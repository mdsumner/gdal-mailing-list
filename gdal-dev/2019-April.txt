From paulborodaev at gmail.com  Mon Apr  1 00:29:49 2019
From: paulborodaev at gmail.com (BrainDrain)
Date: Mon, 1 Apr 2019 00:29:49 -0700 (MST)
Subject: [gdal-dev] Create MVT from PostGIS data with c# bindings
Message-ID: <1554103789807-0.post@n6.nabble.com>

Hello!
Is it possible to create mpabox vector tiles for postgis data using c# SWIG
bindings?
Input: conn string, geometry select queery command text, bbox, custom tile
size, custom tile grid
Output: mvt pbf byte array.
Thank you very much!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From armin.r.schmidt at gmail.com  Mon Apr  1 04:02:12 2019
From: armin.r.schmidt at gmail.com (Armin Schmidt)
Date: Mon, 1 Apr 2019 13:02:12 +0200
Subject: [gdal-dev] in gdal_contour elevation field not for polygons?
Message-ID: <b1eb17fd-b7f8-9ef2-ad85-c7326a4dcae2@Gmail.com>

In gdal_contour it seems that the "-a" elevation field creation only 
works for linestrings, not polygons (-p). Is this intended behaviour?

I would find it more convenient if -a would also work for polygons as I 
sometimes switch between the two modes.

I am using 2.4.0

Armin

-- 
__________________________________________________________________
Dr. Armin Schmidt
GeodataWIZ: Geo Data + Visualisation
  www.GeodataWIZ.com
  www.GeodataWIZ.com/armin-schmidt
Honorary Secretary ISAP
  International Society for Archaeological Prospection
  www.archprospection.org
Honorary Visiting Research Fellow, University of Bradford
  School of Archaeological and Forensic Sciences
Honorary Fellow, Durham University
  Department of Archaeology
http://orcid.org/0000-0002-4241-5381

Email: Armin.R.Schmidt at Gmail.com

Available in print:
  Guidelines for the use of Geophysics in Archaeology (2015). Namur: EAC.
  Earth Resistance for Archaeologists (2013). Lanham: AltaMira Press
  Geophysical Data in Archaeology (2013). Oxford: Oxbow Books.
http://www.amazon.co.uk/-/e/B0034QC4OW
__________________________________________________________________

From mbu at teleplan.no  Mon Apr  1 04:10:20 2019
From: mbu at teleplan.no (Matsamentet)
Date: Mon, 1 Apr 2019 04:10:20 -0700 (MST)
Subject: [gdal-dev] Gdalwarp mosaic large GeoTIFF dataset into GeoPackage
Message-ID: <1554117020951-0.post@n6.nabble.com>

Hi!

I'm trying to mosaic a large GeoTIFF dataset into a GeoPackage with Gdalwarp
(no reprojection). There are 512 .tif files, each with a single grayscale
band, and 1 meter resolution. I'm using -cutline to clip the dataset to a
slightly smaller extent. 

Gdalwarp initially outputs the dimensions as 1 824 323P x 1 662 148L

I expect this operation to take quite some time, but it's now been five days
and there has been no other output than the message about the dimensions.
Gdalwarp.exe has been using 2-3% CPU and 5 GB of memory the entire time.
Since Gdalwarp usually outputs each filename as it's being processed, I'm
suspecting that something has gone wrong.

I'm describing a specific case here, but I've tried this several times in
the past with similar input data, with the same result. It seems that when
the output image is larger than a certain size, the process will not move
forward. Does anyone have experience with creating very large mosaic
GeoPackages in GDAL (performance hints etc.)?

/Command used:/
*gdalwarp --config GDAL_CACHEMAX 35% -multi -of GPKG -wo SKIP_NOSOURCE=YES
-co QUALITY=70 -cutline worldbounds.shp -csql "SELECT * FROM worldbounds
WHERE country='TheCountry'" *.tif output.gpkg*

/Hardware/software:/
Windows Server 2012 R2
Intel Xeon E7 4820
256 GB RAM
GDAL 2.3.0 released 2018/05/04



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From neteler at osgeo.org  Mon Apr  1 04:10:37 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Mon, 1 Apr 2019 13:10:37 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
Message-ID: <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>

Hi,

On Fri, Mar 22, 2019 at 12:02 AM Thomas Gertin <tgertin at vt.edu> wrote:
>
> Hello,
>
> Does anybody know how to install gdal in CentOS?

While Fedora EPEL7 only offers a GDAL 1.x package, I am trying to
compile GDAL 2.3 in order to provide it as a RPM package:

https://copr.fedorainfracloud.org/coprs/neteler/GDAL/

However, compilation is still struggling with the pdf/ driver:

https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00875120-gdal/builder-live.log
[...]

make[2]: Entering directory `/builddir/build/BUILD/gdal-2.3.2-fedora/frmts/pdf'
/bin/sh /builddir/build/BUILD/gdal-2.3.2-fedora/libtool --mode=compile
--silent --tag=CXX g++ -std=c++11
-I/builddir/build/BUILD/gdal-2.3.2-fedora/port
-I/builddir/build/BUILD/gdal-2.3.2-fedora/gcore
-I/builddir/build/BUILD/gdal-2.3.2-fedora/alg
-I/builddir/build/BUILD/gdal-2.3.2-fedora/ogr
-I/builddir/build/BUILD/gdal-2.3.2-fedora/ogr/ogrsf_frmts
-I/builddir/build/BUILD/gdal-2.3.2-fedora/gnm
-I/builddir/build/BUILD/gdal-2.3.2-fedora/apps
-DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME -O2 -g -pipe
-Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong
--param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic
-fpic -I/usr/include/libgeotiff -I/usr/include/tirpc  -Wall -Wextra
-Winit-self -Wunused-parameter -Wformat -Werror=format-security
-Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla
-Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
-fno-operator-names -Wzero-as-null-pointer-constant  -I../vrt -I../mem
-I../../ogr/ogrsf_frmts/mem -DGNM_ENABLED -I/usr/include/libgeotiff
-I/usr/include/tirpc -I/builddir/build/BUILD/gdal-2.3.2-fedora/port
-I/usr/include/openjpeg-2.3   -I/usr/include -Iexternal/include
-I/usr/include/cfitsio  -DGDAL_COMPILATION -DHAVE_XERCES
-I/usr/include -I/usr/include/xercesc -I/usr/include/libgeotiff
-I/usr/include/tirpc -I/builddir/build/BUILD/gdal-2.3.2-fedora/port
-I/usr/include/openjpeg-2.3   -I/usr/include -Iexternal/include
-I/usr/include/cfitsio  -DGDAL_COMPILATION -DHAVE_POPPLER
-DPOPPLER_HAS_OPTCONTENT -DPOPPLER_BASE_STREAM_HAS_TWO_ARGS
-DPOPPLER_0_20_OR_LATER -DPOPPLER_0_23_OR_LATER -I/usr/include
-I/usr/include/poppler   -DDO_NOT_USE_DEBUG_BOOL -c -o
../o/pdfdataset.lo pdfdataset.cpp
/bin/sh /builddir/build/BUILD/gdal-2.3.2-fedora/libtool --mode=compile
--silent --tag=CXX g++ -std=c++11 -DHAVE_AVX_AT_COMPILE_TIME
-DHAVE_SSSE3_AT_COMPILE_TIME -O2 -g -pipe -Wall
-Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong
--param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic
-fpic -I/usr/include/libgeotiff -I/usr/include/tirpc  -Wall -Wextra
-Winit-self -Wunused-parameter -Wformat -Werror=format-security
-Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla
-Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
-fno-operator-names -Wzero-as-null-pointer-constant  -I. -I.. -I../..
-DGNM_ENABLED -I/usr/include/libgeotiff -I/usr/include/tirpc
-I/builddir/build/BUILD/gdal-2.3.2-fedora/port
-I/usr/include/openjpeg-2.3   -I/usr/include -Iexternal/include
-I/usr/include/cfitsio  -DGDAL_COMPILATION -DHAVE_XERCES
-I/usr/include -I/usr/include/xercesc -I/usr/include/libgeotiff
-I/usr/include/tirpc -I/builddir/build/BUILD/gdal-2.3.2-fedora/port
-I/usr/include/openjpeg-2.3   -I/usr/include -Iexternal/include
-I/usr/include/cfitsio  -DGDAL_COMPILATION -c -o ../../o/cadobjects.lo
cadobjects.cpp
pdfdataset.cpp: In member function 'void PDFDataset::FindLayersPoppler()':
pdfdataset.cpp:3444:31: error: no matching function for call to
'begin(GooList* const&)'
         for (const auto &oc : ocgList) {
                               ^
pdfdataset.cpp:3444:31: note: candidates are:
In file included from /usr/include/c++/4.8.2/string:51:0,
                 from /usr/include/c++/4.8.2/stdexcept:39,
                 from /usr/include/c++/4.8.2/array:38,
                 from /usr/include/c++/4.8.2/tuple:39,
                 from /usr/include/c++/4.8.2/bits/stl_map.h:63,
                 from /usr/include/c++/4.8.2/map:61,
                 from gdal_pdf.h:46,
                 from pdfdataset.cpp:36:
/usr/include/c++/4.8.2/bits/range_access.h:87:5: note: template<class
_Tp, long unsigned int _Nm> _Tp* std::begin(_Tp (&)[_Nm])
     begin(_Tp (&__arr)[_Nm])
     ^
/usr/include/c++/4.8.2/bits/range_access.h:87:5: note:   template
argument deduction/substitution failed:
pdfdataset.cpp:3444:31: note:   mismatched types '_Tp [_Nm]' and
'GooList* const'
         for (const auto &oc : ocgList) {
                               ^
In file included from /usr/include/c++/4.8.2/string:51:0,
                 from /usr/include/c++/4.8.2/stdexcept:39,
                 from /usr/include/c++/4.8.2/array:38,
                 from /usr/include/c++/4.8.2/tuple:39,
                 from /usr/include/c++/4.8.2/bits/stl_map.h:63,
                 from /usr/include/c++/4.8.2/map:61,
                 from gdal_pdf.h:46,
                 from pdfdataset.cpp:36:
/usr/include/c++/4.8.2/bits/range_access.h:58:5: note: template<class
_Container> decltype (__cont.begin()) std::begin(const _Container&)
     begin(const _Container& __cont) -> decltype(__cont.begin())
     ^
/usr/include/c++/4.8.2/bits/range_access.h:58:5: note:   template
argument deduction/substitution failed:
/usr/include/c++/4.8.2/bits/range_access.h: In substitution of
'template<class _Container> decltype (__cont.begin()) std::begin(const
_Container&) [with _Container = GooList*]':
pdfdataset.cpp:3444:31:   required from here
/usr/include/c++/4.8.2/bits/range_access.h:58:5: error: request for
member 'begin' in '__cont', which is of pointer type 'GooList* const'
(maybe you meant to use '->' ?)
/usr/include/c++/4.8.2/bits/range_access.h:48:5: note: template<class
_Container> decltype (__cont.begin()) std::begin(_Container&)
     begin(_Container& __cont) -> decltype(__cont.begin())
     ^
[...]

Any hints for that?

thanks
Markus

-- 
Markus Neteler, PhD
https://www.mundialis.de - free data with free software
https://grass.osgeo.org
https://courses.neteler.org/blog

From even.rouault at spatialys.com  Mon Apr  1 05:24:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 01 Apr 2019 14:24:59 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
Message-ID: <1708034.anJ8qsWJeK@even-i700>

On lundi 1 avril 2019 13:10:37 CEST Markus Neteler wrote:
> Hi,
> 
> On Fri, Mar 22, 2019 at 12:02 AM Thomas Gertin <tgertin at vt.edu> wrote:
> > Hello,
> > 
> > Does anybody know how to install gdal in CentOS?
> 
> While Fedora EPEL7 only offers a GDAL 1.x package, I am trying to
> compile GDAL 2.3 in order to provide it as a RPM package:
> 
> https://copr.fedorainfracloud.org/coprs/neteler/GDAL/
> 
> However, compilation is still struggling with the pdf/ driver:

Hum, your GDAL 2.3.2 is definitely a patched version from the official one 
since the official one at line
https://github.com/OSGeo/gdal/blob/v2.3.2/gdal/frmts/pdf/pdfdataset.cpp#L3444
has

for(int i=0;i<ocgList->getLength();i++)

and not

for (const auto &oc : ocgList) {

It looks like your GDAL copy might have some special patch that was designed 
to support for a later version of Poppler on recent Fedora than the one you're 
using (0.26) on RHEL7, but dropping support for older versions as well. 
Perhaps you should just drop that specific patch for the RHEL7 context.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Apr  1 05:34:30 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 01 Apr 2019 14:34:30 +0200
Subject: [gdal-dev] in gdal_contour elevation field not for polygons?
In-Reply-To: <b1eb17fd-b7f8-9ef2-ad85-c7326a4dcae2@Gmail.com>
References: <b1eb17fd-b7f8-9ef2-ad85-c7326a4dcae2@Gmail.com>
Message-ID: <4574901.5OCkIxfnrq@even-i700>

On lundi 1 avril 2019 13:02:12 CEST Armin Schmidt wrote:
> In gdal_contour it seems that the "-a" elevation field creation only
> works for linestrings, not polygons (-p). Is this intended behaviour?

Yes, you need to use -amin and/or -amax in -p mode since the polygons are 
valid for a range of altitudes. The doc and code wasn't really clear about 
that. I've just improved it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From neteler at osgeo.org  Mon Apr  1 08:38:45 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Mon, 1 Apr 2019 17:38:45 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <1708034.anJ8qsWJeK@even-i700>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
Message-ID: <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>

On Mon, Apr 1, 2019 at 2:36 PM Even Rouault <even.rouault at spatialys.com> wrote:
> On lundi 1 avril 2019 13:10:37 CEST Markus Neteler wrote:
> > While Fedora EPEL7 only offers a GDAL 1.x package, I am trying to
> > compile GDAL 2.3 in order to provide it as a RPM package:
> >
> > https://copr.fedorainfracloud.org/coprs/neteler/GDAL/
> >
> > However, compilation is still struggling with the pdf/ driver:
>
> Hum, your GDAL 2.3.2 is definitely a patched version from the official one
[...]
> It looks like your GDAL copy might have some special patch that was designed
> to support for a later version of Poppler on recent Fedora than the one you're
> using (0.26) on RHEL7, but dropping support for older versions as well.
> Perhaps you should just drop that specific patch for the RHEL7 context.

Right, this helped. The use of the poppler patch is now
conditionalized (Fedora only).

Now I am stuck at
...

     [exec]   adding: java/org/gdal/gdal/BuildVRTOptions.html (deflated 78%)
     [exec]   adding: java/org/gdal/gdal/Band.html (deflated 90%)
     [copy] Copying 1 file to
/builddir/build/BUILD/gdal-2.3.2-fedora/swig/java/build/maven
     [copy] Copying 1 file to
/builddir/build/BUILD/gdal-2.3.2-fedora/swig/java/build/maven
      [jar] Building jar:
/builddir/build/BUILD/gdal-2.3.2-fedora/swig/java/build/maven/gdal-2.3.2-javadoc.jar
      [jar] Building jar:
/builddir/build/BUILD/gdal-2.3.2-fedora/swig/java/build/maven/gdal-2.3.2-sources.jar

BUILD SUCCESSFUL
Total time: 10 seconds
+ popd
+ %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
swig/java/build/maven/gdal-2.3.2.jar
~/build/BUILD/gdal-2.3.2-fedora
/var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
....

Unfortunately I am not familiar with swig/java/ - help would be
appreciated. This is the new log:

https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876255-gdal/builder-live.log

thanks
Markus

From andrew at aitchison.me.uk  Mon Apr  1 14:12:13 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 1 Apr 2019 22:12:13 +0100 (BST)
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
Message-ID: <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>

On Mon, 1 Apr 2019, Markus Neteler wrote:

> Now I am stuck at
> ...
>
> BUILD SUCCESSFUL
> Total time: 10 seconds
> + popd
> + %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
> swig/java/build/maven/gdal-2.3.2.jar
> ~/build/BUILD/gdal-2.3.2-fedora
> /var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
> error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
> ....

That is probably a bug in the rpm .spec file
     https://www.redhat.com/archives/rpm-list/2002-October/msg00271.html
suggests that it is a % character being passed to the shell.

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From fan.liu at ericsson.com  Mon Apr  1 23:11:57 2019
From: fan.liu at ericsson.com (Fan Liu)
Date: Tue, 2 Apr 2019 06:11:57 +0000
Subject: [gdal-dev] Question about GDAL lib size
In-Reply-To: <HE1PR0701MB2569BB31E7B08C41C95A88469E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
References: <HE1PR0701MB2569BB31E7B08C41C95A88469E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
Message-ID: <HE1PR0701MB256986B32A104B712AF52DEA9E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>

Resent question after register. Could anyone support?

BRs,
Fan Liu

From: Fan Liu
Sent: Tuesday, April 2, 2019 10:24 AM
To: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Subject: Question about GDAL lib size

Hello,

I have a question related with lib size. When I install GDAL via rpm on redhat, it lib size is 13MB. But when I compile GDAL frou source code on SUSE, the lib is 121MB. This confuse me, could anyone provide any suggestions? Why it's so big?

-rwxr-xr-x 1 root root 121M Apr  1 08:37 libgdal.so.20.5.0  ## compile via source code 2.4.0
-rwxr-xr-x  1 root root  13M Jan 28  2018 libgdal.so.1.18.4  ## installed via rpm on redhat


BRs,
Fan Liu
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190402/8c0cbacc/attachment.html>

From patrick.valsecchi at camptocamp.com  Tue Apr  2 00:14:35 2019
From: patrick.valsecchi at camptocamp.com (Patrick Valsecchi)
Date: Tue, 2 Apr 2019 09:14:35 +0200
Subject: [gdal-dev] Question about GDAL lib size
In-Reply-To: <HE1PR0701MB2569AD058E7BA37F71CE74D49E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
References: <HE1PR0701MB2569BB31E7B08C41C95A88469E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
 <HE1PR0701MB256986B32A104B712AF52DEA9E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
 <CAKOK4jgo8FUPZmM0ajzYvSNmBFkfe9H9mDpHw9QtHkxh1Qv++A@mail.gmail.com>
 <HE1PR0701MB25695260C4E02C32139F386B9E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
 <HE1PR0701MB2569AD058E7BA37F71CE74D49E560@HE1PR0701MB2569.eurprd07.prod.outlook.com>
Message-ID: <CAKOK4jhNo6Ku=bWgNrq8yoB5NeGcAXtQAvdxH0R-GYaAONZd=g@mail.gmail.com>

cmake -DCMAKE_BUILD_TYPE=Release ...

But typically the libs are not stripped in this mode either. I never
understood why and always add steps to do it afterwards.

On Tue, Apr 2, 2019 at 8:52 AM Fan Liu <fan.liu at ericsson.com> wrote:

> Hi,
>
>
>
> I tried ‘strip lib’, it reduce the lib file size to 17MB.
>
> Do you know is there any parameters during “./configure” to compile
> without debug? I didn’t find the document.
>
>
>
> BRs,
>
> Fan Liu
>
>
>
> *From:* Fan Liu
> *Sent:* Tuesday, April 2, 2019 2:40 PM
> *To:* Patrick Valsecchi <patrick.valsecchi at camptocamp.com>
> *Subject:* RE: [gdal-dev] Question about GDAL lib size
>
>
>
> Hi Patrick,
>
>
>
> Thanks for the reply.
>
> I checked online, it looks like strip a library will only remove unused
> links for debug.
>
>
>
> Is it possible to get confirm that strip a library will not impact
> functions?
>
>
>
> BRs,
>
> Fan Liu
>
>
>
> *From:* Patrick Valsecchi <patrick.valsecchi at camptocamp.com>
> *Sent:* Tuesday, April 2, 2019 2:27 PM
> *To:* Fan Liu <fan.liu at ericsson.com>
> *Subject:* Re: [gdal-dev] Question about GDAL lib size
>
>
>
> Hi,
>
>
>
> Most likely Redhat's is stripped and yours not. And yours is maybe also
> compiled in debug...
>
> Plus, you don't look at the same version of GDAL.
>
>
>
> To strip a library, use the "strip" command.
>
>
>
> CU
>
>
>
> On Tue, Apr 2, 2019 at 8:12 AM Fan Liu <fan.liu at ericsson.com> wrote:
>
> Resent question after register. Could anyone support?
>
>
>
> BRs,
>
> Fan Liu
>
>
>
> *From:* Fan Liu
> *Sent:* Tuesday, April 2, 2019 10:24 AM
> *To:* 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
> *Subject:* Question about GDAL lib size
>
>
>
> Hello,
>
>
>
> I have a question related with lib size. When I install GDAL via rpm on
> redhat, it lib size is 13MB. But when I compile GDAL frou source code on
> SUSE, the lib is 121MB. This confuse me, could anyone provide any
> suggestions? Why it's so big?
>
>
>
> -rwxr-xr-x 1 root root 121M Apr  1 08:37 libgdal.so.20.5.0  ## compile via
> source code 2.4.0
>
> -rwxr-xr-x  1 root root  13M Jan 28  2018 libgdal.so.1.18.4  ## installed
> via rpm on redhat
>
>
>
>
>
> BRs,
>
> Fan Liu
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190402/1ad57ef4/attachment-0001.html>

From even.rouault at spatialys.com  Tue Apr  2 08:02:20 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 02 Apr 2019 17:02:20 +0200
Subject: [gdal-dev] GDAL and OpenJpeg2000 next version release
In-Reply-To: <CAPfwm40=1cNVcfwygsApA-5U7vQRaUq0i+6q_5_jJjnLA_0wnA@mail.gmail.com>
References: <CAPfwm40=1cNVcfwygsApA-5U7vQRaUq0i+6q_5_jJjnLA_0wnA@mail.gmail.com>
Message-ID: <3889497.NsQj7Gkr6G@even-i700>

On vendredi 22 février 2019 08:41:13 CEST Noureddine Farah wrote:
> Hi,
> 
> I'm using GDAL to open and read OpenJpeg 2000 files and one of the files
> could not be  read ok because of this bug
> <https://github.com/uclouvain/openjpeg/issues/1120>. The good news that bug
> was fixed in OpenJpeg 2000 master but there is not public OpenJpeg 2000
> including that fix and other enhancements since last public release
> <https://github.com/uclouvain/openjpeg/releases/tag/v2.3.0> of OpenJpeg
> 2000 on Oct 4 2017.
> 
> I asked the question about next version release of OpenJpeg 2000 but my
> question does not appear to be listed in that mailing list and since GDAL
> is using OpenJpeg 2000, i was wondering if any one (may be Even R.) know if
> there is any plan for future version release of OpenJpeg 2000.

FYI OpenJPEG 2.3.1 has just been released:
https://groups.google.com/forum/#!topic/openjpeg/K9lgiDhN0IE

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From reena.dass2 at utas.utc.com  Wed Apr  3 08:46:08 2019
From: reena.dass2 at utas.utc.com (geospatialdev)
Date: Wed, 3 Apr 2019 08:46:08 -0700 (MST)
Subject: [gdal-dev] J2K Compressed NITF with Alpha channel
Message-ID: <1554306368940-0.post@n6.nabble.com>

Can I generate a multiband J2K compressed NITF with alpha channel using gdal?
If I'm using kakadu for compression how do I specify the alpha channel?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From mofoyoda at gmail.com  Wed Apr  3 15:50:17 2019
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Thu, 4 Apr 2019 01:50:17 +0300
Subject: [gdal-dev] Relation members ids in OGR OSM driver
Message-ID: <EF467F51-5649-46CB-9909-1AF8C73501BE@gmail.com>

Hello,
Is there an option to get ids for relation members and node ids for ways in OGR OSM driver?


From even.rouault at spatialys.com  Thu Apr  4 12:58:32 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 04 Apr 2019 21:58:32 +0200
Subject: [gdal-dev] Relation members ids in OGR OSM driver
In-Reply-To: <EF467F51-5649-46CB-9909-1AF8C73501BE@gmail.com>
References: <EF467F51-5649-46CB-9909-1AF8C73501BE@gmail.com>
Message-ID: <111033090.XOTBxi5AIo@even-i700>

On jeudi 4 avril 2019 01:50:17 CEST Nikolai Bezdna wrote:
> Hello,
> Is there an option to get ids for relation members and node ids for ways in
> OGR OSM driver?

As far as I remember, no.
The OGR OSM driver is a "medium/high-level" driver trying to reconstruct OGC 
Single Feature geometries from OSM topological structure.
The source code of GDAL includes low level parsers

https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrsf_frmts/osm/
osm_parser.h
https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrsf_frmts/osm/
osm_parser.cpp
that you could use for that purpose.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Timo.Mouhu at triona.fi  Thu Apr  4 23:23:06 2019
From: Timo.Mouhu at triona.fi (Timo Mouhu)
Date: Fri, 5 Apr 2019 06:23:06 +0000
Subject: [gdal-dev] GDAL compilation with ODA 2019 Update 2 patch 1
Message-ID: <HE1P192MB0028BC6BD1BB917B033AECC58F510@HE1P192MB0028.EURP192.PROD.OUTLOOK.COM>

Hi all,

I have been trying to compile GDAL in Windows with new ODA versions. I have been partly successful, but compiled DWG driver is basically not working at all, even when no errors or warnings are visible during compile or when running on command line. I have tried to compile driver both included and as plugin and both are the same, though plugin version functions otherwise normally.

Has anyone build GDAL with recent ODA versions and could you give me some pointers how to proceed with debug and/or build?

My current nmake.vc configuration looks like this:

TD_FLAGS = -D_TOOLKIT_IN_DLL_
TD_KERNEL = C:\oda\ODA-2019-u2-p1-b19.12\Kernel_vc14_amd64dll
TD_DRAWING = C:\oda\ODA-2019-u2-p1-b19.12\Drawings_vc14_amd64dll
TD_INCLUDE = -I$(TD_KERNEL)\Kernel\Include -I$(TD_DRAWING)\Drawing\Include -I$(TD_KERNEL)\Kernel\Extensions\ExServices -I$(TD_DRAWING)\Drawing\Extensions\ExServices -I$(TD_DRAWING)\Dgn\include -I$(TD_DRAWING)\Dgn\Extensions\ExServices -I$(TD_KERNEL)\ThirdParty\activation -D_TOOLKIT_IN_DLL
TD_KERNEL_LIBDIR = $(TD_KERNEL)\lib\vc14_amd64dll
TD_DRAWING_LIBDIR = $(TD_DRAWING)\lib\vc14_amd64dll
TD_LIBS = $(TD_DRAWING_LIBDIR)\*.lib $(TD_KERNEL_LIBDIR)\*.lib advapi32.lib
TD_LIBDIR = dummy # Needed to compile DWG plugin


-Timo Mouhu

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190405/5ede22c4/attachment.html>

From nikita.vanku at maptiler.com  Fri Apr  5 03:47:52 2019
From: nikita.vanku at maptiler.com (Zaraka)
Date: Fri, 5 Apr 2019 03:47:52 -0700 (MST)
Subject: [gdal-dev] Overviews default directory
Message-ID: <1554461272664-0.post@n6.nabble.com>

Hello,
If I build overviews for dataset which doesn't have one, overviews will be
generated in separate file such as .ovr which will be saved in the same
folder as source dataset file.
Can I change location of generated overviews to different folder? 



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Fri Apr  5 03:54:43 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 5 Apr 2019 03:54:43 -0700 (MST)
Subject: [gdal-dev] Overviews default directory
In-Reply-To: <1554461272664-0.post@n6.nabble.com>
References: <1554461272664-0.post@n6.nabble.com>
Message-ID: <1554461683327-0.post@n6.nabble.com>

Hi,

You can read the images through a VRT file
https://www.gdal.org/gdal_vrttut.html that includes an overview element with
an absolute path.

"Overview: This optional element describes one overview level for the band.
It should have a child SourceFilename and SourceBand element. The
SourceFilename may have a relativeToVRT boolean attribute. Multiple elements
may be used to describe multiple overviews."

<Overview>
  <SourceFilename relativeToVRT="0">path/to/image.ovr</SourceFilename>
  <SourceBand>1</SourceBand>
</Overview>

-Jukka Rahkonen-


Zaraka wrote
> Hello,
> If I build overviews for dataset which doesn't have one, overviews will be
> generated in separate file such as .ovr which will be saved in the same
> folder as source dataset file.
> Can I change location of generated overviews to different folder? 





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From neteler at osgeo.org  Fri Apr  5 06:38:28 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Fri, 5 Apr 2019 15:38:28 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
 <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
Message-ID: <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>

On Mon, Apr 1, 2019 at 11:17 PM Andrew C Aitchison
<andrew at aitchison.me.uk> wrote:
> On Mon, 1 Apr 2019, Markus Neteler wrote:
> > Now I am stuck at
> > ...
> >
> > BUILD SUCCESSFUL
> > Total time: 10 seconds
> > + popd
> > + %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
> > swig/java/build/maven/gdal-2.3.2.jar
> > ~/build/BUILD/gdal-2.3.2-fedora
> > /var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
> > error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
> > ....
>
> That is probably a bug in the rpm .spec file
>      https://www.redhat.com/archives/rpm-list/2002-October/msg00271.html
> suggests that it is a % character being passed to the shell.

Thanks Andrew,

I made further attempts but I am stuck.
Maybe the Python-3 support needs to be kicked out as well?

The current state is here
https://copr.fedorainfracloud.org/coprs/neteler/GDAL/build/876548/
- SPEC file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/gdal.spec
- Log file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/builder-live.log

I'll continue with low priority, happily accepting support by
more-than-me SPEC file experts.

Best,
Markus

From nicolas.cadieux at archeotec.ca  Fri Apr  5 12:27:08 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 5 Apr 2019 15:27:08 -0400
Subject: [gdal-dev] Gdal_fusion.py???
Message-ID: <77DCCE80-5569-413E-9548-9957B2D53B3F@archeotec.ca>

Hi,

I have made a python 2.7 / 3.7 program to fuse a point cloud with hyperspectral images.  The end result is a text file with xyz... from the cloud file followed by the band pixel values.  It’s all multithreaded so a cloud with 6.5 million points can be fused with a raster with 288 band in 45min (12 threads). What would it take to make this an official gdal  command line utility? What steps would be involved?

Nicolas

From luipir at gmail.com  Fri Apr  5 12:52:59 2019
From: luipir at gmail.com (Luigi Pirelli)
Date: Fri, 5 Apr 2019 21:52:59 +0200
Subject: [gdal-dev] Gdal_fusion.py???
In-Reply-To: <77DCCE80-5569-413E-9548-9957B2D53B3F@archeotec.ca>
References: <77DCCE80-5569-413E-9548-9957B2D53B3F@archeotec.ca>
Message-ID: <CAFO80_qr5d=YgXQxmdP=FVTyK=f6VEn0JGL32reHuO1hTDpiQA@mail.gmail.com>

Hi Nicolas,

really interesting... it is suitable only for pointcloud from airborne
sensors or also from mobil? Is it different from 'pdal colorize' command
[1]?

Luigi Pirelli

[1] https://pdal.io/stages/filters.colorization.html#filters-colorization
 and
https://pdal.io/workshop/exercises/analysis/colorization/colorization.html

**************************************************************************************************
* LinkedIn: https://www.linkedin.com/in/luigipirelli
* Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
* GitHub: https://github.com/luipir
* Mastering QGIS 2nd Edition:
*
https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
* Hire me: http://goo.gl/BYRQKg
**************************************************************************************************


On Fri, 5 Apr 2019 at 21:27, Nicolas Cadieux <nicolas.cadieux at archeotec.ca>
wrote:

> Hi,
>
> I have made a python 2.7 / 3.7 program to fuse a point cloud with
> hyperspectral images.  The end result is a text file with xyz... from the
> cloud file followed by the band pixel values.  It’s all multithreaded so a
> cloud with 6.5 million points can be fused with a raster with 288 band in
> 45min (12 threads). What would it take to make this an official gdal
> command line utility? What steps would be involved?
>
> Nicolas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190405/e05a2a63/attachment.html>

From nicolas.cadieux at archeotec.ca  Fri Apr  5 14:14:22 2019
From: nicolas.cadieux at archeotec.ca (Nicolas Cadieux)
Date: Fri, 5 Apr 2019 17:14:22 -0400
Subject: [gdal-dev] Gdal_fusion.py???
In-Reply-To: <CAFO80_qr5d=YgXQxmdP=FVTyK=f6VEn0JGL32reHuO1hTDpiQA@mail.gmail.com>
References: <77DCCE80-5569-413E-9548-9957B2D53B3F@archeotec.ca>
 <CAFO80_qr5d=YgXQxmdP=FVTyK=f6VEn0JGL32reHuO1hTDpiQA@mail.gmail.com>
Message-ID: <FEB01827-6CE8-40BA-8744-946F6B5C23F8@archeotec.ca>

Hi,

I will read up on the PDAL colorize.  For now, my only input is a txt file therefore I am not using PDAL nor am I using gdal to read the cloud.  I must admit, I am not too good with using PDAL but I would like to.  I do use gdal to read the rasters.  For now, the main purpose was to use it with HSI taken from drones but I have someone trying it with a ground based scanner.  Does PDAL colonize handle any number of bands?

Nicolas

> Le 5 avr. 2019 à 15:52, Luigi Pirelli <luipir at gmail.com> a écrit :
> 
> Hi Nicolas, 
> 
> really interesting... it is suitable only for pointcloud from airborne sensors or also from mobil? Is it different from 'pdal colorize' command [1]?
> 
> Luigi Pirelli
> 
> [1] https://pdal.io/stages/filters.colorization.html#filters-colorization and https://pdal.io/workshop/exercises/analysis/colorization/colorization.html
> 
> **************************************************************************************************
> * LinkedIn: https://www.linkedin.com/in/luigipirelli
> * Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
> * GitHub: https://github.com/luipir
> * Mastering QGIS 2nd Edition:
> * https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
> * Hire me: http://goo.gl/BYRQKg
> **************************************************************************************************
> 
> 
>> On Fri, 5 Apr 2019 at 21:27, Nicolas Cadieux <nicolas.cadieux at archeotec.ca> wrote:
>> Hi,
>> 
>> I have made a python 2.7 / 3.7 program to fuse a point cloud with hyperspectral images.  The end result is a text file with xyz... from the cloud file followed by the band pixel values.  It’s all multithreaded so a cloud with 6.5 million points can be fused with a raster with 288 band in 45min (12 threads). What would it take to make this an official gdal  command line utility? What steps would be involved?
>> 
>> Nicolas
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190405/fa854977/attachment.html>

From neteler at osgeo.org  Fri Apr  5 16:18:44 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Sat, 6 Apr 2019 01:18:44 +0200
Subject: [gdal-dev] Gdal_fusion.py???
In-Reply-To: <FEB01827-6CE8-40BA-8744-946F6B5C23F8@archeotec.ca>
References: <77DCCE80-5569-413E-9548-9957B2D53B3F@archeotec.ca>
 <CAFO80_qr5d=YgXQxmdP=FVTyK=f6VEn0JGL32reHuO1hTDpiQA@mail.gmail.com>
 <FEB01827-6CE8-40BA-8744-946F6B5C23F8@archeotec.ca>
Message-ID: <CALFmHhv+0JUdxfmx8x5ENvYRH4-w2osrcmZtc3M-mQP=Ty4gAw@mail.gmail.com>

Hi,

I wrote some scripts to colorize point cloud provided as XYZ files using
PDAL:

https://github.com/mundialis/openNRW/blob/master/lidar/README.md

Maybe to get some ideas ...

Markus


Nicolas Cadieux <nicolas.cadieux at archeotec.ca> schrieb am Fr., 5. Apr.
2019, 23:14:

> Hi,
>
> I will read up on the PDAL colorize.  For now, my only input is a txt file
> therefore I am not using PDAL nor am I using gdal to read the cloud.  I
> must admit, I am not too good with using PDAL but I would like to.  I do
> use gdal to read the rasters.  For now, the main purpose was to use it with
> HSI taken from drones but I have someone trying it with a ground based
> scanner.  Does PDAL colonize handle any number of bands?
>
> Nicolas
>
> Le 5 avr. 2019 à 15:52, Luigi Pirelli <luipir at gmail.com> a écrit :
>
> Hi Nicolas,
>
> really interesting... it is suitable only for pointcloud from airborne
> sensors or also from mobil? Is it different from 'pdal colorize' command
> [1]?
>
> Luigi Pirelli
>
> [1] https://pdal.io/stages/filters.colorization.html#filters-colorization
>  and
> https://pdal.io/workshop/exercises/analysis/colorization/colorization.html
>
>
> **************************************************************************************************
> * LinkedIn: https://www.linkedin.com/in/luigipirelli
> * Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
> * GitHub: https://github.com/luipir
> * Mastering QGIS 2nd Edition:
> *
> https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
> * Hire me: http://goo.gl/BYRQKg
>
> **************************************************************************************************
>
>
> On Fri, 5 Apr 2019 at 21:27, Nicolas Cadieux <nicolas.cadieux at archeotec.ca>
> wrote:
>
>> Hi,
>>
>> I have made a python 2.7 / 3.7 program to fuse a point cloud with
>> hyperspectral images.  The end result is a text file with xyz... from the
>> cloud file followed by the band pixel values.  It’s all multithreaded so a
>> cloud with 6.5 million points can be fused with a raster with 288 band in
>> 45min (12 threads). What would it take to make this an official gdal
>> command line utility? What steps would be involved?
>>
>> Nicolas
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190406/1434313e/attachment-0001.html>

From fengting.chen at oracle.com  Fri Apr  5 12:57:50 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Fri, 5 Apr 2019 15:57:50 -0400
Subject: [gdal-dev] How to run autotest
Message-ID: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>

Hi,

I followed the description in CONTRIUBTING.md on running autotest suite:

/cd ../autotest//
//pip install -r requirements.txt//
//pytest/

At the last step, pytest gave the following error:

/ImportError while loading conftest 
'/scratch/gdal/gdal/autotest/conftest.py'.//
///home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_//
//    exec("""exec _code_ in _globs_, _locs_""")//
//conftest.py:9: in <module>//
//    from osgeo import gdal//
//E   ImportError: No module named osgeo/

Any thing I need to do to fix this?

Thanks,

-Fengting


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190405/4fa1da92/attachment.html>

From even.rouault at spatialys.com  Sat Apr  6 00:28:41 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 06 Apr 2019 09:28:41 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
Message-ID: <2071155.c55yWmvIeG@even-i700>

Fengting,

2 things to check:
- first that the python bindings have been built. Did you ./configure --with-
python ? Or alternatively "cd swig/python && make"
- and that the Python buindings are in the PYTHONPATH. Sourcing scripts/
setdevenv.sh will do it

Even

> Hi,
> 
> I followed the description in CONTRIUBTING.md on running autotest suite:
> 
> /cd ../autotest//
> //pip install -r requirements.txt//
> //pytest/
> 
> At the last step, pytest gave the following error:
> 
> /ImportError while loading conftest
> '/scratch/gdal/gdal/autotest/conftest.py'.//
> ///home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_//
> //    exec("""exec _code_ in _globs_, _locs_""")//
> //conftest.py:9: in <module>//
> //    from osgeo import gdal//
> //E   ImportError: No module named osgeo/
> 
> Any thing I need to do to fix this?
> 
> Thanks,
> 
> -Fengting


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Sat Apr  6 12:08:37 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sat, 6 Apr 2019 19:08:37 +0000
Subject: [gdal-dev] Possible issue with alpha band and VRT
Message-ID: <a93cbbff164040779f7e36cd96c6bfbe@C119S212VM042.msvyvi.vaha.local>

Hi,

I repeated the steps which are described in this question https://gis.stackexchange.com/questions/317916/gdalbuiltvrt-output-is-different-than-the-source-images-when-using-dstalpha and it indeed seems that transparency that is defined with an alpha band in original images is lost if I read data through VRT. I wonder if something similar happens than in this issue https://github.com/mapbox/rasterio/issues/1454 with GDALRasterBand::GetMaskBand().

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190406/6f51604d/attachment.html>

From even.rouault at spatialys.com  Sat Apr  6 14:12:16 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 06 Apr 2019 23:12:16 +0200
Subject: [gdal-dev] Possible issue with alpha band and VRT
In-Reply-To: <a93cbbff164040779f7e36cd96c6bfbe@C119S212VM042.msvyvi.vaha.local>
References: <a93cbbff164040779f7e36cd96c6bfbe@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2218462.5zXeOJIiBE@even-i700>

Jukka,

> I repeated the steps which are described in this question
> https://gis.stackexchange.com/questions/317916/gdalbuiltvrt-output-is-diffe
> rent-than-the-source-images-when-using-dstalpha and it indeed seems that
> transparency that is defined with an alpha band in original images is lost
> if I read data through VRT. 

gdalbuildvrt doesn't do alpha compositing (yet?). It you stack several images, 
the non-alpha and the alpha band of the latest appearing in the sources will 
be used, overriding completely what is beneath.
gdalwarp will do the right thing.

> I wonder if something similar happens than in
> this issue https://github.com/mapbox/rasterio/issues/1454 with
> GDALRasterBand::GetMaskBand().

>From a very quick look, no. The rasterio issue is about 16-bit images and mask 
band

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From markus.metz.giswork at gmail.com  Sun Apr  7 12:57:23 2019
From: markus.metz.giswork at gmail.com (Markus Metz)
Date: Sun, 7 Apr 2019 21:57:23 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
 <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
 <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
Message-ID: <CAG+h=FHKPr_swXRYZAgbKBZPq5bQUpsp6D7qccunJYVHoF+qoA@mail.gmail.com>

On Fri, Apr 5, 2019 at 3:38 PM Markus Neteler <neteler at osgeo.org> wrote:
>
> On Mon, Apr 1, 2019 at 11:17 PM Andrew C Aitchison
> <andrew at aitchison.me.uk> wrote:
> > On Mon, 1 Apr 2019, Markus Neteler wrote:
> > > Now I am stuck at
> > > ...
> > >
> > > BUILD SUCCESSFUL
> > > Total time: 10 seconds
> > > + popd
> > > + %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
> > > swig/java/build/maven/gdal-2.3.2.jar
> > > ~/build/BUILD/gdal-2.3.2-fedora
> > > /var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
> > > error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
> > > ....
> >
> > That is probably a bug in the rpm .spec file
> >      https://www.redhat.com/archives/rpm-list/2002-October/msg00271.html
> > suggests that it is a % character being passed to the shell.
>
> Thanks Andrew,
>
> I made further attempts but I am stuck.
> Maybe the Python-3 support needs to be kicked out as well?
>
> The current state is here
> https://copr.fedorainfracloud.org/coprs/neteler/GDAL/build/876548/
> - SPEC file:
https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/gdal.spec
> - Log file:
https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/builder-live.log

In the log, there is

  File "/usr/lib/python3.6/site-packages/copr_rpmbuild/builders/mock.py",
line 40, in run

where is python 3.6 with /usr/lib/python3.6/site-packages/ coming from in
your build environment? Centos 7 comes with python 3.4 and gdal uses on
Centos 7 python -> python2. Maybe you need to drop this custom python3.6
installation. I never had any problems compiling gdal 2.x on derivates of
RHEL 7.

Markus M

>
> I'll continue with low priority, happily accepting support by
> more-than-me SPEC file experts.
>
> Best,
> Markus
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190407/bb2126d5/attachment.html>

From neteler at osgeo.org  Sun Apr  7 13:06:08 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Sun, 7 Apr 2019 22:06:08 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CAG+h=FHKPr_swXRYZAgbKBZPq5bQUpsp6D7qccunJYVHoF+qoA@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
 <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
 <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
 <CAG+h=FHKPr_swXRYZAgbKBZPq5bQUpsp6D7qccunJYVHoF+qoA@mail.gmail.com>
Message-ID: <CALFmHhvgBGxRaQ+m9GQ2=3iRbCaADqdHHh=Q2GNNWS9CVvoG6g@mail.gmail.com>

On Sun, Apr 7, 2019 at 9:57 PM Markus Metz
<markus.metz.giswork at gmail.com> wrote:
> On Fri, Apr 5, 2019 at 3:38 PM Markus Neteler <neteler at osgeo.org> wrote:
...
> > The current state is here
> > https://copr.fedorainfracloud.org/coprs/neteler/GDAL/build/876548/
> > - SPEC file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/gdal.spec
> > - Log file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/builder-live.log
>
> In the log, there is
>
>   File "/usr/lib/python3.6/site-packages/copr_rpmbuild/builders/mock.py", line 40, in run
>
> where is python 3.6 with /usr/lib/python3.6/site-packages/ coming from in your build environment?

That is the Fedora COPR system....

> Centos 7 comes with python 3.4 and gdal uses on Centos 7 python -> python2. Maybe you need to drop this custom python3.6 installation. I never had any problems compiling gdal 2.x on derivates of RHEL 7.

AFAIK I have no possibilities to change COPR itself but can only
modify the SPEC file and build it there.

Best,
markusN

From andrew at aitchison.me.uk  Mon Apr  8 01:24:01 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 8 Apr 2019 09:24:01 +0100 (BST)
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
 <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
 <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
Message-ID: <alpine.DEB.2.21.1904080910430.25436@warden.aitchison.me.uk>

On Fri, 5 Apr 2019, Markus Neteler wrote:

> On Mon, Apr 1, 2019 at 11:17 PM Andrew C Aitchison
> <andrew at aitchison.me.uk> wrote:
>> On Mon, 1 Apr 2019, Markus Neteler wrote:
>>> Now I am stuck at
>>> ...
>>>
>>> BUILD SUCCESSFUL
>>> Total time: 10 seconds
>>> + popd
>>> + %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
>>> swig/java/build/maven/gdal-2.3.2.jar
>>> ~/build/BUILD/gdal-2.3.2-fedora
>>> /var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
>>> error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
>>> ....
>>
>> That is probably a bug in the rpm .spec file
>>      https://www.redhat.com/archives/rpm-list/2002-October/msg00271.html
>> suggests that it is a % character being passed to the shell.
>
> Thanks Andrew,
>
> I made further attempts but I am stuck.
> Maybe the Python-3 support needs to be kicked out as well?
>
> The current state is here
> https://copr.fedorainfracloud.org/coprs/neteler/GDAL/build/876548/
> - SPEC file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/gdal.spec
> - Log file: https://copr-be.cloud.fedoraproject.org/results/neteler/GDAL/epel-7-x86_64/00876548-gdal/builder-live.log

Towards the end your log file has
 	+ pushd swig/python
 	~/build/BUILD/gdal-2.3.2-fedora
 	~/build/BUILD/gdal-2.3.2-fedora/swig/python
 	~/build/BUILD/gdal-2.3.2-fedora
 	+ %py3_build
 	/var/tmp/rpm-tmp.mcNaiW: line 136: fg: no job control

First, it might be useful to have /var/tmp/rpm-tmp.mcNaiW (or whatever
name this gets next time you build) as well as the log file.

Second, this means that your .spec calls
 	%py3_build
without first defining it:
 	552-# Make Python modules
 	553-pushd swig/python
 	554-  %{?with_python2:%py2_build}
 	555:  %{?with_python3:%py3_build}
 	556-popd

I only have RedHat/CentOS/SL 6, not 7 and
 	grep -r py3_build /usr/lib/rpm
shows nothing. Does py3_build exist in your rpm tree,
or is it part of COPR ?

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From bryantcurto at gmail.com  Mon Apr  8 08:55:49 2019
From: bryantcurto at gmail.com (Bryant)
Date: Mon, 8 Apr 2019 08:55:49 -0700 (MST)
Subject: [gdal-dev] gdalwarp - Erroneous Outputs
Message-ID: <1554738949004-0.post@n6.nabble.com>

Hello!

I've been trying to use /gdalbuildvrt/ and /gdalwarp/ to merge, project, and
crop a set of overlapping images with a new resolution.

However, I've been running into an issue where the edges of the resulting
image have nondeterministic, erroneous values (ie. very large and small
values) and values in regions that I would expect only NoDataValues. The
images are Float32, 1 banded, and have nodata =
-340282346638528859811704183484516925440.

My commands are:
gdalbuildvrt -r cubic -srcnodata -340282346638528859811704183484516925440
-vrtnodata -340282346638528859811704183484516925440 -te -122.445455
37.747147 -122.433587 37.756551 -tr 0.000031 0.000031 -input_file_list
file-list.txt ~/raster.vrt
gdalwarp --config GDAL_CACHEMAX 1024 -t_srs "+proj=utm +datum=WGS84 +zone=10
+units=m" -tr 2.709812 3.424375 -te 548854.456592 4177905.79342
549893.700272 4178955.41704 -r cubic -srcnodata
-340282346638528859811704183484516925440 -dstnodata 0 ~/raster.vrt
~/raster.tif

Input files:
file-list.txt
<http://osgeo-org.1560.x6.nabble.com/file/t384756/file-list.txt>  , 
raster1.img <http://osgeo-org.1560.x6.nabble.com/file/t384756/raster1.img> 
,  raster2.img
<http://osgeo-org.1560.x6.nabble.com/file/t384756/raster2.img>  , and 
raster3.img <http://osgeo-org.1560.x6.nabble.com/file/t384756/raster3.img>  

In the region bounded by my extents, two images (raster1.img and
raster3.img) have only NoDataValues, while the other has valid values for
part of the region.

In my testing, I've found that this issue does not arise when using gdal
v2.2.0 or v2.2.4, but does with v2.3.0 and v2.4.0. See output from  v2.2.4
<http://osgeo-org.1560.x6.nabble.com/file/t384756/output-gdal2-2-4.tif>  
and  v2.4.0
<http://osgeo-org.1560.x6.nabble.com/file/t384756/output-gdal2-4-0.tif>  .

Some other things I've discovered while attempting to debug this issue:
- Setting the resampling method of gdalbuildvrt to anything besides nearest
results in the issue.
- Initializing the destination image in gdalwarp via -wo "INIT_DEST=NO_DATA"
fails to resolve this issue.

Any help would be appreciated!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gdt at lexort.com  Mon Apr  8 12:44:55 2019
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 08 Apr 2019 15:44:55 -0400
Subject: [gdal-dev] libgeotiff 1.5.0 release candidate
In-Reply-To: <1725326.jxJeg1MGks@even-i700> (Even Rouault's message of "Wed,
 13 Mar 2019 23:49:41 +0100")
References: <1725326.jxJeg1MGks@even-i700>
Message-ID: <smuy34kl1s8.fsf@linuxpal.mit.edu>

Even Rouault <even.rouault at spatialys.com> writes:

[I realize this is now about 1.5.1]

> The news are:
> * Require PROJ >= 6 dependency
> * Remove all CSV files used by geo_normalize API, since libgeotiff now relies
>   on PROJ database for EPSG CRS definitions.
> * geo_normalize.c: SetGTParmIds(): use ProjStraightVertPoleLongGeoKey for 
> CT_PolarStereographic
> * geo_normalize.c: report StdParallel1 for Mercator_2SP when a PCS code is 
> used
> * geo_normalize.c: fix support for Laborde Oblique Mercator
> * listgeo: use PROJ database to display non-hardcoded values of a number of 
> keys

Because this requires proj 6, I can't update pkgsrc (well, I'm not
willing to move pkgsrc to proj 6 yet).   I realize there is only finite
effort, but it would be really nice if everything supported proj 5 and 6
both for a while, to avoid having to synchronize updates.

From fengting.chen at oracle.com  Mon Apr  8 14:20:45 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Mon, 8 Apr 2019 17:20:45 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <2071155.c55yWmvIeG@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
Message-ID: <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>

I rebuilt GDAl with python bindings without errors. Now I got a 
different error:

ImportError while loading conftest 
'/scratch/gdal/gdal/autotest/conftest.py'.
/home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_
     exec("""exec _code_ in _globs_, _locs_""")
conftest.py:9: in <module>
     from osgeo import gdal
../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:21: in 
<module>
     _gdal = swig_import_helper()
../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:17: in 
swig_import_helper
     _mod = imp.load_module('_gdal', fp, pathname, description)
E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined 
symbol: _Z17CPLHaveRuntimeAVXv

Any idea why  libgdal.so.20 has undefined symbol?

Thanks,

-Fengting

On 4/6/2019 3:28 AM, Even Rouault wrote:
> Fengting,
>
> 2 things to check:
> - first that the python bindings have been built. Did you ./configure --with-
> python ? Or alternatively "cd swig/python && make"
> - and that the Python buindings are in the PYTHONPATH. Sourcing scripts/
> setdevenv.sh will do it
>
> Even
>
>> Hi,
>>
>> I followed the description in CONTRIUBTING.md on running autotest suite:
>>
>> /cd ../autotest//
>> //pip install -r requirements.txt//
>> //pytest/
>>
>> At the last step, pytest gave the following error:
>>
>> /ImportError while loading conftest
>> '/scratch/gdal/gdal/autotest/conftest.py'.//
>> ///home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_//
>> //    exec("""exec _code_ in _globs_, _locs_""")//
>> //conftest.py:9: in <module>//
>> //    from osgeo import gdal//
>> //E   ImportError: No module named osgeo/
>>
>> Any thing I need to do to fix this?
>>
>> Thanks,
>>
>> -Fengting
>

From even.rouault at spatialys.com  Tue Apr  9 01:22:39 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 09 Apr 2019 10:22:39 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
 <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
Message-ID: <2307358.d1F8GuK5he@even-i700>

On lundi 8 avril 2019 17:20:45 CEST Fengting Chen wrote:
> I rebuilt GDAl with python bindings without errors. Now I got a
> different error:
> 
> ImportError while loading conftest
> '/scratch/gdal/gdal/autotest/conftest.py'.
> /home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_
>      exec("""exec _code_ in _globs_, _locs_""")
> conftest.py:9: in <module>
>      from osgeo import gdal
> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:21: in
> <module>
>      _gdal = swig_import_helper()
> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:17: in
> swig_import_helper
>      _mod = imp.load_module('_gdal', fp, pathname, description)
> E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined
> symbol: _Z17CPLHaveRuntimeAVXv
> 
> Any idea why  libgdal.so.20 has undefined symbol?

First time I see this error
Do you get this also when using gdalinfo, gdal_translate, etc ?
If so, consider doing a clean build. It might be that you have attempted 
several builds of GDAL with different options after ./configure

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fengting.chen at oracle.com  Tue Apr  9 08:33:19 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Tue, 9 Apr 2019 11:33:19 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <2307358.d1F8GuK5he@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
 <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
 <2307358.d1F8GuK5he@even-i700>
Message-ID: <36f18511-204b-3436-5011-c80c343340c8@oracle.com>

gdalinfo and gdal_translate are working fine. just pytest failed with 
the same error.

Here is my configure:

./configure --prefix=${PREFIX} \
   --without-libtool \
   --disable-rpath \
   --with-libz=internal \
   --with-png=internal \
   --with-libtiff=internal \
   --with-geotiff=internal \
   --with-jpeg=internal \
   --with-gif=internal \
   --without-pg \
   --without-sqlite3 \
   --without-expat \
   --without-odbc \
   --with-curl=/usr/bin/curl-config \
   --without-perl \
   --without-pcre \
   --with-hdfs=no \
   --with-python=/scratch/SDK/Python-2.7.5/dist/bin/python \
   --with-proj=/scratch/SDK/proj-6.0.0/dist

After that:

make clean
make -j8 -s
cd apps; make -s test_ogrsf; cd ..

-Fengting

On 4/9/2019 4:22 AM, Even Rouault wrote:
> On lundi 8 avril 2019 17:20:45 CEST Fengting Chen wrote:
>> I rebuilt GDAl with python bindings without errors. Now I got a
>> different error:
>>
>> ImportError while loading conftest
>> '/scratch/gdal/gdal/autotest/conftest.py'.
>> /home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_
>>       exec("""exec _code_ in _globs_, _locs_""")
>> conftest.py:9: in <module>
>>       from osgeo import gdal
>> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:21: in
>> <module>
>>       _gdal = swig_import_helper()
>> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:17: in
>> swig_import_helper
>>       _mod = imp.load_module('_gdal', fp, pathname, description)
>> E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined
>> symbol: _Z17CPLHaveRuntimeAVXv
>>
>> Any idea why  libgdal.so.20 has undefined symbol?
> First time I see this error
> Do you get this also when using gdalinfo, gdal_translate, etc ?
> If so, consider doing a clean build. It might be that you have attempted
> several builds of GDAL with different options after ./configure
>

From andrew at aitchison.me.uk  Tue Apr  9 12:01:23 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Tue, 9 Apr 2019 20:01:23 +0100 (BST)
Subject: [gdal-dev] How to run autotest
In-Reply-To: <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
 <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
 <2307358.d1F8GuK5he@even-i700>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
Message-ID: <alpine.DEB.2.21.1904092000000.27303@warden.aitchison.me.uk>

On Tue, 9 Apr 2019, Fengting Chen wrote:

> gdalinfo and gdal_translate are working fine. just pytest failed with the 
> same error.
>
> Here is my configure:
>
> ./configure --prefix=${PREFIX} \
>   --without-libtool \
>   --disable-rpath \
>   --with-libz=internal \
>   --with-png=internal \
>   --with-libtiff=internal \
>   --with-geotiff=internal \
>   --with-jpeg=internal \
>   --with-gif=internal \
>   --without-pg \
>   --without-sqlite3 \
>   --without-expat \
>   --without-odbc \
>   --with-curl=/usr/bin/curl-config \
>   --without-perl \
>   --without-pcre \
>   --with-hdfs=no \
>   --with-python=/scratch/SDK/Python-2.7.5/dist/bin/python \
>   --with-proj=/scratch/SDK/proj-6.0.0/dist
>
> After that:
>
> make clean
> make -j8 -s
> cd apps; make -s test_ogrsf; cd ..
>
> -Fengting

If you are running ogr tests, you might wish to try
 	ogrinfo
first.

If you didn't install the gdal you wish to test,
I think you need to run the script
   scripts/setdevenv.sh
so that the test gdal is used.

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From fengting.chen at oracle.com  Tue Apr  9 13:48:20 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Tue, 9 Apr 2019 16:48:20 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <alpine.DEB.2.21.1904092000000.27303@warden.aitchison.me.uk>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
 <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
 <2307358.d1F8GuK5he@even-i700>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
 <alpine.DEB.2.21.1904092000000.27303@warden.aitchison.me.uk>
Message-ID: <e1979825-73ee-c500-f8a8-7f9a51e327d3@oracle.com>

I did run scripts/setdevenv.sh and the path looks correct.

ogrinfo runs ok too:

bash-4.2$ ogrinfo
Usage: ogrinfo [--help-general] [-ro] [-q] [-where 
restricted_where|@filename]
                [-spat xmin ymin xmax ymax] [-geomfield field] [-fid fid]
                [-sql statement|@filename] [-dialect sql_dialect] [-al] 
[-rl] [-so] [-fields={YES/NO}]
                [-geom={YES/NO/SUMMARY}] [[-oo NAME=VALUE] ...]
                [-nomd] [-listmdd] [-mdd domain|`all`]*
                [-nocount] [-noextent] [-wkt_format WKT1|WKT2|...]
                datasource_name [layer [layer ...]]

Thanks,

-Fengting

On 4/9/2019 3:01 PM, Andrew C Aitchison wrote:
> On Tue, 9 Apr 2019, Fengting Chen wrote:
>
>> gdalinfo and gdal_translate are working fine. just pytest failed with 
>> the same error.
>>
>> Here is my configure:
>>
>> ./configure --prefix=${PREFIX} \
>>   --without-libtool \
>>   --disable-rpath \
>>   --with-libz=internal \
>>   --with-png=internal \
>>   --with-libtiff=internal \
>>   --with-geotiff=internal \
>>   --with-jpeg=internal \
>>   --with-gif=internal \
>>   --without-pg \
>>   --without-sqlite3 \
>>   --without-expat \
>>   --without-odbc \
>>   --with-curl=/usr/bin/curl-config \
>>   --without-perl \
>>   --without-pcre \
>>   --with-hdfs=no \
>>   --with-python=/scratch/SDK/Python-2.7.5/dist/bin/python \
>>   --with-proj=/scratch/SDK/proj-6.0.0/dist
>>
>> After that:
>>
>> make clean
>> make -j8 -s
>> cd apps; make -s test_ogrsf; cd ..
>>
>> -Fengting
>
> If you are running ogr tests, you might wish to try
>     ogrinfo
> first.
>
> If you didn't install the gdal you wish to test,
> I think you need to run the script
>   scripts/setdevenv.sh
> so that the test gdal is used.
>

From even.rouault at spatialys.com  Wed Apr 10 07:11:39 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Apr 2019 16:11:39 +0200
Subject: [gdal-dev] GDAL 2.5.0 release planning
Message-ID: <3127589.Ay18HSJqft@even-i700>

Hi,

I don't think we've discussed about the 2.5.0 release planning. Here's my 
suggestion, assuming all things go fine:
- 19 April: beta1
- 26 April: RC1
- 3 May: RC1 promoted to final

Thoughts ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Wed Apr 10 07:40:44 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 10 Apr 2019 11:40:44 -0300
Subject: [gdal-dev] GDAL 2.5.0 release planning
In-Reply-To: <3127589.Ay18HSJqft@even-i700>
References: <3127589.Ay18HSJqft@even-i700>
Message-ID: <46980e2a-42b1-e673-3db0-2db7b8a46afb@gatewaygeomatics.com>

On 2019-04-10 11:11 AM, Even Rouault wrote:
> Hi,
> 
> I don't think we've discussed about the 2.5.0 release planning. Here's my
> suggestion, assuming all things go fine:
> - 19 April: beta1
> - 26 April: RC1
> - 3 May: RC1 promoted to final
> 
> Thoughts ?
> 

To confirm: this will be the first release with no support for PROJ < 6, 
correct?

(I know of the wiki status page, but I am asking here for confirmation)

thanks,

-jeff




From even.rouault at spatialys.com  Wed Apr 10 08:08:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Apr 2019 17:08:00 +0200
Subject: [gdal-dev] GDAL 2.5.0 release planning
In-Reply-To: <46980e2a-42b1-e673-3db0-2db7b8a46afb@gatewaygeomatics.com>
References: <3127589.Ay18HSJqft@even-i700>
 <46980e2a-42b1-e673-3db0-2db7b8a46afb@gatewaygeomatics.com>
Message-ID: <12165504.sERdg8zTE9@even-i700>

On mercredi 10 avril 2019 11:40:44 CEST Jeff McKenna wrote:
> On 2019-04-10 11:11 AM, Even Rouault wrote:
> > Hi,
> > 
> > I don't think we've discussed about the 2.5.0 release planning. Here's my
> > suggestion, assuming all things go fine:
> > - 19 April: beta1
> > - 26 April: RC1
> > - 3 May: RC1 promoted to final
> > 
> > Thoughts ?
> 
> To confirm: this will be the first release with no support for PROJ < 6,
> correct?

Correct

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From zazhil_ha at hotmail.com  Wed Apr 10 14:54:29 2019
From: zazhil_ha at hotmail.com (ZAZHIL-HA HERENA)
Date: Wed, 10 Apr 2019 21:54:29 +0000
Subject: [gdal-dev] Problem when trying to open files with GDAL from Object
 Store using vsiswift
Message-ID: <BYAPR07MB6293E544B686131C6F3E4189952E0@BYAPR07MB6293.namprd07.prod.outlook.com>

Hello everyone,

I am using GDAL 2.4.1  with Python 3.6 to access rasters in Object Storage using /vsiswift. I need to open around 100 rasters, read their data and capture it in an array. I do not need to have them all available in memory, this is a sequential task , read one raster, delete dataset and continue with another one within a for loop.

Here is a fragment of my code:

 files = ['/vsiswift/spatial/sourceinput/Atlanta_nadir27_catid_1030010003472200/Pan-Sharpen/Pan-Sharpen_Atlanta_nadir27_catid_1030010003472200_732701_3725139.tif',
             '/vsiswift/spatial/sourceinput/Atlanta_nadir42_catid_10300100035D1B00/Pan-Sharpen/Pan-Sharpen_Atlanta_nadir42_catid_10300100035D1B00_732701_3725139.tif',
             '/vsiswift/spatial/sourceinput/Atlanta_nadir7_catid_1030010003D22F00/Pan-Sharpen/Pan-Sharpen_Atlanta_nadir7_catid_1030010003D22F00_732701_3725139.tif',
              .
              .
              .
             '/vsiswift/spatial/sourceinput/Atlanta_nadir42_catid_10300100035D1B00/Pan-Sharpen/Pan-Sharpen_Atlanta_nadir42_catid_10300100035D1B00_732701_3730989.tif'
             ]
 for _file in tqdm(files[:]):
    tileHdl = gdal.Open(_file, gdal.GA_ReadOnly)
    data = tileHdl.ReadAsArray()
    del tileHDL


My problem is that, after reading 19 rasters, the 20th one returns a dataset in the Open operation , but returns 'None' when I try the 'ReadAsArray()'. The 20th raster is a valid one, if I move this "failing" raster to the first position in the loop it gets read successfully.

I did print gdal lastErrorMsg and got the following error: "band 4: IReadBlock failed at X offset 0, Y offset 0: TIFFReadEncodedStrip() failed"

Has anyone else succeded in accessing multiple rasters in the same python program? Is this a known issue? Maybe I have a problem in my code?

Truly appreciate your help and time.

Thanks,

Zazhil-ha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190410/8230d5ae/attachment.html>

From david.bekaert at jpl.nasa.gov  Wed Apr 10 21:55:52 2019
From: david.bekaert at jpl.nasa.gov (Bekaert, David (334H))
Date: Thu, 11 Apr 2019 04:55:52 +0000
Subject: [gdal-dev] Netcdf groups support
Message-ID: <91E3A8A7-21BC-4D80-9EB6-8D354C52AB56@jpl.nasa.gov>

Dear GDAL developers,

The netcdf4 groups support has been integrated into the GDAL main branch.
So far we have been building it from source.
I was wondering if you might have a rough time-frame when this might become available in a tagged GDAL release and which release this might be (e.g. 2.5).

Thank you,
Best regards,

David



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190411/6d88f738/attachment.html>

From even.rouault at spatialys.com  Thu Apr 11 01:15:21 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 11 Apr 2019 10:15:21 +0200
Subject: [gdal-dev] Netcdf groups support
In-Reply-To: <91E3A8A7-21BC-4D80-9EB6-8D354C52AB56@jpl.nasa.gov>
References: <91E3A8A7-21BC-4D80-9EB6-8D354C52AB56@jpl.nasa.gov>
Message-ID: <1925718.Ir25lpUV4S@even-i700>

On jeudi 11 avril 2019 04:55:52 CEST Bekaert, David (334H) wrote:
> Dear GDAL developers,
> 
> The netcdf4 groups support has been integrated into the GDAL main branch.
> So far we have been building it from source.
> I was wondering if you might have a rough time-frame when this might become
> available in a tagged GDAL release and which release this might be (e.g.
> 2.5).

David,

As it is in master, it will be part of the 2.5.0 release made from it. See 
https://lists.osgeo.org/pipermail/gdal-dev/2019-April/050052.html for proposed 
planning

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mirror.zbeng at gmail.com  Fri Apr 12 13:05:06 2019
From: mirror.zbeng at gmail.com (=?UTF-8?B?16LXldeWINeQ15zXlNeo16g=?=)
Date: Fri, 12 Apr 2019 23:05:06 +0300
Subject: [gdal-dev] Convert GEOTIFF to JPG using GDAL
Message-ID: <CAEgCAnMYw+9KQRwYHWMGNy02zVCKBQUc8OLfqtwr0iUtGYHs8A@mail.gmail.com>

I have a rgb.tif file in the configuration of GeoTiff.

I want to view it in a browser (the GeoTiff does not interest me)

I convert the file to JPG as follows:

gdal_translate -of JPEG C:\z\RGB.tif C:\z\new.jpg -co WORLDFILE=NO

The problem is that the new file is only shown in a program like ArcMap but
not in the browser.

Can someone explain to me why this is happening and does it have a solution
? Thanks

<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
Virus-free.
www.avast.com
<https://www.avast.com/sig-email?utm_medium=email&utm_source=link&utm_campaign=sig-email&utm_content=webmail>
<#DAB4FAD8-2DD7-40BB-A1B8-4E2AA1F9FDF2>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190412/fac16dd7/attachment.html>

From vasile at geo-spatial.org  Sat Apr 13 10:28:02 2019
From: vasile at geo-spatial.org (Vasile Craciunescu)
Date: Sat, 13 Apr 2019 20:28:02 +0300
Subject: [gdal-dev] FOSS4G2019: State of GDAL kind of presentation
Message-ID: <98d37c3e-86d7-06f8-0568-13f45a732e79@geo-spatial.org>

Dear GDAL developers,

FOSS4G 2019 Bucharest is just around the corner and the first clear sign 
is the imminent approach of the call for talks/workshops closing date. 
Monday, the 15th is the last day when you can send your contribution to 
the 2019 global FOSS4G. We have received great submissions so far and, 
of course, a number of them have GDAL as a topic. However, as the global 
FOSS4G is the OSGeo flagship event, the BLOC would be delighted to have 
all OSGeo projects represented in the general track program, with the 
'State of GDAL' kind of talk. If you plan to attend the Bucharest event 
this year, please consider to submit such a talk [1]. Please let me know 
if more time is required.

Warm regards,
Vasile
Chair, FOSS4G 2019

[1] https://2019.foss4g.org/call-for-papers/general-sessions/

From mikeflan at att.net  Sun Apr 14 04:42:33 2019
From: mikeflan at att.net (Mike Flannigan)
Date: Sun, 14 Apr 2019 06:42:33 -0500
Subject: [gdal-dev] Convert GEOTIFF to JPG using GDAL
In-Reply-To: <mailman.7.1555182002.14286.gdal-dev@lists.osgeo.org>
References: <mailman.7.1555182002.14286.gdal-dev@lists.osgeo.org>
Message-ID: <a9f8cc78-0088-8969-f569-546377563ac0@att.net>


Most browsers will open a JPG file.
In the browser, go to File - Open and open
the file.



Mike


On 4/13/2019 2:00 PM, gdal-dev-request at lists.osgeo.org wrote:
> Date: Fri, 12 Apr 2019 23:05:06 +0300
> From: עוז אלהרר<mirror.zbeng at gmail.com>
> To:gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Convert GEOTIFF to JPG using GDAL
> Message-ID:
> 	<CAEgCAnMYw+9KQRwYHWMGNy02zVCKBQUc8OLfqtwr0iUtGYHs8A at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> I have a rgb.tif file in the configuration of GeoTiff.
>
> I want to view it in a browser (the GeoTiff does not interest me)
>
> I convert the file to JPG as follows:
>
> gdal_translate -of JPEG C:\z\RGB.tif C:\z\new.jpg -co WORLDFILE=NO
>
> The problem is that the new file is only shown in a program like ArcMap but
> not in the browser.
>
> Can someone explain to me why this is happening and does it have a solution
> ? Thanks


From even.rouault at spatialys.com  Sun Apr 14 10:50:14 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 14 Apr 2019 19:50:14 +0200
Subject: [gdal-dev] FOSS4G2019: State of GDAL kind of presentation
In-Reply-To: <98d37c3e-86d7-06f8-0568-13f45a732e79@geo-spatial.org>
References: <98d37c3e-86d7-06f8-0568-13f45a732e79@geo-spatial.org>
Message-ID: <2983553.bdvhl6lCOP@even-i700>

Hi,

FYI I've just submitted a proposal for a 'State of GDAL' talk.

Suggestions to improve wording and/or content of the below abstract 
appreciated.

"""
After a brief introduction to the project, this talk will focus on the two 
feature-oriented releases which have occurred during the last year, GDAL 2.4 
and GDAL 2.5.
We will explore new drivers (Google Earth Engine Data API, NextGIS Web, 
GeoJSON sequence, TileDB, ...), improved drivers (BAG, GeoTIFF with Lerc and 
WebP codecs, Geospatial PDF generation…), improved algorithms (polygonal 
contouring), new virtual file systems, the integration of PROJ 6 and its 
benefits (proper database with definitions of coordinate reference systems and 
coordinate operations, support for WKT 2, late-binding transformations)
The advance of community efforts that have lead to a revamped Python testing 
suite and documentation/web site will also be presented.
"""

Even

> Dear GDAL developers,
> 
> FOSS4G 2019 Bucharest is just around the corner and the first clear sign
> is the imminent approach of the call for talks/workshops closing date.
> Monday, the 15th is the last day when you can send your contribution to
> the 2019 global FOSS4G. We have received great submissions so far and,
> of course, a number of them have GDAL as a topic. However, as the global
> FOSS4G is the OSGeo flagship event, the BLOC would be delighted to have
> all OSGeo projects represented in the general track program, with the
> 'State of GDAL' kind of talk. If you plan to attend the Bucharest event
> this year, please consider to submit such a talk [1]. Please let me know
> if more time is required.
> 
> Warm regards,
> Vasile
> Chair, FOSS4G 2019
> 
> [1] https://2019.foss4g.org/call-for-papers/general-sessions/
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From vasile at geo-spatial.org  Sun Apr 14 12:40:04 2019
From: vasile at geo-spatial.org (Vasile Craciunescu)
Date: Sun, 14 Apr 2019 22:40:04 +0300
Subject: [gdal-dev] FOSS4G2019: State of GDAL kind of presentation
In-Reply-To: <2983553.bdvhl6lCOP@even-i700>
References: <98d37c3e-86d7-06f8-0568-13f45a732e79@geo-spatial.org>
 <2983553.bdvhl6lCOP@even-i700>
Message-ID: <21422f1a-b7ba-6b4d-3dab-29929c9ab1fc@geo-spatial.org>

Great!

Bucharest is getting ready to host you guys in late August.

Regards,
Vasile

On 14/04/2019 20:50, Even Rouault wrote:
> Hi,
> 
> FYI I've just submitted a proposal for a 'State of GDAL' talk.
> 
> Suggestions to improve wording and/or content of the below abstract
> appreciated.
> 
> """
> After a brief introduction to the project, this talk will focus on the two
> feature-oriented releases which have occurred during the last year, GDAL 2.4
> and GDAL 2.5.
> We will explore new drivers (Google Earth Engine Data API, NextGIS Web,
> GeoJSON sequence, TileDB, ...), improved drivers (BAG, GeoTIFF with Lerc and
> WebP codecs, Geospatial PDF generation…), improved algorithms (polygonal
> contouring), new virtual file systems, the integration of PROJ 6 and its
> benefits (proper database with definitions of coordinate reference systems and
> coordinate operations, support for WKT 2, late-binding transformations)
> The advance of community efforts that have lead to a revamped Python testing
> suite and documentation/web site will also be presented.
> """
> 
> Even
> 
>> Dear GDAL developers,
>>
>> FOSS4G 2019 Bucharest is just around the corner and the first clear sign
>> is the imminent approach of the call for talks/workshops closing date.
>> Monday, the 15th is the last day when you can send your contribution to
>> the 2019 global FOSS4G. We have received great submissions so far and,
>> of course, a number of them have GDAL as a topic. However, as the global
>> FOSS4G is the OSGeo flagship event, the BLOC would be delighted to have
>> all OSGeo projects represented in the general track program, with the
>> 'State of GDAL' kind of talk. If you plan to attend the Bucharest event
>> this year, please consider to submit such a talk [1]. Please let me know
>> if more time is required.
>>
>> Warm regards,
>> Vasile
>> Chair, FOSS4G 2019
>>
>> [1] https://2019.foss4g.org/call-for-papers/general-sessions/
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 


-- 
---------------------------------------------------------------------
Vasile Crăciunescu
geo-spatial.org: An elegant place for sharing geoKnowledge & geoData
http://www.geo-spatial.org
http://tech.groups.yahoo.com/group/geo-spatial

From simon.eves at omnisci.com  Mon Apr 15 11:34:24 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Mon, 15 Apr 2019 11:34:24 -0700
Subject: [gdal-dev] Determine which KML file inside a KMZ a Layer comes from?
Message-ID: <CAJf0KTRh8NmNcS3Mcnof07E9VE1uT58v9w2+Unjf=T0kmW2UAA@mail.gmail.com>

I have a KMZ which contains five KML files (not including the top-level
doc.kml), most of which contains a single-digit number of layers, each with
a large number (hundreds to thousands) of features.

When I open the KMZ with openGDALDataset() and then use
OGRDataSource::GetLayers() (the new variant which returns a collection) I
get a merged list of all the layers from all the KMLs.

I am importing the data and grouping it by layer, with a single global
prefix provided by the user, but as some of the KMLs have layers which have
the same name as layers in another KML, the resulting merged set of layer
names may not all be unique.

Is there any way to determine which KML a particular layer came from, or to
get the list of KML files and then iterate the layers for each in turn?

Also, one of those five KMLs actually has 1720 layers, each of which only
contains one feature. As an aside, is this common?

Thanks in advance!

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
OmniSci, formerly named MapD


e: simon.eves at omnisci.com | c:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190415/3df468ac/attachment.html>

From even.rouault at spatialys.com  Mon Apr 15 12:23:05 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Apr 2019 21:23:05 +0200
Subject: [gdal-dev] Determine which KML file inside a KMZ a Layer comes
	from?
In-Reply-To: <CAJf0KTRh8NmNcS3Mcnof07E9VE1uT58v9w2+Unjf=T0kmW2UAA@mail.gmail.com>
References: <CAJf0KTRh8NmNcS3Mcnof07E9VE1uT58v9w2+Unjf=T0kmW2UAA@mail.gmail.com>
Message-ID: <4173975.fJeypkvFTI@even-i700>

Simon,

> I have a KMZ which contains five KML files (not including the top-level
> doc.kml), most of which contains a single-digit number of layers, each with
> a large number (hundreds to thousands) of features.
> 
> When I open the KMZ with openGDALDataset() and then use
> OGRDataSource::GetLayers() (the new variant which returns a collection) I
> get a merged list of all the layers from all the KMLs.
> 
> I am importing the data and grouping it by layer, with a single global
> prefix provided by the user, but as some of the KMLs have layers which have
> the same name as layers in another KML, the resulting merged set of layer
> names may not all be unique.
> 
> Is there any way to determine which KML a particular layer came from, or to
> get the list of KML files and then iterate the layers for each in turn?

You can list the kml files with VSIReadDir("/vsizip/your.kmz"), and open each 
of them individually.

> 
> Also, one of those five KMLs actually has 1720 layers, each of which only
> contains one feature. As an aside, is this common?

Yes, this can happen sometimes if each feature in a KML Folder. The 
hierarchical nature of KML files is sometimes hard to translate in relevant 
OGR layers.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From simon.eves at omnisci.com  Mon Apr 15 13:09:44 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Mon, 15 Apr 2019 13:09:44 -0700
Subject: [gdal-dev] Determine which KML file inside a KMZ a Layer comes
	from?
In-Reply-To: <4173975.fJeypkvFTI@even-i700>
References: <CAJf0KTRh8NmNcS3Mcnof07E9VE1uT58v9w2+Unjf=T0kmW2UAA@mail.gmail.com>
 <4173975.fJeypkvFTI@even-i700>
Message-ID: <CAJf0KTSv=Pib_q7rHfjKGi4kSdqfBQKL9NKa-m2HnHCyXEbzYQ@mail.gmail.com>

Even Rouault <even.rouault at spatialys.com> wrote:

>
> You can list the kml files with VSIReadDir("/vsizip/your.kmz"), and open
> each
> of them individually.
>

Makes sense. Thanks!

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
OmniSci, formerly named MapD


e: simon.eves at omnisci.com | c:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190415/e4e6834a/attachment.html>

From chris.marsh at usask.ca  Wed Apr 17 14:14:28 2019
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Wed, 17 Apr 2019 21:14:28 +0000
Subject: [gdal-dev] =?utf-8?q?GDAL_compile_error=3A_expected_initializer_b?=
 =?utf-8?b?ZWZvcmUg4oCYX19hdHRyaWJ1dGVfYWxsb2Nfc2l6ZV9f4oCZ?=
Message-ID: <CAFgDerHh8m0jWdrz3nYpRKVoRUG6ya2+pRuGkvrh8k6ei8=7PA@mail.gmail.com>

Hi,
I'm trying to build GDAL 2.4.1 with gcc 8.3.0 on a CentOS 7 system. However, I get the below error. Any ideas on how to proceed? This works fine with older gcc, e.g., 5.4

Cheers
Chris


$ uname -a
Linux gra-login3 3.10.0-862.14.4.el7.x86_64 #1 SMP Wed Sep 26 15:12:11 UTC 2018 x86_64 GNU/Linux

configure command:
CXXFLAGS=-DDONT_DEPRECATE_SPRINTF ./configure  --prefix=${CMAKE_BINARY_DIR}/lib/gdal --with-static-proj4=${CMAKE_BINARY_DIR}/lib/proj4 --without-hdf5 --without-netcdf

The error:

bin/sh /home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/libtool --mode=compile --silent --tag=CXX g++ -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/port -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/gcore -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/alg -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/ogr -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/ogr/ogrsf_frmts -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/gnm -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/apps -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -DDONT_DEPRECATE_SPRINTF  -Wall -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time -Wnull-dereference -Wduplicated-cond -Wextra-semi -Wfloat-conversion -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override -Wimplicit-fallthrough  -I..  -I/usr/include  -DGNM_ENABLED -I/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/port -I/cvmfs/soft.computecanada.ca/nix/store/k8yicfria8gwr06km6qda1mdm9kz1h7r-openjpeg-2.3.0-dev/include/openjpeg-2.3<http://soft.computecanada.ca/nix/store/k8yicfria8gwr06km6qda1mdm9kz1h7r-openjpeg-2.3.0-dev/include/openjpeg-2.3>  -DGDAL_COMPILATION -DHAVE_PCRE -DSQLITE_HAS_COLUMN_METADATA -c -o ../o/ogrsqliteexecutesql.lo ogrsqliteexecutesql.cpp
In file included from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/cstdlib:75<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/cstdlib:75>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/ext/string_conversions.h:41<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/ext/string_conversions.h:41>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/bits/basic_string.h:6400<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/bits/basic_string.h:6400>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/string:52<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/string:52>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/stdexcept:39<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/stdexcept:39>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/array:39<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/array:39>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/tuple:39<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/tuple:39>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/bits/stl_map.h:63<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/bits/stl_map.h:63>,
                 from /cvmfs/soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/map:61<http://soft.computecanada.ca/nix/var/nix/profiles/gcc-8.3.0/include/c++/8.3.0/map:61>,
                 from ogr_sqlite.h:35,
                 from ogrsqliteexecutesql.cpp:29:
/cvmfs/soft.computecanada.ca/nix/var/nix/profiles/16.09/include/stdlib.h:471:35<http://soft.computecanada.ca/nix/var/nix/profiles/16.09/include/stdlib.h:471:35>:
      __THROW __attribute_malloc__ __attribute_alloc_size__ ((2)) __wur;
                                   ^~~~~~~~~~~~~~~~~~~~~~~~
make[3]: *** [../../../GDALmake.opt:670: ../o/ogrsqliteexecutesql.lo] Error 1
make[3]: Leaving directory '/home/cmarsh/build-test/lib/GDAL-prefix/src/GDAL/ogr/ogrsf_frmts/sqlite'

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190417/26782daf/attachment.html>

From even.rouault at spatialys.com  Wed Apr 17 14:26:34 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Apr 2019 23:26:34 +0200
Subject: [gdal-dev]
	=?utf-8?q?GDAL_compile_error=3A_expected_initializer_b?=
	=?utf-8?b?ZWZvcmUg4oCYX19hdHRyaWJ1dGVfYWxsb2Nfc2l6ZV9f4oCZ?=
In-Reply-To: <CAFgDerHh8m0jWdrz3nYpRKVoRUG6ya2+pRuGkvrh8k6ei8=7PA@mail.gmail.com>
References: <CAFgDerHh8m0jWdrz3nYpRKVoRUG6ya2+pRuGkvrh8k6ei8=7PA@mail.gmail.com>
Message-ID: <1783909.CFWGXISuP7@even-i700>

You didn't actually paste the error message itself, but I guess it must be
'error: expected ‘,’ or ‘;’ before ‘__attribute_alloc_size__’' from hits found 
by

https://www.google.com/search?q=__attribute_alloc_size__

This error seems to occur in various other contexts. Perhaps something due to 
your particular build chain rather than GDAL itself.	Of course if you find a 
reasonable fix to upstream in GDAL, that'd be welcome.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From chris.marsh at usask.ca  Wed Apr 17 14:32:21 2019
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Wed, 17 Apr 2019 21:32:21 +0000
Subject: [gdal-dev]
 =?utf-8?q?GDAL_compile_error=3A_expected_initializer_b?=
 =?utf-8?b?ZWZvcmUg4oCYX19hdHRyaWJ1dGVfYWxsb2Nfc2l6ZV9f4oCZ?=
In-Reply-To: <1783909.CFWGXISuP7@even-i700>
References: <CAFgDerHh8m0jWdrz3nYpRKVoRUG6ya2+pRuGkvrh8k6ei8=7PA@mail.gmail.com>
 <1783909.CFWGXISuP7@even-i700>
Message-ID: <CAFgDerFr=YSfu9qQwigtsyfBh7=Y-goE4aFCUFX=W76V+7jt3w@mail.gmail.com>

That's...odd. I don't quite know what happened there, sorry. here is the full error

/cvmfs/soft.computecanada.ca/nix/var/nix/profiles/16.09/include/stdlib.h:471:35<http://soft.computecanada.ca/nix/var/nix/profiles/16.09/include/stdlib.h:471:35>: error: expected initializer before ‘__attribute_alloc_size__’
      __THROW __attribute_malloc__ __attribute_alloc_size__ ((2)) __wur;
                                   ^~~~~~~~~~~~~~~~~~~~~~~~

I had seen the 'error: expected ‘,’ or ‘;’ before ‘__attribute_alloc_size__’' posts, but this seems to be different.

I take it then that you've never run into this before?


On Wed, Apr 17, 2019 at 3:26 PM Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:
You didn't actually paste the error message itself, but I guess it must be
'error: expected ‘,’ or ‘;’ before ‘__attribute_alloc_size__’' from hits found
by

https://www.google.com/search?q=__attribute_alloc_size__

This error seems to occur in various other contexts. Perhaps something due to
your particular build chain rather than GDAL itself.    Of course if you find a
reasonable fix to upstream in GDAL, that'd be welcome.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190417/6355cfc5/attachment-0001.html>

From jdaniel at etresoft.com  Wed Apr 17 20:30:36 2019
From: jdaniel at etresoft.com (John Daniel)
Date: Thu, 18 Apr 2019 03:30:36 +0000
Subject: [gdal-dev] How to run autotest
In-Reply-To: <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2071155.c55yWmvIeG@even-i700>
 <4f906329-e7d4-1354-5d4e-cfb876febb1e@oracle.com>
 <2307358.d1F8GuK5he@even-i700>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
Message-ID: <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>

Sorry for the duplicate message. I'm not sure what e-mail account I had used for this list.

I am seeing something very similar. Judging from your /scratch/SDK paths, it looks like you have a similar setup to what I am attempting. 

Primarily I am trying to build on the Mac. I can run tests on the Mac, but a few of them fail deep inside SQLite:
0   ???                           	000000000000000000 0 + 0
1   libsqlite3.dylib              	0x00007fff67465441 dbMallocRawFinish + 17
2   libsqlite3.dylib              	0x00007fff6737f666 sqlite3FindFunction + 886
3   libsqlite3.dylib              	0x00007fff6737fb23 sqlite3CreateFunc + 499
4   libsqlite3.dylib              	0x00007fff673807c8 sqlite3_create_function_v2 + 488
5   libspatialite.7.dylib         	0x000000010e3a82d0 register_spatialite_sql_functions + 96
6   libspatialite.7.dylib         	0x000000010e3f469e spatialite_init_ex + 110
7   libgdal.20.dylib              	0x000000010ba9a312 OGRSQLiteBaseDataSource::InitNewSpatialite() + 194

So, I ran my build scripts on Linux to see how it would work there. On Linux, I get something very similar to what you have:

pytest
ImportError while loading conftest '/home/parallels/OS-GIS/sources/GDAL/gdaltest/autotest/conftest.py'.
../../../../build/python/lib/python2.7/site-packages/six.py:709: in exec_
   exec("""exec _code_ in _globs_, _locs_""")
/Users/jdaniel/Programming/OS-GIS/sources/GDAL/gdaltest/autotest/conftest.py:9: in <module>
   ???
../../../../build/python/lib/python2.7/site-packages/six.py:709: in exec_
   exec("""exec _code_ in _globs_, _locs_""")
../../../../platforms/linux/x86_64/gdal/lib/python2.7/site-packages/gdal.py:2: in <module>
   from osgeo.gdal import deprecation_warn
../../../../platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/__init__.py:21: in <module>
   _gdal = swig_import_helper()
../../../../platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/__init__.py:17: in swig_import_helper
   _mod = imp.load_module('_gdal', fp, pathname, description)
E   ImportError: /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/_gdal.so: undefined symbol: CPLGetErrorCounter

I also have my own Python build. 

I am just now getting back to my GDAL work after a couple of years. I have run, and successfully tested, these build scripts with an earlier version of GDAL and supporting libraries. I think I will go back to that previous setup and double-check. I have some new code I would like to contribute this year. I have a replacement for GEOS that I plan to use to avoid GPL restrictions. But I'm going to need those test scripts for that.

John Daniel
Etresoft, Inc.

> On Apr 9, 2019, at 11:33 AM, Fengting Chen <fengting.chen at oracle.com> wrote:
> 
> gdalinfo and gdal_translate are working fine. just pytest failed with the same error.
> 
> Here is my configure:
> 
> ./configure --prefix=${PREFIX} \
>  --without-libtool \
>  --disable-rpath \
>  --with-libz=internal \
>  --with-png=internal \
>  --with-libtiff=internal \
>  --with-geotiff=internal \
>  --with-jpeg=internal \
>  --with-gif=internal \
>  --without-pg \
>  --without-sqlite3 \
>  --without-expat \
>  --without-odbc \
>  --with-curl=/usr/bin/curl-config \
>  --without-perl \
>  --without-pcre \
>  --with-hdfs=no \
>  --with-python=/scratch/SDK/Python-2.7.5/dist/bin/python \
>  --with-proj=/scratch/SDK/proj-6.0.0/dist
> 
> After that:
> 
> make clean
> make -j8 -s
> cd apps; make -s test_ogrsf; cd ..
> 
> -Fengting
> 
> On 4/9/2019 4:22 AM, Even Rouault wrote:
>> On lundi 8 avril 2019 17:20:45 CEST Fengting Chen wrote:
>>> I rebuilt GDAl with python bindings without errors. Now I got a
>>> different error:
>>> 
>>> ImportError while loading conftest
>>> '/scratch/gdal/gdal/autotest/conftest.py'.
>>> /home/fechen/.local/lib/python2.7/site-packages/six.py:709: in exec_
>>>     exec("""exec _code_ in _globs_, _locs_""")
>>> conftest.py:9: in <module>
>>>     from osgeo import gdal
>>> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:21: in
>>> <module>
>>>     _gdal = swig_import_helper()
>>> ../gdal/swig/python/build/lib.linux-x86_64-2.7/osgeo/__init__.py:17: in
>>> swig_import_helper
>>>     _mod = imp.load_module('_gdal', fp, pathname, description)
>>> E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined
>>> symbol: _Z17CPLHaveRuntimeAVXv
>>> 
>>> Any idea why  libgdal.so.20 has undefined symbol?
>> First time I see this error
>> Do you get this also when using gdalinfo, gdal_translate, etc ?
>> If so, consider doing a clean build. It might be that you have attempted
>> several builds of GDAL with different options after ./configure
>> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



From even.rouault at spatialys.com  Thu Apr 18 02:17:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Apr 2019 11:17:53 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
 <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>
Message-ID: <4423378.P32z12xsDR@even-i700>

> E   ImportError:
> /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packa
> ges/osgeo/_gdal.so: undefined symbol: CPLGetErrorCounter

Try

ldd /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/_gdal.so

and check which libgdal.so it links to. It is likely that it is not the right one.

You'll have to adjust your LD_LIBRARY_PATH then.
Sourcing scripts/setdevenv.sh should do that for you


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jdaniel at etresoft.com  Thu Apr 18 06:59:59 2019
From: jdaniel at etresoft.com (John Daniel)
Date: Thu, 18 Apr 2019 13:59:59 +0000
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4423378.P32z12xsDR@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
 <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>
 <4423378.P32z12xsDR@even-i700>
Message-ID: <AA59C90D-A057-4AA2-A29C-DCAA0DA76109@etresoft.com>

That's it. I didn't expect gdal to already be installed. I should have used a different distro for this.

John Daniel
Etresoft, Inc.

> On Apr 18, 2019, at 5:17 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
>> E   ImportError:
>> /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packa
>> ges/osgeo/_gdal.so: undefined symbol: CPLGetErrorCounter
> 
> Try
> 
> ldd /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/_gdal.so
> 
> and check which libgdal.so it links to. It is likely that it is not the right one.
> 
> You'll have to adjust your LD_LIBRARY_PATH then.
> Sourcing scripts/setdevenv.sh should do that for you
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From fengting.chen at oracle.com  Thu Apr 18 09:38:43 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 18 Apr 2019 12:38:43 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4423378.P32z12xsDR@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
 <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>
 <4423378.P32z12xsDR@even-i700>
Message-ID: <4b489983-a9df-380f-17de-ebcff05121da@oracle.com>

In my case, this didn't work.

1. When I ran the GDAL build, I always use "make clean" to clean the old 
build.  And I did run scripts/setdevenv.sh before running the test.

/>which gdalinfo//
///scratch/gdal/gdal/gdal/apps/gdalinfo//
/

/>gdalinfo --version//
//GDAL 2.5.0dev-94f370c-dirty, released 2019/04/01/

2. gdalinfo and gdaltranslate are working without error. Only pytest failed:

/E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined 
symbol: _Z17CPLHaveRuntimeAVXv/

3. I checked libgdal.so.so, it is missing that symbol:

/>nm  /scratch/gdal/gdal/gdal/.libs/libgdal.so.20 |grep 
_Z17CPLHaveRuntimeAVXv//
//                 U _Z17CPLHaveRuntimeAVXv/

It seems that my manual test of gdalinfo and gdal_translate didn't use 
that symbol. Anyone know which library that symbol came from?

Thanks,

-Fengting

On 4/18/2019 5:17 AM, Even Rouault wrote:
>> E   ImportError:
>> /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packa
>> ges/osgeo/_gdal.so: undefined symbol: CPLGetErrorCounter
> Try
>
> ldd /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/_gdal.so
>
> and check which libgdal.so it links to. It is likely that it is not the right one.
>
> You'll have to adjust your LD_LIBRARY_PATH then.
> Sourcing scripts/setdevenv.sh should do that for you
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190418/a50711d8/attachment.html>

From jdaniel at etresoft.com  Thu Apr 18 09:41:41 2019
From: jdaniel at etresoft.com (John Daniel)
Date: Thu, 18 Apr 2019 16:41:41 +0000
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4423378.P32z12xsDR@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <36f18511-204b-3436-5011-c80c343340c8@oracle.com>
 <4167C8CC-1AD6-49A5-A7EF-F560FEDCBE0C@etresoft.com>
 <4423378.P32z12xsDR@even-i700>
Message-ID: <3C68E577-5AFD-4F2E-940D-D77E1140DF53@etresoft.com>

Even,
scripts/setdevenv.sh did fix the python problem for me.

However, I get a very similar segfault in the test scripts that I get on the Mac. It seems related to SQLite and SpatiaLite. I'm going to try to rebuild with an older set of GDAL+libs that has worked in the past. 

Here is the backtrace if anyone is curious. Unless anyone recognizes a known issue, I'm assuming this is my problem to work out from here.

Core was generated by `/home/parallels/OS-GIS/build/python/bin/python2.7 /home/parallels/OS-GIS/build/'.
Program terminated with signal SIGSEGV, Segmentation fault.
#0  0x00007f7ba2872378 in spatialite_init ()
   from /home/parallels/OS-GIS/platforms/linux/x86_64/lib/libspatialite.so.5
(gdb) bt
#0  0x00007f7ba2872378 in spatialite_init ()
   from /home/parallels/OS-GIS/platforms/linux/x86_64/lib/libspatialite.so.5
#1  0x00007f7ba7ee69d0 in OGRSQLiteInitOldSpatialite() ()
   from /tmp/gdal/gdal/.libs/libgdal.so.20
#2  0x00007f7ba7ee8332 in OGRSQLiteDataSource::Create(char const*, char**) ()
   from /tmp/gdal/gdal/.libs/libgdal.so.20
#3  0x00007f7ba7ef323f in OGRSQLiteExecuteSQL(GDALDataset*, char const*, OGRGeometry*, char const*) () from /tmp/gdal/gdal/.libs/libgdal.so.20
#4  0x00007f7ba7a012ef in GDALDataset::ExecuteSQL(char const*, OGRGeometry*, char const*, swq_select_parse_options*) () from /tmp/gdal/gdal/.libs/libgdal.so.20
#5  0x00007f7ba7a01298 in GDALDataset::ExecuteSQL(char const*, OGRGeometry*, char const*) () from /tmp/gdal/gdal/.libs/libgdal.so.20
#6  0x00007f7ba7d2fc3f in GDALGeoPackageDataset::ExecuteSQL(char const*, OGRGeometry*, char const*) () from /tmp/gdal/gdal/.libs/libgdal.so.20
#7  0x00007f7ba7c72f3b in OGR_DS_ExecuteSQL ()
   from /tmp/gdal/gdal/.libs/libgdal.so.20
#8  0x00007f7b9b608a2c in OGRDataSourceShadow_ExecuteSQL (
    dialect=0x7f7b9a669dac "INDIRECT_SQLITE", spatialFilter=0x0, 
    statement=0x7f7b9a66ced4 "SELECT ogr_version()", self=0x55f6a0a5ada0)
    at extensions/ogr_wrap.cpp:3974
#9  _wrap_DataSource_ExecuteSQL (args=<optimized out>, kwargs=<optimized out>)
    at extensions/ogr_wrap.cpp:9849
#10 0x000055f6988bc3c8 in ext_do_call (nk=<optimized out>, na=1, 
---Type <return> to continue, or q <return> to quit---
    flags=<optimized out>, pp_stack=0x7fffb12f2e00, func=0x7f7b9b87b2d8)
    at Python/ceval.c:4663
#11 PyEval_EvalFrameEx (f=f at entry=0x7f7b998485d8, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#12 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a0b1b7e8, kwcount=1, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#13 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f2fd8, 
    func=0x7f7b9b33ccf8) at Python/ceval.c:4447
#14 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f2fd8)
    at Python/ceval.c:4372
#15 PyEval_EvalFrameEx (f=f at entry=0x55f6a0b1b620, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#16 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7baec3d068, argcount=<optimized out>, 
    kws=kws at entry=0x7f7baec3d068, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#17 0x000055f69893aaad in function_call (func=0x7f7bab6329b0, 
    arg=0x7f7baec3d050, kw=0x7f7b9a772398) at Objects/funcobject.c:523
#18 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7bab6329b0, 
---Type <return> to continue, or q <return> to quit---
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b9a772398)
    at Objects/abstract.c:2547
#19 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f3260, func=0x7f7bab6329b0)
    at Python/ceval.c:4666
#20 PyEval_EvalFrameEx (f=f at entry=0x55f6a0cacd20, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#21 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b971b8528, argcount=<optimized out>, 
    kws=kws at entry=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#22 0x000055f69893a9c9 in function_call (func=0x7f7ba9223320, 
    arg=0x7f7b971b8510, kw=0x0) at Objects/funcobject.c:523
#23 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9223320, 
    arg=arg at entry=0x7f7b971b8510, kw=kw at entry=0x0) at Objects/abstract.c:2547
#24 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f34e0, func=0x7f7ba9223320)
    at Python/ceval.c:4666
#25 PyEval_EvalFrameEx (f=f at entry=0x55f69ffd3550, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#26 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
---Type <return> to continue, or q <return> to quit---
    argcount=<optimized out>, kws=0x55f69b09aed8, kwcount=1, 
    defs=0x7f7baac4b068, defcount=1, closure=0x0) at Python/ceval.c:3584
#27 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f36b8, 
    func=0x7f7baacc6b18) at Python/ceval.c:4447
#28 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f36b8)
    at Python/ceval.c:4372
#29 PyEval_EvalFrameEx (f=f at entry=0x55f69b09ad30, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#30 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a0ae8bc8, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#31 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f3898, 
    func=0x7f7ba91e7758) at Python/ceval.c:4447
#32 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f3898)
    at Python/ceval.c:4372
#33 PyEval_EvalFrameEx (f=f at entry=0x55f6a0ae8a10, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#34 0x000055f6988bf4d2 in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=4, pp_stack=0x7fffb12f39b8, func=0x7f7baac4e0c8)
    at Python/ceval.c:4437
---Type <return> to continue, or q <return> to quit---
#35 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f39b8)
    at Python/ceval.c:4372
#36 PyEval_EvalFrameEx (f=f at entry=0x55f69b07e200, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#37 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b97641ce8, argcount=<optimized out>, 
    kws=kws at entry=0x7f7b97172608, kwcount=1, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#38 0x000055f69893aaad in function_call (func=0x7f7baac4cb90, 
    arg=0x7f7b97641cd0, kw=0x7f7b971176e0) at Objects/funcobject.c:523
#39 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7baac4cb90, 
    arg=arg at entry=0x7f7b97641cd0, kw=kw at entry=0x7f7b971176e0)
    at Objects/abstract.c:2547
#40 0x000055f69882746c in instancemethod_call (func=0x7f7baac4cb90, 
    arg=0x7f7b97641cd0, kw=0x7f7b971176e0) at Objects/classobject.c:2602
#41 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7b97654730, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b971176e0)
    at Objects/abstract.c:2547
#42 0x000055f698889a7a in slot_tp_call (self=0x7f7ba9183190, 
    args=0x7f7baec3d050, kwds=0x7f7b971176e0) at Objects/typeobject.c:5546
#43 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9183190, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b971176e0)
---Type <return> to continue, or q <return> to quit---
    at Objects/abstract.c:2547
#44 0x000055f6988b7bce in do_call (nk=<optimized out>, na=<optimized out>, 
    pp_stack=0x7fffb12f3f18, func=0x7f7ba9183190) at Python/ceval.c:4569
#45 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f3f18)
    at Python/ceval.c:4374
#46 PyEval_EvalFrameEx (f=f at entry=0x55f6a0be0c40, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#47 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a0bdfc60, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#48 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f40f8, 
    func=0x7f7ba92268c0) at Python/ceval.c:4447
#49 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f40f8)
    at Python/ceval.c:4372
#50 PyEval_EvalFrameEx (f=f at entry=0x55f6a0bdfac0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#51 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7ba8c547a8, argcount=<optimized out>, 
    kws=kws at entry=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
---Type <return> to continue, or q <return> to quit---
#52 0x000055f69893a9c9 in function_call (func=0x7f7ba920e140, 
    arg=0x7f7ba8c54790, kw=0x0) at Objects/funcobject.c:523
#53 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba920e140, 
    arg=arg at entry=0x7f7ba8c54790, kw=kw at entry=0x0) at Objects/abstract.c:2547
#54 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f4380, func=0x7f7ba920e140)
    at Python/ceval.c:4666
#55 PyEval_EvalFrameEx (f=f at entry=0x55f6a01b26a0, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#56 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69b077a68, kwcount=1, 
    defs=0x7f7baac4b068, defcount=1, closure=0x0) at Python/ceval.c:3584
#57 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f4558, 
    func=0x7f7baacc6b18) at Python/ceval.c:4447
#58 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f4558)
    at Python/ceval.c:4372
#59 PyEval_EvalFrameEx (f=f at entry=0x55f69b0778c0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#60 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a0cae0c8, kwcount=0, defs=0x0, 
---Type <return> to continue, or q <return> to quit---
    defcount=0, closure=0x0) at Python/ceval.c:3584
#61 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f4738, 
    func=0x7f7ba91e7758) at Python/ceval.c:4447
#62 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f4738)
    at Python/ceval.c:4372
#63 PyEval_EvalFrameEx (f=f at entry=0x55f6a0cadf10, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#64 0x000055f6988bf4d2 in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=4, pp_stack=0x7fffb12f4858, func=0x7f7baac4e0c8)
    at Python/ceval.c:4437
#65 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f4858)
    at Python/ceval.c:4372
#66 PyEval_EvalFrameEx (f=f at entry=0x55f69b07a790, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#67 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b976414a8, argcount=<optimized out>, 
    kws=kws at entry=0x7f7b97172578, kwcount=1, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#68 0x000055f69893aaad in function_call (func=0x7f7baac4cb90, 
    arg=0x7f7b97641490, kw=0x7f7bab63ac58) at Objects/funcobject.c:523
#69 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7baac4cb90, 
---Type <return> to continue, or q <return> to quit---
    arg=arg at entry=0x7f7b97641490, kw=kw at entry=0x7f7bab63ac58)
    at Objects/abstract.c:2547
#70 0x000055f69882746c in instancemethod_call (func=0x7f7baac4cb90, 
    arg=0x7f7b97641490, kw=0x7f7bab63ac58) at Objects/classobject.c:2602
#71 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7b99844230, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7bab63ac58)
    at Objects/abstract.c:2547
#72 0x000055f698889a7a in slot_tp_call (self=0x7f7ba9183390, 
    args=0x7f7baec3d050, kwds=0x7f7bab63ac58) at Objects/typeobject.c:5546
#73 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9183390, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7bab63ac58)
    at Objects/abstract.c:2547
#74 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f4dc0, func=0x7f7ba9183390)
    at Python/ceval.c:4666
#75 PyEval_EvalFrameEx (f=f at entry=0x55f6a0c4d300, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#76 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69b08f0f0, kwcount=0, defs=0x0, 
    defcount=0, closure=0x7f7b970f3410) at Python/ceval.c:3584
#77 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f4f98, 
---Type <return> to continue, or q <return> to quit---
    func=0x7f7b970ee140) at Python/ceval.c:4447
#78 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f4f98)
    at Python/ceval.c:4372
#79 PyEval_EvalFrameEx (f=f at entry=0x55f69b08ef30, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#80 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69b086938, kwcount=2, 
    defs=0x7f7ba920a5a8, defcount=1, closure=0x0) at Python/ceval.c:3584
#81 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f5178, 
    func=0x7f7ba920e5f0) at Python/ceval.c:4447
#82 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f5178)
    at Python/ceval.c:4372
#83 PyEval_EvalFrameEx (f=f at entry=0x55f69b086770, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#84 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b97658728, argcount=<optimized out>, 
    kws=kws at entry=0x7f7baec3d068, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#85 0x000055f69893aaad in function_call (func=0x7f7ba920e410, 
    arg=0x7f7b97658710, kw=0x7f7b9710b050) at Objects/funcobject.c:523
---Type <return> to continue, or q <return> to quit---
#86 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba920e410, 
    arg=arg at entry=0x7f7b97658710, kw=kw at entry=0x7f7b9710b050)
    at Objects/abstract.c:2547
#87 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=2, 
    flags=<optimized out>, pp_stack=0x7fffb12f5400, func=0x7f7ba920e410)
    at Python/ceval.c:4666
#88 PyEval_EvalFrameEx (f=f at entry=0x55f69b0767f0, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#89 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a01afc70, kwcount=0, 
    defs=0x7f7ba9203ce8, defcount=1, closure=0x0) at Python/ceval.c:3584
#90 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f55d8, 
    func=0x7f7ba920e320) at Python/ceval.c:4447
#91 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f55d8)
    at Python/ceval.c:4372
#92 PyEval_EvalFrameEx (f=f at entry=0x55f6a01afaa0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#93 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f6a0caf668, kwcount=1, 
    defs=0x7f7ba9306d58, defcount=2, closure=0x0) at Python/ceval.c:3584
---Type <return> to continue, or q <return> to quit---
#94 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f57b8, 
    func=0x7f7ba9208f50) at Python/ceval.c:4447
#95 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f57b8)
    at Python/ceval.c:4372
#96 PyEval_EvalFrameEx (f=f at entry=0x55f6a0caf4d0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#97 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b976a38d8, argcount=<optimized out>, 
    kws=kws at entry=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#98 0x000055f69893a9c9 in function_call (func=0x7f7ba9208ed8, 
    arg=0x7f7b976a38c0, kw=0x0) at Objects/funcobject.c:523
#99 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9208ed8, 
    arg=arg at entry=0x7f7b976a38c0, kw=kw at entry=0x0) at Objects/abstract.c:2547
#100 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f5a40, func=0x7f7ba9208ed8)
    at Python/ceval.c:4666
#101 PyEval_EvalFrameEx (f=f at entry=0x55f69ae74120, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#102 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
---Type <return> to continue, or q <return> to quit---
    argcount=<optimized out>, kws=0x55f6a0920fe8, kwcount=1, 
    defs=0x7f7baac4b068, defcount=1, closure=0x0) at Python/ceval.c:3584
#103 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f5c18, 
    func=0x7f7baacc6b18) at Python/ceval.c:4447
#104 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f5c18)
    at Python/ceval.c:4372
#105 PyEval_EvalFrameEx (f=f at entry=0x55f6a0920e40, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#106 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x7f7b9715b208, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#107 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f5df8, 
    func=0x7f7ba91e7758) at Python/ceval.c:4447
#108 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f5df8)
    at Python/ceval.c:4372
#109 PyEval_EvalFrameEx (f=f at entry=0x7f7b9715b050, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#110 0x000055f6988bf4d2 in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=4, pp_stack=0x7fffb12f5f18, func=0x7f7baac4e0c8)
    at Python/ceval.c:4437
---Type <return> to continue, or q <return> to quit---
#111 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f5f18)
    at Python/ceval.c:4372
#112 PyEval_EvalFrameEx (f=f at entry=0x55f6a0c69730, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#113 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7b9bb04368, argcount=<optimized out>, 
    kws=kws at entry=0x7f7b977084e0, kwcount=2, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#114 0x000055f69893aaad in function_call (func=0x7f7baac4cb90, 
    arg=0x7f7b9bb04350, kw=0x7f7b9a79a280) at Objects/funcobject.c:523
#115 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7baac4cb90, 
    arg=arg at entry=0x7f7b9bb04350, kw=kw at entry=0x7f7b9a79a280)
    at Objects/abstract.c:2547
#116 0x000055f69882746c in instancemethod_call (func=0x7f7baac4cb90, 
    arg=0x7f7b9bb04350, kw=0x7f7b9a79a280) at Objects/classobject.c:2602
#117 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7b9ae4a1e0, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b9a79a280)
    at Objects/abstract.c:2547
#118 0x000055f698889a7a in slot_tp_call (self=0x7f7ba9183610, 
    args=0x7f7baec3d050, kwds=0x7f7b9a79a280) at Objects/typeobject.c:5546
#119 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9183610, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b9a79a280)
---Type <return> to continue, or q <return> to quit---
    at Objects/abstract.c:2547
#120 0x000055f6988b7bce in do_call (nk=<optimized out>, na=<optimized out>, 
    pp_stack=0x7fffb12f6478, func=0x7f7ba9183610) at Python/ceval.c:4569
#121 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f6478)
    at Python/ceval.c:4374
#122 PyEval_EvalFrameEx (f=f at entry=0x7f7b979dade0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#123 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7ba8bf9da8, argcount=<optimized out>, 
    kws=kws at entry=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#124 0x000055f69893a9c9 in function_call (func=0x7f7ba9211398, 
    arg=0x7f7ba8bf9d90, kw=0x0) at Objects/funcobject.c:523
#125 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9211398, 
    arg=arg at entry=0x7f7ba8bf9d90, kw=kw at entry=0x0) at Objects/abstract.c:2547
#126 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f6700, func=0x7f7ba9211398)
    at Python/ceval.c:4666
#127 PyEval_EvalFrameEx (f=f at entry=0x55f69c702990, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#128 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
---Type <return> to continue, or q <return> to quit---
    argcount=<optimized out>, kws=0x55f69c449868, kwcount=1, 
    defs=0x7f7baac4b068, defcount=1, closure=0x0) at Python/ceval.c:3584
#129 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f68d8, 
    func=0x7f7baacc6b18) at Python/ceval.c:4447
#130 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f68d8)
    at Python/ceval.c:4372
#131 PyEval_EvalFrameEx (f=f at entry=0x55f69c4496c0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#132 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69c74a4b8, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#133 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f6ab8, 
    func=0x7f7ba91e7758) at Python/ceval.c:4447
#134 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f6ab8)
    at Python/ceval.c:4372
#135 PyEval_EvalFrameEx (f=f at entry=0x55f69c74a300, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#136 0x000055f6988bf4d2 in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=4, pp_stack=0x7fffb12f6bd8, func=0x7f7baac4e0c8)
    at Python/ceval.c:4437
---Type <return> to continue, or q <return> to quit---
#137 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f6bd8)
    at Python/ceval.c:4372
#138 PyEval_EvalFrameEx (f=f at entry=0x7f7b97a26da8, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#139 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7ba8bf9ca8, argcount=<optimized out>, 
    kws=kws at entry=0x7f7b9b35d5c0, kwcount=1, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#140 0x000055f69893aaad in function_call (func=0x7f7baac4cb90, 
    arg=0x7f7ba8bf9c90, kw=0x7f7b9ae49b40) at Objects/funcobject.c:523
#141 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7baac4cb90, 
    arg=arg at entry=0x7f7ba8bf9c90, kw=kw at entry=0x7f7b9ae49b40)
    at Objects/abstract.c:2547
#142 0x000055f69882746c in instancemethod_call (func=0x7f7baac4cb90, 
    arg=0x7f7ba8bf9c90, kw=0x7f7b9ae49b40) at Objects/classobject.c:2602
#143 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7b9ae4a140, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b9ae49b40)
    at Objects/abstract.c:2547
#144 0x000055f698889a7a in slot_tp_call (self=0x7f7ba9183790, 
    args=0x7f7baec3d050, kwds=0x7f7b9ae49b40) at Objects/typeobject.c:5546
#145 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9183790, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7b9ae49b40)
---Type <return> to continue, or q <return> to quit---
    at Objects/abstract.c:2547
#146 0x000055f6988b7bce in do_call (nk=<optimized out>, na=<optimized out>, 
    pp_stack=0x7fffb12f7138, func=0x7f7ba9183790) at Python/ceval.c:4569
#147 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f7138)
    at Python/ceval.c:4374
#148 PyEval_EvalFrameEx (f=f at entry=0x7f7b9b364938, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#149 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69b1156c0, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#150 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f7318, 
    func=0x7f7ba92112a8) at Python/ceval.c:4447
#151 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f7318)
    at Python/ceval.c:4372
#152 PyEval_EvalFrameEx (f=f at entry=0x55f69b115500, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#153 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x55f69b198798, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#154 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
---Type <return> to continue, or q <return> to quit---
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f74f8, 
    func=0x7f7ba92111b8) at Python/ceval.c:4447
#155 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f74f8)
    at Python/ceval.c:4372
#156 PyEval_EvalFrameEx (f=f at entry=0x55f69b198600, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#157 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7ba8c9ada8, argcount=<optimized out>, 
    kws=kws at entry=0x0, kwcount=0, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#158 0x000055f69893a9c9 in function_call (func=0x7f7ba9211230, 
    arg=0x7f7ba8c9ad90, kw=0x0) at Objects/funcobject.c:523
#159 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9211230, 
    arg=arg at entry=0x7f7ba8c9ad90, kw=kw at entry=0x0) at Objects/abstract.c:2547
#160 0x000055f6988b8710 in ext_do_call (nk=<optimized out>, na=0, 
    flags=<optimized out>, pp_stack=0x7fffb12f7780, func=0x7f7ba9211230)
    at Python/ceval.c:4666
#161 PyEval_EvalFrameEx (f=f at entry=0x55f69b1b5fa0, throwflag=throwflag at entry=0)
    at Python/ceval.c:3028
#162 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x7f7ba8c88d68, kwcount=1, 
---Type <return> to continue, or q <return> to quit---
    defs=0x7f7baac4b068, defcount=1, closure=0x0) at Python/ceval.c:3584
#163 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f7958, 
    func=0x7f7baacc6b18) at Python/ceval.c:4447
#164 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f7958)
    at Python/ceval.c:4372
#165 PyEval_EvalFrameEx (f=f at entry=0x7f7ba8c88bc0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#166 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x7f7ba8c963e8, kwcount=0, defs=0x0, 
    defcount=0, closure=0x0) at Python/ceval.c:3584
#167 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f7b38, 
    func=0x7f7ba91e7758) at Python/ceval.c:4447
#168 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f7b38)
    at Python/ceval.c:4372
#169 PyEval_EvalFrameEx (f=f at entry=0x7f7ba8c96230, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#170 0x000055f6988bf4d2 in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=4, pp_stack=0x7fffb12f7c58, func=0x7f7baac4e0c8)
    at Python/ceval.c:4437
#171 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f7c58)
---Type <return> to continue, or q <return> to quit---
    at Python/ceval.c:4372
#172 PyEval_EvalFrameEx (f=f at entry=0x7f7ba8c90230, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#173 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, 
    args=args at entry=0x7f7baeb11ca8, argcount=<optimized out>, 
    kws=kws at entry=0x7f7ba9304380, kwcount=1, defs=0x0, defcount=0, closure=0x0)
    at Python/ceval.c:3584
#174 0x000055f69893aaad in function_call (func=0x7f7baac4cb90, 
    arg=0x7f7baeb11c90, kw=0x7f7ba8cdc7f8) at Objects/funcobject.c:523
#175 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7baac4cb90, 
    arg=arg at entry=0x7f7baeb11c90, kw=kw at entry=0x7f7ba8cdc7f8)
    at Objects/abstract.c:2547
#176 0x000055f69882746c in instancemethod_call (func=0x7f7baac4cb90, 
    arg=0x7f7baeb11c90, kw=0x7f7ba8cdc7f8) at Objects/classobject.c:2602
#177 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba9503910, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7ba8cdc7f8)
    at Objects/abstract.c:2547
#178 0x000055f698889a7a in slot_tp_call (self=0x7f7ba917b1d0, 
    args=0x7f7baec3d050, kwds=0x7f7ba8cdc7f8) at Objects/typeobject.c:5546
#179 0x000055f69882386a in PyObject_Call (func=func at entry=0x7f7ba917b1d0, 
    arg=arg at entry=0x7f7baec3d050, kw=kw at entry=0x7f7ba8cdc7f8)
    at Objects/abstract.c:2547
---Type <return> to continue, or q <return> to quit---
#180 0x000055f6988b7bce in do_call (nk=<optimized out>, na=<optimized out>, 
    pp_stack=0x7fffb12f81b8, func=0x7f7ba917b1d0) at Python/ceval.c:4569
#181 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f81b8)
    at Python/ceval.c:4374
#182 PyEval_EvalFrameEx (f=f at entry=0x55f69ae0d4f0, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#183 0x000055f6988c0380 in PyEval_EvalCodeEx (co=<optimized out>, 
    globals=<optimized out>, locals=locals at entry=0x0, args=<optimized out>, 
    argcount=<optimized out>, kws=0x7f7baeb66c88, kwcount=0, 
    defs=0x7f7ba9306c80, defcount=2, closure=0x0) at Python/ceval.c:3584
#184 0x000055f6988bd0dd in fast_function (nk=<optimized out>, 
    na=<optimized out>, n=<optimized out>, pp_stack=0x7fffb12f8398, 
    func=0x7f7ba92bd9b0) at Python/ceval.c:4447
#185 call_function (oparg=<optimized out>, pp_stack=0x7fffb12f8398)
    at Python/ceval.c:4372
#186 PyEval_EvalFrameEx (f=f at entry=0x7f7baeb66b00, throwflag=throwflag at entry=0)
    at Python/ceval.c:2989
#187 0x000055f6988c0380 in PyEval_EvalCodeEx (co=co at entry=0x7f7baeb808b0, 
    globals=globals at entry=0x7f7baec12168, locals=locals at entry=0x7f7baec12168, 
    args=args at entry=0x0, argcount=argcount at entry=0, kws=kws at entry=0x0, 
    kwcount=0, defs=0x0, defcount=0, closure=0x0) at Python/ceval.c:3584
#188 0x000055f6988c0599 in PyEval_EvalCode (co=co at entry=0x7f7baeb808b0, 
    globals=globals at entry=0x7f7baec12168, locals=locals at entry=0x7f7baec12168)
---Type <return> to continue, or q <return> to quit---
    at Python/ceval.c:669
#189 0x000055f6988e8e70 in run_mod (arena=0x55f69a944b10, 
    flags=0x7fffb12f864c, locals=0x7f7baec12168, globals=0x7f7baec12168, 
    filename=0x7fffb12fa02c "/home/parallels/OS-GIS/build/python/bin/pytest", 
    mod=0x55f69a9ca7c8) at Python/pythonrun.c:1376
#190 PyRun_FileExFlags (fp=0x55f69a96dfa0, 
    filename=0x7fffb12fa02c "/home/parallels/OS-GIS/build/python/bin/pytest", 
    start=<optimized out>, globals=0x7f7baec12168, locals=0x7f7baec12168, 
    closeit=1, flags=0x7fffb12f864c) at Python/pythonrun.c:1362
#191 0x000055f6988eb621 in PyRun_SimpleFileExFlags (fp=0x55f69a96dfa0, 
    filename=0x7fffb12fa02c "/home/parallels/OS-GIS/build/python/bin/pytest", 
    closeit=1, flags=0x7fffb12f864c) at Python/pythonrun.c:948
#192 0x000055f6988152a0 in Py_Main (argc=<optimized out>, argv=<optimized out>)
    at Modules/main.c:640
#193 0x00007f7badcf3b97 in __libc_start_main (main=0x55f6988144f0 <main>, 
    argc=2, argv=0x7fffb12f8808, init=<optimized out>, fini=<optimized out>, 
    rtld_fini=<optimized out>, stack_end=0x7fffb12f87f8)
    at ../csu/libc-start.c:310
#194 0x000055f69881452a in _start ()
(gdb) 


John Daniel
Etresoft, Inc.

> On Apr 18, 2019, at 5:17 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
>> E   ImportError:
>> /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packa
>> ges/osgeo/_gdal.so: undefined symbol: CPLGetErrorCounter
> 
> Try
> 
> ldd /home/parallels/OS-GIS/platforms/linux/x86_64/gdal/lib/python2.7/site-packages/osgeo/_gdal.so
> 
> and check which libgdal.so it links to. It is likely that it is not the right one.
> 
> You'll have to adjust your LD_LIBRARY_PATH then.
> Sourcing scripts/setdevenv.sh should do that for you
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From even.rouault at spatialys.com  Thu Apr 18 10:11:14 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Apr 2019 19:11:14 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <4b489983-a9df-380f-17de-ebcff05121da@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <4423378.P32z12xsDR@even-i700>
 <4b489983-a9df-380f-17de-ebcff05121da@oracle.com>
Message-ID: <2700336.eAqFur8UrD@even-i700>

On jeudi 18 avril 2019 12:38:43 CEST Fengting Chen wrote:
> In my case, this didn't work.
> 
> 1. When I ran the GDAL build, I always use "make clean" to clean the old
> build.  And I did run scripts/setdevenv.sh before running the test.
> 
> />which gdalinfo//
> ///scratch/gdal/gdal/gdal/apps/gdalinfo//
> /
> 
> />gdalinfo --version//
> //GDAL 2.5.0dev-94f370c-dirty, released 2019/04/01/
> 
> 2. gdalinfo and gdaltranslate are working without error. Only pytest failed:
> 
> /E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined
> symbol: _Z17CPLHaveRuntimeAVXv/
> 
> 3. I checked libgdal.so.so, it is missing that symbol:
> 
> />nm  /scratch/gdal/gdal/gdal/.libs/libgdal.so.20 |grep
> _Z17CPLHaveRuntimeAVXv//
> //                 U _Z17CPLHaveRuntimeAVXv/
> 
> It seems that my manual test of gdalinfo and gdal_translate didn't use
> that symbol. Anyone know which library that symbol came from?

It comes from GDAL in port/cpl_cpu_features.h/.cpp . I did some change in that 
area a few weeks ago. There's some subtelty to inline it or not, depending on 
the compiler, etc, but everything works fine on environments tested by 
continuous integration.
What is your compiler and compiler version ?

Hum, what surprises me is that in a previous post you mentionned having built
--without-libtool, but here you link agains a libtool build. If you indeed use 
a non-libtool build, you need to remove the /scratch/gdal/gdal/gdal/.libs 
directory

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Apr 18 10:26:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Apr 2019 19:26:00 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <3C68E577-5AFD-4F2E-940D-D77E1140DF53@etresoft.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <4423378.P32z12xsDR@even-i700>
 <3C68E577-5AFD-4F2E-940D-D77E1140DF53@etresoft.com>
Message-ID: <1978432.XCcejS3urh@even-i700>

On jeudi 18 avril 2019 16:41:41 CEST John Daniel wrote:
> Even,
> scripts/setdevenv.sh did fix the python problem for me.
> 
> However, I get a very similar segfault in the test scripts that I get on the
> Mac. It seems related to SQLite and SpatiaLite. I'm going to try to rebuild
> with an older set of GDAL+libs that has worked in the past.
> 
> Here is the backtrace if anyone is curious. Unless anyone recognizes a known
> issue, I'm assuming this is my problem to work out from here.

Does not ring a bell. But from the stack trace, you're not using a recent 
spatialite version. Perhaps upgrading it would be a good idea.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fengting.chen at oracle.com  Thu Apr 18 10:39:32 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Thu, 18 Apr 2019 13:39:32 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <2700336.eAqFur8UrD@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <4423378.P32z12xsDR@even-i700>
 <4b489983-a9df-380f-17de-ebcff05121da@oracle.com>
 <2700336.eAqFur8UrD@even-i700>
Message-ID: <202028a7-0968-f1e1-b3d3-c7e1705fde1c@oracle.com>


On 4/18/2019 1:11 PM, Even Rouault wrote:
> On jeudi 18 avril 2019 12:38:43 CEST Fengting Chen wrote:
>> In my case, this didn't work.
>>
>> 1. When I ran the GDAL build, I always use "make clean" to clean the old
>> build.  And I did run scripts/setdevenv.sh before running the test.
>>
>> />which gdalinfo//
>> ///scratch/gdal/gdal/gdal/apps/gdalinfo//
>> /
>>
>> />gdalinfo --version//
>> //GDAL 2.5.0dev-94f370c-dirty, released 2019/04/01/
>>
>> 2. gdalinfo and gdaltranslate are working without error. Only pytest failed:
>>
>> /E   ImportError: /scratch/gdal/gdal/gdal/.libs/libgdal.so.20: undefined
>> symbol: _Z17CPLHaveRuntimeAVXv/
>>
>> 3. I checked libgdal.so.so, it is missing that symbol:
>>
>> />nm  /scratch/gdal/gdal/gdal/.libs/libgdal.so.20 |grep
>> _Z17CPLHaveRuntimeAVXv//
>> //                 U _Z17CPLHaveRuntimeAVXv/
>>
>> It seems that my manual test of gdalinfo and gdal_translate didn't use
>> that symbol. Anyone know which library that symbol came from?
> It comes from GDAL in port/cpl_cpu_features.h/.cpp . I did some change in that
> area a few weeks ago. There's some subtelty to inline it or not, depending on
> the compiler, etc, but everything works fine on environments tested by
> continuous integration.
> What is your compiler and compiler version ?
>
> Hum, what surprises me is that in a previous post you mentionned having built
> --without-libtool, but here you link agains a libtool build. If you indeed use
> a non-libtool build, you need to remove the /scratch/gdal/gdal/gdal/.libs
> directory

Not sure how you find out I used libtool build. In my configure option, 
I did specify "--without-libtool".

Here is the output from configure about compiler and libtool:

/C compiler:                gcc -DHAVE_AVX_AT_COMPILE_TIME 
-DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2 -fPIC//
//  C++ compiler:              g++ -std=c++11 -DHAVE_AVX_AT_COMPILE_TIME 
-DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2 -fPIC//
//  C++14 support:             no//
//
//  LIBTOOL support:           no/

-Fengting


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190418/1dfe197d/attachment.html>

From even.rouault at spatialys.com  Thu Apr 18 12:00:20 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Apr 2019 21:00:20 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <202028a7-0968-f1e1-b3d3-c7e1705fde1c@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2700336.eAqFur8UrD@even-i700>
 <202028a7-0968-f1e1-b3d3-c7e1705fde1c@oracle.com>
Message-ID: <2401249.tqJCQ6P7rD@even-i700>

> Not sure how you find out I used libtool build. In my configure option,
> I did specify "--without-libtool".

/scratch/gdal/gdal/gdal/.libs/libgdal.so.20 is a file produced by a libtool 
build. You perhaps did initially a libtool build and then a non-libtool one.
Remove /scratch/gdal/gdal/gdal/.libs

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Apr 18 12:10:49 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Apr 2019 21:10:49 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <0E4B8BDF-B6CA-4904-BA43-456558465F10@etresoft.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <1978432.XCcejS3urh@even-i700>
 <0E4B8BDF-B6CA-4904-BA43-456558465F10@etresoft.com>
Message-ID: <6010544.qJ5yzdZbZR@even-i700>

On jeudi 18 avril 2019 19:01:34 CEST John Daniel wrote:
> I had tried 3 different versions of SpatiaLite (4.1.1 - 5.0) since that
> seemed to be where the problem is. My last known good build used
> SpatialLite 4.3.0a.
> 
> Is there a list of recommended version of various supporting libraries? I
> have tried to pick the most recent released or tagged version of
> everything. But for SpatialLite, I can't tell which version is best. They
> all seem to have some "rc" or "beta" qualifier - and it need a PROJ6 hack.

Yeah, that's unfortunate they haven't released a normal version recently.
I've hardly any experience on MacOS and our Mac Travis-CI builds don't have 
spatialite enabled apparently (also apparently homebrew has 
libspatialite-4.3.0a_2.el_capitan installed)
On Linux pretty much every spatialite version works.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Bob.Moskovitz at conservation.ca.gov  Thu Apr 18 16:32:17 2019
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob@DOC)
Date: Thu, 18 Apr 2019 23:32:17 +0000
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
Message-ID: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>

Hello gdal_dev,

I am trying to use ogrinfo on a set of CSV file that has a field with the name "Vs30(m/s)", but change the name to "Vs30".  Is this possible or do I have to edit a bunch of files headers to do this?

I tried:
ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT Vs30(m/s) as Vs30 FROM file1"
but as expected ogrinfo gave the error message "no such function: Vs30".

Thanks in advance!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190418/3e153911/attachment.html>

From johnbaums at gmail.com  Thu Apr 18 21:52:13 2019
From: johnbaums at gmail.com (John Baumgartner)
Date: Fri, 19 Apr 2019 14:52:13 +1000
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
In-Reply-To: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
References: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
Message-ID: <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>

Try surrounding the field name with square brackets:

ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT [Vs30(m/s)] as
Vs30 FROM file1"

On Fri, 19 Apr 2019 at 09:32, Moskovitz, Bob at DOC <
Bob.Moskovitz at conservation.ca.gov> wrote:

> Hello gdal_dev,
>
>
>
> I am trying to use ogrinfo on a set of CSV file that has a field with the
> name “Vs30(m/s)”, but change the name to “Vs30”.  Is this possible or do I
> have to edit a bunch of files headers to do this?
>
>
>
> I tried:
>
> ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT Vs30(m/s) as
> Vs30 FROM file1"
>
> but as expected ogrinfo gave the error message “no such function: Vs30”.
>
>
>
> Thanks in advance!
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190419/a64fc1ed/attachment.html>

From even.rouault at spatialys.com  Fri Apr 19 01:45:57 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 10:45:57 +0200
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
In-Reply-To: <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
References: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
 <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
Message-ID: <4231656.1X9b04CuJ7@even-i700>

On vendredi 19 avril 2019 14:52:13 CEST John Baumgartner wrote:
> Try surrounding the field name with square brackets:
> 
> ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT [Vs30(m/s)] as
> Vs30 FROM file1"

Brackets won't work with OGR SQL or SQLite. You must use double quotes

On a Bash shell, if you use double quotes for the SQL statement itself,
you need to escape them

ogrinfo test.csv -sql "select \"VS30(m/s)\" as VS30ms from test"

On Windows cmd.exe, you might also apparently try the above in most cases,
but there are some subtleties and dangers in some cases (not for the
above one), as underlined by
https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/
(paragraph "cmd.exe" and following)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Apr 19 04:37:25 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 13:37:25 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
Message-ID: <1802776.k8HcAEYcvK@even-i700>

Hi,

I have prepared the GDAL/OGR 2.5.0 Beta 1 release.  It will hopefully directly 
followed by a RC1 next week if things go well. 

GDAL 2.5.0 *requires* PROJ >= 6.0, and if using external libgeotiff, 
libgeotiff >= 1.5.0
In case you didn't follow recent developments, a revamp has been done in the 
area of coordinate reference systems, which may impact downstream users & code 
of GDAL. Consult 
https://github.com/OSGeo/gdal/blob/master/gdal/MIGRATION_GUIDE.TXT
and
https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn

The source is available at:

    http://download.osgeo.org/gdal/2.5.0/gdal-2.5.0beta1.tar.xz
    http://download.osgeo.org/gdal/2.5.0/gdal-2.5.0beta1.tar.gz
    http://download.osgeo.org/gdal/2.5.0/gdal250beta1.zip

A snapshot of the Python autotest suite can be downloaded from:

    http://download.osgeo.org/gdal/2.5.0/gdalautotest-2.5.0beta1.tar.gz
    http://download.osgeo.org/gdal/2.5.0/gdalautotest-2.5.0beta1.zip

The GRASS plugin is available at

    http://download.osgeo.org/gdal/2.5.0/gdal-grass-2.5.0beta1.tar.gz

The NEWS is available at :
      https://raw.githubusercontent.com/OSGeo/gdal/master/gdal/NEWS

New bugs found should be filed in GitHub.

GDAL developers and users are encouraged to treat the next week as the prime 
time for bug finding and fixing.

I have not yet created the release/2.5 branch from current master, so be 
careful of what you commit in master.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at lexort.com  Fri Apr 19 07:08:20 2019
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 19 Apr 2019 10:08:20 -0400
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <1802776.k8HcAEYcvK@even-i700> (Even Rouault's message of "Fri,
 19 Apr 2019 13:37:25 +0200")
References: <1802776.k8HcAEYcvK@even-i700>
Message-ID: <smu8sw65bqj.fsf@linuxpal.mit.edu>

Even Rouault <even.rouault at spatialys.com> writes:

> GDAL 2.5.0 *requires* PROJ >= 6.0, and if using external libgeotiff, 

I would expect then that packaging systems will hold off on this,
because I don't think we've reached the point that the collateral damage
of upgrading proj to 6 is ok.

With any luck I'm wrong and most of the proj-using packages have had a
release that works on 6, but it seems that there are a lot of packages
not yet able to cope.

(Which is all fine; packaging systems can stay on 2.4.x for a while.)



From sebastic at xs4all.nl  Fri Apr 19 07:22:29 2019
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 19 Apr 2019 16:22:29 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <smu8sw65bqj.fsf@linuxpal.mit.edu>
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
Message-ID: <6ce76a37-0d7e-ef3c-2707-247d6c342741@xs4all.nl>

On 4/19/19 4:08 PM, Greg Troxel wrote:
> Even Rouault <even.rouault at spatialys.com> writes:
>> GDAL 2.5.0 *requires* PROJ >= 6.0, and if using external libgeotiff, 
> 
> I would expect then that packaging systems will hold off on this,
> because I don't think we've reached the point that the collateral damage
> of upgrading proj to 6 is ok.
>
> With any luck I'm wrong and most of the proj-using packages have had a
> release that works on 6, but it seems that there are a lot of packages
> not yet able to cope.

It's not as bad as it seems. If you set the accept deprecation flag,
most packages that still use proj_api.h build successfully with PROJ 6.

See: https://lists.debian.org/debian-gis/2019/04/msg00004.html
(and the follow-ups)

The ones that still use projects.h are somewhat hopeless, they tend to
be dead upstream, so are candidates for removal.

The biggest concerns are cartopy, R sf & lwgeom, SAGA, and VTK. I've
seen no progress for the R packages, nor anything tangible for VTK
(although it can be built with its embedded copy of libproj4 3.2).

The cartopy test failures may be (partially) fixed with PROJ 6.1.0 like
the test failures with the RDNAP datumgrid, but I expect more changes
will be required to get all tests to pass.

Once the SAGA changes are available in a future release, it will likely
not be compatible with QGIS, but such is the fate of processing modules.
I stopped caring about anything other that GRASS when it comes to QGIS,
and even for GRASS I'll drop the support when it breaks.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Fri Apr 19 07:29:07 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 16:29:07 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <smu8sw65bqj.fsf@linuxpal.mit.edu>
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
Message-ID: <6486327.QVYuD5O78m@even-i700>

Greg,

> I would expect then that packaging systems will hold off on this,
> because I don't think we've reached the point that the collateral damage
> of upgrading proj to 6 is ok.

Packaging systems with an experimental staging area should be able to package 
it hopefully, and add it to the other packages supporting PROJ 6 already.

> 
> With any luck I'm wrong and most of the proj-using packages have had a
> release that works on 6, but it seems that there are a lot of packages
> not yet able to cope.

I understand your concern, but what would have be supposed to do: wait for 
others to upgrade to PROJ 6 as well and defer until they did :-) ?
We're tracing the road away by adopting PROJ 6 too. Projects which don't 
follow the trend are doomed to be left aside ultimately.

Sorry, supporting older PROJ versions wasn't really wishable from a GDAL 
maintainability point of view. What happened is a deep change. A lot of code 
has been """moved"""" to PROJ: instanciation of CRS from the EPSG database, 
WKT1 support, ESRI WKT support and PROJ string import/export. Actually, all 
that code has been deleted from GDAL and rewritten in a completely different 
way in PROJ. Supporting older PROJ versions in GDAL 2.5 would mean maintaining 
a lot of ancient code, that behaves in subtle different ways. Would be a mess 
to have the test suite working in both mode, etc. GDAL is a complicated and 
big enough beast like it is already.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at lexort.com  Fri Apr 19 07:40:24 2019
From: gdt at lexort.com (Greg Troxel)
Date: Fri, 19 Apr 2019 10:40:24 -0400
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <6486327.QVYuD5O78m@even-i700> (Even Rouault's message of "Fri,
 19 Apr 2019 16:29:07 +0200")
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
 <6486327.QVYuD5O78m@even-i700>
Message-ID: <smuwojq3von.fsf@linuxpal.mit.edu>

Even Rouault <even.rouault at spatialys.com> writes:

>> I would expect then that packaging systems will hold off on this,
>> because I don't think we've reached the point that the collateral damage
>> of upgrading proj to 6 is ok.
>
> Packaging systems with an experimental staging area should be able to package 
> it hopefully, and add it to the other packages supporting PROJ 6 already.

True, but that's separate from what is in the mainstream distribution.

>> With any luck I'm wrong and most of the proj-using packages have had a
>> release that works on 6, but it seems that there are a lot of packages
>> not yet able to cope.
>
> I understand your concern, but what would have be supposed to do: wait for 
> others to upgrade to PROJ 6 as well and defer until they did :-) ?
> We're tracing the road away by adopting PROJ 6 too. Projects which don't 
> follow the trend are doomed to be left aside ultimately.
>
> Sorry, supporting older PROJ versions wasn't really wishable from a GDAL 
> maintainability point of view. What happened is a deep change. A lot of code 
> has been """moved"""" to PROJ: instanciation of CRS from the EPSG database, 
> WKT1 support, ESRI WKT support and PROJ string import/export. Actually, all 
> that code has been deleted from GDAL and rewritten in a completely different 
> way in PROJ. Supporting older PROJ versions in GDAL 2.5 would mean maintaining 
> a lot of ancient code, that behaves in subtle different ways. Would be a mess 
> to have the test suite working in both mode, etc. GDAL is a complicated and 
> big enough beast like it is already.

I can certainly see your point that supporting 5 and 6 in the same
release is too much.  I didn't really mean to sound like "you should not
have done this".  I was just trying to point out that the 6-only status
of 2.5.0 is likely going to lead to quite delayed adoption in packaging
systems.


From sebastic at xs4all.nl  Fri Apr 19 07:50:11 2019
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 19 Apr 2019 16:50:11 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <smuwojq3von.fsf@linuxpal.mit.edu>
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
 <6486327.QVYuD5O78m@even-i700> <smuwojq3von.fsf@linuxpal.mit.edu>
Message-ID: <18cd78d7-b11c-6c79-d738-984e5455bcea@xs4all.nl>

On 4/19/19 4:40 PM, Greg Troxel wrote:
> I was just trying to point out that the 6-only status
> of 2.5.0 is likely going to lead to quite delayed adoption in packaging
> systems.

Can you share an overview of the PROJ 6 status in NetBSD?

Since NetBSD doesn't have most of the problematic packages or hasn't
patched them as heavily as in Debian, I think that you should be able to
move to PROJ 6 much sooner than other distributions.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Fri Apr 19 07:52:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 16:52:53 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <CAJf0KTTQda4S8hELKNXSHBxYmPB5o67CPV6knrKdM+9wPCwUKw@mail.gmail.com>
References: <1802776.k8HcAEYcvK@even-i700>
 <CAJf0KTTQda4S8hELKNXSHBxYmPB5o67CPV6knrKdM+9wPCwUKw@mail.gmail.com>
Message-ID: <3673379.a8OrgR3fFP@even-i700>

On vendredi 19 avril 2019 07:42:31 CEST Simon Eves wrote:
> Does this mean there won’t be a 2.4.2?

I'll issuing a few extra 2.4.x maintenance bugfix releases this year, but this 
is a courtesy that will eventually stop.

People needing longer support, and potentially backport of features in the 2.4 
series, are free to contact their favorite service provider.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From edzer.pebesma at uni-muenster.de  Fri Apr 19 08:55:58 2019
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Fri, 19 Apr 2019 17:55:58 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <6ce76a37-0d7e-ef3c-2707-247d6c342741@xs4all.nl>
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
 <6ce76a37-0d7e-ef3c-2707-247d6c342741@xs4all.nl>
Message-ID: <06c90a0c-00aa-7a0a-5958-4af51067648e@uni-muenster.de>



On 4/19/19 4:22 PM, Sebastiaan Couwenberg wrote:
> The biggest concerns are cartopy, R sf & lwgeom, SAGA, and VTK. I've
> seen no progress for the R packages, nor anything tangible for VTK
> (although it can be built with its embedded copy of libproj4 3.2).

Thanks - the R packages sf, lwgeom and rgdal have been updated; github
versions work, we'll be submitting CRAN version in the next few days.

I updated the wiki status pages.
-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48151 Muenster, Germany
Phone: +49 251 8333081
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 2472 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190419/cf4d5b41/attachment.key>

From Bob.Moskovitz at conservation.ca.gov  Fri Apr 19 09:05:14 2019
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob@DOC)
Date: Fri, 19 Apr 2019 16:05:14 +0000
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
In-Reply-To: <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
References: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
 <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
Message-ID: <MWHPR09MB20458C6CD85227BCF2537FABAE270@MWHPR09MB2045.namprd09.prod.outlook.com>

Thanks John, it worked perfectly!

From: John Baumgartner <johnbaums at gmail.com>
Sent: Thursday, April 18, 2019 9:52 PM
To: Moskovitz, Bob at DOC <Bob.Moskovitz at conservation.ca.gov>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] OGR SQL on CSV file with field name with parentheses?

Try surrounding the field name with square brackets:

ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT [Vs30(m/s)] as Vs30 FROM file1"

On Fri, 19 Apr 2019 at 09:32, Moskovitz, Bob at DOC <Bob.Moskovitz at conservation.ca.gov<mailto:Bob.Moskovitz at conservation.ca.gov>> wrote:
Hello gdal_dev,

I am trying to use ogrinfo on a set of CSV file that has a field with the name “Vs30(m/s)”, but change the name to “Vs30”.  Is this possible or do I have to edit a bunch of files headers to do this?

I tried:
ogrinfo -al "Data_directory" -dialect sqlite -sql "SELECT Vs30(m/s) as Vs30 FROM file1"
but as expected ogrinfo gave the error message “no such function: Vs30”.

Thanks in advance!
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://gcc01.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=02%7C01%7CBob.Moskovitz%40conservation.ca.gov%7Cbe37bd898b284d9b257e08d6c482d295%7C4c5988ae5a0040e8b065a017f9c99494%7C0%7C1%7C636912463499656682&sdata=OZJ%2FGfBXcYshyy6evRQFKlrGUBQEw3kNiT6%2BVWsX9Vk%3D&reserved=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190419/8252c969/attachment-0001.html>

From even.rouault at spatialys.com  Fri Apr 19 10:42:25 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 19:42:25 +0200
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
In-Reply-To: <MWHPR09MB20458C6CD85227BCF2537FABAE270@MWHPR09MB2045.namprd09.prod.outlook.com>
References: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
 <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
 <MWHPR09MB20458C6CD85227BCF2537FABAE270@MWHPR09MB2045.namprd09.prod.outlook.com>
Message-ID: <1802802.YZhEqtB0dD@even-i700>

On vendredi 19 avril 2019 16:05:14 CEST Moskovitz, Bob at DOC wrote:
> Thanks John, it worked perfectly!

oh, indeed. Turns out SQLite is rather permissive in that area:
https://www.sqlite.org/lang_keywords.html
(that said, OGR SQL only accepts double quotes when identifier quoting is 
needed)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Bob.Moskovitz at conservation.ca.gov  Fri Apr 19 10:49:23 2019
From: Bob.Moskovitz at conservation.ca.gov (Moskovitz, Bob@DOC)
Date: Fri, 19 Apr 2019 17:49:23 +0000
Subject: [gdal-dev] OGR SQL on CSV file with field name with parentheses?
In-Reply-To: <1802802.YZhEqtB0dD@even-i700>
References: <MWHPR09MB20450DFD4B511AEBED8AEC93AE260@MWHPR09MB2045.namprd09.prod.outlook.com>
 <CACpmSOsqe6N3QXuvbAPKRth2sMoHYDYfo_wCd3r+O_Mut7wbjw@mail.gmail.com>
 <MWHPR09MB20458C6CD85227BCF2537FABAE270@MWHPR09MB2045.namprd09.prod.outlook.com>
 <1802802.YZhEqtB0dD@even-i700>
Message-ID: <MWHPR09MB20451F4C94E8E00B2AB40579AE270@MWHPR09MB2045.namprd09.prod.outlook.com>

Good to know why this syntax works.  It brings back fond memories of using MS Access 😊

-----Original Message-----
From: Even Rouault <even.rouault at spatialys.com> 
Sent: Friday, April 19, 2019 10:42 AM
To: gdal-dev at lists.osgeo.org
Cc: Moskovitz, Bob at DOC <Bob.Moskovitz at conservation.ca.gov>; John Baumgartner <johnbaums at gmail.com>
Subject: Re: [gdal-dev] OGR SQL on CSV file with field name with parentheses?

On vendredi 19 avril 2019 16:05:14 CEST Moskovitz, Bob at DOC wrote:
> Thanks John, it worked perfectly!

oh, indeed. Turns out SQLite is rather permissive in that area:
https://gcc01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.sqlite.org%2Flang_keywords.html&amp;data=02%7C01%7CBob.Moskovitz%40conservation.ca.gov%7Cf0ba36de77384ea4297108d6c4ee6494%7C4c5988ae5a0040e8b065a017f9c99494%7C0%7C0%7C636912925503570904&amp;sdata=8dT7SGvGNq3lscnpcOkOhA4t2QNkh7UL9B7eiDW7Sxk%3D&amp;reserved=0
(that said, OGR SQL only accepts double quotes when identifier quoting is 
needed)

-- 
Spatialys - Geospatial professional services
https://gcc01.safelinks.protection.outlook.com/?url=http%3A%2F%2Fwww.spatialys.com&amp;data=02%7C01%7CBob.Moskovitz%40conservation.ca.gov%7Cf0ba36de77384ea4297108d6c4ee6494%7C4c5988ae5a0040e8b065a017f9c99494%7C0%7C0%7C636912925503570904&amp;sdata=2PT287%2BeOJIl9i73dhes%2BVuh4AD%2BPnn1MswgWO3eHk0%3D&amp;reserved=0

From klassen.js at gmail.com  Fri Apr 19 12:31:17 2019
From: klassen.js at gmail.com (Jim Klassen)
Date: Fri, 19 Apr 2019 14:31:17 -0500
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <3673379.a8OrgR3fFP@even-i700>
References: <1802776.k8HcAEYcvK@even-i700>
 <CAJf0KTTQda4S8hELKNXSHBxYmPB5o67CPV6knrKdM+9wPCwUKw@mail.gmail.com>
 <3673379.a8OrgR3fFP@even-i700>
Message-ID: <3d27143f-028d-4b5f-1f23-3a4f03a461d6@gmail.com>

On 4/19/19 9:52 AM, Even Rouault wrote:

> On vendredi 19 avril 2019 07:42:31 CEST Simon Eves wrote:
>> Does this mean there won’t be a 2.4.2?
> I'll issuing a few extra 2.4.x maintenance bugfix releases this year, but this
> is a courtesy that will eventually stop.
>
> People needing longer support, and potentially backport of features in the 2.4
> series, are free to contact their favorite service provider.
>
> Even
>
Just curious, there seems to be an implicit assumption that proj4/5 and 
proj6 (or GDAL 2.4 and 2.5 for that matter) can't be installed side by 
side.  Why is that? Shouldn't they have different .so major versions?  
Then wouldn't applications that haven't been updated yet continue to 
function with the Proj/GDAL version they were built against?

I understand this is a little messy for awhile, but why would this 
fundamentally be any different than a distro packaging multiple OpenSSL 
versions or Qt versions to keep all the applications happy?


From even.rouault at spatialys.com  Fri Apr 19 12:36:12 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 21:36:12 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <3d27143f-028d-4b5f-1f23-3a4f03a461d6@gmail.com>
References: <1802776.k8HcAEYcvK@even-i700> <3673379.a8OrgR3fFP@even-i700>
 <3d27143f-028d-4b5f-1f23-3a4f03a461d6@gmail.com>
Message-ID: <22882289.1O49zx8hZp@even-i700>

On vendredi 19 avril 2019 14:31:17 CEST Jim Klassen wrote:
> On 4/19/19 9:52 AM, Even Rouault wrote:
> > On vendredi 19 avril 2019 07:42:31 CEST Simon Eves wrote:
> >> Does this mean there won’t be a 2.4.2?
> > 
> > I'll issuing a few extra 2.4.x maintenance bugfix releases this year, but
> > this is a courtesy that will eventually stop.
> > 
> > People needing longer support, and potentially backport of features in the
> > 2.4 series, are free to contact their favorite service provider.
> > 
> > Even
> 
> Just curious, there seems to be an implicit assumption that proj4/5 and
> proj6 (or GDAL 2.4 and 2.5 for that matter) can't be installed side by
> side.  Why is that? Shouldn't they have different .so major versions? 

Most binary distributions only ship one version, for conveniency/reduced work 
load/etc., but yes you can use as many PROJ + GDAL versions in different 
locations of your system of course

What becomes messy is when you have quasi-diamond situations like :

A depends on B on C
B depends on PROJ < 6
C depends on PROJ >= 6

Things are bound to explode at runtime due to symbol clashes.
Except that for the sake of my own development needs I was in that situation 
so you can use that trick:
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From fengting.chen at oracle.com  Fri Apr 19 12:36:33 2019
From: fengting.chen at oracle.com (Fengting Chen)
Date: Fri, 19 Apr 2019 15:36:33 -0400
Subject: [gdal-dev] How to run autotest
In-Reply-To: <2401249.tqJCQ6P7rD@even-i700>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2700336.eAqFur8UrD@even-i700>
 <202028a7-0968-f1e1-b3d3-c7e1705fde1c@oracle.com>
 <2401249.tqJCQ6P7rD@even-i700>
Message-ID: <b5acbcaa-f4c0-96a2-b820-ed610b56d972@oracle.com>

Removing .libs helped and now pytest is working. Thank you!

Instead of using pytest to run all the tests, how to run individual test?

On 4/18/2019 3:00 PM, Even Rouault wrote:
>> Not sure how you find out I used libtool build. In my configure option,
>> I did specify "--without-libtool".
> /scratch/gdal/gdal/gdal/.libs/libgdal.so.20 is a file produced by a libtool
> build. You perhaps did initially a libtool build and then a non-libtool one.
> Remove /scratch/gdal/gdal/gdal/.libs
>

From sebastic at xs4all.nl  Fri Apr 19 12:44:10 2019
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Fri, 19 Apr 2019 21:44:10 +0200
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <3d27143f-028d-4b5f-1f23-3a4f03a461d6@gmail.com>
References: <1802776.k8HcAEYcvK@even-i700>
 <CAJf0KTTQda4S8hELKNXSHBxYmPB5o67CPV6knrKdM+9wPCwUKw@mail.gmail.com>
 <3673379.a8OrgR3fFP@even-i700>
 <3d27143f-028d-4b5f-1f23-3a4f03a461d6@gmail.com>
Message-ID: <39174b10-316d-3c0c-b723-c7d70c39b597@xs4all.nl>

On 4/19/19 9:31 PM, Jim Klassen wrote:
> Shouldn't they have different .so major versions?

They do:

 * PROJ
   4.9.3: SOVERSION 12
   5.0.0: SOVERSION 13
   5.1.0: SOVERSION 14
   6.0.0: SOVERSION 15

 * libgeotiff
   1.4.3: SOVERSION 2
   1.5.0: SOVERSION 5

 * libgdal
   2.4.0: SOVERSION 20
   2.5.0: SOVERSION 26

See also:

 https://abi-laboratory.pro/index.php?view=timeline&l=proj
 https://abi-laboratory.pro/index.php?view=timeline&l=gdal
 https://abi-laboratory.pro/index.php?view=timeline&l=libgeotiff

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Fri Apr 19 12:46:38 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Apr 2019 21:46:38 +0200
Subject: [gdal-dev] How to run autotest
In-Reply-To: <b5acbcaa-f4c0-96a2-b820-ed610b56d972@oracle.com>
References: <604ab7a2-8489-9ca6-4fba-1acc9b64a8c3@oracle.com>
 <2401249.tqJCQ6P7rD@even-i700>
 <b5acbcaa-f4c0-96a2-b820-ed610b56d972@oracle.com>
Message-ID: <3393641.m2AAVALKXZ@even-i700>

On vendredi 19 avril 2019 15:36:33 CEST Fengting Chen wrote:
> Removing .libs helped and now pytest is working. Thank you!
> 
> Instead of using pytest to run all the tests, how to run individual test?

https://docs.pytest.org/en/latest/ for full reference

And
https://github.com/OSGeo/gdal/blob/master/autotest/README.md
for a few practical tips

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pschmitt at gmail.com  Fri Apr 19 14:58:09 2019
From: pschmitt at gmail.com (Peter Schmitt)
Date: Fri, 19 Apr 2019 15:58:09 -0600
Subject: [gdal-dev] Memory utilization and GDAL_HTTP_MULTIRANGE
Message-ID: <CACkcqcXTTejETs2Uuayrb2dgttGaLPDTXj+MnKy847xWy214bQ@mail.gmail.com>

Hi,

I have been experimenting with the GDAL_HTTP_MULTIRANGE config option added
in gdal-2.3.  I have noticed that setting this to YES requires fewer curl
requests, but utilizes a more memory compared to SERIAL. From a very simple
test (details below):

1. gdal-2.2.4:
        Maximum resident set size (kbytes): 45544
2. gdal-2.3.0 with GDAL_HTTP_MULTIRANGE=SERIAL
        Maximum resident set size (kbytes): 46120
3. gdal-2.3.0 with GDAL_HTTP_MULTIRANGE=YES
        Maximum resident set size (kbytes): 83828

The biggest thing I noticed from the log is that multiple HTTP connections
are left intact when GDAL_HTTP_MULTIRANGE=YES. I'm guessing this is where
the additional memory utilization comes from.  Is there any way to reduce
the memory footprint when GDAL_HTTP_MULTIRANGE=YES?

I came across this while trying to understand why I was seeing a much
higher memory footprint with a MapServer built with gdal >= 2.3 compared to
MapServer built with gdal <= 2.2.4, detailed here:
https://lists.osgeo.org/pipermail/mapserver-users/2019-April/081121.html

Thanks,
Pete

PS:  Here are my test details.  I ran a test with the following config
options:

GDAL_DISABLE_READDIR_ON_OPEN=YES
CPL_VSIL_CURL_ALLOWED_EXTENSIONS=tif
GDAL_CACHEMAX=0
VSI_CACHE=FALSE
CPL_VSIL_CURL_NON_CACHED="/vsicurl/https://s3.amazonaws.com"
CPL_CURL_VERBOSE=ON

and the following command:
/usr/bin/time -v gdal_translate -outsize 256 256 -projwin_srs EPSG:3857
-projwin 13894417.251632 -1012637.7505811 13895028.747858 -1013249.2468073
/vsicurl/
https://s3.amazonaws.com/pschmitt-test-public/b378087a-c2a5-43a0-abec-71fcfb051150_cog.tif
/out.tif | grep "Maximum resident set size"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190419/90780c1c/attachment.html>

From even.rouault at spatialys.com  Sat Apr 20 05:11:35 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 20 Apr 2019 14:11:35 +0200
Subject: [gdal-dev] OGDI 4.1.0 is released
Message-ID: <2192442.9HgUk4StxX@even-i700>

Hi,

I've, un-excitedly, done an emergency OGDI 4.1.0 release triggered by licensing
concerns, so that it can still survive in Debian.
The more I do OGDI releases, the less code there is in it :-)

Download links:
https://freefr.dl.sourceforge.net/project/ogdi/ogdi/4.1.0/ogdi-4.1.0.tar.gz
https://freefr.dl.sourceforge.net/project/ogdi/ogdi/4.1.0/ogdi-4.1.0.zip

The news are

4.1.0
=====

 o  Remove DTED driver that used the ecsrregex.c functionality removed in the
    below bullet.
 o  Remove ogdi/c-api/ecshash.c and ogdi/c-api/ecsregex.c, which were considered
    incompatible of DFSG & OSD (https://github.com/libogdi/ogdi/issues/13)

I've verified it works fine with the OGR OGDI driver and VRF OGDI driver.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at lexort.com  Sat Apr 20 16:51:45 2019
From: gdt at lexort.com (Greg Troxel)
Date: Sat, 20 Apr 2019 19:51:45 -0400
Subject: [gdal-dev] GDAL 2.5.0 beta1 available
In-Reply-To: <18cd78d7-b11c-6c79-d738-984e5455bcea@xs4all.nl> (Sebastiaan
 Couwenberg's message of "Fri, 19 Apr 2019 16:50:11 +0200")
References: <1802776.k8HcAEYcvK@even-i700> <smu8sw65bqj.fsf@linuxpal.mit.edu>
 <6486327.QVYuD5O78m@even-i700> <smuwojq3von.fsf@linuxpal.mit.edu>
 <18cd78d7-b11c-6c79-d738-984e5455bcea@xs4all.nl>
Message-ID: <smud0lg44mm.fsf@linuxpal.mit.edu>

Sebastiaan Couwenberg <sebastic at xs4all.nl> writes:

> On 4/19/19 4:40 PM, Greg Troxel wrote:
>> I was just trying to point out that the 6-only status
>> of 2.5.0 is likely going to lead to quite delayed adoption in packaging
>> systems.
>
> Can you share an overview of the PROJ 6 status in NetBSD?

In pkgsrc, there is currently pkgsrc/geograph/proj as 5.2.0.  This
package name is what pkgsrc considers to be the currently-packaged
version, and what everything that depends on proj depends on.  This
package is marked (in a comment) as not allowed to be updated to 6 until
I as package manger think the fallout is manageable.

In wip/proj, there is 6.0.0.  wip is technically not part of pkgsrc, but
people can install from there and then rebuild whatever they like.  I've
been doing this in order to test if things work with 6.  (packages in
pkgsrc proper are not allowed to depend on wip/.  wip is a combination
of what others might call "testing", and a place where pretty much
anyone can get write acess to place packages.)

Already quite a few more things work with proj 6 than when I started
this process.  I do not have an up-to-date list of what's trouble.

It's probably time to install proj 6 and try to build everything that
depends on proj again.

> Since NetBSD doesn't have most of the problematic packages or hasn't
> patched them as heavily as in Debian, I think that you should be able to
> move to PROJ 6 much sooner than other distributions.

I agree with your assessment.

Overall, I think we're making pretty good progress.

From gdt at lexort.com  Sat Apr 20 17:15:21 2019
From: gdt at lexort.com (Greg Troxel)
Date: Sat, 20 Apr 2019 20:15:21 -0400
Subject: [gdal-dev] OGDI 4.1.0 is released
In-Reply-To: <2192442.9HgUk4StxX@even-i700> (Even Rouault's message of "Sat,
 20 Apr 2019 14:11:35 +0200")
References: <2192442.9HgUk4StxX@even-i700>
Message-ID: <smu4l6s43ja.fsf@linuxpal.mit.edu>

Even Rouault <even.rouault at spatialys.com> writes:

> I've, un-excitedly, done an emergency OGDI 4.1.0 release triggered by licensing
> concerns, so that it can still survive in Debian.
> The more I do OGDI releases, the less code there is in it :-)
>
> Download links:
> https://freefr.dl.sourceforge.net/project/ogdi/ogdi/4.1.0/ogdi-4.1.0.tar.gz
> https://freefr.dl.sourceforge.net/project/ogdi/ogdi/4.1.0/ogdi-4.1.0.zip
>
> The news are
>
> 4.1.0
> =====
>
>  o  Remove DTED driver that used the ecsrregex.c functionality removed in the
>     below bullet.
>  o  Remove ogdi/c-api/ecshash.c and ogdi/c-api/ecsregex.c, which were considered
>     incompatible of DFSG & OSD (https://github.com/libogdi/ogdi/issues/13)

I put a big comment in the libogdi ticket.

Basically, I think this is a misinterpretation and there is no field of
use discrimination.

From sfkeller at gmail.com  Sun Apr 21 01:39:59 2019
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 21 Apr 2019 10:39:59 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP and
	STATENT)
Message-ID: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>

Hi,

The Swiss Statistical Office curates well-known datasets informally
called "Hectare Raster" (STATPOP and STATENT) which obviously are
ASCII Gridded XYZ, like this:

"RELI" "X" "Y" "C1" "C2" "C3"
66192542 661900 254200 1 2 3 ...
66192543 661900 254300 1 2 3 ...
66192599 661900 259900 1 2 3 ...
66192600 661900 260000 1 2 3 ...
...

This obviously is a regular gridded X and Y, sorted by X,Y but
obviously also has gaps and more than one  "Z" (C1, C2, C3). Typically
this is converted to a raster format like GeoTIFF and analysed through
map algebra.

Question 1: The GDAL docs (https://www.gdal.org/frmt_xyz.html ) says
"...no missing value is supported.". In fact, I think it supports them
by omitting lines by setting missing "lines" to NODATA.
=> Correct?

Question 2: I think, there is a way (which could be mentioned in the
docs above), to determine the "Z" value to be converted by gdal_grid
explained in "Reading comma separated values"
(https://www.gdal.org/gdal_grid.html#gdal_grid_csv ).
So XYZ in fact is XYZx meaning that potentially there can be many "Z"
in the input file, but only one can be included.
=> What do you think?

Question 3 (the fundamental one): Although XYZ format requires to
contain regular gridded coordinates, it's technically handled the same
as irregular coordinates (without interpolation) - at least regarding
the main task to convert an sparse array of values to a raster format.
=> Correct?

:Stefan

From even.rouault at spatialys.com  Sun Apr 21 02:31:30 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 21 Apr 2019 11:31:30 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
	and STATENT)
In-Reply-To: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
Message-ID: <4475111.vbl6GUhheB@even-i700>

Stefan,

> 
> The Swiss Statistical Office curates well-known datasets informally
> called "Hectare Raster" (STATPOP and STATENT) which obviously are
> ASCII Gridded XYZ, like this:
> 
> "RELI" "X" "Y" "C1" "C2" "C3"
> 66192542 661900 254200 1 2 3 ...
> 66192543 661900 254300 1 2 3 ...
> 66192599 661900 259900 1 2 3 ...
> 66192600 661900 260000 1 2 3 ...
> ...
> 
> This obviously is a regular gridded X and Y, sorted by X,Y but
> obviously also has gaps and more than one  "Z" (C1, C2, C3). Typically
> this is converted to a raster format like GeoTIFF and analysed through
> map algebra.
> 
> Question 1: The GDAL docs (https://www.gdal.org/frmt_xyz.html ) says
> "...no missing value is supported.". In fact, I think it supports them
> by omitting lines by setting missing "lines" to NODATA.
> => Correct?

The driver is quite picky. I don't think it will support missing values in the 
middle of a line of same Y value. It supports missing values at the beginning 
or end of a line of same Y value. And points must be sorted by increasing or 
decreasing Y, and increasing X value for a line of same Y value.

> 
> Question 2: I think, there is a way (which could be mentioned in the
> docs above), to determine the "Z" value to be converted by gdal_grid
> explained in "Reading comma separated values"
> (https://www.gdal.org/gdal_grid.html#gdal_grid_csv ).
> So XYZ in fact is XYZx meaning that potentially there can be many "Z"
> in the input file, but only one can be included.
> => What do you think?

The best way might probably to read the file with the CSV driver indeed. With 
CSV:the_filename if the_filename has not a .csv extension
Convert it to something with a spatial index like a shapefile or GPKG if the 
file is big
And then use gdal_grid to create a raster from it.

> 
> Question 3 (the fundamental one): Although XYZ format requires to
> contain regular gridded coordinates, it's technically handled the same
> as irregular coordinates (without interpolation) - at least regarding
> the main task to convert an sparse array of values to a raster format.
> => Correct?

The XYZ driver requires constant spacing.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Sun Apr 21 05:48:54 2019
From: sfkeller at gmail.com (Stefan Keller)
Date: Sun, 21 Apr 2019 14:48:54 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
 and STATENT)
In-Reply-To: <4475111.vbl6GUhheB@even-i700>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
 <4475111.vbl6GUhheB@even-i700>
Message-ID: <CAFcOn2_AM7wSuq-zZ558exC9+gkBPDJJWm6ZBb4NrZAVJXd02A@mail.gmail.com>

Hi Even

Thx very much!
I'll try that way and will report.

:Stefan

Am So., 21. Apr. 2019 um 11:31 Uhr schrieb Even Rouault
<even.rouault at spatialys.com>:
>
> Stefan,
>
> >
> > The Swiss Statistical Office curates well-known datasets informally
> > called "Hectare Raster" (STATPOP and STATENT) which obviously are
> > ASCII Gridded XYZ, like this:
> >
> > "RELI" "X" "Y" "C1" "C2" "C3"
> > 66192542 661900 254200 1 2 3 ...
> > 66192543 661900 254300 1 2 3 ...
> > 66192599 661900 259900 1 2 3 ...
> > 66192600 661900 260000 1 2 3 ...
> > ...
> >
> > This obviously is a regular gridded X and Y, sorted by X,Y but
> > obviously also has gaps and more than one  "Z" (C1, C2, C3). Typically
> > this is converted to a raster format like GeoTIFF and analysed through
> > map algebra.
> >
> > Question 1: The GDAL docs (https://www.gdal.org/frmt_xyz.html ) says
> > "...no missing value is supported.". In fact, I think it supports them
> > by omitting lines by setting missing "lines" to NODATA.
> > => Correct?
>
> The driver is quite picky. I don't think it will support missing values in the
> middle of a line of same Y value. It supports missing values at the beginning
> or end of a line of same Y value. And points must be sorted by increasing or
> decreasing Y, and increasing X value for a line of same Y value.
>
> >
> > Question 2: I think, there is a way (which could be mentioned in the
> > docs above), to determine the "Z" value to be converted by gdal_grid
> > explained in "Reading comma separated values"
> > (https://www.gdal.org/gdal_grid.html#gdal_grid_csv ).
> > So XYZ in fact is XYZx meaning that potentially there can be many "Z"
> > in the input file, but only one can be included.
> > => What do you think?
>
> The best way might probably to read the file with the CSV driver indeed. With
> CSV:the_filename if the_filename has not a .csv extension
> Convert it to something with a spatial index like a shapefile or GPKG if the
> file is big
> And then use gdal_grid to create a raster from it.
>
> >
> > Question 3 (the fundamental one): Although XYZ format requires to
> > contain regular gridded coordinates, it's technically handled the same
> > as irregular coordinates (without interpolation) - at least regarding
> > the main task to convert an sparse array of values to a raster format.
> > => Correct?
>
> The XYZ driver requires constant spacing.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From sean at mapbox.com  Sun Apr 21 14:58:44 2019
From: sean at mapbox.com (Sean Gillies)
Date: Sun, 21 Apr 2019 15:58:44 -0600
Subject: [gdal-dev] Restoring functions removed in 2.5 beta1
Message-ID: <CADPhZXw22Ado4NLxxQxDpGQ3GWQ9+icW1Y0d69oR8RYf0YtKdw@mail.gmail.com>

Even and all,

The Fiona and Rasterio projects won't build with the pre-release because,
for better or worse, they reference and use OSRFixup, which has been
removed. I've filed issue #1466 about this.

Yes, we can add shims to Fiona and Rasterio so we can support versions
2.0-2.5, but this does nothing for software that's already installed on
computers. If a no-op version of OSRFixup were restored to GDAL 2.5, these
projects and previously installed versions of them would likely work just
fine with 2.5.

I'd be happy to do the work, once I find the commit where the function was
removed.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190421/a5f9541b/attachment.html>

From even.rouault at spatialys.com  Sun Apr 21 15:09:06 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Apr 2019 00:09:06 +0200
Subject: [gdal-dev] Restoring functions removed in 2.5 beta1
In-Reply-To: <CADPhZXw22Ado4NLxxQxDpGQ3GWQ9+icW1Y0d69oR8RYf0YtKdw@mail.gmail.com>
References: <CADPhZXw22Ado4NLxxQxDpGQ3GWQ9+icW1Y0d69oR8RYf0YtKdw@mail.gmail.com>
Message-ID: <2147401.CZJPKjSAsj@even-i700>

Sean,

> 
> The Fiona and Rasterio projects won't build with the pre-release because,
> for better or worse, they reference and use OSRFixup, which has been
> removed. I've filed issue #1466 about this.
> 
> Yes, we can add shims to Fiona and Rasterio so we can support versions
> 2.0-2.5, but this does nothing for software that's already installed on
> computers. If a no-op version of OSRFixup were restored to GDAL 2.5, these
> projects and previously installed versions of them would likely work just
> fine with 2.5.

I'm not so sure restoring the functions is enough. This might give a false 
impression. More testing & other changes will generally be needed because of 
all the revamp that has done in that area of SRS functionnality, like changes 
in axis order.

The removal was also documented when RFC 73 was approved a few months ago
https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn

We could have perhaps actually called the version 3.0.

> 
> I'd be happy to do the work, once I find the commit where the function was
> removed.

in mega-commit 8e5eeb35bf76390e3134a4ea7076dab7d478ea0e

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre+joost at nurfuerspam.de  Sun Apr 21 23:43:30 2019
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Mon, 22 Apr 2019 08:43:30 +0200
Subject: [gdal-dev] Gdalwarp with geolocation Array and nodata value
Message-ID: <q9jnrq$4rv5$1@blaine.gmane.org>

Dear list,

as a follow-up to 
https://gis.stackexchange.com/questions/319147/using-gdalwarp-for-reprojecting-netcdf-file 
with a sample netcdf file linked in the comments:

The netcdf (really HDF5) contains lat and lon bands to reference the 
cells to WGS84 coordinates. Unfortunately, some rows contain nodata 
values for the monitored parameters and the lat-lon coordinates. This 
seems to break gdalwarp -geoloc.

My workaround is to create a vrt file for the requested subdataset, 
manually remove the GCP points with nodata values, and gdalwarp without 
the -geoloc option (i.e. use the remaining GCPs).

Is there a config option for GDALwarp to omit those nodata values in the 
geolocation array? Or is it worth to open a ticket for it?


Greetings,
Andre Joost


From even.rouault at spatialys.com  Mon Apr 22 01:38:44 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Apr 2019 10:38:44 +0200
Subject: [gdal-dev] Gdalwarp with geolocation Array and nodata value
In-Reply-To: <q9jnrq$4rv5$1@blaine.gmane.org>
References: <q9jnrq$4rv5$1@blaine.gmane.org>
Message-ID: <2466212.NL2eC3V3Mx@even-i700>

On lundi 22 avril 2019 08:43:30 CEST Andre Joost wrote:
> Dear list,
> 
> as a follow-up to
> https://gis.stackexchange.com/questions/319147/using-gdalwarp-for-reprojecti
> ng-netcdf-file with a sample netcdf file linked in the comments:
> 
> The netcdf (really HDF5) contains lat and lon bands to reference the
> cells to WGS84 coordinates. Unfortunately, some rows contain nodata
> values for the monitored parameters and the lat-lon coordinates. This
> seems to break gdalwarp -geoloc.
> 
> My workaround is to create a vrt file for the requested subdataset,
> manually remove the GCP points with nodata values, and gdalwarp without
> the -geoloc option (i.e. use the remaining GCPs).
> 
> Is there a config option for GDALwarp to omit those nodata values in the
> geolocation array? Or is it worth to open a ticket for it?

Andre,

This was addressed by https://github.com/OSGeo/gdal/issues/1451 for the HDF5 
driver side of things.
I'm a bit confused by your mention of -geoloc, since the HDF5 driver has no 
support for the GEOLOCATION metadata domain.
The netCDF driver does have support for GEOLOCATION, but for that particular 
sample file, it doesn't manage to identify the geolocation array, because it 
is in another netCDF group.
So it is likely that your -geoloc invokation ended up using GCPs

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Mon Apr 22 08:07:30 2019
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 22 Apr 2019 09:07:30 -0600
Subject: [gdal-dev] Restoring functions removed in 2.5 beta1
In-Reply-To: <2147401.CZJPKjSAsj@even-i700>
References: <CADPhZXw22Ado4NLxxQxDpGQ3GWQ9+icW1Y0d69oR8RYf0YtKdw@mail.gmail.com>
 <2147401.CZJPKjSAsj@even-i700>
Message-ID: <CADPhZXxW1Nyzdt_UFzM+FeAmaj-4YMwPQwnkmOA21jhdZSLMuA@mail.gmail.com>

Hi Even,

On Sun, Apr 21, 2019 at 4:09 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Sean,
>
> >
> > The Fiona and Rasterio projects won't build with the pre-release because,
> > for better or worse, they reference and use OSRFixup, which has been
> > removed. I've filed issue #1466 about this.
> >
> > Yes, we can add shims to Fiona and Rasterio so we can support versions
> > 2.0-2.5, but this does nothing for software that's already installed on
> > computers. If a no-op version of OSRFixup were restored to GDAL 2.5,
> these
> > projects and previously installed versions of them would likely work just
> > fine with 2.5.
>
> I'm not so sure restoring the functions is enough. This might give a false
> impression. More testing & other changes will generally be needed because
> of
> all the revamp that has done in that area of SRS functionnality, like
> changes
> in axis order.


I had the impression from reading RFC 73 that the data-crs axes mapping
concerns would be, with a few exceptions, internal to GDAL and OGR and that
things would be unchanged for Rasterio and Fiona. Specifically, the intent
is that OGR_G_GetX and OGR_G_GetY (used by Fiona:
https://github.com/Toblerity/Fiona/blob/master/fiona/_geometry.pyx#L123)
will by default return the same values in GIS-friendly order as in 2.4. Yes?

If that's not the intent or the reality, then I'll accept that 2.5 is
practically a new major version and adjust accordingly.

I remain excited about the SRS enhancements and the centralization of
features in PROJ and am looking forward to getting over the hump.


>
> The removal was also documented when RFC 73 was approved a few months ago
> https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn
>
> We could have perhaps actually called the version 3.0.
>
> >
> > I'd be happy to do the work, once I find the commit where the function
> was
> > removed.
>
> in mega-commit 8e5eeb35bf76390e3134a4ea7076dab7d478ea0e
>
> Even
>
>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190422/7bc0a707/attachment.html>

From even.rouault at spatialys.com  Mon Apr 22 08:16:56 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Apr 2019 17:16:56 +0200
Subject: [gdal-dev] Restoring functions removed in 2.5 beta1
In-Reply-To: <CADPhZXxW1Nyzdt_UFzM+FeAmaj-4YMwPQwnkmOA21jhdZSLMuA@mail.gmail.com>
References: <CADPhZXw22Ado4NLxxQxDpGQ3GWQ9+icW1Y0d69oR8RYf0YtKdw@mail.gmail.com>
 <2147401.CZJPKjSAsj@even-i700>
 <CADPhZXxW1Nyzdt_UFzM+FeAmaj-4YMwPQwnkmOA21jhdZSLMuA@mail.gmail.com>
Message-ID: <1766423.0tEemXvMCA@even-i700>

On lundi 22 avril 2019 09:07:30 CEST Sean Gillies wrote:
> Hi Even,
> 
> On Sun, Apr 21, 2019 at 4:09 PM Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Sean,
> > 
> > > The Fiona and Rasterio projects won't build with the pre-release
> > > because,
> > > for better or worse, they reference and use OSRFixup, which has been
> > > removed. I've filed issue #1466 about this.
> > > 
> > > Yes, we can add shims to Fiona and Rasterio so we can support versions
> > > 2.0-2.5, but this does nothing for software that's already installed on
> > > computers. If a no-op version of OSRFixup were restored to GDAL 2.5,
> > 
> > these
> > 
> > > projects and previously installed versions of them would likely work
> > > just
> > > fine with 2.5.
> > 
> > I'm not so sure restoring the functions is enough. This might give a false
> > impression. More testing & other changes will generally be needed because
> > of
> > all the revamp that has done in that area of SRS functionnality, like
> > changes
> > in axis order.
> 
> I had the impression from reading RFC 73 that the data-crs axes mapping
> concerns would be, with a few exceptions, internal to GDAL and OGR and that
> things would be unchanged for Rasterio and Fiona. Specifically, the intent
> is that OGR_G_GetX and OGR_G_GetY (used by Fiona:
> https://github.com/Toblerity/Fiona/blob/master/fiona/_geometry.pyx#L123)
> will by default return the same values in GIS-friendly order as in 2.4. Yes?

Yes, retrieving geometries from drivers shouln't change.

But if you use the OGRCoordinateTransformation class with OGRSpatialReference 
objects created from scratch, they will honour EPSG axis order by default (if 
using EPSG based CRS).
I think you're just in that case with:
https://github.com/Toblerity/Fiona/blob/master/fiona/_transform.pyx
To get previous behaviour you'll need to call
OSRSetAxisMappingStrategy(hSRS, OAMS_TRADITIONAL_GIS_ORDER) on the SRS object 
you've created.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Mon Apr 22 14:49:28 2019
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 22 Apr 2019 23:49:28 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
 and STATENT)
In-Reply-To: <CAFcOn2_AM7wSuq-zZ558exC9+gkBPDJJWm6ZBb4NrZAVJXd02A@mail.gmail.com>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
 <4475111.vbl6GUhheB@even-i700>
 <CAFcOn2_AM7wSuq-zZ558exC9+gkBPDJJWm6ZBb4NrZAVJXd02A@mail.gmail.com>
Message-ID: <CAFcOn2_Jm_Oviq=MRhWPMgnhn+3fVY_TBuErX+=BcqQcfk02LA@mail.gmail.com>

Even,

As said my point input data already has regular, constant spaces,
namely 100 meters in X and Y, with e.g. extent (2661900, 1253800) -
(2668400, 1261300), map units are meters (SRS EPSG:2056).

I managed to convert my data using following gdal_grid command
> gdal_grid -ot UInt16 -of GTiff -zfield "C1" in.gpkg out.tif

Now I still have an issue with the output pixel size which was
27.41341571800429122,-27.41341571800429122 meters
But what I want is a pixel size with exactly same spacing as input
points, namely 100,-100 (meters).
I know there's the gdal_grid options -txe/-tye/-outsize, but I'd like
to avoid calculating these by hand.
In addition IMHO there's no need interpolation at all (or nearest
neighbor at most), since input point is already in place, ready for
output.

Is there a solution for just setting output pixel size in map units
(or am I missing something)?

:Stefan

Am So., 21. Apr. 2019 um 14:48 Uhr schrieb Stefan Keller <sfkeller at gmail.com>:
>
> Hi Even
>
> Thx very much!
> I'll try that way and will report.
>
> :Stefan
>
> Am So., 21. Apr. 2019 um 11:31 Uhr schrieb Even Rouault
> <even.rouault at spatialys.com>:
> >
> > Stefan,
> >
> > >
> > > The Swiss Statistical Office curates well-known datasets informally
> > > called "Hectare Raster" (STATPOP and STATENT) which obviously are
> > > ASCII Gridded XYZ, like this:
> > >
> > > "RELI" "X" "Y" "C1" "C2" "C3"
> > > 66192542 661900 254200 1 2 3 ...
> > > 66192543 661900 254300 1 2 3 ...
> > > 66192599 661900 259900 1 2 3 ...
> > > 66192600 661900 260000 1 2 3 ...
> > > ...
> > >
> > > This obviously is a regular gridded X and Y, sorted by X,Y but
> > > obviously also has gaps and more than one  "Z" (C1, C2, C3). Typically
> > > this is converted to a raster format like GeoTIFF and analysed through
> > > map algebra.
> > >
> > > Question 1: The GDAL docs (https://www.gdal.org/frmt_xyz.html ) says
> > > "...no missing value is supported.". In fact, I think it supports them
> > > by omitting lines by setting missing "lines" to NODATA.
> > > => Correct?
> >
> > The driver is quite picky. I don't think it will support missing values in the
> > middle of a line of same Y value. It supports missing values at the beginning
> > or end of a line of same Y value. And points must be sorted by increasing or
> > decreasing Y, and increasing X value for a line of same Y value.
> >
> > >
> > > Question 2: I think, there is a way (which could be mentioned in the
> > > docs above), to determine the "Z" value to be converted by gdal_grid
> > > explained in "Reading comma separated values"
> > > (https://www.gdal.org/gdal_grid.html#gdal_grid_csv ).
> > > So XYZ in fact is XYZx meaning that potentially there can be many "Z"
> > > in the input file, but only one can be included.
> > > => What do you think?
> >
> > The best way might probably to read the file with the CSV driver indeed. With
> > CSV:the_filename if the_filename has not a .csv extension
> > Convert it to something with a spatial index like a shapefile or GPKG if the
> > file is big
> > And then use gdal_grid to create a raster from it.
> >
> > >
> > > Question 3 (the fundamental one): Although XYZ format requires to
> > > contain regular gridded coordinates, it's technically handled the same
> > > as irregular coordinates (without interpolation) - at least regarding
> > > the main task to convert an sparse array of values to a raster format.
> > > => Correct?
> >
> > The XYZ driver requires constant spacing.
> >
> > Even
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

From alexmahrou at gmail.com  Mon Apr 22 20:51:02 2019
From: alexmahrou at gmail.com (Alex)
Date: Mon, 22 Apr 2019 21:51:02 -0600
Subject: [gdal-dev] Can't build GDAL from Source on Ubuntu Linux 16.04 x64
Message-ID: <CADQb9ef7f7Fsu41JQ9QuAJ6iuN9jjFKfRMBz22rH_UBL-P2N5Q@mail.gmail.com>

Hello List,

I'm new, so please bear with me. I'm having issues building GDAL from
source-- specifically 2.3.3. I"m just trying to install it with the
Extensis MrSID plugin. This seems to be the only pathway to read MrSID
files. I have attached my errors and config logs. Any help is truly
appreciated.

I didn't want to post this on github issues, because I can almost guarantee
I'm doing something wrong. lol.

Thank you in advance. All of my system and version information can be
gleaned from the configure.txt and make.txt in the links below.

https://drive.google.com/open?id=1k2HzMsI3cZKbrjioptRJUX21DDvNLOHK

https://drive.google.com/open?id=10o8IXuh17FGcQ3zltCRJyeHbKrWMuX7q

Thanks!

Alex
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190422/5c99b37d/attachment.html>

From even.rouault at spatialys.com  Tue Apr 23 01:41:37 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 23 Apr 2019 10:41:37 +0200
Subject: [gdal-dev] Can't build GDAL from Source on Ubuntu Linux 16.04
	x64
In-Reply-To: <CADQb9ef7f7Fsu41JQ9QuAJ6iuN9jjFKfRMBz22rH_UBL-P2N5Q@mail.gmail.com>
References: <CADQb9ef7f7Fsu41JQ9QuAJ6iuN9jjFKfRMBz22rH_UBL-P2N5Q@mail.gmail.com>
Message-ID: <2208288.P8IqSgDQI2@even-i700>

Alex,

GDAL doesn't set the rpath when linking to external libraries, which causes such issue with libtool-based builds
The fix is to define the paths to the MrSID libraries in LD_LIBRARY_PATH

export LD_LIBRARY_PATH=/home/edma/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Raster_DSDK/lib:/home/edma/MrSID_DSDK-9.5.4.4709-rhel6.x86-64.gcc531/Lidar_DSDK/lib:$LD_LIBRARY_PATH

Note: in your make log, you also have unrelated linking issues with libkea. you probably attempted a previous build against it.
I suggest you 'make clean' each time you run ./configure before rebuilding

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Wed Apr 24 15:26:35 2019
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 25 Apr 2019 00:26:35 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
 and STATENT)
In-Reply-To: <CAFcOn2_Jm_Oviq=MRhWPMgnhn+3fVY_TBuErX+=BcqQcfk02LA@mail.gmail.com>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
 <4475111.vbl6GUhheB@even-i700>
 <CAFcOn2_AM7wSuq-zZ558exC9+gkBPDJJWm6ZBb4NrZAVJXd02A@mail.gmail.com>
 <CAFcOn2_Jm_Oviq=MRhWPMgnhn+3fVY_TBuErX+=BcqQcfk02LA@mail.gmail.com>
Message-ID: <CAFcOn28QFW_7Fp35SCDX52Aps7NN8WEfX+96O+CtYdhazADtrQ@mail.gmail.com>

Hi,

Am 22. Apr. 2019 23:49 wrote regarding gdal_grid:
> Is there a solution for just setting output pixel size in map units

By guessing the "-outsize 65 75" (no. of X and Y lines) I finally got
a result which contained a pixel size of 100, -100 meters plus
sensible values:

# gdal_grid -ot UInt16 -of GTiff -zfield "C3" -a
nearest:radius1=71:radius2=71 -outsize 65 75 in.gpkg out.tif

=> But, I'm still looking for a hint to set pixel sizes without
guessing or calculating the "outsize" from the extents of the input
file.

Then, I observed another problem: One obviously has no choice in
gdal_grid than to choose an interpolation method. As one can see from
the command above, I've chosen "nearest neighbour" as interpolation
method (option "-a nearest:radius1=71:radius2=71").

Now, this worked somehow - but not exactly: In almost all cases a
single input grid point (which "sits" at the junction of four pixels)
affected two or three neighboring pixels in the raster output.
=> But what I'm after is, that one input grid point only sets the
value of one pixel (say lower left pixel) in the raster output!

Which "neighboring" pixel exactly is of secondary importance here.
Main point is that one input value maps to only _one_ (not many) pixel
in the raster output.

:Stefan


Am Mo., 22. Apr. 2019 um 23:49 Uhr schrieb Stefan Keller <sfkeller at gmail.com>:
>
> Even,
>
> As said my point input data already has regular, constant spaces,
> namely 100 meters in X and Y, with e.g. extent (2661900, 1253800) -
> (2668400, 1261300), map units are meters (SRS EPSG:2056).
>
> I managed to convert my data using following gdal_grid command
> > gdal_grid -ot UInt16 -of GTiff -zfield "C1" in.gpkg out.tif
>
> Now I still have an issue with the output pixel size which was
> 27.41341571800429122,-27.41341571800429122 meters
> But what I want is a pixel size with exactly same spacing as input
> points, namely 100,-100 (meters).
> I know there's the gdal_grid options -txe/-tye/-outsize, but I'd like
> to avoid calculating these by hand.
> In addition IMHO there's no need interpolation at all (or nearest
> neighbor at most), since input point is already in place, ready for
> output.
>
> Is there a solution for just setting output pixel size in map units
> (or am I missing something)?
>
> :Stefan
>
> Am So., 21. Apr. 2019 um 14:48 Uhr schrieb Stefan Keller <sfkeller at gmail.com>:
> >
> > Hi Even
> >
> > Thx very much!
> > I'll try that way and will report.
> >
> > :Stefan
> >
> > Am So., 21. Apr. 2019 um 11:31 Uhr schrieb Even Rouault
> > <even.rouault at spatialys.com>:
> > >
> > > Stefan,
> > >
> > > >
> > > > The Swiss Statistical Office curates well-known datasets informally
> > > > called "Hectare Raster" (STATPOP and STATENT) which obviously are
> > > > ASCII Gridded XYZ, like this:
> > > >
> > > > "RELI" "X" "Y" "C1" "C2" "C3"
> > > > 66192542 661900 254200 1 2 3 ...
> > > > 66192543 661900 254300 1 2 3 ...
> > > > 66192599 661900 259900 1 2 3 ...
> > > > 66192600 661900 260000 1 2 3 ...
> > > > ...
> > > >
> > > > This obviously is a regular gridded X and Y, sorted by X,Y but
> > > > obviously also has gaps and more than one  "Z" (C1, C2, C3). Typically
> > > > this is converted to a raster format like GeoTIFF and analysed through
> > > > map algebra.
> > > >
> > > > Question 1: The GDAL docs (https://www.gdal.org/frmt_xyz.html ) says
> > > > "...no missing value is supported.". In fact, I think it supports them
> > > > by omitting lines by setting missing "lines" to NODATA.
> > > > => Correct?
> > >
> > > The driver is quite picky. I don't think it will support missing values in the
> > > middle of a line of same Y value. It supports missing values at the beginning
> > > or end of a line of same Y value. And points must be sorted by increasing or
> > > decreasing Y, and increasing X value for a line of same Y value.
> > >
> > > >
> > > > Question 2: I think, there is a way (which could be mentioned in the
> > > > docs above), to determine the "Z" value to be converted by gdal_grid
> > > > explained in "Reading comma separated values"
> > > > (https://www.gdal.org/gdal_grid.html#gdal_grid_csv ).
> > > > So XYZ in fact is XYZx meaning that potentially there can be many "Z"
> > > > in the input file, but only one can be included.
> > > > => What do you think?
> > >
> > > The best way might probably to read the file with the CSV driver indeed. With
> > > CSV:the_filename if the_filename has not a .csv extension
> > > Convert it to something with a spatial index like a shapefile or GPKG if the
> > > file is big
> > > And then use gdal_grid to create a raster from it.
> > >
> > > >
> > > > Question 3 (the fundamental one): Although XYZ format requires to
> > > > contain regular gridded coordinates, it's technically handled the same
> > > > as irregular coordinates (without interpolation) - at least regarding
> > > > the main task to convert an sparse array of values to a raster format.
> > > > => Correct?
> > >
> > > The XYZ driver requires constant spacing.
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com

From even.rouault at spatialys.com  Wed Apr 24 16:04:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 25 Apr 2019 01:04:17 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
	and STATENT)
In-Reply-To: <CAFcOn28QFW_7Fp35SCDX52Aps7NN8WEfX+96O+CtYdhazADtrQ@mail.gmail.com>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
 <CAFcOn2_Jm_Oviq=MRhWPMgnhn+3fVY_TBuErX+=BcqQcfk02LA@mail.gmail.com>
 <CAFcOn28QFW_7Fp35SCDX52Aps7NN8WEfX+96O+CtYdhazADtrQ@mail.gmail.com>
Message-ID: <1951928.GZuxpYx1Nc@even-i700>

On jeudi 25 avril 2019 00:26:35 CEST Stefan Keller wrote:
> Hi,
> 
> Am 22. Apr. 2019 23:49 wrote regarding gdal_grid:
> > Is there a solution for just setting output pixel size in map units
> 
> By guessing the "-outsize 65 75" (no. of X and Y lines) I finally got
> a result which contained a pixel size of 100, -100 meters plus
> sensible values:
> 
> # gdal_grid -ot UInt16 -of GTiff -zfield "C3" -a
> nearest:radius1=71:radius2=71 -outsize 65 75 in.gpkg out.tif
> 
> => But, I'm still looking for a hint to set pixel sizes without
> guessing or calculating the "outsize" from the extents of the input
> file.

This is left as an exercice to the contributor to implement a -tr option 
similar to gdalwarp / gdal_translate.

> 
> Then, I observed another problem: One obviously has no choice in
> gdal_grid than to choose an interpolation method. As one can see from
> the command above, I've chosen "nearest neighbour" as interpolation
> method (option "-a nearest:radius1=71:radius2=71").

Why 71 ? If you're grid size is 100 meters, then less than 50 meters would be 
a good radius
You would also need to grow the raster extent by a half-pixel size, so that 
the middle of each raster point matches exactly an exact x,y coordinate of 
your CSV (GDAL convention for georeferencing is the coordinate of the top-left 
corner of a pixel area, not its center)
By default, gdal_grid takes the extent of the vector file to set it as the 
extent of the raster file, and doesn't do this half-pixel extension, which is 
the likely cause for the effect you observed.

Example:

given grid.csv with

x,y,z
100,500,1
300,500,3
100,600,4
200,600,5
300,600,6

# note the missing value at 200,500

$ ogr2ogr grid.gpkg grid.csv -oo X_POSSIBLE_NAMES=x -oo Y_POSSIBLE_NAMES=y

# Note the extra small radius since the center of a raster grid matches a
# input vector point, or none
$ gdal_grid -a nearest:radius1=1:radius2=1:nodata=-99  grid.gpkg  grid.tif \
		-txe 50 350 -tye 650 450 -outsize 3 2 -zfield z	

$ gdal_translate grid.tif /vsistdout/ -of aaigrid
ncols        3
nrows        2
xllcorner    50.000000000000
yllcorner    450.000000000000
cellsize     100.000000000000
NODATA_value  -99
 4.0 5 6
 1 -99 3


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From emmburris at gmail.com  Wed Apr 24 16:15:04 2019
From: emmburris at gmail.com (Meghan Burris)
Date: Wed, 24 Apr 2019 16:15:04 -0700
Subject: [gdal-dev] Change an image from 0-360 to -180 to 180
Message-ID: <CAFO=5LXsUKHTvH7D0tD9YBt4XbQM75B6K5Xr4984yDxkXTD=3A@mail.gmail.com>

Hello,

I have an image that is 0-360 degrees but I want to visualize it in -180 to
180 degrees. Everything I try makes the western hemisphere (-180-0)
completely black, so half the map doesn't get displayed. Any chance there
is an easy fix to this?

Thank you so much for any help!

- Em
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190424/0229876e/attachment.html>

From sfkeller at gmail.com  Wed Apr 24 16:20:14 2019
From: sfkeller at gmail.com (Stefan Keller)
Date: Thu, 25 Apr 2019 01:20:14 +0200
Subject: [gdal-dev] ASCII Gridded XYZ and "Hectare Raster" data (STATPOP
 and STATENT)
In-Reply-To: <1951928.GZuxpYx1Nc@even-i700>
References: <CAFcOn2-C4xsyOGvFRi07sBnD9xGWn_rvKSWmMH+SW_uOQzqjMg@mail.gmail.com>
 <CAFcOn2_Jm_Oviq=MRhWPMgnhn+3fVY_TBuErX+=BcqQcfk02LA@mail.gmail.com>
 <CAFcOn28QFW_7Fp35SCDX52Aps7NN8WEfX+96O+CtYdhazADtrQ@mail.gmail.com>
 <1951928.GZuxpYx1Nc@even-i700>
Message-ID: <CAFcOn29=i5dpNoBkCY1oWXiu2NWcQbEutxp+mLgnk0C+xKUWjQ@mail.gmail.com>

25. Apr. 2019 01:04 Uhr Even Rouault wrote:
> > => But, I'm still looking for a hint to set pixel sizes without
> > guessing or calculating the "outsize" from the extents of the input
> > file.
>
> This is left as an exercice to the contributor to implement a -tr option
> similar to gdalwarp / gdal_translate.

Got it :-)
In the meantime I try to sort out a calculation by hand.

> You would also need to grow the raster extent by a half-pixel size, so that
> the middle of each raster point matches exactly an exact x,y coordinate of
> your CSV ...

Now everything makes sense to me!
I had to read the above sentence twice, though.
And I'm now realizing the meaning of -txe/-tye.

Merci beaucoups! I'll try that.
:Stefan


Am Do., 25. Apr. 2019 um 01:04 Uhr schrieb Even Rouault
<even.rouault at spatialys.com>:
>
> On jeudi 25 avril 2019 00:26:35 CEST Stefan Keller wrote:
> > Hi,
> >
> > Am 22. Apr. 2019 23:49 wrote regarding gdal_grid:
> > > Is there a solution for just setting output pixel size in map units
> >
> > By guessing the "-outsize 65 75" (no. of X and Y lines) I finally got
> > a result which contained a pixel size of 100, -100 meters plus
> > sensible values:
> >
> > # gdal_grid -ot UInt16 -of GTiff -zfield "C3" -a
> > nearest:radius1=71:radius2=71 -outsize 65 75 in.gpkg out.tif
> >
> > => But, I'm still looking for a hint to set pixel sizes without
> > guessing or calculating the "outsize" from the extents of the input
> > file.
>
> This is left as an exercice to the contributor to implement a -tr option
> similar to gdalwarp / gdal_translate.
>
> >
> > Then, I observed another problem: One obviously has no choice in
> > gdal_grid than to choose an interpolation method. As one can see from
> > the command above, I've chosen "nearest neighbour" as interpolation
> > method (option "-a nearest:radius1=71:radius2=71").
>
> Why 71 ? If you're grid size is 100 meters, then less than 50 meters would be
> a good radius
> You would also need to grow the raster extent by a half-pixel size, so that
> the middle of each raster point matches exactly an exact x,y coordinate of
> your CSV (GDAL convention for georeferencing is the coordinate of the top-left
> corner of a pixel area, not its center)
> By default, gdal_grid takes the extent of the vector file to set it as the
> extent of the raster file, and doesn't do this half-pixel extension, which is
> the likely cause for the effect you observed.
>
> Example:
>
> given grid.csv with
>
> x,y,z
> 100,500,1
> 300,500,3
> 100,600,4
> 200,600,5
> 300,600,6
>
> # note the missing value at 200,500
>
> $ ogr2ogr grid.gpkg grid.csv -oo X_POSSIBLE_NAMES=x -oo Y_POSSIBLE_NAMES=y
>
> # Note the extra small radius since the center of a raster grid matches a
> # input vector point, or none
> $ gdal_grid -a nearest:radius1=1:radius2=1:nodata=-99  grid.gpkg  grid.tif \
>                 -txe 50 350 -tye 650 450 -outsize 3 2 -zfield z
>
> $ gdal_translate grid.tif /vsistdout/ -of aaigrid
> ncols        3
> nrows        2
> xllcorner    50.000000000000
> yllcorner    450.000000000000
> cellsize     100.000000000000
> NODATA_value  -99
>  4.0 5 6
>  1 -99 3
>
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From thare at usgs.gov  Wed Apr 24 16:27:01 2019
From: thare at usgs.gov (Hare, Trent)
Date: Wed, 24 Apr 2019 16:27:01 -0700
Subject: [gdal-dev] [EXTERNAL] Change an image from 0-360 to -180 to 180
In-Reply-To: <CAFO=5LXsUKHTvH7D0tD9YBt4XbQM75B6K5Xr4984yDxkXTD=3A@mail.gmail.com>
References: <CAFO=5LXsUKHTvH7D0tD9YBt4XbQM75B6K5Xr4984yDxkXTD=3A@mail.gmail.com>
Message-ID: <CAB6t5t_9t92Z676K9fxV2kNGvK5-S3wMzuL7zg1zyp8b1yE-Kw@mail.gmail.com>

Maghan,
    I prefer the VRT method (near the end of this page
<http://trac.osgeo.org/gdal/wiki/UserDocs/RasterProcTutorial>) which I use
all the time, but this page (listed next, which also lists this VRT method)
has a couple other options:
https://gis.stackexchange.com/questions/37790/how-to-reproject-raster-from-0-360-to-180-180-with-cutting-180-meridian


good luck,
Trent

On Wed, Apr 24, 2019 at 4:16 PM Meghan Burris <emmburris at gmail.com> wrote:

> Hello,
>
> I have an image that is 0-360 degrees but I want to visualize it in -180
> to 180 degrees. Everything I try makes the western hemisphere (-180-0)
> completely black, so half the map doesn't get displayed. Any chance there
> is an easy fix to this?
>
> Thank you so much for any help!
>
> - Em
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190424/2bccd024/attachment-0001.html>

From emmburris at gmail.com  Wed Apr 24 16:54:10 2019
From: emmburris at gmail.com (Meghan Burris)
Date: Wed, 24 Apr 2019 16:54:10 -0700
Subject: [gdal-dev] [EXTERNAL] Change an image from 0-360 to -180 to 180
In-Reply-To: <CAB6t5t_9t92Z676K9fxV2kNGvK5-S3wMzuL7zg1zyp8b1yE-Kw@mail.gmail.com>
References: <CAFO=5LXsUKHTvH7D0tD9YBt4XbQM75B6K5Xr4984yDxkXTD=3A@mail.gmail.com>
 <CAB6t5t_9t92Z676K9fxV2kNGvK5-S3wMzuL7zg1zyp8b1yE-Kw@mail.gmail.com>
Message-ID: <CAFO=5LXifsiuvcq-reXZfgmePuzNJ-_u=o2Y=8TgUQKv5=b_8g@mail.gmail.com>

Thanks Trent!

I'll take a look at that right now. I appreciate your help.


On Wed, Apr 24, 2019 at 4:27 PM Hare, Trent <thare at usgs.gov> wrote:

> Maghan,
>     I prefer the VRT method (near the end of this page
> <http://trac.osgeo.org/gdal/wiki/UserDocs/RasterProcTutorial>) which I
> use all the time, but this page (listed next, which also lists this VRT
> method) has a couple other options:
>
> https://gis.stackexchange.com/questions/37790/how-to-reproject-raster-from-0-360-to-180-180-with-cutting-180-meridian
>
>
> good luck,
> Trent
>
> On Wed, Apr 24, 2019 at 4:16 PM Meghan Burris <emmburris at gmail.com> wrote:
>
>> Hello,
>>
>> I have an image that is 0-360 degrees but I want to visualize it in -180
>> to 180 degrees. Everything I try makes the western hemisphere (-180-0)
>> completely black, so half the map doesn't get displayed. Any chance there
>> is an easy fix to this?
>>
>> Thank you so much for any help!
>>
>> - Em
>>
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190424/8f6e4eb1/attachment.html>

From even.rouault at spatialys.com  Thu Apr 25 12:38:23 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 25 Apr 2019 21:38:23 +0200
Subject: [gdal-dev] GDAL Docker images
Message-ID: <2193087.LVTVogp97j@even-i700>

Hi,

I've prepared a set of Dockerfile for different configurations.
See
https://github.com/OSGeo/gdal/blob/master/gdal/docker/README.md

The scope of each is rather arbitrary, but this can be used as a base for 
derived works.

View on Docker Hub:
https://hub.docker.com/r/osgeo/gdal

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From vincent.sarago at gmail.com  Thu Apr 25 12:41:15 2019
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 25 Apr 2019 15:41:15 -0400
Subject: [gdal-dev] GDAL Docker images
In-Reply-To: <2193087.LVTVogp97j@even-i700>
References: <2193087.LVTVogp97j@even-i700>
Message-ID: <6250AC6B-51B8-4484-887E-F5C0CB2C0365@gmail.com>

This is great, thanks Even. 

Because I’m mostly working with AWS Lambda, I might open a PR to add a CENTOS based image (ref: https://github.com/RemotePixel/amazonlinux-gdal <https://github.com/RemotePixel/amazonlinux-gdal>) if this is ok ;-) 

Vincent

> Le 25 avr. 2019 à 15:38, Even Rouault <even.rouault at spatialys.com> a écrit :
> 
> Hi,
> 
> I've prepared a set of Dockerfile for different configurations.
> See
> https://github.com/OSGeo/gdal/blob/master/gdal/docker/README.md
> 
> The scope of each is rather arbitrary, but this can be used as a base for 
> derived works.
> 
> View on Docker Hub:
> https://hub.docker.com/r/osgeo/gdal
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190425/48fb69e9/attachment.html>

From luipir at gmail.com  Thu Apr 25 12:54:16 2019
From: luipir at gmail.com (Luigi Pirelli)
Date: Thu, 25 Apr 2019 21:54:16 +0200
Subject: [gdal-dev] GDAL Docker images
In-Reply-To: <2193087.LVTVogp97j@even-i700>
References: <2193087.LVTVogp97j@even-i700>
Message-ID: <CAFO80_pdusik-rsm=f1zTMvFeEVzEvZU5JtH=trWf6v5BDoGxw@mail.gmail.com>

great... I will update my gdal with ecw container to shirk as much as
possible

https://hub.docker.com/r/ginetto/gdal
with related Dockerfile and compose
https://github.com/luipir/docker-gdalecw

I did a new container because (AFAIK) there weren't one available, updated
and documented.
Mine is based on debian:stable-slim

Luigi Pirelli

**************************************************************************************************
* LinkedIn: https://www.linkedin.com/in/luigipirelli
* Stackexchange: http://gis.stackexchange.com/users/19667/luigi-pirelli
* GitHub: https://github.com/luipir
* Mastering QGIS 2nd Edition:
*
https://www.packtpub.com/big-data-and-business-intelligence/mastering-qgis-second-edition
* Hire me: http://goo.gl/BYRQKg
**************************************************************************************************


On Thu, 25 Apr 2019 at 21:38, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've prepared a set of Dockerfile for different configurations.
> See
> https://github.com/OSGeo/gdal/blob/master/gdal/docker/README.md
>
> The scope of each is rather arbitrary, but this can be used as a base for
> derived works.
>
> View on Docker Hub:
> https://hub.docker.com/r/osgeo/gdal
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190425/9b041fc5/attachment.html>

From tobias.wendorff at tu-dortmund.de  Thu Apr 25 22:41:04 2019
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Fri, 26 Apr 2019 07:41:04 +0200
Subject: [gdal-dev] GDAL Docker images
In-Reply-To: <2193087.LVTVogp97j@even-i700>
References: <2193087.LVTVogp97j@even-i700>
Message-ID: <7ec47d01660add1f7ad530ac998fb4f6.squirrel@webmail.tu-dortmund.de>

Am Do, 25.04.2019, 21:38 schrieb Even Rouault:
>
> I've prepared a set of Dockerfile for different configurations.

I cannot find a like button so: THANKS :-)


From even.rouault at spatialys.com  Fri Apr 26 07:24:09 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 26 Apr 2019 16:24:09 +0200
Subject: [gdal-dev] GDAL Docker images
In-Reply-To: <6250AC6B-51B8-4484-887E-F5C0CB2C0365@gmail.com>
References: <2193087.LVTVogp97j@even-i700>
 <6250AC6B-51B8-4484-887E-F5C0CB2C0365@gmail.com>
Message-ID: <10591307.nvbbyETmVs@even-i700>

On jeudi 25 avril 2019 15:41:15 CEST Vincent Sarago wrote:
> This is great, thanks Even.
> 
> Because I’m mostly working with AWS Lambda, I might open a PR to add a
> CENTOS based image (ref: https://github.com/RemotePixel/amazonlinux-gdal
> <https://github.com/RemotePixel/amazonlinux-gdal>) if this is ok ;-)

Sure, improvements / additions are welcome. (although there will be a point 
where too many configurations will be hard to maintain)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Apr 26 08:38:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 26 Apr 2019 17:38:59 +0200
Subject: [gdal-dev] GDAL 2.5.0 RC1 is available
Message-ID: <10379597.VnhhzO3lgt@even-i700>

Hi,

I've issued a release candidate for GDAL 2.5.0.

Nothing really significant since beta1.

The source is available at:

    http://download.osgeo.org/gdal/2.5.0/gdal-2.5.0rc1.tar.xz
    http://download.osgeo.org/gdal/2.5.0/gdal-2.5.0rc1.tar.gz
    http://download.osgeo.org/gdal/2.5.0/gdal250rc1.zip

A snapshot of the Python autotest suite can be downloaded from:

    http://download.osgeo.org/gdal/2.5.0/gdalautotest-2.5.0rc1.tar.gz
    http://download.osgeo.org/gdal/2.5.0/gdalautotest-2.5.0rc1.zip

The GDAL-GRASS plugin hasn't changed since beta1 :

    http://download.osgeo.org/gdal/2.5.0/gdal-grass-2.5.0.tar.gz

Snapshot of the documentation :

    http://download.osgeo.org/gdal/2.5.0/gdal250doc.zip

The NEWS page has been updated:

   https://trac.osgeo.org/gdal/wiki/Release/2.5.0-News

~~~~~

I'll call for a vote to promote it to final middle of next week if nothing 
serious is reported before.

A release/2.5 branch has been created. All 2.5 bugfixes should go there and in 
master. master is now open for 2.6.0dev

~~~~~

I've pushed a few Docker tags with RC1 (and PROJ master)
osgeo/gdal:
	alpine-ultrasmall-v2.5.0RC1
	alpine-small-v2.5.0RC1
	alpine-normal-v2.5.0RC1
	ubuntu-small-v2.5.0RC1
	ubuntu-full-v2.5.0RC1

I've improved the layering strategy, so, once you get a new base version, 
pulling should only fetch at most 30 MBs if only GDAL changes, even for the 
largest images.

~~~~~

Remainder:
GDAL 2.5.0 *requires* PROJ >= 6.0, and if using external libgeotiff, 
libgeotiff >= 1.5.0
In case you didn't follow recent developments, a revamp has been done in the 
area of coordinate reference systems, which may impact downstream users & code 
of GDAL. Consult 
https://github.com/OSGeo/gdal/blob/master/gdal/MIGRATION_GUIDE.TXT
and
https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bontepaarden at gmail.com  Sat Apr 27 08:09:51 2019
From: bontepaarden at gmail.com (Paul Meems)
Date: Sat, 27 Apr 2019 17:09:51 +0200
Subject: [gdal-dev] UK Ordnance Survey grid references
Message-ID: <CAHNf2YRdk9pe5m2qyKs2B4M1=QZK96f=Nw9Z9=RRCWqzDfXtsQ@mail.gmail.com>

Hi,

I'm not sure if this is the correct list, it might be I need to ask this on
the proj4-list.
Because I'm not a member of that list, I try here first.

Can GDAL/OGR/Proj4 convert lat/long coordinates to Ordnance Survey grid
references?
I've been searching for an answer and found only this page:
https://digimap.edina.ac.uk/webhelp/digimapgis/projections_and_transformations/transformations_in_gdalogr.htm
suggesting
it is possible with GDAL after some changes.
But I can't find an example of how to convert '-2.02903211116781,
53.4040442788744' to 'SJ981896'.

Is this possible with GDAL? If so do I still make the changes mentioned on
the webpage and how would the code look like to do this?

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190427/ac1b7e4c/attachment.html>

From even.rouault at spatialys.com  Sat Apr 27 09:17:12 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 27 Apr 2019 18:17:12 +0200
Subject: [gdal-dev] UK Ordnance Survey grid references
In-Reply-To: <CAHNf2YRdk9pe5m2qyKs2B4M1=QZK96f=Nw9Z9=RRCWqzDfXtsQ@mail.gmail.com>
References: <CAHNf2YRdk9pe5m2qyKs2B4M1=QZK96f=Nw9Z9=RRCWqzDfXtsQ@mail.gmail.com>
Message-ID: <8748028.uq1Ttvpv9q@even-i700>

On samedi 27 avril 2019 17:09:51 CEST Paul Meems wrote:
> Hi,
> 
> I'm not sure if this is the correct list, it might be I need to ask this on
> the proj4-list.
> Because I'm not a member of that list, I try here first.
> 
> Can GDAL/OGR/Proj4 convert lat/long coordinates to Ordnance Survey grid
> references?
> I've been searching for an answer and found only this page:
> https://digimap.edina.ac.uk/webhelp/digimapgis/projections_and_transformatio
> ns/transformations_in_gdalogr.htm suggesting
> it is possible with GDAL after some changes.
> But I can't find an example of how to convert '-2.02903211116781,
> 53.4040442788744' to 'SJ981896'.

I'm not a specialist of this grid reference, but based on the information
https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid
here's how I would do the conversion.

First, in which CRS are those coordinates: in OSGB36 (EPSG:4277) or WGS84 (EPSG:4326) ?
Anyway given that the grid coordinates have 6 figures, thus 3 figures
for easting and northing, SJ981896 has only 100 meter precision (the page you
reference is just about using more accurate datum shift parameters, but this is
only if you are interested in ~1 meter precision, not 100 meter precision)

Let's assume they are already in OSGB36, and transform them to the
"OSGB 1936 / British National Grid" projected CRS (EPSG:27700):

$ echo "-2.02903211116781 53.4040442788744" | \
	 gdaltransform -s_srs EPSG:4277 -t_srs EPSG:27700

==> 398070.067760347 389720.9200866 0

So let drop the sub-meter precision and isolate the figures that are multiple of 100km in those coordinates:
3 98070, 3 89720
and drop the last 2 figures and round appropriately, to get only 4 digits
3 981, 3 897

Now let's find the square of 100km x 100km whose bottom left coordinate is
x=3 and y=3, which according to 
https://en.wikipedia.org/wiki/Ordnance_Survey_National_Grid#/media/File:British_National_Grid.svg
is SJ (SV is located at x=0 and y=0)

Hence SJ981897

So GDAL & PROJ handle the transformation from geographic to projected coordinates.
The formatting of the projected coordinates to the national grid reference
is left as an exercice to users :-)
(I'd be surprised if there is no code in the wild that would do the whole conversion)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sat Apr 27 09:36:23 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 27 Apr 2019 18:36:23 +0200
Subject: [gdal-dev] UK Ordnance Survey grid references
In-Reply-To: <8748028.uq1Ttvpv9q@even-i700>
References: <CAHNf2YRdk9pe5m2qyKs2B4M1=QZK96f=Nw9Z9=RRCWqzDfXtsQ@mail.gmail.com>
 <8748028.uq1Ttvpv9q@even-i700>
Message-ID: <4143626.C1OTP2AhkC@even-i700>

> and drop the last 2 figures and round appropriately

Hum, after reflexion, rounding is likely not appropriate, as you give a 
position in a 100x100 square. So truncating should be rather done.

And if truncating is done, then I assume your input coordinates are in
EPSG:4326, since

$ echo "-2.02903211116781 53.4040442788744" | \
		gdaltransform -s_srs EPSG:4326 -t_srs EPSG:27700
398167.225983081 389691.930910573

Hence SJ981896 as you expected

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nyall.dawson at gmail.com  Sun Apr 28 18:26:06 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Mon, 29 Apr 2019 11:26:06 +1000
Subject: [gdal-dev] Building gdal master with proj master
Message-ID: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>

Hi list,

Trying to build gdal master using proj master today I'm unable to
resolve a bunch of "undefined reference to
`proj_create_conversion_oblique_stereographic'" style errors. I think
my issues come from trying to keep the custom proj build isolated from
my system version, but I'm stumped in how to fix this....

My build process is:

Proj:

./configure --prefix=/home/nyall/dev/build-proj
make
make install

GDAL:

./configure --prefix=/home/nyall/dev/build-gdal/
--with-proj=/home/nyall/dev/build-proj
make

Results in:

/bin/sh /home/nyall/dev/gdal/gdal/libtool --mode=compile --silent
--tag=CXX g++ -I/home/nyall/dev/gdal/gdal/port
-I/home/nyall/dev/gdal/gdal/gcore -I/home/nyall/dev/gdal/gdal/alg
-I/home/nyall/dev/gdal/gdal/ogr
-I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts
-I/home/nyall/dev/gdal/gdal/gnm -I/home/nyall/dev/gdal/gdal/apps
-DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME
-DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall -Wextra -Winit-self
-Wunused-parameter -Wformat -Werror=format-security
-Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
-Wnull-dereference -Wduplicated-cond -Wextra-semi -Wfloat-conversion
-Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
-fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
-Wimplicit-fallthrough  -I/home/nyall/dev/gdal/gdal/frmts/vrt
-DGNM_ENABLED -I/home/nyall/dev/gdal/gdal/port
-I/usr/include/openjpeg-2.3   -DGDAL_COMPILATION
-I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/geojson/libjson
-I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/geojson
-I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/generic
-I/home/nyall/dev/gdal/gdal/gnm -DHAVE_GEOS=1 -I/usr/include -c -o
gdaladdo.lo gdaladdo.cpp
/usr/bin/ld: /home/nyall/dev/gdal/gdal/.libs/libgdal.so: undefined
reference to `proj_create_conversion_oblique_stereographic'
...
collect2: error: ld returned 1 exit status
make[1]: *** [GNUmakefile:82: gdalinfo] Error 1

Any clues what I'm missing here?

Thanks,
Nyall

From andrew at aitchison.me.uk  Sun Apr 28 22:37:56 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Mon, 29 Apr 2019 06:37:56 +0100 (BST)
Subject: [gdal-dev] Building gdal master with proj master
In-Reply-To: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>
References: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>
Message-ID: <alpine.DEB.2.21.1904290631390.31463@warden.aitchison.me.uk>



On Mon, 29 Apr 2019, Nyall Dawson wrote:

> Hi list,
>
> Trying to build gdal master using proj master today I'm unable to
> resolve a bunch of "undefined reference to
> `proj_create_conversion_oblique_stereographic'" style errors. I think
> my issues come from trying to keep the custom proj build isolated from
> my system version, but I'm stumped in how to fix this....
>
> My build process is:
>
> Proj:
>
> ./configure --prefix=/home/nyall/dev/build-proj
> make
> make install
>
> GDAL:
>
> ./configure --prefix=/home/nyall/dev/build-gdal/
> --with-proj=/home/nyall/dev/build-proj
> make
>
> Results in:
>
> /bin/sh /home/nyall/dev/gdal/gdal/libtool --mode=compile --silent
> --tag=CXX g++ -I/home/nyall/dev/gdal/gdal/port
> -I/home/nyall/dev/gdal/gdal/gcore -I/home/nyall/dev/gdal/gdal/alg
> -I/home/nyall/dev/gdal/gdal/ogr
> -I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts
> -I/home/nyall/dev/gdal/gdal/gnm -I/home/nyall/dev/gdal/gdal/apps
> -DHAVE_AVX_AT_COMPILE_TIME -DHAVE_SSSE3_AT_COMPILE_TIME
> -DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall -Wextra -Winit-self
> -Wunused-parameter -Wformat -Werror=format-security
> -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
> -Wnull-dereference -Wduplicated-cond -Wextra-semi -Wfloat-conversion
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
> -Wimplicit-fallthrough  -I/home/nyall/dev/gdal/gdal/frmts/vrt
> -DGNM_ENABLED -I/home/nyall/dev/gdal/gdal/port
> -I/usr/include/openjpeg-2.3   -DGDAL_COMPILATION
> -I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/geojson/libjson
> -I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/geojson
> -I/home/nyall/dev/gdal/gdal/ogr/ogrsf_frmts/generic
> -I/home/nyall/dev/gdal/gdal/gnm -DHAVE_GEOS=1 -I/usr/include -c -o
> gdaladdo.lo gdaladdo.cpp
> /usr/bin/ld: /home/nyall/dev/gdal/gdal/.libs/libgdal.so: undefined
> reference to `proj_create_conversion_oblique_stereographic'
> ...
> collect2: error: ld returned 1 exit status
> make[1]: *** [GNUmakefile:82: gdalinfo] Error 1
>
> Any clues what I'm missing here?

I think that configure assumes that libtool will add 
/home/nyall/dev/build-proj/lib/libinternalproj.so

I see that my equivalent of
  /home/nyall/dev/build-proj/lib/pkgconfig/proj.pc
has
  Libs: -L${libdir} -lproj
but no mention of
 	-linternalproj

-- 
Andrew C. Aitchison					Cambridge, UK
 			andrew at aitchison.me.uk

From rdmailings at duif.net  Sun Apr 28 23:10:20 2019
From: rdmailings at duif.net (Richard Duivenvoorde)
Date: Mon, 29 Apr 2019 08:10:20 +0200
Subject: [gdal-dev] Building gdal master with proj master
In-Reply-To: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>
References: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>
Message-ID: <255852bc-9a22-3e23-6716-c1e6039e5a51@duif.net>

On 29/04/2019 03.26, Nyall Dawson wrote:
> Hi list,
> 
> Trying to build gdal master using proj master today I'm unable to
> resolve a bunch of "undefined reference to
> `proj_create_conversion_oblique_stereographic'" style errors. I think
> my issues come from trying to keep the custom proj build isolated from
> my system version, but I'm stumped in how to fix this....

Hi Nyall,

I build both gdal master and proj 6 last week (25th), using instructions
here:
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev

If on a machine having another (distro) proj around you have to go
through this renaming piece if I'm correct (well, Even told me :-) )

I used:

export LD_LIBRARY_PATH=/home/richard/bin/proj/lib:$LD_LIBRARY_PATH

./configure --prefix=/home/richard/bin/gdal
--with-proj=/home/richard/bin/proj --without-libtool --with-python
--without-ogdi

Be sure (below is Even's text...) to see:

# when configuring gdal
checking for PROJ >= 6 library... checking for proj_create_from_wkt in
-lproj... no  <== this is funny, tough, because I have 6.0 ....
checking for proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -lproj... no
checking for internal_proj_create_from_wkt in -linternalproj... yes  <== !!!

# check if libgdal.so is gelinked is with that libinternalproj:
cd /home/richard/bin/gdal/lib
export LD_LIBRARY_PATH=/home/richard/bin/proj/lib:$LD_LIBRARY_PATH
# make sure there is no /home/richard/bin/proj/lib/libproj.* files .
Only libinternalproj.so*
ldd libgdal.so | grep proj
       libinternalproj.so =>
/home/richard/bin/proj/lib/libinternalproj.so (0x00007f672346d000)

Hope this helps.

Regards,

Richard Duivenvoorde


From nyall.dawson at gmail.com  Sun Apr 28 23:47:38 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Mon, 29 Apr 2019 16:47:38 +1000
Subject: [gdal-dev] Building gdal master with proj master
In-Reply-To: <255852bc-9a22-3e23-6716-c1e6039e5a51@duif.net>
References: <CAB28AsiQR_3rDLj0yAxsrvFuepYSb0S+CBwE3XOnQVr-moY8nw@mail.gmail.com>
 <255852bc-9a22-3e23-6716-c1e6039e5a51@duif.net>
Message-ID: <CAB28Asjk=r2ogxpU_yq8Wp2o=M5JwXM7TL2sgHe35XY+OyV88Q@mail.gmail.com>

On Mon, 29 Apr 2019 at 16:10, Richard Duivenvoorde <rdmailings at duif.net> wrote:
>
> On 29/04/2019 03.26, Nyall Dawson wrote:
> > Hi list,
> >
> > Trying to build gdal master using proj master today I'm unable to
> > resolve a bunch of "undefined reference to
> > `proj_create_conversion_oblique_stereographic'" style errors. I think
> > my issues come from trying to keep the custom proj build isolated from
> > my system version, but I'm stumped in how to fix this....
>
> Hi Nyall,
>
> I build both gdal master and proj 6 last week (25th), using instructions
> here:
> https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev
>
> If on a machine having another (distro) proj around you have to go
> through this renaming piece if I'm correct (well, Even told me :-) )
>
> I used:
>
> export LD_LIBRARY_PATH=/home/richard/bin/proj/lib:$LD_LIBRARY_PATH
>
> ./configure --prefix=/home/richard/bin/gdal
> --with-proj=/home/richard/bin/proj --without-libtool --with-python
> --without-ogdi
>
> Be sure (below is Even's text...) to see:
>
> # when configuring gdal
> checking for PROJ >= 6 library... checking for proj_create_from_wkt in
> -lproj... no  <== this is funny, tough, because I have 6.0 ....
> checking for proj_create_from_wkt in -lproj... no
> checking for internal_proj_create_from_wkt in -lproj... no
> checking for internal_proj_create_from_wkt in -lproj... no
> checking for internal_proj_create_from_wkt in -linternalproj... yes  <== !!!
>
> # check if libgdal.so is gelinked is with that libinternalproj:
> cd /home/richard/bin/gdal/lib
> export LD_LIBRARY_PATH=/home/richard/bin/proj/lib:$LD_LIBRARY_PATH
> # make sure there is no /home/richard/bin/proj/lib/libproj.* files .
> Only libinternalproj.so*
> ldd libgdal.so | grep proj
>        libinternalproj.so =>
> /home/richard/bin/proj/lib/libinternalproj.so (0x00007f672346d000)

Thanks, this is very helpful!

I think my issue stems from ONLY having libproj.* in my proj build
folder -- I don't see any libinternalproj objects. I'll try the
instructions from the wiki page and see if rebuilding proj with those
flags helps.

Thank you!
Nyall

From bontepaarden at gmail.com  Mon Apr 29 01:46:10 2019
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 29 Apr 2019 10:46:10 +0200
Subject: [gdal-dev] UK Ordnance Survey grid references
In-Reply-To: <4143626.C1OTP2AhkC@even-i700>
References: <CAHNf2YRdk9pe5m2qyKs2B4M1=QZK96f=Nw9Z9=RRCWqzDfXtsQ@mail.gmail.com>
 <8748028.uq1Ttvpv9q@even-i700> <4143626.C1OTP2AhkC@even-i700>
Message-ID: <CAHNf2YRs94LR8=2vEnbudco++PdQHhOa4drOzwxLETodV+Umtw@mail.gmail.com>

Thanks Even for your quick response and your full example.

You are right the coordinates are in EPSG:4326.
I will use this example.

Thanks,

Paul



Op za 27 apr. 2019 om 18:36 schreef Even Rouault <even.rouault at spatialys.com
>:

> > and drop the last 2 figures and round appropriately
>
> Hum, after reflexion, rounding is likely not appropriate, as you give a
> position in a 100x100 square. So truncating should be rather done.
>
> And if truncating is done, then I assume your input coordinates are in
> EPSG:4326, since
>
> $ echo "-2.02903211116781 53.4040442788744" | \
>                 gdaltransform -s_srs EPSG:4326 -t_srs EPSG:27700
> 398167.225983081 389691.930910573
>
> Hence SJ981896 as you expected
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190429/7e1012f7/attachment.html>

From idan at miara.com  Mon Apr 29 08:06:46 2019
From: idan at miara.com (Idan Miara)
Date: Mon, 29 Apr 2019 18:06:46 +0300
Subject: [gdal-dev] relationship between gdalwarp and gdal_translate
Message-ID: <CAEDrt38dY=z0R_mqUUmeGodXEfDHFg50SC+SjfEbdQsfHB__9A@mail.gmail.com>

Hi,

I'm writing a wrapper and a QT5 frontend for gdalwarp/gdal_translate:
https://github.com/talos-gis/gdalos

I was wandering if gdalwarp can do anything that gdal_translate can do (and
much more), why is gdal_translate needed? do they use the same backend for
tasks that gdal_translate can do?

Kind regards,
Idan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190429/3380add2/attachment-0001.html>

From even.rouault at spatialys.com  Mon Apr 29 08:15:13 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 29 Apr 2019 17:15:13 +0200
Subject: [gdal-dev] relationship between gdalwarp and gdal_translate
In-Reply-To: <CAEDrt38dY=z0R_mqUUmeGodXEfDHFg50SC+SjfEbdQsfHB__9A@mail.gmail.com>
References: <CAEDrt38dY=z0R_mqUUmeGodXEfDHFg50SC+SjfEbdQsfHB__9A@mail.gmail.com>
Message-ID: <5262927.Z5kfmeCJxC@even-i700>

On lundi 29 avril 2019 18:06:46 CEST Idan Miara wrote:
> Hi,
> 
> I'm writing a wrapper and a QT5 frontend for gdalwarp/gdal_translate:
> https://github.com/talos-gis/gdalos
> 
> I was wandering if gdalwarp can do anything that gdal_translate can do (and
> much more), why is gdal_translate needed? do they use the same backend for
> tasks that gdal_translate can do?

They use completely different techniques. gdal_translate will be 
faster than gdalwarp when no reprojection, cutlining, etc. is needed
gdalwarp can only work with output drivers that have full random-write
capabilities (e.g. TIFF), whereas gdal_translate can support, in addition
to those ones, all drivers that have create copy mode (e.g PNG)

See
https://trac.osgeo.org/gdal/wiki/FAQRaster#Whywontgdalwarporgdal_mergewritetomostformats

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From idan at miara.com  Mon Apr 29 08:23:58 2019
From: idan at miara.com (Idan Miara)
Date: Mon, 29 Apr 2019 18:23:58 +0300
Subject: [gdal-dev] relationship between gdalwarp and gdal_translate
In-Reply-To: <5262927.Z5kfmeCJxC@even-i700>
References: <CAEDrt38dY=z0R_mqUUmeGodXEfDHFg50SC+SjfEbdQsfHB__9A@mail.gmail.com>
 <5262927.Z5kfmeCJxC@even-i700>
Message-ID: <CAEDrt3__iZaYc4pd2b4r=tNj-1nZsfeaXepaW+hS1WqWqLzSRw@mail.gmail.com>

got it, thanks!!!

On Mon, 29 Apr 2019 at 18:15, Even Rouault <even.rouault at spatialys.com>
wrote:

> On lundi 29 avril 2019 18:06:46 CEST Idan Miara wrote:
> > Hi,
> >
> > I'm writing a wrapper and a QT5 frontend for gdalwarp/gdal_translate:
> > https://github.com/talos-gis/gdalos
> >
> > I was wandering if gdalwarp can do anything that gdal_translate can do
> (and
> > much more), why is gdal_translate needed? do they use the same backend
> for
> > tasks that gdal_translate can do?
>
> They use completely different techniques. gdal_translate will be
> faster than gdalwarp when no reprojection, cutlining, etc. is needed
> gdalwarp can only work with output drivers that have full random-write
> capabilities (e.g. TIFF), whereas gdal_translate can support, in addition
> to those ones, all drivers that have create copy mode (e.g PNG)
>
> See
>
> https://trac.osgeo.org/gdal/wiki/FAQRaster#Whywontgdalwarporgdal_mergewritetomostformats
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190429/e33f4e72/attachment.html>

From rdmailings at duif.net  Mon Apr 29 11:27:39 2019
From: rdmailings at duif.net (Richard Duivenvoorde)
Date: Mon, 29 Apr 2019 20:27:39 +0200
Subject: [gdal-dev] gdal_contour -p options no attributes and interval < 1
 strange results?
Message-ID: <74fad67c-b83a-28fd-1692-2096fd178c41@duif.net>

Hi,

If I use gdal_contour (in QGIS/processing) to generate contours of a
rasterset you get a call like:

gdal_contour -b 1 -a ELEV -i 0.0001 -f "ESRI Shapefile" /tmp/smoke.asc
/tmp/OUTPUT.shp

The column ELEV will contain the contour 'height'

But when using the -p option (to create polygons instead of lines) this
column ELEV is just empty.
Is this a bug? Or suppoosed to be... if you want to create labels it
would be handier if this column is filled.

Another thingie:

When using interal values like above (0.0001) the contours *look* ok,
but the values in the dbf/shp file all show 0.001  ??

But when you do output a geopackage
gdal_contour -b 1 -a ELEV -i 0.0001 -f "GPKG" /tmp/smoke.asc
/tmp/OUTPUT.gpkg

The values are OK (well, showing 0.0011 and 0.00090000000 so 'precision'
is handled a little strange...), also when you use 1.0E-4 or 1.00000E-4

Is this something because it is supposed to work with values > 1?
In this case it is modeloutput: a cloud so very small values...

Thanks for any info,
And let me know if this is worth creating one or two? issues.


Wanne play/try?
http://duif.net/temp/smoke.zip is an example epsg:4326
raster smoke plume.

Regards,

Richard Duivenvoorde

From even.rouault at spatialys.com  Mon Apr 29 13:03:51 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 29 Apr 2019 22:03:51 +0200
Subject: [gdal-dev] gdal_contour -p options no attributes and interval <
	1 strange results?
In-Reply-To: <74fad67c-b83a-28fd-1692-2096fd178c41@duif.net>
References: <74fad67c-b83a-28fd-1692-2096fd178c41@duif.net>
Message-ID: <15569992.8p0p7kUNsV@even-i700>

Hi Richard,

> 
> If I use gdal_contour (in QGIS/processing) to generate contours of a
> rasterset you get a call like:
> 
> gdal_contour -b 1 -a ELEV -i 0.0001 -f "ESRI Shapefile" /tmp/smoke.asc
> /tmp/OUTPUT.shp
> 
> The column ELEV will contain the contour 'height'
> 
> But when using the -p option (to create polygons instead of lines) this
> column ELEV is just empty.
> Is this a bug? Or suppoosed to be... if you want to create labels it
> would be handier if this column is filled.

Expected behaviour, which was clarified a few weeks ago,as someone also 
stumbled on this:

https://gdal.org/gdal_contour.html:
"""
-a name:

    provides a name for the attribute in which to put the elevation. If not 
provided no elevation attribute is attached. Ignored in polygonal contouring 
(-p) mode.

-amin name:

    (Since GDAL 2.4) provides a name for the attribute in which to put the 
minimum elevation of contour polygon. If not provided no minimum elevation 
attribute is attached. Ignored in default line contouring mode.

-amax name:

    (Since GDAL 2.4) provides a name for the attribute in which to put the 
maximum elevation of contour polygon. If not provided no maximim elevation 
attribute is attached. Ignored in default line contouring mode.
"""

So the QGIS algorithm should handle the line vs polygon cases a bit 
differently to use -a or -amin + -amax


> When using interal values like above (0.0001) the contours *look* ok,
> but the values in the dbf/shp file all show 0.001  ??

Ah, that's because gdal_contour creates the elevation field with width=12 and 
precision=3, which is obviouly not appropriate for the interval you specify. 
Could be worth a GDAL ticket.

> 
> But when you do output a geopackage
> gdal_contour -b 1 -a ELEV -i 0.0001 -f "GPKG" /tmp/smoke.asc
> /tmp/OUTPUT.gpkg
> 
> The values are OK 

Yes, GeoPackage doesn't support width.precision for numeric fields, and values 
are ultimately stored as IEEE754 double precision.

> (well, showing 0.0011 and 0.00090000000 so 'precision'
> is handled a little strange...), also when you use 1.0E-4 or 1.00000E-4

Showing where ? In QGIS ? Well, that's probably just a formatting issue. With 
ogrinfo/sqlite3, you get the values look OK:

$ echo "select distinct elev from contour order by elev;" | sqlite3 out.gpkg
0.0001
0.0002
0.0003
0.0004
0.0005
0.0006
0.0007
0.0008
0.0009
0.001
0.0011
0.0012
0.0013

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From rdmailings at duif.net  Mon Apr 29 23:40:59 2019
From: rdmailings at duif.net (Richard Duivenvoorde)
Date: Tue, 30 Apr 2019 08:40:59 +0200
Subject: [gdal-dev] gdal_contour -p options no attributes and interval <
 1 strange results?
In-Reply-To: <15569992.8p0p7kUNsV@even-i700>
References: <74fad67c-b83a-28fd-1692-2096fd178c41@duif.net>
 <15569992.8p0p7kUNsV@even-i700>
Message-ID: <ec0655c8-4d69-be63-b0b7-1d16e598ce31@duif.net>

Thanks Even,

All clear.

For -p the -amin -amax options work \o/
(having the same precision issue with shapes though)

Ticket created: https://github.com/OSGeo/gdal/issues/1487

Regards & Thanks,

Richard Duivenvoorde

On 29/04/2019 22.03, Even Rouault wrote:
> Hi Richard,
> 
>>
>> If I use gdal_contour (in QGIS/processing) to generate contours of a
>> rasterset you get a call like:
>>
>> gdal_contour -b 1 -a ELEV -i 0.0001 -f "ESRI Shapefile" /tmp/smoke.asc
>> /tmp/OUTPUT.shp
>>
>> The column ELEV will contain the contour 'height'
>>
>> But when using the -p option (to create polygons instead of lines) this
>> column ELEV is just empty.
>> Is this a bug? Or suppoosed to be... if you want to create labels it
>> would be handier if this column is filled.
> 
> Expected behaviour, which was clarified a few weeks ago,as someone also 
> stumbled on this:
> 
> https://gdal.org/gdal_contour.html:
> """
> -a name:
> 
>     provides a name for the attribute in which to put the elevation. If not 
> provided no elevation attribute is attached. Ignored in polygonal contouring 
> (-p) mode.
> 
> -amin name:
> 
>     (Since GDAL 2.4) provides a name for the attribute in which to put the 
> minimum elevation of contour polygon. If not provided no minimum elevation 
> attribute is attached. Ignored in default line contouring mode.
> 
> -amax name:
> 
>     (Since GDAL 2.4) provides a name for the attribute in which to put the 
> maximum elevation of contour polygon. If not provided no maximim elevation 
> attribute is attached. Ignored in default line contouring mode.
> """
> 
> So the QGIS algorithm should handle the line vs polygon cases a bit 
> differently to use -a or -amin + -amax
> 
> 
>> When using interal values like above (0.0001) the contours *look* ok,
>> but the values in the dbf/shp file all show 0.001  ??
> 
> Ah, that's because gdal_contour creates the elevation field with width=12 and 
> precision=3, which is obviouly not appropriate for the interval you specify. 
> Could be worth a GDAL ticket.
> 
>>
>> But when you do output a geopackage
>> gdal_contour -b 1 -a ELEV -i 0.0001 -f "GPKG" /tmp/smoke.asc
>> /tmp/OUTPUT.gpkg
>>
>> The values are OK 
> 
> Yes, GeoPackage doesn't support width.precision for numeric fields, and values 
> are ultimately stored as IEEE754 double precision.
> 
>> (well, showing 0.0011 and 0.00090000000 so 'precision'
>> is handled a little strange...), also when you use 1.0E-4 or 1.00000E-4
> 
> Showing where ? In QGIS ? Well, that's probably just a formatting issue. With 
> ogrinfo/sqlite3, you get the values look OK:
> 
> $ echo "select distinct elev from contour order by elev;" | sqlite3 out.gpkg
> 0.0001
> 0.0002
> 0.0003
> 0.0004
> 0.0005
> 0.0006
> 0.0007
> 0.0008
> 0.0009
> 0.001
> 0.0011
> 0.0012
> 0.0013
> 
> Even
> 


From andrea.aime at geo-solutions.it  Tue Apr 30 06:06:29 2019
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Tue, 30 Apr 2019 15:06:29 +0200
Subject: [gdal-dev] Interesting debugging log from FileGBD driver
Message-ID: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>

Hi,
I'm looking at a performance issue rendering a very large ESRI File
geodatabase, and in the logs I see:

CPLQuadTree: Estimated spatial index tree depth: 20
CPLQuadTree: Falling back to max number of allowed index tree levels (12).

Wondering if this might be a reason for slow data extraction, and if there
are settings to make it us the full
quadtree depth? The environment is also a multi-threaded (multiple threads
reading from the file at the same time), this could also be a cause.

The file in question is massive, so OpenFileGDB does not seem like an option

Cheers
Andrea

==

GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information. == Ing. Andrea Aime @geowolf Technical Lead
GeoSolutions S.A.S. Via di Montramito 3/A 55054 Massarosa (LU) phone: +39
0584 962313 fax: +39 0584 1660272 mob: +39 339 8844549
http://www.geo-solutions.it http://twitter.com/geosolutions_it
------------------------------------------------------- *Con riferimento
alla normativa sul trattamento dei dati personali (Reg. UE 2016/679 -
Regolamento generale sulla protezione dei dati “GDPR”), si precisa che ogni
circostanza inerente alla presente email (il suo contenuto, gli eventuali
allegati, etc.) è un dato la cui conoscenza è riservata al/i solo/i
destinatario/i indicati dallo scrivente. Se il messaggio Le è giunto per
errore, è tenuta/o a cancellarlo, ogni altra operazione è illecita. Le
sarei comunque grato se potesse darmene notizia. This email is intended
only for the person or entity to which it is addressed and may contain
information that is privileged, confidential or otherwise protected from
disclosure. We remind that - as provided by European Regulation 2016/679
“GDPR” - copying, dissemination or use of this e-mail or the information
herein by anyone other than the intended recipient is prohibited. If you
have received this email by mistake, please notify us immediately by
telephone or e-mail.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190430/a0a59e71/attachment.html>

From even.rouault at spatialys.com  Tue Apr 30 06:22:32 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Apr 2019 15:22:32 +0200
Subject: [gdal-dev] Interesting debugging log from FileGBD driver
In-Reply-To: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>
References: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>
Message-ID: <5706253.1JrkPBoz3j@even-i700>

Hi Andrea,

> I'm looking at a performance issue rendering a very large ESRI File
> geodatabase, and in the logs I see:
> 
> CPLQuadTree: Estimated spatial index tree depth: 20
> CPLQuadTree: Falling back to max number of allowed index tree levels (12).
> 
> Wondering if this might be a reason for slow data extraction, 

I wouldn't think so. The maximum depth of 12 should be large enough.

> and if there
> are settings to make it us the full
> quadtree depth? The environment is also a multi-threaded (multiple threads
> reading from the file at the same time), this could also be a cause.

What is slow exactly ? The first time you do a spatial filtering (which is 
expected, since it requires to do a full scan of the file, because the driver 
doesn't know how to use the on-disk spatial index), or later spatial filtering
operations with the connection still opened (which should be fast normally) ?

> The file in question is massive, so OpenFileGDB does not seem like an option

Yep, still hoping that someone will manage to reverse engineer those last 
missing bits of the format.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrea.aime at geo-solutions.it  Tue Apr 30 06:33:22 2019
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Tue, 30 Apr 2019 15:33:22 +0200
Subject: [gdal-dev] Interesting debugging log from FileGBD driver
In-Reply-To: <5706253.1JrkPBoz3j@even-i700>
References: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>
 <5706253.1JrkPBoz3j@even-i700>
Message-ID: <CA+nxMTuKMegNw6kG=igNffXJevxo9nv42rfxYuzGi14QavOcNw@mail.gmail.com>

On Tue, Apr 30, 2019 at 3:22 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> What is slow exactly ? The first time you do a spatial filtering (which is
> expected, since it requires to do a full scan of the file, because the
> driver
> doesn't know how to use the on-disk spatial index), or later spatial
> filtering
> operations with the connection still opened (which should be fast
> normally) ?
>

Oh wait! You mean those messages pop up only if OpenFileGDB is used?
Dang, thought I had forced usage of FileGBD but I did not, very sorry for
the noise.

The log messages are gone, performance is still really bad. Can I blame
multithreading for that?
All the datasource objects are opened in read only mode

Cheers
Andrea

==

GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information. == Ing. Andrea Aime @geowolf Technical Lead
GeoSolutions S.A.S. Via di Montramito 3/A 55054 Massarosa (LU) phone: +39
0584 962313 fax: +39 0584 1660272 mob: +39 339 8844549
http://www.geo-solutions.it http://twitter.com/geosolutions_it
------------------------------------------------------- *Con riferimento
alla normativa sul trattamento dei dati personali (Reg. UE 2016/679 -
Regolamento generale sulla protezione dei dati “GDPR”), si precisa che ogni
circostanza inerente alla presente email (il suo contenuto, gli eventuali
allegati, etc.) è un dato la cui conoscenza è riservata al/i solo/i
destinatario/i indicati dallo scrivente. Se il messaggio Le è giunto per
errore, è tenuta/o a cancellarlo, ogni altra operazione è illecita. Le
sarei comunque grato se potesse darmene notizia. This email is intended
only for the person or entity to which it is addressed and may contain
information that is privileged, confidential or otherwise protected from
disclosure. We remind that - as provided by European Regulation 2016/679
“GDPR” - copying, dissemination or use of this e-mail or the information
herein by anyone other than the intended recipient is prohibited. If you
have received this email by mistake, please notify us immediately by
telephone or e-mail.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190430/27cdc92e/attachment-0001.html>

From even.rouault at spatialys.com  Tue Apr 30 06:41:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 30 Apr 2019 15:41:00 +0200
Subject: [gdal-dev] Interesting debugging log from FileGBD driver
In-Reply-To: <CA+nxMTuKMegNw6kG=igNffXJevxo9nv42rfxYuzGi14QavOcNw@mail.gmail.com>
References: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>
 <5706253.1JrkPBoz3j@even-i700>
 <CA+nxMTuKMegNw6kG=igNffXJevxo9nv42rfxYuzGi14QavOcNw@mail.gmail.com>
Message-ID: <1615729.NO8C8zPfIK@even-i700>

On mardi 30 avril 2019 15:33:22 CEST Andrea Aime wrote:
> On Tue, Apr 30, 2019 at 3:22 PM Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > What is slow exactly ? The first time you do a spatial filtering (which is
> > expected, since it requires to do a full scan of the file, because the
> > driver
> > doesn't know how to use the on-disk spatial index), or later spatial
> > filtering
> > operations with the connection still opened (which should be fast
> > normally) ?
> 
> Oh wait! You mean those messages pop up only if OpenFileGDB is used?
> Dang, thought I had forced usage of FileGBD but I did not, very sorry for
> the noise.
> 
> The log messages are gone, performance is still really bad. Can I blame
> multithreading for that?
> All the datasource objects are opened in read only mode

Ah, the FileGDB SDK used by the FileGDB driver was/is not thread-safe, so the 
FileGDB driver holds a global lock...

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrea.aime at geo-solutions.it  Tue Apr 30 06:56:28 2019
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Tue, 30 Apr 2019 15:56:28 +0200
Subject: [gdal-dev] Interesting debugging log from FileGBD driver
In-Reply-To: <1615729.NO8C8zPfIK@even-i700>
References: <CA+nxMTupUjx+yLUxL+6E8dUjKqi66Cw4SyZC1feaKO-HQ_6KUQ@mail.gmail.com>
 <5706253.1JrkPBoz3j@even-i700>
 <CA+nxMTuKMegNw6kG=igNffXJevxo9nv42rfxYuzGi14QavOcNw@mail.gmail.com>
 <1615729.NO8C8zPfIK@even-i700>
Message-ID: <CA+nxMTs64725N4MWADyTsySZOJOoLrwmHtuGxV1Tfq4dMnJgFA@mail.gmail.com>

On Tue, Apr 30, 2019 at 3:41 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Ah, the FileGDB SDK used by the FileGDB driver was/is not thread-safe, so
> the
> FileGDB driver holds a global lock...
>

Yes, what I expected.... thanks for the swift confirmation!

Cheers
Andrea

== GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information. == Ing. Andrea Aime @geowolf
Technical Lead GeoSolutions S.A.S. Via di Montramito 3/A 55054 Massarosa
(LU) phone: +39 0584 962313 fax: +39 0584 1660272 mob: +39 339 8844549
http://www.geo-solutions.it http://twitter.com/geosolutions_it
------------------------------------------------------- *Con riferimento
alla normativa sul trattamento dei dati personali (Reg. UE 2016/679 -
Regolamento generale sulla protezione dei dati “GDPR”), si precisa che ogni
circostanza inerente alla presente email (il suo contenuto, gli eventuali
allegati, etc.) è un dato la cui conoscenza è riservata al/i solo/i
destinatario/i indicati dallo scrivente. Se il messaggio Le è giunto per
errore, è tenuta/o a cancellarlo, ogni altra operazione è illecita. Le
sarei comunque grato se potesse darmene notizia. This email is intended
only for the person or entity to which it is addressed and may contain
information that is privileged, confidential or otherwise protected from
disclosure. We remind that - as provided by European Regulation 2016/679
“GDPR” - copying, dissemination or use of this e-mail or the information
herein by anyone other than the intended recipient is prohibited. If you
have received this email by mistake, please notify us immediately by
telephone or e-mail.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20190430/b31b7d3a/attachment.html>

