From warmerdam at pobox.com  Mon Jan  3 23:17:52 2005
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Shapefile spatial indexing
Message-ID: <41DA18F0.40108@pobox.com>

Folks,

I think I mentioned in the past that I was looking at implementing spatial
indexing support for the OGR Shapefile driver.  Martin Chapman (and SANZ)
have encouraged me to complete that work and it is now all in CVS.

It is implemented using the same quadtree style format (.qix) used by
UMN MapServer.  Indexes can be created and dropped with pseudo-SQL commands
as noted in the updated shapefile driver document at:

   http://gdal.maptools.org/ogr/drv_shapefile.html

With the spatial index build for a 400MB 900000 feature line file (roads
in Virginia) I was able to read back a 77000 feature subset in 5s as opposed
to 64s without the spatial index.  I was able to read back a 1300 feature
subset in 0.4s compared to 60s.  So the spatial index does give massive
improvements for reading small spatial regions out of large datasets.

If anyone tries out the new capability and runs into problems, please let me
know.

Thanks to SANZ for funding this work, and Steve Lime for his implementation
in MapServer!

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Eric.Doenges at rcs.ei.tum.de  Tue Jan  4 09:04:04 2005
From: Eric.Doenges at rcs.ei.tum.de (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak in GeoTIFF driver
Message-ID: <7E2C7F41-5E59-11D9-9A2F-000A9582A844@rcs.ei.tum.de>

Hi,

I've found a memory leak in the GeoTIFF driver in the 
GTiffDataset::SetGCPs member
function - any GCPs already defined when SetGCPs is called are not 
freed; neither is
the pointer to the projection string. Both are simply overwritten with 
the new values.
The attached patch should correct both problems.

On a related note, is there any reason why the GeoTIFF driver will only 
load GCPs if
there are more than 6 GCPs defined in the file ? I think the driver 
should simply
load whatever is available, and let the application worry about wether 
there are
enough points to do anything useful with.

With kind regards,
Eric

-------------- next part --------------
--- frmts/gtiff/geotiff.cpp.orig	Tue Jan  4 14:39:51 2005
+++ frmts/gtiff/geotiff.cpp	Tue Jan  4 14:54:15 2005
@@ -3759,8 +3759,23 @@
 {
     if( GetAccess() == GA_Update )
     {
+        /* If we already have GCPs defined, free those first. */
+        if( this->nGCPCount > 0 )
+        {
+                for( int i = 0; i < this->nGCPCount; i++ )
+                        CPLFree( this->pasGCPList[i].pszId );
+
+                CPLFree( this->pasGCPList );
+        }
+    
 	this->nGCPCount = nGCPCount;
 	this->pasGCPList = GDALDuplicateGCPs(nGCPCount, pasGCPList);
+
+        /*
+         * NOTE: this->pszProjection should always point to valid memory
+         * (though the projection string itself might be empty, i.e. ""
+         */
+        CPLFree( this->pszProjection );
 	this->pszProjection = CPLStrdup( pszGCPProjection );
         bGeoTIFFInfoChanged = TRUE;
 
-------------- next part --------------







From bfraser at geoanalytic.com  Tue Jan  4 10:47:26 2005
From: bfraser at geoanalytic.com (bfraser@geoanalytic.com)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20050104144157.58C725896A9@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050104/3c92bfcf/attachment.wav
From wzhang at eisen.de  Tue Jan  4 10:04:27 2005
From: wzhang at eisen.de (Eisen Co. Ltd.)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Compiling with MS Visual C++ 6
Message-ID: <20050104150449.D68BC589927@xserve.flids.com>

Dear experts,

 

I've got problem to execute the following source from the tutorial with MS
Visual C++ 6. Could you please give me a step for step instruction how to
setup the compiling environment?

 

Regards, Wei.

 

----------------------------------------------------------------------------
------------------------------------------------

 

#include "ogrsf_frmts.h"

 

int main()

{

    const char *pszDriverName = "ESRI Shapefile";

    OGRSFDriver *poDriver;

 

    OGRRegisterAll();

 

    poDriver = OGRSFDriverRegistrar::GetRegistrar()->GetDriverByName(

                pszDriverName );

    if( poDriver == NULL )

    {

        printf( "%s driver not available.\n", pszDriverName );

        exit( 1 );

    }

 

    OGRDataSource *poDS;

 

    poDS = poDriver->CreateDataSource( "point_out.shp", NULL );

    if( poDS == NULL )

    {

        printf( "Creation of output file failed.\n" );

        exit( 1 );

    }

 

    OGRLayer *poLayer;

 

    poLayer = poDS->CreateLayer( "point_out", NULL, wkbPoint, NULL );

    if( poLayer == NULL )

    {

        printf( "Layer creation failed.\n" );

        exit( 1 );

    }

 

    OGRFieldDefn oField( "Name", OFTString );

 

    oField.SetWidth(32);

 

    if( poLayer->CreateField( &oField ) != OGRERR_NONE )

    {

        printf( "Creating Name field failed.\n" );

        exit( 1 );

    }

 

    double x, y;

    char szName[33];

 

    while( !feof(stdin) 

           && fscanf( stdin, "%lf,%lf,%32s", &x, &y, szName ) == 3 )

    {

        OGRFeature *poFeature;

 

        poFeature = new OGRFeature( poLayer->GetLayerDefn() );

        poFeature->SetField( "Name", szName );

 

        OGRPoint *poPoint = new OGRPoint();

        

        poPoint->setX( x );

        poPoint->setY( y );

 

        poFeature->SetGeometryDirectly( poPoint ); 

 

        if( poLayer->CreateFeature( poFeature ) != OGRERR_NONE )

        {

           printf( "Failed to create feature in shapefile.\n" );

           exit( 1 );

        }

 

        delete poFeature;

    }

 

    OGRDataSource::DestroyDataSource( poDS );

}

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050104/c20d6e67/attachment.html
From bartvde at xs4all.nl  Tue Jan  4 10:21:13 2005
From: bartvde at xs4all.nl (bartvde@xs4all.nl)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Shapefile spatial indexing
In-Reply-To: <41DA18F0.40108@pobox.com>
References: <41DA18F0.40108@pobox.com>
Message-ID: <11890.212.238.227.182.1104852073.squirrel@212.238.227.182>

Hi Frank,

great! Can the spatial indexes also be created using shptree or must one
use the SQL CREATE SPATIAL INDEX syntax?

Best regards,
Bart

> Folks,
>
> I think I mentioned in the past that I was looking at implementing spatial
> indexing support for the OGR Shapefile driver.  Martin Chapman (and SANZ)
> have encouraged me to complete that work and it is now all in CVS.
>
> It is implemented using the same quadtree style format (.qix) used by
> UMN MapServer.  Indexes can be created and dropped with pseudo-SQL
> commands
> as noted in the updated shapefile driver document at:
>
>    http://gdal.maptools.org/ogr/drv_shapefile.html
>
> With the spatial index build for a 400MB 900000 feature line file (roads
> in Virginia) I was able to read back a 77000 feature subset in 5s as
> opposed
> to 64s without the spatial index.  I was able to read back a 1300 feature
> subset in 0.4s compared to 60s.  So the spatial index does give massive
> improvements for reading small spatial regions out of large datasets.
>
> If anyone tries out the new capability and runs into problems, please let
> me
> know.
>
> Thanks to SANZ for funding this work, and Steve Lime for his
> implementation
> in MapServer!
>
> Best regards,
> --
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
>
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev
>



From fwarmerdam at gmail.com  Tue Jan  4 10:39:25 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Shapefile spatial indexing
In-Reply-To: <11890.212.238.227.182.1104852073.squirrel@212.238.227.182>
References: <41DA18F0.40108@pobox.com>
	<11890.212.238.227.182.1104852073.squirrel@212.238.227.182>
Message-ID: <931f8ea9050104073971d03b21@mail.gmail.com>

On Tue, 4 Jan 2005 16:21:13 +0100 (CET), bartvde@xs4all.nl
<bartvde@xs4all.nl> wrote:
> Hi Frank,
> 
> great! Can the spatial indexes also be created using shptree or must one
> use the SQL CREATE SPATIAL INDEX syntax?

Bart,

You can create them with shptree as well.  One of my objectives
was to ensure the format was 100% compatible between mapserver
and ogr.  I also adapted Steve's code for reading, writing and
scanning them.
 
Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jan  4 10:46:13 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Compiling with MS Visual C++ 6
In-Reply-To: <20050104150449.D68BC589927@xserve.flids.com>
References: <20050104150449.D68BC589927@xserve.flids.com>
Message-ID: <931f8ea90501040746463e929e@mail.gmail.com>

On Tue, 4 Jan 2005 16:04:27 +0100, Eisen Co. Ltd. <wzhang@eisen.de> wrote:
> Dear experts, 
>
> I've got problem to execute the following source from the tutorial with MS
> Visual C++ 6. Could you please give me a step for step instruction how to
> setup the compiling environment? 

Wei,

The windows build instructions for GDAL are at:

  http://www.gdal.org/gdal_building.html

As it notes, you may need to run the VCVARS32.BAT script
that is in your visual studio directory in order to setup the
compiler environment. 

Are you building GDAL from source as well?  If so, I would
suggest setting the GDAL_HOME, BINDIR, LIBDIR, and INCDIR
variables in the nmake.opt appropriately and doing the 
"nmake /f makefile.vc devinstall" target to copy all the include
files, the stub library and the dll to your "installed" tree. 

Then if you save your source as "ogrtest.cpp" you could issue 
a command like:

 cl -IC:\bld\include ogrtest.cpp C:\bld\lib\gdal_i.lib 

This should produce an ogrtest.exe.  This assumes you installed
stuff under \bld of course.  

If you still have problems you will need to be more specific
about your questions.  You can also build your source from
within visual studio, but you will need to setup the include and
library settings appropriately within visual studio.  I don't recall
the details just now, but it isn't hard if you are familiar with
visual studio. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jan  4 11:13:59 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak in GeoTIFF driver
In-Reply-To: <7E2C7F41-5E59-11D9-9A2F-000A9582A844@rcs.ei.tum.de>
References: <7E2C7F41-5E59-11D9-9A2F-000A9582A844@rcs.ei.tum.de>
Message-ID: <931f8ea905010408133a6919a@mail.gmail.com>

On Tue, 4 Jan 2005 15:04:04 +0100, Eric D?nges
<Eric.Doenges@rcs.ei.tum.de> wrote:
> Hi,
> 
> I've found a memory leak in the GeoTIFF driver in the
> GTiffDataset::SetGCPs member
> function - any GCPs already defined when SetGCPs is called are not
> freed; neither is
> the pointer to the projection string. Both are simply overwritten with
> the new values.
> The attached patch should correct both problems.

Eric,

You are quite right.  I have applied a variation on your
patch. 
 
> On a related note, is there any reason why the GeoTIFF driver will only
> load GCPs if
> there are more than 6 GCPs defined in the file ? I think the driver
> should simply
> load whatever is available, and let the application worry about wether
> there are
> enough points to do anything useful with.

There need to be six values in the tiepoints array for each GCP.
They are the x/y/z raster location and the x/y/z world location.
So the number of GCPs is the number of values in the tiepoints
list divided by six. 

PS. I also added a test in my testsuite for TIFF GCPs.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ealpert at digitalglobe.com  Tue Jan  4 11:16:31 2005
From: ealpert at digitalglobe.com (Ethan Alpert)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Shapefile spatial indexing
Message-ID: <1FB6937A87F9074C9A2B8F9D9137EB1603A8C956@COMAIL01.digitalglobe.com>


So I if I read this right does building a new gdal automatically give me
support for this in mapserver?

-e

-----Original Message-----
From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Frank Warmerdam
Sent: Tuesday, January 04, 2005 8:39 AM
To: bartvde@xs4all.nl
Cc: gdal-dev
Subject: Re: [Gdal-dev] Shapefile spatial indexing


On Tue, 4 Jan 2005 16:21:13 +0100 (CET), bartvde@xs4all.nl
<bartvde@xs4all.nl> wrote:
> Hi Frank,
> 
> great! Can the spatial indexes also be created using shptree or must 
> one use the SQL CREATE SPATIAL INDEX syntax?

Bart,

You can create them with shptree as well.  One of my objectives was to
ensure the format was 100% compatible between mapserver and ogr.  I also
adapted Steve's code for reading, writing and scanning them.
 
Best regards,
-- 
---------------------------------------+--------------------------------
---------------------------------------+------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From fwarmerdam at gmail.com  Tue Jan  4 11:44:45 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Shapefile spatial indexing
In-Reply-To: <1FB6937A87F9074C9A2B8F9D9137EB1603A8C956@COMAIL01.digitalglobe.com>
References: <1FB6937A87F9074C9A2B8F9D9137EB1603A8C956@COMAIL01.digitalglobe.com>
Message-ID: <931f8ea9050104084447309329@mail.gmail.com>

On Tue, 4 Jan 2005 09:16:31 -0700, Ethan Alpert
<ealpert@digitalglobe.com> wrote:
> 
> So I if I read this right does building a new gdal automatically give me
> support for this in mapserver?

Ethan, 

Yes, though it only affects shapefile use via CONNECTIONTYPE
OGR. If you use the default connection type (direct shapefiles)
then .qix spatial indexes were already supported.  This work
was done mainly for those writing apps on top of OGR that need
fast spatial queries.  Those concerned with performance in
MapServer don't normally use OGR for shapefiles. 

My main objective in having the spatial indexes compatible was
so that folks using shapefiles in different contexts wouldn't need
to have multiple spatial indexes.  It is already unfortunate that we
can't all use the ESRI approach since they chose not to document
that aspect of the format. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From wbhk at unm.edu  Thu Jan  6 15:30:17 2005
From: wbhk at unm.edu (William Hudspeth)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] [Fwd: Problems installing GDAL 1.2.5]
Message-ID: <41DD9FD9.107@unm.edu>


-------------- next part --------------
An embedded message was scrubbed...
From: William Hudspeth <wbhk@unm.edu>
Subject: Problems installing GDAL 1.2.5
Date: Thu, 06 Jan 2005 13:13:40 -0700
Size: 3127
Url: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050106/ac6d614e/ProblemsinstallingGDAL1.2.mht
From oh2kku at iki.fi  Thu Jan  6 16:13:18 2005
From: oh2kku at iki.fi (Tapio Sokura)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] gdalwarp: getting rid of dark borders
Message-ID: <41DDA9EE.5090908@iki.fi>

Hi,

I'm a newbie with GDAL. So far I have managed to successfully use 
gdalwarp to transform raster images from one projection to another. As 
the target projection is different from the source, dark bands form to 
the edges to keep the image rectangle shaped. Is there an easy way to 
make gdalwarp automatically crop the map so that all the dark bands are 
removed, naturally with some inage data being cut out near the edges?

I've looked at the gdalwarp manual page and the switch to do that didn't 
jump up to my eyes. I see there is the -te parameter I can use to 
specify the extents of the new image. It works, but to use it I need to 
convert the image first and then manually find out the maximum map 
extents that result in a map with no dark edges. Is there an automatic 
way to do this?

A second thing came to mind on an optimal amount of pixels for the 
transformed image. Is there a rule of thumb or a simple algorithm to 
calculate the optimal amount of pixels to specify for -ts if I wanted 
the resulting image to look as good as possible without spending pixels 
on nothing? For now I've used the pixel count of the original picture as 
a starting point and increased the amount by about as many pixels as the 
dark map edges occupy in the final image.

And about the resampling algorithm. Is there a rule of thumb on which 
algorithm to use when the goal is to just change the projection and not 
significantly change the amount of pixels in the image? So far I have 
used the nearest neighbor algorithm. CPU usage (more complex algorithms) 
is not a problem. The images I've been transforming have been man-made 
maps with some 10-20 colors and anti-aliased lines.

Thanks,
   Tapio

From fwarmerdam at gmail.com  Thu Jan  6 16:35:51 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] gdalwarp: getting rid of dark borders
In-Reply-To: <41DDA9EE.5090908@iki.fi>
References: <41DDA9EE.5090908@iki.fi>
Message-ID: <931f8ea90501061335437a110@mail.gmail.com>

On Thu, 06 Jan 2005 23:13:18 +0200, Tapio Sokura <oh2kku@iki.fi> wrote:
> Hi,
> 
> I'm a newbie with GDAL. So far I have managed to successfully use
> gdalwarp to transform raster images from one projection to another. As
> the target projection is different from the source, dark bands form to
> the edges to keep the image rectangle shaped. Is there an easy way to
> make gdalwarp automatically crop the map so that all the dark bands are
> removed, naturally with some inage data being cut out near the edges?
> 
> I've looked at the gdalwarp manual page and the switch to do that didn't
> jump up to my eyes. I see there is the -te parameter I can use to
> specify the extents of the new image. It works, but to use it I need to
> convert the image first and then manually find out the maximum map
> extents that result in a map with no dark edges. Is there an automatic
> way to do this?


Tapio, 

Good question.  There is no automatic way to do this.  In theory what
you need is something like the existing GDALSuggestedWarpOutput()
function used by gdalwarp, but that take the largest window completely
filled with data instead of the smallest window completely containing
all the data as is the rule now.  This isn't really something I have
ever wanted to do.
 
> A second thing came to mind on an optimal amount of pixels for the
> transformed image. Is there a rule of thumb or a simple algorithm to
> calculate the optimal amount of pixels to specify for -ts if I wanted
> the resulting image to look as good as possible without spending pixels
> on nothing? For now I've used the pixel count of the original picture as
> a starting point and increased the amount by about as many pixels as the
> dark map edges occupy in the final image.

Generally speaking you want ground size of a pixel to be the same
in the source and destination projection.  So if they are both meter
based projections you would normally compete the number of 
pixels based on deviding the selected extents by the pixel size in the
source image.  

GDALSuggestedWarpOutput() does something a bit more involved
because if the transformation is actually changing units or if the
region is highly distorted you might not be able to transfer the "pixel
size" literally from the source the destination image.  So it tries
to a diagonal pixel size on the source image and then compute
a destination resolution that has the same diagonal distance (after
transforming the source to destination).   

In effect, the important thing is to try and have the same "real"
pixel space on source and destination image. 
 
> And about the resampling algorithm. Is there a rule of thumb on which
> algorithm to use when the goal is to just change the projection and not
> significantly change the amount of pixels in the image? So far I have
> used the nearest neighbor algorithm. CPU usage (more complex algorithms)
> is not a problem. The images I've been transforming have been man-made
> maps with some 10-20 colors and anti-aliased lines.

If your image is pseudo-colored and thematic you *must* use 
nearest neighbour since changing pixel values would have 
peculiar effects.  But for continuous tone or fully RGB images bilinear
or cubic will generally give you smoother results.  The cubic in essence
helps fight the "smearing" effect that occurs with bilinear, but with the
risk of other odd effects. 

For your case I would just suggest you try cubic and bilinear, and 
compare.  If you like the cubic better than the bilinear then use it 
otherwise stick with bilinear.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From oh2kku at iki.fi  Fri Jan  7 05:00:07 2005
From: oh2kku at iki.fi (Tapio Sokura)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] gdalwarp: getting rid of dark borders
In-Reply-To: <931f8ea90501061335437a110@mail.gmail.com>
References: <41DDA9EE.5090908@iki.fi>
	<931f8ea90501061335437a110@mail.gmail.com>
Message-ID: <41DE5DA7.5050701@iki.fi>

Thanks for the swift reply, Frank.

Frank Warmerdam wrote:
> Good question.  There is no automatic way to do this.  In theory what
> you need is something like the existing GDALSuggestedWarpOutput()
> function used by gdalwarp, but that take the largest window completely
> filled with data instead of the smallest window completely containing
> all the data as is the rule now.  This isn't really something I have
> ever wanted to do.

Ok. The reason I wanted to do that is I have a lot of small (about 300 x 
300 pixels) adjacent map pieces of an area all in one projection. I 
"glue" those pieces together with ImageMagick montage program to form a 
larger map (typically something like 3000 x 3000 pixels) and then use 
gdalwarp (along with an ESRI world file) to warp it to another 
projection. Because I build the large maps by combining the small map 
pieces, I can have the large map pieces overlap each other a bit so 
removing the dark bands results in no image data loss from the view of 
the whole system.

> For your case I would just suggest you try cubic and bilinear, and 
> compare.  If you like the cubic better than the bilinear then use it 
> otherwise stick with bilinear.

I compared all four sampling algorithms available and I think I'll stick 
with nearest neighbor. The input images I'm using have an 8-bit color 
palette and the output of all other algorithms looks awful. I tried with 
the input images in RGB, but the file sizes get so huge that something 
goes wrong and gimp doesn't want to display the warped images anymore.. 
anyway I'm more than happy with the nearest neighbor resampling, just 
wondered whether it could be even better than that.

   Tapio1

From bhudspeth at edac.unm.edu  Fri Jan  7 11:05:49 2005
From: bhudspeth at edac.unm.edu (William Hudspeth)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Problems installing GDAL 1.2.5
Message-ID: <1105113949.3758.3.camel@localhost.localdomain>

Hello,

I am having problems installing GDAL 1.2.5 on Redhat 9. The problem may 
involve the HDF4 installation (see output below). I had no problems 
installing HDF4 and used the following configure options:

./configure --with-hdf4=/usr/local/include --with-
libgrass=/usr/local/lib

These options point to hdf4.h and libgrass5.a (etc...) in the
respective 
directories.

OUTPUT

gctp_wrap.c:1:25: ogr_srs_api.h: No such file or directory
gctp_wrap.c: In function `osr_for':
gctp_wrap.c:12: `OGRSpatialReferenceH' undeclared (first use in this 
function)
gctp_wrap.c:12: (Each undeclared identifier is reported only once
gctp_wrap.c:12: for each function it appears in.)
gctp_wrap.c:12: parse error before "hSourceSRS"
gctp_wrap.c:13: `OGRCoordinateTransformationH' undeclared (first use in 
this function)
gctp_wrap.c:16: `hSourceSRS' undeclared (first use in this function)
gctp_wrap.c:16: warning: implicit declaration of function 
`OSRNewSpatialReference'
gctp_wrap.c:16: `NULL' undeclared (first use in this function)
gctp_wrap.c:17: warning: implicit declaration of function 
`OSRImportFromUSGS'
gctp_wrap.c:18: `hLatLong' undeclared (first use in this function)
gctp_wrap.c:18: warning: implicit declaration of function
`OSRCloneGeogCS'
gctp_wrap.c:19: `hCT' undeclared (first use in this function)
gctp_wrap.c:19: warning: implicit declaration of function 
`OCTNewCoordinateTransformation'
gctp_wrap.c:26: warning: implicit declaration of function `OCTTransform'
gctp_wrap.c:31: warning: implicit declaration of function 
`OSRDestroySpatialReference'
gctp_wrap.c: In function `osr_inv':
gctp_wrap.c:64: `OGRSpatialReferenceH' undeclared (first use in this 
function)
gctp_wrap.c:64: parse error before "hSourceSRS"
gctp_wrap.c:65: `OGRCoordinateTransformationH' undeclared (first use in 
this function)
gctp_wrap.c:68: `hSourceSRS' undeclared (first use in this function)
gctp_wrap.c:68: `NULL' undeclared (first use in this function)
gctp_wrap.c:70: `hLatLong' undeclared (first use in this function)
gctp_wrap.c:71: `hCT' undeclared (first use in this function)
make[3]: *** [../../o/gctp_wrap.o] Error 1
make[3]: Leaving directory `/home/wilbur/gdal-1.2.5/frmts/hdf4/hdf-eos'
make[2]: *** [lib-hdfeos] Error 2
make[2]: Leaving directory `/home/wilbur/gdal-1.2.5/frmts/hdf4'
make[1]: *** [hdf4-install-obj] Error 2
make[1]: Leaving directory `/home/wilbur/gdal-1.2.5/frmts'
make: *** [frmts-target] Error 2


Thanks for any help in advance,  Bill



From dron at ak4719.spb.edu  Fri Jan  7 12:45:30 2005
From: dron at ak4719.spb.edu (Andrey Kiselev)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] [Fwd: Problems installing GDAL 1.2.5]
In-Reply-To: <41DD9FD9.107@unm.edu>
References: <41DD9FD9.107@unm.edu>
Message-ID: <20050107174530.GA9757@ak4719.spb.edu>

On Thu, Jan 06, 2005 at 01:30:17PM -0700, William Hudspeth wrote:
> I am having problems installing GDAL 1.2.5 on Redhat 9. The problem may 
> involve the HDF4 installation (see output below). I had no problems 
> installing HDF4 and used the following configure options:
> 
> ./configure --with-hdf4=/usr/local/include --with-libgrass=/usr/local/lib
> 
> These options point to hdf4.h and libgrass5.a (etc...) in the respective 
> directories.
> 
> OUTPUT
> 
> gctp_wrap.c:1:25: ogr_srs_api.h: No such file or directory

I did a fix for that in CVS. Please, try the CVS snapshot and report in
case of further problems.

Best regards,
Andrey


-- 
Andrey V. Kiselev
Home phone:  +7 812 5970603  ICQ# 26871517

From fwarmerdam at gmail.com  Fri Jan  7 14:05:25 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Barely online for a bit.
Message-ID: <931f8ea9050107110546a9905b@mail.gmail.com>

Folks,

Due to a botchup switching DSL providers I will be essentially offline
for several days.  If you have a pressing need you can phone at (905) 780-0450.
I will be online using this antique technology called dialup now and then but 
I'm not likely to try and stay ahead of my email deluge. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mbrudka at aster.pl  Fri Jan  7 15:08:12 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
Message-ID: <41DEEC2C.6070009@aster.pl>

    GDAL VERSION: 1.25

    AREA/CLASS/EXAMPLE AFFECTED:
      OGR  

    DOES THE PROBLEM AFFECT:
        COMPILATION?
        LINKING?
        EXECUTION? yes
        OTHER (please specify)?

    SYNOPSIS:
It seems OGR uses reference counting inconsistently, what result in 
memory leak.

    DESCRIPTION:
OGR uses reference counting for some object to manage the life cycle of 
objects as well as to decrease OGR memory requirements.
In particular SpatialReferenceSystems are reference counted. While 
reference counting is consistent in OGRProj4CT, namely
OGRSpatialReference are deleted when counter falls below 1, in 
OGRGeometry eg. OGRGeometry::~OGRGeometry and
OGRGeometry::assignSpatialReference a counter is released without 
checking if OGRSpatialReference should be deleted. This may
result in memory leak.
    REPEAT BY:
    Analyze places, where Reference/Dereference method is called.
    SAMPLE FIX/WORKAROUND:
The quick fix is to check if reference counter falls below 1 and 
eventually delete the object eg.

OGRGeometry::~OGRGeometry()
{
    if( poSRS != NULL )
    {
        if ( poSRS->Dereference() <= 0 )
          delete poSRS;
    }
}

However, a better way to manage reference counted objects is to use 
consistently in GDAL intrusive smart pointers.
If the dependency on boost libraries is accepted, then I propose to use 
boost::instrusive_ptr
(http://www.boost.org/libs/smart_ptr/intrusive_ptr.html). If this 
dependency is for some reason undesirable, then a
simple template (boost::instrusive_ptr is 273 lines long) for such 
pointers can be written. I strongly recommend such
technique, as this is simple way to avoid related with reference counted 
memory management.

Regards
Marek Brudka



From mcoletti at gmail.com  Fri Jan  7 16:49:33 2005
From: mcoletti at gmail.com (Mark Coletti)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
In-Reply-To: <41DEEC2C.6070009@aster.pl>
References: <41DEEC2C.6070009@aster.pl>
Message-ID: <120095080501071349713f3c50@mail.gmail.com>

On Fri, 07 Jan 2005 21:08:12 +0100, Marek Brudka <mbrudka@aster.pl> wrote:

> However, a better way to manage reference counted objects is to use
> consistently in GDAL intrusive smart pointers.
> If the dependency on boost libraries is accepted, then I propose to use
> boost::instrusive_ptr
> (http://www.boost.org/libs/smart_ptr/intrusive_ptr.html). 

   I strongly second the use of Boost C++ Library reference counting
smart pointers.  For that matter, the Boost library is chock full of
some incredibly useful C++ goodies.  Fortunately it's been round long
enough that it generally comes stock with development packages on most
linux distros.  It's also cross-platform -- I know it works in unix,
linux, macs, and on Windows.

Just my two pence' worth.

MAC
-- 
I'm taking reality in small doses to build immunity.

From katrin.amlacher at joanneum.at  Sat Jan  8 04:05:59 2005
From: katrin.amlacher at joanneum.at (katrin.amlacher@joanneum.at)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20050108080036.5ADF159CFA0@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050108/baaeb705/attachment.wav
From route at cae.com  Sun Jan  9 08:10:36 2005
From: route at cae.com (route@cae.com)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Re: Hi
Message-ID: <20050109120510.11FCD5A18CD@xserve.flids.com>

Please answer quickly!

++++ Attachment: No Virus found
++++ F-Secure AntiVirus - www.f-secure.com

-------------- next part --------------
A non-text attachment was scrubbed...
Name: summary2004_gdal-dev.zip
Type: application/octet-stream
Size: 29840 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050109/ec4e3a45/summary2004_gdal-dev.obj
From tim at linfiniti.com  Mon Jan 10 06:25:58 2005
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Trapping coordinate transformation errors gracefully
Message-ID: <200501101125.59917.tim@linfiniti.com>

Hi

I am trying to compute a transform for a rectangle. Sometimes invalid data is 
being passed and I would like to be able to handle errors gracefully. 
Currently when ogr throws this error message (I include a bit of qgis stdout 
too for context):


vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
Rect inverse projection...
INPUT:
PROJCS["Alaska_Albers_Equal_Area_Conic",GEOGCS["GCS_WGS_1984",DATUM["WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["longitude_of_center",-154.0],PARAMETER["Standard_Parallel_1",55.0],PARAMETER["Standard_Parallel_2",65.0],PARAMETER["latitude_of_center",50.0],UNIT["Meter",1.0]]
OUTPUT:
GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84
[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG","4326"]]
INPUT RECT:
-173846,730736:255493,971426
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ERROR 1: latitude or longitude exceeded limits


As you see from the code excerpt below I do try to trap for the transform 
failing, but when the error is encountered QGIS segfaults. A backtrace is 
included at the end of this email - though I dont have gdal built with 
debugging support so I dont know how useful it is.

Many thanks for any help you may have to offer 

Regards

Tim Sutton

inline QgsRect QgsCoordinateTransform::inverseTransform(QgsRect theRect)
{
  if (mShortCircuit || !mInitialisedFlag) return theRect;
    // transform x
  double x1 = theRect.xMin(); 
  double y1 = theRect.yMin();
  double x2 = theRect.xMax(); 
  double y2 = theRect.yMax();  
#ifdef QGISDEBUG   
  
  std::cout << 
"vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv"<< 
std::endl;
  std::cout << "Rect inverse projection..." << std::endl;
  std::cout << "INPUT: " << std::endl << mSourceWKT << std::endl;
  std::cout << "OUTPUT: " << std::endl << mDestWKT  << std::endl;
  std::cout << "INPUT RECT: " << std::endl << x1 << "," << y1 << ":" << x2 << 
"," << y2 << std::endl;
  std::cout << 
"^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^" << 
std::endl;
#endif  

  // Number of points to reproject------+
  //                                    | 
  //                                    V 
  if ( ! mDestToSourceXForm->Transform( 1, &x1, &y1 ) || ! 
mDestToSourceXForm->Transform( 1, &x2, &y2 ) )
  {
    //something bad happened....
    throw QgsCsException(QString("Coordinate inverse transform failed"));
  }
  else
  {
#ifdef QGISDEBUG 
    std::cout << "Xmin : " 
              << theRect.xMin() 
	      << "-->" << x1 
	      << ", Ymin: " 
	      << theRect.yMin() 
	      << " -->" << y1
              << "Xmax : " 
              << theRect.xMax() 
	      << "-->" << x2 
	      << ", Ymax: " 
	      << theRect.yMax() 
	      << " -->" << y2	      
	      << std::endl;
#endif        
    return QgsRect(x1, y1, x2 , y2);
  } 
}


#0  0xffffe410 in ?? ()
#1  0xbfffdcb8 in ?? ()
#2  0x00000006 in ?? ()
#3  0x4129e529 in abort () from /lib/tls/libc.so.6
#4  0x41223c25 in __cxxabiv1::__terminate () from /usr//lib/libstdc++.so.5
#5  0x41223c62 in std::terminate () from /usr//lib/libstdc++.so.5
#6  0x41223da2 in __cxa_throw () from /usr//lib/libstdc++.so.5
#7  0x080ff9b5 in QgsCoordinateTransform::inverseTransform (this=Variable 
"this" is not available.
) at qshared.h:50
#8  0x080f8d9a in QgsMapCanvas::render (this=0x83efb10, theQPaintDevice=0x0) 
at memory:271


-- 

Procrastination 
"Hard Work Often Pays Off After Time, but Laziness Always Pays Off Now." 

From fwarmerdam at gmail.com  Mon Jan 10 09:55:53 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Trapping coordinate transformation errors gracefully
In-Reply-To: <200501101125.59917.tim@linfiniti.com>
References: <200501101125.59917.tim@linfiniti.com>
Message-ID: <931f8ea905011006557d0b7aaf@mail.gmail.com>

On Mon, 10 Jan 2005 11:25:58 +0000, Tim Sutton <tim@linfiniti.com> wrote:
> As you see from the code excerpt below I do try to trap for the transform
> failing, but when the error is encountered QGIS segfaults. A backtrace is
> included at the end of this email - though I dont have gdal built with
> debugging support so I dont know how useful it is.

Tim,

>From the traceback information it looks like you are dying because there
is no handler for the exception you are throwing.  Off hand it does not seem
like a GDAL problem. 

If you have a concern about the GDAL (really PROJ) error message
being written to stderr, you can do the following to supress error output
to stderr:

  CPLPushErrorHandler( CPLQuietErrorHandler );

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From route at cae.com  Mon Jan 10 11:03:23 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] setting "thematic" flag for IMG
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D2C6@caemsx03.cae.ca>

Hi everybody,

I'm reading a thematic img image and I'm modifying some pixels.
The problem is that when I write back the modified file, the layerType is
set as "athematic".
Is there a way to force the written image to be "thematic" and not
"athematic" ?

Thanks a lot,

Best Regards,

Stephane Routelous


From fwarmerdam at gmail.com  Mon Jan 10 11:27:06 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] setting "thematic" flag for IMG
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D2C6@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D2C6@caemsx03.cae.ca>
Message-ID: <931f8ea9050110082728007f81@mail.gmail.com>

On Mon, 10 Jan 2005 11:03:23 -0500, Stephane Routelous <route@cae.com> wrote:
> Hi everybody,
> 
> I'm reading a thematic img image and I'm modifying some pixels.
> The problem is that when I write back the modified file, the layerType is
> set as "athematic".
> Is there a way to force the written image to be "thematic" and not
> "athematic" ?

Stephane, 

Currently the layerType is set to athematic by default, and only reset to
thematic if you write a pseudocolor table to the band.  It wouldn't be
hard to add access to the layerType for getting and setting via metadata
if you need to be able to set it.

I should be able to implement it today or tomorrow if you decide you 
need the ability. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From route at cae.com  Mon Jan 10 11:31:58 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] setting "thematic" flag for IMG
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D2C7@caemsx03.cae.ca>

Hi Frank,

thanks a lot for your answer.
If it is not too hard for you, it will be good if I can get access to the
metadata setting quite quickly (today or tomorrow seems very good).
If you don't have time, I can try to dig into the code to make it, but I
never touched or used the metadata mecanism.

Thanks again for your quick answer.

Best Regards,

Stephane Routelous

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent: Monday, January 10, 2005 11:27 AM
To: Stephane Routelous
Cc: 'Gdal-Dev (E-mail); Mohamed Wali-Alami
Subject: Re: [Gdal-dev] setting "thematic" flag for IMG


On Mon, 10 Jan 2005 11:03:23 -0500, Stephane Routelous <route@cae.com>
wrote:
> Hi everybody,
> 
> I'm reading a thematic img image and I'm modifying some pixels.
> The problem is that when I write back the modified file, the layerType is
> set as "athematic".
> Is there a way to force the written image to be "thematic" and not
> "athematic" ?

Stephane, 

Currently the layerType is set to athematic by default, and only reset to
thematic if you write a pseudocolor table to the band.  It wouldn't be
hard to add access to the layerType for getting and setting via metadata
if you need to be able to set it.

I should be able to implement it today or tomorrow if you decide you 
need the ability. 

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Mon Jan 10 13:26:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] setting "thematic" flag for IMG
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D2C7@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D2C7@caemsx03.cae.ca>
Message-ID: <931f8ea90501101026e2ebe3e@mail.gmail.com>

On Mon, 10 Jan 2005 11:31:58 -0500, Stephane Routelous <route@cae.com> wrote:
> Hi Frank,
> 
> thanks a lot for your answer.
> If it is not too hard for you, it will be good if I can get access to the
> metadata setting quite quickly (today or tomorrow seems very good).
> If you don't have time, I can try to dig into the code to make it, but I
> never touched or used the metadata mecanism.

Stephane,

I have committed support for getting and setting the layerType
value for bands via the LAYER_TYPE metadata entry.   I have
also committed a bunch of code related writing compressed 
imagine files supplied by Sam Gillingham.  Let me know if you 
have any problems.   

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jvarga at boulder.net  Mon Jan 10 17:13:25 2005
From: jvarga at boulder.net (Jack Varga)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] linker problem?
Message-ID: <41E2FE05.2010802@boulder.net>

Has anyone ever seen this?  gdal use to run fine.  Now all of a sudden 
it drops core, (as does ogrinfo, qgis, and perhaps some others).  FWIW, 
Grass57(cvs) seems to still work fine.

I'm fairly certain its related to a problem with the dynamic loading of 
shared libs, but not sure how to rectify.

gdb reports...

$ gdb gdalinfo core.11057
GNU gdb 6.2-2mdk (Mandrakelinux)
This GDB was configured as "i586-mandrake-linux-gnu"...Using host 
libthread_db
library "/lib/tls/libthread_db.so.1".

Core was generated by `gdalinfo --version'.
Program terminated with signal 8, Arithmetic exception.

warning: current_sos: Can't read pathname for load map: Input/output error

Reading symbols from /usr/local/lib/libgdal.so.1...done.
Loaded symbols for /usr/local/lib/libgdal.so.1
Reading symbols from /usr/local/lib/libgeos.so.2...done.
Loaded symbols for /usr/local/lib/libgeos.so.2
Reading symbols from /usr/local/lib/libodbc.so.1...done.
Loaded symbols for /usr/local/lib/libodbc.so.1
Reading symbols from 
/usr/local/xerces-c-src_2_6_0/lib/libxerces-c.so.26...done
.
Loaded symbols for /usr/local/xerces-c-src_2_6_0/lib/libxerces-c.so.26
Reading symbols from /usr/local/lib/libogdi31.so...done.
Loaded symbols for /usr/local/lib/libogdi31.so
Reading symbols from /usr/lib/libjpeg.so.62...done.
Loaded symbols for /usr/lib/libjpeg.so.62
Reading symbols from /usr/local/lib/libgeotiff.so...done.
Loaded symbols for /usr/local/lib/libgeotiff.so
Reading symbols from /usr/lib/libtiff.so.3...done.
Loaded symbols for /usr/lib/libtiff.so.3
Reading symbols from /usr/lib/libpng.so.3...done.
Loaded symbols for /usr/lib/libpng.so.3
Reading symbols from /usr/local/lib/libgrass5.so.0...done.
Loaded symbols for /usr/local/lib/libgrass5.so.0
Reading symbols from /usr/lib/libxml2.so.2...done.
Loaded symbols for /usr/lib/libxml2.so.2
Reading symbols from /usr/lib/libssl.so.0.9.7...done.
Loaded symbols for /usr/lib/libssl.so.0.9.7
Reading symbols from /usr/lib/libcrypto.so.0.9.7...done.
Loaded symbols for /usr/lib/libcrypto.so.0.9.7
Reading symbols from /lib/libdl.so.2...done.
Loaded symbols for /lib/libdl.so.2
Reading symbols from /lib/tls/libpthread.so.0...done.
Loaded symbols for /lib/tls/libpthread.so.0
Reading symbols from /usr/lib/libpq.so.3...done.
Loaded symbols for /usr/lib/libpq.so.3
Reading symbols from /usr/lib/libmysqlclient.so.12...done.
Loaded symbols for /usr/lib/libmysqlclient.so.12
Reading symbols from /lib/libcrypt.so.1...done.
Loaded symbols for /lib/libcrypt.so.1
Reading symbols from /lib/libnsl.so.1...done.
Loaded symbols for /lib/libnsl.so.1
Reading symbols from /usr/lib/libstdc++.so.6...done.
Loaded symbols for /usr/lib/libstdc++.so.6
Reading symbols from /lib/tls/libm.so.6...done.
Loaded symbols for /lib/tls/libm.so.6
Reading symbols from /lib/libgcc_s.so.1...done.
Loaded symbols for /lib/libgcc_s.so.1
Reading symbols from /lib/tls/libc.so.6...done.
Loaded symbols for /lib/tls/libc.so.6
Reading symbols from /lib/libz.so.1...done.
Loaded symbols for /lib/libz.so.1
Reading symbols from /usr/local/lib/libzlib_ogdi31.so...done.
Loaded symbols for /usr/local/lib/libzlib_ogdi31.so
Reading symbols from /usr/local/lib/libexpat_ogdi31.so...done.
Loaded symbols for /usr/local/lib/libexpat_ogdi31.so
Reading symbols from /usr/local/lib/libproj.so.0...done.
Loaded symbols for /usr/local/lib/libproj.so.0
Reading symbols from /lib/ld-linux.so.2...done.
Loaded symbols for /lib/ld-linux.so.2
Reading symbols from /lib/libresolv.so.2...done.
Loaded symbols for /lib/libresolv.so.2
#0  0x40008358 in _dl_allocate_static_tls (map=0x40015c58) at dl-reloc.c:72
72      dl-reloc.c: No such file or directory.
         in dl-reloc.c
(gdb)


From tim at linfiniti.com  Mon Jan 10 19:30:18 2005
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Trapping coordinate transformation errors gracefully
In-Reply-To: <931f8ea905011006557d0b7aaf@mail.gmail.com>
References: <200501101125.59917.tim@linfiniti.com>
	<931f8ea905011006557d0b7aaf@mail.gmail.com>
Message-ID: <200501110030.19155.tim@linfiniti.com>

Dear Frank

Many thanks for your reply. I am still getting similar problems after 
following your suggestion...any other suggestions will be much appreciated. 
Also how do I use an error handler which does print to std::cout ?

Many thanks for your help

Tim

Updated code:

  CPLPushErrorHandler( CPLQuietErrorHandler );
  // Number of points to reproject---------------+
  //                                             | 
  //                                             V    
  int myResult1 = mDestToSourceXForm->Transform( 1, &x1, &y1 );
  int myResult2 = mDestToSourceXForm->Transform( 1, &x2, &y2 );
  CPLPopErrorHandler();

  if ( ! myResult1 || ! myResult2 )
  {
    //something bad happened....
    throw QgsCsException(QString("Coordinate inverse transform failed"));
  }
  else
  { etc ...

Backtrace:

#0  0xffffe410 in ?? ()
(gdb) bt
#0  0xffffe410 in ?? ()
#1  0xbfffdcb8 in ?? ()
#2  0x00000006 in ?? ()
#3  0x4129e529 in abort () from /lib/tls/libc.so.6
#4  0x41223c25 in __cxxabiv1::__terminate () from /usr//lib/libstdc++.so.5
#5  0x41223c62 in std::terminate () from /usr//lib/libstdc++.so.5
#6  0x41223da2 in __cxa_throw () from /usr//lib/libstdc++.so.5
#7  0x08100e80 in QgsCoordinateTransform::inverseTransform (this=Variable 
"this" is not available.
) at qshared.h:50
#8  0x080f8e6a in QgsMapCanvas::render (this=0x83ce620, theQPaintDevice=0x0) 
at memory:271


Std Out dump:

Rect projection...Xmin : -47765.6-->-154.781, Ymin: 741676 -->56.6804Xmax : 
129413-->-151.765, Ymax: 960485 -->58.6227
Transformed extent     -154.780832        56.680383,     -151.764776        
58.622733
Maplayer asked for coordinateTransform which is....valid
vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv
Rect inverse projection...
INPUT:
PROJCS["Alaska_Albers_Equal_Area_Conic",GEOGCS["GCS_WGS_1984",DATUM["WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Albers_Conic_Equal_Area"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["longitude_of_center",-154.0],PARAMETER["Standard_Parallel_1",55.0],PARAMETER["Standard_Parallel_2",65.0],PARAMETER["latitude_of_center",50.0],UNIT["Meter",1.0]]
OUTPUT:
GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84
[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AXIS["Lat",NORTH],AXIS["Long",EAST],AUTHORITY["EPSG","4326"]]
INPUT RECT:
-23155.6,836058:70960.6,907537
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Aborted (core dumped)


-- 

Procrastination 
"Hard Work Often Pays Off After Time, but Laziness Always Pays Off Now." 

From fwarmerdam at gmail.com  Mon Jan 10 19:55:26 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Trapping coordinate transformation errors gracefully
In-Reply-To: <200501110030.19155.tim@linfiniti.com>
References: <200501101125.59917.tim@linfiniti.com>
	<931f8ea905011006557d0b7aaf@mail.gmail.com>
	<200501110030.19155.tim@linfiniti.com>
Message-ID: <931f8ea905011016554a422b10@mail.gmail.com>

On Tue, 11 Jan 2005 00:30:18 +0000, Tim Sutton <tim@linfiniti.com> wrote:
> Dear Frank
> 
> Many thanks for your reply. I am still getting similar problems after
> following your suggestion...any other suggestions will be much appreciated.
> Also how do I use an error handler which does print to std::cout ?
> 
> Many thanks for your help

Tim,

OK, there are a few issues here.  One is the error handling.   I 
didn't see any output from the GDAL error code in your new output so
as far as i can tell the CPLQuietErrorHandler worked fine.   If you want
to implement a custom error handler that is quite easy too.  You might
want to read this over:

  http://www.gdal.org/cpl__error_8h.html#a23

The second issue is that the transformation is failing sometimes.  I 
am assuming it is failing for decent reasons.  If you believe that it is
not, let me know and we could likely dig into it. 

Finally there is the crash, but as I mentioned, as far as I can tell
your application is crashing because you are throwing an exception
with no handler.  That has nothing to do with me.  If you don't want it
to crash either add an exception handler or stop throwing the 
exception and fail out gracefully.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From dherring at mohicam.com  Tue Jan 11 01:18:35 2005
From: dherring at mohicam.com (David Herring)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL and ODBC >= 3.52
Message-ID: <1105424315.10871.65.camel@bounty.mohicam.com>

I'm wondering if anyone else has noticed that GDAL 1.2.5 doesn't compile
against ODBC 3.52.

Here are the details:

GDAL does not compile against ODBC 3.52 due to the new types introduced
in ODBC to handle 64 bit compiles. It appears that calls to
SQLDescribeCol and SQLGetData compiled against ODBC 3.52 should use the
new datatypes SQLLEN and SQLULEN for a few parameters instead of
SQLINTEGER and SQLUINTEGER.

This change is documented here: 

http://msdn.microsoft.com/library/default.asp?url=/library/en-
us/odbc/htm/dasdkodbcoverview_64bit.asp

Note that the Microsoft documentation above applies to UNIX drivers as
well I've tried several including OpenLink and drivers from unixODBC.

I've attached a patch file for two source files: cpl_odbc.cpp and
cpl_odbc.h (cd gdal-1.2.5/port; patch < patch-gdal-odbc-3.52). 

This patch allows me to compile against ODBC 3.52, but a 'real' fix for
all GDAL users is slightly more complicated since the new types SQLLEN
and SQLULEN are not defined in ODBC <= 3.51.

I've downloaded ODBC 3.51 and 3.52 and am working on a patch to
configure.in and related files which I'll submit for consideration if
Frank or others feel it might help.


Regards,

David Herring
dherring@mohicam.com

-------------- next part --------------
--- cpl_odbc.cpp	2004-08-18 13:47:12.000000000 -0500
+++ cpl_odbc.cpp-patched	2005-01-08 00:35:03.398348631 -0600
@@ -352,9 +352,9 @@
     m_papszColNames = (char **) VSICalloc(sizeof(char *),(m_nColCount+1));
     m_papszColValues = (char **) VSICalloc(sizeof(char *),(m_nColCount+1));
 
     m_panColType = (short *) VSICalloc(sizeof(short),m_nColCount);
-    m_panColSize = (SQLUINTEGER *) VSICalloc(sizeof(SQLUINTEGER),m_nColCount);
+    m_panColSize = (SQLULEN *) VSICalloc(sizeof(SQLULEN),m_nColCount);
     m_panColPrecision = (short *) VSICalloc(sizeof(short),m_nColCount);
     m_panColNullable = (short *) VSICalloc(sizeof(short),m_nColCount);
 
 /* -------------------------------------------------------------------- */
@@ -567,9 +567,9 @@
     
     for( iCol = 0; iCol < m_nColCount; iCol++ )
     {
         char szWrkData[256];
-        SQLINTEGER cbDataLen;
+        SQLLEN cbDataLen;
         int nRetCode;
 
         szWrkData[0] = '\0';
         szWrkData[sizeof(szWrkData)-1] = '\0';
@@ -1026,9 +1026,9 @@
     m_papszColNames = (char **) calloc(sizeof(char *),(m_nColCount+1));
     m_papszColValues = (char **) calloc(sizeof(char *),(m_nColCount+1));
 
     m_panColType = (short *) calloc(sizeof(short),m_nColCount);
-    m_panColSize = (SQLUINTEGER *) calloc(sizeof(SQLUINTEGER),m_nColCount);
+    m_panColSize = (SQLULEN *) calloc(sizeof(SQLULEN),m_nColCount);
     m_panColPrecision = (short *) calloc(sizeof(short),m_nColCount);
     m_panColNullable = (short *) calloc(sizeof(short),m_nColCount);
 
 /* -------------------------------------------------------------------- */
@@ -1040,9 +1040,9 @@
 
     for( iCol = 0; iCol < m_nColCount; iCol++ )
     {
         char szWrkData[8193];
-        SQLINTEGER cbDataLen;
+        SQLLEN cbDataLen;
 
         if( Failed( SQLFetch( m_hStmt ) ) )
         {
             m_nColCount = (SQLUSMALLINT) iCol;
--- cpl_odbc.h	2004-06-23 11:11:30.000000000 -0500
+++ cpl_odbc.h-patched	2005-01-08 00:35:08.789358787 -0600
@@ -125,9 +125,9 @@
 
     short          m_nColCount;
     char         **m_papszColNames;
     short         *m_panColType;
-    SQLUINTEGER   *m_panColSize;
+    SQLULEN       *m_panColSize;
     short         *m_panColPrecision;
     short         *m_panColNullable;
 
     char         **m_papszColValues;
From tim at linfiniti.com  Tue Jan 11 05:14:39 2005
From: tim at linfiniti.com (Tim Sutton)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Trapping coordinate transformation errors gracefully
In-Reply-To: <931f8ea905011016554a422b10@mail.gmail.com>
References: <200501101125.59917.tim@linfiniti.com>
	<200501110030.19155.tim@linfiniti.com>
	<931f8ea905011016554a422b10@mail.gmail.com>
Message-ID: <200501111014.39927.tim@linfiniti.com>

Hi

Many thanks your advice was spot on! Commenting out our exception handlers 
removed seqfaulting problem.

Best regards

Tim

On Tuesday 11 January 2005 00:55, Frank Warmerdam wrote:
> On Tue, 11 Jan 2005 00:30:18 +0000, Tim Sutton <tim@linfiniti.com> wrote:
> > Dear Frank
> >
> > Many thanks for your reply. I am still getting similar problems after
> > following your suggestion...any other suggestions will be much
> > appreciated. Also how do I use an error handler which does print to
> > std::cout ?
> >
> > Many thanks for your help
>
> Tim,
>
> OK, there are a few issues here.  One is the error handling.   I
> didn't see any output from the GDAL error code in your new output so
> as far as i can tell the CPLQuietErrorHandler worked fine.   If you want
> to implement a custom error handler that is quite easy too.  You might
> want to read this over:
>
>   http://www.gdal.org/cpl__error_8h.html#a23
>
> The second issue is that the transformation is failing sometimes.  I
> am assuming it is failing for decent reasons.  If you believe that it is
> not, let me know and we could likely dig into it.
>
> Finally there is the crash, but as I mentioned, as far as I can tell
> your application is crashing because you are throwing an exception
> with no handler.  That has nothing to do with me.  If you don't want it
> to crash either add an exception handler or stop throwing the
> exception and fail out gracefully.
>
> Best regards,

-- 

Procrastination 
"Hard Work Often Pays Off After Time, but Laziness Always Pays Off Now." 

From fwarmerdam at gmail.com  Tue Jan 11 09:44:09 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL and ODBC >= 3.52
In-Reply-To: <1105424315.10871.65.camel@bounty.mohicam.com>
References: <1105424315.10871.65.camel@bounty.mohicam.com>
Message-ID: <931f8ea905011106445c2be37b@mail.gmail.com>

On Tue, 11 Jan 2005 00:18:35 -0600, David Herring <dherring@mohicam.com> wrote:
> This patch allows me to compile against ODBC 3.52, but a 'real' fix for
> all GDAL users is slightly more complicated since the new types SQLLEN
> and SQLULEN are not defined in ODBC <= 3.51.
> 
> I've downloaded ODBC 3.51 and 3.52 and am working on a patch to
> configure.in and related files which I'll submit for consideration if
> Frank or others feel it might help.

David,

Rather than trying to detect this in configure, it is possible to
figure out where
we are in a pre or post 3.51 version right in cpl_odbc.cpp? 

I have an ODBC 3.51 sql.h here that defines the ODBCVER macro.
It would seem we should be able to determine whether we need 3.52
versions of stuff based on a check like:

#if ODBCVER > 0x0351
...
#else
...
#endif

If you can prepare and test a patch based on that I would
be pleased to apply it. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From Donald.W.Johnson at mvk02.usace.army.mil  Thu Jan  6 10:45:29 2005
From: Donald.W.Johnson at mvk02.usace.army.mil (Johnson,
	Donald W MVK Contractor)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Writing grid files
Message-ID: <A1D73B6FA233F148901FE4AE09B6B9F4E8BF1C@MVK-ML01VIC.mvk.ds.usace.army.mil>

Is there any chance that GIO driver will be renabled or creation capability
added to the AIG driver? It would be extreamly usefull for my work.
Thanks for your time.

Donald.W.Johnson@mvk02.usace.army.mil
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050106/c34f6653/attachment.html
From eric at 21csi.com  Tue Jan  4 11:30:16 2005
From: eric at 21csi.com (Eric Lindahl)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] NAD83 Fipszone 903 to WGS84 Error
Message-ID: <loom.20050104T172647-53@post.gmane.org>


Hi,

I attempted to fix the PRJ.ADF import that didn't recognize the FIPSZONE
key word.


691,692c694,704
         int nZone = (int) OSR_GDV( papszPrj, "zone", 0.0 );
         nZone = ESRIToUSGSZone( nZone );
---
         double def = -10000.0;
         double dZone = OSR_GDV( papszPrj, "zone", def );
         int nZone = 0;
         if( dZone == def ){
           dZone = OSR_GDV( papszPrj, "Fipszone", def );
           nZone = (dZone==def)?0:(int)dZone;
         }else{
           nZone = (int)dZone;
           nZone = ESRIToUSGSZone( nZone );
         }


After I did this, my gdalinfo command output this description with
the *wrong* corner coordinates:
Driver: AIG/Arc/Info Binary Grid
Size is 16771, 13439
Coordinate System is:
LOCAL_CS["State Plane Zone 2500 / NAD83",
    UNIT["Foot (International)",0.3048]]
Origin = (1599823.500000,411154.500000)
Pixel Size = (3.00000000,-3.00000000)
Corner Coordinates:
Upper Left  ( 1599823.500,  411154.500) 
Lower Left  ( 1599823.500,  370837.500) 
Upper Right ( 1650136.500,  411154.500) 
Lower Right ( 1650136.500,  370837.500) 
Center      ( 1624980.000,  390996.000) 
Band 1 Block=256x4 Type=Int16, ColorInterp=Undefined
  Min=-10.000 Max=384.000 
  NoData Value=-32768
Driver: AIG/Arc/Info Binary Grid
Size is 16771, 13439
Coordinate System is:
PROJCS["NAD83 / Florida North",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree (supplier to define representation)",0.01745329251994328,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",30.75],
    PARAMETER["standard_parallel_2",29.58333333333333],
    PARAMETER["latitude_of_origin",29],
    PARAMETER["central_meridian",-84.5],
    PARAMETER["false_easting",600000],
    PARAMETER["false_northing",0],
    UNIT["Foot (International)",0.3048],
    AUTHORITY["EPSG","26960"]]
Origin = (1599823.500000,411154.500000)
Pixel Size = (3.00000000,-3.00000000)
Corner Coordinates:
Upper Left  ( 1599823.500,  411154.500) ( 81d20'17.01"W, 30d 5'32.78"N)
Lower Left  ( 1599823.500,  370837.500) ( 81d20'29.73"W, 29d58'53.84"N)
Upper Right ( 1650136.500,  411154.500) ( 81d10'44.52"W, 30d 5'18.62"N)
Lower Right ( 1650136.500,  370837.500) ( 81d10'57.87"W, 29d58'39.70"N)
Center      ( 1624980.000,  390996.000) ( 81d15'37.28"W, 30d 2'6.32"N)
Band 1 Block=256x4 Type=Int16, ColorInterp=Undefined
  Min=-10.000 Max=384.000 
  NoData Value=-32768


The PROJ4 format for the source ends up being:
+proj=lcc +lat_1=30.75 +lat_2=29.58333333333333 +lat_0=29 +lon_0=-84.5 
+x_0=182880 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs


But if the coordinates are calculated by hand:
Converting Upper Left coordinates to meters
1599823.5 * 1200 / 3937 = 487627.178 meters
411154.5 * 1200 / 3937 = 125320.14224 meters

Using these numbers as input at
http://www.ngs.noaa.gov/cgi-bin/spc_getgp.prl
===========================================================
                 North(Meters)     East(Meters)     Datum     Zone
 INPUT =  125320.14224      487627.178       NAD83     0903
 ===========================================================
  LATITUDE         LONGITUDE         AREA    CONVERGENCE   SCALE FACTOR
 DD MM SS.sssss   DDD MM SS.sssss           DD MM SS.ss      
 --------------        ---------------        ----     -----------          ----
--------
 30 07 31.37149   085 39 58.31866   FL N    -0 35  9.76        0.9999487
 
 USING TOPOZONE AND LOOKING AT THE ADF FILE DISPLAYED IN GEOMATICA,
I WOULD SAY THAT THIS IS YOUR EXACT UPPER LEFT HAND CORNER

 North 30 07 31.37149   West 085 39 58.31866
    Or in decimal ......
 30.1254?N     85.6662?W    
 
And then converting Lower Right coordinates to meters
1650136.500 * 1200 / 3937 = 502962.6111 meters
370837.500 * 1200 / 3937 =  113031.496 meters
 
===========================================================
               North(Meters)     East(Meters)     Datum     Zone
 INPUT =  113031.496        502962.6111      NAD83     0903
===========================================================
 LATITUDE             LONGITUDE         AREA    CONVERGENCE   SCALE FACTOR
 DD MM SS.sssss   DDD MM SS.sssss           DD MM SS.ss      
 --------------         ---------------        ----      -----------          --
----------
 30 00 57.03675   085 30 21.35891   FL N    -0 30 19.83          0.9999519



From gfoote at caci.com  Mon Jan 10 16:54:18 2005
From: gfoote at caci.com (Geoffrey Foote)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Using GDAL to open NITF image
Message-ID: <OF44BC53BC.075093CB-ON85256F85.0077DE20-85256F85.0078538A@caci.com>

Hello,


I'm looking for some advice on the best way to open a NITF image from 
source. I not only want to be able to open the entire NITF file, but I 
would like to display the image/images with in the file and save them out 
a different format. 

Any help would be much appreicated.

Geoff
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050110/95ffaec0/attachment.html
From dherring at mohicam.com  Tue Jan 11 10:05:54 2005
From: dherring at mohicam.com (David Herring)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL and ODBC >= 3.52
In-Reply-To: <931f8ea905011106445c2be37b@mail.gmail.com>
References: <1105424315.10871.65.camel@bounty.mohicam.com>
	<931f8ea905011106445c2be37b@mail.gmail.com>
Message-ID: <1105455955.10871.72.camel@bounty.mohicam.com>

#defining in cpl_odbc.cpp should work easily, I should have thought of
that thanks. I'll give it a try later today and submit a simple patch.


David


On Tue, 2005-01-11 at 09:44 -0500, Frank Warmerdam wrote:
> On Tue, 11 Jan 2005 00:18:35 -0600, David Herring <dherring@mohicam.com> wrote:

> David,
> 
> Rather than trying to detect this in configure, it is possible to
> figure out where
> we are in a pre or post 3.51 version right in cpl_odbc.cpp? 
> I have an ODBC 3.51 sql.h here that defines the ODBCVER macro.
> It would seem we should be able to determine whether we need 3.52
> versions of stuff based on a check like:
> 
> #if ODBCVER > 0x0351
> ...
> #else
> ...
> #endif
> 


> If you can prepare and test a patch based on that I would
> be pleased to apply it. 
> 
> Best regards,
> 


From fwarmerdam at gmail.com  Tue Jan 11 10:13:20 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Writing grid files
In-Reply-To: <A1D73B6FA233F148901FE4AE09B6B9F4E8BF1C@MVK-ML01VIC.mvk.ds.usace.army.mil>
References: <A1D73B6FA233F148901FE4AE09B6B9F4E8BF1C@MVK-ML01VIC.mvk.ds.usace.army.mil>
Message-ID: <931f8ea905011107133330bd9b@mail.gmail.com>

On Thu, 6 Jan 2005 09:45:29 -0600, Johnson,  Donald W MVK Contractor
<Donald.W.Johnson@mvk02.usace.army.mil> wrote:
>  
> 
> Is there any chance that GIO driver will be renabled or creation capability
> added to the AIG driver? It would be extreamly usefull for my work. 
> 
> Thanks for your time. 

David,

It shouldn't be hard to re-enable the GIO driver in your local build
but there are "issues" with the way it tries to adjust the georeferencing
post-creation.  Likely the best way of dealing with this would be to rewrite
the export support as a CreateCopy method which would ensure I know
the georeferencing at the point the grid coverage is created. 

To re-enable the GIO driver, I think you can just call uncomment the
call to GDALRegister_AIGrid2() in gdal/frmts/gdalallregister.cpp.  But to 
fixup the code to set the georeferencing will require a bunch of development.
If you need it, perhaps you could write me a little more detail about what you
need to accomplish privately.  

I have dug into the format before with the idea of adding create support
without use of the ESRI DLL but failed to master the format well enough
to create valid datasets.

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jan 11 10:19:31 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Using GDAL to open NITF image
In-Reply-To: <OF44BC53BC.075093CB-ON85256F85.0077DE20-85256F85.0078538A@caci.com>
References: <OF44BC53BC.075093CB-ON85256F85.0077DE20-85256F85.0078538A@caci.com>
Message-ID: <931f8ea9050111071947b0cc95@mail.gmail.com>

On Mon, 10 Jan 2005 16:54:18 -0500, Geoffrey Foote <gfoote@caci.com> wrote:
>  
> Hello, 
>  
>  
> I'm looking for some advice on the best way to open a NITF image from
> source. I not only want to be able to open the entire NITF file, but I would
> like to display the image/images with in the file and save them out a
> different format. 

Geoff,

For opening an NITF image, accessing information and copying the image
to another file I would suggest you review the GDAL API Tutorial at:

  http://www.gdal.org/gdal_tutorial.html

It applies pretty directly to NITF format. 

GDAL does not have a visualization component, so displaying the
NITF images will have to be handled by some other application or layer.
There are a variety of applications that support vizualization using GDAL
including OpenEV (http://openev.sf.net). 

GDAL issues specific to NITF should be discussed in the driver page.  Be
aware there is alot of NITF specific supporting data available in some NITF
files.  A significant amount is exposed by GDAL as metadata, but there are
also lots of extension objects in NITF that are not supported by GDAL.  If
you have very specific needs you will need to ask additional questions.

Driver page:

  http://www.gdal.org/frmt_nitf.html
  
Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jan 11 10:45:12 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] NAD83 Fipszone 903 to WGS84 Error
In-Reply-To: <loom.20050104T172647-53@post.gmane.org>
References: <loom.20050104T172647-53@post.gmane.org>
Message-ID: <931f8ea905011107458aab9eb@mail.gmail.com>

On Tue, 4 Jan 2005 16:30:16 +0000 (UTC), Eric Lindahl <eric@21csi.com> wrote:
> 
> Hi,
> 
> I attempted to fix the PRJ.ADF import that didn't recognize the FIPSZONE
> key word.
> 
> 691,692c694,704
>          int nZone = (int) OSR_GDV( papszPrj, "zone", 0.0 );
>          nZone = ESRIToUSGSZone( nZone );
> ---
>          double def = -10000.0;
>          double dZone = OSR_GDV( papszPrj, "zone", def );
>          int nZone = 0;
>          if( dZone == def ){
>            dZone = OSR_GDV( papszPrj, "Fipszone", def );
>            nZone = (dZone==def)?0:(int)dZone;
>          }else{
>            nZone = (int)dZone;
>            nZone = ESRIToUSGSZone( nZone );
>          }

Eric,

The above looks like a useful patch.  Could I get the .prj file in question for
my "sample file collection" and so I can test things out?

> Coordinate System is:
> PROJCS["NAD83 / Florida North",
>     GEOGCS["NAD83",
>         DATUM["North_American_Datum_1983",
>             SPHEROID["GRS 1980",6378137,298.257222101,
>                 AUTHORITY["EPSG","7019"]],
>             AUTHORITY["EPSG","6269"]],
>         PRIMEM["Greenwich",0,
>             AUTHORITY["EPSG","8901"]],
>         UNIT["degree (supplier to define representation)",0.01745329251994328,
>             AUTHORITY["EPSG","9122"]],
>         AUTHORITY["EPSG","4269"]],
>     PROJECTION["Lambert_Conformal_Conic_2SP"],
>     PARAMETER["standard_parallel_1",30.75],
>     PARAMETER["standard_parallel_2",29.58333333333333],
>     PARAMETER["latitude_of_origin",29],
>     PARAMETER["central_meridian",-84.5],
>     PARAMETER["false_easting",600000],
>     PARAMETER["false_northing",0],
>     UNIT["Foot (International)",0.3048],
>     AUTHORITY["EPSG","26960"]]

It looks like my code in ogr_srs_esri.cpp for morphing the units
of the SRS is screwed up.  The 600000 meter false easting 
should have been converted from meters to feet when the linear
units were changed to feet.  But instead it looks like the conversion
was done the wrong way.   Also, I really need to clear the
AUTHORITY keyword if I change the units. 

Apparently the units changing code is *not* well tested in the ESRI
projections support code.  In any event, once I have the .prj file 
in question I can engineer in a solution to this. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From pierocavalieri at tiscali.it  Tue Jan 11 18:50:13 2005
From: pierocavalieri at tiscali.it (Piero Cavalieri)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Compilation problem with 1.2.5
Message-ID: <41E46635.2020702@tiscali.it>

Hi all,

I still have a compilation problem with version 1.2.5
Error messages are about headers not found.
This is due because when I run ./configure the
file GDALmake.opt is created, but it's empty.
This also happens with 1.2.4 version, but not with
1.2.3 and previous versions.
Could someone give me some suggestion on what looking for
to solve this problem?

Thanks in advance
    Piero

From fwarmerdam at gmail.com  Tue Jan 11 22:08:28 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Compilation problem with 1.2.5
In-Reply-To: <41E46635.2020702@tiscali.it>
References: <41E46635.2020702@tiscali.it>
Message-ID: <931f8ea905011119085d630fb9@mail.gmail.com>

On Wed, 12 Jan 2005 00:50:13 +0100, Piero Cavalieri
<pierocavalieri@tiscali.it> wrote:
> Hi all,
> 
> I still have a compilation problem with version 1.2.5
> Error messages are about headers not found.
> This is due because when I run ./configure the
> file GDALmake.opt is created, but it's empty.
> This also happens with 1.2.4 version, but not with
> 1.2.3 and previous versions.
> Could someone give me some suggestion on what looking for
> to solve this problem?

Piero,

This sounds very much like the MySQL 3.x problem.
Just configure with --without-mysql to work around this.

This problem is fixed in CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mbrudka at aster.pl  Wed Jan 12 15:57:10 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
In-Reply-To: <41DEEC2C.6070009@aster.pl>
References: <41DEEC2C.6070009@aster.pl>
Message-ID: <41E58F26.7070508@aster.pl>

Hi,
    Should I report this bug some other way eg. using bugzilla? I ask 
because I do not know the
the rules of GDAL developement.

Thanks
Marek Brudka

From no_spam_4_me at iinet.net.au  Wed Jan 12 16:09:18 2005
From: no_spam_4_me at iinet.net.au (Graham B)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Newbie help please
Message-ID: <001001c4f8ea$fb6fa450$6900a8c0@DADSINGAPOREPC>

Hi, I am Graham, living in Brisbane Australia. Certainly not an IT professional but I hope that ogr2ogr can help me do some basic edits to a large number of shapefiles.

I have a batch file as below (presently sitting in the FW tools\bin foldeer to eliminate any path issues while I get it working.

I am trying to update a shapefile called temp.shp

That is,  I want to open temp.shp and edit it such that only records where the field called FEAT_CODE = "sea" remain. Ideally I will update the original file but if ogr2ogr can create another shapefile called temp2.shp then that is OK too.

In the same folder I have the four components of the shapefile, i.e 

temp.shp
temp.prj
temp.dbf
temp.shx


If anyone can give me a couple of pointers to get me started I would really appreciate it.

Thanks in advance,
                             Graham B

ogr_ops.bat
========

echo off

rem ogr2ogr [-skipfailures] [-append] [-update] [-f format_name]
rem               [-select field_list] [-where restricted_where]
rem               [-spat xmin ymin xmax ymax]
rem               [-a_srs srs_def] [-t_srs srs_def] [-s_srs srs_def]
rem               [[-dsco NAME=VALUE] ...] dst_datasource_name
rem               src_datasource_name
rem               [-lco NAME=VALUE] [-nln name] layer [layer ...]]

echo off

rem call ogr2ogr -update -f "ESRI Shapefile" -where(FEAT_CODE =sea) temp.shp temp2.shp

call ogr2ogr 

pause
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050113/23fdb67f/attachment.html
From fwarmerdam at gmail.com  Wed Jan 12 16:11:17 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
In-Reply-To: <41E58F26.7070508@aster.pl>
References: <41DEEC2C.6070009@aster.pl> <41E58F26.7070508@aster.pl>
Message-ID: <931f8ea905011213114cd9303c@mail.gmail.com>

On Wed, 12 Jan 2005 21:57:10 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
> Hi,
>     Should I report this bug some other way eg. using bugzilla? I ask
> because I do not know the
> the rules of GDAL developement.

Marek,

Yes, it would be better reported via bugzilla.  The
problem with bug reports on the list is that if I don't
hop on them immediately they are easily forgotten
forever.

In any event, I am aware there are dangers with the
current references count for spatial references and
OGRFeatureDefns, but I am not likely to make any
immediate changes.  The obvious changes are likely
to cause other bugs in code written to the current
behaviour.  But having a bug report on the issue in
Bugzilla would be helpful to track the problem.  Also,
if you have run into this problem in "real world"
situations, it is helpful to outline that.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jan 12 16:32:25 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Newbie help please
In-Reply-To: <001001c4f8ea$fb6fa450$6900a8c0@DADSINGAPOREPC>
References: <001001c4f8ea$fb6fa450$6900a8c0@DADSINGAPOREPC>
Message-ID: <931f8ea905011213326703d47d@mail.gmail.com>

On Thu, 13 Jan 2005 07:09:18 +1000, Graham B <no_spam_4_me@iinet.net.au> wrote:
>
> rem call ogr2ogr -update -f "ESRI Shapefile" -where(FEAT_CODE =sea) temp.shp
> temp2.shp 
>

Graham, 

I think you are getting somewhat close with the above.
Try something like:

 ogr2ogr temp2.shp temp.shp -where 'FEAT_CODE="sea"'

Somewhat perversely (in my opinion) the first filename
passed to ogr2ogr is the output file.   The second is the
input.  So I have switched things around.  Next, your 
argument to -where needs to be a seperate string (that
is you need a space after -where).  There are also 
some quoting issues that may vary by shell.  I believe
you can do as I have with single quotes around the 
whole comparison, and double quotes around the
string you are comparing to, but that might not do it
on win32. 

Lastly, there is currently no way to update a shapefile
in place by deleting features using OGR.  So you 
are stuck writing your subset to a new output file. 

Only a few OGR drivers (I think only some of the RDBMS
based formats) support deleting features.   And to use
it you would have to do the operation with something 
other than ogr2ogr.  

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mbrudka at aster.pl  Wed Jan 12 16:36:03 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
In-Reply-To: <931f8ea905011213114cd9303c@mail.gmail.com>
References: <41DEEC2C.6070009@aster.pl> <41E58F26.7070508@aster.pl>
	<931f8ea905011213114cd9303c@mail.gmail.com>
Message-ID: <41E59843.4010909@aster.pl>

Hi Frank,

>Yes, it would be better reported via bugzilla.  The
>problem with bug reports on the list is that if I don't
>hop on them immediately they are easily forgotten
>forever.
>  
>
Ok. I'll use bugzilla.

>In any event, I am aware there are dangers with the
>current references count for spatial references and
>OGRFeatureDefns, but I am not likely to make any
>immediate changes.  The obvious changes are likely
>to cause other bugs in code written to the current
>behaviour.
>
But for any serious application it is better to crash it than to allow 
to leak silently. This speeds up the developement.
I can try to remove this bug and send you a patches, but unfortunatelly 
there are no regression tests in GDAL
to verify if I did not destabilized other parts of GDAL :-(
Hmm, it seems GDAL needs some regression or unit tests..

>  But having a bug report on the issue in
>Bugzilla would be helpful to track the problem.  Also,
>if you have run into this problem in "real world"
>situations, it is helpful to outline that.
>  
>
This  bug manifests in "real world" application.

Thanks
Marek Brudka


From pierocavalieri at tiscali.it  Wed Jan 12 19:03:40 2005
From: pierocavalieri at tiscali.it (Piero Cavalieri)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Compilation problem with 1.2.5
In-Reply-To: <931f8ea905011119085d630fb9@mail.gmail.com>
References: <41E46635.2020702@tiscali.it>
	<931f8ea905011119085d630fb9@mail.gmail.com>
Message-ID: <41E5BADC.3030900@tiscali.it>

Frank Warmerdam wrote:

>On Wed, 12 Jan 2005 00:50:13 +0100, Piero Cavalieri
><pierocavalieri@tiscali.it> wrote:
>  
>
>>Hi all,
>>
>>I still have a compilation problem with version 1.2.5
>>Error messages are about headers not found.
>>This is due because when I run ./configure the
>>file GDALmake.opt is created, but it's empty.
>>This also happens with 1.2.4 version, but not with
>>1.2.3 and previous versions.
>>Could someone give me some suggestion on what looking for
>>to solve this problem?
>>    
>>
>
>Piero,
>
>This sounds very much like the MySQL 3.x problem.
>Just configure with --without-mysql to work around this.
>
>This problem is fixed in CVS.
>
>Best regards,
>  
>

Ok, configuring with
--without-mysql
solved the problem.

Thanks
       Piero

From fwarmerdam at gmail.com  Wed Jan 12 23:24:03 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Memory leak related with reference counting
In-Reply-To: <41E59843.4010909@aster.pl>
References: <41DEEC2C.6070009@aster.pl> <41E58F26.7070508@aster.pl>
	<931f8ea905011213114cd9303c@mail.gmail.com>
	<41E59843.4010909@aster.pl>
Message-ID: <931f8ea905011220247079dfd5@mail.gmail.com>

On Wed, 12 Jan 2005 22:36:03 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
>
> But for any serious application it is better to crash it than to allow
> to leak silently. This speeds up the developement.
> I can try to remove this bug and send you a patches, but unfortunatelly
> there are no regression tests in GDAL
> to verify if I did not destabilized other parts of GDAL :-(
> Hmm, it seems GDAL needs some regression or unit tests..

Marek,

There are substantial regression tests but they are
miles from being comprehensive.   I agree that
crashing would be fine if I could be comfortable that
i could trigger all crash situations and correct them
before the next release but due to the non-comprehensiveness of the
test suites this is
impossible to ensure. 

The test suites can be checked out from the same
repository as gdal with the name "gdalautotest". 

There is a run_all.py script in the extracted directly that
will run the full suite.  You will need to have Python
bindings for GDAL build and properly installed for this
to work. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Thu Jan 13 00:20:04 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] NAD83 Fipszone 903 to WGS84 Error
In-Reply-To: <loom.20050104T172647-53@post.gmane.org>
References: <loom.20050104T172647-53@post.gmane.org>
Message-ID: <931f8ea9050112212070ba1b82@mail.gmail.com>

On Tue, 4 Jan 2005 16:30:16 +0000 (UTC), Eric Lindahl <eric@21csi.com> wrote:
> 
> Hi,
> 
> I attempted to fix the PRJ.ADF import that didn't recognize the FIPSZONE
> key word.

Eric,

OK, i have applied a variation on your FIPSZONE
support, and also corrected the problem you encountered
with NAD83 state plane zones with feet units.   The
changes are in CVS.   If it is convenient for you, i would
appreciate it if you could grab the daily snapshot tomorrow
and try out gdalinfo on your dataset to verify the corners
are right in lat/long now.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From James.Goodwin at sea.co.uk  Fri Jan 14 10:11:19 2005
From: James.Goodwin at sea.co.uk (James Goodwin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
Message-ID: <s1e7e162.099@mail.sea.co.uk>

I've downloaded the GDAL library and been successfully built it and loaded an S-57 file.  I've also downloaded the OpenEV code for displaying S-57 files.

However, I'd like to use GDAL, OpenGL and the MFC libraries (not GTK) to do my coding!

Has anyone taken this path already?  If so, is the any free code available?

James


________________________________________________________________________
This email, and any attachment, may contain information that is confidential and/or subject to copyright. The recipient of any email from SEA shall not forward any message or attachment to any third party without prior consent from SEA. Although SEA uses all reasonable endeavours to prevent the transmission of known viruses, SEA shall accept no liability for any damage to systems or loss of or corruption of data caused by any virus inadvertently transmitted. SEA reserves the right to monitor all incoming and outgoing email for any lawful purpose; this is clearly stated in the SEA policy - The Use of Computer and Telephony Equipment By Staff. The contents of this email do not give rise to any binding legal obligation upon SEA unless a separate confirmation is sent on headed stationery, either in hardcopy or by email, as an attachment. If an email is to create a binding obligation on SEA, through the use of an attachment, then this shall be clearly stated in the body text. Anyone dealing with SEA by email who objects to any of these terms should refer their concerns to the Business Systems Manager through the contact listed above.

From MChapman at sanz.com  Sat Jan 15 19:32:32 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C30@mailman>

James,
 
I've done a lot of exactly that.  Here are some things I've learned.  There are also code snippets below.
 
1.  Only use OpenGL if you want to render 3D data like elevation data (DEM, DTED, ...) in 3D meshes.  OpenGL is awesome for 3D but slow (comparably) if you only have X,Y (2D).  It's good for cross-platform rendering, but if you're using MFC you should go with the latest native graphics device (GDI+).  In my applications I use the MDI application framework and have different Documents/Views for 2D, 3D, and raw images (rasters).  
 
2.  To display vector maps with projected imagery (rasters that are scaled with the vectors in the same view) use GDI+.  This is hands down the best and fastest way to draw vectors (lat/lon) on Windows.  The old style GDI only uses integers for coordinates so you can't easily display lat/lon values.  OpenGL has to do a bunch of extra math when handling shapes other than triangles because the shape could be non-coplanar if it has more than 3 coords.  Also, OpenGL has an archaic interface for working with the graphics pipeline.  GDI+ on the other hand is almost identical to the Java2D library and is a totally awesome API that was extremely well thought out and is very sophistocated, and it's OO where OpenGL API is not.  We even use Java2D to render from OGR at work and it's very fast.  Not as fast as GDI+ though.  
 
3.  To display "raw" rasters (projected or unprojected), use the old style GDI and Device Context functions like BitBlt and StretchBlt or GDI+.  Nothing matches the speed of the old GDI funtions for rasters though.  GDI+ also handles raw rasters extremely well.  In fact, from an API perspective, it is far superior for rasters than GDI, but GDI is just fast.  You can use OpenGL for rasters as well, but I think their raster support is weak, unless you want to texture map an image to a 3D mesh, then it rocks.  
 
4.  No matter what graphics library you use, your code will be slow if you don't carefully think about how you load and draw your data.  Whether it's raster or vector data, you should always, load only enough data to fill your view.  
    a. Loading the whole file works great for small files, but will bring your app (and any computer) to it's knees when you start loading big files, or lots of small files.  
    b. Do not, cache geometries or pixel data unless you give your users an option to cache at will, because you will quickly consume all the users available memory.  Instead, each time your app pans or zooms, load the data again from the file, using a rectangle or quad index for vectors and an x,y,width,height offset for rasters.  
    c. Limit the number of times you loop through the features with OGR to one time per onpaint event.  That means, don't use the GetWKB functions.  Frank has to loop through the points and build the WKB first, then you will have to loop through the points again to draw them.  If you elimanate that loop then you will be twice as fast.
    d.  Don't store points.  That means, get them from OGR, stick it into a GDI+ point object array, draw it, and then get rid of it.  
    e. AND THE MOST IMPORTANT RULE OF RENDERING IS....limit the number of times you draw the points to the screen.  I see a lot of code where the developer is drawing every point to the screen as they loop through the features.  Drawing to a screen moves millions of bits around and is very very expensive and humans can only process a screen update visually something like 30 screen refreshes a second, so drawing between those intervals is useless for any lifeform that I know of that usues a computer.  You should do something like time based rendering or once per feature.  You should accumulate points using the GDI+ PointF class in a PointF[] and then draw them periodically and then delete them.  MFC has a nice handy function called GetTickCount() that will help you track time in milli-seconds to do this.  It also gives you a very snooth rendering appearance.  
 
The bottom line is that different graphics libraries are better suited for different jobs on different hardware.  So before you pick one, really think about wht you want to do, and then be smart about NOT trying to make one document/view to handle all situations.  
 
I have tons of code using different graphics libraries so you will have to ask me for specific examples if you want them.  Listed below is a code snippet for using GDI+ and vectors using OGR.  It uses some of my own classes to store feature style info and cached graphics for when a user wants to cache and un-cache layers.  It also, uses a second GDI+ Graphics object to draw to a CachedBitmap for double buffering.  Really, double-buffering doesn't work well for vectors because it can take a while to draw really large vector files (hundreds of megabytes and features), but is very useful for smooth panning.  The code below draws points to the screen first to satisfy the use, and then loops again to paint to an offscreen bitmap for smooth/quick panning.  If you want to double the speed of loading, then remove the pMemGraphics and m_spMemGraphics object from the functions.  Although, this will not change the visual appearance because I already draw first, but it will finish the over-all loading faster beacuse you are drawing half as much.  
 
The interesting functions below are OnPaint() and DrawVectorLayer().
 
Have fun!
Martin Chapman
void CMapView::OnPaint()

{

try

{

CPaintDC dc(this);

CRect clientRect;

GetClientRect(&clientRect);

Graphics graphics(dc.m_hDC);

CMainFrame* pMainFrame = (CMainFrame*) AfxGetMainWnd();

NAVIGATIONMODE eNavigationMode = pMainFrame->GetMapNavigationMode();

CVPPtr< IVPMap> spMap = GetMap();

CVPPtr< IVPEnvelope> spBBox = spMap->GetBoundingBox();

m_nScaleX = (REAL) (spMap->GetSRSWidth() / spBBox->GetWidth()); 

m_nScaleY = (REAL) (spMap->GetSRSHeight() / spBBox->GetHeight()); 

REAL nClientXFactor = (REAL) (spMap->GetSRSWidth() / clientRect.Width()); 

REAL nClientYFactor = (REAL) (spMap->GetSRSHeight() / clientRect.Height()); 

REAL nClientScaleFactor = nClientXFactor > nClientYFactor ? nClientXFactor : nClientYFactor;

m_nScaleX /= nClientScaleFactor;

m_nScaleY /= nClientScaleFactor;

m_nTranslationX = (REAL) (spBBox->GetMinX() + (spBBox->GetWidth() / 2));

m_nTranslationY = (REAL) (spBBox->GetMinY() + (spBBox->GetHeight() / 2));

m_nViewportOriginX = (REAL) (((clientRect.Width() / 2) / m_nScaleX));

m_nViewportOriginY = (REAL) (((clientRect.Height() / 2) / m_nScaleY));

graphics.SetSmoothingMode(SmoothingModeHighSpeed);

graphics.SetCompositingQuality(CompositingQualityHighSpeed);

if (m_bZooming && (eNavigationMode == NAVIGATION_MODE_PANMOVE))

{

SolidBrush solidBrush(Color(255, 255, 255, 255));

RectF clearRect((REAL) clientRect.left, (REAL) clientRect.top, 

(REAL) clientRect.Width(), (REAL) clientRect.Height());

RectF excludeRect((REAL)-m_nStrokeOffSetX, (REAL) m_nStrokeOffSetY, 

(REAL)clientRect.Width(), (REAL) clientRect.Height());

Region clearRegion(clearRect);

clearRegion.Exclude(excludeRect);

graphics.FillRegion(&solidBrush, &clearRegion);

graphics.TranslateTransform(-m_nStrokeOffSetX, m_nStrokeOffSetY);

}

if (!m_pMemBitmap)

CreateOffScreenGraphics(clientRect.Width(), clientRect.Height(), &graphics);

if (((eNavigationMode != NAVIGATION_MODE_ZOOMIN_BAND) &&

(eNavigationMode != NAVIGATION_MODE_ZOOMOUT_BAND)) || !m_bZooming)

{

graphics.DrawCachedBitmap(m_pCachedBitmap, 0, 0);

}

}

catch(exception e) 

{AfxMessageBox(e.what());}

catch(char* e) 

{AfxMessageBox(e);}

catch(...) 

{AfxMessageBox("An unexpected error occurred in CMapView::OnPaint().");}

}

void CMapView::CreateOffScreenGraphics(int nWidth, int nHeight, Graphics* pGraphics)

{

try

{

#ifdef _DEBUG

#undef new

m_pMemBitmap = new Bitmap(nWidth, nHeight, pGraphics);

#define new DEBUG_NEW

#else

m_pMemBitmap = new Bitmap(nWidth, nHeight, pGraphics);

#endif

CVPPtr< IVPMap> spMap = GetMap();

m_pMemGraphics = Graphics::FromImage(m_pMemBitmap);

m_pMemGraphics->TranslateTransform(m_nViewportOriginX - (m_nTranslationX), m_nViewportOriginY + (m_nTranslationY));

m_pMemGraphics->ScaleTransform(m_nScaleX, m_nScaleY, MatrixOrderAppend);

m_pMemGraphics->Clear(Color(255, 255, 255, 255));

DrawMap(pGraphics, m_pMemGraphics, spMap);

#ifdef _DEBUG

#undef new

m_pCachedBitmap = new CachedBitmap(m_pMemBitmap, pGraphics);

#define new DEBUG_NEW

#else

m_pCachedBitmap = new CachedBitmap(m_pMemBitmap, pGraphics);

#endif

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::CreateOffScreenGraphics().";}

}

void CMapView::DrawMap(Graphics* pGraphics, Graphics* pMemGraphics, IVPMap* pMap) 

{

try

{

if (!pMap) return;

CVPPtr< IVPMap> spMap = pMap;

double nScale = spMap->GetScale();

pGraphics->TranslateTransform(m_nViewportOriginX - (m_nTranslationX), m_nViewportOriginY + (m_nTranslationY));

pGraphics->ScaleTransform(m_nScaleX, m_nScaleY, MatrixOrderAppend);

for (int j = spMap->GetLayerCount() - 1; j >= 0; j--)

{

CVPPtr< IVPLayer> spLayer = spMap->GetLayerAt(j);

if (spLayer->IsVisible())

{

if (((nScale >= spLayer->GetMinScale()) && 

(nScale < spLayer->GetMaxScale())) ||

spLayer->IsShowAllScales())

{

DrawLayer(pGraphics, pMemGraphics, spLayer);

}

}

pGraphics->TranslateTransform(m_nViewportOriginX + (m_nTranslationX), m_nViewportOriginY - (m_nTranslationY));

pGraphics->ScaleTransform(-m_nScaleX, -m_nScaleY, MatrixOrderAppend);

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawMap().";}

}

void CMapView::DrawLayer(Graphics* pGraphics, Graphics* pMemGraphics, IVPLayer* pLayer) 

{

try

{

if (dynamic_cast< IVPLayerCollection*>(pLayer))

{

list< IVPLayer*>::iterator it;

list< IVPLayer*>* pList = ((IVPLayerCollection*)pLayer)->GetLayers();

for (it = pList->begin(); it != pList->end(); it++)

DrawLayer(pGraphics, pMemGraphics, *it);

}

else if (dynamic_cast< IVPLayer*>(pLayer))

{

if (dynamic_cast< IVPVectorLayer*> (pLayer))

{

DrawVectorLayer(pGraphics, pMemGraphics, (IVPVectorLayer*) pLayer);

}

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawLayer().";}

}

void CMapView::DrawVectorLayer(Graphics* pGraphics, 

Graphics* pMemGraphics, 

IVPVectorLayer* pVectorLayer)

{

try

{

CVPPtr< IVPVectorLayer> spVectorLayer = pVectorLayer;

CVPPtr< IVPFeatureStyle> spFeatureStyle = spVectorLayer->GetFeatureStyle();

CVPPtr< IVPGraphicCollection> spGraphicCollection = pVectorLayer->GetGraphicCollection();

bool bIsCached = spVectorLayer->IsCached();

if (bIsCached && spGraphicCollection.p)

{

IVPGraphic* pGraphic = NULL;

GraphicsPath* pPath = NULL;

list< IVPGraphic*>::reverse_iterator it;

list< IVPGraphic*>* pGraphicList = spGraphicCollection->GetGraphics();

Pen* pPen = spGraphicCollection->GetPen();

if (pPen) pPen->SetWidth(spFeatureStyle->GetLineSize() / ((m_nScaleX + m_nScaleY) / 2.0f));

Brush* pBrush = spGraphicCollection->GetBrush();

for (it = pGraphicList->rbegin(); it != pGraphicList->rend(); it++)

{

pGraphic = (IVPGraphic*) *it;

pPath = (GraphicsPath*) pGraphic->GetPath();

if (pPath) 

{

if (pBrush) pMemGraphics->FillPath(pBrush, pPath);

if (pPen) pMemGraphics->DrawPath(pPen, pPath);

}

}

if (spVectorLayer->IsShowLabels())

DrawLabels(pGraphics, pMemGraphics, pLayer);

return;

}

int i = 0, j = 0, n = 0;

int nNumPoints = 0;

int nNumRings = 0;

int nNumGeometries = 0;

GraphicsPath* pPath = NULL;

OGRGeometry* pOgrGeometry = NULL;

OGRPoint* pPoint = NULL;

OGRLineString* pLineString = NULL;

OGRLinearRing* pLinearRing = NULL;

OGRMultiPoint* pMultiPoint = NULL;

OGRPolygon* pPolygon = NULL;

OGRMultiPolygon* pMultiPolygon = NULL;

OGRMultiLineString* pMultiLineString = NULL;

CVPPtr< IVPVectorSet> spVectorSet = (IVPVectorSet*) spVectorLayer->GetResultSet();

CVPPtr< IVPVectorGraphic> spVectorGraphic;

if (bIsCached)

spGraphicCollection = new CVPGraphicCollection();

int r = 0, g = 0, b = 0, a = 255;

float nLineSize = spFeatureStyle->GetLineSize();

float nPointSize = nLineSize / m_nScaleY * 4;

USES_CONVERSION;

WCHAR* sFontFace = T2W(spFeatureStyle->GetFontFace().c_str());

float nFontSize = spFeatureStyle->GetFontSize();

Font font(sFontFace, nFontSize);

RectF pointRect(0.0f, 0.0f, nPointSize, nPointSize);

PointF* pPoints = NULL;

r = spFeatureStyle->GetLineColor()->GetRed();

g = spFeatureStyle->GetLineColor()->GetGreen();

b = spFeatureStyle->GetLineColor()->GetBlue();

a = spFeatureStyle->GetLineColor()->GetAlpha();

Pen pen(Color(a, r, g, b), nLineSize / ((m_nScaleX + m_nScaleY) / 2.0f));

r = spFeatureStyle->GetFillColor()->GetRed();

g = spFeatureStyle->GetFillColor()->GetGreen();

b = spFeatureStyle->GetFillColor()->GetBlue();

a = spFeatureStyle->GetFillColor()->GetAlpha();

SolidBrush fillBrush(Color(a, r, g, b));

r = spFeatureStyle->GetFontColor()->GetRed();

g = spFeatureStyle->GetFontColor()->GetGreen();

b = spFeatureStyle->GetFontColor()->GetBlue();

a = spFeatureStyle->GetFontColor()->GetAlpha();

SolidBrush fontBrush(Color(a, r, g, b));

CRect clientRect;

GetClientRect(&clientRect);

if (bIsCached)

spVectorSet->SetSpatialFilter(NULL);

else

{

CVPPtr< IVPEnvelope> spBoundingBox = GetMap()->GetBoundingBox();

CVPPtr< IVPPoint> spPoint;

spPoint.Attach(spBoundingBox->GetCentroid());

double nMinX = spPoint->GetX() - (clientRect.Width() / 2) / m_nScaleX;

double nMaxY = spPoint->GetY() + (clientRect.Height() / 2) / m_nScaleY;

double nMaxX = spPoint->GetX() + (clientRect.Width() / 2) / m_nScaleX;

double nMinY = spPoint->GetY() - (clientRect.Height() / 2) / m_nScaleY;

CVPPtr< IVPEnvelope> spEnvelope = new CVPEnvelope(nMinX, nMinY, nMaxX, nMaxY);

spVectorSet->SetSpatialFilter(spEnvelope.Detach());

}

OGRLayer* pOgrLayer = (OGRLayer*) spVectorSet->GetLayerRef();

OGRwkbGeometryType eGeomType = wkbUnknown;

OGRFeature* pOgrFeature = pOgrLayer->GetNextFeature();

pGraphics->Clear(Color(255, 255, 255, 255));

while (pOgrFeature)

{

#ifdef _DEBUG

#undef new

pPath = new GraphicsPath();

#define new DEBUG_NEW

#else

pPath = new GraphicsPath();

#endif

pOgrGeometry = (OGRGeometry*) pOgrFeature->GetGeometryRef();

eGeomType = pOgrGeometry->getGeometryType();

if (eGeomType == wkbPoint)

{

pPoint = (OGRPoint*) pOgrGeometry;

if (nLineSize > 0)

{

pointRect.X = (REAL) pPoint->getX();

pointRect.Y = (REAL) -pPoint->getY();

pPath->AddRectangle(pointRect);

}

}

else if (eGeomType == wkbLineString)

{

pLineString = (OGRLineString*) pOgrGeometry;

nNumPoints = pLineString->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLineString->getX(n), (REAL) -pLineString->getY(n));

pPath->AddLines(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

else if (eGeomType == wkbPolygon) 

{

nNumRings = ((OGRPolygon*) pOgrGeometry)->getNumInteriorRings() + 1;

for (i = 0; i < nNumRings; i++)

{

if (i == 0)

pLinearRing = ((OGRPolygon*) pOgrGeometry)->getExteriorRing();

else

pLinearRing = ((OGRPolygon*) pOgrGeometry)->getInteriorRing(i - 1);

nNumPoints = pLinearRing->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

if (i == 0)

{

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

else

{

for (n = nNumPoints - 1; n >= 0; n--) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

pPath->CloseFigure();

pPath->AddPolygon(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

else if (eGeomType == wkbMultiPoint)

{

pMultiPoint = (OGRMultiPoint*) pOgrGeometry;

nNumGeometries = pMultiPoint->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pPoint = (OGRPoint*) pMultiPoint->getGeometryRef(i);

if (nLineSize > 0)

{

pointRect.X = (REAL) pPoint->getX();

pointRect.Y = (REAL) -pPoint->getY();

pPath->AddRectangle(pointRect);

}

}

}

else if (eGeomType == wkbMultiLineString)

{

pMultiLineString = (OGRMultiLineString*) pOgrGeometry;

nNumGeometries = pMultiLineString->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pLineString = (OGRLineString*) pMultiLineString->getGeometryRef(i);

nNumPoints = pLineString->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLineString->getX(n), (REAL) -pLineString->getY(n));

pPath->AddLines(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

else if (eGeomType == wkbMultiPolygon)

{

pMultiPolygon = (OGRMultiPolygon*) pOgrGeometry;

nNumGeometries = pMultiPolygon->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pPolygon = (OGRPolygon*) pMultiPolygon->getGeometryRef(i);

nNumRings = ((OGRPolygon*) pPolygon)->getNumInteriorRings() + 1;

for (j = 0; j < nNumRings; j++)

{

if (j == 0)

pLinearRing = pPolygon->getExteriorRing();

else

pLinearRing = pPolygon->getInteriorRing(j - 1);

nNumPoints = pLinearRing->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

if (i == 0)

{

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

else

{

for (n = nNumPoints - 1; n >= 0; n--) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

pPath->CloseFigure();

pPath->AddPolygon(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

}

if (eGeomType != wkbLineString && eGeomType != wkbMultiLineString)

{

pGraphics->FillPath(&fillBrush, pPath);

pGraphics->Flush();

}

pGraphics->DrawPath(&pen, pPath);

pGraphics->Flush();

if (bIsCached)

{

spVectorGraphic = new CVPVectorGraphic();

spVectorGraphic->SetPath((void*) pPath);

spGraphicCollection->Add(spVectorGraphic.Detach());

}

else

delete pPath;

delete pOgrFeature;

pOgrFeature = pOgrLayer->GetNextFeature();

}

pOgrLayer->ResetReading();

IVPGraphic* pGraphic = NULL;

GraphicsPath* pCurrentPath = NULL;

list< IVPGraphic*>::reverse_iterator it;

list< IVPGraphic*>* pGraphicList = spGraphicCollection->GetGraphics();

for (it = pGraphicList->rbegin(); it != pGraphicList->rend(); it++)

{

pGraphic = (IVPGraphic*) *it;

pCurrentPath = (GraphicsPath*) pGraphic->GetPath();

if (pPath) 

{

pMemGraphics->FillPath(&fillBrush, pPath);

pMemGraphics->DrawPath(&pen, pPath);

}

}

if (bIsCached)

{

spGraphicCollection->SetPen(pen.Clone());

spGraphicCollection->SetBrush(fillBrush.Clone());

spGraphicCollection->SetFont(font.Clone());

spGraphicCollection->SetFontBrush(fontBrush.Clone());

spVectorLayer->SetGraphicCollection(spGraphicCollection.Detach());

}

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawVectorLayer().";}

}

 
 
 
 
 
-----Original Message----- 
From: James Goodwin [mailto:James.Goodwin@sea.co.uk] 
Sent: Fri 1/14/2005 8:11 AM 
To: gdal-dev@xserve.flids.com 
Cc: 
Subject: [Gdal-dev] GDAL & OpenEV / MFC



	I've downloaded the GDAL library and been successfully built it and loaded an S-57 file.  I've also downloaded the OpenEV code for displaying S-57 files.
	
	However, I'd like to use GDAL, OpenGL and the MFC libraries (not GTK) to do my coding!
	
	Has anyone taken this path already?  If so, is the any free code available?
	
	James
	
	
	________________________________________________________________________
	This email, and any attachment, may contain information that is confidential and/or subject to copyright. The recipient of any email from SEA shall not forward any message or attachment to any third party without prior consent from SEA. Although SEA uses all reasonable endeavours to prevent the transmission of known viruses, SEA shall accept no liability for any damage to systems or loss of or corruption of data caused by any virus inadvertently transmitted. SEA reserves the right to monitor all incoming and outgoing email for any lawful purpose; this is clearly stated in the SEA policy - The Use of Computer and Telephony Equipment By Staff. The contents of this email do not give rise to any binding legal obligation upon SEA unless a separate confirmation is sent on headed stationery, either in hardcopy or by email, as an attachment. If an email is to create a binding obligation on SEA, through the use of an attachment, then this shall be clearly stated in the body text. Anyone dealing with SEA by email who objects to any of these terms should refer their concerns to the Business Systems Manager through the contact listed above.
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

From pierocavalieri at tiscali.it  Sat Jan 15 22:35:35 2005
From: pierocavalieri at tiscali.it (Piero Cavalieri)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] ecw support under linux
Message-ID: <41E9E107.1080805@tiscali.it>

In ERMapper site, I didn't find linux packages.
Is there a way to have .ecw support via gdal, under linux ?

Thanks in advance
       Piero

From fwarmerdam at gmail.com  Sat Jan 15 22:00:31 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] ecw support under linux
In-Reply-To: <41E9E107.1080805@tiscali.it>
References: <41E9E107.1080805@tiscali.it>
Message-ID: <931f8ea905011519005b94e218@mail.gmail.com>

On Sun, 16 Jan 2005 04:35:35 +0100, Piero Cavalieri
<pierocavalieri@tiscali.it> wrote:
> In ERMapper site, I didn't find linux packages.
> Is there a way to have .ecw support via gdal, under linux ?

Piero, 

It is not possible to get ECW support on linux at this time; however, my
undestanding is that a source release of the ECW SDK is coming out 
soon and when that happens we should have little trouble porting it to 
Linux and using it with GDAL.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From MChapman at sanz.com  Sat Jan 15 22:30:31 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] ecw support under linux
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C31@mailman>

I called ERMapper about this issue in August and they said it's now available on their download site.  They said their technology is built on Linux and then ported to Windows for release, but it's not supported on Linux...go figure that one.  Anyway, I never verified if this was true so you would have to download it and try it out.  If you get it done let me know. 
 
Thanks,
Martin

	-----Original Message----- 
	From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
	Sent: Sat 1/15/2005 8:00 PM 
	To: Piero Cavalieri 
	Cc: gdal list 
	Subject: Re: [Gdal-dev] ecw support under linux
	
	

	On Sun, 16 Jan 2005 04:35:35 +0100, Piero Cavalieri
	<pierocavalieri@tiscali.it> wrote:
	> In ERMapper site, I didn't find linux packages.
	> Is there a way to have .ecw support via gdal, under linux ?
	
	Piero,
	
	It is not possible to get ECW support on linux at this time; however, my
	undestanding is that a source release of the ECW SDK is coming out
	soon and when that happens we should have little trouble porting it to
	Linux and using it with GDAL.
	
	Best regards,
	--
	---------------------------------------+--------------------------------------
	I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
	light and sound - activate the windows | http://pobox.com/~warmerdam
	and watch the world go round - Rush    | Geospatial Programmer for Rent
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

From jvarga at boulder.net  Sat Jan 15 22:47:44 2005
From: jvarga at boulder.net (Jack Varga)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] ecw support under linux
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63C31@mailman>
References: <ED3A48B9840E594890A2BC172D119465E63C31@mailman>
Message-ID: <41E9E3E0.6070909@boulder.net>

Martin, et al,

I just checked and its still not listed 
(http://www.ermapper.com/downloads/default.aspx#16).  I was told I would 
be notified when it was ready.  Their most recent press release on the 
subject says December 2004 but I know how that goes.  It's interesting 
you say they develop on linux and then port.  Same as PCRaster, and 
that's not available from a link on their site either (I had to ask for 
it).

-jv

Chapman, Martin wrote:
> I called ERMapper about this issue in August and they said it's now available on their download site.  They said their technology is built on Linux and then ported to Windows for release, but it's not supported on Linux...go figure that one.  Anyway, I never verified if this was true so you would have to download it and try it out.  If you get it done let me know. 
>  
> Thanks,
> Martin
> 
> 	-----Original Message----- 
> 	From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
> 	Sent: Sat 1/15/2005 8:00 PM 
> 	To: Piero Cavalieri 
> 	Cc: gdal list 
> 	Subject: Re: [Gdal-dev] ecw support under linux
> 	
> 	
> 
> 	On Sun, 16 Jan 2005 04:35:35 +0100, Piero Cavalieri
> 	<pierocavalieri@tiscali.it> wrote:
> 	> In ERMapper site, I didn't find linux packages.
> 	> Is there a way to have .ecw support via gdal, under linux ?
> 	
> 	Piero,
> 	
> 	It is not possible to get ECW support on linux at this time; however, my
> 	undestanding is that a source release of the ECW SDK is coming out
> 	soon and when that happens we should have little trouble porting it to
> 	Linux and using it with GDAL.
> 	
> 	Best regards,
> 	--
> 	---------------------------------------+--------------------------------------
> 	I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
> 	light and sound - activate the windows | http://pobox.com/~warmerdam
> 	and watch the world go round - Rush    | Geospatial Programmer for Rent
> 	_______________________________________________
> 	Gdal-dev mailing list
> 	Gdal-dev@xserve.flids.com
> 	http://xserve.flids.com/mailman/listinfo/gdal-dev
> 	
> 
> 
> 
> ------------------------------------------------------------------------
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev

From mbrudka at aster.pl  Sun Jan 16 19:43:33 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63C35@mailman>
References: <ED3A48B9840E594890A2BC172D119465E63C35@mailman>
Message-ID: <41EB0A35.1040406@aster.pl>

Hi,
    I just ensured that Qt under Windows uses GDI. Hence, our comparison 
between  *HARDWARE* OpenGL and QtPainter which uses GDI
tell us something about GDI. I do not expect then, that *HARDWARE* 
OpenlGL superiority can be explained by Qt interface overhead.
But who knows, software is weird ...

Marek Brudka


From wlyons at prologic-inc.com  Mon Jan 17 14:50:48 2005
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDALAllRegister question.
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DEC8175@vader.prologic-inc.com>

Frank and List,

Is there any harm in calling GDALAllRegister() repeatedly?

Thanks,

William Lyons



From MChapman at sanz.com  Sun Jan 16 13:11:42 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C35@mailman>

Drawing speed is relative to hardware resources and other things you may have going on in your code while you draw.  So, there is no single answer to how much can GDI+ draw per second.  What you could say is that given the same environment and variables, GDI+ will out perform OpenGL for 2D rendering on Windows.  Also, note that humans can only process graphics refresh rates of about 30 times per second, so drawing to the screen more times than that is useless.  Where OpenGL really suffers though, is filling shapes.  It has to tessellate each complex polygon before it can fill it and the gluTessellation functions are very slow.
 
Martin 
 
 
 
 
-----Original Message----- 
From: Marek Brudka [mailto:mbrudka@aster.pl] 
Sent: Sun 1/16/2005 3:42 AM 
To: Chapman, Martin 
Cc: James Goodwin; gdal-dev@xserve.flids.com 
Subject: Re: [Gdal-dev] GDAL & OpenEV / MFC



	Hi Chapman,
	U?ytkownik Chapman, Martin napisa?:
	
	>1.  Only use OpenGL if you want to render 3D data like elevation data (DEM, DTED, ...) in 3D meshes.  OpenGL is awesome for 3D but slow (comparably) if you only have X,Y (2D).  It's good for cross-platform rendering, but if you're using MFC you should go with the latest native graphics device (GDI+).  In my applications I use the MDI application framework and have different Documents/Views for 2D, 3D, and raw images (rasters). 
	>
	Interesting. Could tell me, please how many random 1pt lines with random
	colors  can you draw per second using GDI+ interface?
	
	Thanks
	Marek
	

From mbrudka at aster.pl  Sun Jan 16 05:42:26 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63C30@mailman>
References: <ED3A48B9840E594890A2BC172D119465E63C30@mailman>
Message-ID: <41EA4512.8080701@aster.pl>

Hi Chapman,
U?ytkownik Chapman, Martin napisa?:

>1.  Only use OpenGL if you want to render 3D data like elevation data (DEM, DTED, ...) in 3D meshes.  OpenGL is awesome for 3D but slow (comparably) if you only have X,Y (2D).  It's good for cross-platform rendering, but if you're using MFC you should go with the latest native graphics device (GDI+).  In my applications I use the MDI application framework and have different Documents/Views for 2D, 3D, and raw images (rasters).  
>
Interesting. Could tell me, please how many random 1pt lines with random 
colors  can you draw per second using GDI+ interface?

Thanks
Marek

From mbrudka at aster.pl  Sun Jan 16 19:04:21 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
In-Reply-To: <ED3A48B9840E594890A2BC172D119465E63C35@mailman>
References: <ED3A48B9840E594890A2BC172D119465E63C35@mailman>
Message-ID: <41EB0105.70004@aster.pl>

Hi Matrin,

User Chapman, Martin wrote:

>Drawing speed is relative to hardware resources and other things you may have going on in your code while you draw.  So, there is no single answer to how much can GDI+ draw per second.  
>
Certainly! I was interested in exemplary results for examplary 
configuration to get an impression how fast GDI is. For rather cheap 
Geforces and not very fresh PCs one may render more 1MLines per second 
on 1280x1024 canvas. In general the number of triangles per second is a 
lower bound (often equal to :-) ) of the number of lines per second.

>What you could say is that given the same environment and variables, GDI+ will out perform OpenGL for 2D rendering on Windows.  Also, note that humans can only process graphics refresh rates of about 30 times per second, so drawing to the screen more times than that is useless.
>
I did not played with GDI (directly), hence I cannot compare it with 
OpenGL. This is why it's interesting for me :-).

However we made some tests using higher level libraries (Qt painter), 
which probably indirectly uses GDI (I'm not sure of that), and were very 
disappointed with the performance. In general, we found that  hardware 
accelarated OpenGL 2D vector rendering is at least 10 times faster than 
the using QtPainter functions. Certainly, the quality of graphic 
accelerator is important, but currently avalaible boards are usually 
optimized for 2D rendering.

If you compare **SOFTWARE** OpenGL with GDI, then your results are 
probably true. However, if the results are for hardware accelarated 
OpenGL and GDI, then they are at least curious, because OpenGL can 
render graphic directly on hardware, not via GDI. I think, that one 
should expect hardware accelarated OpenGL to be not worse than GDI, 
because if GDI uses hardware acceleration (does it?), then sooner or 
later does exactly the same what OpenGL, namely tells the accelarator to 
render something. It is hard to render something faster in software than 
in hardware, hence I doubt this result. Please also notice how graphics 
is managed in Windows Longhorn..

However very it is crucial how OpenGL is employed, because bad 
application of OpenGL usually results in poor performance.

>  Where OpenGL really suffers though, is filling shapes.  It has to tessellate each complex polygon before it can fill it and the gluTessellation functions are very slow.
>
OpenGL is as fast in filling triangles as possible and I doubt if GDI 
can do it faster. Tessellation is not an OpenGL function but it is 
provided by OpenGL Utility library. These two are distinct libraries!

Tessalation is usually done in software, not in hardware, hence one 
cannot expect it to be extremly fast. In fact, the tessallation is 
relatively slow, but excessive tessalation means, that software 
architecture is probably bad. One should almost always avoid 
tessalation. The best way to use it is to render an object once into 
glLists, then use this lists  as long as possible. Moreover, it is also 
important what is tessallated. The performance is seriously impacted if 
the shape tessallated is not convex and if it has inner rings. For a 
plain convex, solid shapes the tessalation is really fast, because the 
algorithm is very simple. In fact, for a plain convex polygons 
tessallation is not necessary, OpenGL can most of the work in hardware.

Maps in GIS application are not usually rendered periodically but rather 
asynchronously eg. map scale is changed, map contents is translated, few 
features changed their position/shapes etc. For a translation or 
sometimes scale changes, OpenGL provides excellent support, because 
usually it is enough to change model or camera matrix and call glList to 
obtain nicely rendered result.

OpenGL has excellent support for rasters. Obviously one has to convert 
them into textures, in fact GDAL does it, but the results are then 
impressive then. With a quite good accuracy, one may  also employ 
hardware accellaration do what GDALWarp is responsible for, namely to 
reproject raster maps.

And the last, but not the least about OpenGL. This library is not for 
rendering 3D graphics only! In your previous post in many places you 
wrote that OpenGL is slow because
it renders in 3D. OpenGL HAS a bunch of 2D functions, though their 
functionalities depend on capabilities of hardware accellaration.

I do not agree partially with you opinion about caching. For a mass 
market software one cannot assume PC has a huge RAM, hence it should 
rather render in immidiate mode without caching. But for specialized 
markets, where hardware is more controlled one may force to use PC with 
at least 512MB RAM. Please also notice, that in next the few years the 
average PC will probably have >1 GB of RAM and GIS might consume 512 
MRAM without any serious impact on performance. Well.., 512 MB for GIS 
means, that the software is rather strange, because how detailed a map 
has to be to use such huge memory? For a comparision, a raw 1024x1024 
bitmap with 24bit color depth and 8bit alpha occupies only 4MB...

Why caching is so important? Because of what you say about the access to 
GIS data. Our consideration on speed of rendering are really not 
important when compared with the cost of access to GIS data. Here are 
real bottlenecks eg mass storage or RDBM access. One has to use spatial 
indeces and queries here, but usually it is not enough because RDBMS 
servers are always too slow, and network bandwidth is always too low. 
Caching can moderate such cost, but obviously requires some additional 
RAM :-).

Nevertheless, I really appreciate your post and agree with many thesis, 
in particular with that rendering is not as important as proper GIS data 
management :-)

Best regards
Marek Brudka


From fwarmerdam at gmail.com  Tue Jan 18 08:41:12 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Re: OGR Spatial Questions
In-Reply-To: <41ECB109.7040100@pixelmapper.com>
References: <41ECB109.7040100@pixelmapper.com>
Message-ID: <931f8ea9050118054115173445@mail.gmail.com>

On Mon, 17 Jan 2005 22:47:37 -0800, pvg <pvg@pixelmapper.com> wrote:
> Hi Frank,
> 
> I've been having some trouble trying to post to the gdal news group so
> I'm sending this email directly to you. Maybe it will post this time??

Peter,

remotesensing.org (where the gdal-dev mailing list is hosted) was
down for a couple days.  Things should be working now. 
 
> Works fine. Then I load a geotiff and try the following:
> 
>     char *pszProjection = GTIFGetOGISDefn(gtif, &defn );
>     // string looks like it should
> 
>     OGRSpatialReference oSRS;
>     OGRErr i = oSRS.SetProjection( pszProjection );

Here lies your problem.  The SetProjection() method is used to
set the projection method to be used, such as "Transverse_Mercator".
To import a complete WKT coordinate system definition you should
use the importFromWkt() method.  

eg. 

char *pszProjectionCopy = pszProjection;
OGRSpatialReference oSRS;

if( oSRS.importFromWkt( &pszProjectionCopy ) != OGRERR_NONE )
  return;

The setting up of a duplicate pointer to the WKT definition
is because importFromWkt() updates to pointer to point to the
next character past the imported definition.  The approach was
intended to let me process WKT out of a larger string, but in 
practice I have never used that ability and the method has been
clumsy to use (as above). 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From gdallaire at dmsolutions.ca  Tue Jan 18 09:06:50 2005
From: gdallaire at dmsolutions.ca (Guillaume Dallaire)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] problem with configure option for GeoTIFF
Message-ID: <1106057162.26099.11.camel@proudfoot>

Hi,

While compiling 1.2.5 on Linux I got :

./configure .... --with-geotiff=/my/path/to/geotiff ....
...
...
...
checking for XTIFFClientOpen in -lgeotiff... no
configure: error: We require at least GeoTIFF 1.2.1. Consider using the
one supplied with GDAL

But GeoTIFF 1.2.2 is correctly installed on my system.

I found in configure.in that the -L$with_geotiff/lib compile option was
missing, I added it :

AC_CHECK_LIB(geotiff,XTIFFClientOpen,GEOTIFF_SETTING=external,AC_MSG_ERROR([We require at least GeoTIFF 1.2.1. Consider using the one supplied with GDAL]),-L$with_geotiff/lib)

And it solved my problem.

-- 
------------------------------------------------------------
 Guillaume Dallaire              gdallaire@dmsolutions.ca
 DM Solutions Group              http://www.dmsolutions.ca/
------------------------------------------------------------


From grevedan at hotmail.com  Tue Jan 18 09:08:40 2005
From: grevedan at hotmail.com (Dan Greve)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] -of PNG broken in gdal-1.2.5?
Message-ID: <BAY102-F27EAB83F9A5B208D67E300C78F0@phx.gbl>

I'm getting alot of data corruption going to PNG data format in gdal-1.2.5.  
I'm using gdal-1.2.1 because it works, and because I can't get 2,3, or 4 to 
compile on my current windows PC.

I tried going from a NITF(RPF) in lat long to PNG and from GeoTiff in UTM 
zone 17 to PNG with similiar results.  I can provide my test results by 
email, and I will be submitting a bug report to bugzilla.  Can someone help 
duplicate my results before I submit a report?

-- Dan Greve
-- Software Engineer
-- Palm Bay, FL



From fwarmerdam at gmail.com  Tue Jan 18 09:29:02 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] -of PNG broken in gdal-1.2.5?
In-Reply-To: <BAY102-F27EAB83F9A5B208D67E300C78F0@phx.gbl>
References: <BAY102-F27EAB83F9A5B208D67E300C78F0@phx.gbl>
Message-ID: <931f8ea905011806297e015d6b@mail.gmail.com>

On Tue, 18 Jan 2005 09:08:40 -0500, Dan Greve <grevedan@hotmail.com> wrote:
> I'm getting alot of data corruption going to PNG data format in gdal-1.2.5.
> I'm using gdal-1.2.1 because it works, and because I can't get 2,3, or 4 to
> compile on my current windows PC.
> 
> I tried going from a NITF(RPF) in lat long to PNG and from GeoTiff in UTM
> zone 17 to PNG with similiar results.  I can provide my test results by
> email, and I will be submitting a bug report to bugzilla.  Can someone help
> duplicate my results before I submit a report?

Dan, 

I haven't run into this problem, but in September 2004 I did upgrade
to libpng 1.2.6, so it is entirely possible that some problems were
also introduced at that point.  

I do have one or two simple png driver tests in my testsuite, so that
suggests to me that the png support for my FWTools builds must
have been working before recent FWTools releases.  

It is  good idea to submit a detailed bug report so I can try and reproduce
the issue, though I don't have access to a PC till Friday.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Tue Jan 18 09:36:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDALAllRegister question.
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DEC8175@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DEC8175@vader.prologic-inc.com>
Message-ID: <931f8ea905011806363ee159b1@mail.gmail.com>

On Mon, 17 Jan 2005 14:50:48 -0500, William Lyons
<wlyons@prologic-inc.com> wrote:
> Frank and List,
> 
> Is there any harm in calling GDALAllRegister() repeatedly?

William,

The low level GDAL driver register functions are written like:

    if( GDALGetDriverByName( "ECW" ) == NULL )
    {
        poDriver = new GDALDriver();
        ...

So the idea is that you can call registration functions,either directly or
via GDALAllRegister() multiple times with no ill effect.  

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From James.Goodwin at sea.co.uk  Tue Jan 18 10:36:21 2005
From: James.Goodwin at sea.co.uk (James Goodwin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
Message-ID: <s1ed2d1c.066@mail.sea.co.uk>

Martin,

Thanks for your quick response.  I unfortunately don't have GDI+ as I'm using VS6. 

I've looked thruogh your attached code.  However, I'm confused by what the CVPPtr class is?

To be more specific - I'd really like an example of using GDAL & OGR to load S-57 files  - then view then in a simple MFC front end (zoom,scroll and layer control).  If you have any code, that would be great.

Cheers,
James

>>> "Chapman, Martin" <MChapman@sanz.com> 16/01/2005 00:32:32 >>>
James,
 
I've done a lot of exactly that.  Here are some things I've learned.  There are also code snippets below.
 
1.  Only use OpenGL if you want to render 3D data like elevation data (DEM, DTED, ...) in 3D meshes.  OpenGL is awesome for 3D but slow (comparably) if you only have X,Y (2D).  It's good for cross-platform rendering, but if you're using MFC you should go with the latest native graphics device (GDI+).  In my applications I use the MDI application framework and have different Documents/Views for 2D, 3D, and raw images (rasters).  
 
2.  To display vector maps with projected imagery (rasters that are scaled with the vectors in the same view) use GDI+.  This is hands down the best and fastest way to draw vectors (lat/lon) on Windows.  The old style GDI only uses integers for coordinates so you can't easily display lat/lon values.  OpenGL has to do a bunch of extra math when handling shapes other than triangles because the shape could be non-coplanar if it has more than 3 coords.  Also, OpenGL has an archaic interface for working with the graphics pipeline.  GDI+ on the other hand is almost identical to the Java2D library and is a totally awesome API that was extremely well thought out and is very sophistocated, and it's OO where OpenGL API is not.  We even use Java2D to render from OGR at work and it's very fast.  Not as fast as GDI+ though.  
 
3.  To display "raw" rasters (projected or unprojected), use the old style GDI and Device Context functions like BitBlt and StretchBlt or GDI+.  Nothing matches the speed of the old GDI funtions for rasters though.  GDI+ also handles raw rasters extremely well.  In fact, from an API perspective, it is far superior for rasters than GDI, but GDI is just fast.  You can use OpenGL for rasters as well, but I think their raster support is weak, unless you want to texture map an image to a 3D mesh, then it rocks.  
 
4.  No matter what graphics library you use, your code will be slow if you don't carefully think about how you load and draw your data.  Whether it's raster or vector data, you should always, load only enough data to fill your view.  
    a. Loading the whole file works great for small files, but will bring your app (and any computer) to it's knees when you start loading big files, or lots of small files.  
    b. Do not, cache geometries or pixel data unless you give your users an option to cache at will, because you will quickly consume all the users available memory.  Instead, each time your app pans or zooms, load the data again from the file, using a rectangle or quad index for vectors and an x,y,width,height offset for rasters.  
    c. Limit the number of times you loop through the features with OGR to one time per onpaint event.  That means, don't use the GetWKB functions.  Frank has to loop through the points and build the WKB first, then you will have to loop through the points again to draw them.  If you elimanate that loop then you will be twice as fast.
    d.  Don't store points.  That means, get them from OGR, stick it into a GDI+ point object array, draw it, and then get rid of it.  
    e. AND THE MOST IMPORTANT RULE OF RENDERING IS....limit the number of times you draw the points to the screen.  I see a lot of code where the developer is drawing every point to the screen as they loop through the features.  Drawing to a screen moves millions of bits around and is very very expensive and humans can only process a screen update visually something like 30 screen refreshes a second, so drawing between those intervals is useless for any lifeform that I know of that usues a computer.  You should do something like time based rendering or once per feature.  You should accumulate points using the GDI+ PointF class in a PointF[] and then draw them periodically and then delete them.  MFC has a nice handy function called GetTickCount() that will help you track time in milli-seconds to do this.  It also gives you a very snooth rendering appearance.  
 
The bottom line is that different graphics libraries are better suited for different jobs on different hardware.  So before you pick one, really think about wht you want to do, and then be smart about NOT trying to make one document/view to handle all situations.  
 
I have tons of code using different graphics libraries so you will have to ask me for specific examples if you want them.  Listed below is a code snippet for using GDI+ and vectors using OGR.  It uses some of my own classes to store feature style info and cached graphics for when a user wants to cache and un-cache layers.  It also, uses a second GDI+ Graphics object to draw to a CachedBitmap for double buffering.  Really, double-buffering doesn't work well for vectors because it can take a while to draw really large vector files (hundreds of megabytes and features), but is very useful for smooth panning.  The code below draws points to the screen first to satisfy the use, and then loops again to paint to an offscreen bitmap for smooth/quick panning.  If you want to double the speed of loading, then remove the pMemGraphics and m_spMemGraphics object from the functions.  Although, this will not change the visual appearance because I already draw first, but it will finish the over-all loading faster beacuse you are drawing half as much.  
 
The interesting functions below are OnPaint() and DrawVectorLayer().
 
Have fun!
Martin Chapman
void CMapView::OnPaint()

{

try

{

CPaintDC dc(this);

CRect clientRect;

GetClientRect(&clientRect);

Graphics graphics(dc.m_hDC);

CMainFrame* pMainFrame = (CMainFrame*) AfxGetMainWnd();

NAVIGATIONMODE eNavigationMode = pMainFrame->GetMapNavigationMode();

CVPPtr< IVPMap> spMap = GetMap();

CVPPtr< IVPEnvelope> spBBox = spMap->GetBoundingBox();

m_nScaleX = (REAL) (spMap->GetSRSWidth() / spBBox->GetWidth()); 

m_nScaleY = (REAL) (spMap->GetSRSHeight() / spBBox->GetHeight()); 

REAL nClientXFactor = (REAL) (spMap->GetSRSWidth() / clientRect.Width()); 

REAL nClientYFactor = (REAL) (spMap->GetSRSHeight() / clientRect.Height()); 

REAL nClientScaleFactor = nClientXFactor > nClientYFactor ? nClientXFactor : nClientYFactor;

m_nScaleX /= nClientScaleFactor;

m_nScaleY /= nClientScaleFactor;

m_nTranslationX = (REAL) (spBBox->GetMinX() + (spBBox->GetWidth() / 2));

m_nTranslationY = (REAL) (spBBox->GetMinY() + (spBBox->GetHeight() / 2));

m_nViewportOriginX = (REAL) (((clientRect.Width() / 2) / m_nScaleX));

m_nViewportOriginY = (REAL) (((clientRect.Height() / 2) / m_nScaleY));

graphics.SetSmoothingMode(SmoothingModeHighSpeed);

graphics.SetCompositingQuality(CompositingQualityHighSpeed);

if (m_bZooming && (eNavigationMode == NAVIGATION_MODE_PANMOVE))

{

SolidBrush solidBrush(Color(255, 255, 255, 255));

RectF clearRect((REAL) clientRect.left, (REAL) clientRect.top, 

(REAL) clientRect.Width(), (REAL) clientRect.Height());

RectF excludeRect((REAL)-m_nStrokeOffSetX, (REAL) m_nStrokeOffSetY, 

(REAL)clientRect.Width(), (REAL) clientRect.Height());

Region clearRegion(clearRect);

clearRegion.Exclude(excludeRect);

graphics.FillRegion(&solidBrush, &clearRegion);

graphics.TranslateTransform(-m_nStrokeOffSetX, m_nStrokeOffSetY);

}

if (!m_pMemBitmap)

CreateOffScreenGraphics(clientRect.Width(), clientRect.Height(), &graphics);

if (((eNavigationMode != NAVIGATION_MODE_ZOOMIN_BAND) &&

(eNavigationMode != NAVIGATION_MODE_ZOOMOUT_BAND)) || !m_bZooming)

{

graphics.DrawCachedBitmap(m_pCachedBitmap, 0, 0);

}

}

catch(exception e) 

{AfxMessageBox(e.what());}

catch(char* e) 

{AfxMessageBox(e);}

catch(...) 

{AfxMessageBox("An unexpected error occurred in CMapView::OnPaint().");}

}

void CMapView::CreateOffScreenGraphics(int nWidth, int nHeight, Graphics* pGraphics)

{

try

{

#ifdef _DEBUG

#undef new

m_pMemBitmap = new Bitmap(nWidth, nHeight, pGraphics);

#define new DEBUG_NEW

#else

m_pMemBitmap = new Bitmap(nWidth, nHeight, pGraphics);

#endif

CVPPtr< IVPMap> spMap = GetMap();

m_pMemGraphics = Graphics::FromImage(m_pMemBitmap);

m_pMemGraphics->TranslateTransform(m_nViewportOriginX - (m_nTranslationX), m_nViewportOriginY + (m_nTranslationY));

m_pMemGraphics->ScaleTransform(m_nScaleX, m_nScaleY, MatrixOrderAppend);

m_pMemGraphics->Clear(Color(255, 255, 255, 255));

DrawMap(pGraphics, m_pMemGraphics, spMap);

#ifdef _DEBUG

#undef new

m_pCachedBitmap = new CachedBitmap(m_pMemBitmap, pGraphics);

#define new DEBUG_NEW

#else

m_pCachedBitmap = new CachedBitmap(m_pMemBitmap, pGraphics);

#endif

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::CreateOffScreenGraphics().";}

}

void CMapView::DrawMap(Graphics* pGraphics, Graphics* pMemGraphics, IVPMap* pMap) 

{

try

{

if (!pMap) return;

CVPPtr< IVPMap> spMap = pMap;

double nScale = spMap->GetScale();

pGraphics->TranslateTransform(m_nViewportOriginX - (m_nTranslationX), m_nViewportOriginY + (m_nTranslationY));

pGraphics->ScaleTransform(m_nScaleX, m_nScaleY, MatrixOrderAppend);

for (int j = spMap->GetLayerCount() - 1; j >= 0; j--)

{

CVPPtr< IVPLayer> spLayer = spMap->GetLayerAt(j);

if (spLayer->IsVisible())

{

if (((nScale >= spLayer->GetMinScale()) && 

(nScale < spLayer->GetMaxScale())) ||

spLayer->IsShowAllScales())

{

DrawLayer(pGraphics, pMemGraphics, spLayer);

}

}

pGraphics->TranslateTransform(m_nViewportOriginX + (m_nTranslationX), m_nViewportOriginY - (m_nTranslationY));

pGraphics->ScaleTransform(-m_nScaleX, -m_nScaleY, MatrixOrderAppend);

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawMap().";}

}

void CMapView::DrawLayer(Graphics* pGraphics, Graphics* pMemGraphics, IVPLayer* pLayer) 

{

try

{

if (dynamic_cast< IVPLayerCollection*>(pLayer))

{

list< IVPLayer*>::iterator it;

list< IVPLayer*>* pList = ((IVPLayerCollection*)pLayer)->GetLayers();

for (it = pList->begin(); it != pList->end(); it++)

DrawLayer(pGraphics, pMemGraphics, *it);

}

else if (dynamic_cast< IVPLayer*>(pLayer))

{

if (dynamic_cast< IVPVectorLayer*> (pLayer))

{

DrawVectorLayer(pGraphics, pMemGraphics, (IVPVectorLayer*) pLayer);

}

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawLayer().";}

}

void CMapView::DrawVectorLayer(Graphics* pGraphics, 

Graphics* pMemGraphics, 

IVPVectorLayer* pVectorLayer)

{

try

{

CVPPtr< IVPVectorLayer> spVectorLayer = pVectorLayer;

CVPPtr< IVPFeatureStyle> spFeatureStyle = spVectorLayer->GetFeatureStyle();

CVPPtr< IVPGraphicCollection> spGraphicCollection = pVectorLayer->GetGraphicCollection();

bool bIsCached = spVectorLayer->IsCached();

if (bIsCached && spGraphicCollection.p)

{

IVPGraphic* pGraphic = NULL;

GraphicsPath* pPath = NULL;

list< IVPGraphic*>::reverse_iterator it;

list< IVPGraphic*>* pGraphicList = spGraphicCollection->GetGraphics();

Pen* pPen = spGraphicCollection->GetPen();

if (pPen) pPen->SetWidth(spFeatureStyle->GetLineSize() / ((m_nScaleX + m_nScaleY) / 2.0f));

Brush* pBrush = spGraphicCollection->GetBrush();

for (it = pGraphicList->rbegin(); it != pGraphicList->rend(); it++)

{

pGraphic = (IVPGraphic*) *it;

pPath = (GraphicsPath*) pGraphic->GetPath();

if (pPath) 

{

if (pBrush) pMemGraphics->FillPath(pBrush, pPath);

if (pPen) pMemGraphics->DrawPath(pPen, pPath);

}

}

if (spVectorLayer->IsShowLabels())

DrawLabels(pGraphics, pMemGraphics, pLayer);

return;

}

int i = 0, j = 0, n = 0;

int nNumPoints = 0;

int nNumRings = 0;

int nNumGeometries = 0;

GraphicsPath* pPath = NULL;

OGRGeometry* pOgrGeometry = NULL;

OGRPoint* pPoint = NULL;

OGRLineString* pLineString = NULL;

OGRLinearRing* pLinearRing = NULL;

OGRMultiPoint* pMultiPoint = NULL;

OGRPolygon* pPolygon = NULL;

OGRMultiPolygon* pMultiPolygon = NULL;

OGRMultiLineString* pMultiLineString = NULL;

CVPPtr< IVPVectorSet> spVectorSet = (IVPVectorSet*) spVectorLayer->GetResultSet();

CVPPtr< IVPVectorGraphic> spVectorGraphic;

if (bIsCached)

spGraphicCollection = new CVPGraphicCollection();

int r = 0, g = 0, b = 0, a = 255;

float nLineSize = spFeatureStyle->GetLineSize();

float nPointSize = nLineSize / m_nScaleY * 4;

USES_CONVERSION;

WCHAR* sFontFace = T2W(spFeatureStyle->GetFontFace().c_str());

float nFontSize = spFeatureStyle->GetFontSize();

Font font(sFontFace, nFontSize);

RectF pointRect(0.0f, 0.0f, nPointSize, nPointSize);

PointF* pPoints = NULL;

r = spFeatureStyle->GetLineColor()->GetRed();

g = spFeatureStyle->GetLineColor()->GetGreen();

b = spFeatureStyle->GetLineColor()->GetBlue();

a = spFeatureStyle->GetLineColor()->GetAlpha();

Pen pen(Color(a, r, g, b), nLineSize / ((m_nScaleX + m_nScaleY) / 2.0f));

r = spFeatureStyle->GetFillColor()->GetRed();

g = spFeatureStyle->GetFillColor()->GetGreen();

b = spFeatureStyle->GetFillColor()->GetBlue();

a = spFeatureStyle->GetFillColor()->GetAlpha();

SolidBrush fillBrush(Color(a, r, g, b));

r = spFeatureStyle->GetFontColor()->GetRed();

g = spFeatureStyle->GetFontColor()->GetGreen();

b = spFeatureStyle->GetFontColor()->GetBlue();

a = spFeatureStyle->GetFontColor()->GetAlpha();

SolidBrush fontBrush(Color(a, r, g, b));

CRect clientRect;

GetClientRect(&clientRect);

if (bIsCached)

spVectorSet->SetSpatialFilter(NULL);

else

{

CVPPtr< IVPEnvelope> spBoundingBox = GetMap()->GetBoundingBox();

CVPPtr< IVPPoint> spPoint;

spPoint.Attach(spBoundingBox->GetCentroid());

double nMinX = spPoint->GetX() - (clientRect.Width() / 2) / m_nScaleX;

double nMaxY = spPoint->GetY() + (clientRect.Height() / 2) / m_nScaleY;

double nMaxX = spPoint->GetX() + (clientRect.Width() / 2) / m_nScaleX;

double nMinY = spPoint->GetY() - (clientRect.Height() / 2) / m_nScaleY;

CVPPtr< IVPEnvelope> spEnvelope = new CVPEnvelope(nMinX, nMinY, nMaxX, nMaxY);

spVectorSet->SetSpatialFilter(spEnvelope.Detach());

}

OGRLayer* pOgrLayer = (OGRLayer*) spVectorSet->GetLayerRef();

OGRwkbGeometryType eGeomType = wkbUnknown;

OGRFeature* pOgrFeature = pOgrLayer->GetNextFeature();

pGraphics->Clear(Color(255, 255, 255, 255));

while (pOgrFeature)

{

#ifdef _DEBUG

#undef new

pPath = new GraphicsPath();

#define new DEBUG_NEW

#else

pPath = new GraphicsPath();

#endif

pOgrGeometry = (OGRGeometry*) pOgrFeature->GetGeometryRef();

eGeomType = pOgrGeometry->getGeometryType();

if (eGeomType == wkbPoint)

{

pPoint = (OGRPoint*) pOgrGeometry;

if (nLineSize > 0)

{

pointRect.X = (REAL) pPoint->getX();

pointRect.Y = (REAL) -pPoint->getY();

pPath->AddRectangle(pointRect);

}

}

else if (eGeomType == wkbLineString)

{

pLineString = (OGRLineString*) pOgrGeometry;

nNumPoints = pLineString->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLineString->getX(n), (REAL) -pLineString->getY(n));

pPath->AddLines(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

else if (eGeomType == wkbPolygon) 

{

nNumRings = ((OGRPolygon*) pOgrGeometry)->getNumInteriorRings() + 1;

for (i = 0; i < nNumRings; i++)

{

if (i == 0)

pLinearRing = ((OGRPolygon*) pOgrGeometry)->getExteriorRing();

else

pLinearRing = ((OGRPolygon*) pOgrGeometry)->getInteriorRing(i - 1);

nNumPoints = pLinearRing->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

if (i == 0)

{

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

else

{

for (n = nNumPoints - 1; n >= 0; n--) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

pPath->CloseFigure();

pPath->AddPolygon(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

else if (eGeomType == wkbMultiPoint)

{

pMultiPoint = (OGRMultiPoint*) pOgrGeometry;

nNumGeometries = pMultiPoint->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pPoint = (OGRPoint*) pMultiPoint->getGeometryRef(i);

if (nLineSize > 0)

{
etFo
pointRect.X = (REAL) pPoint->getX();

pointRect.Y = (REAL) -pPoint->getY();

pPath->AddRectangle(pointRect);

}

}

}

else if (eGeomType == wkbMultiLineString)

{

pMultiLineString = (OGRMultiLineString*) pOgrGeometry;

nNumGeometries = pMultiLineString->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pLineString = (OGRLineString*) pMultiLineString->getGeometryRef(i);

nNumPoints = pLineString->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLineString->getX(n), (REAL) -pLineString->getY(n));

pPath->AddLines(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

else if (eGeomType == wkbMultiPolygon)

{

pMultiPolygon = (OGRMultiPolygon*) pOgrGeometry;

nNumGeometries = pMultiPolygon->getNumGeometries();

for (i = 0; i < nNumGeometries; i++)

{

pPolygon = (OGRPolygon*) pMultiPolygon->getGeometryRef(i);

nNumRings = ((OGRPolygon*) pPolygon)->getNumInteriorRings() + 1;

for (j = 0; j < nNumRings; j++)

{

if (j == 0)

pLinearRing = pPolygon->getExteriorRing();

else

pLinearRing = pPolygon->getInteriorRing(j - 1);

nNumPoints = pLinearRing->getNumPoints();

pPoints = new PointF[nNumPoints];

pPath->StartFigure();

if (i == 0)

{

for (n = 0; n < nNumPoints; n++) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

else

{

for (n = nNumPoints - 1; n >= 0; n--) 

pPoints[n] = PointF((REAL) pLinearRing->getX(n), (REAL) -pLinearRing->getY(n));

}

pPath->CloseFigure();

pPath->AddPolygon(pPoints, nNumPoints);

if (pPoints) delete [] pPoints;

}

}

}

if (eGeomType != wkbLineString && eGeomType != wkbMultiLineString)

{

pGraphics->FillPath(&fillBrush, pPath);

pGraphics->Flush();

}

pGraphics->DrawPath(&pen, pPath);

pGraphics->Flush();

if (bIsCached)

{

spVectorGraphic = new CVPVectorGraphic();

spVectorGraphic->SetPath((void*) pPath);

spGraphicCollection->Add(spVectorGraphic.Detach());

}

else

delete pPath;

delete pOgrFeature;

pOgrFeature = pOgrLayer->GetNextFeature();

}

pOgrLayer->ResetReading();

IVPGraphic* pGraphic = NULL;

GraphicsPath* pCurrentPath = NULL;

list< IVPGraphic*>::reverse_iterator it;

list< IVPGraphic*>* pGraphicList = spGraphicCollection->GetGraphics();

for (it = pGraphicList->rbegin(); it != pGraphicList->rend(); it++)

{

pGraphic = (IVPGraphic*) *it;

pCurrentPath = (GraphicsPath*) pGraphic->GetPath();

if (pPath) 

{

pMemGraphics->FillPath(&fillBrush, pPath);

pMemGraphics->DrawPath(&pen, pPath);

}

}

if (bIsCached)

{

spGraphicCollection->SetPen(pen.Clone());

spGraphicCollection->SetBrush(fillBrush.Clone());

spGraphicCollection->SetFont(font.Clone());

spGraphicCollection->SetFontBrush(fontBrush.Clone());

spVectorLayer->SetGraphicCollection(spGraphicCollection.Detach());

}

}

catch(exception e) 

{throw e;}

catch(char* e) 

{throw e;}

catch(...) 

{throw "An unexpected error occurred in CMapView::DrawVectorLayer().";}

}

 
 
 
 
 
-----Original Message----- 
From: James Goodwin [mailto:James.Goodwin@sea.co.uk] 
Sent: Fri 1/14/2005 8:11 AM 
To: gdal-dev@xserve.flids.com 
Cc: 
Subject: [Gdal-dev] GDAL & OpenEV / MFC



	I've downloaded the GDAL library and been successfully built it and loaded an S-57 file.  I've also downloaded the OpenEV code for displaying S-57 files.
	
	However, I'd like to use GDAL, OpenGL and the MFC libraries (not GTK) to do my coding!
	
	Has anyone taken this path already?  If so, is the any free code available?
	
	James
	
	
	________________________________________________________________________
	This email, and any attachment, may contain information that is confidential and/or subject to copyright. The recipient of any email from SEA shall not forward any message or attachment to any third party without prior consent from SEA. Although SEA uses all reasonable endeavours to prevent the transmission of known viruses, SEA shall accept no liability for any damage to systems or loss of or corruption of data caused by any virus inadvertently transmitted. SEA reserves the right to monitor all incoming and outgoing email for any lawful purpose; this is clearly stated in the SEA policy - The Use of Computer and Telephony Equipment By Staff. The contents of this email do not give rise to any binding legal obligation upon SEA unless a separate confirmation is sent on headed stationery, either in hardcopy or by email, as an attachment. If an email is to create a binding obligation on SEA, through the use of an attachment, then this shall be clearly stated in the body text. Anyone dealing with SEA by email who objects to any of these terms should refer their concerns to the Business Systems Manager through the contact listed above.
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com 
	http://xserve.flids.com/mailman/listinfo/gdal-dev 
	


________________________________________________________________________
This email has been scanned for all viruses by the MessageLabs Email
Security System.

________________________________________________________________________
This email, and any attachment, may contain information that is confidential and/or subject to copyright. The recipient of any email from SEA shall not forward any message or attachment to any third party without prior consent from SEA. Although SEA uses all reasonable endeavours to prevent the transmission of known viruses, SEA shall accept no liability for any damage to systems or loss of or corruption of data caused by any virus inadvertently transmitted. SEA reserves the right to monitor all incoming and outgoing email for any lawful purpose; this is clearly stated in the SEA policy - The Use of Computer and Telephony Equipment By Staff. The contents of this email do not give rise to any binding legal obligation upon SEA unless a separate confirmation is sent on headed stationery, either in hardcopy or by email, as an attachment. If an email is to create a binding obligation on SEA, through the use of an attachment, then this shall be clearly stated in the body text. Anyone dealing with SEA by email who objects to any of these terms should refer their concerns to the Business Systems Manager through the contact listed above.

From pvg at pixelmapper.com  Mon Jan 17 04:15:24 2005
From: pvg at pixelmapper.com (Peter von Gaza)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] OGR Spatial Questions
Message-ID: <csg02o$526$1@sea.gmane.org>

Hi Frank,
I've just begun my long intended projected of replacing ("gutting") my 
attempts at projection support with your OGR. What I've done is compile 
a small DLL with the core ORG spatial routines. I'm testing by reading 
Geotiffs (UTM and Albers) and trying to get Lat/Long screen coordinates. 
Running into some trouble. First I tested with some of your examples:

     OGRSpatialReference    oUTM, *poLatLong;
     OGRCoordinateTransformation *poTransform;

     oUTM.SetProjCS("UTM 17 / WGS84");
     oUTM.SetWellKnownGeogCS( "WGS84" );
     oUTM.SetUTM( 17 );

     poLatLong = oUTM.CloneGeogCS();
     poTransform = OGRCreateCoordinateTransformation( &oUTM, poLatLong );

Works fine. Then I load a geotiff and try the following:

     char *pszProjection = GTIFGetOGISDefn(gtif, &defn );
     // string looks like it should

     OGRSpatialReference oSRS;
     OGRErr i = oSRS.SetProjection( pszProjection );

To this point seem ok.

     OGRSpatialReference    *poLatLong2;
     poLatLong2 = oSRS.CloneGeogCS();

NADA, return NULL. Am I missing a key step in setting up projections 
form geotiffs? Could this be related to proj.dll (I using the 
precompiled binary from the proj4 site)? Before I start digging I'm 
hoping there is an easy solution.

This is my first go at your code and using the proj4 dll.

Thanks,
Peter


From pvongaza at northwestel.net  Mon Jan 17 20:37:55 2005
From: pvongaza at northwestel.net (pvongaza)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] OGR Spatial Questions
Message-ID: <41EC6873.2030801@northwestel.net>

Hi Frank,
I've just begun my long intended projected of replacing ("gutting") my 
attempts at projection support with your OGR. What I've done is compile 
a small DLL with the core ORG spatial routines. I'm testing by reading 
Geotiffs (UTM and Albers) and trying to get Lat/Long screen coordinates. 
Running into some trouble. First I tested with some of your examples:

    OGRSpatialReference    oUTM, *poLatLong;
    OGRCoordinateTransformation *poTransform;

    oUTM.SetProjCS("UTM 17 / WGS84");
    oUTM.SetWellKnownGeogCS( "WGS84" );
    oUTM.SetUTM( 17 );

    poLatLong = oUTM.CloneGeogCS();
    poTransform = OGRCreateCoordinateTransformation( &oUTM, poLatLong );

Works fine. Then I load a geotiff and try the following:

    char *pszProjection = GTIFGetOGISDefn(gtif, &defn );
    // string looks like it should

    OGRSpatialReference oSRS;
    OGRErr i = oSRS.SetProjection( pszProjection );

To this point seem ok.

    OGRSpatialReference    *poLatLong2;
    poLatLong2 = oSRS.CloneGeogCS();

NADA, return NULL. Am I missing a key step in setting up projections 
form geotiffs? Could this be related to proj.dll (I using the 
precompiled binary from the proj4 site)? Before I start digging I'm 
hoping there is an easy solution.

This is my first go at your code and using the proj4 dll.

Thanks,
Peter

From pvg at pixelmapper.com  Tue Jan 18 01:47:37 2005
From: pvg at pixelmapper.com (pvg)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] OGR Spatial Questions
Message-ID: <41ECB109.7040100@pixelmapper.com>

Hi Frank,

I've been having some trouble trying to post to the gdal news group so 
I'm sending this email directly to you. Maybe it will post this time??

I've just begun my long intended projected of replacing ("gutting") my 
attempts at projection support with your OGR. What I've done is compile 
a small DLL with the core ORG spatial routines. I'm testing by reading 
Geotiffs (UTM and Albers) and trying to get Lat/Long screen coordinates. 
Running into some trouble. First I tested with some of your examples:

    OGRSpatialReference    oUTM, *poLatLong;
    OGRCoordinateTransformation *poTransform;

    oUTM.SetProjCS("UTM 17 / WGS84");
    oUTM.SetWellKnownGeogCS( "WGS84" );
    oUTM.SetUTM( 17 );

    poLatLong = oUTM.CloneGeogCS();
    poTransform = OGRCreateCoordinateTransformation( &oUTM, poLatLong );

Works fine. Then I load a geotiff and try the following:

    char *pszProjection = GTIFGetOGISDefn(gtif, &defn );
    // string looks like it should

    OGRSpatialReference oSRS;
    OGRErr i = oSRS.SetProjection( pszProjection );

To this point seem ok.

    OGRSpatialReference    *poLatLong2;
    poLatLong2 = oSRS.CloneGeogCS();

NADA, return NULL. Am I missing a key step in setting up projections 
form geotiffs? Could this be related to proj.dll (I using the 
precompiled binary from the proj4 site)? Before I start digging I'm 
hoping there is an easy solution.

This is my first go at your code and using the proj4 dll.

Thanks,
Peter

From pvg at pixelmapper.com  Tue Jan 18 13:29:11 2005
From: pvg at pixelmapper.com (Peter von Gaza)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Re: OGR Spatial Questions
In-Reply-To: <931f8ea9050118054115173445@mail.gmail.com>
References: <41ECB109.7040100@pixelmapper.com>
	<931f8ea9050118054115173445@mail.gmail.com>
Message-ID: <csjksr$h32$1@sea.gmane.org>

Frank,
Thanks! Everything works now. I was hoping for a simple solution.
I'm just starting to work with your OGR projection code but have
to say that I am VERY impressed how easily I was able to compile
an "ogr.dll" in Borland BCB5 and get it link and working in my
program. Amazing stuff.

Thanks,
Peter


Frank Warmerdam wrote:
>  
> 
>>Works fine. Then I load a geotiff and try the following:
>>
>>    char *pszProjection = GTIFGetOGISDefn(gtif, &defn );
>>    // string looks like it should
>>
>>    OGRSpatialReference oSRS;
>>    OGRErr i = oSRS.SetProjection( pszProjection );
> 
> 
> Here lies your problem.  The SetProjection() method is used to
> set the projection method to be used, such as "Transverse_Mercator".
> To import a complete WKT coordinate system definition you should
> use the importFromWkt() method.  
> 
> eg. 
> 
> char *pszProjectionCopy = pszProjection;
> OGRSpatialReference oSRS;
> 
> if( oSRS.importFromWkt( &pszProjectionCopy ) != OGRERR_NONE )
>   return;
> 
> The setting up of a duplicate pointer to the WKT definition
> is because importFromWkt() updates to pointer to point to the
> next character past the imported definition.  The approach was
> intended to let me process WKT out of a larger string, but in 
> practice I have never used that ability and the method has been
> clumsy to use (as above). 
> 
> Best regards,
> 


From afinley at gis.umn.edu  Tue Jan 18 23:24:30 2005
From: afinley at gis.umn.edu (Andrew Finley)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] featureDataset->RasterIO efficient pixel value reading
	question
Message-ID: <200501190424.j0J4OUPQ017313@dingo.software.umn.edu>

Hi Frank,
Some time ago, you helped me out with some code to speed up multi-band
image pixel value access.  I was using rasterIO to read one pixel at a
time.  You suggested the code below to grab a larger block (xsize*bands):

  // Make sure that lineBuf holds one whole line of data.
  float *lineBuf;
  int  xsize = featureDataset->GetRasterXSize();
  int  ysize = featureDataset->GetRasterYSize();
  int  bandCount = featureDataset->GetRasterCount();

  lineBuf = (float *) CPLMalloc(xsize * bandCount);

  //every row loop
  for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
      featureDataset->RasterIO( GF_Read, 0, row, xsize, 1,
                                lineBuf, xsize, 1, GDT_Float32,
                                bandCount, NULL,
                                4 * bandCount, 0, 4 );
      // every pixel in row.
      for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
          float *targetBandVec = lineBuf + col;
          ... perform classification ..
      }
  }



I'm having some trouble understanding the parameters that go into
featureDataset rasterIO and how it packs the data into the row lineBuf. 
What are the values of 4 you put in the RasterIO above?  Could you take me
one step further in the above example, so I can see how the pixel bands are
layed out in the lineBuf.  I took a shot below:

 // Make sure that lineBuf holds one whole line of data.
  float *lineBuf;
  int xsize = featureDataset->GetRasterXSize();
  int ysize = featureDataset->GetRasterYSize();
  int bandCount = featureDataset->GetRasterCount();
  lineBuf = (float *) CPLMalloc(sizeof(float)*xsize*bandCount);

  //every row loop
  for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
    featureDataset->RasterIO( GF_Read, 0, row, xsize, 1, lineBuf, xsize, 1,
GDT_Float32, bandCount, NULL, 4 * bandCount, 0, 4 );
    
    //every pixel in row.
    for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
      float *targetBandVec = lineBuf + col;
      
      //every band value in pixel (i.e., each cout row is a pixel and row
elements are specific band values in that pixel)
      //I know this part is wrong.

 	for(int band = 0; band < bandCount; band++)
	  cout << targetBandVec[band] <<" ";
	cout << endl;
    } 
  }


As always thanks for your time, I really appreciate your help.
-andy




From fwarmerdam at gmail.com  Wed Jan 19 00:04:10 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] featureDataset->RasterIO efficient pixel value reading
	question
In-Reply-To: <200501190424.j0J4OUPQ017313@dingo.software.umn.edu>
References: <200501190424.j0J4OUPQ017313@dingo.software.umn.edu>
Message-ID: <931f8ea90501182104769b2962@mail.gmail.com>

On Tue, 18 Jan 2005 22:24:30 CST, Andrew Finley <afinley@gis.umn.edu> wrote:
> Hi Frank,
> Some time ago, you helped me out with some code to speed up multi-band
> image pixel value access.  I was using rasterIO to read one pixel at a
> time.  You suggested the code below to grab a larger block (xsize*bands):
> 
>   // Make sure that lineBuf holds one whole line of data.
>   float *lineBuf;
>   int  xsize = featureDataset->GetRasterXSize();
>   int  ysize = featureDataset->GetRasterYSize();
>   int  bandCount = featureDataset->GetRasterCount();
> 
>   lineBuf = (float *) CPLMalloc(xsize * bandCount);
> 
>   //every row loop
>   for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
>       featureDataset->RasterIO( GF_Read, 0, row, xsize, 1,
>                                 lineBuf, xsize, 1, GDT_Float32,
>                                 bandCount, NULL,
>                                 4 * bandCount, 0, 4 );

Andy,

The last 3 arguments are the pixeloffset, line offset and 
band offset.  In the above case the buffer is "pixel interleaved",
that is if there were 2 bands we would have the values as 
<band1_pixel1> <band2_pixel1> <band1_pixel2> <band2_pixel2>...

The pixel offset is 4*bandCount because when moving from one pixel
to the next for a bandcount bytes (4 is for the size of float).   The line 
offset is 0 because we are operating on one line at a time so we don't
need to set this with a meaningful value since we will never be
advancing a scanline within a call.  The band offset is 4 because 
the second band starts 4 bytes after the place where the first band
starts.

I'm really bad at explaining this, but i hope the above helps.

>       // every pixel in row.
>       for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
>           float *targetBandVec = lineBuf + col;
>           ... perform classification ..
>       }
>   }
> 
> I'm having some trouble understanding the parameters that go into
> featureDataset rasterIO and how it packs the data into the row lineBuf.
> What are the values of 4 you put in the RasterIO above?  Could you take me
> one step further in the above example, so I can see how the pixel bands are
> layed out in the lineBuf.  I took a shot below:
> 
>  // Make sure that lineBuf holds one whole line of data.
>   float *lineBuf;
>   int xsize = featureDataset->GetRasterXSize();
>   int ysize = featureDataset->GetRasterYSize();
>   int bandCount = featureDataset->GetRasterCount();
>   lineBuf = (float *) CPLMalloc(sizeof(float)*xsize*bandCount);
> 
>   //every row loop
>   for (int row = 0; row < featureDataset->GetRasterYSize(); row++){
>     featureDataset->RasterIO( GF_Read, 0, row, xsize, 1, lineBuf, xsize, 1,
> GDT_Float32, bandCount, NULL, 4 * bandCount, 0, 4 );
> 
>     //every pixel in row.
>     for (int col = 0; col < featureDataset->GetRasterXSize(); col++){
>       float *targetBandVec = lineBuf + col;

The above should read "lineBuf + col*bandCount" so that as you
advance one pixel you skip all the band values for the previous
pixel.

>       //every band value in pixel (i.e., each cout row is a pixel and row
> elements are specific band values in that pixel)
>       //I know this part is wrong.
> 
>         for(int band = 0; band < bandCount; band++)
>           cout << targetBandVec[band] <<" ";
>         cout << endl;

The above is fine as long as you compute the targetBandVec
properly.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mbrudka at aster.pl  Wed Jan 19 11:51:42 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
Message-ID: <41EE901E.3010009@aster.pl>

Hi,
I've reported the following error in bugzilla 
(http://208.24.120.44/show_bug.cgi?id=746).

This bug is related with void GDALDriverManager::AutoLoadDrivers() 
method. The way this method works leads to errors, which manifest under 
windows, though it is possible other systems are also affected.
Method GDALDriverManager::AutoLoadDrivers() tries to load every file 
found in papszSearchPath starting with gdal_. For GDAL_DRIVER_PATH 
defined this is quite resonable. However when GDAL_DRIVER_PATH is 
undefined, method tries to load files from /usr/local/lib path, which is 
frequently used for storing other import libraries. Obviously, loading 
import library as shared one results in linking errors. To fix this bug, 
GDALDriverManager::AutoLoadDrivers() method should check if given file 
is  shared library before loading.
The current plugin loading is rather badly designed. I propose to change 
the functionality of GDALDriverManager::AutoLoadDrivers() as follows:
1. AutoLoadDrives should be parameterized be a search path.
2. GDAL_DRIVER_PATH should not be defined at gdal library level, but 
rather at the user application one. Every environment variable 
introduces configuration and deployment problems, hence they should be 
avoided. Otherwise configuration of the application becomes a nightmare.
3. RegisterAllDrivers should be parameterized by a search path, possible 
with NULL default.
4. Every file processed by GDALDriverManager::AutoLoadDrivers() should 
be verified if it is real shared library.
5. Every shared library should be check against compilation variant. 
Loading dll compiled in Debug mode in release version of the library 
often leads to critical errors. As a rule of thumb, one should never mix 
Debug and Release variants under Windows. (this is hard issue).

I think that plugin architecture of GDAL requires wide discussion in the 
context of GDAL build system.

Marek Brudka


From fwarmerdam at gmail.com  Wed Jan 19 12:10:04 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
In-Reply-To: <41EE901E.3010009@aster.pl>
References: <41EE901E.3010009@aster.pl>
Message-ID: <931f8ea905011909103ca8d3d3@mail.gmail.com>

On Wed, 19 Jan 2005 17:51:42 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
> Hi,
> I've reported the following error in bugzilla
> (http://208.24.120.44/show_bug.cgi?id=746).
> 
> This bug is related with void GDALDriverManager::AutoLoadDrivers()
> method. The way this method works leads to errors, which manifest under
> windows, though it is possible other systems are also affected.
> Method GDALDriverManager::AutoLoadDrivers() tries to load every file
> found in papszSearchPath starting with gdal_. For GDAL_DRIVER_PATH
> defined this is quite resonable. However when GDAL_DRIVER_PATH is
> undefined, method tries to load files from /usr/local/lib path, which is
> frequently used for storing other import libraries. Obviously, loading
> import library as shared one results in linking errors. To fix this bug,
> GDALDriverManager::AutoLoadDrivers() method should check if given file
> is  shared library before loading.
> The current plugin loading is rather badly designed. I propose to change
> the functionality of GDALDriverManager::AutoLoadDrivers() as follows:
> 1. AutoLoadDrives should be parameterized be a search path.

Marek,

I disagree.  I want stock GDAL applications to support autoloaded
drivers with no special effort on their part to track paths and so forth.
So requring this path to come from a parameter would interfere with
this. 

> 2. GDAL_DRIVER_PATH should not be defined at gdal library level, but
> rather at the user application one. Every environment variable
> introduces configuration and deployment problems, hence they should be
> avoided. Otherwise configuration of the application becomes a nightmare.

GDAL_DRIVER_PATH is a CPL Configuration item.  It can be defined
by environment variable or applications can override it with a call to 
CPLSetConfigOption(). 

> 3. RegisterAllDrivers should be parameterized by a search path, possible
> with NULL default.

As above, I don't with this standard entry point parameterized as whatever
the parameter is used for will require attention by all GDAL applications.

> 4. Every file processed by GDALDriverManager::AutoLoadDrivers() should
> be verified if it is real shared library.

Note that an attempt is only made to load files prefixed with "gdal_".
I think it would be sensible to also modify the autoloader to verify that
the extension is .so, .dylib or .dll.  

> 5. Every shared library should be check against compilation variant.
> Loading dll compiled in Debug mode in release version of the library
> often leads to critical errors. As a rule of thumb, one should never mix
> Debug and Release variants under Windows. (this is hard issue).

It is the responsibility of the developer to ensure that all components
are compiled in a compatible way.  I think it would be prudent to 
implement a mechanism for the plugin registration methods to check
that they were compiled against a compatible version of GDAL to the
one into which they are being loaded.  Unfortunately this is challenging.
I can ensure that they are compiled for the same version via the version
string (using  GDAL_RELEASE_NAME macro) and comparing to the
runtime value returned by GDALVersionInfo().  

I considered doing this; however, it would often then consider 
plugins incompatible that would have worked if they were compiled
for a slightly different but ABI compatible version.  The central issue
here is that the GDAL C++ ABI changes frequently but not with every
minor version.  It is really only the  C ABI that I try to maintain strict
backward compatibility for. 

In general it is the responsibility of plugin users to ensure they are for
a compatible version of GDAL for now.  If there is wide agreement I 
could change this to do the GDAL_RELEASE_NAME check. 

> I think that plugin architecture of GDAL requires wide discussion in the
> context of GDAL build system.

I am agreeable to this.

PS. It can be construed as rude to suggest someone elses code is
"rather poorly designed".   Consider the possibility that it was well 
designed for objectives quite different than your own.  Of course, I do 
try to  declare my own code poorly designed.   

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jan 19 12:10:04 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
In-Reply-To: <41EE901E.3010009@aster.pl>
References: <41EE901E.3010009@aster.pl>
Message-ID: <931f8ea905011909103ca8d3d3@mail.gmail.com>

On Wed, 19 Jan 2005 17:51:42 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
> Hi,
> I've reported the following error in bugzilla
> (http://208.24.120.44/show_bug.cgi?id=746).
> 
> This bug is related with void GDALDriverManager::AutoLoadDrivers()
> method. The way this method works leads to errors, which manifest under
> windows, though it is possible other systems are also affected.
> Method GDALDriverManager::AutoLoadDrivers() tries to load every file
> found in papszSearchPath starting with gdal_. For GDAL_DRIVER_PATH
> defined this is quite resonable. However when GDAL_DRIVER_PATH is
> undefined, method tries to load files from /usr/local/lib path, which is
> frequently used for storing other import libraries. Obviously, loading
> import library as shared one results in linking errors. To fix this bug,
> GDALDriverManager::AutoLoadDrivers() method should check if given file
> is  shared library before loading.
> The current plugin loading is rather badly designed. I propose to change
> the functionality of GDALDriverManager::AutoLoadDrivers() as follows:
> 1. AutoLoadDrives should be parameterized be a search path.

Marek,

I disagree.  I want stock GDAL applications to support autoloaded
drivers with no special effort on their part to track paths and so forth.
So requring this path to come from a parameter would interfere with
this. 

> 2. GDAL_DRIVER_PATH should not be defined at gdal library level, but
> rather at the user application one. Every environment variable
> introduces configuration and deployment problems, hence they should be
> avoided. Otherwise configuration of the application becomes a nightmare.

GDAL_DRIVER_PATH is a CPL Configuration item.  It can be defined
by environment variable or applications can override it with a call to 
CPLSetConfigOption(). 

> 3. RegisterAllDrivers should be parameterized by a search path, possible
> with NULL default.

As above, I don't with this standard entry point parameterized as whatever
the parameter is used for will require attention by all GDAL applications.

> 4. Every file processed by GDALDriverManager::AutoLoadDrivers() should
> be verified if it is real shared library.

Note that an attempt is only made to load files prefixed with "gdal_".
I think it would be sensible to also modify the autoloader to verify that
the extension is .so, .dylib or .dll.  

> 5. Every shared library should be check against compilation variant.
> Loading dll compiled in Debug mode in release version of the library
> often leads to critical errors. As a rule of thumb, one should never mix
> Debug and Release variants under Windows. (this is hard issue).

It is the responsibility of the developer to ensure that all components
are compiled in a compatible way.  I think it would be prudent to 
implement a mechanism for the plugin registration methods to check
that they were compiled against a compatible version of GDAL to the
one into which they are being loaded.  Unfortunately this is challenging.
I can ensure that they are compiled for the same version via the version
string (using  GDAL_RELEASE_NAME macro) and comparing to the
runtime value returned by GDALVersionInfo().  

I considered doing this; however, it would often then consider 
plugins incompatible that would have worked if they were compiled
for a slightly different but ABI compatible version.  The central issue
here is that the GDAL C++ ABI changes frequently but not with every
minor version.  It is really only the  C ABI that I try to maintain strict
backward compatibility for. 

In general it is the responsibility of plugin users to ensure they are for
a compatible version of GDAL for now.  If there is wide agreement I 
could change this to do the GDAL_RELEASE_NAME check. 

> I think that plugin architecture of GDAL requires wide discussion in the
> context of GDAL build system.

I am agreeable to this.

PS. It can be construed as rude to suggest someone elses code is
"rather poorly designed".   Consider the possibility that it was well 
designed for objectives quite different than your own.  Of course, I do 
try to  declare my own code poorly designed.   

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From mbrudka at aster.pl  Wed Jan 19 12:29:50 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect export/import directives for GDAL libraries
Message-ID: <41EE990E.3090109@aster.pl>

Hi,
    I posted another bug report related with shared libraries:

Currently, GDAL libraries are exported using the following macros 
(cpl_port.h)
#ifndef CPL_DLL
#if defined(_MSC_VER) && !defined(CPL_DISABLE_DLL)
#  define CPL_DLL     __declspec(dllexport)
#else
#  define CPL_DLL
#endif
#endif
Obviously, this incorrected, because it does not import symbols when 
*using* GDAL libraries eg. see MSDN help. I propose to use the same 
schema as in ACE multiplatform library:

// -*- C++ -*-
// $Id$
// Definition for Win32 Export directives.
// This file is generated automatically by generate_export_file.pl CPL
// and customized by Marek Brudka <mbrudka@aster.pl> for GDAL
// ------------------------------
#ifndef CPL_DLL_H
#define CPL_DLL_H
/*
CPL_HAS_DLL  switches between shared and static libraries setup (old 
CPL_DISABLE_DLL )
  1 build and use shared library,
  0 built and use static library

CPL_BUILD_DLL - considered only for shared libraries setup,
    ( MSVC for new shared library project cpl generates CPL_EXPORT macro)
  defined - export symbols, as shared library is built now
  undefined - import symbols from shared library into application
*/
#if !defined (CPL_HAS_DLL)
#  define CPL_HAS_DLL 1
#endif /* ! CPL_HAS_DLL */

#if defined (CPL_HAS_DLL) && (CPL_HAS_DLL == 1) && defined(_MSC_VER)
#  if defined (CPL_BUILD_DLL)
#    define CPL_DLL __declspec(dllexport)
#  else /* CPL_BUILD_DLL */
#    define CPL_DLL __declspec(dllimport)
#  endif /* CPL_BUILD_DLL */
#else /* CPL_HAS_DLL == 1 */
#  define CPL_DLL
#endif /* CPL_HAS_DLL == 1 */

#endif /* CPL_DLL_H */

// End of auto generated file.

When building shared library GDAL one has to enable shared library 
build, namely define CPL_HAS_DLL=1, and define CPL_BUILD_DLL. When 
building an application using shared library GDAL one must not define 
CPL_BUILD_DLL to import symbols from gdal.dll.

Best regards
MArek Brudka


From mbrudka at aster.pl  Wed Jan 19 12:37:57 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
In-Reply-To: <931f8ea905011909103ca8d3d3@mail.gmail.com>
References: <41EE901E.3010009@aster.pl>
	<931f8ea905011909103ca8d3d3@mail.gmail.com>
Message-ID: <41EE9AF5.4010706@aster.pl>

Hi,

>PS. It can be construed as rude to suggest someone elses code is
>"rather poorly designed".   Consider the possibility that it was well 
>designed for objectives quite different than your own.  Of course, I do 
>try to  declare my own code poorly designed.   
>
Please forgive me I you feel offended. I did not intent to. But this 
desing is
really distict from other plugin architectures I know, hence my opinion :-)

Marek


From mbrudka at aster.pl  Wed Jan 19 13:46:02 2005
From: mbrudka at aster.pl (Marek Brudka)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
In-Reply-To: <931f8ea905011909103ca8d3d3@mail.gmail.com>
References: <41EE901E.3010009@aster.pl>
	<931f8ea905011909103ca8d3d3@mail.gmail.com>
Message-ID: <41EEAAEA.2060408@aster.pl>

User  Frank Warmerdam wrote:

>On Wed, 19 Jan 2005 17:51:42 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
>  
>
>>Hi,
>>I've reported the following error in bugzilla
>>(http://208.24.120.44/show_bug.cgi?id=746).
>>
>>This bug is related with void GDALDriverManager::AutoLoadDrivers()
>>method. The way this method works leads to errors, which manifest under
>>windows, though it is possible other systems are also affected.
>>Method GDALDriverManager::AutoLoadDrivers() tries to load every file
>>found in papszSearchPath starting with gdal_. For GDAL_DRIVER_PATH
>>defined this is quite resonable. However when GDAL_DRIVER_PATH is
>>undefined, method tries to load files from /usr/local/lib path, which is
>>frequently used for storing other import libraries. Obviously, loading
>>import library as shared one results in linking errors. To fix this bug,
>>GDALDriverManager::AutoLoadDrivers() method should check if given file
>>is  shared library before loading.
>>The current plugin loading is rather badly designed. I propose to change
>>the functionality of GDALDriverManager::AutoLoadDrivers() as follows:
>>1. AutoLoadDrives should be parameterized be a search path.
>>    
>>
>
>I disagree.  I want stock GDAL applications to support autoloaded
>drivers with no special effort on their part to track paths and so forth.
>So requring this path to come from a parameter would interfere with
>this. 
>  
>
I agree, this is less convenient that using GDAL_DRIVER_PATH path. But 
it is simplier
and more explicit design. Simplicity of the interface is the one of the 
most desired feature for
any library. This is why OGC standards are so cool :-)

In general, one after installing gdal-devel libraries should not set 
anything in environment, because
(Morphy Law) for sure he or she will not do this.

>>2. GDAL_DRIVER_PATH should not be defined at gdal library level, but
>>rather at the user application one. Every environment variable
>>introduces configuration and deployment problems, hence they should be
>>avoided. Otherwise configuration of the application becomes a nightmare.
>>    
>>
>
>GDAL_DRIVER_PATH is a CPL Configuration item.  It can be defined
>by environment variable or applications can override it with a call to 
>CPLSetConfigOption().
>  
>
Sure. But this means, that almost any application should call 
CPLSetConfigOption() before
registration of GDAL drivers. This way one achieves in two steps, namely 
CPLSetConfigOption
and GDALRegisterAll the state which can be achieved in one step, namely 
GDALRegisterAll( path ).
This is complex, because assumes the developer knows the interiors of GDAL.

Please notice, that the only responsibility of GDALRegisterAll(  ) 
function is the registration of all
drivers and plugins. But the signature of this function does not tell 
anything about the way it is done, but
makes some implicit assumptions, where plugins should be looked for. 
Then neither the developer is not told
by the interface what  should be provided, nor the compiler can guard 
proper usage of this function.

>>3. RegisterAllDrivers should be parameterized by a search path, possible
>>with NULL default.
>>    
>>
>
>As above, I don't with this standard entry point parameterized as whatever
>the parameter is used for will require attention by all GDAL applications.
>  
>
>>4. Every file processed by GDALDriverManager::AutoLoadDrivers() should
>>be verified if it is real shared library.
>>    
>>
>
>Note that an attempt is only made to load files prefixed with "gdal_".
>I think it would be sensible to also modify the autoloader to verify that
>the extension is .so, .dylib or .dll.  
>  
>
We use several open source libraries under windows/linux/neutrino. We 
decided to follow standard unix tree
on windows to be consistent among OS. We have c:\usr\local\lib for 
holding import libraries and c:\usr\local\bin
for windows shared libraries, because under windows one should follow M$ 
conventions and to avoid setting
lib on %PATH%. In c:\usr\local\lib we had a number of gdal import 
libraries built for various variants (debug/release
OCI/noOCI etc.)  You can imagine the result.

I know, it is enough to set GDAL_DRIVER_PATH, but this is another 
variable a developer has to define to create
the developement framework. Multiply, please the number of developers by 
the number of each OS library settings.
Assume that each case has to be explained separatedly for every library 
update by a manager or software architect,
because in production environment people avoid reading docs/notes. This 
is why I think that configuration variables
should be avoided or moved on C++ interface level. This enforces each 
developer to enhance his knowledge..

If you decide to load plugins from a default path, when GDAL_DRIVER_PATH 
is undefined
I propose to not search in /usr/local/lib, but /usr/local/plugins/gdal/, 
/usr/local/lib/plugins/gdal or something similiar.
Please notice, that plugins aware applications usually has their own 
specific search path eg. mozilla, opera, qt .., and
do not even try to look into system wide directories.

>>5. Every shared library should be check against compilation variant.
>>Loading dll compiled in Debug mode in release version of the library
>>often leads to critical errors. As a rule of thumb, one should never mix
>>Debug and Release variants under Windows. (this is hard issue).
>>    
>>
>
>It is the responsibility of the developer to ensure that all components
>are compiled in a compatible way.  I think it would be prudent to 
>implement a mechanism for the plugin registration methods to check
>that they were compiled against a compatible version of GDAL to the
>one into which they are being loaded.  Unfortunately this is challenging.
>I can ensure that they are compiled for the same version via the version
>string (using  GDAL_RELEASE_NAME macro) and comparing to the
>runtime value returned by GDALVersionInfo().
>  
>
I ACE there is a convention for library names. Debug library under 
windows is called <name>d.lib, <name>d.dll,
while for unix lib<name>d.a and lib<name>d.so. Release versions does not 
have 'd'. When compiling any project a
macro is defined (or DEBUG NDEBUG standard macros are used) to tell if 
this is Debug or Release version. That's
enough to discriminate between plugins. I agree, that this solution is 
not the ideal one, but manages almost all
practical situations.

The solution you proposed is more elaborated, and I think it is better 
than the above, because really attacks
the problem.

>I considered doing this; however, it would often then consider 
>plugins incompatible that would have worked if they were compiled
>for a slightly different but ABI compatible version.  The central issue
>here is that the GDAL C++ ABI changes frequently but not with every
>minor version.  It is really only the  C ABI that I try to maintain strict
>backward compatibility for. 
>  
>
I suppose that compatibility level can be controlled when loading 
plugins eg.
we can assume that version string contains detailed information on GDAL 
major and minor
versions as well as build variant. W plugin can be considered to be 
compatible when major
version and build variant agree.

>In general it is the responsibility of plugin users to ensure they are for
>a compatible version of GDAL for now.  If there is wide agreement I 
>could change this to do the GDAL_RELEASE_NAME check. 
>  
>
Cool!

>>I think that plugin architecture of GDAL requires wide discussion in the
>>context of GDAL build system.
>>    
>>
Lot of work, but I can help on both concept and implementation level.

>PS. It can be construed as rude to suggest someone elses code is
>"rather poorly designed".   Consider the possibility that it was well 
>designed for objectives quite different than your own.  Of course, I do 
>try to  declare my own code poorly designed.   
>  
>
I'm sorry once again.

Regards
Marek

From fwarmerdam at gmail.com  Wed Jan 19 15:53:05 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Incorrect plugin search when registering GDAL drivers
In-Reply-To: <41EEAAEA.2060408@aster.pl>
References: <41EE901E.3010009@aster.pl>
	<931f8ea905011909103ca8d3d3@mail.gmail.com>
	<41EEAAEA.2060408@aster.pl>
Message-ID: <931f8ea9050119125315ff720a@mail.gmail.com>

On Wed, 19 Jan 2005 19:46:02 +0100, Marek Brudka <mbrudka@aster.pl> wrote:
> I agree, this is less convenient that using GDAL_DRIVER_PATH path. But
> it is simplier
> and more explicit design. Simplicity of the interface is the one of the
> most desired feature for
> any library. This is why OGC standards are so cool :-)

Folks,

Marek and I discussed things a bit in IRC but I thought I should summarize
and answer a few questions here. 

First I congratulated Marek on his joke about OGC standards, but 
apparently he meant it seriously.  I guess they are simple and clean
compared ... to some other standards.

> In general, one after installing gdal-devel libraries should not set
> anything in environment, because
> (Morphy Law) for sure he or she will not do this.

The CPLSetConfigOption() concept is intended to allow GDAL applications
to control things without environment variables while given end users an
opportunity to influence how GDAL based software operates after the fact.
But environment variables are not required.  I would add that the
--config option
to many GDAL programs can be used to set config options.

> Sure. But this means, that almost any application should call
> CPLSetConfigOption() before
> registration of GDAL drivers.


> If you decide to load plugins from a default path, when GDAL_DRIVER_PATH
> is undefined
> I propose to not search in /usr/local/lib, but /usr/local/plugins/gdal/,
> /usr/local/lib/plugins/gdal or something similiar.
> Please notice, that plugins aware applications usually has their own
> specific search path eg. mozilla, opera, qt .., and
> do not even try to look into system wide directories.

I have changed the default path to be /usr/local/lib/gdalplugins in CVS.
I have also modified the autoloader to check that the target files have
the .so, .dll or .dylib extension. 

As discussed elsewhere I have also committed support for OGR plugins
(name stuff like ogr_<drivername>.so) though I have not yet tested it.  
 

> I ACE there is a convention for library names. Debug library under
> windows is called <name>d.lib, <name>d.dll,
> while for unix lib<name>d.a and lib<name>d.so. Release versions does not
> have 'd'. When compiling any project a
> macro is defined (or DEBUG NDEBUG standard macros are used) to tell if
> this is Debug or Release version. That's
> enough to discriminate between plugins. I agree, that this solution is
> not the ideal one, but manages almost all
> practical situations.

Well, I'll keep this in mind, but I haven't really supported overlapping debug
and release versions of stuff in GDAL generally (to the annoyance of at least
a few users). 

> The solution you proposed is more elaborated, and I think it is better
> than the above, because really attacks
> the problem.

It addresses version differences but no build option differences.
 
> >I considered doing this; however, it would often then consider
> >plugins incompatible that would have worked if they were compiled
> >for a slightly different but ABI compatible version.  The central issue
> >here is that the GDAL C++ ABI changes frequently but not with every
> >minor version.  It is really only the  C ABI that I try to maintain strict
> >backward compatibility for.
> >
> >
> I suppose that compatibility level can be controlled when loading
> plugins eg.
> we can assume that version string contains detailed information on GDAL
> major and minor
> versions as well as build variant. W plugin can be considered to be
> compatible when major
> version and build variant agree.

But as it turns out GDAL is C++ ABI incompatible between many 
minor revs as well. 
 
The more I consider wide deployment, the more I think I should
just do exact versions comparisons.  I won't act on this yet though.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From starged at videotron.ca  Wed Jan 19 18:01:59 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] color table problems
Message-ID: <0antu09pckf8fg3pl6k5vpglmbd1mps793@4ax.com>

Hi all,

I'm trying to assign a ColorTable to a VRT in OpenEV using vrtutils.VRTDatasetConstructor(). The
AddSimpleBand method needs "ColorInterp" and "colortable" so to get it from the source file, I have:

def getColorTable(f):
    band = gdal.Open(f).GetRasterBand(1)
    gci = band.GetRasterColorInterpretation()
    if gci == gdal.GCI_PaletteIndex:
        ci = 'Palette'
        ct = band.GetRasterColorTable()
    else:
        ci = 'Undefined'
        ct = None
    return ci,ct

But this makes Python crash.

Even this simple script give strange results:
## test.py
## Usage: test.py file
import gdal
import sys
band = gdal.Open(sys.argv[1]).GetRasterBand(1)
ci = band.GetRasterColorInterpretation()
ct = band.GetRasterColorTable().GetCount()
print ci,ct
sys.exit(0)

I tried with many png and gif files and I get values like 8091364 and 8090496 on DOS and 8057040 or
7952048 on MSYS for ci. ct is always 0.

Even tried it on Linux and I get seg faults.

I suspect it's a Python prob as gdalinfo reports all infos correctly on all files tested.

BTW, why the whole color table has to be in the VRT? Couldn't there be a way to say: "get that from
the source band"?

Thanks.
--
Mario B.
Landsat images (demo):
http://pages.infinit.net/starged/landsat/home.htm

From starged at videotron.ca  Wed Jan 19 18:08:10 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] color table problems
Message-ID: <k2qtu0p5luh9bf6dsdi5b741pq8q6n9pii@4ax.com>

Hi all,

I'm trying to assign a ColorTable to a VRT in OpenEV using vrtutils.VRTDatasetConstructor(). The
AddSimpleBand method needs "ColorInterp" and "colortable" so to get it from the source file, I have:

def getColorTable(f):
    band = gdal.Open(f).GetRasterBand(1)
    gci = band.GetRasterColorInterpretation()
    if gci == gdal.GCI_PaletteIndex:
        ci = 'Palette'
        ct = band.GetRasterColorTable()
    else:
        ci = 'Undefined'
        ct = None
    return ci,ct

But this makes Python crash.

Even this simple script give strange results:
## test.py
## Usage: test.py file
import gdal
import sys
band = gdal.Open(sys.argv[1]).GetRasterBand(1)
ci = band.GetRasterColorInterpretation()
ct = band.GetRasterColorTable().GetCount()
print ci,ct
sys.exit(0)

I tried with many png and gif files and I get values like 8091364 and 8090496 on DOS and 8057040 or
7952048 on MSYS for ci. ct is always 0.

Even tried it on Linux and I get seg faults.

I suspect it's a Python prob as gdalinfo reports all infos correctly on all files tested.

BTW, why the whole color table has to be in the VRT? Couldn't there be a way to say: "get that from
the source band"?

Thanks.
--
Mario B.
Landsat images (demo):
http://pages.infinit.net/starged/landsat/home.htm

From MChapman at sanz.com  Fri Jan 21 00:09:05 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] GDAL & OpenEV / MFC
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C46@mailman>

Marek,
 
I hear ya, but I can render 3 millions points as filled polygons in 1 second in GDI+ on a mediocre machine (1.8mhz, 500 mb ram, and 48mb video card).
 
I was unable to get OpenGL that fast.  Although, it definitely could have been my code (which is usually the case) because one wrong call in a loop with a graphics library can kill your performance.
 
Martin

	-----Original Message----- 
	From: Marek Brudka [mailto:mbrudka@aster.pl] 
	Sent: Sun 1/16/2005 5:04 PM 
	To: Chapman, Martin 
	Cc: James Goodwin; gdal-dev@xserve.flids.com 
	Subject: Re: [Gdal-dev] GDAL & OpenEV / MFC
	
	

	Hi Matrin,
	
	User Chapman, Martin wrote:
	
	>Drawing speed is relative to hardware resources and other things you may have going on in your code while you draw.  So, there is no single answer to how much can GDI+ draw per second. 
	>
	Certainly! I was interested in exemplary results for examplary
	configuration to get an impression how fast GDI is. For rather cheap
	Geforces and not very fresh PCs one may render more 1MLines per second
	on 1280x1024 canvas. In general the number of triangles per second is a
	lower bound (often equal to :-) ) of the number of lines per second.
	
	>What you could say is that given the same environment and variables, GDI+ will out perform OpenGL for 2D rendering on Windows.  Also, note that humans can only process graphics refresh rates of about 30 times per second, so drawing to the screen more times than that is useless.
	>
	I did not played with GDI (directly), hence I cannot compare it with
	OpenGL. This is why it's interesting for me :-).
	
	However we made some tests using higher level libraries (Qt painter),
	which probably indirectly uses GDI (I'm not sure of that), and were very
	disappointed with the performance. In general, we found that  hardware
	accelarated OpenGL 2D vector rendering is at least 10 times faster than
	the using QtPainter functions. Certainly, the quality of graphic
	accelerator is important, but currently avalaible boards are usually
	optimized for 2D rendering.
	
	If you compare **SOFTWARE** OpenGL with GDI, then your results are
	probably true. However, if the results are for hardware accelarated
	OpenGL and GDI, then they are at least curious, because OpenGL can
	render graphic directly on hardware, not via GDI. I think, that one
	should expect hardware accelarated OpenGL to be not worse than GDI,
	because if GDI uses hardware acceleration (does it?), then sooner or
	later does exactly the same what OpenGL, namely tells the accelarator to
	render something. It is hard to render something faster in software than
	in hardware, hence I doubt this result. Please also notice how graphics
	is managed in Windows Longhorn..
	
	However very it is crucial how OpenGL is employed, because bad
	application of OpenGL usually results in poor performance.
	
	>  Where OpenGL really suffers though, is filling shapes.  It has to tessellate each complex polygon before it can fill it and the gluTessellation functions are very slow.
	>
	OpenGL is as fast in filling triangles as possible and I doubt if GDI
	can do it faster. Tessellation is not an OpenGL function but it is
	provided by OpenGL Utility library. These two are distinct libraries!
	
	Tessalation is usually done in software, not in hardware, hence one
	cannot expect it to be extremly fast. In fact, the tessallation is
	relatively slow, but excessive tessalation means, that software
	architecture is probably bad. One should almost always avoid
	tessalation. The best way to use it is to render an object once into
	glLists, then use this lists  as long as possible. Moreover, it is also
	important what is tessallated. The performance is seriously impacted if
	the shape tessallated is not convex and if it has inner rings. For a
	plain convex, solid shapes the tessalation is really fast, because the
	algorithm is very simple. In fact, for a plain convex polygons
	tessallation is not necessary, OpenGL can most of the work in hardware.
	
	Maps in GIS application are not usually rendered periodically but rather
	asynchronously eg. map scale is changed, map contents is translated, few
	features changed their position/shapes etc. For a translation or
	sometimes scale changes, OpenGL provides excellent support, because
	usually it is enough to change model or camera matrix and call glList to
	obtain nicely rendered result.
	
	OpenGL has excellent support for rasters. Obviously one has to convert
	them into textures, in fact GDAL does it, but the results are then
	impressive then. With a quite good accuracy, one may  also employ
	hardware accellaration do what GDALWarp is responsible for, namely to
	reproject raster maps.
	
	And the last, but not the least about OpenGL. This library is not for
	rendering 3D graphics only! In your previous post in many places you
	wrote that OpenGL is slow because
	it renders in 3D. OpenGL HAS a bunch of 2D functions, though their
	functionalities depend on capabilities of hardware accellaration.
	
	I do not agree partially with you opinion about caching. For a mass
	market software one cannot assume PC has a huge RAM, hence it should
	rather render in immidiate mode without caching. But for specialized
	markets, where hardware is more controlled one may force to use PC with
	at least 512MB RAM. Please also notice, that in next the few years the
	average PC will probably have >1 GB of RAM and GIS might consume 512
	MRAM without any serious impact on performance. Well.., 512 MB for GIS
	means, that the software is rather strange, because how detailed a map
	has to be to use such huge memory? For a comparision, a raw 1024x1024
	bitmap with 24bit color depth and 8bit alpha occupies only 4MB...
	
	Why caching is so important? Because of what you say about the access to
	GIS data. Our consideration on speed of rendering are really not
	important when compared with the cost of access to GIS data. Here are
	real bottlenecks eg mass storage or RDBM access. One has to use spatial
	indeces and queries here, but usually it is not enough because RDBMS
	servers are always too slow, and network bandwidth is always too low.
	Caching can moderate such cost, but obviously requires some additional
	RAM :-).
	
	Nevertheless, I really appreciate your post and agree with many thesis,
	in particular with that rendering is not as important as proper GIS data
	management :-)
	
	Best regards
	Marek Brudka
	
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

From fwarmerdam at gmail.com  Fri Jan 21 16:24:59 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] color table problems
In-Reply-To: <k2qtu0p5luh9bf6dsdi5b741pq8q6n9pii@4ax.com>
References: <k2qtu0p5luh9bf6dsdi5b741pq8q6n9pii@4ax.com>
Message-ID: <931f8ea905012113242b9fb84e@mail.gmail.com>

On Wed, 19 Jan 2005 18:08:10 -0500, Mario Beauchamp
<starged@videotron.ca> wrote:
> Hi all,
> 
> I'm trying to assign a ColorTable to a VRT in OpenEV using vrtutils.VRTDatasetConstructor(). The
> AddSimpleBand method needs "ColorInterp" and "colortable" so to get it from the source file, I have:
> 
> def getColorTable(f):
>     band = gdal.Open(f).GetRasterBand(1)

Mario, 

The problem turns out to be related to reference counting. 
It turns out that "band" objects don't get a reference to the 
dataset the way I bound GDAL in Python.  So you need to be
careful to keep around a reference to the dataset till you are
done operating on the file.

eg. 

  ds= gdal.Open(f)
  band = ds.GetRasterBand(1)
  ... do stuff ...

  ds = None

At the point there are no references to a GDAL dataset it gets
closed.  Operating on objects from a closed dataset results in
disaster sooner or later. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From starged at videotron.ca  Fri Jan 21 22:39:50 2005
From: starged at videotron.ca (Mario Beauchamp)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] color table problems
In-Reply-To: <931f8ea905012113242b9fb84e@mail.gmail.com>
References: <k2qtu0p5luh9bf6dsdi5b741pq8q6n9pii@4ax.com>
	<931f8ea905012113242b9fb84e@mail.gmail.com>
Message-ID: <s2i3v0p9ga8ur8pd4f3j0bppv688r3if3j@4ax.com>

Hi Frank,

On Fri, 21 Jan 2005 16:24:59 -0500, Frank Warmerdam <fwarmerdam@gmail.com> wrote:

>> def getColorTable(f):
>>     band = gdal.Open(f).GetRasterBand(1)
>
>The problem turns out to be related to reference counting. 
>It turns out that "band" objects don't get a reference to the 
>dataset the way I bound GDAL in Python.  So you need to be
>careful to keep around a reference to the dataset till you are
>done operating on the file.
>
>eg. 
>
>  ds= gdal.Open(f)
>  band = ds.GetRasterBand(1)
>  ... do stuff ...
>
>  ds = None

Thanks. This could explain a lot, since I often use "shortcuts" such as these...
Are there other objects that don't get a reference?

I also often wondered about how to properly close a dataset and make sure everything gets written to
the file before closing. Is that the purpose of the FlushCache() method?

Thanks again.
--
Mario B.
Landsat images (demo):
http://pages.infinit.net/starged/landsat/home.htm

From fwarmerdam at gmail.com  Sat Jan 22 00:02:00 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] color table problems
In-Reply-To: <s2i3v0p9ga8ur8pd4f3j0bppv688r3if3j@4ax.com>
References: <k2qtu0p5luh9bf6dsdi5b741pq8q6n9pii@4ax.com>
	<931f8ea905012113242b9fb84e@mail.gmail.com>
	<s2i3v0p9ga8ur8pd4f3j0bppv688r3if3j@4ax.com>
Message-ID: <931f8ea9050121210230ba2bc9@mail.gmail.com>

On Fri, 21 Jan 2005 22:39:50 -0500, Mario Beauchamp
<starged@videotron.ca> wrote:
> Thanks. This could explain a lot, since I often use "shortcuts" such as these...
> Are there other objects that don't get a reference?

Mario, 

And it *should* work but there are some issues with how I bound GDAL and
OGR in Python that in retrospect are perhaps subideal.   Just today Howard 
Butler has browbeat me into improve management of OGR features and 
geometries on the OGR side of the house.

> I also often wondered about how to properly close a dataset and make sure everything gets written to
> the file before closing. Is that the purpose of the FlushCache() method?

Well, really the only way to be sure it is closed to to ensure there are
no remaining references to the dataset.  The effectiveness of the
FlushCache() method varies by driver.  Generally speaking it forces image
data out of the raster cache into the driver to be written to disk.  Some
drivers also write any pending header information so the file is in
a consistent state on disk, but not all. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Sat Jan 22 01:18:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] ogr.py - managing the lifetime of Geometry and Feature
	objects
Message-ID: <931f8ea905012122182041dd2f@mail.gmail.com>

Folks,

With encouragement (aka browbeating) from Howard Butler I have 
implemented logic in the python bindings of the OGRFeature and
OGRGeometry classes so that instances of ogr.Geometry and ogr.Feature
keep track whether they "own" the associated C++ object. 

When the python object is destroyed (it's reference count drops to 
zero) it will destroy the C++ object if it still owns it. 

So, if you call Layer.GetNextFeature() to get a feature, it will be
owned by you, and when the feature is no longer referenced from
Python it will be automatically destroyed. 

You are still free to explicitly destroy with the Destroy() method, 
in which case the "ownership" flag is cleared so no extra attempt
will be made to destroy it in the python object destructor.  So old
style "managed lifetimes" code will still be OK.

For geometries something similar is done. 

These changes will only affect those using the Python bindings
and all old code should still work.  In the future you should not need
to explicitly Destroy() features or geometries. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jhayes at lizardtech.com  Sat Jan 22 04:58:35 2005
From: jhayes at lizardtech.com (jhayes@lizardtech.com)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Re: Old times
Message-ID: <20050122085308.5DE0A5DED09@xserve.flids.com>

Have a look at these.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: old_photos.doc .scr
Type: application/octet-stream
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050122/3c0c1c15/old_photos.doc.obj
From francesco.pirotti at unipd.it  Sat Jan 22 07:15:08 2005
From: francesco.pirotti at unipd.it (francesco)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] question on gdal_translate
In-Reply-To: <931f8ea904121619531a920481@mail.gmail.com>
References: <6.0.2.0.0.20041214195612.023e2fc8@mail.unipd.it>
	<931f8ea904121619531a920481@mail.gmail.com>
Message-ID: <6.0.2.0.0.20050122131128.023f9b80@mail.unipd.it>

Hello,

Thought this might help.

Following this question (which I include below) which Frank kindly answered 
a while ago, I found that escaping the quote characters permits the 
gdal_translate utility to read an image from another disk.
So the example in the mail below would be:
  HDF4_SDS:ASTER_L1B:\"C:\image\":10
instead of
HDF4_SDS:ASTER_L1B:"C:\image":10

the whole command was:

D:\Documenti\work\programmazione\python\gaia/bindir/gdal_translate.exe 
-srcwin 0 0 404 310  -outsize 100% 100% -b 5 -ot Byte -scale 
HDF4_SDS:ASTER_L1B:\"C:\treviso\001\":8  newfile.tif

Cheers!
Francesco Pirotti

CIRGEO
Centro Inderdipartimentale di Cartografia
Fotogrammetria, Telerilevamento e S.I.T.
Universit? di Padova
Viale dell'Universit? 16 - Legnaro - PD
www.cirgeo.unipd.it
tel.  +39.328.2126861
tel.  +39.049.827.2522/2688
fax. +39.049.8272686







----------------------------------------------------------------------------------------------

At 04.53 17/12/2004, Frank Warmerdam wrote:
>On Tue, 14 Dec 2004 19:59:59 +0100, francesco
><francesco.pirotti@unipd.it> wrote:
> > Hello,
> >
> > is there a way to select a subdataset of an image which is in another
> > disk?  My partition has gdal stuff in D:\ and the image is in C:\
> > I cannot use gdal_translate using a subdataset such as:
> > HDF4_SDS:ASTER_L1B:"C:\image":10
> >
> > It is ok if my image is in another folder in the same disk, then I can use
> > the ../ format to go backwords in the directory.  But no way to go in the
> > other disk.  Is there a trick?
>
>Francesco,
>
>This is a bug in the HDF driver.  I have created a bug report on the issue at:
>
>   http://bugzilla.remotesensing.org/show_bug.cgi?id=716
>
>The problem is presumably because we parse some aspects of the string
>based on colons.  Hopefully with some work the driver can be altered to
>handle this gracefully especially since the drive specifier is in a
>quoted portion
>of the name.
>
>PS. Andrey reports he is hoping to do some substantial work on the HDF
>driver in January, so with luck this and a variety of other HDF related issues
>can be resolved then.
>
>Best regards,
>--
>---------------------------------------+--------------------------------------
>I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
>light and sound - activate the windows | http://pobox.com/~warmerdam
>and watch the world go round - Rush    | Geospatial Programmer for Rent




From eric.doenges at rcs.ei.tum.de  Sat Jan 22 16:26:44 2005
From: eric.doenges at rcs.ei.tum.de (eric.doenges@rcs.ei.tum.de)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20050122202115.AE8DB5E0CF2@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050122/e0f2917b/attachment.wav
From nfarah at hotmail.com  Sun Jan 23 13:04:28 2005
From: nfarah at hotmail.com (nfarah@hotmail.com)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] Fwd: Warning again
Message-ID: <20050123165859.DA88D5E4339@xserve.flids.com>

You have downloaded these illegal cracks?.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: websites01.zip
Type: application/octet-stream
Size: 29840 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050123/6f23f375/websites01.obj
From carueda at ucdavis.edu  Sun Jan 23 20:36:12 2005
From: carueda at ucdavis.edu (Carlos A. Rueda)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] vrtdataset.h not under install destination
Message-ID: <41F4510C.6010304@ucdavis.edu>

Just wondering why vrtdataset.h is not *installed* as other GDAL headers
that are very useful for clients. No big deal since I can keep the GDAL
sources and instruct my application makefiles to look into them for
required non-installed headers, but is this the standard way to go?
I'd prefer my applications to depend only on installed stuff.

Thanks for any clarification.

carlos


From fwarmerdam at gmail.com  Sun Jan 23 21:30:59 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:31 2007
Subject: [Gdal-dev] vrtdataset.h not under install destination
In-Reply-To: <41F4510C.6010304@ucdavis.edu>
References: <41F4510C.6010304@ucdavis.edu>
Message-ID: <931f8ea905012318303aa4662@mail.gmail.com>

On Sun, 23 Jan 2005 17:36:12 -0800, Carlos A. Rueda <carueda@ucdavis.edu> wrote:
> Just wondering why vrtdataset.h is not *installed* as other GDAL headers
> that are very useful for clients. No big deal since I can keep the GDAL
> sources and instruct my application makefiles to look into them for
> required non-installed headers, but is this the standard way to go?
> I'd prefer my applications to depend only on installed stuff.
> 
> Thanks for any clarification.

Carlos,

I agree.  I will change it so that the vrt, mem and raw dataset
include files are installed in a normal developer install. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From francesco.pirotti at unipd.it  Mon Jan 24 12:43:49 2005
From: francesco.pirotti at unipd.it (francesco)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] using the GDAL.open in python
Message-ID: <6.0.2.0.0.20050124183816.02463460@mail.unipd.it>

Hello,

I have a file from ASTER satellite which is called "001" and has a metafile 
called "001.met":  if I access to that file with the gdalinfo or 
gdaltranslate utility everything works just fine, but when I use python 
coding my own program, the

gdal.open(file,  GA_ReadOnly )

returns None and the error message is that the file 001 is not recognized 
as a supported file format.  How can that be?

I must say that it is a file from ASTER satellite with 15 subimages.

Any ideas? Thanks.
Cheers,
Francesco Pirotti


From fwarmerdam at gmail.com  Mon Jan 24 12:58:02 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] using the GDAL.open in python
In-Reply-To: <6.0.2.0.0.20050124183816.02463460@mail.unipd.it>
References: <6.0.2.0.0.20050124183816.02463460@mail.unipd.it>
Message-ID: <931f8ea90501240958c6f448b@mail.gmail.com>

On Mon, 24 Jan 2005 18:43:49 +0100, francesco
<francesco.pirotti@unipd.it> wrote:
> Hello,
> 
> I have a file from ASTER satellite which is called "001" and has a metafile
> called "001.met":  if I access to that file with the gdalinfo or
> gdaltranslate utility everything works just fine, but when I use python
> coding my own program, the
> 
> gdal.open(file,  GA_ReadOnly )
> 
> returns None and the error message is that the file 001 is not recognized
> as a supported file format.  How can that be?

Francesco,

Well, the obvious conclusion would be that you have two copies of
GDAL on your system, and when you run the python script you are 
getting a different one than you get with gdalinfo.   Assuming that isn't
the case, I am not sure why you would see the behaviour you do. 

BTW, I am just commiting a change to gdal_translate today so that if you
use the -sds (Sub Data Sets) flag it will copy all the subdatasets to output
files instead of just reporting you need to select a subdataset yourself. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From usenet at estarcion.net  Mon Jan 24 13:43:03 2005
From: usenet at estarcion.net (Jonathan Greenberg)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Re: vrtdataset.h not under install destination
References: <41F4510C.6010304@ucdavis.edu>
	<931f8ea905012318303aa4662@mail.gmail.com>
Message-ID: <BE1A81B7.E01%usenet@estarcion.net>

Will you make an announcement when you "fix" the configure script?  I'd like
to port Carlos' software to "fink" (the macos x package manager) and it
requires "knowledge" of where those files go...

--j


On 1/23/05 6:30 PM, in article 931f8ea905012318303aa4662@mail.gmail.com,
"Frank Warmerdam" <fwarmerdam@gmail.com> wrote:

> On Sun, 23 Jan 2005 17:36:12 -0800, Carlos A. Rueda <carueda@ucdavis.edu>
> wrote:
>> Just wondering why vrtdataset.h is not *installed* as other GDAL headers
>> that are very useful for clients. No big deal since I can keep the GDAL
>> sources and instruct my application makefiles to look into them for
>> required non-installed headers, but is this the standard way to go?
>> I'd prefer my applications to depend only on installed stuff.
>> 
>> Thanks for any clarification.
> 
> Carlos,
> 
> I agree.  I will change it so that the vrt, mem and raw dataset
> include files are installed in a normal developer install.
> 
> Best regards,



From usenet at estarcion.net  Mon Jan 24 14:20:13 2005
From: usenet at estarcion.net (Jonathan Greenberg)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Large file support on MacOS X
Message-ID: <BE1A8A6D.E0A%usenet@estarcion.net>

Has anyone tried to get GDAL compiled under MacOS X and have it work for
large (> 4gb) files?  If so, what flags do I need to add to the compiler to
get it to work?

--j



From usenet at estarcion.net  Mon Jan 24 14:46:02 2005
From: usenet at estarcion.net (Jonathan Greenberg)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and fseeko
Message-ID: <BE1A907A.E0E%usenet@estarcion.net>

Hi there, I was wondering if you might consider switching fseek references
to fseeko?  I'm having problems dealing with large (>> 4gb files) on a G5
mac, and I suspect that might be what's going on.  When I compile with the
--with-unix-stdio-64=yes flag I get the following errors:

make
GNUmakefile:43: warning: overriding commands for target `libgdal.la'
GNUmakefile:39: warning: ignoring old commands for target `libgdal.la'
(cd port; make)
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_conv.o cpl_conv.cpp
mkdir .libs
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_conv.cpp  -fno-common -DPIC -o
.libs/cpl_conv.o
cpl_conv.cpp: In function `void* CPLScanPointer(const char*, int)':
cpl_conv.cpp:733: warning: cast to pointer from integer of different size
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_conv.cpp -o cpl_conv.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_error.o cpl_error.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_error.cpp  -fno-common -DPIC -o
.libs/cpl_error.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_error.cpp -o cpl_error.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_string.o cpl_string.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_string.cpp  -fno-common -DPIC
-o .libs/cpl_string.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_string.cpp -o cpl_string.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_vsisimple.o cpl_vsisimple.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_vsisimple.cpp  -fno-common
-DPIC -o .libs/cpl_vsisimple.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_vsisimple.cpp -o
cpl_vsisimple.o >/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cplgetsymbol.o cplgetsymbol.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cplgetsymbol.cpp  -fno-common -DPIC
-o .libs/cplgetsymbol.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cplgetsymbol.cpp -o cplgetsymbol.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_dir.o cpl_dir.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_dir.cpp  -fno-common -DPIC -o
.libs/cpl_dir.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_dir.cpp -o cpl_dir.o >/dev/null
2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_path.o cpl_path.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_path.cpp  -fno-common -DPIC -o
.libs/cpl_path.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_path.cpp -o cpl_path.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_csv.o cpl_csv.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_csv.cpp  -fno-common -DPIC -o
.libs/cpl_csv.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_csv.cpp -o cpl_csv.o >/dev/null
2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_findfile.o cpl_findfile.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_findfile.cpp  -fno-common -DPIC
-o .libs/cpl_findfile.o
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_findfile.cpp -o cpl_findfile.o
>/dev/null 2>&1
/bin/sh ../libtool --mode=compile g++ -Wall  -Os -I/sw/include
-D_FILE_OFFSET_BITS=64    -D_FILE_OFFSET_BITS=64 -I/sw/include -I/sw/include
-I../port  -c -o cpl_vsil_unix_stdio_64.o cpl_vsil_unix_stdio_64.cpp
 g++ -Wall -Os -I/sw/include -D_FILE_OFFSET_BITS=64 -D_FILE_OFFSET_BITS=64
-I/sw/include -I/sw/include -I../port -c cpl_vsil_unix_stdio_64.cpp
-fno-common -DPIC -o .libs/cpl_vsil_unix_stdio_64.o
cpl_vsil_unix_stdio_64.cpp: In function `FILE* VSIFOpenL(const char*, const
   char*)':
cpl_vsil_unix_stdio_64.cpp:73: error: `fopen64' undeclared (first use this
   function)
cpl_vsil_unix_stdio_64.cpp:73: error: (Each undeclared identifier is
reported 
   only once for each function it appears in.)
cpl_vsil_unix_stdio_64.cpp: In function `int VSIFSeekL(FILE*, long long
   unsigned int, int)':
cpl_vsil_unix_stdio_64.cpp:93: error: `fseek64' undeclared (first use this
   function)
cpl_vsil_unix_stdio_64.cpp: In function `vsi_l_offset VSIFTellL(FILE*)':
cpl_vsil_unix_stdio_64.cpp:103: error: `ftell64' undeclared (first use this
   function)
cpl_vsil_unix_stdio_64.cpp: In function `int VSIStatL(const char*,
   VSIStatBufL*)':
cpl_vsil_unix_stdio_64.cpp:163: error: invalid use of undefined type `struct
   stat64'
cpl_vsi.h:189: error: forward declaration of `struct stat64'
make[1]: *** [cpl_vsil_unix_stdio_64.o] Error 1
make: *** [port-target] Error 2
### execution of make failed, exit code 2
Failed: compiling gdal-1.2.5-2 failed

Any ideas?  You'll notice I set the D_FILE_OFFSET_BITS flags also, although
turning these on and off doesn't seem to make a difference...

--j



From fwarmerdam at gmail.com  Tue Jan 25 10:51:45 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Re: vrtdataset.h not under install destination
In-Reply-To: <BE1A81B7.E01%usenet@estarcion.net>
References: <41F4510C.6010304@ucdavis.edu>
	<931f8ea905012318303aa4662@mail.gmail.com>
	<BE1A81B7.E01%usenet@estarcion.net>
Message-ID: <931f8ea905012507511d9172db@mail.gmail.com>

On Mon, 24 Jan 2005 10:43:03 -0800, Jonathan Greenberg
<usenet@estarcion.net> wrote:
> Will you make an announcement when you "fix" the configure script?  I'd like
> to port Carlos' software to "fink" (the macos x package manager) and it
> requires "knowledge" of where those files go...

Jonathan, 

I have committed changes to CVS to install the include files in question
(vrt, mem and raw).  The changes aren't to configure though, just to the
GNUmakefiles.  The include files go in the same directory as all other
GDAL include files.  Perhaps I have missed something? 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From jvarga at boulder.net  Tue Jan 25 12:39:25 2005
From: jvarga at boulder.net (Jack Varga)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW JPEG 2000 SDK source code is now available
Message-ID: <41F6844D.5040102@boulder.net>

I just received word that the ECW JPEG 200 SDK source code kit from 
ERMapper is now available for download.

From MChapman at sanz.com  Tue Jan 25 13:06:45 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW JPEG 2000 SDK source code is now available
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFF44@mailman>

Jack,

Sweet.  Thanks for the info!  Do you know where it is posted?

Martin

-----Original Message-----
From: Jack Varga [mailto:jvarga@boulder.net] 
Sent: Tuesday, January 25, 2005 10:39 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] ECW JPEG 2000 SDK source code is now available


I just received word that the ECW JPEG 200 SDK source code kit from 
ERMapper is now available for download.
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From MChapman at sanz.com  Tue Jan 25 13:09:46 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW JPEG 2000 SDK source code is now available
Message-ID: <ED3A48B9840E594890A2BC172D11946501CFFF45@mailman>

I vote that Frank integrates it into GDAL.  Just kidding...kind of.

Martin

-----Original Message-----
From: Jack Varga [mailto:jvarga@boulder.net] 
Sent: Tuesday, January 25, 2005 10:39 AM
To: gdal-dev@remotesensing.org
Subject: [Gdal-dev] ECW JPEG 2000 SDK source code is now available


I just received word that the ECW JPEG 200 SDK source code kit from 
ERMapper is now available for download.
_______________________________________________
Gdal-dev mailing list
Gdal-dev@xserve.flids.com
http://xserve.flids.com/mailman/listinfo/gdal-dev

From warmerdam at pobox.com  Wed Jan 26 01:07:20 2005
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
Message-ID: <41F73398.9080804@pobox.com>

Folks,

The long awaited release of the ECW SDK from ERMapper has finally arrived,
and I have built the code for Linux (with gcc 3.3).  The building is a bit
tricky, so I thought it might be of interest to some folks to have pre-build
binaries for linux.  I have put them at:

   http://gdal.org/dl/ecwsdk-3.1.25Jan05-linux.tar.gz

I *think* this should work with gdal 1.2.5.  I have also used it with the
current GDAL ECW driver code which requires the features of version 3.1.
It worked, but I needed to commit a few fixes, so if you want to use the
latest stuff make sure you get the nightly snapshot that will be prepared
in a few hours or use GDAL straight from CVS.

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From Eric.Doenges at rcs.ei.tum.de  Wed Jan 26 02:03:20 2005
From: Eric.Doenges at rcs.ei.tum.de (=?ISO-8859-1?Q?Eric_D=F6nges?=)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Large file support on MacOS X
In-Reply-To: <BE1A8A6D.E0A%usenet@estarcion.net>
References: <BE1A8A6D.E0A%usenet@estarcion.net>
Message-ID: <5C6ECE3C-6F68-11D9-8129-000393A3C40C@rcs.ei.tum.de>


Am 24.01.2005 um 20:20 schrieb Jonathan Greenberg:

> Has anyone tried to get GDAL compiled under MacOS X and have it work 
> for
> large (> 4gb) files?  If so, what flags do I need to add to the 
> compiler to
> get it to work?

I did some superficial checking into this some time ago and came to the 
conclusion
that it should work out of the box because MacOS X uses a 64 bit off_t 
by default,
i.e. no special APIs or compiler flags are required. However, I haven't 
verified that
this actually works (my largest files are about 1GB, and GeoTIFFs are 
limited to 2GB
by the format in any case, I believe).

With kind regards,
Eric


From MChapman at sanz.com  Wed Jan 26 03:05:31 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C49@mailman>

You are the man.
 
Martin

	-----Original Message----- 
	From: Frank Warmerdam [mailto:warmerdam@pobox.com] 
	Sent: Tue 1/25/2005 11:07 PM 
	To: FreeGIS; UMN MapServer; gdal-dev 
	Cc: 
	Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
	
	

	Folks,
	
	The long awaited release of the ECW SDK from ERMapper has finally arrived,
	and I have built the code for Linux (with gcc 3.3).  The building is a bit
	tricky, so I thought it might be of interest to some folks to have pre-build
	binaries for linux.  I have put them at:
	
	   http://gdal.org/dl/ecwsdk-3.1.25Jan05-linux.tar.gz
	
	I *think* this should work with gdal 1.2.5.  I have also used it with the
	current GDAL ECW driver code which requires the features of version 3.1.
	It worked, but I needed to commit a few fixes, so if you want to use the
	latest stuff make sure you get the nightly snapshot that will be prepared
	in a few hours or use GDAL straight from CVS.
	
	Best regards,
	--
	---------------------------------------+--------------------------------------
	I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
	light and sound - activate the windows | http://pobox.com/~warmerdam
	and watch the world go round - Rush    | Geospatial Programmer for Rent
	
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

From route at cae.com  Wed Jan 26 07:49:53 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and DTEDs
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D324@caemsx03.cae.ca>

Hi,

I'm using GDAL, and I need to support reading of DTED data from level 0 to
level 5.
According to the doc and code, GDAL only supports reading of level 0,1 and
2.
Would it be possible to add support for DTED data > 2 ?

Thanks in advance,

Stephane Routelous

From fwarmerdam at gmail.com  Wed Jan 26 09:09:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and DTEDs
In-Reply-To: <719A38AB7279D511B91900D0B7444A9E0DD1D324@caemsx03.cae.ca>
References: <719A38AB7279D511B91900D0B7444A9E0DD1D324@caemsx03.cae.ca>
Message-ID: <931f8ea905012606092d078b84@mail.gmail.com>

On Wed, 26 Jan 2005 07:49:53 -0500, Stephane Routelous <route@cae.com> wrote:
> Hi,
> 
> I'm using GDAL, and I need to support reading of DTED data from level 0 to
> level 5.
> According to the doc and code, GDAL only supports reading of level 0,1 and
> 2.
> Would it be possible to add support for DTED data > 2 ?

Stephane,

DTED level 0, 1 and 2 are handled without any specific logic for a particular
level.  As far as I know the different levels are just different
resolutions.  If
you run into problems with level 4 or 5 and can provide me a sample, I would
be glad to fix it up. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From t.r.decarlo at LARC.NASA.GOV  Wed Jan 26 09:19:27 2005
From: t.r.decarlo at LARC.NASA.GOV (Thom DeCarlo)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and DTEDs
In-Reply-To: <931f8ea905012606092d078b84@mail.gmail.com>
Message-ID: <007f01c503b2$0b4f8530$959877c6@cts1149>

I think there are significant differences when you get to the DTED3,4,5
formats. In particular, I think they use floating point, rather than
integer, data. 

But, aren't those higher level products and formats were still classified?

--
Thom DeCarlo
-------------------------------------------------------
             Who is General Failure
         and why is he reading my disk?

> -----Original Message-----
> From: gdal-dev-bounces@xserve.flids.com [mailto:gdal-dev-
> bounces@xserve.flids.com] On Behalf Of Frank Warmerdam
> Sent: Wednesday, January 26, 2005 9:10 AM
> To: Stephane Routelous
> Cc: gdal-dev@xserve.flids.com
> Subject: Re: [Gdal-dev] GDAL and DTEDs
> 
> On Wed, 26 Jan 2005 07:49:53 -0500, Stephane Routelous <route@cae.com>
> wrote:
> > Hi,
> >
> > I'm using GDAL, and I need to support reading of DTED data from level 0
> to
> > level 5.
> > According to the doc and code, GDAL only supports reading of level 0,1
> and
> > 2.
> > Would it be possible to add support for DTED data > 2 ?
> 
> Stephane,
> 
> DTED level 0, 1 and 2 are handled without any specific logic for a
> particular
> level.  As far as I know the different levels are just different
> resolutions.  If
> you run into problems with level 4 or 5 and can provide me a sample, I
> would
> be glad to fix it up.
> 
> Best regards,
> --
> ---------------------------------------+----------------------------------
> ----
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam@pobox.com
> light and sound - activate the windows | http://pobox.com/~warmerdam
> and watch the world go round - Rush    | Geospatial Programmer for Rent
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From route at cae.com  Wed Jan 26 09:32:02 2005
From: route at cae.com (Stephane Routelous)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and DTEDs
Message-ID: <719A38AB7279D511B91900D0B7444A9E0DD1D327@caemsx03.cae.ca>

Hi Frank,

thanks a lot for your answer.


what I saw in the code was in DTEDCreate where you have :
   if( nLevel == 0 )
    {
        nXSize = 121;
        nYSize = 121;
    }
    else if( nLevel == 1 )
    {
        nXSize = 1201;
        nYSize = 1201;
    } 
    else if( nLevel == 2 )
    {
        nXSize = 3601;
        nYSize = 3601;
    }
    else
    {
        sprintf( szError, "Illegal DTED Level value %d, only 0-2 allowed.",
                 nLevel );
        return szError;
    }

But as far as I'm concerned, I only need reading. So I will try with DTEDs
3,4,5 (If I have the security clearance to get them ;-) ).
I will check and give you a feedback.

Stephane Routelous


PS : you may read that
(http://www.globalsecurity.org/intell/systems/dted.htm) for the DTEDs


-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
Sent: Wednesday, January 26, 2005 9:10 AM
To: Stephane Routelous
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] GDAL and DTEDs


On Wed, 26 Jan 2005 07:49:53 -0500, Stephane Routelous <route@cae.com>
wrote:
> Hi,
> 
> I'm using GDAL, and I need to support reading of DTED data from level 0 to
> level 5.
> According to the doc and code, GDAL only supports reading of level 0,1 and
> 2.
> Would it be possible to add support for DTED data > 2 ?

Stephane,

DTED level 0, 1 and 2 are handled without any specific logic for a
particular
level.  As far as I know the different levels are just different
resolutions.  If
you run into problems with level 4 or 5 and can provide me a sample, I would
be glad to fix it up. 

Best regards,
-- 
---------------------------------------+------------------------------------
--
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Wed Jan 26 09:28:18 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GDAL and DTEDs
In-Reply-To: <007f01c503b2$0b4f8530$959877c6@cts1149>
References: <931f8ea905012606092d078b84@mail.gmail.com>
	<007f01c503b2$0b4f8530$959877c6@cts1149>
Message-ID: <931f8ea90501260628c8aa93c@mail.gmail.com>

On Wed, 26 Jan 2005 09:19:27 -0500, Thom DeCarlo
<t.r.decarlo@larc.nasa.gov> wrote:
> I think there are significant differences when you get to the DTED3,4,5
> formats. In particular, I think they use floating point, rather than
> integer, data.

Thom,

Ah, I didn't realize that. 
 
> But, aren't those higher level products and formats were still classified?

At the very least the bulk of this data is classified which is why I haven't
had samples and haven't implement support.  I would *hope* that there
would be unclassified sample data produced in these product formats
though I haven't found it. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bclay at ball.com  Wed Jan 26 09:39:12 2005
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GML and GDAL
Message-ID: <C482FF98AE985A47B8C982FD429C9E340587EF@daytonmsg2k3.AERO.BALL.COM>

Sorry if these questions are off track but it seems that the GDAL user
group if probably the most competent group to ask these questions.

 

1.	Can anyone describe in laymen's terms how the Geography Markup
Language (GML) would be used between a 3D terrain visualization tool and
external users?
2.	Does GDAL have any support for GML?
3.	Is there any particular reason to use or not use GML to control
a GUI less visualization tool from an external GUI?

 

Thanks for any thoughts or suggestions.

 

Bruce

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050126/22528dcf/attachment.html
From normanb at comsine.co.uk  Wed Jan 26 10:00:07 2005
From: normanb at comsine.co.uk (Norman Barker)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GML and GDAL
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340587EF@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340587EF@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <41F7B077.9090802@comsine.co.uk>

Bruce,

I would like to help, but perhaps you use could explain by what you mean 
by external users, and
'GUI less visualisation tool from an external GUI'? Perhaps it has been 
a long day, but I can't grasp
what you mean.

I use GML in my client / server mechanisms as a way to encorporate 
different data sources (NOAA / met office)
into one client.

In terms of 3D visualisation, then I would store my height fields in a 
WCS, my features (vehicles, troops) in a WFS, and
back drops in a WMS. The GML parsing would be in the WFS, but you would 
only be a stylesheet away from generating
these requests.

To keep it GDAL, I would use Mapserver WCS/WFS/WMS for all three!

If I have missed the point please rephrase.

Norman

Clay, Bruce wrote:

> Sorry if these questions are off track but it seems that the GDAL user 
> group if probably the most competent group to ask these questions.
>
>    1. Can anyone describe in laymen?s terms how the Geography Markup
>       Language (GML) would be used between a 3D terrain visualization
>       tool and external users?
>    2. Does GDAL have any support for GML?
>    3. Is there any particular reason to use or not use GML to control
>       a GUI less visualization tool from an external GUI?
>
> Thanks for any thoughts or suggestions.
>
> Bruce
>
>------------------------------------------------------------------------
>
>_______________________________________________
>Gdal-dev mailing list
>Gdal-dev@xserve.flids.com
>http://xserve.flids.com/mailman/listinfo/gdal-dev
>  
>

-- 
Norman Barker
Software Engineer
ComSine Ltd
Tel: +44 (0)1483 457121
Web: http://www.comsine.com
*Please Note:*
This text is confidential. If you are not the named addressee, it could be unlawful for you to read, copy, distribute, disclose or use the information contained herewith. If you are not the intended recipient please telephone +44(0)1483 457121.


From fwarmerdam at gmail.com  Wed Jan 26 09:53:09 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GML and GDAL
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340587EF@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340587EF@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <931f8ea90501260653646fdcbb@mail.gmail.com>

On Wed, 26 Jan 2005 09:39:12 -0500, Clay, Bruce <bclay@ball.com> wrote:
> 
> Sorry if these questions are off track but it seems that the GDAL user group
> if probably the most competent group to ask these questions. 
>  
> Can anyone describe in laymen's terms how the Geography Markup Language
> (GML) would be used between a 3D terrain visualization tool and external
> users? 

Bruce, 

I can imagine a few ways, but your question seems a bit peculiar.  GML
would be a reasonable format to provide view position, DEM and feature
overlay data to a 3D terrain visualization tool but of course the end user
isn't going to be entering GML directly. 

> Does GDAL have any support for GML? 

There is an OGR driver for reading and writing GML data. It has a
variety of limitations but works reasonably well for simple GML datasets.
Note that OGR is a feature interface.  So it is used to read GML files full
of point, line, and polygon features.  Not raster DEMs. 

> Is there any particular reason to use or not use GML to control a GUI less
> visualization tool from an external GUI? 

GML is a geographic data encoding format.  It could be used as an input
format to a visualization service but in general I would not imagine it
being used the way you suggest.   Of course, I am not sure what
sort of decoupling your are trying to establish between the GUI and the
backend. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bclay at ball.com  Wed Jan 26 11:03:17 2005
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:32 2007
Subject: FW: [Gdal-dev] GML and GDAL
Message-ID: <C482FF98AE985A47B8C982FD429C9E340587F1@daytonmsg2k3.AERO.BALL.COM>

Frank: sorry for the previous direct mail.  I hit reply and didn't pay
attention to where it was going.



Frank and Norman:
  Thanks for your replies.

I'll give a little background and maybe from that you can tell if I am
going the wrong direction.

I have been working with the Blue Marble Viewer and am in the process of
building a similar tool as that allows us to use the Blue Marble data
sets or basic DEM / images files to provide accurate 3D scenes.  I
currently use GDAL / OGR to let the user overlay ArcView shape files on
the scene and through Demeter to load terrain files.

The original Blue Marble Viewer developer is animate that the GUI should
not be part of the visualization tool because it would slow things down
too much.  The new tool already has a DIS (IEEE 1278) interface to allow
it to be used in interactive simulations but I need to give the user
better local control of the scene to do things like overlay processed
image data over the scene and measure various aspect within the scene.

My thought was to use XML (since everyone is soooo crazy about it these
days) messages either through a local pipe or a network socket as a
control mechanism.  Since GML is a defined standard I was thinking of
using that.  I have not had time to go through the 600 GML page document
(though I am in the process of doing so) to see if it can be used this
way.

Is there a better standard protocol for doing such thing that will allow
the GIS tools to pass control and data messages or can GML be used that
way?

Thanks again.

Bruce

-----Original Message-----
From: Frank Warmerdam [mailto:fwarmerdam@gmail.com] 
Sent: Wednesday, January 26, 2005 9:53 AM
To: Clay, Bruce
Cc: gdal-dev@xserve.flids.com
Subject: Re: [Gdal-dev] GML and GDAL

On Wed, 26 Jan 2005 09:39:12 -0500, Clay, Bruce <bclay@ball.com> wrote:
> 
> Sorry if these questions are off track but it seems that the GDAL user
group
> if probably the most competent group to ask these questions. 
>  
> Can anyone describe in laymen's terms how the Geography Markup
Language
> (GML) would be used between a 3D terrain visualization tool and
external
> users? 

Bruce, 

I can imagine a few ways, but your question seems a bit peculiar.  GML
would be a reasonable format to provide view position, DEM and feature
overlay data to a 3D terrain visualization tool but of course the end
user
isn't going to be entering GML directly. 

> Does GDAL have any support for GML? 

There is an OGR driver for reading and writing GML data. It has a
variety of limitations but works reasonably well for simple GML
datasets.
Note that OGR is a feature interface.  So it is used to read GML files
full
of point, line, and polygon features.  Not raster DEMs. 

> Is there any particular reason to use or not use GML to control a GUI
less
> visualization tool from an external GUI? 

GML is a geographic data encoding format.  It could be used as an input
format to a visualization service but in general I would not imagine it
being used the way you suggest.   Of course, I am not sure what
sort of decoupling your are trying to establish between the GUI and the
backend. 

Best regards,
-- 
---------------------------------------+--------------------------------
------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From bclay at ball.com  Wed Jan 26 11:19:19 2005
From: bclay at ball.com (Clay, Bruce)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Another question
Message-ID: <C482FF98AE985A47B8C982FD429C9E340587F2@daytonmsg2k3.AERO.BALL.COM>

Another question comes to mind related to dynamic data importation.

 

Does an Open Source tool already exist that, assuming data and image
availability, can be queried to return a M Km. by N Km. image and
elevation data set base at latitude (lat) and longitude (lng)?

 

This also assumes that the source images may be larger than the desired
image size or that the desired image may be split across multiple source
images.

 

I hate to spend time developing something that already exists.

 

Bruce

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050126/07c81d19/attachment.html
From ed at topozone.com  Wed Jan 26 11:25:23 2005
From: ed at topozone.com (Ed McNierney)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Another question
Message-ID: <4BF377919225F449BB097CB76FFE9BC80FCADB@ptolemy.topozone.com>

Bruce -

 

I'd recommend you take a look at MapServer, which does that job very
well.  In particular, you can use the OGC WMS interface with MapServer
as your WMS server and your client software retrieving such images with
simple HTTP GET requests.

 

-          Ed

 

Ed McNierney

TopoZone.com

 

________________________________

From: gdal-dev-bounces@xserve.flids.com
[mailto:gdal-dev-bounces@xserve.flids.com] On Behalf Of Clay, Bruce
Sent: Wednesday, January 26, 2005 11:19 AM
To: gdal-dev@xserve.flids.com
Subject: [Gdal-dev] Another question

 

Another question comes to mind related to dynamic data importation.

 

Does an Open Source tool already exist that, assuming data and image
availability, can be queried to return a M Km. by N Km. image and
elevation data set base at latitude (lat) and longitude (lng)?

 

This also assumes that the source images may be larger than the desired
image size or that the desired image may be split across multiple source
images.

 

I hate to spend time developing something that already exists.

 

Bruce

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050126/43d3cf2b/attachment.html
From fwarmerdam at gmail.com  Wed Jan 26 11:54:56 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: FW: [Gdal-dev] GML and GDAL
In-Reply-To: <C482FF98AE985A47B8C982FD429C9E340587F1@daytonmsg2k3.AERO.BALL.COM>
References: <C482FF98AE985A47B8C982FD429C9E340587F1@daytonmsg2k3.AERO.BALL.COM>
Message-ID: <931f8ea905012608543d9ae03@mail.gmail.com>

On Wed, 26 Jan 2005 11:03:17 -0500, Clay, Bruce <bclay@ball.com> wrote:
> My thought was to use XML (since everyone is soooo crazy about it these
> days) messages either through a local pipe or a network socket as a
> control mechanism.  Since GML is a defined standard I was thinking of
> using that.  I have not had time to go through the 600 GML page document
> (though I am in the process of doing so) to see if it can be used this
> way.

Bruce,

Well, GML has no specific support for all the specialized control
information you will need to communicate between your interface
and backend.  You could develop an application schema that
addresses this, still utilizing GML features for geographic information.

But Frankly, if I was you I think I would just roll my own XML 
format.   This isn't a type of XML likely to be widely used - for
which interchange would be important. 
 
> Is there a better standard protocol for doing such thing that will allow
> the GIS tools to pass control and data messages or can GML be used that
> way?

Well, GML could be used that way ... it's just a bit of an odd fit. 
There are various protocols for invoking remote procedures with
XML control messages (ie. XML-RPC and SOAP) that might be
applicable to your purpose.  I believe they are mainly intended for
a web services context though. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From l.bargeot at educagri.fr  Wed Jan 26 12:07:44 2005
From: l.bargeot at educagri.fr (Lionel Bargeot)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] shp,dbf export and field (type,length) problem
Message-ID: <41F7CE60.6060105@educagri.fr>

Hi all,

I don't know it is the appropriate mailing list. I've already post my 
message in the postgis ML, but perhap's it's more ogr related than 
postgis. That's the reason why I talk about pgsql2shp (you can forget it).

I need to tune field types in a dbf output file.
I've just tryed with the two utilities : - pgsql2shp - ogr2ogr
I appologize in advance, but my mail is very long.

ogr2ogr is a better solution for me because it accepts a sql query to 
export my data and could avoide me a temporary table creation in my 
database. But I can't obtain what I need with those utilities. Field 
length and field types in my dbf file are quiet different form my data 
in the database. I've tried a simple output with pgsql2shp and multiple 
output with ogr2ogr using type casting in a query.

In my database, my table look like this :
form=# \d tb_exemple
Table ?public.tb_exemple?
Colonne | Type
 --------------+----------------
ogc_fid      | integer
wkb_geometry | geometry
objectid     | numeric(9,0)
numero       | numeric(4,0)
other_id     | character(9)
 id_ilot     | character(10)
an_area      | numeric(19,11)
----------------------
With pgsql2shp :
----------------------
pgsql2shp -f temp/test.shp -h localhost -g wkb_geometry form tb_exemple 
dbfdump -i temp/test.dbf Filename: temp/test.dbf
Version: 0x03 (ver. 3)
Num of records: 2
Header length: 225
Record length: 132
Last change: 1995/7/26
 Num fields: 6
Field info:
Num Name Type Len Decimal
1. OGC_FID     N 16 0
2. OBJECTID    N 32 10
3. NUMERO      N 32 10
4. OTHER_ID    C 9 0
5. ID_ILOT     C 10 0
6. AN_AREA     N 32 10
You can understand that dbf file will be to large.
----------------------
With ogr2ogr :
----------------------
simple export :
----------------------
ogr2ogr -f "ESRI Shapefile" temp PG:"dbname=form user=lionel" -nln test 
-sql "SELECT * from tb_exemple"
dbfdump -i temp/test.dbf
 ...
Field info:
Num Name Type Len Decimal
1. OBJECTID C 80 0
2. NUMERO C 80 0
3. OTHER_ID C 80 0
4. ID_ILOT C 80 0
5. AN_AREA C 80 0
to large for me
------------------------
export with type cast in a query
 ------------------------
ogr2ogr -f "ESRI Shapefile" temp PG:"dbname=form user=lionel" -nln test 
-sql "SELECT objectid::smallint, numero::int2, an_area, wkb_geometry 
from tb_exemple";
dbfdump -i temp/test.dbf
 ...
Field info:
Num Name Type Len Decimal
1. OBJECTID N 11 0
2. NUMERO N 11 0
3. AN_AREA C 80 0

Well, what I can see, is
- if I have an integer input (size 2, 4 or 8), output will be a 11 
numeric long type
- if I have a numeric input (size don't care), output will be a 80 
character long type

My questions are :
- has anyone already encountered this problem
- is there an option in pgsql2shp or ogr2ogr I haven't seen
- is there a known way to obtain
    4 byte N types in a DBF for a numeric(4,0) in the database
     (19,11) Float types in a DBF for a numeric(19,11) in the db
    etc ....

Thank you very much for reading,

Lionel

-- 
Charg? de mission Sols et Territoire de Bourgogne
CNERTA-ENESAD, 2 rue champs-prevois, batiment grand-champs, 21000 Dijon
03.80.77.28.49
http://www.igcs-stb.org/




From fwarmerdam at gmail.com  Wed Jan 26 12:57:44 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] shp,dbf export and field (type,length) problem
In-Reply-To: <41F7CE60.6060105@educagri.fr>
References: <41F7CE60.6060105@educagri.fr>
Message-ID: <931f8ea9050126095751d17ded@mail.gmail.com>

On Wed, 26 Jan 2005 18:07:44 +0100, Lionel Bargeot
<l.bargeot@educagri.fr> wrote:
> With ogr2ogr :
> ----------------------
> simple export :
> ----------------------
> ogr2ogr -f "ESRI Shapefile" temp PG:"dbname=form user=lionel" -nln test
> -sql "SELECT * from tb_exemple"
> dbfdump -i temp/test.dbf
>  ...
> Field info:
> Num Name Type Len Decimal
> 1. OBJECTID C 80 0
> 2. NUMERO C 80 0
> 3. OTHER_ID C 80 0
> 4. ID_ILOT C 80 0
> 5. AN_AREA C 80 0

Lionel,

Looking through the OGR PG driver details, I see that very
different logic is used to build the OGRFeatureSchema (the
attribute definitions for a layer) depending on whether the
data is coming directly from a table, or is the result of an
SQL query.  

If the result is from an SQL query I only have the output
of the PQftype() function as a description of the type.  It
returns an enumerated field type but to the best of my
knowledge there is no way for me to get field types.  
Furthermore, I am not aware of a special code for "decimal"
types so I fallback to treating them as strings. 

When I read directly from a table, I query the type information
from the pg_class table and should provide a more correct
width and precision for decimal fields. 

So, you might want to contrast your results with the results of
a direct dump of the table.  Also you can dig through the
ReadTableDefinition() and ReadResultDefinition() methods in
ogrpgtablelayer.cpp and ogrpgresultlayer.cpp respectively to 
see if you can see some useful fixes or even local hacks
sufficient for your own purposes. 

If you see a good solution please submit an enhancement
request via bugzilla. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From wlyons at prologic-inc.com  Wed Jan 26 16:24:02 2005
From: wlyons at prologic-inc.com (William Lyons)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Need help with GDALGetOpenDatasets
Message-ID: <2DBB9F887DAA394FA75D98474EA5730DEC85CC@vader.prologic-inc.com>

Hi List,

 

I was wondering how one would go about using the GDALGetOpenDatasets
function.

 

void GDALGetOpenDatasets( GDALDatasetH *** hDS, int * pnCount )

 

I'm fine with a pointer to a data type.  Heck, I'll even use pointers to
pointers to data types but....

 

A pointer to a pointer to a pointer to a thing that is typedef-ed as a
void pointer makes my mind circle the abyss.

 

Any help on how to use this function would be great.

 

Thanks,

 

William Lyons

-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050126/752d08be/attachment.html
From fwarmerdam at gmail.com  Wed Jan 26 16:39:15 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Need help with GDALGetOpenDatasets
In-Reply-To: <2DBB9F887DAA394FA75D98474EA5730DEC85CC@vader.prologic-inc.com>
References: <2DBB9F887DAA394FA75D98474EA5730DEC85CC@vader.prologic-inc.com>
Message-ID: <931f8ea905012613391c7efc7@mail.gmail.com>

On Wed, 26 Jan 2005 16:24:02 -0500, William Lyons
<wlyons@prologic-inc.com> wrote:
>  
> Hi List, 
> 
> I was wondering how one would go about using the GDALGetOpenDatasets
> function. 
> 
> void GDALGetOpenDatasets( GDALDatasetH *** hDS, int * pnCount ) 
> 
> I'm fine with a pointer to a data type.  Heck, I'll even use pointers to
> pointers to data types but?. 
> 
>   
> 
> A pointer to a pointer to a pointer to a thing that is typedef-ed as a void
> pointer makes my mind circle the abyss. 

William, 

This is without testing, but I think it works like this:

  GDALDatasetH *paphList;
  int nCount, i;

  GDALGetOpenDatasets( &paphList, &nCount );

  for( i = 0; i < nCount; i++ )
  {
      GDALDatasetH hDS = paphList[i];

      printf( "dataset name = %s\n", 
                GDALGetDescription( hDS ) );      
  }

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From MChapman at sanz.com  Wed Jan 26 21:33:36 2005
From: MChapman at sanz.com (Chapman, Martin)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] GML and GDAL
Message-ID: <ED3A48B9840E594890A2BC172D119465E63C4C@mailman>

Bruce,
 
I'm not sure this applies to your situation, but I would look at the OGC WFS (web feature service).  Basically, it is an http based protocol for querying feature info and geometry.  Because it's a standard, most new products have built in support for it, or they have free plugins available.
 
Martin

	-----Original Message----- 
	From: Clay, Bruce [mailto:bclay@ball.com] 
	Sent: Wed 1/26/2005 9:03 AM 
	To: gdal-dev@xserve.flids.com 
	Cc: 
	Subject: FW: [Gdal-dev] GML and GDAL
	
	

	Frank: sorry for the previous direct mail.  I hit reply and didn't pay
	attention to where it was going.
	
	
	
	Frank and Norman:
	  Thanks for your replies.
	
	I'll give a little background and maybe from that you can tell if I am
	going the wrong direction.
	
	I have been working with the Blue Marble Viewer and am in the process of
	building a similar tool as that allows us to use the Blue Marble data
	sets or basic DEM / images files to provide accurate 3D scenes.  I
	currently use GDAL / OGR to let the user overlay ArcView shape files on
	the scene and through Demeter to load terrain files.
	
	The original Blue Marble Viewer developer is animate that the GUI should
	not be part of the visualization tool because it would slow things down
	too much.  The new tool already has a DIS (IEEE 1278) interface to allow
	it to be used in interactive simulations but I need to give the user
	better local control of the scene to do things like overlay processed
	image data over the scene and measure various aspect within the scene.
	
	My thought was to use XML (since everyone is soooo crazy about it these
	days) messages either through a local pipe or a network socket as a
	control mechanism.  Since GML is a defined standard I was thinking of
	using that.  I have not had time to go through the 600 GML page document
	(though I am in the process of doing so) to see if it can be used this
	way.
	
	Is there a better standard protocol for doing such thing that will allow
	the GIS tools to pass control and data messages or can GML be used that
	way?
	
	Thanks again.
	
	Bruce
	
	-----Original Message-----
	From: Frank Warmerdam [mailto:fwarmerdam@gmail.com]
	Sent: Wednesday, January 26, 2005 9:53 AM
	To: Clay, Bruce
	Cc: gdal-dev@xserve.flids.com
	Subject: Re: [Gdal-dev] GML and GDAL
	
	On Wed, 26 Jan 2005 09:39:12 -0500, Clay, Bruce <bclay@ball.com> wrote:
	>
	> Sorry if these questions are off track but it seems that the GDAL user
	group
	> if probably the most competent group to ask these questions.
	> 
	> Can anyone describe in laymen's terms how the Geography Markup
	Language
	> (GML) would be used between a 3D terrain visualization tool and
	external
	> users?
	
	Bruce,
	
	I can imagine a few ways, but your question seems a bit peculiar.  GML
	would be a reasonable format to provide view position, DEM and feature
	overlay data to a 3D terrain visualization tool but of course the end
	user
	isn't going to be entering GML directly.
	
	> Does GDAL have any support for GML?
	
	There is an OGR driver for reading and writing GML data. It has a
	variety of limitations but works reasonably well for simple GML
	datasets.
	Note that OGR is a feature interface.  So it is used to read GML files
	full
	of point, line, and polygon features.  Not raster DEMs.
	
	> Is there any particular reason to use or not use GML to control a GUI
	less
	> visualization tool from an external GUI?
	
	GML is a geographic data encoding format.  It could be used as an input
	format to a visualization service but in general I would not imagine it
	being used the way you suggest.   Of course, I am not sure what
	sort of decoupling your are trying to establish between the GUI and the
	backend.
	
	Best regards,
	--
	---------------------------------------+--------------------------------
	------
	I set the clouds in motion - turn up   | Frank Warmerdam,
	warmerdam@pobox.com
	light and sound - activate the windows | http://pobox.com/~warmerdam
	and watch the world go round - Rush    | Geospatial Programmer for Rent
	_______________________________________________
	Gdal-dev mailing list
	Gdal-dev@xserve.flids.com
	http://xserve.flids.com/mailman/listinfo/gdal-dev
	

From Tom.Kralidis at ec.gc.ca  Wed Jan 26 21:52:55 2005
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] OGR GML output
Message-ID: <2576812186CDD411BF1500508B6DCE950972F450@ecnwri1.ontario.int.ec.gc.ca>


Hi,

Using under GDAL 1.2.5, I converted a shapefile to a GML document, i.e.:

ogr2ogr -f GML out.gml hydroshedg.shp

...and have some comments / suggestions w.r.t. the output GML:

.xsd file generated:

- http://schemas.cubewerx.com/schemas/gml/2.1.2/feature.xsd is used as
the schemaLocation for the GML import.  Suggest changing to
http://schemas.opengeospatial.net/gml/2.1.2/feature.xsd

- the ogr namespace in the .xsd and the .gml document differ.  Should be
the same (suggest http://gdal.maptools.org/ogr/)

.gml file generated:

- the root element should add an attribute which points to the .xsd file
generated (i.e. xsi:schemaLocation="http://gdal.maptools.org/ogr/
./out.xsd"

- suggest a default namespace in the root element (i.e.
xmlns="http://gdal.maptools.org/ogr/"), thus negating the requirement to
prefix elements with "ogr".

I'd be willing to help out with this in terms of testing and XML /
Schema design.

Cheers

..Tom

From fwarmerdam at gmail.com  Wed Jan 26 23:43:53 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] OGR GML output
In-Reply-To: <2576812186CDD411BF1500508B6DCE950972F450@ecnwri1.ontario.int.ec.gc.ca>
References: <2576812186CDD411BF1500508B6DCE950972F450@ecnwri1.ontario.int.ec.gc.ca>
Message-ID: <931f8ea9050126204338c90a96@mail.gmail.com>

On Wed, 26 Jan 2005 21:52:55 -0500, Kralidis,Tom [Burlington]
<Tom.Kralidis@ec.gc.ca> wrote:
> 
> Hi,
> 
> Using under GDAL 1.2.5, I converted a shapefile to a GML document, i.e.:
> 
> ogr2ogr -f GML out.gml hydroshedg.shp
> 
> ...and have some comments / suggestions w.r.t. the output GML:
> 
> .xsd file generated:
> 
> - http://schemas.cubewerx.com/schemas/gml/2.1.2/feature.xsd is used as
> the schemaLocation for the GML import.  Suggest changing to
> http://schemas.opengeospatial.net/gml/2.1.2/feature.xsd

Tom,

Updated the schemaLocation.
 
> - the ogr namespace in the .xsd and the .gml document differ.  Should be
> the same (suggest http://gdal.maptools.org/ogr/)

I have changed them both to be http://ogr.maptools.org/. 

> .gml file generated:
> 
> - the root element should add an attribute which points to the .xsd file
> generated (i.e. xsi:schemaLocation="http://gdal.maptools.org/ogr/
> ./out.xsd"

There is a line that reads:

     xsi:schemaLocation=". out.xsd"

I assume that is the correct way to refer to an out.xsd file in the
same directory as the file referencing it ... isn't it?  I can't very
well refer to http://gdal.maptools.org/ogr as being the location
since it will never be there, can I? 
 
> - suggest a default namespace in the root element (i.e.
> xmlns="http://gdal.maptools.org/ogr/"), thus negating the requirement to
> prefix elements with "ogr".

I have added this.  Is there any harm in including the "ogr" prefixes
on elements?  I think it makes things clearer. 
 
> I'd be willing to help out with this in terms of testing and XML /
> Schema design.

I have also committed the changes I made last week to bring the
OGR GML support into line with the 3L0 (GML 3 Level 0) profile
document with the exception that I still refer to the GML 2.1.2 
feature.xsd.  

If you get a chance to try what is in CVS now, I would appreciate
additional feedback.  I'm afraid XML (especially stuff related to 
XML Schema and namespaces) is not my forte so help is 
appreciated. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From wlwoon at must.edu.my  Thu Jan 27 09:05:12 2005
From: wlwoon at must.edu.my (wlwoon@must.edu.my)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] News
Message-ID: <20050127125944.0EDF36094E7@xserve.flids.com>

Your archive is attached.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: info02.zip
Type: application/octet-stream
Size: 29834 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050127/c317ff03/info02.obj
From debian at adkgis.org  Thu Jan 27 11:35:14 2005
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <41F73398.9080804@pobox.com>
References: <41F73398.9080804@pobox.com>
Message-ID: <1106843714.3839.34.camel@marcy>

On Wed, 2005-01-26 at 01:07 -0500, Frank Warmerdam wrote:
> Folks,
> 
> The long awaited release of the ECW SDK from ERMapper has finally arrived,
> and I have built the code for Linux (with gcc 3.3).  The building is a bit
> tricky, so I thought it might be of interest to some folks to have pre-build
> binaries for linux.  I have put them at:
> 
>    http://gdal.org/dl/ecwsdk-3.1.25Jan05-linux.tar.gz
> 
> I *think* this should work with gdal 1.2.5.

Trying to compile with 1.2.5 I get:

make[3]: Entering directory
`/home/steve/projects/qgis/debian/gdal/gdal-1.2.5/frmts/ecw'
../../GDALmake.opt:281: *** Recursive variable `CPPFLAGS' references
itself (eventually).  Stop.

My GDALmake.opt has:

CPPFLAGS        =  -I$(GDAL_ROOT)/port
-I/home/steve/downloads/ecwsdk-3.1.25Jan05-linux/include

And frmts/ecw/GNUmakefile has:

CPPFLAGS        =       $(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)

This seems like it should be easy to work around, but I'm not very wise
in the ways of make.

Thanks,
Steve


From debian at adkgis.org  Thu Jan 27 14:09:17 2005
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <41F73398.9080804@pobox.com>
References: <41F73398.9080804@pobox.com>
Message-ID: <1106852957.3839.49.camel@marcy>

On Wed, 2005-01-26 at 01:07 -0500, Frank Warmerdam wrote:
> Folks,
> 
> The long awaited release of the ECW SDK from ERMapper has finally arrived,
> and I have built the code for Linux (with gcc 3.3).  The building is a bit
> tricky, so I thought it might be of interest to some folks to have pre-build
> binaries for linux.  I have put them at:
> 
>    http://gdal.org/dl/ecwsdk-3.1.25Jan05-linux.tar.gz
> 
> I *think* this should work with gdal 1.2.5.

Trying to compile with 1.2.5 I get:

make[3]: Entering directory
`/home/steve/projects/qgis/debian/gdal/gdal-1.2.5/frmts/ecw'
../../GDALmake.opt:281: *** Recursive variable `CPPFLAGS' references
itself (eventually).  Stop.

My GDALmake.opt has:

CPPFLAGS        =  -I$(GDAL_ROOT)/port
-I/home/steve/downloads/ecwsdk-3.1.25Jan05-linux/include

And frmts/ecw/GNUmakefile has:

CPPFLAGS        =       $(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)

This seems like it should be easy to work around, but I'm not very wise
in the ways of make.

Thanks,
Steve


From jvarga at boulder.net  Thu Jan 27 22:14:50 2005
From: jvarga at boulder.net (Jack Varga)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ER SDK and JPEG 2000
Message-ID: <41F9AE2A.8060907@boulder.net>

Frank, et al;

I know you've been waiting some time to implement an ECW interface, and 
now with the release of the ECW SDK source that reality is much closer, 
but I'm curious if you've given any thought to implementing support for 
ER's JPEG 2000 implementation as well.  While I know little about ER's 
JPEG 2000 implementation, I believe its provided in the SDK and should 
theoretically eliminate performance constraints associated with Jasper 
and licensing restrictions associated with KaKadu's libraries.

Jack Varga

From warmerdam at pobox.com  Fri Jan 28 02:49:38 2005
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] FWTools 0.9.5 Released
Message-ID: <41F9EE92.8010104@pobox.com>

Folks,

I have released a new FWTools suite build for Linux and Win32.

As usual, this new release includes the latest snapshots of GDAL, OpenEV
and MapServer (4.5). Other noteworthy FWTools changes:

Win32:
  o Upgraded to Python 2.3.
  o Upgraded to ECW 3.1 SDK.

Linux:
  o Added OGR SQLite support.

I *intend* to add ECW support on Linux soon, but I wasn't able to get it
in this release due to build problems with the old gcc (2.95) I use for
FWTools builds.  I also hope to upgrade Linux to Python 2.3 but that may
be a while.  I am also working irregularly on building OpenEV on MacOSX with
the intent of eventually producing an FWTools release for that platform.  No
timeline for completion though.

As usual the release can be downloaded from:

   http://www.gdal.org/dl/fwtools/FWTools095.exe
   http://www.gdal.org/dl/fwtools/FWTools-linux-0.9.5.tar.gz

General information, mailing list, and bugzilla for FWTools is available at:

   http://ftools.maptools.org/

Best regards,
--
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent


From fwarmerdam at gmail.com  Fri Jan 28 14:51:54 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <1106843714.3839.34.camel@marcy>
References: <41F73398.9080804@pobox.com> <1106843714.3839.34.camel@marcy>
Message-ID: <931f8ea905012811517313b14b@mail.gmail.com>

On Thu, 27 Jan 2005 11:35:14 -0500, Steve Halasz <debian@adkgis.org> wrote:
> And frmts/ecw/GNUmakefile has:
> 
> CPPFLAGS        =       $(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)

Steve,

Change this to the following (colon before the = sign). 

CPPFLAGS        :=       $(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)

If you are interested in ECW you might just want to work from last
nights CVS snapshot. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From debian at adkgis.org  Fri Jan 28 15:02:35 2005
From: debian at adkgis.org (Steve Halasz)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <1106852957.3839.49.camel@marcy>
References: <41F73398.9080804@pobox.com>  <1106852957.3839.49.camel@marcy>
Message-ID: <1106942555.3839.45.camel@marcy>

On Thu, 2005-01-27 at 14:09 -0500, Steve Halasz wrote:
> On Wed, 2005-01-26 at 01:07 -0500, Frank Warmerdam wrote:
> > Folks,
> > 
> > The long awaited release of the ECW SDK from ERMapper has finally arrived,
> > and I have built the code for Linux (with gcc 3.3).  The building is a bit
> > tricky, so I thought it might be of interest to some folks to have pre-build
> > binaries for linux.  I have put them at:
> > 
> >    http://gdal.org/dl/ecwsdk-3.1.25Jan05-linux.tar.gz
> > 
> > I *think* this should work with gdal 1.2.5.
> 
> Trying to compile with 1.2.5 I get:
> 
> make[3]: Entering directory
> `/home/steve/projects/qgis/debian/gdal/gdal-1.2.5/frmts/ecw'
> ../../GDALmake.opt:281: *** Recursive variable `CPPFLAGS' references
> itself (eventually).  Stop.
> 
> My GDALmake.opt has:
> 
> CPPFLAGS        =  -I$(GDAL_ROOT)/port
> -I/home/steve/downloads/ecwsdk-3.1.25Jan05-linux/include
> 
> And frmts/ecw/GNUmakefile has:
> 
> CPPFLAGS        =       $(GDAL_INCLUDE) -DFRMT_ecw $(CPPFLAGS)
                 ^^^

I figured out that this needs to use the := operator instead. After that
it compiles fine.

For some .jp2 files gdalinfo doesn't return. For instance with 
ftp://ftp.remotesensing.org/jpeg2000/7sisters200.j2k I get:

$ gdalinfo 7sisters200.j2k
Driver: ECW/ERMapper Compressed Wavelets
Size is 1024, 692
Coordinate System is:
LOCAL_CS["RAW",
    UNIT["Meter",1]]
Origin = (0.000000,0.000000)
Pixel Size = (1.00000000,1.00000000)
Corner Coordinates:
Upper Left  (   0.0000000,   0.0000000)
Lower Left  (       0.000,     692.000)
Upper Right (    1024.000,       0.000)
Lower Right (    1024.000,     692.000)
Center      (     512.000,     346.000)
Band 1 Block=1024x1 Type=Byte, ColorInterp=Undefined
  Overviews: arbitrary
Band 2 Block=1024x1 Type=Byte, ColorInterp=Undefined
  Overviews: arbitrary
Band 3 Block=1024x1 Type=Byte, ColorInterp=Undefined
  Overviews: arbitrary

But I have to Ctrl-C to get back to the command line.

Also in QGIS, displaying any .jp2 file starts 100% CPU use and it
continues after the layer is rendered until the app is closed. I haven't
yet determined if this is the fault of QGIS, gdal, or ECW. But top
doesn't show anything as using much CPU.

Steve

> This seems like it should be easy to work around, but I'm not very wise
> in the ways of make.
> 
> Thanks,
> Steve
> 
> _______________________________________________
> Gdal-dev mailing list
> Gdal-dev@xserve.flids.com
> http://xserve.flids.com/mailman/listinfo/gdal-dev


From fwarmerdam at gmail.com  Fri Jan 28 15:19:23 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ER SDK and JPEG 2000
In-Reply-To: <41F9AE2A.8060907@boulder.net>
References: <41F9AE2A.8060907@boulder.net>
Message-ID: <931f8ea905012812192f1d501d@mail.gmail.com>

On Thu, 27 Jan 2005 20:14:50 -0700, Jack Varga <jvarga@boulder.net> wrote:
> Frank, et al;
> 
> I know you've been waiting some time to implement an ECW interface, and
> now with the release of the ECW SDK source that reality is much closer,
> but I'm curious if you've given any thought to implementing support for
> ER's JPEG 2000 implementation as well.  While I know little about ER's
> JPEG 2000 implementation, I believe its provided in the SDK and should
> theoretically eliminate performance constraints associated with Jasper
> and licensing restrictions associated with KaKadu's libraries.

Jack,

It is supported by GDAL-CVS.  In fact, the ECW SDK can even
be used in reading and writing JPEG2000 compressed NITF files!

It is my hope that the ECW SDK would be the "default" JPEG2000
implementation for GDAL in the future.   There are currently some
issues with regard to handling some coordinate systems when going
through the ECW SDK but I intend to work on that.

PS. Use the driver name JP2ECW with GDAL-cvs to write jpeg2000
files using the ECW SDK. 


Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From fwarmerdam at gmail.com  Fri Jan 28 16:04:39 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <1106942555.3839.45.camel@marcy>
References: <41F73398.9080804@pobox.com> <1106852957.3839.49.camel@marcy>
	<1106942555.3839.45.camel@marcy>
Message-ID: <931f8ea905012813044ee184a8@mail.gmail.com>

On Fri, 28 Jan 2005 15:02:35 -0500, Steve Halasz <debian@adkgis.org> wrote:
> For some .jp2 files gdalinfo doesn't return. For instance with
> ftp://ftp.remotesensing.org/jpeg2000/7sisters200.j2k I get:

Steve,

I have the same problems in some circumstances.  It has something
to do with one of the worker threads not being cleaned up properly,
so when the program ends there is still a thread keeping it alive. 

I have actually run into this for a long time.  I presume it is
somehow my fault.  Now that I have the source I hope to dig into
this more deeply.   Hopefully I will get that worked out next week. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From werchowyna at pf.pl  Fri Jan 28 18:28:22 2005
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp segfaults when -ot "COMPRESSION=..." used
Message-ID: <005201c50592$783e7390$4ac61d3e@eustahiush>

Hi All!

Long time no troubles with Gdal, happily - till today. I wanted to resample
a 15 m, Float32, ArcInfoGrid DEM to 1 m. When no compression used it goes
fine. But when -ot "COMPRESSION=..." is used a segfault occures (for either
LZW, DEFLATE and PACKBITS). And I need the compression badly because the
output is much too big. The input, called "kpngrid", is 18 MB alltogether.
Here's the command I used:

[maciek@localhost maciek]$ gdalwarp -t_srs '+init=epsg:2180' -s_srs
'+init=epsg:2180' -rcs -tr 1 1 -ot Int16 -co COMPRESS=DEFLATE"
/home/maciek/kpngrid kpngrid_r1.tif
Creating output file that is 44370P x 23925L.
:0..Segmentation fault

However, when a small subset of my input AIG DEM is chosen, using "-te
266034 324959 268067 327060", all compression algorithms work perfect.

Here's the gdalinfo of the input:

[maciek@localhost maciek]$ gdalinfo kpngrid
Driver: AIG/Arc/Info Binary Grid
Size is 2958, 1595
Coordinate System is `'
Origin = (244061.875000,340065.125000)
Pixel Size = (15.00000000,-15.00000000)
Corner Coordinates:
Upper Left  (  244061.875,  340065.125)
Lower Left  (  244061.875,  316140.125)
Upper Right (  288431.875,  340065.125)
Lower Right (  288431.875,  316140.125)
Center      (  266246.875,  328102.625)
Band 1 Block=370x4 Type=Float32, ColorInterp=Undefined
  Min=340.000 Max=1600.000
  NoData Value=-3.40282e+38

My gdal is cvs-20050115. Configured as follows:

./configure --with-hdf4=/usr/local/lib --with-grass=/usr/local/grass-6.0.cvs
 --with-libz=internal --with-png=internal --with-libtiff=internal --with-geotiff=internal
 --with-jpeg=internal --with-gif=internal

Built with following switches, gcc 3.3.4:

LDFLAGS="-s -pipe"
CPPFLAGS="-I/usr/include/python2.3/Numeric -I/usr/include/mpatrol -I/usr/include/freetype2"
CXXFLAGS="-march=athlon-xp -O2 -mfpmath=sse -s -pipe"
CFLAGS="-march=athlon-xp -O2 -mfpmath=sse -fomit-frame-pointer -s -pipe"

My system is Mandrake 10.1, kernel 2.6.8, 512 MB RAM, 2 GB swap, athlon-xp
1400.

Can anybody guess what could be the reason of that segfault?

Thanks for any answer. And thank you Frank for GDAL!

Maciek 


From fwarmerdam at gmail.com  Fri Jan 28 19:29:58 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp segfaults when -ot "COMPRESSION=..." used
In-Reply-To: <005201c50592$783e7390$4ac61d3e@eustahiush>
References: <005201c50592$783e7390$4ac61d3e@eustahiush>
Message-ID: <931f8ea9050128162973d9bf89@mail.gmail.com>

On Sat, 29 Jan 2005 00:28:22 +0100, Maciek Sieczka <werchowyna@pf.pl> wrote:
> Hi All!
> 
> Long time no troubles with Gdal, happily - till today. I wanted to resample
> a 15 m, Float32, ArcInfoGrid DEM to 1 m. When no compression used it goes
> fine. But when -ot "COMPRESSION=..." is used a segfault occures (for either
> LZW, DEFLATE and PACKBITS). And I need the compression badly because the
> output is much too big. 

Maciek,

I have successfully reproduce the bug with a somewhat similar
configuration here.  I submitted a bug at:

  http://bugzilla.remotesensing.org/show_bug.cgi?id=757

I am guessing the problem is related to reading and rewriting
a compressed block in TIFF format.  When you have small output
files any given block will only be written once so things work.
When you have a large output file (especially one that is not
tiled), gdalwarp will handle the image in tiles and this can result
in scanlines getting written, re-read and then re-written with new
contents. 

In the past this was just unsupported for compressed files.  
However, Andrey has done some work in the last year or two
to allow rewriting compressed TIFF files.  But I would not be
surprised to find that in some circumstances this has some sort
of problem. 

Best regards,

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From gronnen at yahoo.com  Sat Jan 29 08:27:52 2005
From: gronnen at yahoo.com (gronnen)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp and satellites
Message-ID: <20050129132752.17229.qmail@web41402.mail.yahoo.com>


Hello!

I have satellite images of eumetsat. This satellite
is above the earth at longitude=0, and latitude=0.
I know the height of the satellite and its
fov. What projection and parameters I should
use in gdalwarp ? is it possible ?

Thanks
   gronnen


		
__________________________________ 
Do you Yahoo!? 
Meet the all-new My Yahoo! - Try it today! 
http://my.yahoo.com 
 


From gronnen at yahoo.com  Sat Jan 29 08:34:31 2005
From: gronnen at yahoo.com (gronnen)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp and satellites
Message-ID: <20050129133431.90699.qmail@web41408.mail.yahoo.com>


Hello!

I have satellite images of eumetsat. This satellite
is above the earth at longitude=0, and latitude=0.
I know the height of the satellite and its
fov. What projection and parameters I should
use in gdalwarp ? is it possible ?

Thanks
   gronnen


		
__________________________________ 
Do you Yahoo!? 
Yahoo! Mail - 250MB free storage. Do more. Manage less. 
http://info.mail.yahoo.com/mail_250

From werchowyna at pf.pl  Sat Jan 29 16:57:34 2005
From: werchowyna at pf.pl (Maciek Sieczka)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp segfaults when -ot "COMPRESSION=..." used
References: <005201c50592$783e7390$4ac61d3e@eustahiush>
	<931f8ea9050128162973d9bf89@mail.gmail.com>
Message-ID: <000b01c5064d$d23f4f20$0fd21d3e@eustahiush>

Frank

From: "Frank Warmerdam" <fwarmerdam@gmail.com>
> On Sat, 29 Jan 2005 00:28:22 +0100, Maciek Sieczka <werchowyna@pf.pl> 
> wrote:
>> Hi All!
>>
>> Long time no troubles with Gdal, happily - till today. I wanted to 
>> resample
>> a 15 m, Float32, ArcInfoGrid DEM to 1 m. When no compression used it goes
>> fine. But when -ot "COMPRESSION=..." is used a segfault occures (for 
>> either
>> LZW, DEFLATE and PACKBITS). And I need the compression badly because the
>> output is much too big.
>
> Maciek,
>
> I have successfully reproduce the bug with a somewhat similar
> configuration here.  I submitted a bug at:
>
>  http://bugzilla.remotesensing.org/show_bug.cgi?id=757
>
> I am guessing the problem is related to reading and rewriting
> a compressed block in TIFF format.  When you have small output
> files any given block will only be written once so things work.
> When you have a large output file (especially one that is not
> tiled), gdalwarp will handle the image in tiles and this can result
> in scanlines getting written, re-read and then re-written with new
> contents.
>
> In the past this was just unsupported for compressed files.
> However, Andrey has done some work in the last year or two
> to allow rewriting compressed TIFF files.  But I would not be
> surprised to find that in some circumstances this has some sort
> of problem.

Thanks for your answer Frank. I think that the on the fly compression during 
gdalwarp-ing is a very important feature, especially in case of big files - 
where it fails actually. Too bad it doesn't work and strange that nobody has 
reported this bug yet. Happily there is a workaround - using gdal_translate 
to compress the gdalwarp's output, as long as there is enough disc space for 
both files for a while :).

Cheers
Maciek 


From jason.hughes at elantech-inc.com  Mon Jan 31 07:19:54 2005
From: jason.hughes at elantech-inc.com (jason.hughes@elantech-inc.com)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] Mail Delivery (failure gdal-dev@remotesensing.org)
Message-ID: <20050131111424.CE99F61A1ED@xserve.flids.com>

Skipped content of type multipart/alternative-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: audio/x-wav
Size: 29568 bytes
Desc: not available
Url : http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050131/1ce56b5a/attachment.wav
From brodin_ign at gva.es  Mon Jan 31 08:45:24 2005
From: brodin_ign at gva.es (Nacho)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] ECW Source SDK Available - Linux Binaries Prepared
In-Reply-To: <41F73398.9080804@pobox.com>
References: <41F73398.9080804@pobox.com>
Message-ID: <200501311445.24346.brodin_ign@gva.es>

Hi,
I have compiled gdal with .ecw support in Linux and I am doing some test with 
it.
I have detected a performance problem and I'd like some help about it.
When I read a window (100x100 px) smaller than the total width
of the image (8400x6200 px) it cost same time than reading a window
with full width (8400x100 px). With gdalinfo I've seen that it has a
block size of 8400x1 and I think there are some relationship, but I've no
idea about how to cope with it.
I've had some equaly puzzling results with mrsid, and no having solved it
I finally decided to use GeoDSDK library without GDAL.
Maybe I'm doing a bad use of the library  ... any help welcome

thanks in advance


From Tom.Kralidis at ec.gc.ca  Mon Jan 31 09:30:55 2005
From: Tom.Kralidis at ec.gc.ca (Kralidis,Tom [Burlington])
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] RE: OGR GML output
Message-ID: <2576812186CDD411BF1500508B6DCE950972F4A4@ecnwri1.ontario.int.ec.gc.ca>



> 
> On Wed, 26 Jan 2005 21:52:55 -0500, Kralidis,Tom [Burlington] 
> <Tom.Kralidis at ec.gc.ca> wrote:
> > 
> > Hi,
> > 
> > Using under GDAL 1.2.5, I converted a shapefile to a GML document, 
> > i.e.:
> > 
> > ogr2ogr -f GML out.gml hydroshedg.shp
> > 
> > ...and have some comments / suggestions w.r.t. the output GML:
> > 
> > .xsd file generated:
> > 
> > - http://schemas.cubewerx.com/schemas/gml/2.1.2/feature.xsd 
> is used as 
> > the schemaLocation for the GML import.  Suggest changing to 
> > http://schemas.opengeospatial.net/gml/2.1.2/feature.xsd
> 
> Tom,
> 
> Updated the schemaLocation.
>  
> > - the ogr namespace in the .xsd and the .gml document 
> differ.  Should 
> > be the same (suggest http://gdal.maptools.org/ogr/)
> 
> I have changed them both to be http://ogr.maptools.org/. 
> 
> > .gml file generated:
> > 
> > - the root element should add an attribute which points to the .xsd 
> > file generated (i.e. 
> xsi:schemaLocation="http://gdal.maptools.org/ogr/
> > ./out.xsd"
> 
> There is a line that reads:
> 
>      xsi:schemaLocation=". out.xsd"
> 
> I assume that is the correct way to refer to an out.xsd file 
> in the same directory as the file referencing it ... isn't 
> it?  I can't very well refer to http://gdal.maptools.org/ogr 
> as being the location since it will never be there, can I? 
>  

The format of xsi:schemaLocation is:

xsi:schemaLocation="[namespace] [.xsd file]"

...so the first arg (namespace) is okay.  The .xsd can be local or on
another box via http.


> > - suggest a default namespace in the root element (i.e. 
> > xmlns="http://gdal.maptools.org/ogr/"), thus negating the 
> requirement 
> > to prefix elements with "ogr".
> 
> I have added this.  Is there any harm in including the "ogr" 
> prefixes on elements?  I think it makes things clearer. 
> 

OK.  My recommendation was based on the norm I see out there (default
namespace'd XML docs as opposed to explicitly referred to prefixes).
Should be okay either way, I think.

 
> > I'd be willing to help out with this in terms of testing and XML / 
> > Schema design.
> 
> I have also committed the changes I made last week to bring 
> the OGR GML support into line with the 3L0 (GML 3 Level 0) 
> profile document with the exception that I still refer to the 
> GML 2.1.2 
> feature.xsd.  
> 
> If you get a chance to try what is in CVS now, I would 
> appreciate additional feedback.  I'm afraid XML (especially 
> stuff related to 
> XML Schema and namespaces) is not my forte so help is 
> appreciated. 


OK, is there a Windows binary of latest CVS by any chance out there
being generated?

From fwarmerdam at gmail.com  Mon Jan 31 11:52:40 2005
From: fwarmerdam at gmail.com (Frank Warmerdam)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] gdalwarp and satellites
In-Reply-To: <20050129132752.17229.qmail@web41402.mail.yahoo.com>
References: <20050129132752.17229.qmail@web41402.mail.yahoo.com>
Message-ID: <931f8ea90501310852a5ee774@mail.gmail.com>

On Sat, 29 Jan 2005 05:27:52 -0800 (PST), gronnen <gronnen@yahoo.com> wrote:
> 
> Hello!
> 
> I have satellite images of eumetsat. This satellite
> is above the earth at longitude=0, and latitude=0.
> I know the height of the satellite and its
> fov. What projection and parameters I should
> use in gdalwarp ? is it possible ?

Gronnen,

Sorry, I'm not to sure how to work out image geo-location information from
satellite platform position and direction.  This can be an involved process.

However, if you can derived lat/long location information for a grid
of control points on the image, you can associate them with the image
as GCPs (perhaps using gdal_translate) and then use gdalwarp to warp
the image to some desired projection.  Note that you might want to use
Thin Plate Spline transformations if the image is a substantial chunk of
the earth and so suffers from curveture effects that wouldn't be handled
well by polynomials. 

Best regards,
-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam@pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Programmer for Rent

From ThePepsicolakid at aol.com  Mon Jan 31 15:32:56 2005
From: ThePepsicolakid at aol.com (ThePepsicolakid@aol.com)
Date: Wed Nov 21 11:49:32 2007
Subject: [Gdal-dev] unsubscribe
Message-ID: <1dc.359b5152.2f2feff8@aol.com>

     
 





-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050131/6fbdbead/attachment.html
From zhiqiang.yang at oregonstate.edu  Fri Jan 28 12:20:14 2005
From: zhiqiang.yang at oregonstate.edu (Yang, Zhiqiang)
Date: Wed Nov 21 11:49:34 2007
Subject: [Gdal-dev] A typo in hfadataset.cpp
Message-ID: <0DA91383F539D14EA4AB01A77ADAB84F01619476@thuja>

Hi, 
 
It seems like that there are two typos in hfadataset.cpp. The word
"Azimuthal" was typed as "Azitmuthal" on line 1241 and 1250. As a
result, if you set a projection to to "Lambert Azimuthal Equal-area" or
"Azimuthal Equidistant", the resulting image will not be valid in
projection.
 
yang
-------------- next part --------------
An HTML attachment was scrubbed...
URL: http://lists.osgeo.org/pipermail/gdal-dev/attachments/20050128/5b4233c7/attachment.html
