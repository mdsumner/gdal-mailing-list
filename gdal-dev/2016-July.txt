From kai.muehlbauer at uni-bonn.de  Fri Jul  1 00:03:56 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 1 Jul 2016 09:03:56 +0200
Subject: [gdal-dev] building gdal with python and libtool
In-Reply-To: <57717533.4010500@uni-bonn.de>
References: <57717533.4010500@uni-bonn.de>
Message-ID: <577615DC.4000204@uni-bonn.de>

Hi all,

I tried to reproduce this with a standard linux system. So I used my 
OpenSuse Leap42 Box.

Steps to reproduce:

1. Download gdal-2.1.0 tarball
2. extract to some folder
3. ./configure --prefix=/usr/local --with-python
4. make

This builds fine using libtool.

5. extract gdal tarball to another folder (just to be sure)
6. export CC=gcc
7. export CXX=g++
8. ./configure --prefix=/usr/local --with-python
9. make

This fails in swig/python with the error mentioned in the OP. See 
attached excerpt of the build log.

I haven't found anything related to this special problem yet. But it 
turns out, that something is happening in the combination of `configure` 
and `libtool` when CC and CXX are exported in the environment. It is 
actually working, if you add `--without-libtool` to the call to `configure`.

To come back to my OP, we are using this approach (exporting CC and CXX) 
to build different packages, but only experiencing this issue with gdal 
so far.

It would be very helpful, if gdal-devs could have a look into this.

Thanks again!

Cheers,
Kai




Am 27.06.2016 um 20:49 schrieb Kai Mühlbauer:
> Hi all,
>
> while trying to build gdal on linux (on CircleCi in a CentOS based
> docker image using conda/conda-forge) like this:
>
> ------------------------------------------------------------
> export CC=gcc
> export CXX=g++
> export CFLAGS="${CFLAGS}"
> export CXXFLAGS="${CXXFLAGS} -DBOOST_MATH_DISABLE_FLOAT128"
> export LDFLAGS="${LDFLAGS}"
> export LINKFLAGS="${LDFLAGS}"
> export CFLAGS="${CFLAGS} -m${ARCH}"
> export CXXFLAGS="${CXXFLAGS} -m${ARCH}"
>
> export LDFLAGS="$LDFLAGS -L$PREFIX/lib"
> export CPPFLAGS="$CPPFLAGS -I$PREFIX/include"
>
> ./configure --prefix=$PREFIX \
>              --with-hdf4=$PREFIX \
>              --with-hdf5=$PREFIX \
>              --with-xerces=$PREFIX \
>              --with-netcdf=$PREFIX \
>              --with-geos=$PREFIX/bin/geos-config \
>              --with-kea=$PREFIX/bin/kea-config \
>              --with-static-proj4=$PREFIX \
>              --with-libz=$PREFIX \
>              --with-png=$PREFIX \
>              --with-jpeg=$PREFIX \
>              --with-libjson-c=$PREFIX \
>              --with-expat=$PREFIX \
>              --with-freexl=$PREFIX \
>              --with-libtiff=$PREFIX \
>              --with-xml2=$PREFIX \
>              --with-openjpeg=$PREFIX \
>              --with-spatialite=$PREFIX \
>              --with-pg=$PREFIX/bin/pg_config \
>              --with-sqlite3=$PREFIX \
>              --with-curl \
>              --with-python \
>              --disable-rpath
>
> make
> make install
> -----------------------------------------------------------
>
> we are experiencing the same issue like posted here:
>
> http://www.michael-joost.de/gdal_install.html
>
> Everything works OK, until the build descends into the swig/python
> subdir, then the two compile commands work using libtool. But when it
> comes to linking, we get this error:
>
> /bin/bash -pthread -shared -L/home/sam/miniconda3/envs/_build/lib
> -Wl,-rpath=/home/sam/miniconda3/envs/_build/lib,--no-as-needed
> -L/home/sam/miniconda3/envs/_build/lib
> -L/home/sam/miniconda3/envs/_build/lib -m64 -Wall
> -Wdeclaration-after-statement -Wextra -Winit-self -Wunused-parameter
> -Wmissing-prototypes -Wmissing-declarations -Wformat
> -Werror=format-security -Wno-format-nonliteral -Wlogical-op -Wshadow
> -Werror=vla -Wdeclaration-after-statement -DOGR_ENABLED
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/conda-bld/work/gdal-2.1.0/port
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/envs/_build
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/envs/_build
> -I/home/sam/miniconda3/envs/_build/include
> -I/home/sam/miniconda3/envs/_build
> -I/home/sam/miniconda3/envs/_build/include -DGDAL_COMPILATION
> build/temp.linux-x86_64-3.4/extensions/gdal_wrap.o -L../../.libs
> -L../../ -L/home/sam/miniconda3/envs/_build/lib
> -L/home/sam/miniconda3/conda-bld/work/gdal-2.1.0/lib -lpython3.4m -lgdal
> -o build/lib.linux-x86_64-3.4/osgeo/_gdal.cpython-34m.so
> /bin/bash: -d: invalid option
> error: command '/bin/bash' failed with exit status 1
> make[2]: *** [build] Error 1
> make[2]: Leaving directory
> `/home/sam/miniconda3/conda-bld/work/gdal-2.1.0/swig/python'
> make[1]: *** [build] Error 2
> make[1]: Leaving directory
> `/home/sam/miniconda3/conda-bld/work/gdal-2.1.0/swig'
>
> Using internet search I found that it could be related to wrongly set
> environment variables. But I can't find any problems so far. Using
> configure with --without-libtool leads to stable build without errors.
>
> Although we can build gdal this way, we like to find the root cause of
> this libtool-problem. Any hints appreciated!
>
> Cheers,
> Kai
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: build.log
Type: text/x-log
Size: 4498 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160701/00e740ad/attachment.bin>

From jidanni at jidanni.org  Fri Jul  1 00:10:17 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Fri, 01 Jul 2016 15:10:17 +0800
Subject: [gdal-dev] R:  Problem using ogrlineref
References: <VI1PR0201MB1790A57E72651121E1A30E5AE75D0@VI1PR0201MB1790.eurprd02.prod.outlook.com>
Message-ID: <87oa6hsujq.fsf@jidanni.org>

I am trying to use the ogrlineref command.
I can't even understand its man page.
Maybe it only works on shapefiles.
Maybe it only Seg Faults.

How can I get the locations of the kilometer markers given only this KML:

<Placemark>
  <name>zaokeng main road 中45市道</name>
  <LineString>
    <tessellate>1</tessellate>
    <coordinates>120.86817,24.17922,0.0 120.86816,24.17922,0.0...
  </LineString>
</Placemark>

Let's say put the output into a new KML file.

OK maybe I need these redundant starting and ending points too:
<Placemark>
  <name>Start</name>
  <Point>
    <coordinates>120.86817,24.17922,0.0</coordinates>
  </Point>
</Placemark>
<Placemark>
  <name>End</name>
  <Point>
    <coordinates>120.86696,24.16733,0.0</coordinates>
  </Point>
</Placemark>

Anyway the man page is just a mishmosh to me.

Maybe if you show me how to do it, then I can figure out what "reper"
points are. They certainly aren't English. Maybe I don't need "reper"
points. Maybe I am trying to produce "reper" point.
Nobody knows.

From jidanni at jidanni.org  Fri Jul  1 00:12:48 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Fri, 01 Jul 2016 15:12:48 +0800
Subject: [gdal-dev] R:  Problem using ogrlineref
References: <VI1PR0201MB1790A57E72651121E1A30E5AE75D0@VI1PR0201MB1790.eurprd02.prod.outlook.com>
Message-ID: <87eg7dsufj.fsf@jidanni.org>

I just have a single <LineString>.
I want to put kilometer markers along it.
That is all I am trying to do.

From bishop.dev at gmail.com  Fri Jul  1 00:26:24 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Fri, 1 Jul 2016 10:26:24 +0300
Subject: [gdal-dev] R: Problem using ogrlineref
In-Reply-To: <87oa6hsujq.fsf@jidanni.org>
References: <VI1PR0201MB1790A57E72651121E1A30E5AE75D0@VI1PR0201MB1790.eurprd02.prod.outlook.com>
 <87oa6hsujq.fsf@jidanni.org>
Message-ID: <57761B20.3000801@gmail.com>

Hi Dan,

I see your tickets on debian bug tracker.
1. ogrlineref support all GDAL vector drivers with write capability
2. You didn't set -f (format) option, so default driver was set - ESRI 
shape file
3. I reproduce segmentation fault (will be fixed soon)
4. Current implementation have the only option to return distance along 
line for some geographic coordinates and coordinates for distance. So 
you need to loop every 500 meters to get what you want.
5. We tested using ogrlineref without any repers (reference point, 
milestones) and it works. You only need to add to OGRLayer three fields 
(beg type of REAL, end type of REAL and scale type of REAL).
6. KML is not good format as ogrlineref expect some attributes filled, 
but KML usually has the few attributes (NAME and Description). In that 
case ogrlineref cannot get some sensitive data from attributes.

Best regards,
     Dmitry

01.07.2016 10:10, 積丹尼 Dan Jacobson пишет:
> I am trying to use the ogrlineref command.
> I can't even understand its man page.
> Maybe it only works on shapefiles.
> Maybe it only Seg Faults.
>
> How can I get the locations of the kilometer markers given only this KML:
>
> <Placemark>
>    <name>zaokeng main road 中45市道</name>
>    <LineString>
>      <tessellate>1</tessellate>
>      <coordinates>120.86817,24.17922,0.0 120.86816,24.17922,0.0...
>    </LineString>
> </Placemark>
>
> Let's say put the output into a new KML file.
>
> OK maybe I need these redundant starting and ending points too:
> <Placemark>
>    <name>Start</name>
>    <Point>
>      <coordinates>120.86817,24.17922,0.0</coordinates>
>    </Point>
> </Placemark>
> <Placemark>
>    <name>End</name>
>    <Point>
>      <coordinates>120.86696,24.16733,0.0</coordinates>
>    </Point>
> </Placemark>
>
> Anyway the man page is just a mishmosh to me.
>
> Maybe if you show me how to do it, then I can figure out what "reper"
> points are. They certainly aren't English. Maybe I don't need "reper"
> points. Maybe I am trying to produce "reper" point.
> Nobody knows.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Fri Jul  1 02:12:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jul 2016 11:12:08 +0200
Subject: [gdal-dev] GDAL/OGR 1.11.5 RC1 Available for Review
Message-ID: <201607011112.08178.even.rouault@spatialys.com>

Hi,

As announced, I have prepared a GDAL/OGR 1.11.5 release candidate. Please 
review and test.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5RC1.tar.xz
  http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5RC1.tar.gz
  http://download.osgeo.org/gdal/1.11.5/gdal1115RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/1.11.5/gdalautotest-1.11.5.tar.gz
  http://download.osgeo.org/gdal/1.11.5/gdalautotest-1.11.5.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/1.11.5-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

2.0.3RC1 to follow, and 2.1.1RC1 as soon as I get confirmation that a yesterday 
fix is correct.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  1 02:16:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jul 2016 11:16:21 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.3 RC1 Available for Review
Message-ID: <201607011116.21611.even.rouault@spatialys.com>

And now GDAL/OGR 2.0.3 release candidate. Please 
review and test.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC1.tar.xz
  http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC1.tar.gz
  http://download.osgeo.org/gdal/2.0.3/gdal203RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3.tar.gz
  http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.0.3-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

Best regards,

Even
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  1 03:28:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jul 2016 12:28:21 +0200
Subject: [gdal-dev] GDAL/OGR 2.0.3 RC2 Available for Review
In-Reply-To: <201607011116.21611.even.rouault@spatialys.com>
References: <201607011116.21611.even.rouault@spatialys.com>
Message-ID: <201607011228.22187.even.rouault@spatialys.com>

I'm backing out RC1 to add a last minute fix for a regression introduced in 
2.0.1:
 * morphToESRI(): correctly compute standard_parallel_1 of Mercator(2SP) 
projection from scale factor of Mercator(1SP) (#6456, #4861)

Updated links:
   http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC2.tar.xz
   http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC2.tar.gz
   http://download.osgeo.org/gdal/2.0.3/gdal203RC2.zip
   http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3RC2.tar.gz
   http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3RC2.zip

Le vendredi 01 juillet 2016 11:16:21, Even Rouault a écrit :
> And now GDAL/OGR 2.0.3 release candidate. Please
> review and test.
> 
> Peek up an archive among the following ones (by ascending size):
> 
>   http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC1.tar.xz
>   http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3RC1.tar.gz
>   http://download.osgeo.org/gdal/2.0.3/gdal203RC1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
>   http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3.tar.gz
>   http://download.osgeo.org/gdal/2.0.3/gdalautotest-2.0.3.zip
> 
> The NEWS file is here :
> 
>   http://trac.osgeo.org/gdal/wiki/Release/2.0.3-News
> 
> I'll call for a vote promoting it to final in the next days if no
> serious problems are reported before.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kai.muehlbauer at uni-bonn.de  Fri Jul  1 04:17:54 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 1 Jul 2016 13:17:54 +0200
Subject: [gdal-dev] GDAL python bindings build error (gcc command
 replaced by bash)
In-Reply-To: <CANXASxMd0RyvruK3oqs9s3G-85cdkYZPBPapApuywa51khyQnw@mail.gmail.com>
References: <CANXASxMd0RyvruK3oqs9s3G-85cdkYZPBPapApuywa51khyQnw@mail.gmail.com>
Message-ID: <57765162.6010901@uni-bonn.de>

Hi James,

I did experience the same issue. See

https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044678.html

Although I did not find the root cause of this, I found that in my use 
case, copying and unsetting CC and CXX environment variables did the trick.

So what I did is:

export CF_CC=$CC
export CF_CXX=$CXX
unset CC CXX
./configure CC=$CF_CC \
             CXX=$CF_CXX \
             --prefix=$PREFIX
make

Hoping for more insight by gdal-devs.

Cheers,
Kai


Am 25.05.2016 um 17:13 schrieb James Nunn:
> Hi
>
> I'm building gdal on linux (64bit ubuntu 16) with python bindings, and I'm
> coming across a strange error right at the end of the python build steps
> where exactly 4 commands which *should* be run with `x86_64-linux-gnu-gcc`
> are instead run as `/bin/bash`.
>
> Here are the last few lines of output before the error is encountered (look
> for /bin/bash -pthread ... command after the python header warnings:
>
> make[1]: Entering directory '/home/james/src/gdal/gdal/swig'
> for dir in python ; do (cd $dir; make build) || exit; done
> make[2]: Entering directory '/home/james/src/gdal/gdal/swig/python'
> rm -f setup_vars.ini
> echo 'GNM_ENABLED=no' >> setup_vars.ini
> python setup.py build
> running build
> running build_py
> creating build
> creating build/lib.linux-x86_64-2.7
> copying gdal.py -> build/lib.linux-x86_64-2.7
> copying ogr.py -> build/lib.linux-x86_64-2.7
> copying osr.py -> build/lib.linux-x86_64-2.7
> copying gdalconst.py -> build/lib.linux-x86_64-2.7
> copying gdalnumeric.py -> build/lib.linux-x86_64-2.7
> creating build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/gnm.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/gdalnumeric.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/gdal_array.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/gdalconst.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/osr.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/__init__.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/gdal.py -> build/lib.linux-x86_64-2.7/osgeo
> copying osgeo/ogr.py -> build/lib.linux-x86_64-2.7/osgeo
> running build_ext
> building 'osgeo._gdal' extension
> creating build/temp.linux-x86_64-2.7
> creating build/temp.linux-x86_64-2.7/extensions
> x86_64-linux-gnu-gcc -pthread -DNDEBUG -g -fwrapv -O2 -Wall
> -Wstrict-prototypes -fno-strict-aliasing -Wdate-time -D_FORTIFY_SOURCE=2 -g
> -fstack-protector -Wformat -Werror=format-security -fPIC -I../../port
> -I../../gcore -I../../alg -I../../ogr/ -I../../ogr/ogrsf_frmts -I../../gnm
> -I../../apps -I/usr/include/python2.7
> -I/home/james/local/farmenv/local/lib/python2.7/site-packages/numpy/core/include
> -I/home/james/src/gdal/gdal/include -c extensions/gdal_wrap.cpp -o
> build/temp.linux-x86_64-2.7/extensions/gdal_wrap.o
> cc1plus: warning: command line option ‘-Wstrict-prototypes’ is valid for
> C/ObjC but not for C++
> In file included from /usr/include/python2.7/Python.h:133:0,
>                   from extensions/gdal_wrap.cpp:155:
> extensions/gdal_wrap.cpp: In function ‘PyObject*
> _wrap_MajorObject_SetMetadata__SWIG_0(PyObject*, PyObject*)’:
> /usr/include/python2.7/abstract.h:1354:62: warning: deprecated conversion
> from string constant to ‘char*’ [-Wwrite-strings]
>   #define PyMapping_Items(O) PyObject_CallMethod(O,"items",NULL)
>                                                                ^
> extensions/gdal_wrap.cpp:9115:31: note: in expansion of macro
> ‘PyMapping_Items’
>           PyObject *item_list = PyMapping_Items( obj1 );
>                                 ^
> /bin/bash -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions
> -Wl,-Bsymbolic-functions -Wl,-z,relro -fno-strict-aliasing -DNDEBUG -g
> -fwrapv -O2 -Wall -Wstrict-prototypes -Wdate-time -D_FORTIFY_SOURCE=2 -g
> -fstack-protector -Wformat -Werror=format-security -Wl,-Bsymbolic-functions
> -Wl,-z,relro -Wdate-time -D_FORTIFY_SOURCE=2 -g -fstack-protector -Wformat
> -Werror=format-security build/temp.linux-x86_64-2.7/extensions/gdal_wrap.o
> -L../../.libs -L../../ -L/home/james/src/gdal/gdal/lib -lgdal -o
> build/lib.linux-x86_64-2.7/osgeo/_gdal.so
> /bin/bash: -d: invalid option
> error: command '/bin/bash' failed with exit status 1
> GNUmakefile:74: recipe for target 'build' failed
> make[2]: *** [build] Error 1
> make[2]: Leaving directory '/home/james/src/gdal/gdal/swig/python'
> GNUmakefile:30: recipe for target 'build' failed
> make[1]: *** [build] Error 2
> make[1]: Leaving directory '/home/james/src/gdal/gdal/swig'
> GNUmakefile:104: recipe for target 'swig-modules' failed
> make: *** [swig-modules] Error 2
>
>
> If I manually re-run the failing commands replacing `/bin/bash` with
> `x86_64-linux-gnu-gcc`, the entire build eventually succeeds.
>
>
> Can anyone shed light on why the command is being replaced?
>
>
> Regards
>
> James
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de

From kai.muehlbauer at uni-bonn.de  Fri Jul  1 04:20:12 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 1 Jul 2016 13:20:12 +0200
Subject: [gdal-dev] make install fails
In-Reply-To: <56D81298.2040200@opengis.ch>
References: <56D81298.2040200@opengis.ch>
Message-ID: <577651EC.602@uni-bonn.de>

Hi Matthias,

I did experience the same issue. See

https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044678.html

Although I did not find the root cause of this, I found that in my use 
case, copying and unsetting CC and CXX environment variables did the trick.

So what I did is:

export CF_CC=$CC
export CF_CXX=$CXX
unset CC CXX
./configure CC=$CF_CC \
             CXX=$CF_CXX \
             --prefix=$PREFIX
make

Hoping for more insight by gdal-devs.

Cheers,
Kai

Am 03.03.2016 um 11:31 schrieb Matthias Kuhn:
> Hi,
>
> I am trying to compile and install gdal in docker (ubuntu 12.04)
> container with python3 and in a custom prefix (/home/travis/deps),
> clang-3.6 is used. configure and make run fine, however, make install fails:
>
> /bin/bash -pthread -shared -Wl,-O1 -Wl,-Bsymbolic-functions
> -Wl,-Bsymbolic-functions -Wl,-z,relro
> build/temp.linux-x86_64-3.2/extensions/osr_wrap.o -L../../.libs -L../../
> -L/usr/src/gdal-2.0.2/lib -lgdal -o
> build/lib.linux-x86_64-3.2/osgeo/_osr.cpython-32mu.so
> /bin/bash: -d: invalid option
> error: command '/bin/bash' failed with exit status 1
>
> Any idea what could be the cause for this? I am grateful for any hints!
>
> Thank you in advance,
> Matthias
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de

From marco.atzeri at gmail.com  Fri Jul  1 04:35:14 2016
From: marco.atzeri at gmail.com (Marco Atzeri)
Date: Fri, 1 Jul 2016 13:35:14 +0200
Subject: [gdal-dev] make install fails
In-Reply-To: <577651EC.602@uni-bonn.de>
References: <56D81298.2040200@opengis.ch> <577651EC.602@uni-bonn.de>
Message-ID: <7c5ba0e1-a2f6-0e9d-9d55-d9b1ef4e8b4f@gmail.com>

On 01/07/2016 13:20, Kai Muehlbauer wrote:
> Hi Matthias,
>
> I did experience the same issue. See
>
> https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044678.html
>
> Although I did not find the root cause of this, I found that in my use
> case, copying and unsetting CC and CXX environment variables did the trick.
>
> So what I did is:
>
> export CF_CC=$CC
> export CF_CXX=$CXX
> unset CC CXX
> ./configure CC=$CF_CC \
>             CXX=$CF_CXX \
>             --prefix=$PREFIX
> make
>
> Hoping for more insight by gdal-devs.
>
> Cheers,
> Kai
>

same workaround "unset CC CXX"
is implemented for cygwin package build.

   https://lists.osgeo.org/pipermail/gdal-dev/2016-April/044171.html

and it looks this bug is present by long long time

   http://www.michael-joost.de/gdal_install.html

Regards
Marco

From kai.muehlbauer at uni-bonn.de  Fri Jul  1 04:55:07 2016
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Fri, 1 Jul 2016 13:55:07 +0200
Subject: [gdal-dev] make install fails
In-Reply-To: <7c5ba0e1-a2f6-0e9d-9d55-d9b1ef4e8b4f@gmail.com>
References: <56D81298.2040200@opengis.ch> <577651EC.602@uni-bonn.de>
 <7c5ba0e1-a2f6-0e9d-9d55-d9b1ef4e8b4f@gmail.com>
Message-ID: <57765A1B.1050300@uni-bonn.de>

Hi Marco,

thanks for the reply.

Although I tried to dig up every related issue, I didn't find.

Am 01.07.2016 um 13:35 schrieb Marco Atzeri:
> On 01/07/2016 13:20, Kai Muehlbauer wrote:
>> Hi Matthias,
>>
>> I did experience the same issue. See
>>
>> https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044678.html
>>
>> Although I did not find the root cause of this, I found that in my use
>> case, copying and unsetting CC and CXX environment variables did the
>> trick.
>>
>> So what I did is:
>>
>> export CF_CC=$CC
>> export CF_CXX=$CXX
>> unset CC CXX
>> ./configure CC=$CF_CC \
>>             CXX=$CF_CXX \
>>             --prefix=$PREFIX
>> make
>>
>> Hoping for more insight by gdal-devs.
>>
>> Cheers,
>> Kai
>>
>
> same workaround "unset CC CXX"
> is implemented for cygwin package build.
>
>    https://lists.osgeo.org/pipermail/gdal-dev/2016-April/044171.html
>
> and it looks this bug is present by long long time
>
>    http://www.michael-joost.de/gdal_install.html

This is a annoying problem for quite some gdal users. With the four of 
us, who reported this problem here on the list, there is these on github:

https://github.com/LLNL/spack/issues/679
https://github.com/Homebrew/legacy-homebrew/issues/19845
https://github.com/lunar-linux/moonbase-other/pull/310

And all those unkown, who just use the workaround proposed Michael Joost.

I would really like to get some response on that from gdal-devs. (I'll 
not be nagging any more now).

Cheers,
Kai

>
> Regards
> Marco
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de

From gis.gn at libero.it  Fri Jul  1 05:20:14 2016
From: gis.gn at libero.it (Gabriele N.)
Date: Fri, 1 Jul 2016 05:20:14 -0700 (PDT)
Subject: [gdal-dev] gdal_calc.py IF ELSE Condition
In-Reply-To: <bd6aafaa-3f37-5a61-f675-39af7a0b7bb8@yahoo.it>
References: <1467293149111-5274166.post@n6.nabble.com>
 <717302eb-af8f-a49f-da32-e869ddf92d4a@yahoo.it>
 <1467294436556-5274178.post@n6.nabble.com>
 <bd6aafaa-3f37-5a61-f675-39af7a0b7bb8@yahoo.it>
Message-ID: <1467375614213-5274365.post@n6.nabble.com>

Ciao Antonio.

Now everything looks perfect.

Thank you very much


Gabriele



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-calc-py-IF-ELSE-Condition-tp5274166p5274365.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schwehr at gmail.com  Fri Jul  1 10:20:56 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 1 Jul 2016 10:20:56 -0700
Subject: [gdal-dev] Removing one of the two svn:keyword Id lines in all
	source files
Message-ID: <CACmBxysg+x9gLoFdgBSK7Bus=1PjhZK2361zj8j+t08_EJ2OuQ@mail.gmail.com>

See: https://trac.osgeo.org/gdal/ticket/6547

I propose to remove the $id line from the comments at the top of the file
for files that already have CPL_CVSID.  Having two lines means we have a
redundant copy of all this info, which is changing for every commit.

In addition, I propose to set the svn:keywords for these files to just be
Id.  Some have more and some have none.  e.g.

svn propset svn:keywords Id gdal_rpc.cpp
svn propset svn:keywords Id gdaltransformgeolocs.cpp
svn commit

https://trac.osgeo.org/gdal/changeset/34506

grep Id gdal_rpc.cpp gdaltransformgeolocs.cpp

gdal_rpc.cpp: * $Id: gdal_rpc.cpp 34506 2016-07-01 17:08:58Z goatbar $
gdal_rpc.cpp:CPL_CVSID("$Id: gdal_rpc.cpp 34506 2016-07-01 17:08:58Z
goatbar $");
gdaltransformgeolocs.cpp: * $Id: gdaltransformgeolocs.cpp 34506 2016-07-01
17:08:58Z goatbar $
gdaltransformgeolocs.cpp:CPL_CVSID("$Id: gdaltransformgeolocs.cpp 34506
2016-07-01 17:08:58Z goatbar $");

Then removing the redundant line, it becomes:

grep Id gdal_rpc.cpp gdaltransformgeolocs.cpp

gdal_rpc.cpp:CPL_CVSID("$Id: gdal_rpc.cpp 34506 2016-07-01 17:08:58Z
goatbar $");
gdaltransformgeolocs.cpp:CPL_CVSID("$Id: gdaltransformgeolocs.cpp 34506
2016-07-01 17:08:58Z goatbar $");

Why?  It's extra churn in diffs/patches and adds yet another line to check
for those of use using merge tools like meld a lot (which might just be me).

Anyone against this?  I'm proposing this just for head on trunk.

-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160701/bf816a0a/attachment.html>

From antonio.valentino at tiscali.it  Fri Jul  1 11:09:42 2016
From: antonio.valentino at tiscali.it (Antonio Valentino)
Date: Fri, 1 Jul 2016 20:09:42 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <1467355930076-5274296.post@n6.nabble.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com> <5772E306.3090504@tiscali.it>
 <1467299787210-5274192.post@n6.nabble.com> <5775583C.7090802@tiscali.it>
 <1467355930076-5274296.post@n6.nabble.com>
Message-ID: <5776B1E6.6040303@tiscali.it>

Hi Bugbuster,

Il 01/07/2016 08:52, Bugbuster ha scritto:
> Hi Antonio,
> 
> I did try the test suite you provided. I tried to convert all VRT images to
> GTiff with the simple command :
> 
> 
> None of them gave any results.

please ensure to have gdal_PIXFUN.so in the GDAL_DRIVER_PATH:

env GDAL_DRIVER_PATH=../../.. gdal_translate -of GTiff pixfun_cmul_c.vrt
pixfun_cmul_c.vrt.tif

> In each function, I added a debug message when testing the number of source
> rasters :
> 
> I always get :
> 
> 
> If you have any ideas, I would be very grateful to you :-)
> Thanks
> Philippe


regards

-- 
Antonio Valentino

From jedfrechette at gmail.com  Fri Jul  1 11:43:24 2016
From: jedfrechette at gmail.com (Jed Frechette)
Date: Fri, 1 Jul 2016 12:43:24 -0600
Subject: [gdal-dev] gdalbuildvrt 2.1.0 and off by 1 pixel display
Message-ID: <a04f78c9-ba4c-4369-7575-a810bcace30a@gmail.com>

Starting with version 2.1.0 I've started to see display errors in both
QGIS and ArcGIS for datasets built with gdalbuildvrt. In both cases, the
vrt data ends up offset by 1 pixel relative to the source files. This
offset is not consistent between applications or within the data set. My
guess is that what I'm seeing are rounding errors as a result of
Changeset 30648 [1] writing source and destination offsets and sizes as
floats rather than integers.

Here is a snippet of a VRT generated by 2.0.0::

<ComplexSource>
   <SourceFilename relativeToVRT="1">slpc/test01.tif</SourceFilename>
   <SourceBand>1</SourceBand>
   <SourceProperties RasterXSize="952" RasterYSize="1189" DataType="Byte"
BlockXSize="952" BlockYSize="8" />
   <SrcRect xOff="0" yOff="0" xSize="952" ySize="1189" />
   <DstRect xOff="0" yOff="0" xSize="952" ySize="1189" />
   <NODATA>0</NODATA>
</ComplexSource>

And the equivalent snippet generated by 2.1.0::

<ComplexSource>
   <SourceFilename relativeToVRT="1">slpc/test01.tif</SourceFilename>
   <SourceBand>1</SourceBand>
   <SourceProperties RasterXSize="952" RasterYSize="1189" DataType="Byte"
BlockXSize="952" BlockYSize="8" />
   <SrcRect xOff="0" yOff="0" xSize="952" ySize="1189" />
   <DstRect xOff="0" yOff="0" xSize="951.999999999534"
ySize="1189.00000000373" />
   <NODATA>0</NODATA>
</ComplexSource>

Both VRT files were generated in the same way::

gdalbuildvrt -tr 0.05 0.05 -tap slpc.vrt slpc/*tif

Note that the results are the same whether or not I use the -tr and -tap 
flags. Looking at other ComplexSources the DstRect offsets and sizes are 
always the values that are inconsistently rounded to integers with any 
of them potentially containing floats in the xml file. The VRT files 
were created on different systems with significantly different 
configurations so it is entirely possible that there is some local issue 
with my setup that is introducing this problem.

So I guess my first question is: Can anyone else confirm this issue? If 
so should it be considered a bug in GDAL or is up to other applications 
to adapt to this behavior?

Thanks,

[1] https://trac.osgeo.org/gdal/changeset/30648
-- 
Jed Frechette

From even.rouault at spatialys.com  Fri Jul  1 12:51:09 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jul 2016 21:51:09 +0200
Subject: [gdal-dev] gdalbuildvrt 2.1.0 and off by 1 pixel display
In-Reply-To: <a04f78c9-ba4c-4369-7575-a810bcace30a@gmail.com>
References: <a04f78c9-ba4c-4369-7575-a810bcace30a@gmail.com>
Message-ID: <201607012151.10112.even.rouault@spatialys.com>

Le vendredi 01 juillet 2016 20:43:24, Jed Frechette a écrit :
> Starting with version 2.1.0 I've started to see display errors in both
> QGIS and ArcGIS for datasets built with gdalbuildvrt. In both cases, the
> vrt data ends up offset by 1 pixel relative to the source files. This
> offset is not consistent between applications or within the data set. My
> guess is that what I'm seeing are rounding errors as a result of
> Changeset 30648 [1] writing source and destination offsets and sizes as
> floats rather than integers.
> 
> Here is a snippet of a VRT generated by 2.0.0::
> 
> <ComplexSource>
>    <SourceFilename relativeToVRT="1">slpc/test01.tif</SourceFilename>
>    <SourceBand>1</SourceBand>
>    <SourceProperties RasterXSize="952" RasterYSize="1189" DataType="Byte"
> BlockXSize="952" BlockYSize="8" />
>    <SrcRect xOff="0" yOff="0" xSize="952" ySize="1189" />
>    <DstRect xOff="0" yOff="0" xSize="952" ySize="1189" />
>    <NODATA>0</NODATA>
> </ComplexSource>
> 
> And the equivalent snippet generated by 2.1.0::
> 
> <ComplexSource>
>    <SourceFilename relativeToVRT="1">slpc/test01.tif</SourceFilename>
>    <SourceBand>1</SourceBand>
>    <SourceProperties RasterXSize="952" RasterYSize="1189" DataType="Byte"
> BlockXSize="952" BlockYSize="8" />
>    <SrcRect xOff="0" yOff="0" xSize="952" ySize="1189" />
>    <DstRect xOff="0" yOff="0" xSize="951.999999999534"
> ySize="1189.00000000373" />
>    <NODATA>0</NODATA>
> </ComplexSource>
> 
> Both VRT files were generated in the same way::
> 
> gdalbuildvrt -tr 0.05 0.05 -tap slpc.vrt slpc/*tif
> 
> Note that the results are the same whether or not I use the -tr and -tap
> flags. Looking at other ComplexSources the DstRect offsets and sizes are
> always the values that are inconsistently rounded to integers with any
> of them potentially containing floats in the xml file. The VRT files
> were created on different systems with significantly different
> configurations so it is entirely possible that there is some local issue
> with my setup that is introducing this problem.
> 
> So I guess my first question is: Can anyone else confirm this issue? If
> so should it be considered a bug in GDAL or is up to other applications
> to adapt to this behavior?

Jed,

Yes GDAL 2.1 can produce floating point numbers, which can help to get sub-
pixel precision in some use cases. If read by GDAL < 2.1, those VRT files will 
exhibit possible one-off shift, since those older versions only read values as 
integers. Is it your case ?
Perhaps GDAL could be improved to avoid those issues by rounding to closest 
integer when numbers are very close like in your use case. Could you share a 
way to reproduce the issue ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  1 14:53:03 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 1 Jul 2016 23:53:03 +0200
Subject: [gdal-dev] gdalbuildvrt 2.1.0 and off by 1 pixel display
In-Reply-To: <e410cb03-d5b6-3b37-f4d2-4be40880da34@gmail.com>
References: <a04f78c9-ba4c-4369-7575-a810bcace30a@gmail.com>
 <201607012151.10112.even.rouault@spatialys.com>
 <e410cb03-d5b6-3b37-f4d2-4be40880da34@gmail.com>
Message-ID: <201607012353.03531.even.rouault@spatialys.com>

Le vendredi 01 juillet 2016 22:48:36, Jed Frechette a écrit :
> On 2016-07-01 1:51 PM, Even Rouault wrote:
> > If read by GDAL < 2.1, those VRT files will
> > exhibit possible one-off shift, since those older versions only read
> > values as integers. Is it your case ?
> 
> I see it in QGIS 2.14.3 (built against GDAL 2.0.2 and 2.1.0), QGIS
> 2.15.0 91c2d76 (GDAL 2.1.0), and ArcMap 10.1.
> 
> It seems like this has the potential to cause a lot of subtle issues in
> third party applications that, for various reasons, may be using
> different versions of the GDAL library. It also worries me that I'm
> seeing the offset in versions of QGIS (including the current weekly
> snapshot) that are reportedly built with GDAL 2.1.
> 
> > Could you share a way to reproduce the issue ?

I've pushed a fix in https://trac.osgeo.org/gdal/ticket/6568 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jidanni at jidanni.org  Fri Jul  1 15:19:42 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sat, 02 Jul 2016 06:19:42 +0800
Subject: [gdal-dev] R: Problem using ogrlineref
References: <VI1PR0201MB1790A57E72651121E1A30E5AE75D0@VI1PR0201MB1790.eurprd02.prod.outlook.com>
Message-ID: <87vb0p3ssh.fsf@jidanni.org>

Well OK but the Debian guy closed all my bug reports instantly,
and on the man page you will need to give full examples, including input file content,
before any of this becomes understandable. Thanks.

From cmcgeorge at surgeforward.com  Fri Jul  1 16:57:10 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Fri, 1 Jul 2016 17:57:10 -0600
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
Message-ID: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>

Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual Studio 2015?
I keep getting the following errors that I have not been able to resolve:

 

LINK : error LNK2001: unresolved external symbol
OCTNewCoordinateTransformation

LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT

LINK : error LNK2001: unresolved external symbol GDALComputeMedianCutPCT

LINK : error LNK2001: unresolved external symbol GDALReprojectImage

LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp

LINK : error LNK2001: unresolved external symbol OGRRegisterAll

LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount

LINK : error LNK2001: unresolved external symbol OPTGetProjectionMethods

LINK : error LNK2001: unresolved external symbol OSRValidate

gdal201.dll : fatal error LNK1120: 9 unresolved externals

 

Thank you,

Chris



---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160701/17e24331/attachment.html>

From even.rouault at spatialys.com  Fri Jul  1 17:10:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 2 Jul 2016 02:10:10 +0200
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
Message-ID: <201607020210.10982.even.rouault@spatialys.com>

Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
> Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual Studio
> 2015? I keep getting the following errors that I have not been able to
> resolve:

Did you define WIN64=YES in nmake.opt/nmake.local ?
> 
> 
> 
> LINK : error LNK2001: unresolved external symbol
> OCTNewCoordinateTransformation
> 
> LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
> 
> LINK : error LNK2001: unresolved external symbol GDALComputeMedianCutPCT
> 
> LINK : error LNK2001: unresolved external symbol GDALReprojectImage
> 
> LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
> 
> LINK : error LNK2001: unresolved external symbol OGRRegisterAll
> 
> LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
> 
> LINK : error LNK2001: unresolved external symbol OPTGetProjectionMethods
> 
> LINK : error LNK2001: unresolved external symbol OSRValidate
> 
> gdal201.dll : fatal error LNK1120: 9 unresolved externals
> 
> 
> 
> Thank you,
> 
> Chris
> 
> 
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cmcgeorge at surgeforward.com  Fri Jul  1 17:13:03 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Fri, 1 Jul 2016 18:13:03 -0600
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <201607020210.10982.even.rouault@spatialys.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
Message-ID: <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>

Hi, Even.  Thank you for your response.  Yes, I uncommented out this line in the nmake.opt file, and I used the "WIN64=yes" nmake command-line argument.

Thank you,
Chris

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Friday, July 01, 2016 6:10 PM
To: gdal-dev at lists.osgeo.org
Cc: Christopher McGeorge <cmcgeorge at surgeforward.com>
Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015

Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
> Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual Studio 
> 2015? I keep getting the following errors that I have not been able to
> resolve:

Did you define WIN64=YES in nmake.opt/nmake.local ?
> 
> 
> 
> LINK : error LNK2001: unresolved external symbol 
> OCTNewCoordinateTransformation
> 
> LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
> 
> LINK : error LNK2001: unresolved external symbol 
> GDALComputeMedianCutPCT
> 
> LINK : error LNK2001: unresolved external symbol GDALReprojectImage
> 
> LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
> 
> LINK : error LNK2001: unresolved external symbol OGRRegisterAll
> 
> LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
> 
> LINK : error LNK2001: unresolved external symbol 
> OPTGetProjectionMethods
> 
> LINK : error LNK2001: unresolved external symbol OSRValidate
> 
> gdal201.dll : fatal error LNK1120: 9 unresolved externals
> 
> 
> 
> Thank you,
> 
> Chris
> 
> 
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus

--
Spatialys - Geospatial professional services http://www.spatialys.com


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Fri Jul  1 17:23:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 2 Jul 2016 02:23:12 +0200
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
 <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
Message-ID: <201607020223.12126.even.rouault@spatialys.com>

Le samedi 02 juillet 2016 02:13:03, vous avez écrit :
> Hi, Even.  Thank you for your response.  Yes, I uncommented out this line
> in the nmake.opt file, and I used the "WIN64=yes" nmake command-line
> argument.
> 

And MSVC_VER=1900 ?
Make sure to clean before rebuilding if you change options

Here's a successful build on AppVeyour in case that helps:
https://ci.appveyor.com/project/rouault/gdal-coverage/build/1.0.5162/job/7np9al6m0uriphp1

> Thank you,
> Chris
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Friday, July 01, 2016 6:10 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Christopher McGeorge <cmcgeorge at surgeforward.com>
> Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
> 
> Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
> > Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual Studio
> > 2015? I keep getting the following errors that I have not been able to
> 
> > resolve:
> Did you define WIN64=YES in nmake.opt/nmake.local ?
> 
> > LINK : error LNK2001: unresolved external symbol
> > OCTNewCoordinateTransformation
> > 
> > LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
> > 
> > LINK : error LNK2001: unresolved external symbol
> > GDALComputeMedianCutPCT
> > 
> > LINK : error LNK2001: unresolved external symbol GDALReprojectImage
> > 
> > LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
> > 
> > LINK : error LNK2001: unresolved external symbol OGRRegisterAll
> > 
> > LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
> > 
> > LINK : error LNK2001: unresolved external symbol
> > OPTGetProjectionMethods
> > 
> > LINK : error LNK2001: unresolved external symbol OSRValidate
> > 
> > gdal201.dll : fatal error LNK1120: 9 unresolved externals
> > 
> > 
> > 
> > Thank you,
> > 
> > Chris
> > 
> > 
> > 
> > ---
> > This email has been checked for viruses by Avast antivirus software.
> > https://www.avast.com/antivirus
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
> 
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cmcgeorge at surgeforward.com  Fri Jul  1 20:01:44 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Fri, 1 Jul 2016 21:01:44 -0600
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <201607020223.12126.even.rouault@spatialys.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
 <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
 <201607020223.12126.even.rouault@spatialys.com>
Message-ID: <001b01d1d40e$11a4d1e0$34ee75a0$@surgeforward.com>

Thank you for your help, Even.  Yes, I tried cleaning before rebuilding and even re-downloading the original source code.

Thank you for your posting on AppVeyour.  To verify, you simply downloaded the following file:

    release-1800-x64-gdal-mapserver-src.zip

unzipped, changed to the "gdal" folder, uncommented out the following line in "nmake.opt":

    #WIN64=YES

and ran the following command:

    nmake -f makefile.vc MSVC_VER=1900 WIN64=yes

Thank you,
Chris

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Friday, July 01, 2016 6:23 PM
To: Christopher McGeorge <cmcgeorge at surgeforward.com>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015

Le samedi 02 juillet 2016 02:13:03, vous avez écrit :
> Hi, Even.  Thank you for your response.  Yes, I uncommented out this 
> line in the nmake.opt file, and I used the "WIN64=yes" nmake 
> command-line argument.
> 

And MSVC_VER=1900 ?
Make sure to clean before rebuilding if you change options

Here's a successful build on AppVeyour in case that helps:
https://ci.appveyor.com/project/rouault/gdal-coverage/build/1.0.5162/job/7np9al6m0uriphp1

> Thank you,
> Chris
> 
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Friday, July 01, 2016 6:10 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Christopher McGeorge <cmcgeorge at surgeforward.com>
> Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
> 
> Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
> > Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual 
> > Studio 2015? I keep getting the following errors that I have not 
> > been able to
> 
> > resolve:
> Did you define WIN64=YES in nmake.opt/nmake.local ?
> 
> > LINK : error LNK2001: unresolved external symbol 
> > OCTNewCoordinateTransformation
> > 
> > LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
> > 
> > LINK : error LNK2001: unresolved external symbol 
> > GDALComputeMedianCutPCT
> > 
> > LINK : error LNK2001: unresolved external symbol GDALReprojectImage
> > 
> > LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
> > 
> > LINK : error LNK2001: unresolved external symbol OGRRegisterAll
> > 
> > LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
> > 
> > LINK : error LNK2001: unresolved external symbol 
> > OPTGetProjectionMethods
> > 
> > LINK : error LNK2001: unresolved external symbol OSRValidate
> > 
> > gdal201.dll : fatal error LNK1120: 9 unresolved externals
> > 
> > 
> > 
> > Thank you,
> > 
> > Chris
> > 
> > 
> > 
> > ---
> > This email has been checked for viruses by Avast antivirus software.
> > https://www.avast.com/antivirus
> 
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
> 
> 
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus

--
Spatialys - Geospatial professional services http://www.spatialys.com


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jamessramm at gmail.com  Sat Jul  2 00:14:07 2016
From: jamessramm at gmail.com (James Ramm)
Date: Sat, 2 Jul 2016 08:14:07 +0100
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <001b01d1d40e$11a4d1e0$34ee75a0$@surgeforward.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
 <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
 <201607020223.12126.even.rouault@spatialys.com>
 <001b01d1d40e$11a4d1e0$34ee75a0$@surgeforward.com>
Message-ID: <CAEW=KS6R3r717dbTd1LZ5hDoTz7=fDshmoJ3EpHjvfPVWRfPbw@mail.gmail.com>

I'm am compiling successfully with vs 2015, both the library and python 3
bindings. The only thing I would add is to  make sure you run vcvarsall.bat
amd64. I'm building from trunk.
On 2 Jul 2016 4:02 a.m., "Christopher McGeorge" <cmcgeorge at surgeforward.com>
wrote:

> Thank you for your help, Even.  Yes, I tried cleaning before rebuilding
> and even re-downloading the original source code.
>
> Thank you for your posting on AppVeyour.  To verify, you simply downloaded
> the following file:
>
>     release-1800-x64-gdal-mapserver-src.zip
>
> unzipped, changed to the "gdal" folder, uncommented out the following line
> in "nmake.opt":
>
>     #WIN64=YES
>
> and ran the following command:
>
>     nmake -f makefile.vc MSVC_VER=1900 WIN64=yes
>
> Thank you,
> Chris
>
> -----Original Message-----
> From: Even Rouault [mailto:even.rouault at spatialys.com]
> Sent: Friday, July 01, 2016 6:23 PM
> To: Christopher McGeorge <cmcgeorge at surgeforward.com>;
> gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
>
> Le samedi 02 juillet 2016 02:13:03, vous avez écrit :
> > Hi, Even.  Thank you for your response.  Yes, I uncommented out this
> > line in the nmake.opt file, and I used the "WIN64=yes" nmake
> > command-line argument.
> >
>
> And MSVC_VER=1900 ?
> Make sure to clean before rebuilding if you change options
>
> Here's a successful build on AppVeyour in case that helps:
>
> https://ci.appveyor.com/project/rouault/gdal-coverage/build/1.0.5162/job/7np9al6m0uriphp1
>
> > Thank you,
> > Chris
> >
> > -----Original Message-----
> > From: Even Rouault [mailto:even.rouault at spatialys.com]
> > Sent: Friday, July 01, 2016 6:10 PM
> > To: gdal-dev at lists.osgeo.org
> > Cc: Christopher McGeorge <cmcgeorge at surgeforward.com>
> > Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
> >
> > Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
> > > Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual
> > > Studio 2015? I keep getting the following errors that I have not
> > > been able to
> >
> > > resolve:
> > Did you define WIN64=YES in nmake.opt/nmake.local ?
> >
> > > LINK : error LNK2001: unresolved external symbol
> > > OCTNewCoordinateTransformation
> > >
> > > LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
> > >
> > > LINK : error LNK2001: unresolved external symbol
> > > GDALComputeMedianCutPCT
> > >
> > > LINK : error LNK2001: unresolved external symbol GDALReprojectImage
> > >
> > > LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
> > >
> > > LINK : error LNK2001: unresolved external symbol OGRRegisterAll
> > >
> > > LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
> > >
> > > LINK : error LNK2001: unresolved external symbol
> > > OPTGetProjectionMethods
> > >
> > > LINK : error LNK2001: unresolved external symbol OSRValidate
> > >
> > > gdal201.dll : fatal error LNK1120: 9 unresolved externals
> > >
> > >
> > >
> > > Thank you,
> > >
> > > Chris
> > >
> > >
> > >
> > > ---
> > > This email has been checked for viruses by Avast antivirus software.
> > > https://www.avast.com/antivirus
> >
> > --
> > Spatialys - Geospatial professional services http://www.spatialys.com
> >
> >
> > ---
> > This email has been checked for viruses by Avast antivirus software.
> > https://www.avast.com/antivirus
>
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
>
>
> ---
> This email has been checked for viruses by Avast antivirus software.
> https://www.avast.com/antivirus
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160702/a021b06a/attachment.html>

From jmckenna at gatewaygeomatics.com  Sat Jul  2 04:45:07 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 2 Jul 2016 08:45:07 -0300
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <CAEW=KS6R3r717dbTd1LZ5hDoTz7=fDshmoJ3EpHjvfPVWRfPbw@mail.gmail.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
 <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
 <201607020223.12126.even.rouault@spatialys.com>
 <001b01d1d40e$11a4d1e0$34ee75a0$@surgeforward.com>
 <CAEW=KS6R3r717dbTd1LZ5hDoTz7=fDshmoJ3EpHjvfPVWRfPbw@mail.gmail.com>
Message-ID: <dc024fce-5fde-070d-c051-035a859f462a@gatewaygeomatics.com>

I would reinforce what James said: be careful choosing the command 
prompt, the default "Developer Command prompt for VS2015" with Visual 
Studio 2015 installed on an x64 machine actually builds in x86 - you 
actually need to use the "VS2015 x64 Native Tools Command Prompt".  Once 
the window is opened, you can execute "cl" and view its response and 
look for the text 'compiler version 19.00.xx for x64'

Or simply just use James' command. :)

-jeff

-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-07-02 4:14 AM, James Ramm wrote:
> I'm am compiling successfully with vs 2015, both the library and python
> 3 bindings. The only thing I would add is to  make sure you run
> vcvarsall.bat amd64. I'm building from trunk.
>
> On 2 Jul 2016 4:02 a.m., "Christopher McGeorge"
> <cmcgeorge at surgeforward.com <mailto:cmcgeorge at surgeforward.com>> wrote:
>
>     Thank you for your help, Even.  Yes, I tried cleaning before
>     rebuilding and even re-downloading the original source code.
>
>     Thank you for your posting on AppVeyour.  To verify, you simply
>     downloaded the following file:
>
>         release-1800-x64-gdal-mapserver-src.zip
>
>     unzipped, changed to the "gdal" folder, uncommented out the
>     following line in "nmake.opt":
>
>         #WIN64=YES
>
>     and ran the following command:
>
>         nmake -f makefile.vc <http://makefile.vc> MSVC_VER=1900 WIN64=yes
>
>     Thank you,
>     Chris
>
>     -----Original Message-----
>     From: Even Rouault [mailto:even.rouault at spatialys.com
>     <mailto:even.rouault at spatialys.com>]
>     Sent: Friday, July 01, 2016 6:23 PM
>     To: Christopher McGeorge <cmcgeorge at surgeforward.com
>     <mailto:cmcgeorge at surgeforward.com>>; gdal-dev at lists.osgeo.org
>     <mailto:gdal-dev at lists.osgeo.org>
>     Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
>
>     Le samedi 02 juillet 2016 02:13:03, vous avez écrit :
>     > Hi, Even.  Thank you for your response.  Yes, I uncommented out this
>     > line in the nmake.opt file, and I used the "WIN64=yes" nmake
>     > command-line argument.
>     >
>
>     And MSVC_VER=1900 ?
>     Make sure to clean before rebuilding if you change options
>
>     Here's a successful build on AppVeyour in case that helps:
>     https://ci.appveyor.com/project/rouault/gdal-coverage/build/1.0.5162/job/7np9al6m0uriphp1
>
>     > Thank you,
>     > Chris
>     >
>     > -----Original Message-----
>     > From: Even Rouault [mailto:even.rouault at spatialys.com
>     <mailto:even.rouault at spatialys.com>]
>     > Sent: Friday, July 01, 2016 6:10 PM
>     > To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     > Cc: Christopher McGeorge <cmcgeorge at surgeforward.com
>     <mailto:cmcgeorge at surgeforward.com>>
>     > Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
>     >
>     > Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
>     > > Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual
>     > > Studio 2015? I keep getting the following errors that I have not
>     > > been able to
>     >
>     > > resolve:
>     > Did you define WIN64=YES in nmake.opt/nmake.local ?
>     >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > OCTNewCoordinateTransformation
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
>     > >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > GDALComputeMedianCutPCT
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALReprojectImage
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OGRRegisterAll
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
>     > >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > OPTGetProjectionMethods
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OSRValidate
>     > >
>     > > gdal201.dll : fatal error LNK1120: 9 unresolved externals
>     > >
>     > >
>     > >
>     > > Thank you,
>     > >
>     > > Chris
>     > >
>     > >
>     > >
>     > > ---
>     > > This email has been checked for viruses by Avast antivirus software.
>     > > https://www.avast.com/antivirus
>     >
>     > --
>     > Spatialys - Geospatial professional services http://www.spatialys.com
>     >
>     >
>     > ---
>     > This email has been checked for viruses by Avast antivirus software.
>     > https://www.avast.com/antivirus
>
>     --
>     Spatialys - Geospatial professional services http://www.spatialys.com
>
>




From bishop.dev at gmail.com  Sat Jul  2 04:57:17 2016
From: bishop.dev at gmail.com (Dmitry Baryshnikov)
Date: Sat, 2 Jul 2016 14:57:17 +0300
Subject: [gdal-dev] R: Problem using ogrlineref
In-Reply-To: <87vb0p3ssh.fsf@jidanni.org>
References: <VI1PR0201MB1790A57E72651121E1A30E5AE75D0@VI1PR0201MB1790.eurprd02.prod.outlook.com>
 <87vb0p3ssh.fsf@jidanni.org>
Message-ID: <5777AC1D.5090400@gmail.com>

Hi Dan,

Feel free to rewrite the docs more understandable.
You have to fork https://github.com/OSGeo/gdal
make changes to 
https://github.com/OSGeo/gdal/blob/trunk/gdal/apps/ogr_utilities.dox
and provide pull request.
Also, look at man pages of other utilities as an example how it should 
be done (i.e. http://gdal.org/ogr2ogr.html).

Best regards,
     Dmitry

02.07.2016 01:19, 積丹尼 Dan Jacobson пишет:
> Well OK but the Debian guy closed all my bug reports instantly,
> and on the man page you will need to give full examples, including input file content,
> before any of this becomes understandable. Thanks.
>


From jedfrechette at gmail.com  Sat Jul  2 05:40:18 2016
From: jedfrechette at gmail.com (Jed Frechette)
Date: Sat, 02 Jul 2016 06:40:18 -0600
Subject: [gdal-dev] gdalbuildvrt 2.1.0 and off by 1 pixel display
In-Reply-To: <201607012353.03531.even.rouault@spatialys.com>
Message-ID: <5777b635.4436620a.ed2d8.ffffa9bb@mx.google.com>

Great. Thanks!


  Original Message  
From:even.rouault at spatialys.com
Sent:July 1, 2016 15:50
To:jedfrechette at gmail.com
Cc:gdal-dev at lists.osgeo.org
Subject:Re: [gdal-dev] gdalbuildvrt 2.1.0 and off by 1 pixel display

Le vendredi 01 juillet 2016 22:48:36, Jed Frechette a écrit :
> On 2016-07-01 1:51 PM, Even Rouault wrote:
> > If read by GDAL < 2.1, those VRT files will
> > exhibit possible one-off shift, since those older versions only read
> > values as integers. Is it your case ?
> 
> I see it in QGIS 2.14.3 (built against GDAL 2.0.2 and 2.1.0), QGIS
> 2.15.0 91c2d76 (GDAL 2.1.0), and ArcMap 10.1.
> 
> It seems like this has the potential to cause a lot of subtle issues in
> third party applications that, for various reasons, may be using
> different versions of the GDAL library. It also worries me that I'm
> seeing the offset in versions of QGIS (including the current weekly
> snapshot) that are reportedly built with GDAL 2.1.
> 
> > Could you share a way to reproduce the issue ?

I've pushed a fix in https://trac.osgeo.org/gdal/ticket/6568 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cmcgeorge at surgeforward.com  Sat Jul  2 07:28:48 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Sat, 2 Jul 2016 08:28:48 -0600
Subject: [gdal-dev] Compiling GDAL with Visual Studio 2015
In-Reply-To: <dc024fce-5fde-070d-c051-035a859f462a@gatewaygeomatics.com>
References: <000801d1d3f4$48ccfe50$da66faf0$@surgeforward.com>
 <201607020210.10982.even.rouault@spatialys.com>
 <001401d1d3f6$8090bdc0$81b23940$@surgeforward.com>
 <201607020223.12126.even.rouault@spatialys.com>
 <001b01d1d40e$11a4d1e0$34ee75a0$@surgeforward.com>
 <CAEW=KS6R3r717dbTd1LZ5hDoTz7=fDshmoJ3EpHjvfPVWRfPbw@mail.gmail.com>
 <dc024fce-5fde-070d-c051-035a859f462a@gatewaygeomatics.com>
Message-ID: <001501d1d46e$0cb95a60$262c0f20$@surgeforward.com>

Thank you, Jeff and James!

Chris

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jeff McKenna
Sent: Saturday, July 02, 2016 5:45 AM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015

I would reinforce what James said: be careful choosing the command prompt, the default "Developer Command prompt for VS2015" with Visual Studio 2015 installed on an x64 machine actually builds in x86 - you actually need to use the "VS2015 x64 Native Tools Command Prompt".  Once the window is opened, you can execute "cl" and view its response and look for the text 'compiler version 19.00.xx for x64'

Or simply just use James' command. :)

-jeff

--
Jeff McKenna
MapServer Consulting and Training Services http://www.gatewaygeomatics.com/



On 2016-07-02 4:14 AM, James Ramm wrote:
> I'm am compiling successfully with vs 2015, both the library and python
> 3 bindings. The only thing I would add is to  make sure you run
> vcvarsall.bat amd64. I'm building from trunk.
>
> On 2 Jul 2016 4:02 a.m., "Christopher McGeorge"
> <cmcgeorge at surgeforward.com <mailto:cmcgeorge at surgeforward.com>> wrote:
>
>     Thank you for your help, Even.  Yes, I tried cleaning before
>     rebuilding and even re-downloading the original source code.
>
>     Thank you for your posting on AppVeyour.  To verify, you simply
>     downloaded the following file:
>
>         release-1800-x64-gdal-mapserver-src.zip
>
>     unzipped, changed to the "gdal" folder, uncommented out the
>     following line in "nmake.opt":
>
>         #WIN64=YES
>
>     and ran the following command:
>
>         nmake -f makefile.vc <http://makefile.vc> MSVC_VER=1900 WIN64=yes
>
>     Thank you,
>     Chris
>
>     -----Original Message-----
>     From: Even Rouault [mailto:even.rouault at spatialys.com
>     <mailto:even.rouault at spatialys.com>]
>     Sent: Friday, July 01, 2016 6:23 PM
>     To: Christopher McGeorge <cmcgeorge at surgeforward.com
>     <mailto:cmcgeorge at surgeforward.com>>; gdal-dev at lists.osgeo.org
>     <mailto:gdal-dev at lists.osgeo.org>
>     Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
>
>     Le samedi 02 juillet 2016 02:13:03, vous avez écrit :
>     > Hi, Even.  Thank you for your response.  Yes, I uncommented out this
>     > line in the nmake.opt file, and I used the "WIN64=yes" nmake
>     > command-line argument.
>     >
>
>     And MSVC_VER=1900 ?
>     Make sure to clean before rebuilding if you change options
>
>     Here's a successful build on AppVeyour in case that helps:
>     https://ci.appveyor.com/project/rouault/gdal-coverage/build/1.0.5162/job/7np9al6m0uriphp1
>
>     > Thank you,
>     > Chris
>     >
>     > -----Original Message-----
>     > From: Even Rouault [mailto:even.rouault at spatialys.com
>     <mailto:even.rouault at spatialys.com>]
>     > Sent: Friday, July 01, 2016 6:10 PM
>     > To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     > Cc: Christopher McGeorge <cmcgeorge at surgeforward.com
>     <mailto:cmcgeorge at surgeforward.com>>
>     > Subject: Re: [gdal-dev] Compiling GDAL with Visual Studio 2015
>     >
>     > Le samedi 02 juillet 2016 01:57:10, Christopher McGeorge a écrit :
>     > > Hi.  Has anyone been able to build 64-bit GDAL 2.1 using Visual
>     > > Studio 2015? I keep getting the following errors that I have not
>     > > been able to
>     >
>     > > resolve:
>     > Did you define WIN64=YES in nmake.opt/nmake.local ?
>     >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > OCTNewCoordinateTransformation
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
>     > >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > GDALComputeMedianCutPCT
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALReprojectImage
>     > >
>     > > LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OGRRegisterAll
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
>     > >
>     > > LINK : error LNK2001: unresolved external symbol
>     > > OPTGetProjectionMethods
>     > >
>     > > LINK : error LNK2001: unresolved external symbol OSRValidate
>     > >
>     > > gdal201.dll : fatal error LNK1120: 9 unresolved externals
>     > >
>     > >
>     > >
>     > > Thank you,
>     > >
>     > > Chris
>     > >
>     > >
>     > >
>     > > ---
>     > > This email has been checked for viruses by Avast antivirus software.
>     > > https://www.avast.com/antivirus
>     >
>     > --
>     > Spatialys - Geospatial professional services http://www.spatialys.com
>     >
>     >
>     > ---
>     > This email has been checked for viruses by Avast antivirus software.
>     > https://www.avast.com/antivirus
>
>     --
>     Spatialys - Geospatial professional services http://www.spatialys.com
>
>



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jidanni at jidanni.org  Sat Jul  2 07:42:26 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sat, 02 Jul 2016 22:42:26 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
Message-ID: <87wpl4dru5.fsf@jidanni.org>

http://www.gdal.org/ogr_feature_style.html says

    Here is what one of those .OFS files could look like:

    OFS-Version: 1.0
    StyleField: "style"

    DefaultStyle: PEN(C:#000000FF)
    road:      PEN(c:#FF0000,w:5px)
    lake:      BRUSH(fc:#0000FF);PEN(c:#000000)
    campsite:  SYMBOL(c:#00FF00,id:"points.sym-45,ogr-sym-7")
    label:     LABEL(f:"Times New Roman",s:12pt,t:{text_string})

Where do we save this file to? rivers.ofs ?

     2.9 Using OGR SQL to transfer the style between the data sources

     We can use the OGR_STYLE special field to extract the feature level
     style, and ogr2ogr can be used to transfer the style string between the
     data sources according to the following example:

     ogr2ogr -f "ESRI Shapefile" -sql "select *, OGR_STYLE from rivers" rivers.shp rivers.tab

Does "OGR_STYLE from rivers" mean it will read rivers.ofs ?

From jidanni at jidanni.org  Sat Jul  2 08:34:27 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sat, 02 Jul 2016 23:34:27 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
References: <87wpl4dru5.fsf@jidanni.org>
Message-ID: <87shvsdpfg.fsf@jidanni.org>

I failed miserably at adding ANY style to a shapefile.

$ ogrinfo -al -q zk2.shp|colrm 66
Layer name: zk2
Metadata:
  DBF_DATE_LAST_UPDATE=2016-07-02
OGRFeature(zk2):0
  Name (String) = zaokeng main road 中45市道
  descriptio (String) = (null)
  timestamp (Date) = (null)
  begin (Date) = (null)
  end (Date) = (null)
  altitudeMo (String) = (null)
  tessellate (Integer) = 1
  extrude (Integer) = 0
  visibility (Integer) = -1
  drawOrder (Integer) = (null)
  icon (String) = (null)
  LINESTRING Z (120.86817 24.17922 0,120.86816 24.17922 0,120.868

$ cat zk2.ofs
OFS-Version: 1.0
StyleField: "style"

DefaultStyle: PEN(C:#000000FF)
road:      PEN(c:#FF0000,w:5px)
lake:      BRUSH(fc:#0000FF);PEN(c:#000000)
campsite:  SYMBOL(c:#00FF00,id:"points.sym-45,ogr-sym-7")
label:     LABEL(f:"Times New Roman",s:12pt,t:{text_string})

$ ogr2ogr -lco ENCODING=UTF-8 -f "ESRI Shapefile" -sql "select *, OGR_STYLE from zk2" x.shp zk2.shp
$ ogrinfo -al -q x.shp|colrm 66
Layer name: x
Metadata:
  DBF_DATE_LAST_UPDATE=2016-07-02
OGRFeature(x):0
  Name (String) = zaokeng main road 中45市道
  descriptio (String) = (null)
  timestamp (Date) = (null)
  begin (Date) = (null)
  end (Date) = (null)
  altitudeMo (String) = (null)
  tessellate (Integer) = 1
  extrude (Integer) = 0
  visibility (Integer) = -1
  drawOrder (Integer) = (null)
  icon (String) = (null)
  OGR_STYLE (String) = (null)
  Style =
  LINESTRING Z (120.86817 24.17922 0,120.86816 24.17922 0,120.868

Not even the DefaultStyle. Total failure.

From cmcgeorge at surgeforward.com  Sat Jul  2 10:47:35 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Sat, 2 Jul 2016 11:47:35 -0600
Subject: [gdal-dev] Test Windows Build
Message-ID: <003e01d1d489$d193afa0$74bb0ee0$@surgeforward.com>

Hi.  Could anyone please suggest a way, preferably one that I can automate,
to verify that GDAL Windows builds were successful, such as by running one
of the generated exe files in the apps folder?

 

Thank you,

Chris



---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160702/9bae9210/attachment.html>

From jef at norbit.de  Sat Jul  2 13:27:12 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Sat, 2 Jul 2016 22:27:12 +0200
Subject: [gdal-dev] Test Windows Build
In-Reply-To: <003e01d1d489$d193afa0$74bb0ee0$@surgeforward.com>
References: <003e01d1d489$d193afa0$74bb0ee0$@surgeforward.com>
Message-ID: <20160702202712.GA20870@norbit.de>

Hi Christopher,

On Sat, 02. Jul 2016 at 11:47:35 -0600, Christopher McGeorge wrote:
> Hi.  Could anyone please suggest a way, preferably one that I can automate,
> to verify that GDAL Windows builds were successful, such as by running one
> of the generated exe files in the apps folder?

Does https://trac.osgeo.org/gdal/wiki/TestingNotes help?


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160702/125e6928/attachment.sig>

From jidanni at jidanni.org  Sat Jul  2 20:56:25 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sun, 03 Jul 2016 11:56:25 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
References: <87wpl4dru5.fsf@jidanni.org>
Message-ID: <87wpl39xxy.fsf@jidanni.org>

I finally gave up and stipped the KML data into a .csv and finally
was able to (according to ogrinfo) successfully attach styles to it with
this .vrt file:
<OGRVRTDataSource>
  <OGRVRTLayer name="road">
    <SrcDataSource>road.csv</SrcDataSource>
    <GeometryType>wkbLineString</GeometryType>
    <LayerSRS>WGS84</LayerSRS>
    <GeometryField encoding="PointFromColumns" x="Longitude" y="Latitude"/>
    <SrcSQL>SELECT *,'PEN(c:#FF00FF,w:10px)' AS OGR_STYLE FROM road</SrcSQL>
  </OGRVRTLayer>
</OGRVRTDataSource>

From jidanni at jidanni.org  Sat Jul  2 21:22:44 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sun, 03 Jul 2016 12:22:44 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
References: <87wpl4dru5.fsf@jidanni.org>
Message-ID: <87k2h39wq3.fsf@jidanni.org>

But this applies the style to all the points in the line, but I just
want to apply it to the line itself.

And then how can I finally print the result to a .png file? Convert to
.shp and view in qgis? But my .shp ended up with no points in it.

From jidanni at jidanni.org  Sat Jul  2 21:35:41 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sun, 03 Jul 2016 12:35:41 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
References: <87wpl4dru5.fsf@jidanni.org>
Message-ID: <87inwn9w4i.fsf@jidanni.org>

All I want to do is try the various Label Placement Modes seen in
http://www.gdal.org/ogr_feature_style.html , given my LineString of .csv
Lon/Lat points that I stripped out of my .kml.
Surely there is a way to attach Label Placement Modes to a
LineSrting and then output it to some .png etc. file, or view it in
qgis. I see -f PDF has limitations on Label Placement Modes so I don't
want to use that.

From jidanni at jidanni.org  Sat Jul  2 22:41:41 2016
From: jidanni at jidanni.org (=?utf-8?B?56mN5Li55bC8?= Dan Jacobson)
Date: Sun, 03 Jul 2016 13:41:41 +0800
Subject: [gdal-dev] Does "OGR_STYLE from rivers" mean it will read
	rivers.ofs ?
References: <87wpl4dru5.fsf@jidanni.org>
Message-ID: <87eg7b9t2i.fsf@jidanni.org>

Maybe http://www.gdal.org/ogr_feature_style.html is just a framework
and not something that is implemented anywhere?

Are there any examples of anybody using LABEL(f:"Times New
Roman",s:12pt,t:{text_string}) to print anything anywhere?

From jukka.rahkonen at maanmittauslaitos.fi  Sun Jul  3 04:22:16 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Sun, 3 Jul 2016 11:22:16 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?Does_=22OGR=5FSTYLE_from_rivers=22_mean_it_w?=
	=?utf-8?q?ill_read=09rivers=2Eofs_=3F?=
References: <87wpl4dru5.fsf@jidanni.org> <87eg7b9t2i.fsf@jidanni.org>
Message-ID: <loom.20160703T131723-670@post.gmane.org>

積丹尼 Dan Jacobson <jidanni <at> jidanni.org> writes:

> 
> Maybe http://www.gdal.org/ogr_feature_style.html is just a framework
> and not something that is implemented anywhere?
> 
> Are there any examples of anybody using LABEL(f:"Times New
> Roman",s:12pt,t:{text_string}) to print anything anywhere?

Most GIS formats do not support per feature styles. OGR_STYLE should be
usable in formats like MapInfo, KML, DXF, PDF vector. PDF might be easiest
for testing.

-Jukka Rahkonen-


From even.rouault at spatialys.com  Sun Jul  3 06:29:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 3 Jul 2016 15:29:33 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.1 RC1 Available for Review
Message-ID: <201607031529.33561.even.rouault@spatialys.com>

Hi,

And to conclude this bugfixes series, I have prepared a GDAL/OGR 2.1.1 release 
candidate. Please review and test.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.xz
  http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.gz
  http://download.osgeo.org/gdal/2.1.1/gdal211RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.tar.gz
  http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.1.1-News

I'll call for a vote promoting it to final in the next days if no 
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From 191980 at niuitmo.ru  Sun Jul  3 07:03:45 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 3 Jul 2016 14:03:45 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 6]
Message-ID: <EBAE2C6E-F4FB-4788-B010-341FC7CA3400@niuitmo.ru>

Blogpost link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-6-report.html>.


Last week I had to move back home, and I had to set up a new working environment, and it took a lot of time. Also, I changed priority a little, so 'probably to be done' tasks are done (EED), and 'to be done' task becomes next week task.


1. This week I've done:

Libopencad changes:

- ExtendedEntityData is now available by method vector< string > CADGeometry::getEED();

- ESRI SpatialRef is now available by method string CADFile::getESRISpatialRef();


OGR CAD Driver changes:

- EED support added (all EED are presented as a feature string attribute).

- *.prj file reading, or extracting it from CAD file, if not presented.


2. Plan on doing next week:

Polylines tesselation, spline geometry. Test library on a files with a lot of different objects (raster/vector). Fix CAD driver issue (described below).


3. Blocking:

As far as I can see Latest commits to libopencad crashed CAD Driver on my Mac. GDAL still builts fine, but calling ogrinfo with DWG file causes an endless loop somewhere in libopencad, however, tests are passed and cadinfo app works just fine. Currently I have no idea what can cause such behavior, and I am working on it.


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>


Best regards,

Alexandr Borzykh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160703/f40bf27f/attachment-0001.html>

From 191980 at niuitmo.ru  Sun Jul  3 06:06:57 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 3 Jul 2016 13:06:57 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 6]
Message-ID: <D7E39A00-53F5-48C3-9251-D1716BEB8546@niuitmo.ru>

Blogpost link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-6-report.html>.


Last week I had to move back home, and I had to set up a new working environment, and it took a lot of time. Also, I changed priority a little, so 'probably to be done' tasks are done (EED), and 'to be done' task becomes next week task.


1. This week I've done:

Libopencad changes:

- ExtendedEntityData is now available by method vector< string > CADGeometry::getEED();

- ESRI SpatialRef is now available by method string CADFile::getESRISpatialRef();


OGR CAD Driver changes:

- EED support added (all EED are presented as a feature string attribute).

- *.prj file reading, or extracting it from CAD file, if not presented.


2. Plan on doing next week:

Polylines tesselation, spline geometry. Test library on a files with a lot of different objects (raster/vector). Fix CAD driver issue (described below).


3. Blocking:

As far as I can see Latest commits to libopencad crashed CAD Driver on my Mac. GDAL still builts fine, but calling ogrinfo with DWG file causes an endless loop somewhere in libopencad, however, tests are passed and cadinfo app works just fine. Currently I have no idea what can cause such behavior, and I am working on it.


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>


Best regards,

Alexandr Borzykh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160703/3587bee6/attachment.html>

From philippe.ghesquiere at airbus.com  Mon Jul  4 00:30:44 2016
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Mon, 4 Jul 2016 00:30:44 -0700 (PDT)
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <5776B1E6.6040303@tiscali.it>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com> <5772E306.3090504@tiscali.it>
 <1467299787210-5274192.post@n6.nabble.com> <5775583C.7090802@tiscali.it>
 <1467355930076-5274296.post@n6.nabble.com> <5776B1E6.6040303@tiscali.it>
Message-ID: <1467617444210-5274571.post@n6.nabble.com>

Hi Antonio,

as I was mentioning it in my 1st message,I am running under *Windows*.
I can see that the PIXFUN is indeed recognized thanks to the log messages I
have added in all functions.
I have noticed that the pointer *papoSources* is always *null *!

If you have a clue, I would buy it :-)
Sincerly
Philippe




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Amplitude-virtual-bands-for-complex-datasets-tp5273713p5274571.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Jul  4 01:18:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jul 2016 10:18:50 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <1467617444210-5274571.post@n6.nabble.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <5776B1E6.6040303@tiscali.it> <1467617444210-5274571.post@n6.nabble.com>
Message-ID: <201607041018.50794.even.rouault@spatialys.com>

Le lundi 04 juillet 2016 09:30:44, Bugbuster a écrit :
> Hi Antonio,
> 
> as I was mentioning it in my 1st message,I am running under *Windows*.
> I can see that the PIXFUN is indeed recognized thanks to the log messages I
> have added in all functions.
> I have noticed that the pointer *papoSources* is always *null *!
> 
> If you have a clue, I would buy it :-)

Hi,

I've add a look at the code and noticed on unsafe practice, but I'm not sure 
it explains what you observe. In pixelfunctions.c, 
GDALRegisterDefaultPixelFunc() is declared with CPL_STDCALL convention, but in 
pixfunplugin.c with "extern CPLErr GDALRegisterDefaultPixelFunc()"; (and thus 
C convention I guess).

Even

> Sincerly
> Philippe
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Amplitude-virtual-bands-for-c
> omplex-datasets-tp5273713p5274571.html Sent from the GDAL - Dev mailing
> list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.michel at cnes.fr  Mon Jul  4 01:28:01 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 4 Jul 2016 10:28:01 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201606281239.25031.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com>
Message-ID: <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>

Le 28/06/2016 à 12:39, Even Rouault a écrit :
> There would be likely changes to do in:
> - GDALOpen(), to detect a syntax like
> "DERIVED_SUBDATASET:Amplitude:original_datasetname" and create the appropriate
> dataset. Hum, or perhaps better, instead of hacking GDALOpen(), having a
> driver that would recognize this syntax and instanciate the proper derived
> dataset.
> - GDALDataset::GetMetadata( pszDomain ) when pszDomain equals "SUBDATASETS"
> -> with the issue I mentionned for drivers that already implement subdatasets
> and will not call the base method.
>
>
> Hum, or perhaps a better solution would be to have a new metadata domain
> "DERIVED_SUBDATASETS". Would solve the potential confusion between "natural"
> and derived subdatasets, and would probably require little/no changes in
> drivers. Would not confuse gdal_translate -sds. Could be used by mapserver
> unmodified. But would require QGIS querying this new metadata domain.
To check if I understood well :

I will create a driver that will recognize the 
"DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver 
needs to now if "original_datasetname" is of complex type (to report it 
can open it), and will also expose the derived band somehow (can I 
benefit from the CreateDerivedBand API, and the pixel functions from 
Antonio ?). Also, "original_datasetname" can be a subdataset itself.

There should also be a mechanism that will report the existing 
DERIVED_SUBDATASETS upon query (this I did not get yet).

I am not sure if I can figure out how to do this, but I will try.

Regards,

Julien

-- 
Julien MICHEL
CNES - DCT/SI/AP


From even.rouault at spatialys.com  Mon Jul  4 02:06:20 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jul 2016 11:06:20 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com>
 <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>
Message-ID: <201607041106.20270.even.rouault@spatialys.com>

Hi,
> 
> To check if I understood well :
> 
> I will create a driver that will recognize the
> "DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver
> needs to now if "original_datasetname" is of complex type (to report it
> can open it)

That or we could also possibly accept non-complex types (assume imaginary part 
= 0). Antonio's functions handle complex & non-complex AFAICS

> , and will also expose the derived band somehow (can I
> benefit from the CreateDerivedBand API, 

If you write it, yes... (it doesn't exist yet if I wasn't clear)

If you follow the VRT pixel function road, that's a matter of building a on-
the-fly VRT dataset.

http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation could possibly be 
used. But AFAICS setting the pixel function name isn't supported. Could be 
done by implementing CPLErr VRTSourcedRasterBand::SetMetadataItem( const char 
*pszName, const char *pszValue, const char *pszDomain ), similarly to what 
VRTSourcedRasterBand::SetMetadataItem(...) handles for vrt sources.

> and the pixel functions from Antonio ?).

Would make sense to internalize this code (uses X/MIT license)

> Also, "original_datasetname" can be a subdataset itself.

Yes, that shouldn't matter to the driver. It is just a string that it provides 
to GDALOpen() (some care must be taken when parsing 
DERIVED_SUBDATASET:algname:original_datasetname, since original_datasetname 
can have columns too)

> 
> There should also be a mechanism that will report the existing
> DERIVED_SUBDATASETS upon query (this I did not get yet).

Implement in GDALDataset, the following method (from GDALMajorObject)

virtual char **GetMetadata( const char * pszDomain = "" );

char **GDALDataset::GetMetadata( const char * pszDomain = "" )
{
	if( pszDomain != NULL && EQUAL(pszDomain, "DERIVED_SUBDATASET") )
	{
		// some stuff. Be careful that ownership of returned char** belongs
		// to the dataset object
	}
	else
		return GDALMajorObject::GetMetadata(pszDomain);
}

As well as :

virtual char **GetMetadataDomainList(); to report DERIVED_SUBDATASET when it 
makes sense (contrary to GetMetadata(), ownership of the returned char** 
belongs to the caller)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.michel at cnes.fr  Mon Jul  4 05:30:26 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 4 Jul 2016 14:30:26 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607041106.20270.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com>
 <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>
 <201607041106.20270.even.rouault@spatialys.com>
Message-ID: <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>

Hi,

Started the work here :

https://github.com/OSGeo/gdal/compare/trunk...jmichel-otb:enhance-complex-datasets

For now, recognizes the following syntax :

gdal_translate -srcwin 1000 1000 1000 1000 
DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff 
~/tmp/test.tif

I need to see about exposing those derived datasets properly.

Antonio, I copied one of your pixel function for fast prototyping, I 
hope you do not mind. Of course upon completion of this work we should 
merge properly all your pixel functions with proper 
credits/copyright/licence. Thing is I did not know where to put them 
within gdal.

Regards,

Julien

Le 04/07/2016 à 11:06, Even Rouault a écrit :
> Hi,
>> To check if I understood well :
>>
>> I will create a driver that will recognize the
>> "DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver
>> needs to now if "original_datasetname" is of complex type (to report it
>> can open it)
> That or we could also possibly accept non-complex types (assume imaginary part
> = 0). Antonio's functions handle complex & non-complex AFAICS
>
>> , and will also expose the derived band somehow (can I
>> benefit from the CreateDerivedBand API,
> If you write it, yes... (it doesn't exist yet if I wasn't clear)
>
> If you follow the VRT pixel function road, that's a matter of building a on-
> the-fly VRT dataset.
>
> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation could possibly be
> used. But AFAICS setting the pixel function name isn't supported. Could be
> done by implementing CPLErr VRTSourcedRasterBand::SetMetadataItem( const char
> *pszName, const char *pszValue, const char *pszDomain ), similarly to what
> VRTSourcedRasterBand::SetMetadataItem(...) handles for vrt sources.
>
>> and the pixel functions from Antonio ?).
> Would make sense to internalize this code (uses X/MIT license)
>
>> Also, "original_datasetname" can be a subdataset itself.
> Yes, that shouldn't matter to the driver. It is just a string that it provides
> to GDALOpen() (some care must be taken when parsing
> DERIVED_SUBDATASET:algname:original_datasetname, since original_datasetname
> can have columns too)
>
>> There should also be a mechanism that will report the existing
>> DERIVED_SUBDATASETS upon query (this I did not get yet).
> Implement in GDALDataset, the following method (from GDALMajorObject)
>
> virtual char **GetMetadata( const char * pszDomain = "" );
>
> char **GDALDataset::GetMetadata( const char * pszDomain = "" )
> {
> 	if( pszDomain != NULL && EQUAL(pszDomain, "DERIVED_SUBDATASET") )
> 	{
> 		// some stuff. Be careful that ownership of returned char** belongs
> 		// to the dataset object
> 	}
> 	else
> 		return GDALMajorObject::GetMetadata(pszDomain);
> }
>
> As well as :
>
> virtual char **GetMetadataDomainList(); to report DERIVED_SUBDATASET when it
> makes sense (contrary to GetMetadata(), ownership of the returned char**
> belongs to the caller)
>
> Even
>


-- 
Julien MICHEL
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From julien.michel at cnes.fr  Mon Jul  4 05:32:01 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 4 Jul 2016 14:32:01 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com>
 <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>
 <201607041106.20270.even.rouault@spatialys.com>
 <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
Message-ID: <a749886d-afef-948c-c43b-b93049d21ae3@cnes.fr>

PS: any comments welcome, I am not really familiar with gdal coding 
style & arch.

Julien

Le 04/07/2016 à 14:30, Julien Michel a écrit :
> Hi,
>
> Started the work here :
>
> https://github.com/OSGeo/gdal/compare/trunk...jmichel-otb:enhance-complex-datasets 
>
>
> For now, recognizes the following syntax :
>
> gdal_translate -srcwin 1000 1000 1000 1000 
> DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff 
> ~/tmp/test.tif
>
> I need to see about exposing those derived datasets properly.
>
> Antonio, I copied one of your pixel function for fast prototyping, I 
> hope you do not mind. Of course upon completion of this work we should 
> merge properly all your pixel functions with proper 
> credits/copyright/licence. Thing is I did not know where to put them 
> within gdal.
>
> Regards,
>
> Julien
>
> Le 04/07/2016 à 11:06, Even Rouault a écrit :
>> Hi,
>>> To check if I understood well :
>>>
>>> I will create a driver that will recognize the
>>> "DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver
>>> needs to now if "original_datasetname" is of complex type (to report it
>>> can open it)
>> That or we could also possibly accept non-complex types (assume 
>> imaginary part
>> = 0). Antonio's functions handle complex & non-complex AFAICS
>>
>>> , and will also expose the derived band somehow (can I
>>> benefit from the CreateDerivedBand API,
>> If you write it, yes... (it doesn't exist yet if I wasn't clear)
>>
>> If you follow the VRT pixel function road, that's a matter of 
>> building a on-
>> the-fly VRT dataset.
>>
>> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation could 
>> possibly be
>> used. But AFAICS setting the pixel function name isn't supported. 
>> Could be
>> done by implementing CPLErr VRTSourcedRasterBand::SetMetadataItem( 
>> const char
>> *pszName, const char *pszValue, const char *pszDomain ), similarly to 
>> what
>> VRTSourcedRasterBand::SetMetadataItem(...) handles for vrt sources.
>>
>>> and the pixel functions from Antonio ?).
>> Would make sense to internalize this code (uses X/MIT license)
>>
>>> Also, "original_datasetname" can be a subdataset itself.
>> Yes, that shouldn't matter to the driver. It is just a string that it 
>> provides
>> to GDALOpen() (some care must be taken when parsing
>> DERIVED_SUBDATASET:algname:original_datasetname, since 
>> original_datasetname
>> can have columns too)
>>
>>> There should also be a mechanism that will report the existing
>>> DERIVED_SUBDATASETS upon query (this I did not get yet).
>> Implement in GDALDataset, the following method (from GDALMajorObject)
>>
>> virtual char **GetMetadata( const char * pszDomain = "" );
>>
>> char **GDALDataset::GetMetadata( const char * pszDomain = "" )
>> {
>>     if( pszDomain != NULL && EQUAL(pszDomain, "DERIVED_SUBDATASET") )
>>     {
>>         // some stuff. Be careful that ownership of returned char** 
>> belongs
>>         // to the dataset object
>>     }
>>     else
>>         return GDALMajorObject::GetMetadata(pszDomain);
>> }
>>
>> As well as :
>>
>> virtual char **GetMetadataDomainList(); to report DERIVED_SUBDATASET 
>> when it
>> makes sense (contrary to GetMetadata(), ownership of the returned char**
>> belongs to the caller)
>>
>> Even
>>
>
>


-- 
Julien MICHEL
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From even.rouault at spatialys.com  Mon Jul  4 06:04:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jul 2016 15:04:26 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041106.20270.even.rouault@spatialys.com>
 <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
Message-ID: <201607041504.27453.even.rouault@spatialys.com>

Le lundi 04 juillet 2016 14:30:26, Julien Michel a écrit :
> Hi,
> 
> Started the work here :
> 
> https://github.com/OSGeo/gdal/compare/trunk...jmichel-otb:enhance-complex-d
> atasets
> 
> For now, recognizes the following syntax :
> 
> gdal_translate -srcwin 1000 1000 1000 1000
> DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:s1a-s6-slc-vv-20150619t195043-20150619
> t195101-006447-00887d-001.tiff ~/tmp/test.tif
> 
> I need to see about exposing those derived datasets properly.
> 
> Antonio, I copied one of your pixel function for fast prototyping, I
> hope you do not mind. Of course upon completion of this work we should
> merge properly all your pixel functions with proper
> credits/copyright/licence. Thing is I did not know where to put them
> within gdal.

frmts/vrt seem to be the appropriate place, and make the VRTDriver register 
them.

> 
> Regards,
> 
> Julien
> 
> Le 04/07/2016 à 11:06, Even Rouault a écrit :
> > Hi,
> > 
> >> To check if I understood well :
> >> 
> >> I will create a driver that will recognize the
> >> "DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver
> >> needs to now if "original_datasetname" is of complex type (to report it
> >> can open it)
> > 
> > That or we could also possibly accept non-complex types (assume imaginary
> > part = 0). Antonio's functions handle complex & non-complex AFAICS
> > 
> >> , and will also expose the derived band somehow (can I
> >> benefit from the CreateDerivedBand API,
> > 
> > If you write it, yes... (it doesn't exist yet if I wasn't clear)
> > 
> > If you follow the VRT pixel function road, that's a matter of building a
> > on- the-fly VRT dataset.
> > 
> > http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation could possibly
> > be used. But AFAICS setting the pixel function name isn't supported.
> > Could be done by implementing CPLErr
> > VRTSourcedRasterBand::SetMetadataItem( const char *pszName, const char
> > *pszValue, const char *pszDomain ), similarly to what
> > VRTSourcedRasterBand::SetMetadataItem(...) handles for vrt sources.
> > 
> >> and the pixel functions from Antonio ?).
> > 
> > Would make sense to internalize this code (uses X/MIT license)
> > 
> >> Also, "original_datasetname" can be a subdataset itself.
> > 
> > Yes, that shouldn't matter to the driver. It is just a string that it
> > provides to GDALOpen() (some care must be taken when parsing
> > DERIVED_SUBDATASET:algname:original_datasetname, since
> > original_datasetname can have columns too)
> > 
> >> There should also be a mechanism that will report the existing
> >> DERIVED_SUBDATASETS upon query (this I did not get yet).
> > 
> > Implement in GDALDataset, the following method (from GDALMajorObject)
> > 
> > virtual char **GetMetadata( const char * pszDomain = "" );
> > 
> > char **GDALDataset::GetMetadata( const char * pszDomain = "" )
> > {
> > 
> > 	if( pszDomain != NULL && EQUAL(pszDomain, "DERIVED_SUBDATASET") )
> > 	{
> > 	
> > 		// some stuff. Be careful that ownership of returned char** belongs
> > 		// to the dataset object
> > 	
> > 	}
> > 	else
> > 	
> > 		return GDALMajorObject::GetMetadata(pszDomain);
> > 
> > }
> > 
> > As well as :
> > 
> > virtual char **GetMetadataDomainList(); to report DERIVED_SUBDATASET when
> > it makes sense (contrary to GetMetadata(), ownership of the returned
> > char** belongs to the caller)
> > 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From trajce.nikolov.nick at gmail.com  Mon Jul  4 06:18:41 2016
From: trajce.nikolov.nick at gmail.com (Trajce Nikolov NICK)
Date: Mon, 4 Jul 2016 15:18:41 +0200
Subject: [gdal-dev] vertical datums (and the other) catalog update
Message-ID: <CAO-+zik7yp+bNJmF3maLjvK7dpaGHH-3D1ZTfViUDhVtYKG7Bg@mail.gmail.com>

Hello Community,

I am seeing in the data folder lots of catalogs. Just a fast question: How
often they are updated - are they up to date all the time?

Thanks a bunch as alway!

Cheers,
Nick

-- 
trajce nikolov nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160704/ee28dbab/attachment-0001.html>

From CABO at NIRAS.DK  Mon Jul  4 07:23:34 2016
From: CABO at NIRAS.DK (=?iso-8859-1?Q?Casper_B=F8rgesen_=28CABO=29?=)
Date: Mon, 4 Jul 2016 14:23:34 +0000
Subject: [gdal-dev] Is OGR Buffer(...) thread safe in C#?
Message-ID: <BCF6B63AE0B25941A7F56567B58A2805C5751922@allkexa1.NIRAS.INT>

Hi

I was just trying to parallelize buffering of a large set of polygons using GDAL 2.1 in C#.
My code is something like the following:

List<Geometry> polygonList = List of polygons...
var result = new ConcurrentBag<Geometry>();

Parallel.ForEach(polygonList, polygon =>
{
    var polygonBuffer = polygon.Buffer(1, 1);
   result.Add(polygonBuffer);
});

I get a System.AccessViolationException in ogr_csharp.dll on the Buffer(...) line. Since my method runs fine using a normal foreach or if I omit the Buffer(...) method, I assume it has something to do with thread safety and OGR.

So is my problem just that OGR Buffer(...) isn't thread safe or am I doing something wrong here?

Regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160704/4b3dfce4/attachment.html>

From even.rouault at spatialys.com  Mon Jul  4 07:39:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jul 2016 16:39:50 +0200
Subject: [gdal-dev] vertical datums (and the other) catalog update
In-Reply-To: <CAO-+zik7yp+bNJmF3maLjvK7dpaGHH-3D1ZTfViUDhVtYKG7Bg@mail.gmail.com>
References: <CAO-+zik7yp+bNJmF3maLjvK7dpaGHH-3D1ZTfViUDhVtYKG7Bg@mail.gmail.com>
Message-ID: <201607041639.50763.even.rouault@spatialys.com>

Le lundi 04 juillet 2016 15:18:41, Trajce Nikolov NICK a écrit :
> Hello Community,
> 
> I am seeing in the data folder lots of catalogs. Just a fast question: How
> often they are updated -

From GDAL 2.1 NEWS file:
""" * Upgrade to EPSG database v8.8 """

> are they up to date all the time?
They are refreshed from the latest available EPSG database about once a year.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jbe at geo6.be  Mon Jul  4 08:04:53 2016
From: jbe at geo6.be (=?iso-8859-1?Q?Jonathan_Beli=EBn?=)
Date: Mon, 4 Jul 2016 17:04:53 +0200
Subject: [gdal-dev] GML (created via ogr2ogr) validation with OpenGIS XSD
Message-ID: <030f01d1d605$6ca1ab10$45e50130$@geo6.be>

Hi everyone,

 

Im trying to validate a GML file produced with ogr2ogr with OpenGIS GML XSD
files.

 

For every file I try to validate I have the same error message : « element
FeatureCollection: Schemas validity error : Element
'{http://ogr.maptools.org/}FeatureCollection': No matching global
declaration available for the validation root. »

 

I suspect I do something wrong but I cant figure what !?!

 

I tried several -dsco FORMAT parameter and tried to validate on every schema
I could find here http://schemas.opengis.net/gml/ without any success.

 

Does someone know what Im doing wrong or could help me to validate my file
?

 

Thanks a lot !

 

Copy of my test file :

 

<?xml version="1.0" encoding="utf-8" ?>

<ogr:FeatureCollection

     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

     xsi:schemaLocation="http://ogr.maptools.org/ test.xsd"

     xmlns:ogr="http://ogr.maptools.org/"

     xmlns:gml="http://www.opengis.net/gml">

  <gml:boundedBy>

    <gml:Box>

 
<gml:coord><gml:X>3.38653564453125</gml:X><gml:Y>50.41551870402676</gml:Y></
gml:coord>

 
<gml:coord><gml:X>4.57305908203125</gml:X><gml:Y>50.89956852220873</gml:Y></
gml:coord>

    </gml:Box>

  </gml:boundedBy>

 


  <gml:featureMember>

    <ogr:test fid="test.0">

      <ogr:geometryProperty><gml:Polygon
srsName="EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>4.
49066162109375,50.896103955543587 3.38653564453125,50.60415948856101
4.57305908203125,50.415518704026759 3.61724853515625,50.899568522208732
4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing></gml:
outerBoundaryIs></gml:Polygon></ogr:geometryProperty>

      <ogr:userid>userid-1</ogr:userid>

    </ogr:test>

  </gml:featureMember>

  <gml:featureMember>

    <ogr:test fid="test.1">

      <ogr:geometryProperty><gml:MultiPolygon
srsName="EPSG:4326"><gml:polygonMember><gml:Polygon><gml:outerBoundaryIs><gm
l:LinearRing><gml:coordinates>3.921339446183916,50.745568181163129
4.57305908203125,50.415518704026759 3.38653564453125,50.60415948856101
3.921339446183916,50.745568181163129</gml:coordinates></gml:LinearRing></gml
:outerBoundaryIs></gml:Polygon></gml:polygonMember><gml:polygonMember><gml:P
olygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>4.4906616210937
5,50.896103955543587 3.921339446183916,50.745568181163129
3.61724853515625,50.899568522208732
4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing></gml:
outerBoundaryIs></gml:Polygon></gml:polygonMember></gml:MultiPolygon></ogr:g
eometryProperty>

      <ogr:label>label-2</ogr:label>

    </ogr:test>

  </gml:featureMember>

</ogr:FeatureCollection>

 

Jonathan Beliën

GEO-6

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160704/340657b1/attachment.html>

From antonio.valentino at tiscali.it  Mon Jul  4 10:52:40 2016
From: antonio.valentino at tiscali.it (Antonio Valentino)
Date: Mon, 4 Jul 2016 19:52:40 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com>
 <11bffd4d-e457-ebdd-f1cb-16e6490abe5e@cnes.fr>
 <201607041106.20270.even.rouault@spatialys.com>
 <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
Message-ID: <577AA268.5040207@tiscali.it>

Hi Julien,

Il 04/07/2016 14:30, Julien Michel ha scritto:
> Hi,
> 
> Started the work here :
> 
> https://github.com/OSGeo/gdal/compare/trunk...jmichel-otb:enhance-complex-datasets
> 
> 
> For now, recognizes the following syntax :
> 
> gdal_translate -srcwin 1000 1000 1000 1000
> DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff
> ~/tmp/test.tif
> 
> I need to see about exposing those derived datasets properly.
> 
> Antonio, I copied one of your pixel function for fast prototyping, I
> hope you do not mind. Of course upon completion of this work we should

absolutely, I'm happy if it helps

> merge properly all your pixel functions with proper
> credits/copyright/licence. Thing is I did not know where to put them
> within gdal.


cheers

-- 
Antonio Valentino

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: OpenPGP digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160704/1ab2a62c/attachment.sig>

From even.rouault at spatialys.com  Mon Jul  4 11:09:53 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 4 Jul 2016 20:09:53 +0200
Subject: [gdal-dev] GML (created via ogr2ogr) validation with OpenGIS XSD
In-Reply-To: <030f01d1d605$6ca1ab10$45e50130$@geo6.be>
References: <030f01d1d605$6ca1ab10$45e50130$@geo6.be>
Message-ID: <201607042009.54023.even.rouault@spatialys.com>

Le lundi 04 juillet 2016 17:04:53, Jonathan Beliën a écrit :
> Hi everyone,
> 
> 
> 
> Im trying to validate a GML file produced with ogr2ogr with OpenGIS GML
> XSD files.
> 
> 
> 
> For every file I try to validate I have the same error message : « element
> FeatureCollection: Schemas validity error : Element
> '{http://ogr.maptools.org/}FeatureCollection': No matching global
> declaration available for the validation root. »
> 
> 
> 
> I suspect I do something wrong but I cant figure what !?!

As far as I know, files produces with OGR GML driver validate against the 
schemas. You didn't specify which tool you used to do the validation and how 
do you invoked it.

You must validate explictly against the .xsd file generated along side of the 
.gml. This xsd will import the appropriate GML schemas.

Example of successful validation with xmllint/libxml2 :

$ ogr2ogr -f GML poly.gml poly.shp

$ xmllint -noout -schema poly.xsd poly.gml
poly.gml validates

$ ogr2ogr -f GML poly.gml poly.shp -dsco FORMAT=GML3

$ xmllint -noout -schema poly.xsd poly.gml
poly.gml validates


> 
> 
> 
> I tried several -dsco FORMAT parameter and tried to validate on every
> schema I could find here http://schemas.opengis.net/gml/ without any
> success.
> 
> 
> 
> Does someone know what Im doing wrong or could help me to validate my file
> ?
> 
> 
> 
> Thanks a lot !
> 
> 
> 
> Copy of my test file :
> 
> 
> 
> <?xml version="1.0" encoding="utf-8" ?>
> 
> <ogr:FeatureCollection
> 
>      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
> 
>      xsi:schemaLocation="http://ogr.maptools.org/ test.xsd"
> 
>      xmlns:ogr="http://ogr.maptools.org/"
> 
>      xmlns:gml="http://www.opengis.net/gml">
> 
>   <gml:boundedBy>
> 
>     <gml:Box>
> 
> 
> <gml:coord><gml:X>3.38653564453125</gml:X><gml:Y>50.41551870402676</gml:Y><
> / gml:coord>
> 
> 
> <gml:coord><gml:X>4.57305908203125</gml:X><gml:Y>50.89956852220873</gml:Y><
> / gml:coord>
> 
>     </gml:Box>
> 
>   </gml:boundedBy>
> 
> 
> 
> 
>   <gml:featureMember>
> 
>     <ogr:test fid="test.0">
> 
>       <ogr:geometryProperty><gml:Polygon
> srsName="EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>4
> . 49066162109375,50.896103955543587 3.38653564453125,50.60415948856101
> 4.57305908203125,50.415518704026759 3.61724853515625,50.899568522208732
> 4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing></gm
> l: outerBoundaryIs></gml:Polygon></ogr:geometryProperty>
> 
>       <ogr:userid>userid-1</ogr:userid>
> 
>     </ogr:test>
> 
>   </gml:featureMember>
> 
>   <gml:featureMember>
> 
>     <ogr:test fid="test.1">
> 
>       <ogr:geometryProperty><gml:MultiPolygon
> srsName="EPSG:4326"><gml:polygonMember><gml:Polygon><gml:outerBoundaryIs><g
> m l:LinearRing><gml:coordinates>3.921339446183916,50.745568181163129
> 4.57305908203125,50.415518704026759 3.38653564453125,50.60415948856101
> 3.921339446183916,50.745568181163129</gml:coordinates></gml:LinearRing></g
> ml
> 
> :outerBoundaryIs></gml:Polygon></gml:polygonMember><gml:polygonMember><gml:
> :P
> 
> olygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>4.490661621093
> 7 5,50.896103955543587 3.921339446183916,50.745568181163129
> 3.61724853515625,50.899568522208732
> 4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing></gml
> :
> outerBoundaryIs></gml:Polygon></gml:polygonMember></gml:MultiPolygon></ogr
> :g eometryProperty>
> 
>       <ogr:label>label-2</ogr:label>
> 
>     </ogr:test>
> 
>   </gml:featureMember>
> 
> </ogr:FeatureCollection>
> 
> 
> 
> Jonathan Beliën
> 
> GEO-6

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From trajce.nikolov.nick at gmail.com  Mon Jul  4 13:32:23 2016
From: trajce.nikolov.nick at gmail.com (Trajce Nikolov NICK)
Date: Mon, 4 Jul 2016 22:32:23 +0200
Subject: [gdal-dev] vertical datums (and the other) catalog update
In-Reply-To: <201607041639.50763.even.rouault@spatialys.com>
References: <CAO-+zik7yp+bNJmF3maLjvK7dpaGHH-3D1ZTfViUDhVtYKG7Bg@mail.gmail.com>
 <201607041639.50763.even.rouault@spatialys.com>
Message-ID: <CAO-+zi=93H_Hd+P9ttxqaaLmuTLGAsGdzeiradDX-CNj0_+Wjw@mail.gmail.com>

Thanks a bunch Even !

Cheers,
Nick

On Mon, Jul 4, 2016 at 4:39 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 04 juillet 2016 15:18:41, Trajce Nikolov NICK a écrit :
> > Hello Community,
> >
> > I am seeing in the data folder lots of catalogs. Just a fast question:
> How
> > often they are updated -
>
> From GDAL 2.1 NEWS file:
> """ * Upgrade to EPSG database v8.8 """
>
> > are they up to date all the time?
> They are refreshed from the latest available EPSG database about once a
> year.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
trajce nikolov nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160704/9bf83f10/attachment.html>

From philippe.ghesquiere at airbus.com  Tue Jul  5 00:34:31 2016
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Tue, 5 Jul 2016 00:34:31 -0700 (PDT)
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607041018.50794.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201606281239.25031.even.rouault@spatialys.com> <5772E306.3090504@tiscali.it>
 <1467299787210-5274192.post@n6.nabble.com> <5775583C.7090802@tiscali.it>
 <1467355930076-5274296.post@n6.nabble.com> <5776B1E6.6040303@tiscali.it>
 <1467617444210-5274571.post@n6.nabble.com>
 <201607041018.50794.even.rouault@spatialys.com>
Message-ID: <1467704071254-5274688.post@n6.nabble.com>

Dear Even,

Sorry for my late answer, I was onto something different yesterday.

I agree with you, and I did change all function declarations in order to
"export" them in the DLL.
Thus, all functions in both pixfunplugin.c and pixelfunctions.c are now
declared as "C" functions with the CPL_DLL export tag.
I checked with Dependency Walker that all functions are indeed exported
correctly.
What is really weird is that *all I/F variables* in RealPixFunc() function
(for example) seem to be correct *but the 1sr one papoSources*.

Philippe



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Amplitude-virtual-bands-for-complex-datasets-tp5273713p5274688.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jbe at geo6.be  Tue Jul  5 03:33:09 2016
From: jbe at geo6.be (=?utf-8?Q?Jonathan_Beli=C3=ABn?=)
Date: Tue, 5 Jul 2016 12:33:09 +0200
Subject: [gdal-dev] GML (created via ogr2ogr) validation with OpenGIS XSD
In-Reply-To: <201607042009.54023.even.rouault@spatialys.com>
References: <030f01d1d605$6ca1ab10$45e50130$@geo6.be>
 <201607042009.54023.even.rouault@spatialys.com>
Message-ID: <002201d1d6a8$a1a2dcf0$e4e896d0$@geo6.be>

Hi Even,

Thanks a lot for quick and detailed answer.
So simple I didn't thought about it ... what an idiot !

Subsidiary questions : how can I validate my GML file to be sure there is only Simple Features (like no self-intersection for instance) ?

Thanks a lot for your help.

PS: I use xmllint to validate my GML files.

Jonathan Beliën
GEO-6


-----Message d'origine-----
De : Even Rouault [mailto:even.rouault at spatialys.com] 
Envoyé : lundi 4 juillet 2016 20:10
À : gdal-dev at lists.osgeo.org
Cc : Jonathan Beliën
Objet : Re: [gdal-dev] GML (created via ogr2ogr) validation with OpenGIS XSD

Le lundi 04 juillet 2016 17:04:53, Jonathan Beliën a écrit :
> Hi everyone,
> 
> 
> 
> I’m trying to validate a GML file produced with ogr2ogr with OpenGIS 
> GML XSD files.
> 
> 
> 
> For every file I try to validate I have the same error message : « 
> element
> FeatureCollection: Schemas validity error : Element
> '{http://ogr.maptools.org/}FeatureCollection': No matching global 
> declaration available for the validation root. »
> 
> 
> 
> I suspect I do something wrong but I can’t figure what !?!

As far as I know, files produces with OGR GML driver validate against the schemas. You didn't specify which tool you used to do the validation and how do you invoked it.

You must validate explictly against the .xsd file generated along side of the .gml. This xsd will import the appropriate GML schemas.

Example of successful validation with xmllint/libxml2 :

$ ogr2ogr -f GML poly.gml poly.shp

$ xmllint -noout -schema poly.xsd poly.gml poly.gml validates

$ ogr2ogr -f GML poly.gml poly.shp -dsco FORMAT=GML3

$ xmllint -noout -schema poly.xsd poly.gml poly.gml validates


> 
> 
> 
> I tried several -dsco FORMAT parameter and tried to validate on every 
> schema I could find here http://schemas.opengis.net/gml/ without any 
> success.
> 
> 
> 
> Does someone know what I’m doing wrong or could help me to validate my 
> file ?
> 
> 
> 
> Thanks a lot !
> 
> 
> 
> Copy of my test file :
> 
> 
> 
> <?xml version="1.0" encoding="utf-8" ?>
> 
> <ogr:FeatureCollection
> 
>      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
> 
>      xsi:schemaLocation="http://ogr.maptools.org/ test.xsd"
> 
>      xmlns:ogr="http://ogr.maptools.org/"
> 
>      xmlns:gml="http://www.opengis.net/gml">
> 
>   <gml:boundedBy>
> 
>     <gml:Box>
> 
> 
> <gml:coord><gml:X>3.38653564453125</gml:X><gml:Y>50.41551870402676</gm
> l:Y><
> / gml:coord>
> 
> 
> <gml:coord><gml:X>4.57305908203125</gml:X><gml:Y>50.89956852220873</gm
> l:Y><
> / gml:coord>
> 
>     </gml:Box>
> 
>   </gml:boundedBy>
> 
> 
> 
> 
>   <gml:featureMember>
> 
>     <ogr:test fid="test.0">
> 
>       <ogr:geometryProperty><gml:Polygon
> srsName="EPSG:4326"><gml:outerBoundaryIs><gml:LinearRing><gml:coordina
> tes>4 . 49066162109375,50.896103955543587 
> 3.38653564453125,50.60415948856101
> 4.57305908203125,50.415518704026759 
> 3.61724853515625,50.899568522208732
> 4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing>
> </gm
> l: outerBoundaryIs></gml:Polygon></ogr:geometryProperty>
> 
>       <ogr:userid>userid-1</ogr:userid>
> 
>     </ogr:test>
> 
>   </gml:featureMember>
> 
>   <gml:featureMember>
> 
>     <ogr:test fid="test.1">
> 
>       <ogr:geometryProperty><gml:MultiPolygon
> srsName="EPSG:4326"><gml:polygonMember><gml:Polygon><gml:outerBoundary
> Is><g m 
> l:LinearRing><gml:coordinates>3.921339446183916,50.745568181163129
> 4.57305908203125,50.415518704026759 3.38653564453125,50.60415948856101
> 3.921339446183916,50.745568181163129</gml:coordinates></gml:LinearRing
> ></g
> ml
> 
> :outerBoundaryIs></gml:Polygon></gml:polygonMember><gml:polygonMember><gml:
> :P
> 
> olygon><gml:outerBoundaryIs><gml:LinearRing><gml:coordinates>4.4906616
> olygon>21093
> 7 5,50.896103955543587 3.921339446183916,50.745568181163129
> 3.61724853515625,50.899568522208732
> 4.49066162109375,50.896103955543587</gml:coordinates></gml:LinearRing>
> </gml
> :
> outerBoundaryIs></gml:Polygon></gml:polygonMember></gml:MultiPolygon><
> outerBoundaryIs>/ogr
> :g eometryProperty>
> 
>       <ogr:label>label-2</ogr:label>
> 
>     </ogr:test>
> 
>   </gml:featureMember>
> 
> </ogr:FeatureCollection>
> 
> 
> 
> Jonathan Beliën
> 
> GEO-6

--
Spatialys - Geospatial professional services http://www.spatialys.com


From wilfried.karel at geo.tuwien.ac.at  Tue Jul  5 15:35:23 2016
From: wilfried.karel at geo.tuwien.ac.at (Wilfried Karel)
Date: Wed, 6 Jul 2016 00:35:23 +0200
Subject: [gdal-dev] Overview scales
Message-ID: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>

Dear list,

I'd like to use overviews for building image pyramids with a scale
reduction of 2 for photogrammetric applications. While
GDALDataset::BuildOverviews allows for the specification of "overview
decimation factors" as integers only, GDAL seems to interpret these
factors as hints only, and it generates overviews of slightly different
scales if the base image resolution is not divisible by the decimation
factor without remainder. The way that GDAL tries to even out the
varying offsets between the regular image grids not only results in
possibly anisotropic scales in the 2 coordinate directions of overview
images, but it also means that the transformation of image coordinates
from 1 overview to the other is not linear, but a step function (image
content is shifted between -0.5px and +0.5px), and that the sampling
distance is non-constant: there will be 2 neighboring rows and columns
close to the horizontal/vertical center lines of the base image that are
both mapped to neighboring rows and columns of the overview.

Is there any way to force an exact, constant sampling distance of 2
throughout an overview?

What is the reason for this behavior, especially as by GDAL-means, only
integer decimation factors may be specified, anyway? Also, all other
image processing tools that I know of (and that are not based on GDAL)
seem to support a constant sampling distance of exactly 2.

Thanks!
Willi.
-- 
                        _____ _____ _____  Technische Universität Wien
   DI Wilfried Karel   /____// ___//    / Dept. of Geodesy & Geoinform.
  wilfried.karel@     // __ / /__ / // / Research Groups Photogrammetry
 geo.tuwien.ac.at    //__/// /__ / // /   & Remote Sensing
+43 1 58801 12244   /____//____//____/ Gusshausstr. 27-29, A-1040 Wien

From julien.michel at cnes.fr  Wed Jul  6 00:15:13 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Wed, 6 Jul 2016 09:15:13 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607041504.27453.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041106.20270.even.rouault@spatialys.com>
 <5b787ccb-bffd-f525-48ab-be7d35783b6b@cnes.fr>
 <201607041504.27453.even.rouault@spatialys.com>
Message-ID: <f9dc0269-b756-082e-dbf8-e6a6c4ceb895@cnes.fr>

Hi all,

I hacked the SetBand() method so as to report the new medata in 
DERIVED_SUBDATASETS mdd. Now if I gdal info a S1 dataset I get :

$ gdalinfo -nogcp -mdd DERIVED_SUBDATASETS 
s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff
Driver: GTiff/GeoTIFF
Files: s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff
s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff.aux.xml
Size is 17663, 31106
[...]
Metadata (DERIVED_SUBDATASETS):
   DERIVED_SUBDATASET_1_DESC=Complex amplitude of bands from 
/media/michelj/HUGE/LargeInput/SENTINEL1/S1A_S6_SLC__1SSV_20150619T195043/measurement/s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff
DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:/media/michelj/HUGE/LargeInput/SENTINEL1/S1A_S6_SLC__1SSV_20150619T195043/measurement/s1a-s6-slc-vv-20150619t195043-20150619t195101-006447-00887d-001.tiff
[...]
Band 1 Block=17663x1 Type=CInt16, ColorInterp=Gray

Even, I think the AddBand() method is obviously not the right place to 
do that, but I do not get how tweak the GetMetadata() / 
GetMetadataDomainList(). As far as I can tell from the code, datasets 
never directly declare new domains by hacking GetMetadataDomainList(). 
Calling SetMetadataItem() with a new domain is enough to create it (that 
is what I did). But I surely miss something here.

Also, can we discuss syntax (COMPLEX_AMPLITUDE is not very meaningful) 
and behaviour (for now all bands are considered even if they are not 
complex).

Last, it does not work for real subdatasets. For instance, for S2 data :

$ gdalinfo -mdd DERIVED_SUBDATASETS 
SENTINEL2_L1C:S2A_OPER_MTD_SAFL1C_PDMC_20150519T113602_R070_V20130707T172156_20130707T172156.xml:20m:EPSG_32615

Driver: SENTINEL2/Sentinel 2
[...]
Metadata (DERIVED_SUBDATASETS):
   DERIVED_SUBDATASET_1_DESC=Complex amplitude of bands from
   DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:
[...]

But calling
$ gdalinfo 
DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:SENTINEL2_L1C:S2A_OPER_MTD_SAFL1C_PDMC_20150519T113602_R070_V20130707T172156_20130707T172156.xml:20m:EPSG_32615

seems to work.

I will try to do the pixel function proper integration on a separate 
branch, so as to avoid mixing different purposes.

Regards,

Julien

Le 04/07/2016 à 15:04, Even Rouault a écrit :
> Le lundi 04 juillet 2016 14:30:26, Julien Michel a écrit :
>> Hi,
>>
>> Started the work here :
>>
>> https://github.com/OSGeo/gdal/compare/trunk...jmichel-otb:enhance-complex-d
>> atasets
>>
>> For now, recognizes the following syntax :
>>
>> gdal_translate -srcwin 1000 1000 1000 1000
>> DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:s1a-s6-slc-vv-20150619t195043-20150619
>> t195101-006447-00887d-001.tiff ~/tmp/test.tif
>>
>> I need to see about exposing those derived datasets properly.
>>
>> Antonio, I copied one of your pixel function for fast prototyping, I
>> hope you do not mind. Of course upon completion of this work we should
>> merge properly all your pixel functions with proper
>> credits/copyright/licence. Thing is I did not know where to put them
>> within gdal.
> frmts/vrt seem to be the appropriate place, and make the VRTDriver register
> them.
>
>> Regards,
>>
>> Julien
>>
>> Le 04/07/2016 à 11:06, Even Rouault a écrit :
>>> Hi,
>>>
>>>> To check if I understood well :
>>>>
>>>> I will create a driver that will recognize the
>>>> "DERIVED_SUBDATASET:Amplitude:original_datasetname" syntax. This driver
>>>> needs to now if "original_datasetname" is of complex type (to report it
>>>> can open it)
>>> That or we could also possibly accept non-complex types (assume imaginary
>>> part = 0). Antonio's functions handle complex & non-complex AFAICS
>>>
>>>> , and will also expose the derived band somehow (can I
>>>> benefit from the CreateDerivedBand API,
>>> If you write it, yes... (it doesn't exist yet if I wasn't clear)
>>>
>>> If you follow the VRT pixel function road, that's a matter of building a
>>> on- the-fly VRT dataset.
>>>
>>> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation could possibly
>>> be used. But AFAICS setting the pixel function name isn't supported.
>>> Could be done by implementing CPLErr
>>> VRTSourcedRasterBand::SetMetadataItem( const char *pszName, const char
>>> *pszValue, const char *pszDomain ), similarly to what
>>> VRTSourcedRasterBand::SetMetadataItem(...) handles for vrt sources.
>>>
>>>> and the pixel functions from Antonio ?).
>>> Would make sense to internalize this code (uses X/MIT license)
>>>
>>>> Also, "original_datasetname" can be a subdataset itself.
>>> Yes, that shouldn't matter to the driver. It is just a string that it
>>> provides to GDALOpen() (some care must be taken when parsing
>>> DERIVED_SUBDATASET:algname:original_datasetname, since
>>> original_datasetname can have columns too)
>>>
>>>> There should also be a mechanism that will report the existing
>>>> DERIVED_SUBDATASETS upon query (this I did not get yet).
>>> Implement in GDALDataset, the following method (from GDALMajorObject)
>>>
>>> virtual char **GetMetadata( const char * pszDomain = "" );
>>>
>>> char **GDALDataset::GetMetadata( const char * pszDomain = "" )
>>> {
>>>
>>> 	if( pszDomain != NULL && EQUAL(pszDomain, "DERIVED_SUBDATASET") )
>>> 	{
>>> 	
>>> 		// some stuff. Be careful that ownership of returned char** belongs
>>> 		// to the dataset object
>>> 	
>>> 	}
>>> 	else
>>> 	
>>> 		return GDALMajorObject::GetMetadata(pszDomain);
>>>
>>> }
>>>
>>> As well as :
>>>
>>> virtual char **GetMetadataDomainList(); to report DERIVED_SUBDATASET when
>>> it makes sense (contrary to GetMetadata(), ownership of the returned
>>> char** belongs to the caller)
>>>
>>> Even


-- 
Julien MICHEL
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From even.rouault at spatialys.com  Wed Jul  6 01:08:13 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 10:08:13 +0200
Subject: [gdal-dev] Overview scales
In-Reply-To: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
References: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
Message-ID: <201607061008.13766.even.rouault@spatialys.com>

Wilfried,

> 
> I'd like to use overviews for building image pyramids with a scale
> reduction of 2 for photogrammetric applications. While
> GDALDataset::BuildOverviews allows for the specification of "overview
> decimation factors" as integers only, GDAL seems to interpret these
> factors as hints only, and it generates overviews of slightly different
> scales if the base image resolution is not divisible by the decimation
> factor without remainder. The way that GDAL tries to even out the
> varying offsets between the regular image grids not only results in
> possibly anisotropic scales in the 2 coordinate directions of overview
> images, but it also means that the transformation of image coordinates
> from 1 overview to the other is not linear, but a step function (image
> content is shifted between -0.5px and +0.5px), and that the sampling
> distance is non-constant: there will be 2 neighboring rows and columns
> close to the horizontal/vertical center lines of the base image that are
> both mapped to neighboring rows and columns of the overview.

You are talking about nearest resampling right ? I'm not sure the current 
behaviour was really intended. It is more likely just a detail of 
implementation. We could potentially have a "NEAR_CONSTANT_STEP" alternate 
variant that would implement what you mention. But anyway nearest resampling 
is always more or less arbitrary. Even if you have an original image of size 
2N and you compute its overview of factor 2. Which lines do you take : the 2i 
ones or the 2i+1 ones ? For high quality overviews, people use usually other 
resampling methods, and starting with GDAL 2.0, with 
bilinear/cubic/cubicspline/lanczos, you should get "good" results.

> What is the reason for this behavior, especially as by GDAL-means, only
> integer decimation factors may be specified, anyway? 

Because 99% of people use powers of 2 ?

That said, if the overview is initialized (empty) with other means than this 
interface, the overview building should be able to take into account non 
integer decimation factor.

> Also, all other
> image processing tools that I know of (and that are not based on GDAL)
> seem to support a constant sampling distance of exactly 2.
> 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul  6 01:26:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 10:26:50 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <f9dc0269-b756-082e-dbf8-e6a6c4ceb895@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041504.27453.even.rouault@spatialys.com>
 <f9dc0269-b756-082e-dbf8-e6a6c4ceb895@cnes.fr>
Message-ID: <201607061026.50845.even.rouault@spatialys.com>

> 
> Even, I think the AddBand() method is obviously not the right place to
> do that, but I do not get how tweak the GetMetadata() /
> GetMetadataDomainList().

Hum I'm not sure how to better explain. I almost coded it ;-)

> As far as I can tell from the code, datasets
> never directly declare new domains by hacking GetMetadataDomainList().
> Calling SetMetadataItem() with a new domain is enough to create it (that
> is what I did). But I surely miss something here.

We definitely don't want to call SetMetadata() / SetMetadataItem() in generic 
code, as it could have a lot of undesired side effects, like pushing metadata 
to PAM (.aux.xml files) or to the own metadata storage of the driver. IMHO, the 
derived subdataset reporting must rather be done in a "passive" way with 
GetMetadata().

Hum, after all, maybe SetBand() could still do it, but we would need to make 
sure to explicitly call GDALDataset::SetMetadataItem(), and not the potential 
overridden SetMetadataItem() method of a driver.

> 
> Also, can we discuss syntax (COMPLEX_AMPLITUDE is not very meaningful)
> and behaviour (for now all bands are considered even if they are not
> complex).
> 
> Last, it does not work for real subdatasets. For instance, for S2 data :
> 
> $ gdalinfo -mdd DERIVED_SUBDATASETS
> SENTINEL2_L1C:S2A_OPER_MTD_SAFL1C_PDMC_20150519T113602_R070_V20130707T17215
> 6_20130707T172156.xml:20m:EPSG_32615
> 
> Driver: SENTINEL2/Sentinel 2
> [...]
> Metadata (DERIVED_SUBDATASETS):
>    DERIVED_SUBDATASET_1_DESC=Complex amplitude of bands from
>    DERIVED_SUBDATASET_1_NAME=DERIVED_SUBDATASET:COMPLEX_AMPLITUDE:
> [...]

Probably because at the time of SetBand(), the dataset name hasn't been set 
yet on the dataset object. It is generally done at the very end of the Open() 
method, and that's the case of the Sentinel2 driver, and most all other 
drivers that are generally copied&pasted from the same skeleton. So the 
SetBand() way seems to be a dead end, unless we edit all drivers (probably not 
all drivers, just in drivers that can have complex data types) to initialize 
their description earlier. 


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.michel at cnes.fr  Wed Jul  6 01:41:29 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Wed, 6 Jul 2016 10:41:29 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607061026.50845.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041504.27453.even.rouault@spatialys.com>
 <f9dc0269-b756-082e-dbf8-e6a6c4ceb895@cnes.fr>
 <201607061026.50845.even.rouault@spatialys.com>
Message-ID: <ea56bde0-7073-6b2e-5278-234c20cdd6f3@cnes.fr>

Le 06/07/2016 à 10:26, Even Rouault a écrit :
>> Even, I think the AddBand() method is obviously not the right place to
>> do that, but I do not get how tweak the GetMetadata() /
>> GetMetadataDomainList().
> Hum I'm not sure how to better explain. I almost coded it ;-)
Sorry, it is my first time coding into gdal, I need to wrap my head 
around it. I will try again ;)
>
>> As far as I can tell from the code, datasets
>> never directly declare new domains by hacking GetMetadataDomainList().
>> Calling SetMetadataItem() with a new domain is enough to create it (that
>> is what I did). But I surely miss something here.
> We definitely don't want to call SetMetadata() / SetMetadataItem() in generic
> code, as it could have a lot of undesired side effects, like pushing metadata
> to PAM (.aux.xml files) or to the own metadata storage of the driver. IMHO, the
> derived subdataset reporting must rather be done in a "passive" way with
> GetMetadata().
Pushing metadata to PAM actually happens with the current code. I had a 
hard time figuring out why my changes to the derived datasets name did 
not reflect in gdalinfo, before I remember this little xml file ;) I 
understand this is not a desired behaviour.
>
> Probably because at the time of SetBand(), the dataset name hasn't been set
> yet on the dataset object. It is generally done at the very end of the Open()
> method, and that's the case of the Sentinel2 driver, and most all other
> drivers that are generally copied&pasted from the same skeleton. So the
> SetBand() way seems to be a dead end, unless we edit all drivers (probably not
> all drivers, just in drivers that can have complex data types) to initialize
> their description earlier.
>
Ok I will try the other way, and keep you posted.

Regards,

Julien

-- 
Julien MICHEL
CNES - DCT/SI/AP


From julien.michel at cnes.fr  Wed Jul  6 02:28:24 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Wed, 6 Jul 2016 11:28:24 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607061026.50845.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041504.27453.even.rouault@spatialys.com>
 <f9dc0269-b756-082e-dbf8-e6a6c4ceb895@cnes.fr>
 <201607061026.50845.even.rouault@spatialys.com>
Message-ID: <3c267955-6cd1-8548-3154-f084b49ca309@cnes.fr>

Le 06/07/2016 à 10:26, Even Rouault a écrit :
>> Even, I think the AddBand() method is obviously not the right place to
>> >do that, but I do not get how tweak the GetMetadata() /
>> >GetMetadataDomainList().
> Hum I'm not sure how to better explain. I almost coded it;-)
>
I figured it out (or at least I figured out why it was not working at my 
first attempt) : most drivers in frmts have a gdaldataset subclass, 
which override GetMetadataDomainList() and GetMetadata() ... So the 
gdaldataset implementation never gets called. Seems like another dead 
end ...

Julien

-- 
Julien MICHEL
CNES - DCT/SI/AP


From even.rouault at spatialys.com  Wed Jul  6 02:49:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 11:49:08 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <3c267955-6cd1-8548-3154-f084b49ca309@cnes.fr>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607061026.50845.even.rouault@spatialys.com>
 <3c267955-6cd1-8548-3154-f084b49ca309@cnes.fr>
Message-ID: <201607061149.08911.even.rouault@spatialys.com>

Le mercredi 06 juillet 2016 11:28:24, Julien Michel a écrit :
> Le 06/07/2016 à 10:26, Even Rouault a écrit :
> >> Even, I think the AddBand() method is obviously not the right place to
> >> 
> >> >do that, but I do not get how tweak the GetMetadata() /
> >> >GetMetadataDomainList().
> > 
> > Hum I'm not sure how to better explain. I almost coded it;-)
> 
> I figured it out (or at least I figured out why it was not working at my
> first attempt) : most drivers in frmts have a gdaldataset subclass,
> which override GetMetadataDomainList() and GetMetadata() ... So the
> gdaldataset implementation never gets called. Seems like another dead
> end ...

Which ones ? They should call the base method as well.

For example, looking randomly in the HDF4 driver, that should be OK:

/************************************************************************/
/*                      GetMetadataDomainList()                         */
/************************************************************************/

char **HDF4Dataset::GetMetadataDomainList()
{
    return BuildMetadataDomainList(GDALPamDataset::GetMetadataDomainList(),
                                   TRUE,
                                   "SUBDATASETS", NULL);
}

/************************************************************************/
/*                            GetMetadata()                             */
/************************************************************************/

char **HDF4Dataset::GetMetadata( const char *pszDomain )

{
    if( pszDomain != NULL && STARTS_WITH_CI(pszDomain, "SUBDATASETS") )
        return papszSubDatasets;

    return GDALDataset::GetMetadata( pszDomain );
}


I cannot exclude that some do not call the base method, If so, they should be 
fixed.
The GeoTIFF one might be an exception to that, for a whole set of good and bad 
reasons, history, etc... does its own thing regarding metadata handling. But 
we might be able to patch it to call the base method when the domain is 
DERIVED_SUBDATASET.

> 
> Julien

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From wilfried.karel at geo.tuwien.ac.at  Wed Jul  6 03:52:15 2016
From: wilfried.karel at geo.tuwien.ac.at (Wilfried Karel)
Date: Wed, 6 Jul 2016 12:52:15 +0200
Subject: [gdal-dev] Overview scales
In-Reply-To: <201607061008.13766.even.rouault@spatialys.com>
References: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
 <201607061008.13766.even.rouault@spatialys.com>
Message-ID: <79df6e17-fbfc-64e5-15c8-16557219614d@geo.tuwien.ac.at>

Dear Even,

I'm not referring to a specific interpolation method. However, for
checking GDAL's behaviour, nearest-neighbor interpolation is surely the
easiest way. And yes, it may seem arbitrary whether to select only even
rows/columns or only odd rows/columns of the base image when
downsampling by a factor of 2 (although I'd prefer to select even rows,
as that means that the image coordinate systems of overviews only differ
by scales, and not also by shifts - if indices are 0-based and if the
image coordinate systems' origins are at the center of the upper/left
pixel).

However, what seems not arbitrary to me, but is quite an obstacle for me
(and possibly others who would like to use GDAL for doing
photogrammetry), is GDAL's behavior to not use strictly constant
sampling distances, as can be seen in the following example of 1 line of
a base image with 11 columns:

246   7   2 212  93  80 231 174 134  69  24

downsampling by a decimation factor of 2, using nearest-neighbor
interpolation (via GDALDataset::BuildOverviews) results in:

246       2      93     231 174      69

2 neighboring pixels in the base image are both mapped to the overview,
while all other source pixels are separated by a non-mapped source
pixel. That means that there is no linear transformation between image
coordinates in those 2 images. What I would strongly welcome, at least
for the very common decimation factors of 2, would be the following line
in the overview:

246       2      93     231     134      24

In that case, when transforming image coordinates from the overview to
the base image or vice versa, simply the scale factor of 2 would need to
be considered.

Looking into GDAL, it seems to me that (relative) image scales are
always derived from the base image / overview resolutions. While this
may be a good way to handle overviews with arbitrary scales (probably
created with other tools), I find this very distracting when the goal is
to simply have scale factors of exactly 2.
While decimation factors for GDALDataset::BuildOverviews can be
specified as integers only, the actual scale ratios may result as e.g.
1.8999 or so. This ratio is applied and then casted to
integer-coordinates of the source image grid. Hence the 2 neighboring
rows/columns close to the horizontal and vertical center lines of the
source image that are both mapped to the overview image.

I think that scale factors of 2 are the by far most common case. Thus,
I'd vote for rounding scale factors that are "close" to 2 to exactly 2.
However, as I can see it, the derivation of scales by dividing the
resolutions of 2 images is done in multiple places. Hence, this change
would need to be done in all those places, I believe.

Cheers,
Willi.


On 06.07.2016 10:08, Even Rouault wrote:
> Wilfried,
> 
>>
>> I'd like to use overviews for building image pyramids with a scale
>> reduction of 2 for photogrammetric applications. While
>> GDALDataset::BuildOverviews allows for the specification of "overview
>> decimation factors" as integers only, GDAL seems to interpret these
>> factors as hints only, and it generates overviews of slightly different
>> scales if the base image resolution is not divisible by the decimation
>> factor without remainder. The way that GDAL tries to even out the
>> varying offsets between the regular image grids not only results in
>> possibly anisotropic scales in the 2 coordinate directions of overview
>> images, but it also means that the transformation of image coordinates
>> from 1 overview to the other is not linear, but a step function (image
>> content is shifted between -0.5px and +0.5px), and that the sampling
>> distance is non-constant: there will be 2 neighboring rows and columns
>> close to the horizontal/vertical center lines of the base image that are
>> both mapped to neighboring rows and columns of the overview.
> 
> You are talking about nearest resampling right ? I'm not sure the current 
> behaviour was really intended. It is more likely just a detail of 
> implementation. We could potentially have a "NEAR_CONSTANT_STEP" alternate 
> variant that would implement what you mention. But anyway nearest resampling 
> is always more or less arbitrary. Even if you have an original image of size 
> 2N and you compute its overview of factor 2. Which lines do you take : the 2i 
> ones or the 2i+1 ones ? For high quality overviews, people use usually other 
> resampling methods, and starting with GDAL 2.0, with 
> bilinear/cubic/cubicspline/lanczos, you should get "good" results.
> 
>> What is the reason for this behavior, especially as by GDAL-means, only
>> integer decimation factors may be specified, anyway? 
> 
> Because 99% of people use powers of 2 ?
> 
> That said, if the overview is initialized (empty) with other means than this 
> interface, the overview building should be able to take into account non 
> integer decimation factor.
> 
>> Also, all other
>> image processing tools that I know of (and that are not based on GDAL)
>> seem to support a constant sampling distance of exactly 2.
>>
> 
> Even
> 

-- 
                        _____ _____ _____  Technische Universität Wien
   DI Wilfried Karel   /____// ___//    / Dept. of Geodesy & Geoinform.
  wilfried.karel@     // __ / /__ / // / Research Groups Photogrammetry
 geo.tuwien.ac.at    //__/// /__ / // /   & Remote Sensing
+43 1 58801 12244   /____//____//____/ Gusshausstr. 27-29, A-1040 Wien

From even.rouault at spatialys.com  Wed Jul  6 04:45:56 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 13:45:56 +0200
Subject: [gdal-dev] Overview scales
In-Reply-To: <79df6e17-fbfc-64e5-15c8-16557219614d@geo.tuwien.ac.at>
References: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
 <201607061008.13766.even.rouault@spatialys.com>
 <79df6e17-fbfc-64e5-15c8-16557219614d@geo.tuwien.ac.at>
Message-ID: <201607061345.56840.even.rouault@spatialys.com>

Le mercredi 06 juillet 2016 12:52:15, Wilfried Karel a écrit :
> Dear Even,
> 
> I'm not referring to a specific interpolation method. However, for
> checking GDAL's behaviour, nearest-neighbor interpolation is surely the
> easiest way.

I guess the effect is the most distracting with nearest neighbor, as other 
methods do interpolations and thus you cannot map a target pixel to a single 
source pixel, and the effect of taking a non exact sampling factor has less 
visible consequences as the contribution of fractional source pixel is well 
taken into account (at least for those using the generic convolution 
infrastructure: cubic, cubicspline, bilinear and lanczos. Wouldn't be the case 
for Gauss, which apparently due to recent tickets may have its own problems, 
or Mode / Average)

> And yes, it may seem arbitrary whether to select only even
> rows/columns or only odd rows/columns of the base image when
> downsampling by a factor of 2 (although I'd prefer to select even rows,
> as that means that the image coordinate systems of overviews only differ
> by scales, and not also by shifts - if indices are 0-based and if the
> image coordinate systems' origins are at the center of the upper/left
> pixel).
> 
> However, what seems not arbitrary to me, but is quite an obstacle for me
> (and possibly others who would like to use GDAL for doing
> photogrammetry), is GDAL's behavior to not use strictly constant
> sampling distances, as can be seen in the following example of 1 line of
> a base image with 11 columns:
> 
> 246   7   2 212  93  80 231 174 134  69  24
> 
> downsampling by a decimation factor of 2, using nearest-neighbor
> interpolation (via GDALDataset::BuildOverviews) results in:
> 
> 246       2      93     231 174      69
> 
> 2 neighboring pixels in the base image are both mapped to the overview,
> while all other source pixels are separated by a non-mapped source
> pixel. That means that there is no linear transformation between image
> coordinates in those 2 images. What I would strongly welcome, at least
> for the very common decimation factors of 2, would be the following line
> in the overview:
> 
> 246       2      93     231     134      24
> 
> In that case, when transforming image coordinates from the overview to
> the base image or vice versa, simply the scale factor of 2 would need to
> be considered.
> 
> Looking into GDAL, it seems to me that (relative) image scales are
> always derived from the base image / overview resolutions. While this
> may be a good way to handle overviews with arbitrary scales (probably
> created with other tools), I find this very distracting when the goal is
> to simply have scale factors of exactly 2.

OK I see your point.

> While decimation factors for GDALDataset::BuildOverviews can be
> specified as integers only, the actual scale ratios may result as e.g.
> 1.8999 or so. This ratio is applied and then casted to
> integer-coordinates of the source image grid.

A criterion could be that the rounded scale ratio shouldn't account for a 
difference of more than one pixel. Something like :

dfFactor = (float)nFullResSize / nOvrSize
int nClosestIntFactor = (int)(dfFactor + 0.5)
if( ABS(nOvrSize *  nClosestIntFactor - nFullResSize) <= 1 )
	dfFactor = nClosestIntFactor

For non nearest neighbour methods, some care should be taken to ensure that 
for the pixels at the right and bottom of the image, all the source pixels are 
well taken into account. I think that this must be already the case, but 
should be checked.

> Hence the 2 neighboring
> rows/columns close to the horizontal and vertical center lines of the
> source image that are both mapped to the overview image.
> 
> I think that scale factors of 2 are the by far most common case. Thus,
> I'd vote for rounding scale factors that are "close" to 2 to exactly 2.
> However, as I can see it, the derivation of scales by dividing the
> resolutions of 2 images is done in multiple places.
> Hence, this change
> would need to be done in all those places, I believe.

In gcore/rasterio.cpp, in GDALRasterBand::IRasterIO() there's similar logic as 
well for the nearest resampling logic. Other methods end up using overview 
building internally (but there would be likely changes here to do in factor 
computation)

And we would perhaps want the warper alg in alg/gdalwarpkernel.cpp to be 
updated as well. Not sure how much feasible it is however. Would only make 
sense in the cases the warper is used for simple resampling, ie that there's 
no reprojection or GCP/RPC fitting, but the warper kernel doesn't know the 
properties of the src <--> target pixel transformer. It is just a blackbox for 
it. Hum, we could probably skip the warper update, as using it for just 
resampling is overkill since GDAL 2.0 gdal_translate supports the -r 
parameter.

So yes there's a bunch of code change, and also test suite "golden" results to 
be updated. That'd need a champion.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From wilfried.karel at geo.tuwien.ac.at  Wed Jul  6 05:45:25 2016
From: wilfried.karel at geo.tuwien.ac.at (Wilfried Karel)
Date: Wed, 6 Jul 2016 14:45:25 +0200
Subject: [gdal-dev] Overview scales
In-Reply-To: <201607061345.56840.even.rouault@spatialys.com>
References: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
 <201607061008.13766.even.rouault@spatialys.com>
 <79df6e17-fbfc-64e5-15c8-16557219614d@geo.tuwien.ac.at>
 <201607061345.56840.even.rouault@spatialys.com>
Message-ID: <a9fbf70c-c81b-b6fa-1630-7cbeb258b767@geo.tuwien.ac.at>

Dear Even,

On 06.07.2016 13:45, Even Rouault wrote:
> Le mercredi 06 juillet 2016 12:52:15, Wilfried Karel a écrit :
>> Dear Even,
>>
>> I'm not referring to a specific interpolation method. However, for
>> checking GDAL's behaviour, nearest-neighbor interpolation is surely the
>> easiest way.
> 
> I guess the effect is the most distracting with nearest neighbor, as other 
> methods do interpolations and thus you cannot map a target pixel to a single 
> source pixel, and the effect of taking a non exact sampling factor has less 
> visible consequences as the contribution of fractional source pixel is well 
> taken into account (at least for those using the generic convolution 
> infrastructure: cubic, cubicspline, bilinear and lanczos. Wouldn't be the case 
> for Gauss, which apparently due to recent tickets may have its own problems, 
> or Mode / Average)
Yes, with interpolation methods that take into account more than a
single pixel of the source image, this effect will not be that obvious.
But that doesn't resolve the problem if one is interested in more than
just visualization, but e.g. in deriving positions from the image
content, as in least-squares image matching at decreasing image pyramid
levels and/or between images with largely different scales.

> 
>> And yes, it may seem arbitrary whether to select only even
>> rows/columns or only odd rows/columns of the base image when
>> downsampling by a factor of 2 (although I'd prefer to select even rows,
>> as that means that the image coordinate systems of overviews only differ
>> by scales, and not also by shifts - if indices are 0-based and if the
>> image coordinate systems' origins are at the center of the upper/left
>> pixel).
>>
>> However, what seems not arbitrary to me, but is quite an obstacle for me
>> (and possibly others who would like to use GDAL for doing
>> photogrammetry), is GDAL's behavior to not use strictly constant
>> sampling distances, as can be seen in the following example of 1 line of
>> a base image with 11 columns:
>>
>> 246   7   2 212  93  80 231 174 134  69  24
>>
>> downsampling by a decimation factor of 2, using nearest-neighbor
>> interpolation (via GDALDataset::BuildOverviews) results in:
>>
>> 246       2      93     231 174      69
>>
>> 2 neighboring pixels in the base image are both mapped to the overview,
>> while all other source pixels are separated by a non-mapped source
>> pixel. That means that there is no linear transformation between image
>> coordinates in those 2 images. What I would strongly welcome, at least
>> for the very common decimation factors of 2, would be the following line
>> in the overview:
>>
>> 246       2      93     231     134      24
>>
>> In that case, when transforming image coordinates from the overview to
>> the base image or vice versa, simply the scale factor of 2 would need to
>> be considered.
>>
>> Looking into GDAL, it seems to me that (relative) image scales are
>> always derived from the base image / overview resolutions. While this
>> may be a good way to handle overviews with arbitrary scales (probably
>> created with other tools), I find this very distracting when the goal is
>> to simply have scale factors of exactly 2.
> 
> OK I see your point.
> 
>> While decimation factors for GDALDataset::BuildOverviews can be
>> specified as integers only, the actual scale ratios may result as e.g.
>> 1.8999 or so. This ratio is applied and then casted to
>> integer-coordinates of the source image grid.
> 
> A criterion could be that the rounded scale ratio shouldn't account for a 
> difference of more than one pixel. Something like :
> 
> dfFactor = (float)nFullResSize / nOvrSize
> int nClosestIntFactor = (int)(dfFactor + 0.5)
> if( ABS(nOvrSize *  nClosestIntFactor - nFullResSize) <= 1 )
> 	dfFactor = nClosestIntFactor
> 
> For non nearest neighbour methods, some care should be taken to ensure that 
> for the pixels at the right and bottom of the image, all the source pixels are 
> well taken into account. I think that this must be already the case, but 
> should be checked.
> 
>> Hence the 2 neighboring
>> rows/columns close to the horizontal and vertical center lines of the
>> source image that are both mapped to the overview image.
>>
>> I think that scale factors of 2 are the by far most common case. Thus,
>> I'd vote for rounding scale factors that are "close" to 2 to exactly 2.
>> However, as I can see it, the derivation of scales by dividing the
>> resolutions of 2 images is done in multiple places.
>> Hence, this change
>> would need to be done in all those places, I believe.
> 
> In gcore/rasterio.cpp, in GDALRasterBand::IRasterIO() there's similar logic as 
> well for the nearest resampling logic. Other methods end up using overview 
> building internally (but there would be likely changes here to do in factor 
> computation)
> 
> And we would perhaps want the warper alg in alg/gdalwarpkernel.cpp to be 
> updated as well. Not sure how much feasible it is however. Would only make 
> sense in the cases the warper is used for simple resampling, ie that there's 
> no reprojection or GCP/RPC fitting, but the warper kernel doesn't know the 
> properties of the src <--> target pixel transformer. It is just a blackbox for 
> it. Hum, we could probably skip the warper update, as using it for just 
> resampling is overkill since GDAL 2.0 gdal_translate supports the -r 
> parameter.
> 
> So yes there's a bunch of code change, and also test suite "golden" results to 
> be updated. That'd need a champion.
Unfortunately, I'm surely no GDAL champion. So I hope that one of those
picks up this problem!

Cheers,
Willi.
> 
> Even
> 

-- 
                        _____ _____ _____  Technische Universität Wien
   DI Wilfried Karel   /____// ___//    / Dept. of Geodesy & Geoinform.
  wilfried.karel@     // __ / /__ / // / Research Groups Photogrammetry
 geo.tuwien.ac.at    //__/// /__ / // /   & Remote Sensing
+43 1 58801 12244   /____//____//____/ Gusshausstr. 27-29, A-1040 Wien

From even.rouault at spatialys.com  Wed Jul  6 06:02:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 15:02:48 +0200
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
	2.0.3 RC2 and and 2.1.1 RC1 for release
Message-ID: <201607061502.48692.even.rouault@spatialys.com>

Hi,

The explicit feedback has been modest, but positive so far, so :

Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final 
release.

Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.

Motion 3: GDAL/OGR 2.1.1 RC1 is promoted to be the official 2.1.1 final release.

--

My votes :
Motion 1: + 1
Motion 2: + 1
Motion 3: + 1

Best regards,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.michel at cnes.fr  Wed Jul  6 06:15:51 2016
From: julien.michel at cnes.fr (Julien Michel)
Date: Wed, 6 Jul 2016 15:15:51 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607061149.08911.even.rouault@spatialys.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607061026.50845.even.rouault@spatialys.com>
 <3c267955-6cd1-8548-3154-f084b49ca309@cnes.fr>
 <201607061149.08911.even.rouault@spatialys.com>
Message-ID: <932ed16a-2206-2989-2b83-0a36ba375527@cnes.fr>

You were right (what a surprise !). I pushed the new 
GetMetadataDomainList() / GetMetadata() methods to gdaldataset, as well 
as the fix for geotiff (and some other fixes).

Now works like a charm even with subdatasets.

Regards,

Julien


Le 06/07/2016 à 11:49, Even Rouault a écrit :
> Le mercredi 06 juillet 2016 11:28:24, Julien Michel a écrit :
>> Le 06/07/2016 à 10:26, Even Rouault a écrit :
>>>> Even, I think the AddBand() method is obviously not the right place to
>>>>
>>>>> do that, but I do not get how tweak the GetMetadata() /
>>>>> GetMetadataDomainList().
>>> Hum I'm not sure how to better explain. I almost coded it;-)
>> I figured it out (or at least I figured out why it was not working at my
>> first attempt) : most drivers in frmts have a gdaldataset subclass,
>> which override GetMetadataDomainList() and GetMetadata() ... So the
>> gdaldataset implementation never gets called. Seems like another dead
>> end ...
> Which ones ? They should call the base method as well.
>
> For example, looking randomly in the HDF4 driver, that should be OK:
>
> /************************************************************************/
> /*                      GetMetadataDomainList()                         */
> /************************************************************************/
>
> char **HDF4Dataset::GetMetadataDomainList()
> {
>      return BuildMetadataDomainList(GDALPamDataset::GetMetadataDomainList(),
>                                     TRUE,
>                                     "SUBDATASETS", NULL);
> }
>
> /************************************************************************/
> /*                            GetMetadata()                             */
> /************************************************************************/
>
> char **HDF4Dataset::GetMetadata( const char *pszDomain )
>
> {
>      if( pszDomain != NULL && STARTS_WITH_CI(pszDomain, "SUBDATASETS") )
>          return papszSubDatasets;
>
>      return GDALDataset::GetMetadata( pszDomain );
> }
>
>
> I cannot exclude that some do not call the base method, If so, they should be
> fixed.
> The GeoTIFF one might be an exception to that, for a whole set of good and bad
> reasons, history, etc... does its own thing regarding metadata handling. But
> we might be able to patch it to call the base method when the domain is
> DERIVED_SUBDATASET.
>
>> Julien


-- 
Julien MICHEL
CNES - DCT/SI/AP - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From daniele.romagnoli at geo-solutions.it  Wed Jul  6 06:19:28 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed, 6 Jul 2016 15:19:28 +0200
Subject: [gdal-dev] Geotiff FillEmptyTiles with no data value?
In-Reply-To: <201605101529.34814.even.rouault@spatialys.com>
References: <1462299829320-5264310.post@n6.nabble.com>
 <201605061414.06850.even.rouault@spatialys.com>
 <1462864939565-5265514.post@n6.nabble.com>
 <201605101529.34814.even.rouault@spatialys.com>
Message-ID: <CAJaHrDyZXfm_Da+EzGAcwpHey+8gsLEuwA+_C-g7f=HAPOi6Bg@mail.gmail.com>

Hi Even,
has this improvement also being backported on previous versions (as an
instance 2.1.x, 2.0.x)?

Cheers,
Daniele

On Tue, May 10, 2016 at 3:29 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 10 mai 2016 09:22:19, jramm a écrit :
> > Hi
> > I have made changes to FillEmptyTiles so that if nodata is set, then it
> > will always fill with nodata, otherwise 0.
> >
> > I have attached the raw diff...I have no idea how to submit a change
> > request/review etc?
> >
> > fillempty_nodata.diff
> > <http://osgeo-org.1560.x6.nabble.com/file/n5265514/fillempty_nodata.diff
> >
>
> I've committed in trunk a more complete version of your patch since on
> reflection there was also the case of non power-of-two bit depths to
> handle.
>
> Patches are better handled as attachments to Trac tickets.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160706/5adfdaf8/attachment-0001.html>

From cmcgeorge at surgeforward.com  Wed Jul  6 06:38:17 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Wed, 6 Jul 2016 07:38:17 -0600
Subject: [gdal-dev] Test Windows Build
In-Reply-To: <20160702202712.GA20870@norbit.de>
References: <003e01d1d489$d193afa0$74bb0ee0$@surgeforward.com>
 <20160702202712.GA20870@norbit.de>
Message-ID: <001201d1d78b$a7ad6640$f70832c0$@surgeforward.com>

Thank you, Jürgen!  This is exactly what I was looking for.

Thank you,
Chris

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jürgen
E. Fischer
Sent: Saturday, July 2, 2016 2:27 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Test Windows Build

Hi Christopher,

On Sat, 02. Jul 2016 at 11:47:35 -0600, Christopher McGeorge wrote:
> Hi.  Could anyone please suggest a way, preferably one that I can
automate,
> to verify that GDAL Windows builds were successful, such as by running
one
> of the generated exe files in the apps folder?

Does https://trac.osgeo.org/gdal/wiki/TestingNotes help?


Jürgen

--
Jürgen E. Fischer           norBIT GmbH             Tel.
+49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax.
+49-4931-918175-50
Software Engineer           D-26506 Norden
http://www.norbit.de


From even.rouault at spatialys.com  Wed Jul  6 06:48:01 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 15:48:01 +0200
Subject: [gdal-dev] Overview scales
In-Reply-To: <a9fbf70c-c81b-b6fa-1630-7cbeb258b767@geo.tuwien.ac.at>
References: <eddc2c56-f332-4e78-168c-c61521d3a0a1@geo.tuwien.ac.at>
 <201607061345.56840.even.rouault@spatialys.com>
 <a9fbf70c-c81b-b6fa-1630-7cbeb258b767@geo.tuwien.ac.at>
Message-ID: <201607061548.02258.even.rouault@spatialys.com>


> Yes, with interpolation methods that take into account more than a
> single pixel of the source image, this effect will not be that obvious.
> But that doesn't resolve the problem if one is interested in more than
> just visualization, but e.g. in deriving positions from the image
> content, as in least-squares image matching at decreasing image pyramid
> levels and/or between images with largely different scales.

Imagine that you have 101 source pixels and create an overview of 50 pixels.
If you use linear resampling, to compute the first ovr value we will take into 
account the corresponding first 2 source pixels plus a tiny bit of the 3rd 
source pixel, since the spatial extent of the target pixel overlaps a bit that 
pixel. So the contribution of source pixels is evenly distributed to target 
pixels, which seems to me to be the adequate solution, rather than deciding 
that to use 2 source pixels for each target pixel, except the last one.

> > So yes there's a bunch of code change, and also test suite "golden"
> > results to be updated. That'd need a champion.
> 
> Unfortunately, I'm surely no GDAL champion. So I hope that one of those
> picks up this problem!

I meant someone to champion the effort, ie do the work ;-)

> 
> Cheers,
> Willi.
> 
> > Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul  6 06:53:42 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 15:53:42 +0200
Subject: [gdal-dev] Geotiff FillEmptyTiles with no data value?
In-Reply-To: <CAJaHrDyZXfm_Da+EzGAcwpHey+8gsLEuwA+_C-g7f=HAPOi6Bg@mail.gmail.com>
References: <1462299829320-5264310.post@n6.nabble.com>
 <201605101529.34814.even.rouault@spatialys.com>
 <CAJaHrDyZXfm_Da+EzGAcwpHey+8gsLEuwA+_C-g7f=HAPOi6Bg@mail.gmail.com>
Message-ID: <201607061553.42649.even.rouault@spatialys.com>

Daniele,

> has this improvement also being backported on previous versions (as an
> instance 2.1.x, 2.0.x)?

No, trunk only.

You could as well use the SPARSE_OK=TRUE creation option to avoid writting 
blocks at all. Provided that your reader knows how to deal with tile/strips 
with a 0 byte count (GDAL based readers back to the older days are OK)

Even

> 
> Cheers,
> Daniele
> 
> On Tue, May 10, 2016 at 3:29 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le mardi 10 mai 2016 09:22:19, jramm a écrit :
> > > Hi
> > > I have made changes to FillEmptyTiles so that if nodata is set, then it
> > > will always fill with nodata, otherwise 0.
> > > 
> > > I have attached the raw diff...I have no idea how to submit a change
> > > request/review etc?
> > > 
> > > fillempty_nodata.diff
> > > <http://osgeo-org.1560.x6.nabble.com/file/n5265514/fillempty_nodata.dif
> > > f
> > 
> > I've committed in trunk a more complete version of your patch since on
> > reflection there was also the case of non power-of-two bit depths to
> > handle.
> > 
> > Patches are better handled as attachments to Trac tickets.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniele.romagnoli at geo-solutions.it  Wed Jul  6 07:17:32 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Wed, 6 Jul 2016 16:17:32 +0200
Subject: [gdal-dev] Geotiff FillEmptyTiles with no data value?
In-Reply-To: <201607061553.42649.even.rouault@spatialys.com>
References: <1462299829320-5264310.post@n6.nabble.com>
 <201605101529.34814.even.rouault@spatialys.com>
 <CAJaHrDyZXfm_Da+EzGAcwpHey+8gsLEuwA+_C-g7f=HAPOi6Bg@mail.gmail.com>
 <201607061553.42649.even.rouault@spatialys.com>
Message-ID: <CAJaHrDxc1yxiYx6jsaqV7m_gBEH_TA96kR39Gb8mqF3syx+eyQ@mail.gmail.com>

Hi Even,
thanks I'm already using the SPARSE_OK=TRUE to create an empty tiff
and afterwards warp input files on that with SKIP_NOSOURCE=YES.
I have already updated the ImageIO-EXT's TIFFImageReader to deal with
tile/strip with zero byte count.

Final question:
Starting from which GDAL version, SPARSE_OK=TRUE and SKIP_NOSOURCE=YES are
supported?

Thanks for your feedbacks.
Cheers,
Daniele


On Wed, Jul 6, 2016 at 3:53 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Daniele,
>
> > has this improvement also being backported on previous versions (as an
> > instance 2.1.x, 2.0.x)?
>
> No, trunk only.
>
> You could as well use the SPARSE_OK=TRUE creation option to avoid writting
> blocks at all. Provided that your reader knows how to deal with tile/strips
> with a 0 byte count (GDAL based readers back to the older days are OK)
>
> Even
>
> >
> > Cheers,
> > Daniele
> >
> > On Tue, May 10, 2016 at 3:29 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Le mardi 10 mai 2016 09:22:19, jramm a écrit :
> > > > Hi
> > > > I have made changes to FillEmptyTiles so that if nodata is set, then
> it
> > > > will always fill with nodata, otherwise 0.
> > > >
> > > > I have attached the raw diff...I have no idea how to submit a change
> > > > request/review etc?
> > > >
> > > > fillempty_nodata.diff
> > > > <
> http://osgeo-org.1560.x6.nabble.com/file/n5265514/fillempty_nodata.dif
> > > > f
> > >
> > > I've committed in trunk a more complete version of your patch since on
> > > reflection there was also the case of non power-of-two bit depths to
> > > handle.
> > >
> > > Patches are better handled as attachments to Trac tickets.
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160706/a4c2a7c6/attachment.html>

From even.rouault at spatialys.com  Wed Jul  6 07:42:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 6 Jul 2016 16:42:37 +0200
Subject: [gdal-dev] Geotiff FillEmptyTiles with no data value?
In-Reply-To: <CAJaHrDxc1yxiYx6jsaqV7m_gBEH_TA96kR39Gb8mqF3syx+eyQ@mail.gmail.com>
References: <1462299829320-5264310.post@n6.nabble.com>
 <201607061553.42649.even.rouault@spatialys.com>
 <CAJaHrDxc1yxiYx6jsaqV7m_gBEH_TA96kR39Gb8mqF3syx+eyQ@mail.gmail.com>
Message-ID: <201607061642.37899.even.rouault@spatialys.com>

Le mercredi 06 juillet 2016 16:17:32, Daniele Romagnoli a écrit :
> Hi Even,
> thanks I'm already using the SPARSE_OK=TRUE to create an empty tiff
> and afterwards warp input files on that with SKIP_NOSOURCE=YES.
> I have already updated the ImageIO-EXT's TIFFImageReader to deal with
> tile/strip with zero byte count.
> 
> Final question:
> Starting from which GDAL version, SPARSE_OK=TRUE and SKIP_NOSOURCE=YES are
> supported?

Woo, a long time. I wasn't probably even born when they were added. 

Digging a bit in history shows that SPARSE_OK was added in 2008 / GDAL 1.6 and 
SKIP_NOSOURCE in 2006...
Returning the nodata value for implicit blocks instead of 0 was added in 1.7.

> 
> Thanks for your feedbacks.
> Cheers,
> Daniele
> 
> 
> On Wed, Jul 6, 2016 at 3:53 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Daniele,
> > 
> > > has this improvement also being backported on previous versions (as an
> > > instance 2.1.x, 2.0.x)?
> > 
> > No, trunk only.
> > 
> > You could as well use the SPARSE_OK=TRUE creation option to avoid
> > writting blocks at all. Provided that your reader knows how to deal with
> > tile/strips with a 0 byte count (GDAL based readers back to the older
> > days are OK)
> > 
> > Even
> > 
> > > Cheers,
> > > Daniele
> > > 
> > > On Tue, May 10, 2016 at 3:29 PM, Even Rouault <
> > 
> > even.rouault at spatialys.com>
> > 
> > > wrote:
> > > > Le mardi 10 mai 2016 09:22:19, jramm a écrit :
> > > > > Hi
> > > > > I have made changes to FillEmptyTiles so that if nodata is set,
> > > > > then
> > 
> > it
> > 
> > > > > will always fill with nodata, otherwise 0.
> > > > > 
> > > > > I have attached the raw diff...I have no idea how to submit a
> > > > > change request/review etc?
> > > > > 
> > > > > fillempty_nodata.diff
> > > > > <
> > 
> > http://osgeo-org.1560.x6.nabble.com/file/n5265514/fillempty_nodata.dif
> > 
> > > > > f
> > > > 
> > > > I've committed in trunk a more complete version of your patch since
> > > > on reflection there was also the case of non power-of-two bit depths
> > > > to handle.
> > > > 
> > > > Patches are better handled as attachments to Trac tickets.
> > > > 
> > > > Even
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cmcgeorge at surgeforward.com  Wed Jul  6 08:44:46 2016
From: cmcgeorge at surgeforward.com (Christopher McGeorge)
Date: Wed, 6 Jul 2016 09:44:46 -0600
Subject: [gdal-dev] Test Windows Build
In-Reply-To: <001201d1d78b$a7ad6640$f70832c0$@surgeforward.com>
References: <003e01d1d489$d193afa0$74bb0ee0$@surgeforward.com>
 <20160702202712.GA20870@norbit.de>
 <001201d1d78b$a7ad6640$f70832c0$@surgeforward.com>
Message-ID: <003501d1d79d$538138f0$fa83aad0$@surgeforward.com>

Hi, Jürgen.  Do you happen to know of similar tests for the output
executables and libraries?

Thank you,
Chris

-----Original Message-----
From: Christopher McGeorge [mailto:cmcgeorge at surgeforward.com] 
Sent: Wednesday, July 6, 2016 7:38 AM
To: 'Jürgen E. Fischer' <jef at norbit.de>
Cc: gdal-dev at lists.osgeo.org
Subject: RE: [gdal-dev] Test Windows Build

Thank you, Jürgen!  This is exactly what I was looking for.

Thank you,
Chris

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jürgen
E. Fischer
Sent: Saturday, July 2, 2016 2:27 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Test Windows Build

Hi Christopher,

On Sat, 02. Jul 2016 at 11:47:35 -0600, Christopher McGeorge wrote:
> Hi.  Could anyone please suggest a way, preferably one that I can
automate,
> to verify that GDAL Windows builds were successful, such as by running
one
> of the generated exe files in the apps folder?

Does https://trac.osgeo.org/gdal/wiki/TestingNotes help?


Jürgen

--
Jürgen E. Fischer           norBIT GmbH             Tel.
+49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax.
+49-4931-918175-50
Software Engineer           D-26506 Norden
http://www.norbit.de



From dale.o.roberts at gmail.com  Wed Jul  6 13:59:24 2016
From: dale.o.roberts at gmail.com (Dale Roberts)
Date: Wed, 6 Jul 2016 22:59:24 +0200
Subject: [gdal-dev] Quickly view satellite imagery directly in your terminal
Message-ID: <CANbG6pXeCqqxn=p+Q5URtGgVkGcCytt8uPTfRCvTVHasW266cQ@mail.gmail.com>

Dear developers, I thought people on this list might find my latest little
tool entertaining and/or useful:

https://github.com/daleroberts/tv

... and thank you for the great subsampling feature in GDAL 2. I've used it
on a couple of different projects and it's fantastic.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160706/7a889331/attachment.html>

From christian.alfons at saabgroup.com  Wed Jul  6 22:09:09 2016
From: christian.alfons at saabgroup.com (chralf)
Date: Wed, 6 Jul 2016 22:09:09 -0700 (PDT)
Subject: [gdal-dev] gdaladdo -r max?
Message-ID: <1467868149442-5275059.post@n6.nabble.com>

I'm in need of "max" resampling in gdaladdo, to preserve the highest points
in elevation raster overviews. I've found that gdalwarp supports "-r max",
but gdaladdo doesn't.

Can I achieve what I need (with prebuilt GDAL binaries)? (How?)

Will future versions of gdaladdo support "-r max"? (When?)



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdaladdo-r-max-tp5275059.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jul  7 00:57:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 09:57:12 +0200
Subject: [gdal-dev] gdaladdo -r max?
In-Reply-To: <1467868149442-5275059.post@n6.nabble.com>
References: <1467868149442-5275059.post@n6.nabble.com>
Message-ID: <201607070957.12769.even.rouault@spatialys.com>

Christian,

> I'm in need of "max" resampling in gdaladdo, to preserve the highest points
> in elevation raster overviews. I've found that gdalwarp supports "-r max",
> but gdaladdo doesn't.
> 
> Can I achieve what I need (with prebuilt GDAL binaries)? (How?)

You could do it possibly this way :

gdalwarp your.tif your.tif.ovr -ts with_of_your_tif/2 height_of_your_tif/2 -r max
gdalwarp your.tif.ovr your.tif.ovr.ovr -ts with_of_your_tif/4 height_of_your_tif/4 -r max
etc...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul  7 03:32:45 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 12:32:45 +0200
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
	2.0.3 RC2 and and 2.1.1 RC1 for release
In-Reply-To: <201607061502.48692.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
Message-ID: <201607071232.45423.even.rouault@spatialys.com>

Le mercredi 06 juillet 2016 15:02:48, Even Rouault a écrit :
> Hi,
> 
> The explicit feedback has been modest, but positive so far, so :
> 
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.
> 
> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final
> release.
> 
> Motion 3: GDAL/OGR 2.1.1 RC1 is promoted to be the official 2.1.1 final
> release.

I'm changing my vote on Motion 3 (2.1.1RC1) to -1 as I just found that the 
bugfix for #6561 wasn't correct and could emit an annoying warning in 
update/overwrite scenarios that would confuse people. I'll re-issue a RC2 
right away.

> 
> --
> 
> My votes :
> Motion 1: + 1
> Motion 2: + 1
> Motion 3: + 1
> 
> Best regards,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul  7 03:48:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 12:48:34 +0200
Subject: [gdal-dev] GDAL/OGR 2.1.1 RC2 Available for Review
In-Reply-To: <201607031529.33561.even.rouault@spatialys.com>
References: <201607031529.33561.even.rouault@spatialys.com>
Message-ID: <201607071248.34242.even.rouault@spatialys.com>

Hi,

As mentionned just before, I'm retracting RC1 since the bugfix for #6561 was 
only partial.

So here's RC2 :
   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC2.tar.xz
   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC2.tar.gz
   http://download.osgeo.org/gdal/2.1.1/gdal211RC2.zip
   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1RC2.tar.gz
   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1RC2.zip

Besides the above mentionned fix, it comes with 4 extra fixes :
- GTiff driver:
 * fix suboptimal behaviour before regarding flushing of working buffer (#6580)
 * fix race between empty block filling logic and background compression threads 
when using Create() interface and NUM_THREADS creation option (#6582)
- VRT warp: fix issue with partial blocks at the right/bottom and dest nodata 
values that are different per band (#6581)
-  WFS driver: don't crash on empty <Keyword/> declaration (#6586)

I'll call for a new vote tomorrow if nothing ciritical is reported on that 
one.

Even

> Hi,
> 
> And to conclude this bugfixes series, I have prepared a GDAL/OGR 2.1.1
> release candidate. Please review and test.
> 
> Peek up an archive among the following ones (by ascending size):
> 
>   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.xz
>   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.gz
>   http://download.osgeo.org/gdal/2.1.1/gdal211RC1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
>   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.tar.gz
>   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.zip
> 
> The NEWS file is here :
> 
>   http://trac.osgeo.org/gdal/wiki/Release/2.1.1-News
> 
> I'll call for a vote promoting it to final in the next days if no
> serious problems are reported before.
> 
> Best regards,
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul  7 04:49:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 13:49:32 +0200
Subject: [gdal-dev] Quickly view satellite imagery directly in your
	terminal
In-Reply-To: <CANbG6pXeCqqxn=p+Q5URtGgVkGcCytt8uPTfRCvTVHasW266cQ@mail.gmail.com>
References: <CANbG6pXeCqqxn=p+Q5URtGgVkGcCytt8uPTfRCvTVHasW266cQ@mail.gmail.com>
Message-ID: <201607071349.33062.even.rouault@spatialys.com>

Le mercredi 06 juillet 2016 22:59:24, Dale Roberts a écrit :
> Dear developers, I thought people on this list might find my latest little
> tool entertaining and/or useful:
> 
> https://github.com/daleroberts/tv
> 
> ... and thank you for the great subsampling feature in GDAL 2. I've used it
> on a couple of different projects and it's fantastic.

Dale,

The concept is cool. It reminds me a bit of the MapServer easter-egg text format :
http://demo.mapserver.org/cgi-
bin/mapserv?map=/osgeo/mapserver/msautotest/world/world.map&service=WMS&request=GetMap&layers=WMS_TEST&VERSION=1.1.0&SRS=EPSG:4326&BBOX=-180,-90,180,90&FORMAT=image/txt
Except that MapServer text output is hard-coded. So if your utility was ported
as a GDAL driver, MapServer could have a real text output !!!

I tried tv on Ubuntu, but it seems that my terminal (gnome-terminal) is much less
capable as yours and the result is hardly readable. I did try the -unicodes 1 or 2 flag,
but with no better result. In your readme, you mention the hiptext utility and it gave
acceptable results (probably not ideal w.r.t. the potential of tv, as show in your
side-by-side comparisons). I also noticed that tv is quite slow compared to hiptext (even on very small rasters, like 20x20 pixels).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Thu Jul  7 05:53:04 2016
From: jamessramm at gmail.com (jramm)
Date: Thu, 7 Jul 2016 05:53:04 -0700 (PDT)
Subject: [gdal-dev] File Geodatabase raster driver
Message-ID: <1467895984830-5275154.post@n6.nabble.com>

Based on Even's work on FGDB vector, I have begun looking at raster data,
here: https://github.com/JamesRamm/fgdb_raster_spec

So far everything I've found is pretty much based on the output of v the
dump_gdb script. I have two troubling areas currently blocking progress 

1. I can locate pixel data blocks but cannot decipher how to read them, even
when the contents are known.

2. It is unclear how more than one raster is handled. It appears to be based
solely on the names of files but any patterns/groupings are not obvious 

Does anyone have any more experience with this or any tips on how to
proceed?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/File-Geodatabase-raster-driver-tp5275154.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jul  7 07:22:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 16:22:51 +0200
Subject: [gdal-dev] File Geodatabase raster driver
In-Reply-To: <1467895984830-5275154.post@n6.nabble.com>
References: <1467895984830-5275154.post@n6.nabble.com>
Message-ID: <201607071622.52274.even.rouault@spatialys.com>

Le jeudi 07 juillet 2016 14:53:04, jramm a écrit :
> Based on Even's work on FGDB vector, I have begun looking at raster data,
> here: https://github.com/JamesRamm/fgdb_raster_spec
> 
> So far everything I've found is pretty much based on the output of v the
> dump_gdb script. I have two troubling areas currently blocking progress
> 
> 1. I can locate pixel data blocks but cannot decipher how to read them,
> even when the contents are known.

So if I look at all_ones.gdb/a0000000c.gdbtable the challenge is to decypher 
the block_data records ?

I see they begin with 0x78 0x9c bytes which is the zlib magic header for 
deflate default compression ( http://stackoverflow.com/questions/9050260/what-
does-a-zlib-header-look-like ).

So after running the blob through :
import zlib
val = zlib.decompress(val)

I get a 67584 uncompressed blob, that starts with :
00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 01 00 00 00 01 followed by 7F FF 
FF FF to pad the line, that repeated 5 times. Which seems to match the 
Field: band_width : 5
Field: band_height : 5
declaration.
To have lines of 128x4, I guess the shape of your raster is more a diamond of 
ones and not a square ?
At offset 0x10000, there's 2048 bytes of trailer content, most of them being 
zeroed and a few 0xF8 bytes. Probably not very important for decoding.

> 
> 2. It is unclear how more than one raster is handled. It appears to be
> based solely on the names of files but any patterns/groupings are not
> obvious

Not sure to understand but it looks to be the same as for vector bands, ie you 
have to cross compare the a00000001.gdbtable and a00000004.gdbtable

a00000001.gdbtable:

FID = 9 ---> a00000009.gdbtable
feature_offset = 302
blob_len = 13
Field: Name : "all_ones"
Field: FileFormat : 0

FID = 10 ---> a0000000a.gdbtable   0xa=10
feature_offset = 319
blob_len = 22
Field: Name : "fras_ras_all_ones"
Field: FileFormat : 0

FID = 11 ---> a0000000b.gdbtable    0xb=11
feature_offset = 345
blob_len = 22
Field: Name : "fras_aux_all_ones"
Field: FileFormat : 0

FID = 12
feature_offset = 371
blob_len = 22
Field: Name : "fras_blk_all_ones"
Field: FileFormat : 0

FID = 13
feature_offset = 397
blob_len = 22
Field: Name : "fras_bnd_all_ones"
Field: FileFormat : 0


a00000004.gdbtable:
FID = 3
feature_offset = 1633
blob_len = 4214
flags = [120, 212]
Field: UUID : "393a7e99ffc3c244b029422a075064fd"
Field: Type : "a367d65ea99ca2448029d95bf23704b9"
Field: Name : "all_ones"
Field: PhysicalName : "ALL_ONES"
Field: Path : "\all_ones"
Field: DatasetSubtype1 : NULL
Field: DatasetSubtype2 : NULL
Field: DatasetInfo1 : NULL
Field: DatasetInfo2 : NULL
Field: URL : ""


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Thu Jul  7 09:02:41 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 7 Jul 2016 13:02:41 -0300
Subject: [gdal-dev] GDAL/OGR 2.1.1 RC2 Available for Review
In-Reply-To: <201607071248.34242.even.rouault@spatialys.com>
References: <201607031529.33561.even.rouault@spatialys.com>
 <201607071248.34242.even.rouault@spatialys.com>
Message-ID: <0fdf611c-39a2-cf60-21b4-e850b690497f@gatewaygeomatics.com>

Hi Even,

Tested RC2 on Windows fine with MSVC 2015.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-07-07 7:48 AM, Even Rouault wrote:
> Hi,
>
> As mentionned just before, I'm retracting RC1 since the bugfix for #6561 was
> only partial.
>
> So here's RC2 :
>    http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC2.tar.xz
>    http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC2.tar.gz
>    http://download.osgeo.org/gdal/2.1.1/gdal211RC2.zip
>    http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1RC2.tar.gz
>    http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1RC2.zip
>
> Besides the above mentionned fix, it comes with 4 extra fixes :
> - GTiff driver:
>  * fix suboptimal behaviour before regarding flushing of working buffer (#6580)
>  * fix race between empty block filling logic and background compression threads
> when using Create() interface and NUM_THREADS creation option (#6582)
> - VRT warp: fix issue with partial blocks at the right/bottom and dest nodata
> values that are different per band (#6581)
> -  WFS driver: don't crash on empty <Keyword/> declaration (#6586)
>
> I'll call for a new vote tomorrow if nothing ciritical is reported on that
> one.
>
> Even
>
>> Hi,
>>
>> And to conclude this bugfixes series, I have prepared a GDAL/OGR 2.1.1
>> release candidate. Please review and test.
>>
>> Peek up an archive among the following ones (by ascending size):
>>
>>   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.xz
>>   http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1RC1.tar.gz
>>   http://download.osgeo.org/gdal/2.1.1/gdal211RC1.zip
>>
>> A snapshot of the gdalautotest suite is also available :
>>
>>   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.tar.gz
>>   http://download.osgeo.org/gdal/2.1.1/gdalautotest-2.1.1.zip
>>
>> The NEWS file is here :
>>
>>   http://trac.osgeo.org/gdal/wiki/Release/2.1.1-News
>>
>> I'll call for a vote promoting it to final in the next days if no
>> serious problems are reported before.
>>
>> Best regards,
>>
>> Even
>



From William.Kelly.Magee at leidos.com  Thu Jul  7 09:31:30 2016
From: William.Kelly.Magee at leidos.com (William Kelly Magee)
Date: Thu, 7 Jul 2016 12:31:30 -0400
Subject: [gdal-dev] Failure Building GEOS on Windows w/Mingw
Message-ID: <577E83E2.8090906@leidos.com>

Hello

I am using GDAL-1.11.1 and have built it to use GEOS successfully on 
Linux.  I need to build the same on Windows and am using Mingw32.  No 
problem with GDAL but am running into an issue building GEOS on Windows 
using Mingw.  I have searched the GEOS site but cannot find a solution.  
The GEOS build failure is as follows;

    Making all in locate
    make[4]: Entering directory
    `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm/locate'
    .deps/IndexedPointInAreaLocator.Plo:1: *** multiple target
    patterns.  Stop.
    make[4]: Leaving directory
    `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm/locate'
    Makefile:556: recipe for target `all-recursive' failed
    make[3]: *** [all-recursive] Error 1
    make[3]: Leaving directory
    `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm'
    Makefile:595: recipe for target `all-recursive' failed
    make[2]: *** [all-recursive] Error 1
    make[2]: Leaving directory `/cygdrive/c/build/geos/geos-3.5.0/src'
    Makefile:469: recipe for target `all-recursive' failed
    make[1]: *** [all-recursive] Error 1
    make[1]: Leaving directory `/cygdrive/c/build/geos/geos-3.5.0'
    Makefile:416: recipe for target `all' failed
    make: *** [all] Error 2

I have tried both mingw32-make and (cygwin's) make, and still cannot get 
a clean build.

The arguments I am specifying to configure are;

    sh configure --build=mingw32 --enable-static=no -enable-shared=yes
    --disable-inline


Any suggestions (aside from not using Windows) are greatly appreciated.

- Kelly


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160707/d1567b6a/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Thu Jul  7 09:42:37 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 7 Jul 2016 13:42:37 -0300
Subject: [gdal-dev] Failure Building GEOS on Windows w/Mingw
In-Reply-To: <577E83E2.8090906@leidos.com>
References: <577E83E2.8090906@leidos.com>
Message-ID: <de2374ad-2bc2-7304-a992-6858bb73d458@gatewaygeomatics.com>

I often ask my GEOS build questions direct to the GEOS community: 
subscribe at https://lists.osgeo.org/mailman/listinfo/geos-devel

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/



On 2016-07-07 1:31 PM, William Kelly Magee wrote:
> Hello
>
> I am using GDAL-1.11.1 and have built it to use GEOS successfully on
> Linux.  I need to build the same on Windows and am using Mingw32.  No
> problem with GDAL but am running into an issue building GEOS on Windows
> using Mingw.  I have searched the GEOS site but cannot find a solution.
> The GEOS build failure is as follows;
>
>     Making all in locate
>     make[4]: Entering directory
>     `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm/locate'
>     .deps/IndexedPointInAreaLocator.Plo:1: *** multiple target
>     patterns.  Stop.
>     make[4]: Leaving directory
>     `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm/locate'
>     Makefile:556: recipe for target `all-recursive' failed
>     make[3]: *** [all-recursive] Error 1
>     make[3]: Leaving directory
>     `/cygdrive/c/build/geos/geos-3.5.0/src/algorithm'
>     Makefile:595: recipe for target `all-recursive' failed
>     make[2]: *** [all-recursive] Error 1
>     make[2]: Leaving directory `/cygdrive/c/build/geos/geos-3.5.0/src'
>     Makefile:469: recipe for target `all-recursive' failed
>     make[1]: *** [all-recursive] Error 1
>     make[1]: Leaving directory `/cygdrive/c/build/geos/geos-3.5.0'
>     Makefile:416: recipe for target `all' failed
>     make: *** [all] Error 2
>
> I have tried both mingw32-make and (cygwin's) make, and still cannot get
> a clean build.
>
> The arguments I am specifying to configure are;
>
>     sh configure --build=mingw32 --enable-static=no -enable-shared=yes
>     --disable-inline
>
>
> Any suggestions (aside from not using Windows) are greatly appreciated.
>
> - Kelly
>
>

From even.rouault at spatialys.com  Thu Jul  7 09:49:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 7 Jul 2016 18:49:15 +0200
Subject: [gdal-dev] Failure Building GEOS on Windows w/Mingw
In-Reply-To: <577E83E2.8090906@leidos.com>
References: <577E83E2.8090906@leidos.com>
Message-ID: <201607071849.15492.even.rouault@spatialys.com>

Le jeudi 07 juillet 2016 18:31:30, William Kelly Magee a écrit :
> Hello
> 
> I am using GDAL-1.11.1 and have built it to use GEOS successfully on
> Linux.  I need to build the same on Windows and am using Mingw32.  No
> problem with GDAL but am running into an issue building GEOS on Windows
> using Mingw.  I have searched the GEOS site but cannot find a solution.

Not sure if that's what you meant by "site", but in case not, there's a 
dedicated GEOS mailing list :
https://lists.osgeo.org/mailman/listinfo/geos-devel

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  8 03:02:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Jul 2016 12:02:10 +0200
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
	2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607071232.45423.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
Message-ID: <201607081202.10600.even.rouault@spatialys.com>

Hi,

Motions under vote:
Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final 
release.

Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.

To replace the retracted motion 3:
Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final 
release.

--

My votes :
Motion 1: + 1
Motion 2: + 1
Motion 3bis: + 1

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  8 07:31:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Jul 2016 16:31:11 +0200
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
Message-ID: <201607081631.11872.even.rouault@spatialys.com>

Hi,

The topic of sparse dataset management come back regularly, so I've decided to 
tackle it.

Please find https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements 
for review.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew at dcs.bbk.ac.uk  Fri Jul  8 08:17:07 2016
From: andrew at dcs.bbk.ac.uk (Andrew Watkins)
Date: Fri, 8 Jul 2016 16:17:07 +0100
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
	solaris 11
Message-ID: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>

Hello,

I know it crazy, but any pointers would be great.

I am trying to build GDAL 2.1 using Oracle Developer Studio 12.5 
(formally  Sun Studio12) on Solaris 11, but it fails at first CC.

./configure CC='cc -m64' CXX='CC -m64' CPPFLAGS=-m64 CXXFLAGS=-m64 
--without-libtool

GDAL is now configured for x86_64-pc-solaris2.11

   Installation directory:    /usr/local
   C compiler:                cc -m64 -g -fPIC
   C++ compiler:              CC -m64 -m64 -fPIC

   LIBTOOL support:           no

   LIBZ support:              external
   LIBLZMA support:           no
   cryptopp support:          no
   GRASS support:             no
   CFITSIO support:           no
   PCRaster support:          internal
   LIBPNG support:            external
   DDS support:               no
   GTA support:               no
   LIBTIFF support:           internal (BigTIFF=yes)
   LIBGEOTIFF support:        internal
   LIBJPEG support:           internal
   12 bit JPEG:               yes
   12 bit JPEG-in-TIFF:       yes
   LIBGIF support:            internal
   OGDI support:              no
   HDF4 support:              no
   HDF5 support:              no
   Kea support:               no
   NetCDF support:            no
   Kakadu support:            no
   JasPer support:            no
   OpenJPEG support:          no
   ECW support:               no
   MrSID support:             no
   MrSID/MG4 Lidar support:   no
   MSG support:               no
   GRIB support:              yes
   EPSILON support:           no
   WebP support:              no
   cURL support (wms/wcs/...):yes
   PostgreSQL support:        no
   MRF support:               yes
   MySQL support:             no
   Ingres support:            no
   Xerces-C support:          no
   NAS support:               no
   Expat support:             yes
   libxml2 support:           yes
   Google libkml support:     no
   ODBC support:              no
   PGeo support:              no
   FGDB support:              no
   MDB support:               no
   PCIDSK support:            internal
   OCI support:               no
   GEORASTER support:         no
   SDE support:               no
   Rasdaman support:          no
   DODS support:              no
   SQLite support:            yes
   PCRE support:              no
   SpatiaLite support:        no
   DWGdirect support          no
   INFORMIX DataBlade support:no
   GEOS support:              no
   QHull support:             internal
   Poppler support:           no
   Podofo support:            no
   PDFium support:            no
   OpenCL support:            no
   Armadillo support:         no
   FreeXL support:            no
   SOSI support:              no
   MongoDB support:           no


   SWIG Bindings:             no

   Statically link PROJ.4:    no
   enable GNM building:       no
   enable pthread support:    yes
   enable POSIX iconv support:yes
   hide internal symbols:     no

$ gmake
(cd port; gmake)
gmake[1]: Entering directory `/tmp/gdal-2.1.0/port'
CC -m64 -I/tmp/gdal-2.1.0/port -I/tmp/gdal-2.1.0/gcore 
-I/tmp/gdal-2.1.0/alg -I/tmp/gdal-2.1.0/ogr 
-I/tmp/gdal-2.1.0/ogr/ogrsf_frmts -I/tmp/gdal-2.1.0/gnm 
-I/tmp/gdal-2.1.0/apps -m64 -fPIC  -Wall -Wextra -Winit-self 
-Wunused-parameter -Wformat -Werror=format-security 
-Wno-format-nonliteral -Wshorten-64-to-32 -Wlogical-op -Wshadow 
-Werror=vla -Wnull-dereference -Wduplicated-cond -Wunused-private-field 
-Wmissing-prototypes -Wmissing-declarations -Wnon-virtual-dtor 
-Woverloaded-virtual -fno-operator-names  -DOGR_ENABLED -m64 
-I/tmp/gdal-2.1.0/port -DGDAL_COMPILATION        -DHAVE_CURL -DHAVE_LIBZ 
-I/usr/include/libxml2 -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c -o 
cpl_conv.o cpl_conv.cpp
CC: Warning: Option -fno-operator-names passed to ld, if ld is invoked, 
ignored otherwise
"cpl_conv.cpp", line 225: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 919: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 942: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 965: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 994: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 1056: Error: The function "strncasecmp" must have a 
prototype.
"cpl_conv.cpp", line 1255: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 1303: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 1342: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 1348: Error: The function "strncasecmp" must have a 
prototype.
"cpl_conv.cpp", line 1349: Error: The function "snprintf" must have a 
prototype.
"cpl_conv.cpp", line 1940: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 1942: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2137: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2591: Error: The function "symlink" must have a 
prototype.
"cpl_conv.cpp", line 2612: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2613: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2655: Error: The function "strcasecmp" must have a 
prototype.
"cpl_conv.cpp", line 2656: Error: The function "strcasecmp" must have a 
prototype.
Compilation aborted, too many Error messages.
gmake[1]: *** [cpl_conv.o] Error 2
gmake[1]: Leaving directory `/tmp/gdal-2.1.0/port'
gmake: *** [port-target] Error 2

Thanks,

Andrew


-- 
Andrew Watkins * Birkbeck, University of London * Computer Science *
* http://notallmicrosoft.blogspot.com *
* UKOUG Systems SIG Chair *
* UKOUG Tech committee *
* tel: 020 7631 6720 *

  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160708/8352be0d/attachment.html>

From michael.smith.erdc at gmail.com  Fri Jul  8 08:25:40 2016
From: michael.smith.erdc at gmail.com (Michael Smith)
Date: Fri, 08 Jul 2016 11:25:40 -0400
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
 solaris 11
In-Reply-To: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
References: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
Message-ID: <D3A53DC0.D0300%michael.smith.erdc@gmail.com>

I've only compiled GDAL on solaris using the gcc compiler. You might want to
try that.

Mike

-- 
Michael Smith
Remote Sensing/GIS Center
US Army Corps of Engineers

From:  gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andrew
Watkins <andrew at dcs.bbk.ac.uk>
Date:  Friday, July 8, 2016 at  11:17 AM
To:  <gdal-dev at lists.osgeo.org>
Subject:  [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
solaris 11

>     
>  
> 
> Hello,
>  
> 
> I know it crazy, but any pointers would be great.
>  
> 
> I am trying to build GDAL 2.1 using Oracle Developer Studio 12.5  (formally
> Sun Studio12) on Solaris 11, but it fails at first CC.
>  
> 
> ./configure CC='cc -m64' CXX='CC -m64' CPPFLAGS=-m64 CXXFLAGS=-m64
> --without-libtool
>  
> 
> GDAL is now configured for x86_64-pc-solaris2.11
>  
>    Installation directory:    /usr/local
>    C compiler:                cc -m64 -g -fPIC
>    C++ compiler:              CC -m64 -m64 -fPIC
>  
>    LIBTOOL support:           no
>  
>    LIBZ support:              external
>    LIBLZMA support:           no
>    cryptopp support:          no
>    GRASS support:             no
>    CFITSIO support:           no
>    PCRaster support:          internal
>    LIBPNG support:            external
>    DDS support:               no
>    GTA support:               no
>    LIBTIFF support:           internal (BigTIFF=yes)
>    LIBGEOTIFF support:        internal
>    LIBJPEG support:           internal
>    12 bit JPEG:               yes
>    12 bit JPEG-in-TIFF:       yes
>    LIBGIF support:            internal
>    OGDI support:              no
>    HDF4 support:              no
>    HDF5 support:              no
>    Kea support:               no
>    NetCDF support:            no
>    Kakadu support:            no
>    JasPer support:            no
>    OpenJPEG support:          no
>    ECW support:               no
>    MrSID support:             no
>    MrSID/MG4 Lidar support:   no
>    MSG support:               no
>    GRIB support:              yes
>    EPSILON support:           no
>    WebP support:              no
>    cURL support (wms/wcs/...):yes
>    PostgreSQL support:        no
>    MRF support:               yes
>    MySQL support:             no
>    Ingres support:            no
>    Xerces-C support:          no
>    NAS support:               no
>    Expat support:             yes
>    libxml2 support:           yes
>    Google libkml support:     no
>    ODBC support:              no
>    PGeo support:              no
>    FGDB support:              no
>    MDB support:               no
>    PCIDSK support:            internal
>    OCI support:               no
>    GEORASTER support:         no
>    SDE support:               no
>    Rasdaman support:          no
>    DODS support:              no
>    SQLite support:            yes
>    PCRE support:              no
>    SpatiaLite support:        no
>    DWGdirect support          no
>    INFORMIX DataBlade support:no
>    GEOS support:              no
>    QHull support:             internal
>    Poppler support:           no
>    Podofo support:            no
>    PDFium support:            no
>    OpenCL support:            no
>    Armadillo support:         no
>    FreeXL support:            no
>    SOSI support:              no
>    MongoDB support:           no
>  
>  
>    SWIG Bindings:             no
>  
>    Statically link PROJ.4:    no
>    enable GNM building:       no
>    enable pthread support:    yes
>    enable POSIX iconv support:yes
>    hide internal symbols:     no
>  
>  
> 
> $ gmake
>  (cd port; gmake)
>  gmake[1]: Entering directory `/tmp/gdal-2.1.0/port'
>  CC -m64 -I/tmp/gdal-2.1.0/port -I/tmp/gdal-2.1.0/gcore -I/tmp/gdal-2.1.0/alg
> -I/tmp/gdal-2.1.0/ogr -I/tmp/gdal-2.1.0/ogr/ogrsf_frmts -I/tmp/gdal-2.1.0/gnm
> -I/tmp/gdal-2.1.0/apps -m64 -fPIC  -Wall -Wextra -Winit-self
> -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral
> -Wshorten-64-to-32 -Wlogical-op -Wshadow -Werror=vla -Wnull-dereference
> -Wduplicated-cond -Wunused-private-field -Wmissing-prototypes
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> -fno-operator-names  -DOGR_ENABLED -m64 -I/tmp/gdal-2.1.0/port
> -DGDAL_COMPILATION        -DHAVE_CURL -DHAVE_LIBZ -I/usr/include/libxml2
> -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c -o cpl_conv.o cpl_conv.cpp
>  CC: Warning: Option -fno-operator-names passed to ld, if ld is invoked,
> ignored otherwise
>  "cpl_conv.cpp", line 225: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 919: Error: The function "atoll" must have a prototype.
>  "cpl_conv.cpp", line 942: Error: The function "atoll" must have a prototype.
>  "cpl_conv.cpp", line 965: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 994: Error: The function "atoll" must have a prototype.
>  "cpl_conv.cpp", line 1056: Error: The function "strncasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 1255: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 1303: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 1342: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 1348: Error: The function "strncasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 1349: Error: The function "snprintf" must have a
> prototype.
>  "cpl_conv.cpp", line 1940: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 1942: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2137: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2591: Error: The function "symlink" must have a
> prototype.
>  "cpl_conv.cpp", line 2612: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2613: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2655: Error: The function "strcasecmp" must have a
> prototype.
>  "cpl_conv.cpp", line 2656: Error: The function "strcasecmp" must have a
> prototype.
>  Compilation aborted, too many Error messages.
>  gmake[1]: *** [cpl_conv.o] Error 2
>  gmake[1]: Leaving directory `/tmp/gdal-2.1.0/port'
>  gmake: *** [port-target] Error 2
>  
>  
> 
> Thanks,
>  
> 
> Andrew
>  
>  
> 
> 
>  
>  
> -- 
> Andrew Watkins * Birkbeck, University of London * Computer Science *
> * http://notallmicrosoft.blogspot.com *
> * UKOUG Systems SIG Chair *
> * UKOUG Tech committee *
> * tel: 020 7631 6720 *
> 
>  
> 
>  
> _______________________________________________ gdal-dev mailing list
> gdal-dev at lists.osgeo.org http://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160708/baa19e84/attachment-0001.html>

From andrew at dcs.bbk.ac.uk  Fri Jul  8 08:33:52 2016
From: andrew at dcs.bbk.ac.uk (Andrew Watkins)
Date: Fri, 8 Jul 2016 16:33:52 +0100
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
 solaris 11
In-Reply-To: <D3A53DC0.D0300%michael.smith.erdc@gmail.com>
References: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
 <D3A53DC0.D0300%michael.smith.erdc@gmail.com>
Message-ID: <f22a35da-5884-d802-3aaf-15021b4bc99e@dcs.bbk.ac.uk>


I have it up and running with gcc, but I want to see if I can get it 
working with Oracle Developer Studio 12.

But, I was taken back that it failed at the first compile line.

Cheers,

Andrew

On 07/08/16 16:25, Michael Smith wrote:
> I've only compiled GDAL on solaris using the gcc compiler. You might 
> want to try that.
>
> Mike
>
> -- 
> Michael Smith
> Remote Sensing/GIS Center
> US Army Corps of Engineers
>
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org 
> <mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Andrew Watkins 
> <andrew at dcs.bbk.ac.uk <mailto:andrew at dcs.bbk.ac.uk>>
> Date: Friday, July 8, 2016 at 11:17 AM
> To: <gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>>
> Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on 
> solaris 11
>
>     Hello,
>
>     I know it crazy, but any pointers would be great.
>
>     I am trying to build GDAL 2.1 using Oracle Developer Studio 12.5 
>     (formally  Sun Studio12) on Solaris 11, but it fails at first CC.
>
>     ./configure CC='cc -m64' CXX='CC -m64' CPPFLAGS=-m64 CXXFLAGS=-m64
>     --without-libtool
>
>     GDAL is now configured for x86_64-pc-solaris2.11
>
>       Installation directory:    /usr/local
>       C compiler:                cc -m64 -g -fPIC
>       C++ compiler:              CC -m64 -m64 -fPIC
>
>       LIBTOOL support:           no
>
>       LIBZ support:              external
>       LIBLZMA support:           no
>       cryptopp support:          no
>       GRASS support:             no
>       CFITSIO support:           no
>       PCRaster support:          internal
>       LIBPNG support:            external
>       DDS support:               no
>       GTA support:               no
>       LIBTIFF support:           internal (BigTIFF=yes)
>       LIBGEOTIFF support:        internal
>       LIBJPEG support:           internal
>       12 bit JPEG:               yes
>       12 bit JPEG-in-TIFF:       yes
>       LIBGIF support:            internal
>       OGDI support:              no
>       HDF4 support:              no
>       HDF5 support:              no
>       Kea support:               no
>       NetCDF support:            no
>       Kakadu support:            no
>       JasPer support:            no
>       OpenJPEG support:          no
>       ECW support:               no
>       MrSID support:             no
>       MrSID/MG4 Lidar support:   no
>       MSG support:               no
>       GRIB support:              yes
>       EPSILON support:           no
>       WebP support:              no
>       cURL support (wms/wcs/...):yes
>       PostgreSQL support:        no
>       MRF support:               yes
>       MySQL support:             no
>       Ingres support:            no
>       Xerces-C support:          no
>       NAS support:               no
>       Expat support:             yes
>       libxml2 support:           yes
>       Google libkml support:     no
>       ODBC support:              no
>       PGeo support:              no
>       FGDB support:              no
>       MDB support:               no
>       PCIDSK support:            internal
>       OCI support:               no
>       GEORASTER support:         no
>       SDE support:               no
>       Rasdaman support:          no
>       DODS support:              no
>       SQLite support:            yes
>       PCRE support:              no
>       SpatiaLite support:        no
>       DWGdirect support          no
>       INFORMIX DataBlade support:no
>       GEOS support:              no
>       QHull support:             internal
>       Poppler support:           no
>       Podofo support:            no
>       PDFium support:            no
>       OpenCL support:            no
>       Armadillo support:         no
>       FreeXL support:            no
>       SOSI support:              no
>       MongoDB support:           no
>
>
>       SWIG Bindings:             no
>
>       Statically link PROJ.4:    no
>       enable GNM building:       no
>       enable pthread support:    yes
>       enable POSIX iconv support:yes
>       hide internal symbols:     no
>
>     $ gmake
>     (cd port; gmake)
>     gmake[1]: Entering directory `/tmp/gdal-2.1.0/port'
>     CC -m64 -I/tmp/gdal-2.1.0/port -I/tmp/gdal-2.1.0/gcore
>     -I/tmp/gdal-2.1.0/alg -I/tmp/gdal-2.1.0/ogr
>     -I/tmp/gdal-2.1.0/ogr/ogrsf_frmts -I/tmp/gdal-2.1.0/gnm
>     -I/tmp/gdal-2.1.0/apps -m64 -fPIC  -Wall -Wextra -Winit-self
>     -Wunused-parameter -Wformat -Werror=format-security
>     -Wno-format-nonliteral -Wshorten-64-to-32 -Wlogical-op -Wshadow
>     -Werror=vla -Wnull-dereference -Wduplicated-cond
>     -Wunused-private-field -Wmissing-prototypes -Wmissing-declarations
>     -Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names 
>     -DOGR_ENABLED -m64 -I/tmp/gdal-2.1.0/port  -DGDAL_COMPILATION
>     -DHAVE_CURL -DHAVE_LIBZ -I/usr/include/libxml2 -DHAVE_LIBXML2
>     -DUSE_ONLY_CRYPTODLL_ALG -c -o cpl_conv.o cpl_conv.cpp
>     CC: Warning: Option -fno-operator-names passed to ld, if ld is
>     invoked, ignored otherwise
>     "cpl_conv.cpp", line 225: Error: The function "snprintf" must have
>     a prototype.
>     "cpl_conv.cpp", line 919: Error: The function "atoll" must have a
>     prototype.
>     "cpl_conv.cpp", line 942: Error: The function "atoll" must have a
>     prototype.
>     "cpl_conv.cpp", line 965: Error: The function "snprintf" must have
>     a prototype.
>     "cpl_conv.cpp", line 994: Error: The function "atoll" must have a
>     prototype.
>     "cpl_conv.cpp", line 1056: Error: The function "strncasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 1255: Error: The function "snprintf" must
>     have a prototype.
>     "cpl_conv.cpp", line 1303: Error: The function "snprintf" must
>     have a prototype.
>     "cpl_conv.cpp", line 1342: Error: The function "snprintf" must
>     have a prototype.
>     "cpl_conv.cpp", line 1348: Error: The function "strncasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 1349: Error: The function "snprintf" must
>     have a prototype.
>     "cpl_conv.cpp", line 1940: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 1942: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2137: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2591: Error: The function "symlink" must have
>     a prototype.
>     "cpl_conv.cpp", line 2612: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2613: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2655: Error: The function "strcasecmp" must
>     have a prototype.
>     "cpl_conv.cpp", line 2656: Error: The function "strcasecmp" must
>     have a prototype.
>     Compilation aborted, too many Error messages.
>     gmake[1]: *** [cpl_conv.o] Error 2
>     gmake[1]: Leaving directory `/tmp/gdal-2.1.0/port'
>     gmake: *** [port-target] Error 2
>
>     Thanks,
>
>     Andrew
>
>
>     -- 
>     Andrew Watkins * Birkbeck, University of London * Computer Science *
>     *http://notallmicrosoft.blogspot.com  *
>     * UKOUG Systems SIG Chair *
>     * UKOUG Tech committee *
>     * tel: 020 7631 6720 *
>
>       
>
>     _______________________________________________ gdal-dev mailing
>     list gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


-- 
Andrew Watkins * Birkbeck, University of London * Computer Science *
* http://notallmicrosoft.blogspot.com *
* UKOUG Systems SIG Chair *
* UKOUG Tech committee *
* tel: 020 7631 6720 *

  

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160708/f752590c/attachment.html>

From lucena_ivan at hotmail.com  Fri Jul  8 08:31:17 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 8 Jul 2016 15:31:17 +0000
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5
	on	solaris 11
In-Reply-To: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
References: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
Message-ID: <BLUPR19MB01459358B400746252A9ED79F23C0@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi Andrew,


Nothing crazy about using and IDE. You should be able to find some hints here:


http://trac.osgeo.org/gdal/wiki/BuildHints

  *   SolarisNotes<http://trac.osgeo.org/gdal/wiki/SolarisNotes>
  *   BuildingOnUnixWithNetBeansIDE<http://trac.osgeo.org/gdal/wiki/BuildingOnUnixWithNetBeansIDE>

The IDE will use whatever compiler you have on your system, so the errors you are getting are not related to the IDE.

You can try building GDAL on command line first.


Regards,

Ivan

________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Andrew Watkins <andrew at dcs.bbk.ac.uk>
Sent: Friday, July 8, 2016 11:17 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on solaris 11


Hello,

I know it crazy, but any pointers would be great.

I am trying to build GDAL 2.1 using Oracle Developer Studio 12.5  (formally  Sun Studio12) on Solaris 11, but it fails at first CC.

./configure CC='cc -m64' CXX='CC -m64' CPPFLAGS=-m64 CXXFLAGS=-m64 --without-libtool

GDAL is now configured for x86_64-pc-solaris2.11

  Installation directory:    /usr/local
  C compiler:                cc -m64 -g -fPIC
  C++ compiler:              CC -m64 -m64 -fPIC

  LIBTOOL support:           no

  LIBZ support:              external
  LIBLZMA support:           no
  cryptopp support:          no
  GRASS support:             no
  CFITSIO support:           no
  PCRaster support:          internal
  LIBPNG support:            external
  DDS support:               no
  GTA support:               no
  LIBTIFF support:           internal (BigTIFF=yes)
  LIBGEOTIFF support:        internal
  LIBJPEG support:           internal
  12 bit JPEG:               yes
  12 bit JPEG-in-TIFF:       yes
  LIBGIF support:            internal
  OGDI support:              no
  HDF4 support:              no
  HDF5 support:              no
  Kea support:               no
  NetCDF support:            no
  Kakadu support:            no
  JasPer support:            no
  OpenJPEG support:          no
  ECW support:               no
  MrSID support:             no
  MrSID/MG4 Lidar support:   no
  MSG support:               no
  GRIB support:              yes
  EPSILON support:           no
  WebP support:              no
  cURL support (wms/wcs/...):yes
  PostgreSQL support:        no
  MRF support:               yes
  MySQL support:             no
  Ingres support:            no
  Xerces-C support:          no
  NAS support:               no
  Expat support:             yes
  libxml2 support:           yes
  Google libkml support:     no
  ODBC support:              no
  PGeo support:              no
  FGDB support:              no
  MDB support:               no
  PCIDSK support:            internal
  OCI support:               no
  GEORASTER support:         no
  SDE support:               no
  Rasdaman support:          no
  DODS support:              no
  SQLite support:            yes
  PCRE support:              no
  SpatiaLite support:        no
  DWGdirect support          no
  INFORMIX DataBlade support:no
  GEOS support:              no
  QHull support:             internal
  Poppler support:           no
  Podofo support:            no
  PDFium support:            no
  OpenCL support:            no
  Armadillo support:         no
  FreeXL support:            no
  SOSI support:              no
  MongoDB support:           no


  SWIG Bindings:             no

  Statically link PROJ.4:    no
  enable GNM building:       no
  enable pthread support:    yes
  enable POSIX iconv support:yes
  hide internal symbols:     no

$ gmake
(cd port; gmake)
gmake[1]: Entering directory `/tmp/gdal-2.1.0/port'
CC -m64 -I/tmp/gdal-2.1.0/port -I/tmp/gdal-2.1.0/gcore -I/tmp/gdal-2.1.0/alg -I/tmp/gdal-2.1.0/ogr -I/tmp/gdal-2.1.0/ogr/ogrsf_frmts -I/tmp/gdal-2.1.0/gnm -I/tmp/gdal-2.1.0/apps -m64 -fPIC  -Wall -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security -Wno-format-nonliteral -Wshorten-64-to-32 -Wlogical-op -Wshadow -Werror=vla -Wnull-dereference -Wduplicated-cond -Wunused-private-field -Wmissing-prototypes -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names  -DOGR_ENABLED -m64 -I/tmp/gdal-2.1.0/port  -DGDAL_COMPILATION        -DHAVE_CURL -DHAVE_LIBZ -I/usr/include/libxml2 -DHAVE_LIBXML2 -DUSE_ONLY_CRYPTODLL_ALG -c -o cpl_conv.o cpl_conv.cpp
CC: Warning: Option -fno-operator-names passed to ld, if ld is invoked, ignored otherwise
"cpl_conv.cpp", line 225: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 919: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 942: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 965: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 994: Error: The function "atoll" must have a prototype.
"cpl_conv.cpp", line 1056: Error: The function "strncasecmp" must have a prototype.
"cpl_conv.cpp", line 1255: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 1303: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 1342: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 1348: Error: The function "strncasecmp" must have a prototype.
"cpl_conv.cpp", line 1349: Error: The function "snprintf" must have a prototype.
"cpl_conv.cpp", line 1940: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 1942: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2137: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2591: Error: The function "symlink" must have a prototype.
"cpl_conv.cpp", line 2612: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2613: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2655: Error: The function "strcasecmp" must have a prototype.
"cpl_conv.cpp", line 2656: Error: The function "strcasecmp" must have a prototype.
Compilation aborted, too many Error messages.
gmake[1]: *** [cpl_conv.o] Error 2
gmake[1]: Leaving directory `/tmp/gdal-2.1.0/port'
gmake: *** [port-target] Error 2

Thanks,

Andrew


--
Andrew Watkins * Birkbeck, University of London * Computer Science *
* http://notallmicrosoft.blogspot.com *
* UKOUG Systems SIG Chair *
* UKOUG Tech committee *
* tel: 020 7631 6720 *





[http://2.bp.blogspot.com/_lf493CmNlqs/SM7X123eoKI/AAAAAAAAAAo/YGRX_LfZIpI/S220-s80/andrew.jpg]<http://notallmicrosoft.blogspot.com/>

Life on the OutSide - blogspot.com<http://notallmicrosoft.blogspot.com/>
notallmicrosoft.blogspot.com
I think more and more people will start using Kernel Zone and I have a feeling that will soon be the only zone that Solaris will offer soon. So, I thought I would ...

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160708/5eede7cd/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jul  8 08:42:20 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Jul 2016 17:42:20 +0200
Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
	solaris 11
In-Reply-To: <f22a35da-5884-d802-3aaf-15021b4bc99e@dcs.bbk.ac.uk>
References: <11472138-aefe-ca36-3fa1-4100351d361e@dcs.bbk.ac.uk>
 <D3A53DC0.D0300%michael.smith.erdc@gmail.com>
 <f22a35da-5884-d802-3aaf-15021b4bc99e@dcs.bbk.ac.uk>
Message-ID: <201607081742.21343.even.rouault@spatialys.com>

Le vendredi 08 juillet 2016 17:33:52, Andrew Watkins a écrit :
> I have it up and running with gcc, but I want to see if I can get it
> working with Oracle Developer Studio 12.
> 
> But, I was taken back that it failed at the first compile line.

The man pages of those functions might give some hints of some defines to set :

       snprintf(), vsnprintf(): _BSD_SOURCE || _XOPEN_SOURCE >= 500 || 
_ISOC99_SOURCE; or cc -std=c99


       atoll(): _BSD_SOURCE || _SVID_SOURCE || _XOPEN_SOURCE >= 600 || 
_ISOC99_SOURCE; or cc -std=c99

    symlink(): _BSD_SOURCE || _XOPEN_SOURCE >= 500 || _POSIX_C_SOURCE >= 
200112L


strncasecmp():  4.4BSD, POSIX.1-2001.


> 
> Cheers,
> 
> Andrew
> 
> On 07/08/16 16:25, Michael Smith wrote:
> > I've only compiled GDAL on solaris using the gcc compiler. You might
> > want to try that.
> > 
> > Mike
> > 
> > 
> > From: gdal-dev <gdal-dev-bounces at lists.osgeo.org
> > <mailto:gdal-dev-bounces at lists.osgeo.org>> on behalf of Andrew Watkins
> > <andrew at dcs.bbk.ac.uk <mailto:andrew at dcs.bbk.ac.uk>>
> > Date: Friday, July 8, 2016 at 11:17 AM
> > To: <gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>>
> > Subject: [gdal-dev] Building gdal with Oracle Developer Studio 12.5 on
> > solaris 11
> > 
> >     Hello,
> >     
> >     I know it crazy, but any pointers would be great.
> >     
> >     I am trying to build GDAL 2.1 using Oracle Developer Studio 12.5
> >     (formally  Sun Studio12) on Solaris 11, but it fails at first CC.
> >     
> >     ./configure CC='cc -m64' CXX='CC -m64' CPPFLAGS=-m64 CXXFLAGS=-m64
> >     --without-libtool
> >     
> >     GDAL is now configured for x86_64-pc-solaris2.11
> >     
> >       Installation directory:    /usr/local
> >       C compiler:                cc -m64 -g -fPIC
> >       C++ compiler:              CC -m64 -m64 -fPIC
> >       
> >       LIBTOOL support:           no
> >       
> >       LIBZ support:              external
> >       LIBLZMA support:           no
> >       cryptopp support:          no
> >       GRASS support:             no
> >       CFITSIO support:           no
> >       PCRaster support:          internal
> >       LIBPNG support:            external
> >       DDS support:               no
> >       GTA support:               no
> >       LIBTIFF support:           internal (BigTIFF=yes)
> >       LIBGEOTIFF support:        internal
> >       LIBJPEG support:           internal
> >       12 bit JPEG:               yes
> >       12 bit JPEG-in-TIFF:       yes
> >       LIBGIF support:            internal
> >       OGDI support:              no
> >       HDF4 support:              no
> >       HDF5 support:              no
> >       Kea support:               no
> >       NetCDF support:            no
> >       Kakadu support:            no
> >       JasPer support:            no
> >       OpenJPEG support:          no
> >       ECW support:               no
> >       MrSID support:             no
> >       MrSID/MG4 Lidar support:   no
> >       MSG support:               no
> >       GRIB support:              yes
> >       EPSILON support:           no
> >       WebP support:              no
> >       cURL support (wms/wcs/...):yes
> >       PostgreSQL support:        no
> >       MRF support:               yes
> >       MySQL support:             no
> >       Ingres support:            no
> >       Xerces-C support:          no
> >       NAS support:               no
> >       Expat support:             yes
> >       libxml2 support:           yes
> >       Google libkml support:     no
> >       ODBC support:              no
> >       PGeo support:              no
> >       FGDB support:              no
> >       MDB support:               no
> >       PCIDSK support:            internal
> >       OCI support:               no
> >       GEORASTER support:         no
> >       SDE support:               no
> >       Rasdaman support:          no
> >       DODS support:              no
> >       SQLite support:            yes
> >       PCRE support:              no
> >       SpatiaLite support:        no
> >       DWGdirect support          no
> >       INFORMIX DataBlade support:no
> >       GEOS support:              no
> >       QHull support:             internal
> >       Poppler support:           no
> >       Podofo support:            no
> >       PDFium support:            no
> >       OpenCL support:            no
> >       Armadillo support:         no
> >       FreeXL support:            no
> >       SOSI support:              no
> >       MongoDB support:           no
> >       
> >       
> >       SWIG Bindings:             no
> >       
> >       Statically link PROJ.4:    no
> >       enable GNM building:       no
> >       enable pthread support:    yes
> >       enable POSIX iconv support:yes
> >       hide internal symbols:     no
> >     
> >     $ gmake
> >     (cd port; gmake)
> >     gmake[1]: Entering directory `/tmp/gdal-2.1.0/port'
> >     CC -m64 -I/tmp/gdal-2.1.0/port -I/tmp/gdal-2.1.0/gcore
> >     -I/tmp/gdal-2.1.0/alg -I/tmp/gdal-2.1.0/ogr
> >     -I/tmp/gdal-2.1.0/ogr/ogrsf_frmts -I/tmp/gdal-2.1.0/gnm
> >     -I/tmp/gdal-2.1.0/apps -m64 -fPIC  -Wall -Wextra -Winit-self
> >     -Wunused-parameter -Wformat -Werror=format-security
> >     -Wno-format-nonliteral -Wshorten-64-to-32 -Wlogical-op -Wshadow
> >     -Werror=vla -Wnull-dereference -Wduplicated-cond
> >     -Wunused-private-field -Wmissing-prototypes -Wmissing-declarations
> >     -Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names
> >     -DOGR_ENABLED -m64 -I/tmp/gdal-2.1.0/port  -DGDAL_COMPILATION
> >     -DHAVE_CURL -DHAVE_LIBZ -I/usr/include/libxml2 -DHAVE_LIBXML2
> >     -DUSE_ONLY_CRYPTODLL_ALG -c -o cpl_conv.o cpl_conv.cpp
> >     CC: Warning: Option -fno-operator-names passed to ld, if ld is
> >     invoked, ignored otherwise
> >     "cpl_conv.cpp", line 225: Error: The function "snprintf" must have
> >     a prototype.
> >     "cpl_conv.cpp", line 919: Error: The function "atoll" must have a
> >     prototype.
> >     "cpl_conv.cpp", line 942: Error: The function "atoll" must have a
> >     prototype.
> >     "cpl_conv.cpp", line 965: Error: The function "snprintf" must have
> >     a prototype.
> >     "cpl_conv.cpp", line 994: Error: The function "atoll" must have a
> >     prototype.
> >     "cpl_conv.cpp", line 1056: Error: The function "strncasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1255: Error: The function "snprintf" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1303: Error: The function "snprintf" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1342: Error: The function "snprintf" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1348: Error: The function "strncasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1349: Error: The function "snprintf" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1940: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 1942: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2131: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2137: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2381: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2521: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2591: Error: The function "symlink" must have
> >     a prototype.
> >     "cpl_conv.cpp", line 2612: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2613: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2655: Error: The function "strcasecmp" must
> >     have a prototype.
> >     "cpl_conv.cpp", line 2656: Error: The function "strcasecmp" must
> >     have a prototype.
> >     Compilation aborted, too many Error messages.
> >     gmake[1]: *** [cpl_conv.o] Error 2
> >     gmake[1]: Leaving directory `/tmp/gdal-2.1.0/port'
> >     gmake: *** [port-target] Error 2
> >     
> >     Thanks,
> >     
> >     Andrew
> >     
> >     
> >     
> >     
> >     
> >     _______________________________________________ gdal-dev mailing
> >     list gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> >     http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From robbkwright at gmail.com  Fri Jul  8 12:05:05 2016
From: robbkwright at gmail.com (Robb Wright)
Date: Fri, 8 Jul 2016 15:05:05 -0400
Subject: [gdal-dev] ogr2ogr: issues going from polar2geographic
Message-ID: <15b48597-20ab-72ad-34f0-20886b5446c2@gmail.com>


I'm having problems going from a Stereographic North Pole to 4326. 
Contiguous polys across the 180 line in polar are splitting and wrapping 
across the 4326 space, instead of just splitting at the 180.  The data 
doesn't go south of ~50 degrees latitude.

ogr2ogr --config CHECK_WITH_INVERT_PROJ=YES "ESRI Shapefile" 
output_wgs84.shp masie_ice_r00_v01_2016187_4km.shp -s_srs "+proj=stere 
+lat_0=90 +lat_ts=60 +lon_0=-80 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m 
+no_defs" -t_srs EPSG:4326

I've tried it with/without wrapdateline, with/without 
CHECK_WITH_INVERT_PROJ but all output looks the same.
The proj4 came from gdalsrsinfo on the source file.

Source shapefile: 
ftp://sidads.colorado.edu/DATASETS/NOAA/G02186/latest/4km/maise_ice_r00_4km.zip

Using GDAL 2.1.0, released 2016/04/25 from the built GISInternals site.

If anyone has thoughts on how to go from a polar to anything else, it 
would be appreciated.

Robb


From piotrpachol at gmail.com  Fri Jul  8 14:03:21 2016
From: piotrpachol at gmail.com (=?UTF-8?B?UGlvdHIgUGFjaMOzxYI=?=)
Date: Fri, 8 Jul 2016 23:03:21 +0200
Subject: [gdal-dev] import gml with curves
Message-ID: <bc5bb465-597e-fdc6-86d1-3ec9760168ab@gmail.com>

Hello,
Is there any way to import properly to Postgis gml which contain curves 
with more than one segment ?
Below I attach a part of gml with exemplary object.

<gml:featureMember>
<bt:Object>
     <bt:ID>10000</bt:ID>
<bt:geometry>
<gml:Curve gml:id="ID_786" srsDimension="2" srsName="EPSG:2180">
<gml:segments>
<gml:LineStringSegment>
<gml:posList>485840.70 318178.50 485819.70 318182.37 </gml:posList>
</gml:LineStringSegment>
<gml:LineStringSegment>
<gml:posList>485825.11 318176.40 485826.88 318186.02 </gml:posList>
</gml:LineStringSegment>
</gml:segments>
          </gml:Curve>
</bt:geometry>
  </bt:Object>
  </gml:featureMember>


And here is how I try to import gml:
SET PGCLIENTENCODING=UTF8
SET GML_EXPOSE_GML_ID=YES
SET GML_ATTRIBUTES_TO_OGR_FIELDS=YES
SET GML_FETCH_ALL_GEOMETRIES= YES
ogr2ogr -f "PostgreSQL" PG:"host=localhost user=*** dbname=test 
password=*** port=5432" d:\test.xml -forceNullable -splitlistfields -nlt 
GEOMETRY

And I've got errors:
ERROR 1: Non contiguous curves
ERROR 1: Curve: Got NULL geometry as Member instead of segments.

I there any option or trick to import such object? Curves with one 
segment are imported without any problem.

Regards,
Piotr
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160708/e5072f40/attachment.html>

From even.rouault at spatialys.com  Fri Jul  8 14:20:21 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 8 Jul 2016 23:20:21 +0200
Subject: [gdal-dev] import gml with curves
In-Reply-To: <bc5bb465-597e-fdc6-86d1-3ec9760168ab@gmail.com>
References: <bc5bb465-597e-fdc6-86d1-3ec9760168ab@gmail.com>
Message-ID: <201607082320.22891.even.rouault@spatialys.com>

Piotr,

According to http://www.datypic.com/sc/niem21/e-gml32_Curve.html, "The curve 
segments are connected to one another, with the end point of each segment 
except the last being the start point of the next segment in the segment 
list", which is not the case here. Hence the "Non contiguous curves" error 
message. So I believe your GML geometry is invalid.

Even

> Hello,
> Is there any way to import properly to Postgis gml which contain curves
> with more than one segment ?
> Below I attach a part of gml with exemplary object.
> 
> <gml:featureMember>
> <bt:Object>
>      <bt:ID>10000</bt:ID>
> <bt:geometry>
> <gml:Curve gml:id="ID_786" srsDimension="2" srsName="EPSG:2180">
> <gml:segments>
> <gml:LineStringSegment>
> <gml:posList>485840.70 318178.50 485819.70 318182.37 </gml:posList>
> </gml:LineStringSegment>
> <gml:LineStringSegment>
> <gml:posList>485825.11 318176.40 485826.88 318186.02 </gml:posList>
> </gml:LineStringSegment>
> </gml:segments>
>           </gml:Curve>
> </bt:geometry>
>   </bt:Object>
>   </gml:featureMember>
> 
> 
> And here is how I try to import gml:
> SET PGCLIENTENCODING=UTF8
> SET GML_EXPOSE_GML_ID=YES
> SET GML_ATTRIBUTES_TO_OGR_FIELDS=YES
> SET GML_FETCH_ALL_GEOMETRIES= YES
> ogr2ogr -f "PostgreSQL" PG:"host=localhost user=*** dbname=test
> password=*** port=5432" d:\test.xml -forceNullable -splitlistfields -nlt
> GEOMETRY
> 
> And I've got errors:
> ERROR 1: Non contiguous curves
> ERROR 1: Curve: Got NULL geometry as Member instead of segments.
> 
> I there any option or trick to import such object? Curves with one
> segment are imported without any problem.
> 
> Regards,
> Piotr

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul  8 16:00:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 9 Jul 2016 01:00:46 +0200
Subject: [gdal-dev] ogr2ogr: issues going from polar2geographic
In-Reply-To: <15b48597-20ab-72ad-34f0-20886b5446c2@gmail.com>
References: <15b48597-20ab-72ad-34f0-20886b5446c2@gmail.com>
Message-ID: <201607090100.47001.even.rouault@spatialys.com>

Le vendredi 08 juillet 2016 21:05:05, Robb Wright a écrit :
> I'm having problems going from a Stereographic North Pole to 4326.
> Contiguous polys across the 180 line in polar are splitting and wrapping
> across the 4326 space, instead of just splitting at the 180.  The data
> doesn't go south of ~50 degrees latitude.
> 
> ogr2ogr --config CHECK_WITH_INVERT_PROJ=YES "ESRI Shapefile"
> output_wgs84.shp masie_ice_r00_v01_2016187_4km.shp -s_srs "+proj=stere
> +lat_0=90 +lat_ts=60 +lon_0=-80 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m
> +no_defs" -t_srs EPSG:4326
> 
> I've tried it with/without wrapdateline, with/without
> CHECK_WITH_INVERT_PROJ but all output looks the same.
> The proj4 came from gdalsrsinfo on the source file.
> 
> Source shapefile:
> ftp://sidads.colorado.edu/DATASETS/NOAA/G02186/latest/4km/maise_ice_r00_4km
> .zip
> 
> Using GDAL 2.1.0, released 2016/04/25 from the built GISInternals site.
> 
> If anyone has thoughts on how to go from a polar to anything else, it
> would be appreciated.

Robb,

ogr2ogr -wrapdateline heuristics aren't ready to deal with such complex cases
as polygons in polar projection that contain the pole itself and/or that cross the
merdian +/- 180 deg (here we have both)

I've finally found a method in 4 steps :

1) create needle.csv with the following content :

id,WKT
1,"POLYGON((179.99999 0,179.99999 89.99999,-179.99999 89.99999,-179.99999 0,179.99999 0))"

2) project it to the polar system :

$ ogr2ogr needle_polar.shp needle.csv -s_srs EPSG:4326 -t_srs "+proj=stere +lat_0=90 +lat_ts=60 +lon_0=-80 +k=1 +x_0=0 +y_0=0 +datum=WGS84 +units=m +no_defs" -overwrite

3) erase the needle from the original shapefile :

$ python ogr_layer_algebra.py Erase -input_ds masie_ice_r00_v01_2016189_4km.shp -method_ds needle_polar.shp  -output_ds polar_without_pole.shp -overwrite

where ogr_layer_algebra.py comes from
https://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr_layer_algebra.py

This step makes sure that no polygons include a point at longitude +/- 180 deg, as well as
making sure that the ~ 90 latitude appears in the coordinates of the polygon that contains the pole.

4) Finally project it to EPSG:4326

$ ogr2ogr result.shp polar_without_pole.shp -t_srs EPSG:4326 -overwrite


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Sat Jul  9 01:35:21 2016
From: jamessramm at gmail.com (James Ramm)
Date: Sat, 9 Jul 2016 09:35:21 +0100
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <201607081631.11872.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
Message-ID: <CAEW=KS57N=TaUid4K=fmG+jAQF_pteHas-TeohCWoiYbF9KJyw@mail.gmail.com>

Definitely a welcome improvement!
Especially useful where the read window does not match natural block size
(so the current sparse functionality doesnt help much). It improved the
efficiency of a blob extraction algorithm (which requires overlapping
windows and thus cannot use natural blocks) we use by around 20-45%
depending on our data.

You are able to find the percentage of non null values without reading data
is that correct? I don't fully understand how it works yet, but would it be
possible to retrieve the indices of non null data?
In the case where you data is very sparse but each block still contains a
small number of pixels, you would still need to loop through all that null
data. If it were possible to retrieve the non null indices that could be
useful, at least to speed up python apps...
On 8 Jul 2016 4:27 p.m., "Even Rouault" <even.rouault at spatialys.com> wrote:

> Hi,
>
> The topic of sparse dataset management come back regularly, so I've
> decided to
> tackle it.
>
> Please find
> https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
> for review.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160709/6b1d578d/attachment.html>

From even.rouault at spatialys.com  Sat Jul  9 02:38:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 9 Jul 2016 11:38:07 +0200
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <CAEW=KS57N=TaUid4K=fmG+jAQF_pteHas-TeohCWoiYbF9KJyw@mail.gmail.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <CAEW=KS57N=TaUid4K=fmG+jAQF_pteHas-TeohCWoiYbF9KJyw@mail.gmail.com>
Message-ID: <201607091138.07761.even.rouault@spatialys.com>

Le samedi 09 juillet 2016 10:35:21, James Ramm a écrit :
> Definitely a welcome improvement!
> Especially useful where the read window does not match natural block size
> (so the current sparse functionality doesnt help much). It improved the
> efficiency of a blob extraction algorithm (which requires overlapping
> windows and thus cannot use natural blocks) we use by around 20-45%
> depending on our data.
> 
> You are able to find the percentage of non null values without reading data
> is that correct? I don't fully understand how it works yet,

For GeoTIFF, the unit of query remains the block. So if a block is missing is 
present, it computes how many pixels of the window of request intersect the 
block, and count them as present.

Imagine that you have a raster of dimensions 20x20, with tiles of size 10x10. 
Imagine the first block (pixels 0,0 to 9,9) is missing. And you call 
GetDataCoverageStatus() with (5,5,15,15). Then you will have a contribution of 
10x5 valid pixels from the top-right block, 5x10 from the bottom-left block 
and 10x10 from the bottom-right block, hence a non-null percentage of 200. / 
225. * 100 = 88.9 %

For VRT, the computation is done by starting with a polygon with the shape of 
the query window, and each time a source intersects that polygon, by removing 
the contribution of this source with a Difference() geometry operation. At the 
end, you compute the area of the resulting polygon.

> but would it be
> possible to retrieve the indices of non null data?

You can do that by calling GetDataCoverageStatus() in iterative way, with a 
window size not too small (block size e.g.). 
For VRT such a list couldn't be established since the shape of holes can be 
completely arbitrary depending on the relative location of sources.

> In the case where you data is very sparse but each block still contains a
> small number of pixels, you would still need to loop through all that null
> data. 
You mean that in an extreme situation you could have datasets where all blocks 
would be not completely null, but have just one valid pixel for example ? In 
that case this RFC wouldn't help at all as those blocks would be seen as data. 
You really need to fetch the data to know which pixels are null or not.

> If it were possible to retrieve the non null indices that could be
> useful, at least to speed up python apps...
> 
> On 8 Jul 2016 4:27 p.m., "Even Rouault" <even.rouault at spatialys.com> wrote:
> > Hi,
> > 
> > The topic of sparse dataset management come back regularly, so I've
> > decided to
> > tackle it.
> > 
> > Please find
> > https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
> > for review.
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Sun Jul 10 02:07:00 2016
From: jamessramm at gmail.com (jramm)
Date: Sun, 10 Jul 2016 02:07:00 -0700 (PDT)
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <201607091138.07761.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <CAEW=KS57N=TaUid4K=fmG+jAQF_pteHas-TeohCWoiYbF9KJyw@mail.gmail.com>
 <201607091138.07761.even.rouault@spatialys.com>
Message-ID: <1468141620909-5275600.post@n6.nabble.com>

Even Rouault-2 wrote
> For GeoTIFF, the unit of query remains the block. So if a block is missing
> is 
> present, it computes how many pixels of the window of request intersect
> the 
> block, and count them as present.
> 
> Imagine that you have a raster of dimensions 20x20, with tiles of size
> 10x10. 
> Imagine the first block (pixels 0,0 to 9,9) is missing. And you call 
> GetDataCoverageStatus() with (5,5,15,15). Then you will have a
> contribution of 
> 10x5 valid pixels from the top-right block, 5x10 from the bottom-left
> block 
> and 10x10 from the bottom-right block, hence a non-null percentage of 200.
> / 
> 225. * 100 = 88.9 %

Ah ok, makes sense. 
Having SPARSE_OK=YES mean that gdal_translate will actually skip null blocks
is a good additiona also - more intuitive. 





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-63-Sparse-datasets-improvements-tp5275443p5275600.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From andrew at aitchison.me.uk  Sun Jul 10 02:32:48 2016
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 10 Jul 2016 10:32:48 +0100 (BST)
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
 improvements
In-Reply-To: <201607081631.11872.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
Message-ID: <alpine.LRH.2.20.1607091728190.12814@warden.aitchison.me.uk>

On Fri, 8 Jul 2016, Even Rouault wrote:

> The topic of sparse dataset management come back regularly, so I've decided to 
> tackle it.
>
> Please find https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements 
> for review.

I know of several proprietary file formats where the data is tiled
with the index indicating (perhaps implicitly) where the tile has no 
data.

A driver for such formats could have IReadBlock quickly return with
a code to indicate NoData, rather than filling in the image data.
As it stands that might mean extending CPLErr, but would
that be helpful to the main library ?

Is this what is described by having the offset and byte count both zero ?

----

I don't really understand how GDAL_DATA_COVERAGE_STATUS values combine
or when pdfDataPct is valid.

In one of the formats above, the tile index has special values
for "no data" and and for "data exists and could be retrieved/purchased
if required". I'd consider mapping these to GDAL_DATA_COVERAGE_STATUS_EMPTY
and GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED. Does that make sense ?

-- 
Andrew C Aitchison


From even.rouault at spatialys.com  Sun Jul 10 02:54:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 10 Jul 2016 11:54:17 +0200
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <alpine.LRH.2.20.1607091728190.12814@warden.aitchison.me.uk>
References: <201607081631.11872.even.rouault@spatialys.com>
 <alpine.LRH.2.20.1607091728190.12814@warden.aitchison.me.uk>
Message-ID: <201607101154.17484.even.rouault@spatialys.com>

Le dimanche 10 juillet 2016 11:32:48, Andrew C Aitchison a écrit :
> On Fri, 8 Jul 2016, Even Rouault wrote:
> > The topic of sparse dataset management come back regularly, so I've
> > decided to tackle it.
> > 
> > Please find
> > https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements for
> > review.
> 
> I know of several proprietary file formats where the data is tiled
> with the index indicating (perhaps implicitly) where the tile has no
> data.
> 
> A driver for such formats could have IReadBlock quickly return with
> a code to indicate NoData, rather than filling in the image data.
> As it stands that might mean extending CPLErr, but would
> that be helpful to the main library ?

That would have a significant impact on the whole code base, as well as 
application code, so I didn't really considered that option and prefered an 
auxiliary interface to be used by code aware and caring about special 
behaviour for sparse datasets.

> 
> Is this what is described by having the offset and byte count both zero ?
Yes, in TIFF, you have 2 arrays, one that indicates at which offset in the file 
a given tile/strip is located, and the other one for the number of bytes of 
that tile/strip. GDAL uses offset = count = 0 as a convention for missing 
blocks.
> 
> ----
> 
> I don't really understand how GDAL_DATA_COVERAGE_STATUS values combine
> or

* If the requested window contains has no missing blocks, it returns 
GDAL_DATA_COVERAGE_STATUS_DATA
* If the requested window has only missing blocks, it returns 
GDAL_DATA_COVERAGE_STATUS_EMPTY
* If the requested window is a mix of both, it returns 
GDAL_DATA_COVERAGE_STATUS_DATA | GDAL_DATA_COVERAGE_STATUS_EMPTY

> when pdfDataPct is valid.

It should be valid if the processing has not been stopped prematurely due to 
the nMaskFlagStop being triggered. For example if you have a dataset and you 
want a special processing (could be just an info "This dataset is sparse") as 
soon as it contains empty blocks, then you can query the whole dataset extent 
with nMaskFlagStop = GDAL_DATA_COVERAGE_STATUS_EMPTY. As soon as a missing 
block is found, the function will exit, and will thus be unable to determine 
the percentage of valid data.

> 
> In one of the formats above, the tile index has special values
> for "no data" and and for "data exists and could be retrieved/purchased
> if required". I'd consider mapping these to GDAL_DATA_COVERAGE_STATUS_EMPTY

Clearly a missing block will cause GDAL_DATA_COVERAGE_STATUS_EMPTY to be set.

> and GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED. Does that make sense ?

GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED is aimed at being returned when a 
driver does not offer an implementation of the interface, and thus uses the 
default dumb implementation that returns 
GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED

I realize that I didn't really document yet the semantics of those flags. To be 
done.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From 191980 at niuitmo.ru  Sun Jul 10 06:57:29 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 10 Jul 2016 13:57:29 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 7]
Message-ID: <D217B6D3-083F-4B9C-8059-6565EB835DC9@niuitmo.ru>

Blogpost link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/1.html> (screenshots with working QGis + libopencad, little comparisons to ArcGIS and AutoCAD).


1. This week I've done:

Libopencad changes:

- Fixed reading of files with only 1 object inside (before, it used to enter endless loop).

- Filemap creation speeded up.

- Added a bunch of various tests.

- Minor fixes and code formatting.


OGR CAD Driver changes:

- Basic spline geometry support added.

- Code refactoring, memory leaks fixes.

- I've started removing any dependencies on C++11 in driver code (but libopencad still will require -std=c++11).


2. Plan on doing next week:

Complete spline geometry, polylines interpolation, remove any dependencies on c++11 from driver code, fix ERRORs that appears when using test_ogrsf util. Get info about OGR Feature Style and make geometry parameters mapping into it.


3. Blocking:

None.


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160710/db7ec42c/attachment.html>

From even.rouault at spatialys.com  Mon Jul 11 03:57:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Jul 2016 12:57:32 +0200
Subject: [gdal-dev] Fwd: [ogdidev] Time for a OGDI 3.2.0 release ?
Message-ID: <201607111257.32634.even.rouault@spatialys.com>

CC'ing gdal-dev as a number of OGDI users must be there.

----------  Message transmis  ----------

Sujet : [ogdidev] Time for a OGDI 3.2.0 release ?
Date : lundi 11 juillet 2016, 12:55:48
De : "Even Rouault even.rouault at spatialys.com [ogdidev]" 
<ogdidev at yahoogroups.com>
À : ogdidev at yahoogroups.com

Hi,

I've recently done a number of fixes as well as integrating a few patches that 
were standing.
Given that the last official non-beta release dates back to nearly 10 years ago, 
I'd like to issue soon a 3.2.0 final release, so I'd appreciate if you could 
test and give some feedback. My aim is to issue the release beginning of next 
week.
I don't aim at doing the "perfect" release that fixes all reported issues, as I 
have limited bandwidth to do so, but at least ensuring that the situation is 
not worse than before. Works fine for me on Linux and Windows with the VRF 
driver.

If that's more convenient, I've created a mirror of the CVS repository at 
https://github.com/libogdi/ogdi/
The sync from CVS is done manually when I modify it.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com


------------------------------------
Posted by: Even Rouault <even.rouault at spatialys.com>
------------------------------------


------------------------------------

Yahoo Groups Links

<*> To visit your group on the web, go to:
    http://groups.yahoo.com/group/ogdidev/

<*> Your email settings:
    Individual Email | Traditional

<*> To change settings online go to:
    http://groups.yahoo.com/group/ogdidev/join
    (Yahoo! ID required)

<*> To change settings via email:
    ogdidev-digest at yahoogroups.com 
    ogdidev-fullfeatured at yahoogroups.com

<*> To unsubscribe from this group, send an email to:
    ogdidev-unsubscribe at yahoogroups.com

<*> Your use of Yahoo Groups is subject to:
    https://info.yahoo.com/legal/us/yahoo/utos/terms/



-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Mon Jul 11 08:11:59 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Jul 2016 08:11:59 -0700
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <201607101154.17484.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <alpine.LRH.2.20.1607091728190.12814@warden.aitchison.me.uk>
 <201607101154.17484.even.rouault@spatialys.com>
Message-ID: <CACmBxyv9JT21VQC5-Q4wTEOMeFwyiYsT1BcD7L66eBXbpeJnwQ@mail.gmail.com>

Even,

I think this looks good and a big win for a lot of use cases.

Comments related to the flags defined in gcore/gdal.h:

- If possible, use an enum rather than bare defines.
- Add comments to gdal.h explaining what the values are
- Should an unimplemented also have the _DATA flag set rather than _EMPTY?

A suggestion for this
<https://github.com/OSGeo/gdal/compare/trunk...rouault:sparse_datasets?expand=1#diff-66f7e256611c32cddc2745d78b4fe59bR3787>,
which looks brittle to me:

     if( nStatus != GDAL_DATA_COVERAGE_STATUS_EMPTY )

A helper function to check empty rather than a direct check will allow for
later or'ing the status with other flags.  Or you can & with the flag.  But
looking at it a second time, I think it might be more explicit if you did a
check against having data:

    if( nStatus & GDAL_DATA_COVERAGE_STATUS_DATA )

-kurt

On Sun, Jul 10, 2016 at 2:54 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le dimanche 10 juillet 2016 11:32:48, Andrew C Aitchison a écrit :
> > On Fri, 8 Jul 2016, Even Rouault wrote:
> > > The topic of sparse dataset management come back regularly, so I've
> > > decided to tackle it.
> > >
> > > Please find
> > > https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
> for
> > > review.
> >
> > I know of several proprietary file formats where the data is tiled
> > with the index indicating (perhaps implicitly) where the tile has no
> > data.
> >
> > A driver for such formats could have IReadBlock quickly return with
> > a code to indicate NoData, rather than filling in the image data.
> > As it stands that might mean extending CPLErr, but would
> > that be helpful to the main library ?
>
> That would have a significant impact on the whole code base, as well as
> application code, so I didn't really considered that option and prefered an
> auxiliary interface to be used by code aware and caring about special
> behaviour for sparse datasets.
>
> >
> > Is this what is described by having the offset and byte count both zero ?
> Yes, in TIFF, you have 2 arrays, one that indicates at which offset in the
> file
> a given tile/strip is located, and the other one for the number of bytes of
> that tile/strip. GDAL uses offset = count = 0 as a convention for missing
> blocks.
> >
> > ----
> >
> > I don't really understand how GDAL_DATA_COVERAGE_STATUS values combine
> > or
>
> * If the requested window contains has no missing blocks, it returns
> GDAL_DATA_COVERAGE_STATUS_DATA
> * If the requested window has only missing blocks, it returns
> GDAL_DATA_COVERAGE_STATUS_EMPTY
> * If the requested window is a mix of both, it returns
> GDAL_DATA_COVERAGE_STATUS_DATA | GDAL_DATA_COVERAGE_STATUS_EMPTY
>
> > when pdfDataPct is valid.
>
> It should be valid if the processing has not been stopped prematurely due
> to
> the nMaskFlagStop being triggered. For example if you have a dataset and
> you
> want a special processing (could be just an info "This dataset is sparse")
> as
> soon as it contains empty blocks, then you can query the whole dataset
> extent
> with nMaskFlagStop = GDAL_DATA_COVERAGE_STATUS_EMPTY. As soon as a missing
> block is found, the function will exit, and will thus be unable to
> determine
> the percentage of valid data.
>
> >
> > In one of the formats above, the tile index has special values
> > for "no data" and and for "data exists and could be retrieved/purchased
> > if required". I'd consider mapping these to
> GDAL_DATA_COVERAGE_STATUS_EMPTY
>
> Clearly a missing block will cause GDAL_DATA_COVERAGE_STATUS_EMPTY to be
> set.
>
> > and GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED. Does that make sense ?
>
> GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED is aimed at being returned when a
> driver does not offer an implementation of the interface, and thus uses the
> default dumb implementation that returns
> GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED
>
> I realize that I didn't really document yet the semantics of those flags.
> To be
> done.
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160711/4af4b48e/attachment.html>

From jmckenna at gatewaygeomatics.com  Mon Jul 11 08:15:35 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 11 Jul 2016 12:15:35 -0300
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
 2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607081202.10600.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
Message-ID: <6010b1cd-68fa-8ddb-fa98-802cb0a2aa48@gatewaygeomatics.com>

On 2016-07-08 7:02 AM, Even Rouault wrote:
> Hi,
>
> Motions under vote:
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.

+1

>
> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.

+1

>
> To replace the retracted motion 3:
> Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
> release.

+1


-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




From even.rouault at spatialys.com  Mon Jul 11 08:31:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Jul 2016 17:31:58 +0200
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <CACmBxyv9JT21VQC5-Q4wTEOMeFwyiYsT1BcD7L66eBXbpeJnwQ@mail.gmail.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <201607101154.17484.even.rouault@spatialys.com>
 <CACmBxyv9JT21VQC5-Q4wTEOMeFwyiYsT1BcD7L66eBXbpeJnwQ@mail.gmail.com>
Message-ID: <201607111731.59285.even.rouault@spatialys.com>

Le lundi 11 juillet 2016 17:11:59, Kurt Schwehr a écrit :
> Even,
> 
> I think this looks good and a big win for a lot of use cases.
> 
> Comments related to the flags defined in gcore/gdal.h:
> 
> - If possible, use an enum rather than bare defines.

They are flags that can be OR'ed, so you cannot really define an enumeration. Or 
am I missing something ?


> - Add comments to gdal.h explaining what the values are
Yep, will do

> - Should an unimplemented also have the _DATA flag set rather than _EMPTY?

Yes, this is the case of the default GDALRasterBand::IGetDataCoverageStatus(). 
I should also mention it in the doc that a driver that would implement the 
method, but in some cases would want to return _UNIMPLEMENTED should also set 
_DATA. 

> 
> A suggestion for this
> <https://github.com/OSGeo/gdal/compare/trunk...rouault:sparse_datasets?expa
> nd=1#diff-66f7e256611c32cddc2745d78b4fe59bR3787>, which looks brittle to
> me:
> 
>      if( nStatus != GDAL_DATA_COVERAGE_STATUS_EMPTY )
> 
> A helper function to check empty rather than a direct check will allow for
> later or'ing the status with other flags.  Or you can & with the flag.  But
> looking at it a second time, I think it might be more explicit if you did a
> check against having data:
> 
>     if( nStatus & GDAL_DATA_COVERAGE_STATUS_DATA )

Yes, that's probably better (assuming that _unimplemented comes with _data 
set)

Thanks

> 
> -kurt
> 
> On Sun, Jul 10, 2016 at 2:54 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le dimanche 10 juillet 2016 11:32:48, Andrew C Aitchison a écrit :
> > > On Fri, 8 Jul 2016, Even Rouault wrote:
> > > > The topic of sparse dataset management come back regularly, so I've
> > > > decided to tackle it.
> > > > 
> > > > Please find
> > > > https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
> > 
> > for
> > 
> > > > review.
> > > 
> > > I know of several proprietary file formats where the data is tiled
> > > with the index indicating (perhaps implicitly) where the tile has no
> > > data.
> > > 
> > > A driver for such formats could have IReadBlock quickly return with
> > > a code to indicate NoData, rather than filling in the image data.
> > > As it stands that might mean extending CPLErr, but would
> > > that be helpful to the main library ?
> > 
> > That would have a significant impact on the whole code base, as well as
> > application code, so I didn't really considered that option and prefered
> > an auxiliary interface to be used by code aware and caring about special
> > behaviour for sparse datasets.
> > 
> > > Is this what is described by having the offset and byte count both zero
> > > ?
> > 
> > Yes, in TIFF, you have 2 arrays, one that indicates at which offset in
> > the file
> > a given tile/strip is located, and the other one for the number of bytes
> > of that tile/strip. GDAL uses offset = count = 0 as a convention for
> > missing blocks.
> > 
> > > ----
> > > 
> > > I don't really understand how GDAL_DATA_COVERAGE_STATUS values combine
> > > or
> > 
> > * If the requested window contains has no missing blocks, it returns
> > GDAL_DATA_COVERAGE_STATUS_DATA
> > * If the requested window has only missing blocks, it returns
> > GDAL_DATA_COVERAGE_STATUS_EMPTY
> > * If the requested window is a mix of both, it returns
> > GDAL_DATA_COVERAGE_STATUS_DATA | GDAL_DATA_COVERAGE_STATUS_EMPTY
> > 
> > > when pdfDataPct is valid.
> > 
> > It should be valid if the processing has not been stopped prematurely due
> > to
> > the nMaskFlagStop being triggered. For example if you have a dataset and
> > you
> > want a special processing (could be just an info "This dataset is
> > sparse") as
> > soon as it contains empty blocks, then you can query the whole dataset
> > extent
> > with nMaskFlagStop = GDAL_DATA_COVERAGE_STATUS_EMPTY. As soon as a
> > missing block is found, the function will exit, and will thus be unable
> > to determine
> > the percentage of valid data.
> > 
> > > In one of the formats above, the tile index has special values
> > > for "no data" and and for "data exists and could be retrieved/purchased
> > > if required". I'd consider mapping these to
> > 
> > GDAL_DATA_COVERAGE_STATUS_EMPTY
> > 
> > Clearly a missing block will cause GDAL_DATA_COVERAGE_STATUS_EMPTY to be
> > set.
> > 
> > > and GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED. Does that make sense ?
> > 
> > GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED is aimed at being returned when a
> > driver does not offer an implementation of the interface, and thus uses
> > the default dumb implementation that returns
> > GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED
> > 
> > I realize that I didn't really document yet the semantics of those flags.
> > To be
> > done.
> > 
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Mon Jul 11 08:42:36 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Jul 2016 08:42:36 -0700
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <201607111731.59285.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <201607101154.17484.even.rouault@spatialys.com>
 <CACmBxyv9JT21VQC5-Q4wTEOMeFwyiYsT1BcD7L66eBXbpeJnwQ@mail.gmail.com>
 <201607111731.59285.even.rouault@spatialys.com>
Message-ID: <CACmBxyuD6QtVaGyt_hA=rCPHnfkie+qTCc3s6fc-K2p4o3ioFQ@mail.gmail.com>

Scratch my enum comment...

http://stackoverflow.com/questions/1448396/how-to-use-enums-as-flags-in-c

On Mon, Jul 11, 2016 at 8:31 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 11 juillet 2016 17:11:59, Kurt Schwehr a écrit :
> > Even,
> >
> > I think this looks good and a big win for a lot of use cases.
> >
> > Comments related to the flags defined in gcore/gdal.h:
> >
> > - If possible, use an enum rather than bare defines.
>
> They are flags that can be OR'ed, so you cannot really define an
> enumeration. Or
> am I missing something ?
>
>
> > - Add comments to gdal.h explaining what the values are
> Yep, will do
>
> > - Should an unimplemented also have the _DATA flag set rather than
> _EMPTY?
>
> Yes, this is the case of the default
> GDALRasterBand::IGetDataCoverageStatus().
> I should also mention it in the doc that a driver that would implement the
> method, but in some cases would want to return _UNIMPLEMENTED should also
> set
> _DATA.
>
> >
> > A suggestion for this
> > <
> https://github.com/OSGeo/gdal/compare/trunk...rouault:sparse_datasets?expa
> > nd=1#diff-66f7e256611c32cddc2745d78b4fe59bR3787>, which looks brittle to
> > me:
> >
> >      if( nStatus != GDAL_DATA_COVERAGE_STATUS_EMPTY )
> >
> > A helper function to check empty rather than a direct check will allow
> for
> > later or'ing the status with other flags.  Or you can & with the flag.
> But
> > looking at it a second time, I think it might be more explicit if you
> did a
> > check against having data:
> >
> >     if( nStatus & GDAL_DATA_COVERAGE_STATUS_DATA )
>
> Yes, that's probably better (assuming that _unimplemented comes with _data
> set)
>
> Thanks
>
> >
> > -kurt
> >
> > On Sun, Jul 10, 2016 at 2:54 AM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Le dimanche 10 juillet 2016 11:32:48, Andrew C Aitchison a écrit :
> > > > On Fri, 8 Jul 2016, Even Rouault wrote:
> > > > > The topic of sparse dataset management come back regularly, so I've
> > > > > decided to tackle it.
> > > > >
> > > > > Please find
> > > > >
> https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
> > >
> > > for
> > >
> > > > > review.
> > > >
> > > > I know of several proprietary file formats where the data is tiled
> > > > with the index indicating (perhaps implicitly) where the tile has no
> > > > data.
> > > >
> > > > A driver for such formats could have IReadBlock quickly return with
> > > > a code to indicate NoData, rather than filling in the image data.
> > > > As it stands that might mean extending CPLErr, but would
> > > > that be helpful to the main library ?
> > >
> > > That would have a significant impact on the whole code base, as well as
> > > application code, so I didn't really considered that option and
> prefered
> > > an auxiliary interface to be used by code aware and caring about
> special
> > > behaviour for sparse datasets.
> > >
> > > > Is this what is described by having the offset and byte count both
> zero
> > > > ?
> > >
> > > Yes, in TIFF, you have 2 arrays, one that indicates at which offset in
> > > the file
> > > a given tile/strip is located, and the other one for the number of
> bytes
> > > of that tile/strip. GDAL uses offset = count = 0 as a convention for
> > > missing blocks.
> > >
> > > > ----
> > > >
> > > > I don't really understand how GDAL_DATA_COVERAGE_STATUS values
> combine
> > > > or
> > >
> > > * If the requested window contains has no missing blocks, it returns
> > > GDAL_DATA_COVERAGE_STATUS_DATA
> > > * If the requested window has only missing blocks, it returns
> > > GDAL_DATA_COVERAGE_STATUS_EMPTY
> > > * If the requested window is a mix of both, it returns
> > > GDAL_DATA_COVERAGE_STATUS_DATA | GDAL_DATA_COVERAGE_STATUS_EMPTY
> > >
> > > > when pdfDataPct is valid.
> > >
> > > It should be valid if the processing has not been stopped prematurely
> due
> > > to
> > > the nMaskFlagStop being triggered. For example if you have a dataset
> and
> > > you
> > > want a special processing (could be just an info "This dataset is
> > > sparse") as
> > > soon as it contains empty blocks, then you can query the whole dataset
> > > extent
> > > with nMaskFlagStop = GDAL_DATA_COVERAGE_STATUS_EMPTY. As soon as a
> > > missing block is found, the function will exit, and will thus be unable
> > > to determine
> > > the percentage of valid data.
> > >
> > > > In one of the formats above, the tile index has special values
> > > > for "no data" and and for "data exists and could be
> retrieved/purchased
> > > > if required". I'd consider mapping these to
> > >
> > > GDAL_DATA_COVERAGE_STATUS_EMPTY
> > >
> > > Clearly a missing block will cause GDAL_DATA_COVERAGE_STATUS_EMPTY to
> be
> > > set.
> > >
> > > > and GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED. Does that make sense ?
> > >
> > > GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED is aimed at being returned
> when a
> > > driver does not offer an implementation of the interface, and thus uses
> > > the default dumb implementation that returns
> > > GDAL_DATA_COVERAGE_STATUS_UNIMPLEMENTED
> > >
> > > I realize that I didn't really document yet the semantics of those
> flags.
> > > To be
> > > done.
> > >
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160711/1cbcb795/attachment-0001.html>

From schwehr at gmail.com  Mon Jul 11 09:36:45 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 11 Jul 2016 09:36:45 -0700
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
 2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607081202.10600.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
Message-ID: <CACmBxyui2yRupoBVGGbCWy8wMyf3fu330u8DVgGXiNh+j3GbSA@mail.gmail.com>

On Fri, Jul 8, 2016 at 3:02 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> Motions under vote:
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.
>

+1


>
> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final
> release.
>
>
+0 Did not test.


> To replace the retracted motion 3:
> Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
> release.
>
>
+1
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160711/454610e4/attachment.html>

From andre.hollstein at gfz-potsdam.de  Tue Jul 12 01:12:22 2016
From: andre.hollstein at gfz-potsdam.de (Andre Hollstein)
Date: Tue, 12 Jul 2016 10:12:22 +0200
Subject: [gdal-dev] unable to create jpeg200 files with self compiled gdal
	and openjpeg
Message-ID: <df2f209e-ef40-4b1e-b12d-5518da0609ba@gfz-potsdam.de>

Dear gdal experts,

I'm compiling gdal and a whole list of other libraries myself. Currently 
I'm using gdal-2.1.0 and openjepeg v2.1.1 and use the libs from python:

import gdal
import numpy as np
gdal.AllRegister()
#driver = 'JP2KAK'
driver = "JP2OpenJPEG"
#driver = "GTiff"
#driver = "JPEG2000" # jasper

fn = "./img_buf.%s" % 
{"GTiff":"tiff",'JP2KAK':"jp2","JP2OpenJPEG":"jp2","JPEG2000":"jp2"}[driver]

sh = (1000,1000)
img = np.ones(sh,dtype=np.int16)
dr = gdal.GetDriverByName(driver)
ds = dr.Create(fn,img.shape[0],img.shape[1],1,gdal.GDT_UInt16) # here I 
get: ERROR 6: GDALDriver::Create() ... no create method implemented for 
this format.
if ds is None: raise ValueError(fn)
rb = ds.GetRasterBand(1)
rb.WriteArray(img)
ds.FlushCache()
ds = None

This code works for geotiff, but not for jpeg2000. There I'm getting the 
error: ERROR 6: GDALDriver::Create() ... no create method implemented 
for this format.

I tested various combinations of various data types without any change 
in behavior.

I guess it should work, what can I do to solve this issue?

I compile openjpeg like this:

cmake . -DCMAKE_INSTALL_PREFIX=$prefix_opt -DCMAKE_C_FLAGS="-O3 -fPIC" 
-DBUILD_SHARED_LIBS:bool=on -DBUILD_CODEC:bool=on

and gdal like that:

kdu_opts=--with-kakadu=$prefix_opt
conda install --yes numpy
./configure \
--prefix $prefix_opt \
--with-openjpeg=$prefix_opt \
--with-jasper=$prefix_opt \
--with-libtiff=$prefix_opt \
--without-libtool \
--with-hdf4=$prefix_opt \
--with-hdf5=no \
--with-netcdf=no \
--with-geotiff=internal \
--with-grass=no \
--with-sqlite3=no \
$kdu_opts \
--with-pic \
--with-python=$prefix_python/bin/python \

make install
make clean

Am I missing any needed flags or options?

Kind regards, André

-- 
Dr. André Hollstein
Sektion 1.4 Fernerkundung
Tel.: +49 (0)331/288-28969
Fax: +49 (0)331/288-28969
E-Mail: andre.hollstein at gfz-potsdam.de
___________________________________

Helmholtz-Zentrum Potsdam
Deutsches GeoForschungsZentrum GFZ
Stiftung des öff. Rechts Land Brandenburg
Telegrafenberg, 14473 Potsdam
Haus 17, Raum 20.23


From even.rouault at spatialys.com  Tue Jul 12 01:33:44 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Jul 2016 10:33:44 +0200
Subject: [gdal-dev] unable to create jpeg200 files with self compiled
	gdal and openjpeg
In-Reply-To: <df2f209e-ef40-4b1e-b12d-5518da0609ba@gfz-potsdam.de>
References: <df2f209e-ef40-4b1e-b12d-5518da0609ba@gfz-potsdam.de>
Message-ID: <201607121033.44202.even.rouault@spatialys.com>

André,

> 
> This code works for geotiff, but not for jpeg2000. There I'm getting the
> error: ERROR 6: GDALDriver::Create() ... no create method implemented
> for this format.

You cannot directly use Create() for any of the JPEG2000 drivers as Create() 
assumes random writing capabilities which the JPEG2000 format doesn't offer. So 
the solution is to create a temporary dataset (for example with the MEM driver 
if it fits into RAM, or with an intermediate GeoTIFF otherwise) and then 
CreateCopy() it to JPEG2000

Something like:

tmp_ds = 
gdal.GetDriverByName('MEM').Create('',img.shape[0],img.shape[1],1,gdal.GDT_UInt16) 
# here I 
rb = tmp_ds.GetRasterBand(1)
rb.WriteArray(img)
dr.CreateCopy(fn, tmp_ds)
tmp_ds = None

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jul 12 02:30:36 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 12 Jul 2016 09:30:36 +0000
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
 2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607121120.20265.even.rouault@spatialys.com>
References: <201607121120.20265.even.rouault@spatialys.com>
Message-ID: <d472301a92884eeb9dd410aba34b5d2b@C119S212VM017.msvyvi.vaha.local>

+1 for all three.

-Jukka Rahkonen-

________________________________
Lähettäjä: Even Rouault<mailto:even.rouault at spatialys.com>
Lähetetty: ‎12.‎7.‎2016 12:15
Vastaanottaja: Rahkonen Jukka (MML)<mailto:jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Fwd: [gdal-dev] Motions: Promote 1.11.5 RC 1, 2.0.3 RC2 and and 2.1.1 RC2 for release


----------  Message transmis  ----------

Sujet : Fwd: [gdal-dev] Motions: Promote 1.11.5 RC 1, 2.0.3 RC2 and and 2.1.1
RC2 for release
Date : mardi 12 juillet 2016, 11:18:07
De : Even Rouault <even.rouault at spatialys.com>
À : Frank Warmerdam <warmerdam at pobox.com>, Daniel Morissette
<dmorissette at mapgears.com>, Tamas Szekeres <szekerest at gmail.com>, Howard
Butler <howard at hobu.co>, Andrey Kiselev <dron at ak4719.spb.edu>, Jukka Rahkonen
<jukka.rahkonen at mmmtike.fi>

Dear PSC members,

I'd appreciate a few more votes on those motions, especially regarding
2.0.3RC2 that hasn't yet reached the minimum +2 threshold.

Best regards,

Even

----------  Message transmis  ----------

Sujet : [gdal-dev] Motions: Promote 1.11.5 RC 1, 2.0.3 RC2 and and 2.1.1 RC2
for release
Date : vendredi 08 juillet 2016, 12:02:10
De : Even Rouault <even.rouault at spatialys.com>
À : gdal-dev at lists.osgeo.org

Hi,

Motions under vote:
Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
release.

Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.

To replace the retracted motion 3:
Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
release.

--

My votes :
Motion 1: + 1
Motion 2: + 1
Motion 3bis: + 1

Best regards,

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------------------------------------------------
--
Spatialys - Geospatial professional services
http://www.spatialys.com

-------------------------------------------------------
--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160712/fa81a271/attachment.html>

From jamessramm at gmail.com  Tue Jul 12 05:40:27 2016
From: jamessramm at gmail.com (jramm)
Date: Tue, 12 Jul 2016 05:40:27 -0700 (PDT)
Subject: [gdal-dev] GDAL raster processing library?
Message-ID: <1468327227051-5275948.post@n6.nabble.com>

I wonder if there is a use case/interest in a small library within GDAL to
facilitate generic raster processing. 

My idea would be to have a user-extensible framework to run processing
functions on whole rasters, with a growing library of common-such functions
within GDAL. 

Something along the lines of this:

/*******************************************************************/
typedef CPLErr (*GDALRasterProcessFn)(double *padfInArray, double
*padfOutArray, 
                int nWindowXSize, int nWindowYSize, void *pData, double
*pdfNoDataValue);
/**
* \brief Definition of a raster processing function. 
*
* A GDALRasterProcessFn accepts an array of data as input, applies custom
logic and writes the output to padfOutArray.
* Such a function can be passed to GDALRunRasterProcess to apply custom
processing to a GDALDataset in chunks and create 
* a new GDALDataset. 
*
* @param padfInArray The input array of data. 
*
* @param padfOutArray The output array of data. On first call (via
GDALRunRasterProcess) this will be an empty, initialised array,
*    which should be populated with the result of calculations on
padfInArray. In subsequent calls it will contain the result of the 
*    previous window. 
*
* @param nWindowXSize the actual x size (width) of the read window.
*
* @param nWindowYSize the actual y size (height) of the read window. The
length of padfInArray == padfOutArray == nWindowXSize * nWindowYSize
*
* @param pData Process-specific data. This data is passed straight through
to the GDALRasterProcessFn and may contain e.g user defined parameters.
*     The GDALRasterProcessFn definition would define the structure/type of
such data.
*
* @param pdfNoDataValue The no data value of the dataset
*/

CPLErr GDALRunRasterProcess(GDALRasterProcessFn processFn, GDALDataset
*poSrcDataset, 
                        GDALDataset *poDstDataset, void *pData, int
*pnWindowXSize, 
                        int *pnWindowYSize, int *pnPixelBuffer);
/**
* \brief Apply a raster processing function to each sub-window of a raster.
* 
* The input raster dataset is read in chunks of nWindowXSize * nWindowYSize
and each chunk is passed to the processing
* function. The output array from the function is written to the destination
dataset. 
* An optional 'pixel buffer' can be specified to allow overlaps between
successive windows. This is useful for 
* some algorithms, e.g. blob extraction, watershed/stream flow analysis,
convolution etc.
* Process specific data can be passed (e.g. configuration parameters). This
data is simply passed straight through to the processing
* function on each call. 
*
* @param processFn A GDALRasterProcessFn to apply to each sub window of the
raster. 
* 
* @param poSrcDataset The source raster dataset from which pixel values are
read
*
* @param poDstDataset The destination raster dataset to which pixel values
are written. Must support RasterIO in write mode.
*
* @param pData Process-specific data. This is passed straight through to the
GDALRasterProcessFn on each call. 
*
* @param pnWindowXSize The desired width of each read window. If NULL it
defaults to the 'natural' block size of the raster
*
* @param pnWindowYSize The desired height of each read window. If NULL it
defaults to the 'natural' block size.
*
* @param pnPixelBuffer A pixel buffer to apply to the read window. The read
window is expanded by pnPixelBuffer pixels in all directions such that 
*    each window overlaps by pnPixelBuffer pixels. Ignored if NULL or 0
*
* @return a CPLErr enum indicating whether the function succesfully ran. 
*/

                        
CPLErr GDALRunRasterProcesses(GDALRasterProcessFn *paProcessFn, int
nProcesses, GDALDataset *poSrcDataset, 
                        GDALDataset *poDstDataset, void **paData, int
*pnWindowXSize, 
                        int *pnWindowYSize, int *pnPixelBuffer);
                        
/**
* \brief Apply multiple raster processing functions to each sub-window of a
raster
*
* For each window, the functions defined by the paProcessFn array are called
in turn, with the array output of the previous function forming the input
* to the next function. This allows processing 'toolchains' to be built
without having to create intermediate datasets, which can be less efficient
in time and space. 
*
*
* @param paProcessFn An array of GDALRasterProcessFn to apply to each sub
window of the raster
*
* @param nProcesses The size of paProcessFn
*
* @param poSrcDataset The source raster dataset from which pixel values are
read
*
* @param poDstDataset The destination raster dataset to which pixel values
are written. Must support RasterIO in write mode.
*
* @param paData an array of process-specific data objects of size
nProcesses. Each data object will be passed to the corresponding
GDALRasterProcessFn
*
* @param pnWindowXSize The desired width of each read window. If NULL it
defaults to the 'natural' block size of the raster
*
* @param pnWindowYSize The desired height of each read window. If NULL it
defaults to the 'natural' block size.
*
* @param pnPixelBuffer A pixel buffer to apply to the read window. The read
window is expanded by pnPixelBuffer pixels in all directions such that 
*    each window overlaps by pnPixelBuffer pixels. If NULL, it is ignored. 
*
* @return a CPLErr enum indicating whether the function succesfully ran. 
*/
/*******************************************************************/

So GDALRunRasterProcess would take care of I/O and looping through the
dataset in chunks, which can be configure by the user. Each chunk is
submitted to the processing function, which does 'stuff' and populates the
output array. GDALRunRasterProcess would write it to the output dataset
object. 

An example of a processing function could be something like this:

/*******************************************************************/
typedef struct ReclassArgs {
    int nReclassArgs;
    double *padfMinBound;
    double *padfMaxBound;
    double *padfBinValue;
    
} ReclassArgs;


CPLErr Reclass(double *padfInArray, double *padfOutArray, 
               int nWindowXSize, int nWindowYSize, void *pData,
               double *pdfNoDataValue)
{
    ReclassArgs *poRargs = static_cast<ReclassArgs *>(pData);
    double pixel;
    for (int i = 0; i < nWindowXSize * nWindowYSize - 1; ++i){
        pixel = padfInArray[i];
        for (int k = 0; k < poRargs->nReclassArgs; ++k){
                if ((pixel > poRargs->padfMinBound[k]) && (pixel <=
poRargs->padfMaxBound[k])){
                    padfOutArray[i] = poRargs->padfBinValue[k];
                    break;
                }
        }
    }    
    return CE_None;
}
/*******************************************************************/

To use it you would:

/*******************************************************************/
// Open a source dataset
GDALDataset *poSrc = GDALOpen(...)

// Create some output dataset with same dimensions etc..
GDALDataset *poDst = ....

// Setup the reclass args
ReclassArgs *poRargs = ...

// Call the process
CPLErr retval = GDALRunRasterProcess(Reclass, poSrc, poDst, (void *)poRargs,
NULL, NULL, NULL);
/*******************************************************************/

GDAL could feature its own library of common functions...reclass, truncate,
blob extraction etc etc and a user of GDAL could write their own and have
GDAL process it. 

It would be useful to expose enough to python via SWIG so that a
GDALRasterProcessFn could be defined in python - this would then allow rapid
development in python, but push the expensive work of looping over dataset
chunks to C++.
I dont know enough about SWIG yet to see whether this would be feasible.

However, even in C++, it allows the user to only think about their algorithm
and leave the boilerplate to GDAL. 

I imagine all this being implemented in a 'sub library', something like
gdpl.h (geospatial/gdal dataset processing library), but sitting in the GDAL
source tree (then I can happily expose all the useful GDAL goodness without
being worried about users having to include gdal headers etc, and avoid any
work in having to abstract it away)

This is a first stab at defining something like this and is probably not yet
comprehensive enough.

Any thoughts?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp5275948.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From howard at hobu.co  Tue Jul 12 06:23:27 2016
From: howard at hobu.co (Howard Butler)
Date: Tue, 12 Jul 2016 08:23:27 -0500
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
	2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <CACmBxyui2yRupoBVGGbCWy8wMyf3fu330u8DVgGXiNh+j3GbSA@mail.gmail.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
 <CACmBxyui2yRupoBVGGbCWy8wMyf3fu330u8DVgGXiNh+j3GbSA@mail.gmail.com>
Message-ID: <4940A16D-B823-4AF3-8047-EAA959256A4F@hobu.co>


> On Fri, Jul 8, 2016 at 3:02 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> Hi,
> 
> Motions under vote:
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.

+1

> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.

+1

> To replace the retracted motion 3:
> Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
> release.

+1


From even.rouault at spatialys.com  Tue Jul 12 06:55:41 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Jul 2016 15:55:41 +0200
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <1468327227051-5275948.post@n6.nabble.com>
References: <1468327227051-5275948.post@n6.nabble.com>
Message-ID: <201607121555.41244.even.rouault@spatialys.com>

James,

There's some intersection with Ari's proposal :
https://trac.osgeo.org/gdal/wiki/rfc62_raster_algebra . At least regarding the 
overall purposes, since technically this is quite different.

Actually what you propose is very close to the existing VRT pixel functions of 
derived bands. See "Using Derived Bands" in 
http://www.gdal.org/gdal_vrttut.html . In the last days, we've merged 
Antonio's work regarding a predefined set of pixel functions.
Perhaps some extension to allow passing user parameters to the pixel func 
could be useful. It is possible to use pixel functions from Python as shown in 
https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/testnonboundtoswig.py#L303 
although this is a bit ugly as it uses ctypes and not SWIG. But should be 
possible through SWIG by introducing proper types similarly to what is done 
for the progress functions or error handler functions.

Even

Le mardi 12 juillet 2016 14:40:27, jramm a écrit :
> I wonder if there is a use case/interest in a small library within GDAL to
> facilitate generic raster processing.
> 
> My idea would be to have a user-extensible framework to run processing
> functions on whole rasters, with a growing library of common-such functions
> within GDAL.
> 
> Something along the lines of this:
> 
> /*******************************************************************/
> typedef CPLErr (*GDALRasterProcessFn)(double *padfInArray, double
> *padfOutArray,
>                 int nWindowXSize, int nWindowYSize, void *pData, double
> *pdfNoDataValue);
> /**
> * \brief Definition of a raster processing function.
> *
> * A GDALRasterProcessFn accepts an array of data as input, applies custom
> logic and writes the output to padfOutArray.
> * Such a function can be passed to GDALRunRasterProcess to apply custom
> processing to a GDALDataset in chunks and create
> * a new GDALDataset.
> *
> * @param padfInArray The input array of data.
> *
> * @param padfOutArray The output array of data. On first call (via
> GDALRunRasterProcess) this will be an empty, initialised array,
> *    which should be populated with the result of calculations on
> padfInArray. In subsequent calls it will contain the result of the
> *    previous window.
> *
> * @param nWindowXSize the actual x size (width) of the read window.
> *
> * @param nWindowYSize the actual y size (height) of the read window. The
> length of padfInArray == padfOutArray == nWindowXSize * nWindowYSize
> *
> * @param pData Process-specific data. This data is passed straight through
> to the GDALRasterProcessFn and may contain e.g user defined parameters.
> *     The GDALRasterProcessFn definition would define the structure/type of
> such data.
> *
> * @param pdfNoDataValue The no data value of the dataset
> */
> 
> CPLErr GDALRunRasterProcess(GDALRasterProcessFn processFn, GDALDataset
> *poSrcDataset,
>                         GDALDataset *poDstDataset, void *pData, int
> *pnWindowXSize,
>                         int *pnWindowYSize, int *pnPixelBuffer);
> /**
> * \brief Apply a raster processing function to each sub-window of a raster.
> *
> * The input raster dataset is read in chunks of nWindowXSize * nWindowYSize
> and each chunk is passed to the processing
> * function. The output array from the function is written to the
> destination dataset.
> * An optional 'pixel buffer' can be specified to allow overlaps between
> successive windows. This is useful for
> * some algorithms, e.g. blob extraction, watershed/stream flow analysis,
> convolution etc.
> * Process specific data can be passed (e.g. configuration parameters). This
> data is simply passed straight through to the processing
> * function on each call.
> *
> * @param processFn A GDALRasterProcessFn to apply to each sub window of the
> raster.
> *
> * @param poSrcDataset The source raster dataset from which pixel values are
> read
> *
> * @param poDstDataset The destination raster dataset to which pixel values
> are written. Must support RasterIO in write mode.
> *
> * @param pData Process-specific data. This is passed straight through to
> the GDALRasterProcessFn on each call.
> *
> * @param pnWindowXSize The desired width of each read window. If NULL it
> defaults to the 'natural' block size of the raster
> *
> * @param pnWindowYSize The desired height of each read window. If NULL it
> defaults to the 'natural' block size.
> *
> * @param pnPixelBuffer A pixel buffer to apply to the read window. The read
> window is expanded by pnPixelBuffer pixels in all directions such that
> *    each window overlaps by pnPixelBuffer pixels. Ignored if NULL or 0
> *
> * @return a CPLErr enum indicating whether the function succesfully ran.
> */
> 
> 
> CPLErr GDALRunRasterProcesses(GDALRasterProcessFn *paProcessFn, int
> nProcesses, GDALDataset *poSrcDataset,
>                         GDALDataset *poDstDataset, void **paData, int
> *pnWindowXSize,
>                         int *pnWindowYSize, int *pnPixelBuffer);
> 
> /**
> * \brief Apply multiple raster processing functions to each sub-window of a
> raster
> *
> * For each window, the functions defined by the paProcessFn array are
> called in turn, with the array output of the previous function forming the
> input * to the next function. This allows processing 'toolchains' to be
> built without having to create intermediate datasets, which can be less
> efficient in time and space.
> *
> *
> * @param paProcessFn An array of GDALRasterProcessFn to apply to each sub
> window of the raster
> *
> * @param nProcesses The size of paProcessFn
> *
> * @param poSrcDataset The source raster dataset from which pixel values are
> read
> *
> * @param poDstDataset The destination raster dataset to which pixel values
> are written. Must support RasterIO in write mode.
> *
> * @param paData an array of process-specific data objects of size
> nProcesses. Each data object will be passed to the corresponding
> GDALRasterProcessFn
> *
> * @param pnWindowXSize The desired width of each read window. If NULL it
> defaults to the 'natural' block size of the raster
> *
> * @param pnWindowYSize The desired height of each read window. If NULL it
> defaults to the 'natural' block size.
> *
> * @param pnPixelBuffer A pixel buffer to apply to the read window. The read
> window is expanded by pnPixelBuffer pixels in all directions such that
> *    each window overlaps by pnPixelBuffer pixels. If NULL, it is ignored.
> *
> * @return a CPLErr enum indicating whether the function succesfully ran.
> */
> /*******************************************************************/
> 
> So GDALRunRasterProcess would take care of I/O and looping through the
> dataset in chunks, which can be configure by the user. Each chunk is
> submitted to the processing function, which does 'stuff' and populates the
> output array. GDALRunRasterProcess would write it to the output dataset
> object.
> 
> An example of a processing function could be something like this:
> 
> /*******************************************************************/
> typedef struct ReclassArgs {
>     int nReclassArgs;
>     double *padfMinBound;
>     double *padfMaxBound;
>     double *padfBinValue;
> 
> } ReclassArgs;
> 
> 
> CPLErr Reclass(double *padfInArray, double *padfOutArray,
>                int nWindowXSize, int nWindowYSize, void *pData,
>                double *pdfNoDataValue)
> {
>     ReclassArgs *poRargs = static_cast<ReclassArgs *>(pData);
>     double pixel;
>     for (int i = 0; i < nWindowXSize * nWindowYSize - 1; ++i){
>         pixel = padfInArray[i];
>         for (int k = 0; k < poRargs->nReclassArgs; ++k){
>                 if ((pixel > poRargs->padfMinBound[k]) && (pixel <=
> poRargs->padfMaxBound[k])){
>                     padfOutArray[i] = poRargs->padfBinValue[k];
>                     break;
>                 }
>         }
>     }
>     return CE_None;
> }
> /*******************************************************************/
> 
> To use it you would:
> 
> /*******************************************************************/
> // Open a source dataset
> GDALDataset *poSrc = GDALOpen(...)
> 
> // Create some output dataset with same dimensions etc..
> GDALDataset *poDst = ....
> 
> // Setup the reclass args
> ReclassArgs *poRargs = ...
> 
> // Call the process
> CPLErr retval = GDALRunRasterProcess(Reclass, poSrc, poDst, (void
> *)poRargs, NULL, NULL, NULL);
> /*******************************************************************/
> 
> GDAL could feature its own library of common functions...reclass, truncate,
> blob extraction etc etc and a user of GDAL could write their own and have
> GDAL process it.
> 
> It would be useful to expose enough to python via SWIG so that a
> GDALRasterProcessFn could be defined in python - this would then allow
> rapid development in python, but push the expensive work of looping over
> dataset chunks to C++.
> I dont know enough about SWIG yet to see whether this would be feasible.
> 
> However, even in C++, it allows the user to only think about their
> algorithm and leave the boilerplate to GDAL.
> 
> I imagine all this being implemented in a 'sub library', something like
> gdpl.h (geospatial/gdal dataset processing library), but sitting in the
> GDAL source tree (then I can happily expose all the useful GDAL goodness
> without being worried about users having to include gdal headers etc, and
> avoid any work in having to abstract it away)
> 
> This is a first stab at defining something like this and is probably not
> yet comprehensive enough.
> 
> Any thoughts?
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp52759
> 48.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Tue Jul 12 07:05:26 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 12 Jul 2016 10:05:26 -0400
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
 2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607081202.10600.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
Message-ID: <8a2bc279-bfc8-fcc0-1b6a-e204129bac62@mapgears.com>

+0 on all three. I didn't have a chance to fully test, but I'm very 
supportive.

Daniel


On 2016-07-08 6:02 AM, Even Rouault wrote:
> Hi,
>
> Motions under vote:
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.
>
> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final release.
>
> To replace the retracted motion 3:
> Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
> release.
>
> --
>
> My votes :
> Motion 1: + 1
> Motion 2: + 1
> Motion 3bis: + 1
>
> Best regards,
>
> Even
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From jamessramm at gmail.com  Tue Jul 12 07:39:34 2016
From: jamessramm at gmail.com (James Ramm)
Date: Tue, 12 Jul 2016 15:39:34 +0100
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <201607121555.41244.even.rouault@spatialys.com>
References: <1468327227051-5275948.post@n6.nabble.com>
 <201607121555.41244.even.rouault@spatialys.com>
Message-ID: <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>

Hi Even,

The difference I see with pixel functions is that, as far as I understand,
the pixel function is applied per pixel, so there is no possibility of e.g.
the pixel buffer when have the function apply to 'blocks'.
I may be way off, but many of the algorithms we deal with require some kind
of neighbourhood search - a polygonise algorithm or flow direction
algorithm being good examples.
I dont think VRT pixel functions allow this?

So in that sense I'd see a VRT being 'just' another potential input data
source.

Perhaps VRT pixel functions could be expanded to also allow 'window'
functions?

A downside is it requires creating a VRT even when you only want to apply a
such a function to a single dataset. Small effort, but still a bit more
than throwing in any GDALDataset to be processed.

I see the overlap with raster algebra, although yes technically very
different.



On 12 July 2016 at 14:55, Even Rouault <even.rouault at spatialys.com> wrote:

> James,
>
> There's some intersection with Ari's proposal :
> https://trac.osgeo.org/gdal/wiki/rfc62_raster_algebra . At least
> regarding the
> overall purposes, since technically this is quite different.
>
> Actually what you propose is very close to the existing VRT pixel
> functions of
> derived bands. See "Using Derived Bands" in
> http://www.gdal.org/gdal_vrttut.html . In the last days, we've merged
> Antonio's work regarding a predefined set of pixel functions.
> Perhaps some extension to allow passing user parameters to the pixel func
> could be useful. It is possible to use pixel functions from Python as
> shown in
>
> https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/testnonboundtoswig.py#L303
> although this is a bit ugly as it uses ctypes and not SWIG. But should be
> possible through SWIG by introducing proper types similarly to what is done
> for the progress functions or error handler functions.
>
> Even
>
> Le mardi 12 juillet 2016 14:40:27, jramm a écrit :
> > I wonder if there is a use case/interest in a small library within GDAL
> to
> > facilitate generic raster processing.
> >
> > My idea would be to have a user-extensible framework to run processing
> > functions on whole rasters, with a growing library of common-such
> functions
> > within GDAL.
> >
> > Something along the lines of this:
> >
> > /*******************************************************************/
> > typedef CPLErr (*GDALRasterProcessFn)(double *padfInArray, double
> > *padfOutArray,
> >                 int nWindowXSize, int nWindowYSize, void *pData, double
> > *pdfNoDataValue);
> > /**
> > * \brief Definition of a raster processing function.
> > *
> > * A GDALRasterProcessFn accepts an array of data as input, applies custom
> > logic and writes the output to padfOutArray.
> > * Such a function can be passed to GDALRunRasterProcess to apply custom
> > processing to a GDALDataset in chunks and create
> > * a new GDALDataset.
> > *
> > * @param padfInArray The input array of data.
> > *
> > * @param padfOutArray The output array of data. On first call (via
> > GDALRunRasterProcess) this will be an empty, initialised array,
> > *    which should be populated with the result of calculations on
> > padfInArray. In subsequent calls it will contain the result of the
> > *    previous window.
> > *
> > * @param nWindowXSize the actual x size (width) of the read window.
> > *
> > * @param nWindowYSize the actual y size (height) of the read window. The
> > length of padfInArray == padfOutArray == nWindowXSize * nWindowYSize
> > *
> > * @param pData Process-specific data. This data is passed straight
> through
> > to the GDALRasterProcessFn and may contain e.g user defined parameters.
> > *     The GDALRasterProcessFn definition would define the structure/type
> of
> > such data.
> > *
> > * @param pdfNoDataValue The no data value of the dataset
> > */
> >
> > CPLErr GDALRunRasterProcess(GDALRasterProcessFn processFn, GDALDataset
> > *poSrcDataset,
> >                         GDALDataset *poDstDataset, void *pData, int
> > *pnWindowXSize,
> >                         int *pnWindowYSize, int *pnPixelBuffer);
> > /**
> > * \brief Apply a raster processing function to each sub-window of a
> raster.
> > *
> > * The input raster dataset is read in chunks of nWindowXSize *
> nWindowYSize
> > and each chunk is passed to the processing
> > * function. The output array from the function is written to the
> > destination dataset.
> > * An optional 'pixel buffer' can be specified to allow overlaps between
> > successive windows. This is useful for
> > * some algorithms, e.g. blob extraction, watershed/stream flow analysis,
> > convolution etc.
> > * Process specific data can be passed (e.g. configuration parameters).
> This
> > data is simply passed straight through to the processing
> > * function on each call.
> > *
> > * @param processFn A GDALRasterProcessFn to apply to each sub window of
> the
> > raster.
> > *
> > * @param poSrcDataset The source raster dataset from which pixel values
> are
> > read
> > *
> > * @param poDstDataset The destination raster dataset to which pixel
> values
> > are written. Must support RasterIO in write mode.
> > *
> > * @param pData Process-specific data. This is passed straight through to
> > the GDALRasterProcessFn on each call.
> > *
> > * @param pnWindowXSize The desired width of each read window. If NULL it
> > defaults to the 'natural' block size of the raster
> > *
> > * @param pnWindowYSize The desired height of each read window. If NULL it
> > defaults to the 'natural' block size.
> > *
> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
> read
> > window is expanded by pnPixelBuffer pixels in all directions such that
> > *    each window overlaps by pnPixelBuffer pixels. Ignored if NULL or 0
> > *
> > * @return a CPLErr enum indicating whether the function succesfully ran.
> > */
> >
> >
> > CPLErr GDALRunRasterProcesses(GDALRasterProcessFn *paProcessFn, int
> > nProcesses, GDALDataset *poSrcDataset,
> >                         GDALDataset *poDstDataset, void **paData, int
> > *pnWindowXSize,
> >                         int *pnWindowYSize, int *pnPixelBuffer);
> >
> > /**
> > * \brief Apply multiple raster processing functions to each sub-window
> of a
> > raster
> > *
> > * For each window, the functions defined by the paProcessFn array are
> > called in turn, with the array output of the previous function forming
> the
> > input * to the next function. This allows processing 'toolchains' to be
> > built without having to create intermediate datasets, which can be less
> > efficient in time and space.
> > *
> > *
> > * @param paProcessFn An array of GDALRasterProcessFn to apply to each sub
> > window of the raster
> > *
> > * @param nProcesses The size of paProcessFn
> > *
> > * @param poSrcDataset The source raster dataset from which pixel values
> are
> > read
> > *
> > * @param poDstDataset The destination raster dataset to which pixel
> values
> > are written. Must support RasterIO in write mode.
> > *
> > * @param paData an array of process-specific data objects of size
> > nProcesses. Each data object will be passed to the corresponding
> > GDALRasterProcessFn
> > *
> > * @param pnWindowXSize The desired width of each read window. If NULL it
> > defaults to the 'natural' block size of the raster
> > *
> > * @param pnWindowYSize The desired height of each read window. If NULL it
> > defaults to the 'natural' block size.
> > *
> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
> read
> > window is expanded by pnPixelBuffer pixels in all directions such that
> > *    each window overlaps by pnPixelBuffer pixels. If NULL, it is
> ignored.
> > *
> > * @return a CPLErr enum indicating whether the function succesfully ran.
> > */
> > /*******************************************************************/
> >
> > So GDALRunRasterProcess would take care of I/O and looping through the
> > dataset in chunks, which can be configure by the user. Each chunk is
> > submitted to the processing function, which does 'stuff' and populates
> the
> > output array. GDALRunRasterProcess would write it to the output dataset
> > object.
> >
> > An example of a processing function could be something like this:
> >
> > /*******************************************************************/
> > typedef struct ReclassArgs {
> >     int nReclassArgs;
> >     double *padfMinBound;
> >     double *padfMaxBound;
> >     double *padfBinValue;
> >
> > } ReclassArgs;
> >
> >
> > CPLErr Reclass(double *padfInArray, double *padfOutArray,
> >                int nWindowXSize, int nWindowYSize, void *pData,
> >                double *pdfNoDataValue)
> > {
> >     ReclassArgs *poRargs = static_cast<ReclassArgs *>(pData);
> >     double pixel;
> >     for (int i = 0; i < nWindowXSize * nWindowYSize - 1; ++i){
> >         pixel = padfInArray[i];
> >         for (int k = 0; k < poRargs->nReclassArgs; ++k){
> >                 if ((pixel > poRargs->padfMinBound[k]) && (pixel <=
> > poRargs->padfMaxBound[k])){
> >                     padfOutArray[i] = poRargs->padfBinValue[k];
> >                     break;
> >                 }
> >         }
> >     }
> >     return CE_None;
> > }
> > /*******************************************************************/
> >
> > To use it you would:
> >
> > /*******************************************************************/
> > // Open a source dataset
> > GDALDataset *poSrc = GDALOpen(...)
> >
> > // Create some output dataset with same dimensions etc..
> > GDALDataset *poDst = ....
> >
> > // Setup the reclass args
> > ReclassArgs *poRargs = ...
> >
> > // Call the process
> > CPLErr retval = GDALRunRasterProcess(Reclass, poSrc, poDst, (void
> > *)poRargs, NULL, NULL, NULL);
> > /*******************************************************************/
> >
> > GDAL could feature its own library of common functions...reclass,
> truncate,
> > blob extraction etc etc and a user of GDAL could write their own and have
> > GDAL process it.
> >
> > It would be useful to expose enough to python via SWIG so that a
> > GDALRasterProcessFn could be defined in python - this would then allow
> > rapid development in python, but push the expensive work of looping over
> > dataset chunks to C++.
> > I dont know enough about SWIG yet to see whether this would be feasible.
> >
> > However, even in C++, it allows the user to only think about their
> > algorithm and leave the boilerplate to GDAL.
> >
> > I imagine all this being implemented in a 'sub library', something like
> > gdpl.h (geospatial/gdal dataset processing library), but sitting in the
> > GDAL source tree (then I can happily expose all the useful GDAL goodness
> > without being worried about users having to include gdal headers etc, and
> > avoid any work in having to abstract it away)
> >
> > This is a first stab at defining something like this and is probably not
> > yet comprehensive enough.
> >
> > Any thoughts?
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp52759
> > 48.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160712/39ec585f/attachment-0001.html>

From p.halls at york.ac.uk  Tue Jul 12 07:47:53 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Tue, 12 Jul 2016 15:47:53 +0100
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
References: <1468327227051-5275948.post@n6.nabble.com>
 <201607121555.41244.even.rouault@spatialys.com>
 <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
Message-ID: <CADEnnOOrij+H2SH33aJYXNySwAtKq9erkAkGp3PJBpyR1NcxHA@mail.gmail.com>

James,

      in reality, are you not requesting an implementation of Tomlin's
'Grid Algebra' in GDAL?  That defines the whole range of functions from
whole raster to pixel and has the distinct advantage of being both
published and extremely well known because of other implementations ...
which also provide ready-made reference bases for the GDAL implementors ...

Best wishes,
Peter

On 12 July 2016 at 15:39, James Ramm <jamessramm at gmail.com> wrote:

> Hi Even,
>
> The difference I see with pixel functions is that, as far as I understand,
> the pixel function is applied per pixel, so there is no possibility of e.g.
> the pixel buffer when have the function apply to 'blocks'.
> I may be way off, but many of the algorithms we deal with require some
> kind of neighbourhood search - a polygonise algorithm or flow direction
> algorithm being good examples.
> I dont think VRT pixel functions allow this?
>
> So in that sense I'd see a VRT being 'just' another potential input data
> source.
>
> Perhaps VRT pixel functions could be expanded to also allow 'window'
> functions?
>
> A downside is it requires creating a VRT even when you only want to apply
> a such a function to a single dataset. Small effort, but still a bit more
> than throwing in any GDALDataset to be processed.
>
> I see the overlap with raster algebra, although yes technically very
> different.
>
>
>
> On 12 July 2016 at 14:55, Even Rouault <even.rouault at spatialys.com> wrote:
>
>> James,
>>
>> There's some intersection with Ari's proposal :
>> https://trac.osgeo.org/gdal/wiki/rfc62_raster_algebra . At least
>> regarding the
>> overall purposes, since technically this is quite different.
>>
>> Actually what you propose is very close to the existing VRT pixel
>> functions of
>> derived bands. See "Using Derived Bands" in
>> http://www.gdal.org/gdal_vrttut.html . In the last days, we've merged
>> Antonio's work regarding a predefined set of pixel functions.
>> Perhaps some extension to allow passing user parameters to the pixel func
>> could be useful. It is possible to use pixel functions from Python as
>> shown in
>>
>> https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/testnonboundtoswig.py#L303
>> although this is a bit ugly as it uses ctypes and not SWIG. But should be
>> possible through SWIG by introducing proper types similarly to what is
>> done
>> for the progress functions or error handler functions.
>>
>> Even
>>
>> Le mardi 12 juillet 2016 14:40:27, jramm a écrit :
>> > I wonder if there is a use case/interest in a small library within GDAL
>> to
>> > facilitate generic raster processing.
>> >
>> > My idea would be to have a user-extensible framework to run processing
>> > functions on whole rasters, with a growing library of common-such
>> functions
>> > within GDAL.
>> >
>> > Something along the lines of this:
>> >
>> > /*******************************************************************/
>> > typedef CPLErr (*GDALRasterProcessFn)(double *padfInArray, double
>> > *padfOutArray,
>> >                 int nWindowXSize, int nWindowYSize, void *pData, double
>> > *pdfNoDataValue);
>> > /**
>> > * \brief Definition of a raster processing function.
>> > *
>> > * A GDALRasterProcessFn accepts an array of data as input, applies
>> custom
>> > logic and writes the output to padfOutArray.
>> > * Such a function can be passed to GDALRunRasterProcess to apply custom
>> > processing to a GDALDataset in chunks and create
>> > * a new GDALDataset.
>> > *
>> > * @param padfInArray The input array of data.
>> > *
>> > * @param padfOutArray The output array of data. On first call (via
>> > GDALRunRasterProcess) this will be an empty, initialised array,
>> > *    which should be populated with the result of calculations on
>> > padfInArray. In subsequent calls it will contain the result of the
>> > *    previous window.
>> > *
>> > * @param nWindowXSize the actual x size (width) of the read window.
>> > *
>> > * @param nWindowYSize the actual y size (height) of the read window. The
>> > length of padfInArray == padfOutArray == nWindowXSize * nWindowYSize
>> > *
>> > * @param pData Process-specific data. This data is passed straight
>> through
>> > to the GDALRasterProcessFn and may contain e.g user defined parameters.
>> > *     The GDALRasterProcessFn definition would define the
>> structure/type of
>> > such data.
>> > *
>> > * @param pdfNoDataValue The no data value of the dataset
>> > */
>> >
>> > CPLErr GDALRunRasterProcess(GDALRasterProcessFn processFn, GDALDataset
>> > *poSrcDataset,
>> >                         GDALDataset *poDstDataset, void *pData, int
>> > *pnWindowXSize,
>> >                         int *pnWindowYSize, int *pnPixelBuffer);
>> > /**
>> > * \brief Apply a raster processing function to each sub-window of a
>> raster.
>> > *
>> > * The input raster dataset is read in chunks of nWindowXSize *
>> nWindowYSize
>> > and each chunk is passed to the processing
>> > * function. The output array from the function is written to the
>> > destination dataset.
>> > * An optional 'pixel buffer' can be specified to allow overlaps between
>> > successive windows. This is useful for
>> > * some algorithms, e.g. blob extraction, watershed/stream flow analysis,
>> > convolution etc.
>> > * Process specific data can be passed (e.g. configuration parameters).
>> This
>> > data is simply passed straight through to the processing
>> > * function on each call.
>> > *
>> > * @param processFn A GDALRasterProcessFn to apply to each sub window of
>> the
>> > raster.
>> > *
>> > * @param poSrcDataset The source raster dataset from which pixel values
>> are
>> > read
>> > *
>> > * @param poDstDataset The destination raster dataset to which pixel
>> values
>> > are written. Must support RasterIO in write mode.
>> > *
>> > * @param pData Process-specific data. This is passed straight through to
>> > the GDALRasterProcessFn on each call.
>> > *
>> > * @param pnWindowXSize The desired width of each read window. If NULL it
>> > defaults to the 'natural' block size of the raster
>> > *
>> > * @param pnWindowYSize The desired height of each read window. If NULL
>> it
>> > defaults to the 'natural' block size.
>> > *
>> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
>> read
>> > window is expanded by pnPixelBuffer pixels in all directions such that
>> > *    each window overlaps by pnPixelBuffer pixels. Ignored if NULL or 0
>> > *
>> > * @return a CPLErr enum indicating whether the function succesfully ran.
>> > */
>> >
>> >
>> > CPLErr GDALRunRasterProcesses(GDALRasterProcessFn *paProcessFn, int
>> > nProcesses, GDALDataset *poSrcDataset,
>> >                         GDALDataset *poDstDataset, void **paData, int
>> > *pnWindowXSize,
>> >                         int *pnWindowYSize, int *pnPixelBuffer);
>> >
>> > /**
>> > * \brief Apply multiple raster processing functions to each sub-window
>> of a
>> > raster
>> > *
>> > * For each window, the functions defined by the paProcessFn array are
>> > called in turn, with the array output of the previous function forming
>> the
>> > input * to the next function. This allows processing 'toolchains' to be
>> > built without having to create intermediate datasets, which can be less
>> > efficient in time and space.
>> > *
>> > *
>> > * @param paProcessFn An array of GDALRasterProcessFn to apply to each
>> sub
>> > window of the raster
>> > *
>> > * @param nProcesses The size of paProcessFn
>> > *
>> > * @param poSrcDataset The source raster dataset from which pixel values
>> are
>> > read
>> > *
>> > * @param poDstDataset The destination raster dataset to which pixel
>> values
>> > are written. Must support RasterIO in write mode.
>> > *
>> > * @param paData an array of process-specific data objects of size
>> > nProcesses. Each data object will be passed to the corresponding
>> > GDALRasterProcessFn
>> > *
>> > * @param pnWindowXSize The desired width of each read window. If NULL it
>> > defaults to the 'natural' block size of the raster
>> > *
>> > * @param pnWindowYSize The desired height of each read window. If NULL
>> it
>> > defaults to the 'natural' block size.
>> > *
>> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
>> read
>> > window is expanded by pnPixelBuffer pixels in all directions such that
>> > *    each window overlaps by pnPixelBuffer pixels. If NULL, it is
>> ignored.
>> > *
>> > * @return a CPLErr enum indicating whether the function succesfully ran.
>> > */
>> > /*******************************************************************/
>> >
>> > So GDALRunRasterProcess would take care of I/O and looping through the
>> > dataset in chunks, which can be configure by the user. Each chunk is
>> > submitted to the processing function, which does 'stuff' and populates
>> the
>> > output array. GDALRunRasterProcess would write it to the output dataset
>> > object.
>> >
>> > An example of a processing function could be something like this:
>> >
>> > /*******************************************************************/
>> > typedef struct ReclassArgs {
>> >     int nReclassArgs;
>> >     double *padfMinBound;
>> >     double *padfMaxBound;
>> >     double *padfBinValue;
>> >
>> > } ReclassArgs;
>> >
>> >
>> > CPLErr Reclass(double *padfInArray, double *padfOutArray,
>> >                int nWindowXSize, int nWindowYSize, void *pData,
>> >                double *pdfNoDataValue)
>> > {
>> >     ReclassArgs *poRargs = static_cast<ReclassArgs *>(pData);
>> >     double pixel;
>> >     for (int i = 0; i < nWindowXSize * nWindowYSize - 1; ++i){
>> >         pixel = padfInArray[i];
>> >         for (int k = 0; k < poRargs->nReclassArgs; ++k){
>> >                 if ((pixel > poRargs->padfMinBound[k]) && (pixel <=
>> > poRargs->padfMaxBound[k])){
>> >                     padfOutArray[i] = poRargs->padfBinValue[k];
>> >                     break;
>> >                 }
>> >         }
>> >     }
>> >     return CE_None;
>> > }
>> > /*******************************************************************/
>> >
>> > To use it you would:
>> >
>> > /*******************************************************************/
>> > // Open a source dataset
>> > GDALDataset *poSrc = GDALOpen(...)
>> >
>> > // Create some output dataset with same dimensions etc..
>> > GDALDataset *poDst = ....
>> >
>> > // Setup the reclass args
>> > ReclassArgs *poRargs = ...
>> >
>> > // Call the process
>> > CPLErr retval = GDALRunRasterProcess(Reclass, poSrc, poDst, (void
>> > *)poRargs, NULL, NULL, NULL);
>> > /*******************************************************************/
>> >
>> > GDAL could feature its own library of common functions...reclass,
>> truncate,
>> > blob extraction etc etc and a user of GDAL could write their own and
>> have
>> > GDAL process it.
>> >
>> > It would be useful to expose enough to python via SWIG so that a
>> > GDALRasterProcessFn could be defined in python - this would then allow
>> > rapid development in python, but push the expensive work of looping over
>> > dataset chunks to C++.
>> > I dont know enough about SWIG yet to see whether this would be feasible.
>> >
>> > However, even in C++, it allows the user to only think about their
>> > algorithm and leave the boilerplate to GDAL.
>> >
>> > I imagine all this being implemented in a 'sub library', something like
>> > gdpl.h (geospatial/gdal dataset processing library), but sitting in the
>> > GDAL source tree (then I can happily expose all the useful GDAL goodness
>> > without being worried about users having to include gdal headers etc,
>> and
>> > avoid any work in having to abstract it away)
>> >
>> > This is a first stab at defining something like this and is probably not
>> > yet comprehensive enough.
>> >
>> > Any thoughts?
>> >
>> >
>> >
>> >
>> > --
>> > View this message in context:
>> >
>> http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp52759
>> > 48.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
(PRDU),
                      University of York

Snail mail: c/o Research Centre for the Social Sciences (RCSS),
        University of York,
        Heslington, York YO10 5DD

This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160712/3352bfc3/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jul 12 07:57:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Jul 2016 16:57:47 +0200
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
References: <1468327227051-5275948.post@n6.nabble.com>
 <201607121555.41244.even.rouault@spatialys.com>
 <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
Message-ID: <201607121657.48141.even.rouault@spatialys.com>

Le mardi 12 juillet 2016 16:39:34, James Ramm a écrit :
> Hi Even,
> 
> The difference I see with pixel functions is that, as far as I understand,
> the pixel function is applied per pixel, so there is no possibility of e.g.
> the pixel buffer when have the function apply to 'blocks'.
> I may be way off, but many of the algorithms we deal with require some kind
> of neighbourhood search - a polygonise algorithm or flow direction
> algorithm being good examples.
> I dont think VRT pixel functions allow this?

True, they don't. Although there's the KernelFilteredSource that is close

> 
> So in that sense I'd see a VRT being 'just' another potential input data
> source.
> 
> Perhaps VRT pixel functions could be expanded to also allow 'window'
> functions?

Would make sense

> 
> A downside is it requires creating a VRT even when you only want to apply a
> such a function to a single dataset. Small effort, but still a bit more
> than throwing in any GDALDataset to be processed.

You could have an helper function to create the VRT dataset from the input 
dataset, the processing function and its parameters. A bit similarly to what 
Julien is doing in 
https://github.com/OSGeo/gdal/pull/142/files#diff-0c9bf560508edf2453cd2f776d72f905R121

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Tue Jul 12 10:08:50 2016
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 12 Jul 2016 19:08:50 +0200
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
 2.0.3 RC2 and and 2.1.1 RC2for release
In-Reply-To: <201607081202.10600.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
Message-ID: <57852422.46461c0a.2305c.ffffceb5@mx.google.com>

+1 for all

Tamas



Feladó: Even Rouault
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160712/a771fc17/attachment.html>

From jamessramm at gmail.com  Wed Jul 13 00:09:46 2016
From: jamessramm at gmail.com (James Ramm)
Date: Wed, 13 Jul 2016 08:09:46 +0100
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <CADEnnOOrij+H2SH33aJYXNySwAtKq9erkAkGp3PJBpyR1NcxHA@mail.gmail.com>
References: <1468327227051-5275948.post@n6.nabble.com>
 <201607121555.41244.even.rouault@spatialys.com>
 <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
 <CADEnnOOrij+H2SH33aJYXNySwAtKq9erkAkGp3PJBpyR1NcxHA@mail.gmail.com>
Message-ID: <CAEW=KS76Mk5kab9b7jYR=rh5U7jKVzxLzQoRWnOEm0Eym7exUQ@mail.gmail.com>

Peter,
I think 'Grid Algebra' would be what Ari Jolma is proposing here:
https://trac.osgeo.org/gdal/wiki/rfc62_raster_algebra

As Even pointed out, there is some overlap, though my proposal is
technically very different.
The key differences I see are:

- Users can submit functions which operate on each sub window of the
raster, rather than an algebraic expression. This potentially allows for
much more complicated algorithms to be used (e.g. I dont think it would be
possible to run a watershed segmentation with a raster algebra
implementation, or to have algorithms which behave differently depending on
the 'location' within the raster or the values of surrounding pixels etc
etc).

- Functions can be chained together for a complex processing toolchain.
Some overlap with VRT here, although again this introduces a little more
flexibility.

On 12 July 2016 at 15:47, Peter Halls <p.halls at york.ac.uk> wrote:

> James,
>
>       in reality, are you not requesting an implementation of Tomlin's
> 'Grid Algebra' in GDAL?  That defines the whole range of functions from
> whole raster to pixel and has the distinct advantage of being both
> published and extremely well known because of other implementations ...
> which also provide ready-made reference bases for the GDAL implementors ...
>
> Best wishes,
> Peter
>
> On 12 July 2016 at 15:39, James Ramm <jamessramm at gmail.com> wrote:
>
>> Hi Even,
>>
>> The difference I see with pixel functions is that, as far as I
>> understand, the pixel function is applied per pixel, so there is no
>> possibility of e.g. the pixel buffer when have the function apply to
>> 'blocks'.
>> I may be way off, but many of the algorithms we deal with require some
>> kind of neighbourhood search - a polygonise algorithm or flow direction
>> algorithm being good examples.
>> I dont think VRT pixel functions allow this?
>>
>> So in that sense I'd see a VRT being 'just' another potential input data
>> source.
>>
>> Perhaps VRT pixel functions could be expanded to also allow 'window'
>> functions?
>>
>> A downside is it requires creating a VRT even when you only want to apply
>> a such a function to a single dataset. Small effort, but still a bit more
>> than throwing in any GDALDataset to be processed.
>>
>> I see the overlap with raster algebra, although yes technically very
>> different.
>>
>>
>>
>> On 12 July 2016 at 14:55, Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>
>>> James,
>>>
>>> There's some intersection with Ari's proposal :
>>> https://trac.osgeo.org/gdal/wiki/rfc62_raster_algebra . At least
>>> regarding the
>>> overall purposes, since technically this is quite different.
>>>
>>> Actually what you propose is very close to the existing VRT pixel
>>> functions of
>>> derived bands. See "Using Derived Bands" in
>>> http://www.gdal.org/gdal_vrttut.html . In the last days, we've merged
>>> Antonio's work regarding a predefined set of pixel functions.
>>> Perhaps some extension to allow passing user parameters to the pixel func
>>> could be useful. It is possible to use pixel functions from Python as
>>> shown in
>>>
>>> https://github.com/OSGeo/gdal/blob/trunk/autotest/gcore/testnonboundtoswig.py#L303
>>> although this is a bit ugly as it uses ctypes and not SWIG. But should be
>>> possible through SWIG by introducing proper types similarly to what is
>>> done
>>> for the progress functions or error handler functions.
>>>
>>> Even
>>>
>>> Le mardi 12 juillet 2016 14:40:27, jramm a écrit :
>>> > I wonder if there is a use case/interest in a small library within
>>> GDAL to
>>> > facilitate generic raster processing.
>>> >
>>> > My idea would be to have a user-extensible framework to run processing
>>> > functions on whole rasters, with a growing library of common-such
>>> functions
>>> > within GDAL.
>>> >
>>> > Something along the lines of this:
>>> >
>>> > /*******************************************************************/
>>> > typedef CPLErr (*GDALRasterProcessFn)(double *padfInArray, double
>>> > *padfOutArray,
>>> >                 int nWindowXSize, int nWindowYSize, void *pData, double
>>> > *pdfNoDataValue);
>>> > /**
>>> > * \brief Definition of a raster processing function.
>>> > *
>>> > * A GDALRasterProcessFn accepts an array of data as input, applies
>>> custom
>>> > logic and writes the output to padfOutArray.
>>> > * Such a function can be passed to GDALRunRasterProcess to apply custom
>>> > processing to a GDALDataset in chunks and create
>>> > * a new GDALDataset.
>>> > *
>>> > * @param padfInArray The input array of data.
>>> > *
>>> > * @param padfOutArray The output array of data. On first call (via
>>> > GDALRunRasterProcess) this will be an empty, initialised array,
>>> > *    which should be populated with the result of calculations on
>>> > padfInArray. In subsequent calls it will contain the result of the
>>> > *    previous window.
>>> > *
>>> > * @param nWindowXSize the actual x size (width) of the read window.
>>> > *
>>> > * @param nWindowYSize the actual y size (height) of the read window.
>>> The
>>> > length of padfInArray == padfOutArray == nWindowXSize * nWindowYSize
>>> > *
>>> > * @param pData Process-specific data. This data is passed straight
>>> through
>>> > to the GDALRasterProcessFn and may contain e.g user defined parameters.
>>> > *     The GDALRasterProcessFn definition would define the
>>> structure/type of
>>> > such data.
>>> > *
>>> > * @param pdfNoDataValue The no data value of the dataset
>>> > */
>>> >
>>> > CPLErr GDALRunRasterProcess(GDALRasterProcessFn processFn, GDALDataset
>>> > *poSrcDataset,
>>> >                         GDALDataset *poDstDataset, void *pData, int
>>> > *pnWindowXSize,
>>> >                         int *pnWindowYSize, int *pnPixelBuffer);
>>> > /**
>>> > * \brief Apply a raster processing function to each sub-window of a
>>> raster.
>>> > *
>>> > * The input raster dataset is read in chunks of nWindowXSize *
>>> nWindowYSize
>>> > and each chunk is passed to the processing
>>> > * function. The output array from the function is written to the
>>> > destination dataset.
>>> > * An optional 'pixel buffer' can be specified to allow overlaps between
>>> > successive windows. This is useful for
>>> > * some algorithms, e.g. blob extraction, watershed/stream flow
>>> analysis,
>>> > convolution etc.
>>> > * Process specific data can be passed (e.g. configuration parameters).
>>> This
>>> > data is simply passed straight through to the processing
>>> > * function on each call.
>>> > *
>>> > * @param processFn A GDALRasterProcessFn to apply to each sub window
>>> of the
>>> > raster.
>>> > *
>>> > * @param poSrcDataset The source raster dataset from which pixel
>>> values are
>>> > read
>>> > *
>>> > * @param poDstDataset The destination raster dataset to which pixel
>>> values
>>> > are written. Must support RasterIO in write mode.
>>> > *
>>> > * @param pData Process-specific data. This is passed straight through
>>> to
>>> > the GDALRasterProcessFn on each call.
>>> > *
>>> > * @param pnWindowXSize The desired width of each read window. If NULL
>>> it
>>> > defaults to the 'natural' block size of the raster
>>> > *
>>> > * @param pnWindowYSize The desired height of each read window. If NULL
>>> it
>>> > defaults to the 'natural' block size.
>>> > *
>>> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
>>> read
>>> > window is expanded by pnPixelBuffer pixels in all directions such that
>>> > *    each window overlaps by pnPixelBuffer pixels. Ignored if NULL or 0
>>> > *
>>> > * @return a CPLErr enum indicating whether the function succesfully
>>> ran.
>>> > */
>>> >
>>> >
>>> > CPLErr GDALRunRasterProcesses(GDALRasterProcessFn *paProcessFn, int
>>> > nProcesses, GDALDataset *poSrcDataset,
>>> >                         GDALDataset *poDstDataset, void **paData, int
>>> > *pnWindowXSize,
>>> >                         int *pnWindowYSize, int *pnPixelBuffer);
>>> >
>>> > /**
>>> > * \brief Apply multiple raster processing functions to each sub-window
>>> of a
>>> > raster
>>> > *
>>> > * For each window, the functions defined by the paProcessFn array are
>>> > called in turn, with the array output of the previous function forming
>>> the
>>> > input * to the next function. This allows processing 'toolchains' to be
>>> > built without having to create intermediate datasets, which can be less
>>> > efficient in time and space.
>>> > *
>>> > *
>>> > * @param paProcessFn An array of GDALRasterProcessFn to apply to each
>>> sub
>>> > window of the raster
>>> > *
>>> > * @param nProcesses The size of paProcessFn
>>> > *
>>> > * @param poSrcDataset The source raster dataset from which pixel
>>> values are
>>> > read
>>> > *
>>> > * @param poDstDataset The destination raster dataset to which pixel
>>> values
>>> > are written. Must support RasterIO in write mode.
>>> > *
>>> > * @param paData an array of process-specific data objects of size
>>> > nProcesses. Each data object will be passed to the corresponding
>>> > GDALRasterProcessFn
>>> > *
>>> > * @param pnWindowXSize The desired width of each read window. If NULL
>>> it
>>> > defaults to the 'natural' block size of the raster
>>> > *
>>> > * @param pnWindowYSize The desired height of each read window. If NULL
>>> it
>>> > defaults to the 'natural' block size.
>>> > *
>>> > * @param pnPixelBuffer A pixel buffer to apply to the read window. The
>>> read
>>> > window is expanded by pnPixelBuffer pixels in all directions such that
>>> > *    each window overlaps by pnPixelBuffer pixels. If NULL, it is
>>> ignored.
>>> > *
>>> > * @return a CPLErr enum indicating whether the function succesfully
>>> ran.
>>> > */
>>> > /*******************************************************************/
>>> >
>>> > So GDALRunRasterProcess would take care of I/O and looping through the
>>> > dataset in chunks, which can be configure by the user. Each chunk is
>>> > submitted to the processing function, which does 'stuff' and populates
>>> the
>>> > output array. GDALRunRasterProcess would write it to the output dataset
>>> > object.
>>> >
>>> > An example of a processing function could be something like this:
>>> >
>>> > /*******************************************************************/
>>> > typedef struct ReclassArgs {
>>> >     int nReclassArgs;
>>> >     double *padfMinBound;
>>> >     double *padfMaxBound;
>>> >     double *padfBinValue;
>>> >
>>> > } ReclassArgs;
>>> >
>>> >
>>> > CPLErr Reclass(double *padfInArray, double *padfOutArray,
>>> >                int nWindowXSize, int nWindowYSize, void *pData,
>>> >                double *pdfNoDataValue)
>>> > {
>>> >     ReclassArgs *poRargs = static_cast<ReclassArgs *>(pData);
>>> >     double pixel;
>>> >     for (int i = 0; i < nWindowXSize * nWindowYSize - 1; ++i){
>>> >         pixel = padfInArray[i];
>>> >         for (int k = 0; k < poRargs->nReclassArgs; ++k){
>>> >                 if ((pixel > poRargs->padfMinBound[k]) && (pixel <=
>>> > poRargs->padfMaxBound[k])){
>>> >                     padfOutArray[i] = poRargs->padfBinValue[k];
>>> >                     break;
>>> >                 }
>>> >         }
>>> >     }
>>> >     return CE_None;
>>> > }
>>> > /*******************************************************************/
>>> >
>>> > To use it you would:
>>> >
>>> > /*******************************************************************/
>>> > // Open a source dataset
>>> > GDALDataset *poSrc = GDALOpen(...)
>>> >
>>> > // Create some output dataset with same dimensions etc..
>>> > GDALDataset *poDst = ....
>>> >
>>> > // Setup the reclass args
>>> > ReclassArgs *poRargs = ...
>>> >
>>> > // Call the process
>>> > CPLErr retval = GDALRunRasterProcess(Reclass, poSrc, poDst, (void
>>> > *)poRargs, NULL, NULL, NULL);
>>> > /*******************************************************************/
>>> >
>>> > GDAL could feature its own library of common functions...reclass,
>>> truncate,
>>> > blob extraction etc etc and a user of GDAL could write their own and
>>> have
>>> > GDAL process it.
>>> >
>>> > It would be useful to expose enough to python via SWIG so that a
>>> > GDALRasterProcessFn could be defined in python - this would then allow
>>> > rapid development in python, but push the expensive work of looping
>>> over
>>> > dataset chunks to C++.
>>> > I dont know enough about SWIG yet to see whether this would be
>>> feasible.
>>> >
>>> > However, even in C++, it allows the user to only think about their
>>> > algorithm and leave the boilerplate to GDAL.
>>> >
>>> > I imagine all this being implemented in a 'sub library', something like
>>> > gdpl.h (geospatial/gdal dataset processing library), but sitting in the
>>> > GDAL source tree (then I can happily expose all the useful GDAL
>>> goodness
>>> > without being worried about users having to include gdal headers etc,
>>> and
>>> > avoid any work in having to abstract it away)
>>> >
>>> > This is a first stab at defining something like this and is probably
>>> not
>>> > yet comprehensive enough.
>>> >
>>> > Any thoughts?
>>> >
>>> >
>>> >
>>> >
>>> > --
>>> > View this message in context:
>>> >
>>> http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp52759
>>> > 48.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
>>> > _______________________________________________
>>> > gdal-dev mailing list
>>> > gdal-dev at lists.osgeo.org
>>> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>> --
>>> Spatialys - Geospatial professional services
>>> http://www.spatialys.com
>>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
>
> ----------------------------------------------------------------------------------------------------------------
> Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
> (PRDU),
>                       University of York
>
> Snail mail: c/o Research Centre for the Social Sciences (RCSS),
>         University of York,
>         Heslington, York YO10 5DD
>
> This message has the status of a private and personal communication
>
> ----------------------------------------------------------------------------------------------------------------
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160713/dce9faf7/attachment-0001.html>

From jamessramm at gmail.com  Tue Jul 12 23:59:07 2016
From: jamessramm at gmail.com (jramm)
Date: Tue, 12 Jul 2016 23:59:07 -0700 (PDT)
Subject: [gdal-dev] GDAL raster processing library?
In-Reply-To: <201607121657.48141.even.rouault@spatialys.com>
References: <1468327227051-5275948.post@n6.nabble.com>
 <201607121555.41244.even.rouault@spatialys.com>
 <CAEW=KS5V1+HKa61MsXdEorPbUBOCi17zPjkENodz3tuXdT9JBQ@mail.gmail.com>
 <201607121657.48141.even.rouault@spatialys.com>
Message-ID: <1468393147061-5276078.post@n6.nabble.com>

I can see where some similarities with other new and existing GDAL work could
be a blocker on this, but I also think this adds a a degree more flexibility
allowing potentially any kind of complex processing to be carried out
without worrying/bothering about boilerplate. 

It would be good to find some kind of middle ground where this flexibility
can be added in without duplicating other efforts?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/GDAL-raster-processing-library-tp5275948p5276078.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jul 13 01:48:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jul 2016 10:48:12 +0200
Subject: [gdal-dev] Motions: Promote 1.11.5 RC 1,
	2.0.3 RC2 and and 2.1.1 RC2 for release
In-Reply-To: <201607081202.10600.even.rouault@spatialys.com>
References: <201607061502.48692.even.rouault@spatialys.com>
 <201607071232.45423.even.rouault@spatialys.com>
 <201607081202.10600.even.rouault@spatialys.com>
Message-ID: <201607131048.12867.even.rouault@spatialys.com>

Le vendredi 08 juillet 2016 12:02:10, Even Rouault a écrit :
> Hi,
> 
> Motions under vote:
> Motion 1: GDAL/OGR 1.11.5 RC1 is promoted to be the official 1.11.5 final
> release.
> 
> Motion 2: GDAL/OGR 2.0.3 RC2 is promoted to be the official 2.0.3 final
> release.
> 
> To replace the retracted motion 3:
> Motion 3bis: GDAL/OGR 2.1.1 RC2 is promoted to be the official 2.1.1 final
> release.
> 
> --

Hi,

All those motions are passed  :

Motion 1: +1 from PSC members EvenR, KurtS, JukkaR, HowardB and TamasS. +0 
from DanielM. And +1 from community member JeffM. 

Motion 2: +1 from PSC members EvenR, JukkaR, HowardB and TamasS. +0 from 
KurtS, DanielM. And +1 from community member JeffM. 

Motion 3bis: +1 from PSC members EvenR, KurtS, JukkaR, HowardB and TamasS. +0 
from DanielM. And +1 from community member JeffM. 

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul 13 02:13:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jul 2016 11:13:17 +0200
Subject: [gdal-dev] GDAL/OGR 1.11.5, 2.0.3 and 2.1.1 released
Message-ID: <201607131113.18543.even.rouault@spatialys.com>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to
announce the release of the GDAL/OGR 1.11.5, 2.0.3 and 2.1.1 bug fix versions. 
They contain respectively 24, 70 and 58 bug fixes since 1.11.4, 2.0.2 and 
2.1.0.

The sources for 1.11.5 are available at:

  http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5.tar.xz
  http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5.tar.gz
  http://download.osgeo.org/gdal/1.11.5/gdal1115.zip

The sources for 2.0.3 are available at:

  http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3.tar.xz
  http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3.tar.gz
  http://download.osgeo.org/gdal/2.0.3/gdal203.zip

The sources for 2.1.1 are available at:

  http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1.tar.xz
  http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1.tar.gz
  http://download.osgeo.org/gdal/2.1.1/gdal211.zip

Details on the fixes in those releases are available at:
  http://trac.osgeo.org/gdal/wiki/Release/1.11.5-News
  http://trac.osgeo.org/gdal/wiki/Release/2.0.3-News
  http://trac.osgeo.org/gdal/wiki/Release/2.1.1-News

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 13 06:40:49 2016
From: jamessramm at gmail.com (jramm)
Date: Wed, 13 Jul 2016 06:40:49 -0700 (PDT)
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
Message-ID: <1468417249456-5276136.post@n6.nabble.com>

I have a strange error when reprojecting a dataset to NWT_GRD format. 

e.g.

gdalwarp -of NWT_GRD -ot Float32 -t_srs EPSG:4326 test.tif test.grd

very quickly returns


Stepping through, I've traced this to a call to `GetLockedBlockRef` in
IRasterIO (rasterio.cpp) which is called when GDALWarp attempts to write the
first warped 'block' to the GRD dataset. 

Somehow, a flag - `bJustInitialize` gets set to false, causing
GetLockedBlockRef to attemp a read operation before writing the block. As no
data has yet been written to the dataset, this read operation fails.
(Specifically, line 316 of grddataset.cpp in frmts/northwood)

Im struggling to find the cause of this. I am wondering whether I have
missed some implementation detail in the Create method of the NWT_GRD
driver?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jamessramm at gmail.com  Wed Jul 13 06:41:36 2016
From: jamessramm at gmail.com (jramm)
Date: Wed, 13 Jul 2016 06:41:36 -0700 (PDT)
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <1468417249456-5276136.post@n6.nabble.com>
References: <1468417249456-5276136.post@n6.nabble.com>
Message-ID: <1468417296568-5276137.post@n6.nabble.com>

jramm wrote
> gdalwarp -of NWT_GRD -ot Float32 -t_srs EPSG:4326 test.tif test.grd
> 
> very quickly returns

Sorry this meant to read:

very quickly returns:

0ERROR 1: /home/jamesramm/test.grd, band 1: IReadBlock failed at X offset 0,
Y offset 0
ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136p5276137.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jul 13 07:21:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Jul 2016 16:21:17 +0200
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <1468417296568-5276137.post@n6.nabble.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
Message-ID: <201607131621.17377.even.rouault@spatialys.com>

Le mercredi 13 juillet 2016 15:41:36, jramm a écrit :
> jramm wrote
> 
> > gdalwarp -of NWT_GRD -ot Float32 -t_srs EPSG:4326 test.tif test.grd
> > 
> > very quickly returns
> 
> Sorry this meant to read:
> 
> very quickly returns:
> 
> 0ERROR 1: /home/jamesramm/test.grd, band 1: IReadBlock failed at X offset
> 0, Y offset 0
> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0

I don't manage to reproduce. Might perhaps depend on the dimensions of the 
input dataset and/or cache size used

That said, it is not inconsistant that some code tries to read blocks on the 
newly created dataset. Probably that the Create() method should use 
VSIFTruncateL() to set the file to the full size if filling with zeroes is OK 
for the format. Otherwise you may need to pad with more appropriate values. 
That way potential IReadBlock() won't error out.

> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136
> p5276137.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 13 07:26:25 2016
From: jamessramm at gmail.com (James Ramm)
Date: Wed, 13 Jul 2016 15:26:25 +0100
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <201607131621.17377.even.rouault@spatialys.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
 <201607131621.17377.even.rouault@spatialys.com>
Message-ID: <CAEW=KS4HHgs8HKB7v5_44ULR=UR=x4Ds7pFxe6UnO7dJxfL1HA@mail.gmail.com>

Yes I am finding it can be dependent on the input dataset dimensions - Im
only reproducing with a large raster. It is perhaps a small problem anyway
since apparently MapInfo will not handle files > 2GB anyway.
I will try using VSIFTruncateL to initialize.

On 13 July 2016 at 15:21, Even Rouault <even.rouault at spatialys.com> wrote:

> Le mercredi 13 juillet 2016 15:41:36, jramm a écrit :
> > jramm wrote
> >
> > > gdalwarp -of NWT_GRD -ot Float32 -t_srs EPSG:4326 test.tif test.grd
> > >
> > > very quickly returns
> >
> > Sorry this meant to read:
> >
> > very quickly returns:
> >
> > 0ERROR 1: /home/jamesramm/test.grd, band 1: IReadBlock failed at X offset
> > 0, Y offset 0
> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 0
>
> I don't manage to reproduce. Might perhaps depend on the dimensions of the
> input dataset and/or cache size used
>
> That said, it is not inconsistant that some code tries to read blocks on
> the
> newly created dataset. Probably that the Create() method should use
> VSIFTruncateL() to set the file to the full size if filling with zeroes is
> OK
> for the format. Otherwise you may need to pad with more appropriate values.
> That way potential IReadBlock() won't error out.
>
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136
> > p5276137.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160713/4af3bc51/attachment.html>

From hrz at geodata.soton.ac.uk  Thu Jul 14 02:20:32 2016
From: hrz at geodata.soton.ac.uk (Homme Zwaagstra)
Date: Thu, 14 Jul 2016 10:20:32 +0100
Subject: [gdal-dev] GDAL/OGR 1.11.5, 2.0.3 and 2.1.1 released
In-Reply-To: <201607131113.18543.even.rouault@spatialys.com>
References: <201607131113.18543.even.rouault@spatialys.com>
Message-ID: <57875960.9090102@geodata.soton.ac.uk>

Hi,

For Docker users the releases are packaged up as Docker images at 
<https://hub.docker.com/r/geodata/gdal/>.  These are based on the GDAL 
TravisCI test environment and as such are compiled with a broad range of 
drivers - the following commands list the available raster formats for 
the three releases:

     docker run geodata/gdal:2.1.1 gdalinfo --formats
     docker run geodata/gdal:2.0.3 gdalinfo --formats
     docker run geodata/gdal:1.11.5 gdalinfo --formats

Thanks,

Homme.

On 13/07/16 10:13, Even Rouault wrote:
> Hi,
>
> On behalf of the GDAL/OGR development team, I am pleased to
> announce the release of the GDAL/OGR 1.11.5, 2.0.3 and 2.1.1 bug fix versions.
> They contain respectively 24, 70 and 58 bug fixes since 1.11.4, 2.0.2 and
> 2.1.0.
>
> The sources for 1.11.5 are available at:
>
>    http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5.tar.xz
>    http://download.osgeo.org/gdal/1.11.5/gdal-1.11.5.tar.gz
>    http://download.osgeo.org/gdal/1.11.5/gdal1115.zip
>
> The sources for 2.0.3 are available at:
>
>    http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3.tar.xz
>    http://download.osgeo.org/gdal/2.0.3/gdal-2.0.3.tar.gz
>    http://download.osgeo.org/gdal/2.0.3/gdal203.zip
>
> The sources for 2.1.1 are available at:
>
>    http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1.tar.xz
>    http://download.osgeo.org/gdal/2.1.1/gdal-2.1.1.tar.gz
>    http://download.osgeo.org/gdal/2.1.1/gdal211.zip
>
> Details on the fixes in those releases are available at:
>    http://trac.osgeo.org/gdal/wiki/Release/1.11.5-News
>    http://trac.osgeo.org/gdal/wiki/Release/2.0.3-News
>    http://trac.osgeo.org/gdal/wiki/Release/2.1.1-News
>
> Best regards,
>
> Even
>


From hannes.diedrich at gfz-potsdam.de  Thu Jul 14 03:05:15 2016
From: hannes.diedrich at gfz-potsdam.de (hannes.diedrich at gfz-potsdam.de)
Date: Thu, 14 Jul 2016 03:05:15 -0700 (PDT)
Subject: [gdal-dev] Get Metadata from VRT file, store 4D Dataset into VRT
Message-ID: <1468490715155-5276331.post@n6.nabble.com>

Hello,

I just started to use virtual raster bands with gdal (python) and have two
questions (see below).
My aim: I like to manage Sentinel 2 data with VRB preferably in an 4D
environment (x,y,time, spectral band)

This is what I have done so far:
I managed to build a vrt file by adding multiple 
jpg2000 files (Sentinel 2 L1C data) to a VRT file with:

/gdalbuildvrt -separate -input_file_list list.list vrt.vrt/

The vrt file looks like:
-------------------------------------------------------------------------------------
<VRTDataset rasterXSize="10980" rasterYSize="10980">
  <SRS>PROJCS["WGS 84 / UTM zone 32N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32632"]]</SRS>
  <GeoTransform>  6.0000000000000000e+05,  1.0000000000000000e+01, 
0.0000000000000000e+00,  6.0000000000000000e+06,  0.0000000000000000e+00,
-1.0000000000000000e+01</GeoTransform>
  <VRTRasterBand dataType="UInt16" band="1">
    <SimpleSource>
      <SourceFilename
relativeToVRT="0">/misc/fluo10/Sentinel2_L1C/32U/PE/2016/S2A_OPER_MSI_L1C_TL_SGS__20160113T143043_A002922_T32UPE_N02.01/B02.jp2</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="10980" RasterYSize="10980"
DataType="UInt16" BlockXSize="2048" BlockYSize="128" />
      <SrcRect xOff="0" yOff="0" xSize="10980" ySize="10980" />
      <DstRect xOff="0" yOff="0" xSize="10980" ySize="10980" />
    </SimpleSource>
  </VRTRasterBand>
  <VRTRasterBand dataType="UInt16" band="2">
    <SimpleSource>
      <SourceFilename
relativeToVRT="0">/misc/fluo10/Sentinel2_L1C/32U/PE/2016/S2A_OPER_MSI_L1C_TL_SGS__20160614T154940_A005110_T32UPE_N02.02/B02.jp2</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="10980" RasterYSize="10980"
DataType="UInt16" BlockXSize="2048" BlockYSize="128" />
      <SrcRect xOff="0" yOff="0" xSize="10980" ySize="10980" />
      <DstRect xOff="0" yOff="0" xSize="10980" ySize="10980" />
    </SimpleSource>
  </VRTRasterBand>
-----------------------------------------------------------------

In python i've done the following:

/import gdal
import gdalconst as gc
dataset = gdal.Open("vrt.vrt", gc.GA_ReadOnly )
array=dataset.GetVirtualMemArray()
/

array is a 3D-array that fetches the data of all files for my wanted subset
e.g. subset =array[*,100:110,2:5]
So far so good.

1st Question: How can I get the metadata from each band e.g. the
"SourceFilename"?
I tried the following:
/band1=ds.GetRasterBand(1)
metadata_band1=band1.GetMetadata()/
Unfortunately, there is not output, although /gdalinfo/ (outside python)
provides all the metadata of the vrt file.

2nd Question:
Is there a way that I can add another dimension to the vrt file, for example
by adding multiple products (jp2-files) to each virtual raster band, just
like gdalbuildvrt does if the "-separate" keyword is not set?

Thanks in advance!
Hannes



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Get-Metadata-from-VRT-file-store-4D-Dataset-into-VRT-tp5276331.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jamessramm at gmail.com  Thu Jul 14 04:07:42 2016
From: jamessramm at gmail.com (jramm)
Date: Thu, 14 Jul 2016 04:07:42 -0700 (PDT)
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <1468417296568-5276137.post@n6.nabble.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
Message-ID: <1468494462462-5276347.post@n6.nabble.com>

I added the following to the end of the Create method in
frmts/northwood/grddataset.cpp:


    vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
    if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
		CPLError(CE_Failure, CPLE_FileIO,
				"Failed to allocate space for GRD file");
		delete poDS;
		return NULL;
    }
    poDS->FlushCache(); // Write the header to disk.

Unfortunately still receiving the error. I wonder if it would be better if I
explicitly write the zeros with VSIFWriteL?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136p5276347.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jul 14 05:26:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jul 2016 14:26:50 +0200
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <1468494462462-5276347.post@n6.nabble.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
 <1468494462462-5276347.post@n6.nabble.com>
Message-ID: <201607141426.51927.even.rouault@spatialys.com>

Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> I added the following to the end of the Create method in
> frmts/northwood/grddataset.cpp:
> 
> 
>     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;

--> beware of the potential int32 overflow in nXSize * nYSize

>     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> 		CPLError(CE_Failure, CPLE_FileIO,
> 				"Failed to allocate space for GRD file");
> 		delete poDS;
> 		return NULL;
>     }
>     poDS->FlushCache(); // Write the header to disk.
> 
> Unfortunately still receiving the error. I wonder if it would be better if
> I explicitly write the zeros with VSIFWriteL?

No, that's what VSIFTruncateL() is supposed to do, in a smarter way depending 
on filesystem capabilities.

> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136
> p5276347.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From William.Kelly.Magee at leidos.com  Thu Jul 14 05:28:40 2016
From: William.Kelly.Magee at leidos.com (William Kelly Magee)
Date: Thu, 14 Jul 2016 08:28:40 -0400
Subject: [gdal-dev] Error building 1.11.1 on MingW64 for 32-bit
In-Reply-To: <1468494462462-5276347.post@n6.nabble.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
 <1468494462462-5276347.post@n6.nabble.com>
Message-ID: <57878578.2090003@leidos.com>

Hello all,

Trying to build a 32-bit version of gdal v1.11.1 on Windows10 using 
Mingw64 gcc 4.9.1 and getting an unresolved error at link time;

    C:/gcc-4.9.1/bin/../lib/gcc/i686-w64-mingw32/4.9.1/../../../../i686-w64-mingw32/lib/../lib/libiconv.a(localcharset.o):localcharset.c:(.text+0x7):
    undefined reference to `_imp__GetACP at 0'^


Prior to this I've been using MingW (not MingW64) and have not had any 
issues.  I need to use Mingw64 4.9.1 in order to support building Qt as 
part of the same build.

Have tried many of the suggestions posted on various sites but nothing 
seems to work.

Reaching out for any other suggestions?

- Kelly


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160714/1837fddf/attachment.html>

From even.rouault at spatialys.com  Thu Jul 14 06:47:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jul 2016 15:47:37 +0200
Subject: [gdal-dev] Get Metadata from VRT file, store 4D Dataset into VRT
In-Reply-To: <1468490715155-5276331.post@n6.nabble.com>
References: <1468490715155-5276331.post@n6.nabble.com>
Message-ID: <201607141547.38066.even.rouault@spatialys.com>

Hannes,

> 
> 1st Question: How can I get the metadata from each band e.g. the
> "SourceFilename"?
> I tried the following:
> /band1=ds.GetRasterBand(1)
> metadata_band1=band1.GetMetadata()/
> Unfortunately, there is not output, although /gdalinfo/ (outside python)
> provides all the metadata of the vrt file.

You can get the file list with ds.GetFileList()
And if you want to get the file below a given pixel, you can do, here for pixel 
(0,0):

band1.GetMetadataItem('Pixel_0_0', 'LocationInfo') 

That will return something like :
    <LocationInfo>
      <File>byte.tif</File>
    </LocationInfo>

> 
> 2nd Question:
> Is there a way that I can add another dimension to the vrt file, for
> example by adding multiple products (jp2-files) to each virtual raster
> band, just like gdalbuildvrt does if the "-separate" keyword is not set?

Not sure to really understand what you mean, but the GDAL raster model is 
limited to several bands of 2D raster, so "3D". You can emulate 4D by 
flattening the extra dimensions.

But here it seems you want to do a spatial mosaic ? You could potentially do 
gdalbuildvrt in default mode to mosaic the same bands of several products, and 
then gdalbuildvrt -separate those mosaiced VRTs to make a multi band raster.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bdeschamps.home at gmail.com  Thu Jul 14 11:52:35 2016
From: bdeschamps.home at gmail.com (Benjamin Deschamps)
Date: Thu, 14 Jul 2016 14:52:35 -0400
Subject: [gdal-dev] IMD files being created by gdalwarp and driver.Create
Message-ID: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>

Hi,

I am seeing .IMD files being created first by driver.Create() with the
GTIFF driver, and then also by gdalwarp (doing a simple reprojection), with
both input and output in GTIFF format.

I've never seen these files before... Can I prevent them from being written?

I'm using GDAL 2.0.2 with the Python bindings, and GDAL 2.1.0 for the
utilities.

Thanks,

Benjamin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160714/d22dc940/attachment.html>

From frallain at gmail.com  Thu Jul 14 12:13:24 2016
From: frallain at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_ALLAIN?=)
Date: Thu, 14 Jul 2016 20:13:24 +0100
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
 GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
Message-ID: <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>

Hello,

I am trying to convert a gdal_rasterize command to a gdal.Rasterize call
with the Python bindings
(Python 2.7.9 64bits, GDAL 2.1.0 compiled with libproj0 libgeos-dev on
Debian 8.3).

The  gdal_rasterize command works perfectly  :
gdal_rasterize -i -b 4 -burn 0 my.geojson my.tif

With the information available on the web :
http://erouault.blogspot.ie/2015/10/gdal-and-ogr-utilities-as-library.html
https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library
http://gis.stackexchange.com/questions/77139/why-do-shapefiles-and-geojson-behave-differently-in-gdal-python

I've tried this kind of script :

import os
import sys
from osgeo import gdal, ogr, osr

geojson_filename = "my.geojson"
driver = ogr.GetDriverByName("GeoJSON")
vector_ds = driver.Open(geojson_filename, gdal.GA_ReadOnly)

geotiff_filename = "my.tif"
ds = gdal.Open(geotiff_filename, gdal.GA_Update)

ret = gdal.Rasterize(ds, vector_ds,
            bands = [4],
            inverse = True,
            burnValues = [0])
if ret != 1:
    print 'fail'
else:
    print 'success'

but I kept getting this error :
Traceback (most recent call last):
  File "test.py", line 62, in <module>
    ret = gdal.Rasterize(ds, vector_ds, bands = [4], inverse = True,
burnValues = [0])
  File "/usr/local/lib/python2.7/dist-packages/osgeo/gdal.py", line 1046,
in Rasterize
    return wrapper_GDALRasterizeDestName(destNameOrDestDS, srcDS, opts,
callback, callback_data)
TypeError: in method 'wrapper_GDALRasterizeDestName', argument 2 of type
'GDALDatasetShadow *'

Any ideas of what could be wrong with this script ?

Thanks in advance

Cheers

François ALLAIN
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160714/7924ecb0/attachment.html>

From even.rouault at spatialys.com  Thu Jul 14 13:28:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jul 2016 22:28:55 +0200
Subject: [gdal-dev] IMD files being created by gdalwarp and driver.Create
In-Reply-To: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>
References: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>
Message-ID: <201607142228.55810.even.rouault@spatialys.com>

Benjamin,

> 
> I am seeing .IMD files being created first by driver.Create() with the
> GTIFF driver, and then also by gdalwarp (doing a simple reprojection), with
> both input and output in GTIFF format.
> 
> I've never seen these files before... Can I prevent them from being
> written?

If they are created, it means that the IMD metadata domain is set on your 
GeoTIFF files. Presumably because it is also set in the source images you use. 
There's no option to suppress writing the IMD files when the IMD metadata 
domain is set on a GeoTIFF file. So either make sure it is not set, or suppress 
the .imd as a postprocessing.

But just doing a plain driver.Create() without setting metadata should not 
result in a .imd file being written.

> 
> I'm using GDAL 2.0.2 with the Python bindings, and GDAL 2.1.0 for the
> utilities.

Odd setup. I presume you know what you are doing ;-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul 14 13:35:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Jul 2016 22:35:06 +0200
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
	GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>
Message-ID: <201607142235.06765.even.rouault@spatialys.com>

Le jeudi 14 juillet 2016 21:13:24, François ALLAIN a écrit :
> Hello,
> 
> I am trying to convert a gdal_rasterize command to a gdal.Rasterize call
> with the Python bindings
> (Python 2.7.9 64bits, GDAL 2.1.0 compiled with libproj0 libgeos-dev on
> Debian 8.3).
> 
> The  gdal_rasterize command works perfectly  :
> gdal_rasterize -i -b 4 -burn 0 my.geojson my.tif
> 
> With the information available on the web :
> http://erouault.blogspot.ie/2015/10/gdal-and-ogr-utilities-as-library.html
> https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library
> http://gis.stackexchange.com/questions/77139/why-do-shapefiles-and-geojson-
> behave-differently-in-gdal-python
> 
> I've tried this kind of script :
> 
> import os
> import sys
> from osgeo import gdal, ogr, osr
> 
> geojson_filename = "my.geojson"
> driver = ogr.GetDriverByName("GeoJSON")
> vector_ds = driver.Open(geojson_filename, gdal.GA_ReadOnly)
> 
> geotiff_filename = "my.tif"
> ds = gdal.Open(geotiff_filename, gdal.GA_Update)
> 
> ret = gdal.Rasterize(ds, vector_ds,
>             bands = [4],
>             inverse = True,
>             burnValues = [0])
> if ret != 1:
>     print 'fail'
> else:
>     print 'success'
> 
> but I kept getting this error :
> Traceback (most recent call last):
>   File "test.py", line 62, in <module>
>     ret = gdal.Rasterize(ds, vector_ds, bands = [4], inverse = True,
> burnValues = [0])
>   File "/usr/local/lib/python2.7/dist-packages/osgeo/gdal.py", line 1046,
> in Rasterize
>     return wrapper_GDALRasterizeDestName(destNameOrDestDS, srcDS, opts,
> callback, callback_data)
> TypeError: in method 'wrapper_GDALRasterizeDestName', argument 2 of type
> 'GDALDatasetShadow *'

François,

I presume the issue is with how the vector_ds has been opened. 
gdal.Rasterize() expects all datasets, raster or vector, to be of type 
GDALDatasetShadow. When you open with ogr.Open(), this is not the case.
Try:

vector_ds  = gdal.OpenEx( geojson_filename, gdal.OF_VECTOR )

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From frallain at gmail.com  Thu Jul 14 14:43:22 2016
From: frallain at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_ALLAIN?=)
Date: Thu, 14 Jul 2016 22:43:22 +0100
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
 GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <201607142235.06765.even.rouault@spatialys.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>
 <201607142235.06765.even.rouault@spatialys.com>
Message-ID: <CAPRcDAADUb-DF4fdmM12MC8+E=L=a8Q6u378jMdAwTxFy6852Q@mail.gmail.com>

It did resolve this error, but now I've got this :

ERROR 10: Pointer 'hDS' is NULL in 'GDALGetProjectionRef'.

Warning 1: The input vector layer has a SRS, but the output raster dataset
SRS is unknown.
Ensure output raster dataset has the same SRS, otherwise results might be
incorrect.
ERROR 10: Pointer 'hDataset' is NULL in 'GDALGetRasterXSize'.

ERROR 10: Pointer 'hDataset' is NULL in 'GDALGetRasterYSize'.

ERROR 10: Pointer 'hDS' is NULL in 'GDALGetGeoTransform'.

Segmentation fault

I thought that the geotiff had a SRS :
$ gdalinfo my.tif
Driver: GTiff/GeoTIFF
Files: a.tif
Size is 256, 256
Coordinate System is:
GEOGCS["WGS 84",
    DATUM["WGS_1984",
        SPHEROID["WGS 84",6378137,298.257223563,
            AUTHORITY["EPSG","7030"]],
        AUTHORITY["EPSG","6326"]],
    PRIMEM["Greenwich",0],
    UNIT["degree",0.0174532925199433],
    AUTHORITY["EPSG","4326"]]
Origin = (-76.460380554200000,45.450708220599999)
Pixel Size = (0.000000167637891,-0.000000117601953)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  ( -76.4603806,  45.4507082) ( 76d27'37.37"W, 45d27' 2.55"N)
Lower Left  ( -76.4603806,  45.4506781) ( 76d27'37.37"W, 45d27' 2.44"N)
Upper Right ( -76.4603376,  45.4507082) ( 76d27'37.22"W, 45d27' 2.55"N)
Lower Right ( -76.4603376,  45.4506781) ( 76d27'37.22"W, 45d27' 2.44"N)
Center      ( -76.4603591,  45.4506932) ( 76d27'37.29"W, 45d27' 2.50"N)
Band 1 Block=256x8 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=256x8 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=256x8 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=256x8 Type=Byte, ColorInterp=Alpha


$ cat my.geojson
{   "type": "FeatureCollection",
    "features": [{
        "type": "Feature",
            "properties": {
                "prop0": "value0"
            },
        "id": 0,
        "geometry": {
            "type": "Polygon",
            "coordinates": [
                  [
                    [
                        -76.4603750,
                        45.4506926
                    ],
                    [
                        -76.4603632,
                        45.4506998
                    ],
                    [
                        -76.4603522,
                        45.4506914
                    ],
                    [
                        -76.4603639,
                        45.4506845
                    ],
                    [
                        -76.4603750,
                        45.4506926
                    ]
                  ]
            ]
        }
    }]

Cheers
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160714/abf780ff/attachment.html>

From sam at surfline.com  Thu Jul 14 17:13:08 2016
From: sam at surfline.com (Sam Wilson)
Date: Fri, 15 Jul 2016 00:13:08 +0000
Subject: [gdal-dev] gdal_calc.py floating point arithmetic
Message-ID: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>

Hi,

I’m attempting to linearly interpolate two geotiff files using gdal_calc.py.  The geotiff files are 3 hours apart, so for example hour 0 and hour 3.  I’d like to end up with hourly data, so I need hours 1 and 2.

Below are the commands I’m using:

gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour1.tif —calc=“(A+B)*0.333”
gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour2.tif —calc=“(A+B)*0.667”

However, hour1.tif and hour2.tif appear to be the exact same.

Does gdal_calc.py not allow using floating point values in the calculation? Or, am I doing something else wrong?

Many thanks.

Sam

From andrew at aitchison.me.uk  Thu Jul 14 23:12:42 2016
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 15 Jul 2016 07:12:42 +0100 (BST)
Subject: [gdal-dev] gdal_calc.py floating point arithmetic
In-Reply-To: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>
References: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>
Message-ID: <alpine.LRH.2.20.1607150709580.29154@warden.aitchison.me.uk>

On Fri, 15 Jul 2016, Sam Wilson wrote:

> Hi,
>
> I’m attempting to linearly interpolate two geotiff files using gdal_calc.py.  The geotiff files are 3 hours apart, so for example hour 0 and hour 3.  I’d like to end up with hourly data, so I need hours 1 and 2.
>
> Below are the commands I’m using:
>
> However, hour1.tif and hour2.tif appear to be the exact same.
>
> Does gdal_calc.py not allow using floating point values in the calculation?

I don't know but imagine that there is a scaling either in the 
generation, the comparison or the diplay.

> Or, am I doing something else wrong?

Yes. You ned something like:
  gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour1.tif —calc=“(A*0.667)+(B*0.333)”
  gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour2.tif —calc=“(A*0.333)+(B*0.667)”



From afalciano at yahoo.it  Fri Jul 15 00:48:12 2016
From: afalciano at yahoo.it (Antonio Falciano)
Date: Fri, 15 Jul 2016 09:48:12 +0200
Subject: [gdal-dev] gdal_calc.py floating point arithmetic
In-Reply-To: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>
References: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>
Message-ID: <5ee15168-517d-f52d-cc31-408d6bc4d08d@yahoo.it>

Il 15/07/2016 02:13, Sam Wilson ha scritto:
> Hi,
>
> I’m attempting to linearly interpolate two geotiff files using gdal_calc.py.  The geotiff files are 3 hours apart, so for example hour 0 and hour 3.  I’d like to end up with hourly data, so I need hours 1 and 2.
>
> Below are the commands I’m using:
>
> gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour1.tif —calc=“(A+B)*0.333”
> gdal_calc.py -A hour0.tif -B hour3.tif —outfile=hour2.tif —calc=“(A+B)*0.667”
>
> However, hour1.tif and hour2.tif appear to be the exact same.
>
> Does gdal_calc.py not allow using floating point values in the calculation? Or, am I doing something else wrong?

Hi Sam,
if your input data are both of type Int*, you should force the output 
datatype:
gdal_calc.py -A hour0.tif -B hour3.tif --outfile=hour1.tif 
--calc="(A+B)*0.333" --type Float32
gdal_calc.py -A hour0.tif -B hour3.tif --outfile=hour2.tif 
--calc="(A+B)*0.667" --type Float32
Hope this helps.

Cheers,
Antonio

-- 
Antonio Falciano
http://www.linkedin.com/in/antoniofalciano

From frallain at gmail.com  Fri Jul 15 01:45:39 2016
From: frallain at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_ALLAIN?=)
Date: Fri, 15 Jul 2016 09:45:39 +0100
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
 GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <201607142235.06765.even.rouault@spatialys.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>
 <201607142235.06765.even.rouault@spatialys.com>
Message-ID: <CAPRcDAAASyqi4ssrvOC4SZ9rK-xM+AQx6umuXr6Y-9L3UkWhyw@mail.gmail.com>

My bad... I finally got it working with your code :

import os
import sys
from osgeo import gdal, ogr, osr

geojson_filename = "my.geojson"
driver = ogr.GetDriverByName("GeoJSON")
vector_ds  = gdal.OpenEx( geojson_filename, gdal.OF_VECTOR )

geotiff_filename = "my.tif"
ds = gdal.Open(geotiff_filename, gdal.GA_Update)

ret = gdal.Rasterize(ds,
                    vector_ds,
                    bands = [4],
                    inverse = True,
                    burnValues = [0])

if ret != 1:
    print 'fail'
else:
    print 'success'

Cheers and thanks again

François
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160715/9a563f38/attachment.html>

From bdeschamps.home at gmail.com  Fri Jul 15 06:31:09 2016
From: bdeschamps.home at gmail.com (Benjamin Deschamps)
Date: Fri, 15 Jul 2016 09:31:09 -0400
Subject: [gdal-dev] IMD files being created by gdalwarp and driver.Create
In-Reply-To: <201607142228.55810.even.rouault@spatialys.com>
References: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>
 <201607142228.55810.even.rouault@spatialys.com>
Message-ID: <CAMGmV3sdKZaqd5AB_v-4X4N2sGojLXryMP9ZZasy=Upzni2GTQ@mail.gmail.com>

Hi Even,

The original file is a Landsat-8 image, I can confirm that it has tags set
in the imd metadata domain with gdalinfo -mdd imd
LC80040242014245LGN00_B3.TIF but I'm creating a brand new raster, not
making a copy, so I'm not sure why the metadata is being transferred. The
following basic example still has the .IMD file created.

import numpy
from osgeo import gdal

band =
"C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN00_B3.TIF"
outpath =
"C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN00_B3_test.TIF"

ds = gdal.Open(band)
proj = ds.GetProjection()
geot = ds.GetGeoTransform()
dn = ds.ReadAsArray().astype(numpy.float32)
ds = None

driver = gdal.GetDriverByName("GTiff")
ds_out = driver.Create(outpath, dn.shape[1], dn.shape[0], 1,
gdal.GDT_Float32)
ds_out.GetRasterBand(1).WriteArray(dn)
ds_out.SetProjection(proj)
ds_out.SetGeoTransform(geot)
ds_out.GetRasterBand(1).SetNoDataValue(0)
ds_out = None

However, if I write to a different directory, or more curiously to a name
with a different prefix, it does not create the file.

outpath =
"C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/newname.TIF"
outpath =
"C:/Users/deschampsb/Desktop/test/new/LC80040242014245LGN00_B3_test.TIF"

Is it looking up other files in the directory?

Thanks,

Benjamin



On Thu, Jul 14, 2016 at 4:28 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Benjamin,
>
> >
> > I am seeing .IMD files being created first by driver.Create() with the
> > GTIFF driver, and then also by gdalwarp (doing a simple reprojection),
> with
> > both input and output in GTIFF format.
> >
> > I've never seen these files before... Can I prevent them from being
> > written?
>
> If they are created, it means that the IMD metadata domain is set on your
> GeoTIFF files. Presumably because it is also set in the source images you
> use.
> There's no option to suppress writing the IMD files when the IMD metadata
> domain is set on a GeoTIFF file. So either make sure it is not set, or
> suppress
> the .imd as a postprocessing.
>
> But just doing a plain driver.Create() without setting metadata should not
> result in a .imd file being written.
>
> >
> > I'm using GDAL 2.0.2 with the Python bindings, and GDAL 2.1.0 for the
> > utilities.
>
> Odd setup. I presume you know what you are doing ;-)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160715/5faf2c03/attachment.html>

From SGONG at mdacorporation.com  Fri Jul 15 08:29:19 2016
From: SGONG at mdacorporation.com (Shawn Gong)
Date: Fri, 15 Jul 2016 15:29:19 +0000
Subject: [gdal-dev] SPOT-7 and Worldview 3
Message-ID: <7DCBC135929FF74E8A5488B1814AC6BC3BDA36B2@exbermd02.ds.mda.ca>

Hi all,



I have downloaded and built gdal 2.1.1

Ran some tests on SPOT-7 and Worldview 3



SPOT-7 tiled dimap: the DIM_SPOT7_*.xml file was loaded fine. But the georeferencing was wrong.  The xml seems to indicate ITRF2005 (epsg 4896) but it has no projection information in gdal.  The individual geotiffs didn't seem to agree with the xml either

Worldview 3: the TIL file was loaded fine. UTM georeferencing looks good.


Thanks,
Shawn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160715/89b4e5d6/attachment.html>

From even.rouault at spatialys.com  Fri Jul 15 09:02:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Jul 2016 18:02:55 +0200
Subject: [gdal-dev] SPOT-7 and Worldview 3
In-Reply-To: <7DCBC135929FF74E8A5488B1814AC6BC3BDA36B2@exbermd02.ds.mda.ca>
References: <7DCBC135929FF74E8A5488B1814AC6BC3BDA36B2@exbermd02.ds.mda.ca>
Message-ID: <201607151802.55702.even.rouault@spatialys.com>

Le vendredi 15 juillet 2016 17:29:19, Shawn Gong a écrit :
> Hi all,
> 
> 
> 
> I have downloaded and built gdal 2.1.1
> 
> Ran some tests on SPOT-7 and Worldview 3
> 
> 
> 
> SPOT-7 tiled dimap: the DIM_SPOT7_*.xml file was loaded fine. But the
> georeferencing was wrong.  The xml seems to indicate ITRF2005 (epsg 4896)
> but it has no projection information in gdal.  The individual geotiffs
> didn't seem to agree with the xml either

I've done improvements in the DIMAP driver (for v2 products) in trunk recently 
to support tiled datasets. You may want to check that.

> 
> Worldview 3: the TIL file was loaded fine. UTM georeferencing looks good.
> 
> 
> Thanks,
> Shawn

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Jul 15 09:07:01 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Jul 2016 18:07:01 +0200
Subject: [gdal-dev] IMD files being created by gdalwarp and driver.Create
In-Reply-To: <CAMGmV3sdKZaqd5AB_v-4X4N2sGojLXryMP9ZZasy=Upzni2GTQ@mail.gmail.com>
References: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>
 <201607142228.55810.even.rouault@spatialys.com>
 <CAMGmV3sdKZaqd5AB_v-4X4N2sGojLXryMP9ZZasy=Upzni2GTQ@mail.gmail.com>
Message-ID: <201607151807.01060.even.rouault@spatialys.com>

Le vendredi 15 juillet 2016 15:31:09, Benjamin Deschamps a écrit :
> Hi Even,
> 
> The original file is a Landsat-8 image, I can confirm that it has tags set
> in the imd metadata domain with gdalinfo -mdd imd
> LC80040242014245LGN00_B3.TIF but I'm creating a brand new raster, not
> making a copy, so I'm not sure why the metadata is being transferred. The
> following basic example still has the .IMD file created.
> 
> import numpy
> from osgeo import gdal
> 
> band =
> "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN
> 00_B3.TIF" outpath =
> "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN
> 00_B3_test.TIF"
> 
> ds = gdal.Open(band)
> proj = ds.GetProjection()
> geot = ds.GetGeoTransform()
> dn = ds.ReadAsArray().astype(numpy.float32)
> ds = None
> 
> driver = gdal.GetDriverByName("GTiff")
> ds_out = driver.Create(outpath, dn.shape[1], dn.shape[0], 1,
> gdal.GDT_Float32)
> ds_out.GetRasterBand(1).WriteArray(dn)
> ds_out.SetProjection(proj)
> ds_out.SetGeoTransform(geot)
> ds_out.GetRasterBand(1).SetNoDataValue(0)
> ds_out = None
> 
> However, if I write to a different directory, or more curiously to a name
> with a different prefix, it does not create the file.
> 
> outpath =
> "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/newname.TIF"
> outpath =
> "C:/Users/deschampsb/Desktop/test/new/LC80040242014245LGN00_B3_test.TIF"
> 
> Is it looking up other files in the directory?
> 

OK that makes sense now. There is indeed a general metadata reader that 
recognizes Landsat _MTL.txt files (among other potential metadata sources). It 
is triggered here whereas it is not desirable in Create() case. Could you file 
a ticket on https://trac.osgeo.org/gdal/newticket regarding this ? Thanks

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sam at surfline.com  Fri Jul 15 09:38:31 2016
From: sam at surfline.com (Sam Wilson)
Date: Fri, 15 Jul 2016 16:38:31 +0000
Subject: [gdal-dev] gdal_calc.py floating point arithmetic
In-Reply-To: <alpine.LRH.2.20.1607150709580.29154@warden.aitchison.me.uk>
References: <C18519B3-DE5F-4021-9A11-C71004539136@surfline.com>
 <alpine.LRH.2.20.1607150709580.29154@warden.aitchison.me.uk>
Message-ID: <D3AE5F7F.11E8EC%sam@surfline.com>

Thank you Andrew! That did it.

Cheers,
Sam



On 7/14/16, 11:12 PM, "Andrew C Aitchison" <andrew at aitchison.me.uk> wrote:

>On Fri, 15 Jul 2016, Sam Wilson wrote:
>
>> Hi,
>>
>> I¹m attempting to linearly interpolate two geotiff files using
>>gdal_calc.py.  The geotiff files are 3 hours apart, so for example hour
>>0 and hour 3.  I¹d like to end up with hourly data, so I need hours 1
>>and 2.
>>
>> Below are the commands I¹m using:
>>
>> However, hour1.tif and hour2.tif appear to be the exact same.
>>
>> Does gdal_calc.py not allow using floating point values in the
>>calculation?
>
>I don't know but imagine that there is a scaling either in the
>generation, the comparison or the diplay.
>
>> Or, am I doing something else wrong?
>
>Yes. You ned something like:
>  gdal_calc.py -A hour0.tif -B hour3.tif ‹outfile=hour1.tif
>‹calc=³(A*0.667)+(B*0.333)²
>  gdal_calc.py -A hour0.tif -B hour3.tif ‹outfile=hour2.tif
>‹calc=³(A*0.333)+(B*0.667)²
>
>


From bdeschamps.home at gmail.com  Fri Jul 15 09:41:59 2016
From: bdeschamps.home at gmail.com (Benjamin Deschamps)
Date: Fri, 15 Jul 2016 12:41:59 -0400
Subject: [gdal-dev] IMD files being created by gdalwarp and driver.Create
In-Reply-To: <201607151807.01060.even.rouault@spatialys.com>
References: <CAMGmV3sHWRjB0Wx-k2qt7yaVMhTmB07G3o=Q48zR59cqWFpxOQ@mail.gmail.com>
 <201607142228.55810.even.rouault@spatialys.com>
 <CAMGmV3sdKZaqd5AB_v-4X4N2sGojLXryMP9ZZasy=Upzni2GTQ@mail.gmail.com>
 <201607151807.01060.even.rouault@spatialys.com>
Message-ID: <CAMGmV3tKRU+NxxStEzrfHEGe70uApXU7MYKnwCK2uoOjbc7f0A@mail.gmail.com>

Created a ticket here:
https://trac.osgeo.org/gdal/ticket/6594#ticket

First ticket, so hopefully I followed protocol.

Thanks for your help.

On Fri, Jul 15, 2016 at 12:07 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le vendredi 15 juillet 2016 15:31:09, Benjamin Deschamps a écrit :
> > Hi Even,
> >
> > The original file is a Landsat-8 image, I can confirm that it has tags
> set
> > in the imd metadata domain with gdalinfo -mdd imd
> > LC80040242014245LGN00_B3.TIF but I'm creating a brand new raster, not
> > making a copy, so I'm not sure why the metadata is being transferred. The
> > following basic example still has the .IMD file created.
> >
> > import numpy
> > from osgeo import gdal
> >
> > band =
> >
> "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN
> > 00_B3.TIF" outpath =
> >
> "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/LC80040242014245LGN
> > 00_B3_test.TIF"
> >
> > ds = gdal.Open(band)
> > proj = ds.GetProjection()
> > geot = ds.GetGeoTransform()
> > dn = ds.ReadAsArray().astype(numpy.float32)
> > ds = None
> >
> > driver = gdal.GetDriverByName("GTiff")
> > ds_out = driver.Create(outpath, dn.shape[1], dn.shape[0], 1,
> > gdal.GDT_Float32)
> > ds_out.GetRasterBand(1).WriteArray(dn)
> > ds_out.SetProjection(proj)
> > ds_out.SetGeoTransform(geot)
> > ds_out.GetRasterBand(1).SetNoDataValue(0)
> > ds_out = None
> >
> > However, if I write to a different directory, or more curiously to a name
> > with a different prefix, it does not create the file.
> >
> > outpath =
> > "C:/Users/deschampsb/Desktop/test/LC80040242014245LGN00/newname.TIF"
> > outpath =
> > "C:/Users/deschampsb/Desktop/test/new/LC80040242014245LGN00_B3_test.TIF"
> >
> > Is it looking up other files in the directory?
> >
>
> OK that makes sense now. There is indeed a general metadata reader that
> recognizes Landsat _MTL.txt files (among other potential metadata
> sources). It
> is triggered here whereas it is not desirable in Create() case. Could you
> file
> a ticket on https://trac.osgeo.org/gdal/newticket regarding this ? Thanks
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160715/d67c8943/attachment.html>

From SGONG at mdacorporation.com  Fri Jul 15 09:46:17 2016
From: SGONG at mdacorporation.com (Shawn Gong)
Date: Fri, 15 Jul 2016 16:46:17 +0000
Subject: [gdal-dev] SPOT-7 and Worldview 3
In-Reply-To: <201607151802.55702.even.rouault@spatialys.com>
References: <7DCBC135929FF74E8A5488B1814AC6BC3BDA36B2@exbermd02.ds.mda.ca>,
 <201607151802.55702.even.rouault@spatialys.com>
Message-ID: <7DCBC135929FF74E8A5488B1814AC6BC3BDA36D7@exbermd02.ds.mda.ca>

Thank you Even.


Shawn

________________________________________
From: Even Rouault [even.rouault at spatialys.com]
Sent: July-15-16 12:02 PM
To: gdal-dev at lists.osgeo.org
Cc: Shawn Gong
Subject: Re: [gdal-dev] SPOT-7 and Worldview 3

Le vendredi 15 juillet 2016 17:29:19, Shawn Gong a écrit :
> Hi all,
>
>
>
> I have downloaded and built gdal 2.1.1
>
> Ran some tests on SPOT-7 and Worldview 3
>
>
>
> SPOT-7 tiled dimap: the DIM_SPOT7_*.xml file was loaded fine. But the
> georeferencing was wrong.  The xml seems to indicate ITRF2005 (epsg 4896)
> but it has no projection information in gdal.  The individual geotiffs
> didn't seem to agree with the xml either

I've done improvements in the DIMAP driver (for v2 products) in trunk recently
to support tiled datasets. You may want to check that.

>
> Worldview 3: the TIL file was loaded fine. UTM georeferencing looks good.
>
>
> Thanks,
> Shawn

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From frallain at gmail.com  Fri Jul 15 10:32:14 2016
From: frallain at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_ALLAIN?=)
Date: Fri, 15 Jul 2016 18:32:14 +0100
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
 GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <CAPRcDAAASyqi4ssrvOC4SZ9rK-xM+AQx6umuXr6Y-9L3UkWhyw@mail.gmail.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAC=M_RTSmeeShfDVL3WJ+vu1k_MkDkO1p+JBWPJRTmhJQ@mail.gmail.com>
 <201607142235.06765.even.rouault@spatialys.com>
 <CAPRcDAAASyqi4ssrvOC4SZ9rK-xM+AQx6umuXr6Y-9L3UkWhyw@mail.gmail.com>
Message-ID: <CAPRcDADSxKvQ6oObQPPAYsOGOdk45SQD2ZAHvmpwrgOupDoSLQ@mail.gmail.com>

I am now trying to do this process as an in-memory process.
I coudl figure out how to load the .tif in-memory :

 # Create in-memory file and initialize it with the content
gdal.FileFromMemBuffer('/vsimem/tiffinmem', self.file)

# Open the in-memory file
ds = gdal.Open('/vsimem/tiffinmem', gdal.GA_Update)

But i've got some problem to get a
<osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow *'
from a geojson... Here are my vain attemps:


 #create an output datasource in memory
outdriver=ogr.GetDriverByName('MEMORY')
source=outdriver.CreateDataSource('memData')
# <osgeo.ogr.DataSource; proxy of <Swig Object of type 'OGRDataSourceShadow
*'
#open the memory datasource with write access
tmp=outdriver.Open('memData',1)

import os
import sys
from osgeo import gdal, ogr, osr
geojson =
"""{"type":"Polygon","coordinates":[[[-76.4603750,45.4506926],[-76.4603632,45.4506998],[-76.4603522,45.4506914],[-76.4603639,45.4506845],[-76.4603750,45.4506926]]]}"""
geometry = ogr.CreateGeometryFromJson(geojson)
# print type(geometry)
# <class 'osgeo.ogr.Geometry'>

I know that i need to build a  GDALDatasetShadow object from the
OGRDataSourceShadow
object and the osgeo.ogr.Geometry object but i've got no clue after
searching on the web :
http://www.gdal.org/classGDALDataset.html#a9cb8585d0b3c16726b08e25bcc94274a
https://pcjericks.github.io/py-gdalogr-cookbook/vector_layers.html#load-data-to-memory
https://pcjericks.github.io/py-gdalogr-cookbook/vector_layers.html#spatial-filter

Could please give a hint ?

I would be grateful.

Cheers


François ALLAIN
+33 651399906


On Fri, Jul 15, 2016 at 9:45 AM, François ALLAIN <frallain at gmail.com> wrote:

> My bad... I finally got it working with your code :
>
> import os
> import sys
> from osgeo import gdal, ogr, osr
>
> geojson_filename = "my.geojson"
> driver = ogr.GetDriverByName("GeoJSON")
> vector_ds  = gdal.OpenEx( geojson_filename, gdal.OF_VECTOR )
>
> geotiff_filename = "my.tif"
> ds = gdal.Open(geotiff_filename, gdal.GA_Update)
>
> ret = gdal.Rasterize(ds,
>                     vector_ds,
>                     bands = [4],
>                     inverse = True,
>                     burnValues = [0])
>
> if ret != 1:
>     print 'fail'
> else:
>     print 'success'
>
> Cheers and thanks again
>
> François
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160715/4b062650/attachment.html>

From even.rouault at spatialys.com  Fri Jul 15 10:36:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Jul 2016 19:36:57 +0200
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
	GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <CAPRcDADSxKvQ6oObQPPAYsOGOdk45SQD2ZAHvmpwrgOupDoSLQ@mail.gmail.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAAASyqi4ssrvOC4SZ9rK-xM+AQx6umuXr6Y-9L3UkWhyw@mail.gmail.com>
 <CAPRcDADSxKvQ6oObQPPAYsOGOdk45SQD2ZAHvmpwrgOupDoSLQ@mail.gmail.com>
Message-ID: <201607151936.57877.even.rouault@spatialys.com>

Le vendredi 15 juillet 2016 19:32:14, François ALLAIN a écrit :
> I am now trying to do this process as an in-memory process.
> I coudl figure out how to load the .tif in-memory :
> 
>  # Create in-memory file and initialize it with the content
> gdal.FileFromMemBuffer('/vsimem/tiffinmem', self.file)
> 
> # Open the in-memory file
> ds = gdal.Open('/vsimem/tiffinmem', gdal.GA_Update)
> 
> But i've got some problem to get a
> <osgeo.gdal.Dataset; proxy of <Swig Object of type 'GDALDatasetShadow *'
> from a geojson... Here are my vain attemps:
> 
> 
>  #create an output datasource in memory
> outdriver=ogr.GetDriverByName('MEMORY')
> source=outdriver.CreateDataSource('memData')
> # <osgeo.ogr.DataSource; proxy of <Swig Object of type 'OGRDataSourceShadow
> *'
> #open the memory datasource with write access
> tmp=outdriver.Open('memData',1)
> 
> import os
> import sys
> from osgeo import gdal, ogr, osr
> geojson =
> """{"type":"Polygon","coordinates":[[[-76.4603750,45.4506926],[-76.4603632,
> 45.4506998],[-76.4603522,45.4506914],[-76.4603639,45.4506845],[-76.4603750,
> 45.4506926]]]}""" geometry = ogr.CreateGeometryFromJson(geojson)
> # print type(geometry)
> # <class 'osgeo.ogr.Geometry'>
> 
> I know that i need to build a  GDALDatasetShadow object from the
> OGRDataSourceShadow
> object and the osgeo.ogr.Geometry object but i've got no clue after
> searching on the web :
> http://www.gdal.org/classGDALDataset.html#a9cb8585d0b3c16726b08e25bcc94274a
> https://pcjericks.github.io/py-gdalogr-cookbook/vector_layers.html#load-dat
> a-to-memory
> https://pcjericks.github.io/py-gdalogr-cookbook/vector_layers.html#spatial
> -filter
> 
> Could please give a hint ?

Have a look at test_gdal_rasterize_lib_1() in
https://svn.osgeo.org/gdal/trunk/autotest/utilities/test_gdal_rasterize_lib.py

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From 191980 at niuitmo.ru  Sun Jul 17 08:25:37 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 17 Jul 2016 15:25:37 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 8]
Message-ID: <720044BF-5F69-4EB3-9BF4-4DCBFAF73DD1@niuitmo.ru>

<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-8-report.html>

Blogpost link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-8-report.html> (full copy of report is below).


1. This week I've done:

Libopencad changes:

- BlockReference is now handled properly.

- Added a new API to work with Dictionaries (NamedObjectDictionary XRecords can be got, nested dictionaries isnt supported right now).

- Every geometry now has a list of attributes (can be got by calling CADGeometry::getBlockAttributes()). This attributes are being got from BlockReference (every geometry in block reference has it's block reference attributes).


OGR CAD Driver changes:

- Basic spline geometry support added.

- CADRecode() function, which does recoding CAD file strings (usually they are not UTF compatible, so it does recoding it to UTF).

- OGR Feature Style now sets to PEN(geometry color). Thickness and dash-dot styles needs LineType information (libopencad doesnot read it).

- Fixed a lot of errors which occured in test_ogrsf utility.


2. Plan on doing next week:

Library code refactoring and preparation it for GDAL-trunk, map geometry attributes into Feature attributes. Remove C++11 code from driver code, fix windows build.


3. Blocking:

None.


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160717/183a3812/attachment.html>

From baas at speerit.nl  Sun Jul 17 22:53:20 2016
From: baas at speerit.nl (Jelmer Baas)
Date: Mon, 18 Jul 2016 05:53:20 +0000
Subject: [gdal-dev] Unable to read in GML file via OGRINFO / OGR2OGR
	(attempt 2)
Message-ID: <BC9747AD8551184D9B674A8310FE337B316E59B9@mailserver>

Hello,

My apologies for posting this to the mailinglist instead of creating a ticket; I don't have neither an account nor a 'mantra' to create one. Also: this is my second email; the first one got stuck in moderation because of the 200KB attachment.

I'm trying to read-in GML dump files created by the Dutch government for something called 'BGT': https://www.pdok.nl/nl/producten/pdok-downloads/download-basisregistratie-grootschalige-topografie

Most files work OK, but some crash with errors like this:
ERROR 1: Did not get at least 3 values or invalid number of
set of coordinates <gml:posList>208571.109 471975.820 208566.817 471979.832 208563.393 471983.993 208560.647 471988.047 208559.061 471992.578 208558.491 471995.522 208560.093
471998.215 208561.266 472000.859 208562.744 472002.305 208569.013 472004.931 208579.753 472008.430 208604.055 472016.825 208612.004 472019.497 208624.655 472024.144 208635.529
 472028.072 208648.497 472032.266 208662.090 472037.073 208677.664 472042.323 208693.844 472047.788 208708.362 472053.101 208723.717 472058.277 208739.036 472063.579 208749.17
9 472067.218 208768.026 472073.756 208784.226 472079.411 208807.632 472087.496 208824.624 472093.225 208846.511 472100.642 208867.095 472107.655 208888.151 472114.912 208909.5
80 472122.717 208927.368 472129.470 208947.175 472137.865 208964.831 472146.035 208985.138 472155.696 208997.877 472161.397 209003.819 472164.163 209007.933 472165.992 209012.
133 472167.200 209015.477 472168.023 209018.800 472168.782 209020.224 472169.028 209026.980 472171.610 209033.017 472173.880 209039.922 472176.630 209044.744 472178.919</gml:posList>

I've tried adding -dim 2 to ogr2ogr, but that doesn't seem to work. Is there any way to force ogr to treat these objects as 2D? Forcing object type isn't possible, unfortunately, since the GML file contains mixed types (linestrings, polygons, even curved polygons).

I can provide a 200KB testfile if that helps.

Regards,
Jelmer Baas


From emmanuel.sambale at gmail.com  Mon Jul 18 00:22:52 2016
From: emmanuel.sambale at gmail.com (maning sambale)
Date: Mon, 18 Jul 2016 12:52:52 +0530
Subject: [gdal-dev] change attribute type of OSM data
Message-ID: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>

Hi,

I found this section of the code osmconf.ini:

# type of attribute 'foo' can be changed with something like
#foo_type=Integer/Real/String/DateTime

So in my configuration I have the following:

# keys to report as OGR fields
attributes=name,building,height,ele,start_date,

height_type=Real
ele_type=Real
start_date_type=DateTime

Not sure if I'm doing it correctly


-- 
cheers,
maning
------------------------------------------------------
"Freedom is still the most radical idea of all" -N.Branden
https://epsg4253.wordpress.com/
http://twitter.com/maningsambale
------------------------------------------------------

From even.rouault at spatialys.com  Mon Jul 18 07:07:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jul 2016 16:07:58 +0200
Subject: [gdal-dev] change attribute type of OSM data
In-Reply-To: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
References: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
Message-ID: <201607181607.58956.even.rouault@spatialys.com>

Le lundi 18 juillet 2016 09:22:52, maning sambale a écrit :
> Hi,
> 
> I found this section of the code osmconf.ini:
> 
> # type of attribute 'foo' can be changed with something like
> #foo_type=Integer/Real/String/DateTime
> 
> So in my configuration I have the following:
> 
> # keys to report as OGR fields
> attributes=name,building,height,ele,start_date,
> 
> height_type=Real
> ele_type=Real
> start_date_type=DateTime
> 
> Not sure if I'm doing it correctly

This looks good, but you can check for sure by looking at the attribute types 
returned with ogrinfo -so -al your.osm


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jul 18 07:27:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jul 2016 16:27:07 +0200
Subject: [gdal-dev] Unable to read in GML file via OGRINFO / OGR2OGR
	(attempt 2)
In-Reply-To: <BC9747AD8551184D9B674A8310FE337B316E59B9@mailserver>
References: <BC9747AD8551184D9B674A8310FE337B316E59B9@mailserver>
Message-ID: <201607181627.07694.even.rouault@spatialys.com>

> 
> I've tried adding -dim 2 to ogr2ogr, but that doesn't seem to work. Is
> there any way to force ogr to treat these objects as 2D? Forcing object
> type isn't possible, unfortunately, since the GML file contains mixed
> types (linestrings, polygons, even curved polygons).

No, there must be something in the GML that indicates that it is 3D, but some 
inconsistency afterwards.

> 
> I can provide a 200KB testfile if that helps.

That would be helpful to confirm.

> 
> Regards,
> Jelmer Baas
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From frallain at gmail.com  Mon Jul 18 09:19:19 2016
From: frallain at gmail.com (=?UTF-8?Q?Fran=C3=A7ois_ALLAIN?=)
Date: Mon, 18 Jul 2016 17:19:19 +0100
Subject: [gdal-dev] Fwd: Problem with gdal.Rasterize utility : argument
 GDALDatasetShadow in wrapper_GDALRasterizeDestName
In-Reply-To: <201607151936.57877.even.rouault@spatialys.com>
References: <CAPRcDABfDT7NGVBVpa3rbyYahvWUknCxgQ+wC3XbLSyJthKqOA@mail.gmail.com>
 <CAPRcDAAASyqi4ssrvOC4SZ9rK-xM+AQx6umuXr6Y-9L3UkWhyw@mail.gmail.com>
 <CAPRcDADSxKvQ6oObQPPAYsOGOdk45SQD2ZAHvmpwrgOupDoSLQ@mail.gmail.com>
 <201607151936.57877.even.rouault@spatialys.com>
Message-ID: <CAPRcDADg9raHNeCci9GnCY5W2Gk35AbPG90075cagQt4ME9XPQ@mail.gmail.com>

Here is how I did finally :

    INPUTS:
    mask_geojson = [feature['geometry'] for feature in geojson['features']]
    filelike_in # my Geotiff file in-Memory (cStringIO.StringIO)



   # https://lists.osgeo.org/pipermail/gdal-dev/2010-May/024723.html
    # Create in-memory file and initialize it with the content
    gdal.FileFromMemBuffer('/vsimem/tiffinmem', filelike_in.read())

    # Open the in-memory file
    ds = gdal.Open('/vsimem/tiffinmem', gdal.GA_Update)

    #
https://trac.osgeo.org/gdal/browser/trunk/autotest/utilities/test_gdal_rasterize_lib.py?rev=30939
    # https://trac.osgeo.org/gdal/wiki/rfc59.1_utilities_as_a_library
    #
https://pcjericks.github.io/py-gdalogr-cookbook/vector_layers.html#spatial-filter
    vector_ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0)
    layer = vector_ds.CreateLayer('layer')
    layer.GetLayerDefn()
    feature = ogr.Feature(layer.GetLayerDefn())
    geojson_str = json.dumps(mask_geojson[0])
    feature.SetGeometryDirectly(ogr.CreateGeometryFromJson(geojson_str))
    layer.CreateFeature(feature)

    ret = gdal.Rasterize(ds,
                        vector_ds,
                        bands = [1,2,3,4],
                        inverse = True,
                        burnValues = [0])
    # rasterio.mask.mask burns the RGB channels on top of the Alpha
    # -> this is not needed but results in a smaller png :
    # 56.7kB instead of 78.5 kB. Any change in the time required ?

    # transforming a GDAL-style shape to a standard-style shape
    np_array = np.rollaxis(ds.ReadAsArray(), 0, 3)

    filelike_out = cStringIO.StringIO()
    misc.imsave(filelike_out, np_array, 'png')

    # Close the dataset
    ds = None

    # Release memory associated to the in-memory file
    gdal.Unlink('/vsimem/tiffinmem')


Cheers
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160718/de786812/attachment.html>

From even.rouault at spatialys.com  Mon Jul 18 14:09:42 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 Jul 2016 23:09:42 +0200
Subject: [gdal-dev] Unable to read in GML file via OGRINFO / OGR2OGR
	(attempt 2)
In-Reply-To: <201607181627.07694.even.rouault@spatialys.com>
References: <BC9747AD8551184D9B674A8310FE337B316E59B9@mailserver>
 <201607181627.07694.even.rouault@spatialys.com>
Message-ID: <201607182309.42555.even.rouault@spatialys.com>

> That would be helpful to confirm.

Based on sample file provided off-line, turned out to be a hack specific to 
CityGML that was far from being universal.
Fixed per https://trac.osgeo.org/gdal/ticket/6597

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From emmanuel.sambale at gmail.com  Mon Jul 18 21:19:54 2016
From: emmanuel.sambale at gmail.com (maning sambale)
Date: Tue, 19 Jul 2016 09:49:54 +0530
Subject: [gdal-dev] change attribute type of OSM data
In-Reply-To: <201607181607.58956.even.rouault@spatialys.com>
References: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
 <201607181607.58956.even.rouault@spatialys.com>
Message-ID: <CAPzumuFBGH_qiftNsmj-FvTiszBb5SzJBZz4owxdAnRaqf-nAw@mail.gmail.com>

Hi Even,

Here's mi osmconf.ini:
https://gist.github.com/anonymous/f9b34c34a2107fd4fb3a5dfa5931b78f

Converting to shapefile:
ogr2ogr -f "ESRI Shapefile" -overwrite labuildings.shp
california-latest.osm.pbf -spat -118.952 32.75 -117.646 34.8233
--config OSM_CONFIG_FILE osmconf.ini -progress -sql 'select * from
multipolygons where building is not null'

I get the following:
ogrinfo -so -al labuildings.shp
<snip>
height: String (80.0)
ele: String (80.0)
start_date: String (80.0)
other_tags: String (254.0)

On Mon, Jul 18, 2016 at 7:37 PM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le lundi 18 juillet 2016 09:22:52, maning sambale a écrit :
>> Hi,
>>
>> I found this section of the code osmconf.ini:
>>
>> # type of attribute 'foo' can be changed with something like
>> #foo_type=Integer/Real/String/DateTime
>>
>> So in my configuration I have the following:
>>
>> # keys to report as OGR fields
>> attributes=name,building,height,ele,start_date,
>>
>> height_type=Real
>> ele_type=Real
>> start_date_type=DateTime
>>
>> Not sure if I'm doing it correctly
>
> This looks good, but you can check for sure by looking at the attribute types
> returned with ogrinfo -so -al your.osm
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com



-- 
cheers,
maning
------------------------------------------------------
"Freedom is still the most radical idea of all" -N.Branden
https://epsg4253.wordpress.com/
http://twitter.com/maningsambale
------------------------------------------------------

From even.rouault at spatialys.com  Tue Jul 19 00:47:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jul 2016 09:47:33 +0200
Subject: [gdal-dev] change attribute type of OSM data
In-Reply-To: <CAPzumuFBGH_qiftNsmj-FvTiszBb5SzJBZz4owxdAnRaqf-nAw@mail.gmail.com>
References: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
 <201607181607.58956.even.rouault@spatialys.com>
 <CAPzumuFBGH_qiftNsmj-FvTiszBb5SzJBZz4owxdAnRaqf-nAw@mail.gmail.com>
Message-ID: <201607190947.33986.even.rouault@spatialys.com>

Le mardi 19 juillet 2016 06:19:54, maning sambale a écrit :
> Hi Even,
> 
> Here's mi osmconf.ini:
> https://gist.github.com/anonymous/f9b34c34a2107fd4fb3a5dfa5931b78f

Works for me. Looking at history, I see this capability was added in GDAL 2.0 
so I presume you use an older version.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From baas at speerit.nl  Tue Jul 19 00:49:50 2016
From: baas at speerit.nl (Jelmer Baas)
Date: Tue, 19 Jul 2016 07:49:50 +0000
Subject: [gdal-dev] Unable to read in GML file via OGRINFO /
	OGR2OGR	(attempt 2)
In-Reply-To: <201607182309.42555.even.rouault@spatialys.com>
References: <BC9747AD8551184D9B674A8310FE337B316E59B9@mailserver>
 <201607181627.07694.even.rouault@spatialys.com>
 <201607182309.42555.even.rouault@spatialys.com>
Message-ID: <BC9747AD8551184D9B674A8310FE337B316E602D@mailserver>

Amazing! 

Thanks for the quick response!

Regards,
Jelmer

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Even Rouault
Sent: maandag 18 juli 2016 23:10
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Unable to read in GML file via OGRINFO / OGR2OGR (attempt 2)

> That would be helpful to confirm.

Based on sample file provided off-line, turned out to be a hack specific to 
CityGML that was far from being universal.
Fixed per https://trac.osgeo.org/gdal/ticket/6597

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue Jul 19 00:54:04 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jul 2016 09:54:04 +0200
Subject: [gdal-dev] change attribute type of OSM data
In-Reply-To: <201607190947.33986.even.rouault@spatialys.com>
References: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
 <CAPzumuFBGH_qiftNsmj-FvTiszBb5SzJBZz4owxdAnRaqf-nAw@mail.gmail.com>
 <201607190947.33986.even.rouault@spatialys.com>
Message-ID: <201607190954.04166.even.rouault@spatialys.com>

Le mardi 19 juillet 2016 09:47:33, Even Rouault a écrit :
> Le mardi 19 juillet 2016 06:19:54, maning sambale a écrit :
> > Hi Even,
> > 
> > Here's mi osmconf.ini:
> > https://gist.github.com/anonymous/f9b34c34a2107fd4fb3a5dfa5931b78f
> 
> Works for me. Looking at history, I see this capability was added in GDAL
> 2.0 so I presume you use an older version.

This was added together with the capability of creating computed fields with 
SQL expressions.

But you can change the type of columns with CAST(field_name AS type_name) in 
your -sql statement

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jul 19 05:32:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jul 2016 14:32:55 +0200
Subject: [gdal-dev] OGDI 3.2.0 released
Message-ID: <201607191432.55948.even.rouault@spatialys.com>

Hi,

I guess people will only begin testing when it is released, so here it is :
https://sourceforge.net/projects/ogdi/files/ogdi/3.2.0/ogdi-3.2.0.tar.gz/download

3.2.0 news:

 o  Fix Windows build issues

 o  Harding of VRF driver regarding corrupted datasets

 o  Extra fixes for buffer overflows and 64 bit issues.

 o  Compiler warning fixes

 o  PROJ >= 4.8 support


Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniele.romagnoli at geo-solutions.it  Tue Jul 19 05:51:07 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue, 19 Jul 2016 14:51:07 +0200
Subject: [gdal-dev] How to add an external mask as internal mask to a
	GeoTIFF?
Message-ID: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>

Hi List,
I have a 4 Bands (RGB-IR) GeoTIFF for which I also have an external
mask.tif which has been created starting from a mask.shp shapefile using
this command:

*gdal_rasterize -ot Byte -l mask -CO "TILED=YES" -CO "NBITS=1" -CO
"PHOTOMETRIC=MINISBLACK" -CO "COMPRESS=DEFLATE" -a cat -burn 1 -ts 16384
16384 mask.shp mask.tif*

So that my mask.tif is 1 bit B/W GeoTIFF.
Now, I would like to add it as Internal Mask of the main GeoTIFF.
I have played a bit with GDAL translate and buildvrt and, due to
constraints on number of bands, I ended up with this commands:




*gdalbuildvrt -b 1 1.vrt origin.tif gdalbuildvrt -b 2 2.vrt
origin.tifgdalbuildvrt -b 3 3.vrt origin.tif *
*gdalbuildvrt -b 4 4.vrt origin.tif *
In order to separate the bands
Then:
*gdalbuildvrt -separate out.vrt 1.vrt 2.vrt 3.vrt 4.vrt mask.tif *

in order to re-aggregate them into a single raster, together with the mask.

And finally:

*gdal_translate -of GTIFF -CO "PHOTOMETRIC=RGB" -CO "ALPHA=NO" -CO
"TILED=YES" -CO "COMPRESS=DEFLATE" -b 1 -b 2 -b 3 -b 4 -mask 5 out.vrt
final.tif*

So that I copy the 4 bands from VRT and add the 5th band as mask.

I have 2 issues with that:
1) This solution is really not optimal. Wondering if there is a single
command to attach an external tif as a mask band of an existing raster
(provided it has same CRS, resolution, bbox, ecc)
2) What I get is that the mask has been set as an external file
final.tif.msk.
Is there any config option or opening option to open the final.tif in
update mode so that the band mask can be added as internal geotiff mask?

Please, let me know what do you think about it.
Cheers,
Daniele


-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160719/45108d3c/attachment.html>

From even.rouault at spatialys.com  Tue Jul 19 06:12:24 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jul 2016 15:12:24 +0200
Subject: [gdal-dev] How to add an external mask as internal mask to a
	GeoTIFF?
In-Reply-To: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>
References: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>
Message-ID: <201607191512.24817.even.rouault@spatialys.com>

Hi Daniele,

> 
> I have 2 issues with that:
> 1) This solution is really not optimal. Wondering if there is a single
> command to attach an external tif as a mask band of an existing raster
> (provided it has same CRS, resolution, bbox, ecc)

None that I can think of. Your workflow is probably close to optimum if you 
don't want to create the VRT at hand

I think we would welcome a contribution of a Python script that would allow 
things like :
- gdal_add_band.py -mask in.tif mask.tif out.vrt
- gdal_add_band.py -alpha in.tif alpha.tif out.vrt
- gdal_add_band.py in.tif extra_band.tif out.vrt

> 2) What I get is that the mask has been set as an external file
> final.tif.msk.
> Is there any config option or opening option to open the final.tif in
> update mode so that the band mask can be added as internal geotiff mask?

Yes, "--config GDAL_TIFF_INTERNAL_MASK YES". See "Internal nodata masks" 
paragraph of http://gdal.org/frmt_gtiff.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniele.romagnoli at geo-solutions.it  Tue Jul 19 06:27:05 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue, 19 Jul 2016 15:27:05 +0200
Subject: [gdal-dev] How to add an external mask as internal mask to a
	GeoTIFF?
In-Reply-To: <201607191512.24817.even.rouault@spatialys.com>
References: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>
 <201607191512.24817.even.rouault@spatialys.com>
Message-ID: <CAJaHrDzGA+mytf7LdmAwndduFdcPfgQ0C5p5dkpuWbvxsFHosA@mail.gmail.com>

Hi Even,
thanks for the feedback.

I was using it as a -co "GDAL_TIFF_INTERNAL_MASK=YES" to the latest command
and I was getting

*Warning 6: driver GTiff does not support creation option
GDAL_TIFF_INTERNAL_MASK*
Appending the line you provided me to that command worked!
Thanks.
Daniele


On Tue, Jul 19, 2016 at 3:12 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Daniele,
>
> >
> > I have 2 issues with that:
> > 1) This solution is really not optimal. Wondering if there is a single
> > command to attach an external tif as a mask band of an existing raster
> > (provided it has same CRS, resolution, bbox, ecc)
>
> None that I can think of. Your workflow is probably close to optimum if you
> don't want to create the VRT at hand
>
> I think we would welcome a contribution of a Python script that would allow
> things like :
> - gdal_add_band.py -mask in.tif mask.tif out.vrt
> - gdal_add_band.py -alpha in.tif alpha.tif out.vrt
> - gdal_add_band.py in.tif extra_band.tif out.vrt
>
> > 2) What I get is that the mask has been set as an external file
> > final.tif.msk.
> > Is there any config option or opening option to open the final.tif in
> > update mode so that the band mask can be added as internal geotiff mask?
>
> Yes, "--config GDAL_TIFF_INTERNAL_MASK YES". See "Internal nodata masks"
> paragraph of http://gdal.org/frmt_gtiff.html
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160719/47395e24/attachment.html>

From even.rouault at spatialys.com  Tue Jul 19 06:34:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Jul 2016 15:34:14 +0200
Subject: [gdal-dev] How to add an external mask as internal mask to a
	GeoTIFF?
In-Reply-To: <CAJaHrDzGA+mytf7LdmAwndduFdcPfgQ0C5p5dkpuWbvxsFHosA@mail.gmail.com>
References: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>
 <201607191512.24817.even.rouault@spatialys.com>
 <CAJaHrDzGA+mytf7LdmAwndduFdcPfgQ0C5p5dkpuWbvxsFHosA@mail.gmail.com>
Message-ID: <201607191534.15158.even.rouault@spatialys.com>

Le mardi 19 juillet 2016 15:27:05, Daniele Romagnoli a écrit :
> Hi Even,
> thanks for the feedback.
> 
> I was using it as a -co "GDAL_TIFF_INTERNAL_MASK=YES" to the latest command
> and I was getting
> 
> *Warning 6: driver GTiff does not support creation option
> GDAL_TIFF_INTERNAL_MASK*
> Appending the line you provided me to that command worked!

Yes, there is some confusion around configuration options vs creation options, 
and you must be careful about the terminology used in the documentation.

"Configuration options" are specified either with "--config name value" or as 
environmenet variables or with CPLSetConfigOption(name,value) in C

"Creation options" are specified with gdal_translate -co name=value or as 
"name=value" strings in the papszOptions argument of Create()/CreateCopy() 
methods in C/C++

GDAL_TIFF_INTERNAL_MASK is a configuration option since it can be used on an 
existing TIFF opened in update mode, to which you add a mask. Thus a creation 
option couldn't be used in that case (since a creation option is for when the 
target file does not exist yet).

> Thanks.
> Daniele
> 
> 
> On Tue, Jul 19, 2016 at 3:12 PM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Hi Daniele,
> > 
> > > I have 2 issues with that:
> > > 1) This solution is really not optimal. Wondering if there is a single
> > > command to attach an external tif as a mask band of an existing raster
> > > (provided it has same CRS, resolution, bbox, ecc)
> > 
> > None that I can think of. Your workflow is probably close to optimum if
> > you don't want to create the VRT at hand
> > 
> > I think we would welcome a contribution of a Python script that would
> > allow things like :
> > - gdal_add_band.py -mask in.tif mask.tif out.vrt
> > - gdal_add_band.py -alpha in.tif alpha.tif out.vrt
> > - gdal_add_band.py in.tif extra_band.tif out.vrt
> > 
> > > 2) What I get is that the mask has been set as an external file
> > > final.tif.msk.
> > > Is there any config option or opening option to open the final.tif in
> > > update mode so that the band mask can be added as internal geotiff
> > > mask?
> > 
> > Yes, "--config GDAL_TIFF_INTERNAL_MASK YES". See "Internal nodata masks"
> > paragraph of http://gdal.org/frmt_gtiff.html
> > 
> > Even
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From daniele.romagnoli at geo-solutions.it  Tue Jul 19 06:52:36 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Tue, 19 Jul 2016 15:52:36 +0200
Subject: [gdal-dev] How to add an external mask as internal mask to a
	GeoTIFF?
In-Reply-To: <201607191534.15158.even.rouault@spatialys.com>
References: <CAJaHrDx3s6o2gzrvtk03Li5B0vv_4QTUth1f-K6twpeauzFuig@mail.gmail.com>
 <201607191512.24817.even.rouault@spatialys.com>
 <CAJaHrDzGA+mytf7LdmAwndduFdcPfgQ0C5p5dkpuWbvxsFHosA@mail.gmail.com>
 <201607191534.15158.even.rouault@spatialys.com>
Message-ID: <CAJaHrDwcE3j1rfBhcJra8fwAVTAQjmiB5zt7QhDyv=qG3Vprog@mail.gmail.com>

On Tue, Jul 19, 2016 at 3:34 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 19 juillet 2016 15:27:05, Daniele Romagnoli a écrit :
> > Hi Even,
> > thanks for the feedback.
> >
> > I was using it as a -co "GDAL_TIFF_INTERNAL_MASK=YES" to the latest
> command
> > and I was getting
> >
> > *Warning 6: driver GTiff does not support creation option
> > GDAL_TIFF_INTERNAL_MASK*
> > Appending the line you provided me to that command worked!
>
> Yes, there is some confusion around configuration options vs creation
> options,
> and you must be careful about the terminology used in the documentation.
>
> "Configuration options" are specified either with "--config name value" or
> as
> environmenet variables or with CPLSetConfigOption(name,value) in C
>
> "Creation options" are specified with gdal_translate -co name=value or as
> "name=value" strings in the papszOptions argument of Create()/CreateCopy()
> methods in C/C++
>
> Right, when seeing that option on some previous commands in my shell
history, I have confused it as a Create option instead of a Configuration
one.
Thanks for the clarification. Very helpful.

Cheers,
Daniele


> GDAL_TIFF_INTERNAL_MASK is a configuration option since it can be used on
> an
> existing TIFF opened in update mode, to which you add a mask. Thus a
> creation
> option couldn't be used in that case (since a creation option is for when
> the
> target file does not exist yet).
>







>
> > Thanks.
> > Daniele
> >
> >
> > On Tue, Jul 19, 2016 at 3:12 PM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Hi Daniele,
> > >
> > > > I have 2 issues with that:
> > > > 1) This solution is really not optimal. Wondering if there is a
> single
> > > > command to attach an external tif as a mask band of an existing
> raster
> > > > (provided it has same CRS, resolution, bbox, ecc)
> > >
> > > None that I can think of. Your workflow is probably close to optimum if
> > > you don't want to create the VRT at hand
> > >
> > > I think we would welcome a contribution of a Python script that would
> > > allow things like :
> > > - gdal_add_band.py -mask in.tif mask.tif out.vrt
> > > - gdal_add_band.py -alpha in.tif alpha.tif out.vrt
> > > - gdal_add_band.py in.tif extra_band.tif out.vrt
> > >
> > > > 2) What I get is that the mask has been set as an external file
> > > > final.tif.msk.
> > > > Is there any config option or opening option to open the final.tif in
> > > > update mode so that the band mask can be added as internal geotiff
> > > > mask?
> > >
> > > Yes, "--config GDAL_TIFF_INTERNAL_MASK YES". See "Internal nodata
> masks"
> > > paragraph of http://gdal.org/frmt_gtiff.html
> > >
> > > Even
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160719/edac44c6/attachment-0001.html>

From emmanuel.sambale at gmail.com  Tue Jul 19 07:07:17 2016
From: emmanuel.sambale at gmail.com (maning sambale)
Date: Tue, 19 Jul 2016 19:37:17 +0530
Subject: [gdal-dev] change attribute type of OSM data
In-Reply-To: <201607190954.04166.even.rouault@spatialys.com>
References: <CAPzumuF1QrkN4o=JHfGaBRKu=GqXTfifcGu5f9bSbrHpewd3xg@mail.gmail.com>
 <CAPzumuFBGH_qiftNsmj-FvTiszBb5SzJBZz4owxdAnRaqf-nAw@mail.gmail.com>
 <201607190947.33986.even.rouault@spatialys.com>
 <201607190954.04166.even.rouault@spatialys.com>
Message-ID: <CAPzumuGtt9kjv_2iAoB5vcW20ormgsyp3MQG8rKOyH-f3KqUSw@mail.gmail.com>

I see, I'm using 1.11.  Will try the sql CAST way.  Thanks!

On Tue, Jul 19, 2016 at 1:24 PM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le mardi 19 juillet 2016 09:47:33, Even Rouault a écrit :
>> Le mardi 19 juillet 2016 06:19:54, maning sambale a écrit :
>> > Hi Even,
>> >
>> > Here's mi osmconf.ini:
>> > https://gist.github.com/anonymous/f9b34c34a2107fd4fb3a5dfa5931b78f
>>
>> Works for me. Looking at history, I see this capability was added in GDAL
>> 2.0 so I presume you use an older version.
>
> This was added together with the capability of creating computed fields with
> SQL expressions.
>
> But you can change the type of columns with CAST(field_name AS type_name) in
> your -sql statement
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com



-- 
cheers,
maning
------------------------------------------------------
"Freedom is still the most radical idea of all" -N.Branden
https://epsg4253.wordpress.com/
http://twitter.com/maningsambale
------------------------------------------------------

From matthias at opengis.ch  Tue Jul 19 22:29:06 2016
From: matthias at opengis.ch (Matthias Kuhn)
Date: Wed, 20 Jul 2016 07:29:06 +0200
Subject: [gdal-dev] Raster from temporary tiles
Message-ID: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>

Hi,

I have a question regarding creating raster data (geopackage). It's
trivial to create files with gdal_translate if there is already an
existing source raster file (e.g. geotiff).

What I need to do is to download tiles and "feed" them to a geopackage
raster file.
I guess I could just download them and then create a VRT or use
gdal_merge to stitch them together before sending them to gdal_translate.

Now I wonder if it's possible to incrementally populate the geopackage.
This way the cpu could already be spend some useful cycles on reencoding
while still imagery is still being downloaded.
Looking at the docs of geopackage [1] I think "support for
IWriteBlocks()" seems to indicate that this is possible but I'm not
completely sure.

A similar request would be to manually set the overview images. With
gdaladdo, the high-res imagery can be downsampled. But if that's
possible, I assume it should also be possible to "inject" different
raster tiles (e.g. of generalized maps).

Best regards
Matthias

[1] http://www.gdal.org/drv_geopackage_raster.html

From even.rouault at spatialys.com  Tue Jul 19 23:04:23 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 08:04:23 +0200
Subject: [gdal-dev] Raster from temporary tiles
In-Reply-To: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>
References: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>
Message-ID: <201607200804.24186.even.rouault@spatialys.com>

Hi Matthias,

The GPKG driver is a full-blown raster driver with similar capabilites to the 
GeoTIFF one. That is you can use GDALCreate() to initialize an empty raster 
and then write arbitrary portions of it with GDALRasterIO(, ..., GF_Write, 
...). 
You can also initialize empty overviews with GDALBuildOverviews( ..., "NONE", 
... ) and write arbitrary raster content in them with GDALRasterIO() on the 
overview bands.

Even

> Hi,
> 
> I have a question regarding creating raster data (geopackage). It's
> trivial to create files with gdal_translate if there is already an
> existing source raster file (e.g. geotiff).
> 
> What I need to do is to download tiles and "feed" them to a geopackage
> raster file.
> I guess I could just download them and then create a VRT or use
> gdal_merge to stitch them together before sending them to gdal_translate.
> 
> Now I wonder if it's possible to incrementally populate the geopackage.
> This way the cpu could already be spend some useful cycles on reencoding
> while still imagery is still being downloaded.
> Looking at the docs of geopackage [1] I think "support for
> IWriteBlocks()" seems to indicate that this is possible but I'm not
> completely sure.
> 
> A similar request would be to manually set the overview images. With
> gdaladdo, the high-res imagery can be downsampled. But if that's
> possible, I assume it should also be possible to "inject" different
> raster tiles (e.g. of generalized maps).
> 
> Best regards
> Matthias
> 
> [1] http://www.gdal.org/drv_geopackage_raster.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthias at opengis.ch  Tue Jul 19 23:08:07 2016
From: matthias at opengis.ch (Matthias Kuhn)
Date: Wed, 20 Jul 2016 08:08:07 +0200
Subject: [gdal-dev] Raster from temporary tiles
In-Reply-To: <201607200804.24186.even.rouault@spatialys.com>
References: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>
 <201607200804.24186.even.rouault@spatialys.com>
Message-ID: <47f8dfdf-188c-c27e-4934-eb56bcacb5ac@opengis.ch>

Hi Even


On 20/07/16 08:04, Even Rouault wrote:
> Hi Matthias,
>
> The GPKG driver is a full-blown raster driver with similar capabilites to the 
> GeoTIFF one. That is you can use GDALCreate() to initialize an empty raster 
> and then write arbitrary portions of it with GDALRasterIO(, ..., GF_Write, 
> ...). 
> You can also initialize empty overviews with GDALBuildOverviews( ..., "NONE", 
> ... ) and write arbitrary raster content in them with GDALRasterIO() on the 
> overview bands.
>
> Even

Thanks, good to know it's possible!
Is that available in

  * command line tools
  * the python API
  * or only the C API?


Matthias
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160720/b771a827/attachment.html>

From even.rouault at spatialys.com  Tue Jul 19 23:20:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 08:20:51 +0200
Subject: [gdal-dev] Raster from temporary tiles
In-Reply-To: <47f8dfdf-188c-c27e-4934-eb56bcacb5ac@opengis.ch>
References: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>
 <201607200804.24186.even.rouault@spatialys.com>
 <47f8dfdf-188c-c27e-4934-eb56bcacb5ac@opengis.ch>
Message-ID: <201607200820.51196.even.rouault@spatialys.com>

Le mercredi 20 juillet 2016 08:08:07, Matthias Kuhn a écrit :
> Hi Even
> 
> On 20/07/16 08:04, Even Rouault wrote:
> > Hi Matthias,
> > 
> > The GPKG driver is a full-blown raster driver with similar capabilites to
> > the GeoTIFF one. That is you can use GDALCreate() to initialize an empty
> > raster and then write arbitrary portions of it with GDALRasterIO(, ...,
> > GF_Write, ...).
> > You can also initialize empty overviews with GDALBuildOverviews( ...,
> > "NONE", ... ) and write arbitrary raster content in them with
> > GDALRasterIO() on the overview bands.
> > 
> > Even
> 
> Thanks, good to know it's possible!
> Is that available in
> 
>   * command line tools
For creation of an empty raster, I can't think of an existing easy way.
For creation of empty overviews, yes with
"gdaladdo -r NONE your.gpkg 2 4 ...."
For update of an existing raster, with "gdalwarp in.tif out.gpkg"
For update of overviews, likely with
"gdalwarp in.tif out.gpkg -doo ZOOM_LEVEL=2" (caution the zoom level is in the 
GPKG meaning, and not with the GDAL convention. ie ZOOM_LEVEL=0 is the less 
detailed overview level)

>   * the python API
Sure. The Python API wraps alls those basic calls
driver_obj.Create()
band_obj.WriteRaster()
gdal.BuildOverviews()

The driver tests might be a useful resource:
https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/gpkg.py

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matthias at opengis.ch  Tue Jul 19 23:24:29 2016
From: matthias at opengis.ch (Matthias Kuhn)
Date: Wed, 20 Jul 2016 08:24:29 +0200
Subject: [gdal-dev] Raster from temporary tiles
In-Reply-To: <201607200820.51196.even.rouault@spatialys.com>
References: <2dcad044-7683-0bbb-ee69-21bfee244607@opengis.ch>
 <201607200804.24186.even.rouault@spatialys.com>
 <47f8dfdf-188c-c27e-4934-eb56bcacb5ac@opengis.ch>
 <201607200820.51196.even.rouault@spatialys.com>
Message-ID: <2a2493db-b8e7-89b2-405a-7a2c0008fdb5@opengis.ch>

On 20/07/16 08:20, Even Rouault wrote:

> Le mercredi 20 juillet 2016 08:08:07, Matthias Kuhn a écrit :
>> Hi Even
>>
>> On 20/07/16 08:04, Even Rouault wrote:
>>> Hi Matthias,
>>>
>>> The GPKG driver is a full-blown raster driver with similar capabilites to
>>> the GeoTIFF one. That is you can use GDALCreate() to initialize an empty
>>> raster and then write arbitrary portions of it with GDALRasterIO(, ...,
>>> GF_Write, ...).
>>> You can also initialize empty overviews with GDALBuildOverviews( ...,
>>> "NONE", ... ) and write arbitrary raster content in them with
>>> GDALRasterIO() on the overview bands.
>>>
>>> Even
>> Thanks, good to know it's possible!
>> Is that available in
>>
>>   * command line tools
> For creation of an empty raster, I can't think of an existing easy way.
> For creation of empty overviews, yes with
> "gdaladdo -r NONE your.gpkg 2 4 ...."
> For update of an existing raster, with "gdalwarp in.tif out.gpkg"
> For update of overviews, likely with
> "gdalwarp in.tif out.gpkg -doo ZOOM_LEVEL=2" (caution the zoom level is in the 
> GPKG meaning, and not with the GDAL convention. ie ZOOM_LEVEL=0 is the less 
> detailed overview level)
>
>>   * the python API
> Sure. The Python API wraps alls those basic calls
> driver_obj.Create()
> band_obj.WriteRaster()
> gdal.BuildOverviews()
>
> The driver tests might be a useful resource:
> https://svn.osgeo.org/gdal/trunk/autotest/gdrivers/gpkg.py
>
Awesome, thanks a lot Even!


From even.rouault at spatialys.com  Wed Jul 20 02:18:30 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 11:18:30 +0200
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <1467704071254-5274688.post@n6.nabble.com>
References: <E0377F749DE181469BADAAA718213DF761F03F27@TW-MBX-P01.cnesnet.ad.cnes.fr>
 <201607041018.50794.even.rouault@spatialys.com>
 <1467704071254-5274688.post@n6.nabble.com>
Message-ID: <201607201118.30336.even.rouault@spatialys.com>

Le mardi 05 juillet 2016 09:34:31, Bugbuster a écrit :
> Dear Even,
> 
> Sorry for my late answer, I was onto something different yesterday.
> 
> I agree with you, and I did change all function declarations in order to
> "export" them in the DLL.
> Thus, all functions in both pixfunplugin.c and pixelfunctions.c are now
> declared as "C" functions with the CPL_DLL export tag.
> I checked with Dependency Walker that all functions are indeed exported
> correctly.
> What is really weird is that *all I/F variables* in RealPixFunc() function
> (for example) seem to be correct *but the 1sr one papoSources*.

For those who followed this thread, the issue has been reported and fixed in
https://trac.osgeo.org/gdal/ticket/6599

It turned out not being a Windows specific issue, but a general one that could 
affect any VRT derived band made of a single SimpleSource, when using dataset 
level raster I/O such as with gdal_translate.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 20 03:12:59 2016
From: jamessramm at gmail.com (jramm)
Date: Wed, 20 Jul 2016 03:12:59 -0700 (PDT)
Subject: [gdal-dev] Memory increase in postgis raster driver
Message-ID: <1469009579985-5277284.post@n6.nabble.com>

I am seeing a continuous, linear memory increase when reading sequential
windows of a large postgis dataset. This is the same regardless of my
GDAL_CACHEMAX settings
If I run he same code on an equivalent GTiff dataset, I do not see the same
increase in memory. 

I can see that the postgis dataset RasterIO implementation calls CacheTile
for each tile it reads, which I think uses the GDAL caching mechanism - is
it possible that, since each tile will be *new* (due to the sequential read
over the dataset), it is somehow cached outside of the gdal cache/ignoring
the CACHEMAX setting?

I'm just stabbing in the dark here as I can't really find a reason for it
yet



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Memory-increase-in-postgis-raster-driver-tp5277284.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From philippe.ghesquiere at airbus.com  Wed Jul 20 03:25:04 2016
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Wed, 20 Jul 2016 03:25:04 -0700 (PDT)
Subject: [gdal-dev] Amplitude virtual bands for complex datasets ?
In-Reply-To: <201607201118.30336.even.rouault@spatialys.com>
References: <201606281239.25031.even.rouault@spatialys.com>
 <5772E306.3090504@tiscali.it> <1467299787210-5274192.post@n6.nabble.com>
 <5775583C.7090802@tiscali.it> <1467355930076-5274296.post@n6.nabble.com>
 <5776B1E6.6040303@tiscali.it> <1467617444210-5274571.post@n6.nabble.com>
 <201607041018.50794.even.rouault@spatialys.com>
 <1467704071254-5274688.post@n6.nabble.com>
 <201607201118.30336.even.rouault@spatialys.com>
Message-ID: <1469010304746-5277290.post@n6.nabble.com>

Hi Even,

thanks a lot for your quick correction and the easy workaround.
Cheers
Philippe



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Amplitude-virtual-bands-for-complex-datasets-tp5273713p5277290.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jul 20 05:37:44 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 14:37:44 +0200
Subject: [gdal-dev] Memory increase in postgis raster driver
In-Reply-To: <1469009579985-5277284.post@n6.nabble.com>
References: <1469009579985-5277284.post@n6.nabble.com>
Message-ID: <201607201437.44368.even.rouault@spatialys.com>

Le mercredi 20 juillet 2016 12:12:59, jramm a écrit :
> I am seeing a continuous, linear memory increase when reading sequential
> windows of a large postgis dataset. This is the same regardless of my
> GDAL_CACHEMAX settings
> If I run he same code on an equivalent GTiff dataset, I do not see the same
> increase in memory.
> 
> I can see that the postgis dataset RasterIO implementation calls CacheTile
> for each tile it reads, which I think uses the GDAL caching mechanism - is
> it possible that, since each tile will be *new* (due to the sequential read
> over the dataset), it is somehow cached outside of the gdal cache/ignoring
> the CACHEMAX setting?

It should remain in the blocks managed by the global raster block cache. 
Playing with GDAL_CACHEMAX when doing gdalinfo -checksum, I see it is honoured 
(the top memory consumption of the process lowers when GDAL_CACHEMAX lowers). 
valgrind does not show memleaks either.

> 
> I'm just stabbing in the dark here as I can't really find a reason for it
> yet
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Memory-increase-in-postgis-raster-driv
> er-tp5277284.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 20 06:29:37 2016
From: jamessramm at gmail.com (James Ramm)
Date: Wed, 20 Jul 2016 14:29:37 +0100
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <201607141426.51927.even.rouault@spatialys.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <1468417296568-5276137.post@n6.nabble.com>
 <1468494462462-5276347.post@n6.nabble.com>
 <201607141426.51927.even.rouault@spatialys.com>
Message-ID: <CAEW=KS4U-jGTy9O+F7g04PX72+ovJDXVQvSOSJzpgyjWpZHeYw@mail.gmail.com>

The only 'fix' I can get working is to return a zero-filled array if the
call to VSIFReadL fails in IReadBlock.

Given that ReadBlock checks whether the block index is valid, I think it is
safe to assume that if IReadBlock is called, the data is expected to be
retrievable (i.e. VSIFReadL in IReadBlock would not fail due to a user
requesting a block that is out of bounds as that raise an error much
earlier), is it acceptable to do this?

Any reason for VSIFReadL to fail for a valid block index where an error
would be preferable to a zero'd array?

I also tried to see whether VSIGetRangeStatusL could be of any help.
Interestingly, for the newly created raster (without any data added), it
returns VSI_RANGE_STATUS_DATA for the very first block and
VSI_RANGE_STATUS_HOLE
for subsequent blocks.







On 14 July 2016 at 13:26, Even Rouault <even.rouault at spatialys.com> wrote:

> Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> > I added the following to the end of the Create method in
> > frmts/northwood/grddataset.cpp:
> >
> >
> >     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
>
> --> beware of the potential int32 overflow in nXSize * nYSize
>
> >     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> >               CPLError(CE_Failure, CPLE_FileIO,
> >                               "Failed to allocate space for GRD file");
> >               delete poDS;
> >               return NULL;
> >     }
> >     poDS->FlushCache(); // Write the header to disk.
> >
> > Unfortunately still receiving the error. I wonder if it would be better
> if
> > I explicitly write the zeros with VSIFWriteL?
>
> No, that's what VSIFTruncateL() is supposed to do, in a smarter way
> depending
> on filesystem capabilities.
>
> >
> >
> >
> >
> > --
> > View this message in context:
> >
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp5276136
> > p5276347.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160720/d6765406/attachment-0001.html>

From even.rouault at spatialys.com  Wed Jul 20 06:35:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 15:35:57 +0200
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <CAEW=KS4U-jGTy9O+F7g04PX72+ovJDXVQvSOSJzpgyjWpZHeYw@mail.gmail.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <201607141426.51927.even.rouault@spatialys.com>
 <CAEW=KS4U-jGTy9O+F7g04PX72+ovJDXVQvSOSJzpgyjWpZHeYw@mail.gmail.com>
Message-ID: <201607201535.57813.even.rouault@spatialys.com>

Le mercredi 20 juillet 2016 15:29:37, James Ramm a écrit :
> The only 'fix' I can get working is to return a zero-filled array if the
> call to VSIFReadL fails in IReadBlock.
> 
> Given that ReadBlock checks whether the block index is valid, I think it is
> safe to assume that if IReadBlock is called, the data is expected to be
> retrievable (i.e. VSIFReadL in IReadBlock would not fail due to a user
> requesting a block that is out of bounds as that raise an error much
> earlier), is it acceptable to do this?
> 
> Any reason for VSIFReadL to fail for a valid block index where an error
> would be preferable to a zero'd array?

If the file is corrupted/truncated, it might be appropriate to return an error. 
Or if the operating system doesn't manage to read the block (disk corruption)

I still don't get why VSIFTruncateL() wouldn't do the job. Are you sure you 
are computing correctly the file size when extending it ?

> 
> I also tried to see whether VSIGetRangeStatusL could be of any help.
> Interestingly, for the newly created raster (without any data added), it
> returns VSI_RANGE_STATUS_DATA for the very first block and
> VSI_RANGE_STATUS_HOLE
> for subsequent blocks.

The granularity of the information is linked a disk sector (4 KB ? might 
depend on the filesystem) so it is not surprising that the first block returns 
DATA given there's an header. 

> 
> On 14 July 2016 at 13:26, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> > > I added the following to the end of the Create method in
> > > 
> > > frmts/northwood/grddataset.cpp:
> > >     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
> > 
> > --> beware of the potential int32 overflow in nXSize * nYSize
> > 
> > >     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> > >     
> > >               CPLError(CE_Failure, CPLE_FileIO,
> > >               
> > >                               "Failed to allocate space for GRD file");
> > >               
> > >               delete poDS;
> > >               return NULL;
> > >     
> > >     }
> > >     poDS->FlushCache(); // Write the header to disk.
> > > 
> > > Unfortunately still receiving the error. I wonder if it would be better
> > 
> > if
> > 
> > > I explicitly write the zeros with VSIFWriteL?
> > 
> > No, that's what VSIFTruncateL() is supposed to do, in a smarter way
> > depending
> > on filesystem capabilities.
> > 
> > > --
> > 
> > > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp527613
> > 6
> > 
> > > p5276347.html Sent from the GDAL - Dev mailing list archive at
> > 
> > Nabble.com.
> > 
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 20 06:55:37 2016
From: jamessramm at gmail.com (James Ramm)
Date: Wed, 20 Jul 2016 14:55:37 +0100
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <201607201535.57813.even.rouault@spatialys.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <201607141426.51927.even.rouault@spatialys.com>
 <CAEW=KS4U-jGTy9O+F7g04PX72+ovJDXVQvSOSJzpgyjWpZHeYw@mail.gmail.com>
 <201607201535.57813.even.rouault@spatialys.com>
Message-ID: <CAEW=KS7Nrob4aG_94+Q5fh_C9FcAe=OhNxq+ySMpCwWNQ2AXhQ@mail.gmail.com>

I may very well be computing the file size wrong, my calculation is:

1024 + nXSize * nYSize * 2

1024 is the size of the header. Data on disk is written as an unsigned
short hence * 2.

I think this is correct when comparing with calculation to seek to a given
block offset in IReadBlock/IWriteBlock:

1024 + nRecordSize * static_cast<vsi_l_offset>(nBlockYOff),

Where nRecordSize = nBlockXSize * 2

VSIFTruncateL would be preferred - I will keep looking at it to find what
Im doing wrong.

On 20 July 2016 at 14:35, Even Rouault <even.rouault at spatialys.com> wrote:

> Le mercredi 20 juillet 2016 15:29:37, James Ramm a écrit :
> > The only 'fix' I can get working is to return a zero-filled array if the
> > call to VSIFReadL fails in IReadBlock.
> >
> > Given that ReadBlock checks whether the block index is valid, I think it
> is
> > safe to assume that if IReadBlock is called, the data is expected to be
> > retrievable (i.e. VSIFReadL in IReadBlock would not fail due to a user
> > requesting a block that is out of bounds as that raise an error much
> > earlier), is it acceptable to do this?
> >
> > Any reason for VSIFReadL to fail for a valid block index where an error
> > would be preferable to a zero'd array?
>
> If the file is corrupted/truncated, it might be appropriate to return an
> error.
> Or if the operating system doesn't manage to read the block (disk
> corruption)
>
> I still don't get why VSIFTruncateL() wouldn't do the job. Are you sure you
> are computing correctly the file size when extending it ?
>
> >
> > I also tried to see whether VSIGetRangeStatusL could be of any help.
> > Interestingly, for the newly created raster (without any data added), it
> > returns VSI_RANGE_STATUS_DATA for the very first block and
> > VSI_RANGE_STATUS_HOLE
> > for subsequent blocks.
>
> The granularity of the information is linked a disk sector (4 KB ? might
> depend on the filesystem) so it is not surprising that the first block
> returns
> DATA given there's an header.
>
> >
> > On 14 July 2016 at 13:26, Even Rouault <even.rouault at spatialys.com>
> wrote:
> > > Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> > > > I added the following to the end of the Create method in
> > > >
> > > > frmts/northwood/grddataset.cpp:
> > > >     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
> > >
> > > --> beware of the potential int32 overflow in nXSize * nYSize
> > >
> > > >     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> > > >
> > > >               CPLError(CE_Failure, CPLE_FileIO,
> > > >
> > > >                               "Failed to allocate space for GRD
> file");
> > > >
> > > >               delete poDS;
> > > >               return NULL;
> > > >
> > > >     }
> > > >     poDS->FlushCache(); // Write the header to disk.
> > > >
> > > > Unfortunately still receiving the error. I wonder if it would be
> better
> > >
> > > if
> > >
> > > > I explicitly write the zeros with VSIFWriteL?
> > >
> > > No, that's what VSIFTruncateL() is supposed to do, in a smarter way
> > > depending
> > > on filesystem capabilities.
> > >
> > > > --
> > >
> > > > View this message in context:
> > >
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp527613
> > > 6
> > >
> > > > p5276347.html Sent from the GDAL - Dev mailing list archive at
> > >
> > > Nabble.com.
> > >
> > > > _______________________________________________
> > > > gdal-dev mailing list
> > > > gdal-dev at lists.osgeo.org
> > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160720/d5c2ab01/attachment.html>

From even.rouault at spatialys.com  Wed Jul 20 06:58:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Jul 2016 15:58:11 +0200
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <CAEW=KS7Nrob4aG_94+Q5fh_C9FcAe=OhNxq+ySMpCwWNQ2AXhQ@mail.gmail.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <201607201535.57813.even.rouault@spatialys.com>
 <CAEW=KS7Nrob4aG_94+Q5fh_C9FcAe=OhNxq+ySMpCwWNQ2AXhQ@mail.gmail.com>
Message-ID: <201607201558.11518.even.rouault@spatialys.com>

Le mercredi 20 juillet 2016 15:55:37, James Ramm a écrit :
> I may very well be computing the file size wrong, my calculation is:
> 
> 1024 + nXSize * nYSize * 2

This might perhaps be not the issue in your case, but I warned you before 
about the potential int32 overflow. You should cast one of nXSize or nYSize to 
vsi_l_offset. 


> 
> 1024 is the size of the header. Data on disk is written as an unsigned
> short hence * 2.
> 
> I think this is correct when comparing with calculation to seek to a given
> block offset in IReadBlock/IWriteBlock:
> 
> 1024 + nRecordSize * static_cast<vsi_l_offset>(nBlockYOff),
> 
> Where nRecordSize = nBlockXSize * 2
> 
> VSIFTruncateL would be preferred - I will keep looking at it to find what
> Im doing wrong.
> 
> On 20 July 2016 at 14:35, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le mercredi 20 juillet 2016 15:29:37, James Ramm a écrit :
> > > The only 'fix' I can get working is to return a zero-filled array if
> > > the call to VSIFReadL fails in IReadBlock.
> > > 
> > > Given that ReadBlock checks whether the block index is valid, I think
> > > it
> > 
> > is
> > 
> > > safe to assume that if IReadBlock is called, the data is expected to be
> > > retrievable (i.e. VSIFReadL in IReadBlock would not fail due to a user
> > > requesting a block that is out of bounds as that raise an error much
> > > earlier), is it acceptable to do this?
> > > 
> > > Any reason for VSIFReadL to fail for a valid block index where an error
> > > would be preferable to a zero'd array?
> > 
> > If the file is corrupted/truncated, it might be appropriate to return an
> > error.
> > Or if the operating system doesn't manage to read the block (disk
> > corruption)
> > 
> > I still don't get why VSIFTruncateL() wouldn't do the job. Are you sure
> > you are computing correctly the file size when extending it ?
> > 
> > > I also tried to see whether VSIGetRangeStatusL could be of any help.
> > > Interestingly, for the newly created raster (without any data added),
> > > it returns VSI_RANGE_STATUS_DATA for the very first block and
> > > VSI_RANGE_STATUS_HOLE
> > > for subsequent blocks.
> > 
> > The granularity of the information is linked a disk sector (4 KB ? might
> > depend on the filesystem) so it is not surprising that the first block
> > returns
> > DATA given there's an header.
> > 
> > > On 14 July 2016 at 13:26, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> > > > Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> > > > > I added the following to the end of the Create method in
> > > > > 
> > > > > frmts/northwood/grddataset.cpp:
> > > > >     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
> > > > 
> > > > --> beware of the potential int32 overflow in nXSize * nYSize
> > > > 
> > > > >     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> > > > >     
> > > > >               CPLError(CE_Failure, CPLE_FileIO,
> > > > >               
> > > > >                               "Failed to allocate space for GRD
> > 
> > file");
> > 
> > > > >               delete poDS;
> > > > >               return NULL;
> > > > >     
> > > > >     }
> > > > >     poDS->FlushCache(); // Write the header to disk.
> > > > > 
> > > > > Unfortunately still receiving the error. I wonder if it would be
> > 
> > better
> > 
> > > > if
> > > > 
> > > > > I explicitly write the zeros with VSIFWriteL?
> > > > 
> > > > No, that's what VSIFTruncateL() is supposed to do, in a smarter way
> > > > depending
> > > > on filesystem capabilities.
> > > > 
> > > > > --
> > 
> > > > > View this message in context:
> > http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp527613
> > 
> > > > 6
> > > > 
> > > > > p5276347.html Sent from the GDAL - Dev mailing list archive at
> > > > 
> > > > Nabble.com.
> > > > 
> > > > > _______________________________________________
> > > > > gdal-dev mailing list
> > > > > gdal-dev at lists.osgeo.org
> > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > 
> > > > --
> > > > Spatialys - Geospatial professional services
> > > > http://www.spatialys.com
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Wed Jul 20 07:01:56 2016
From: jamessramm at gmail.com (James Ramm)
Date: Wed, 20 Jul 2016 15:01:56 +0100
Subject: [gdal-dev] Error in GDALWarp to NWT_GRD
In-Reply-To: <201607201558.11518.even.rouault@spatialys.com>
References: <1468417249456-5276136.post@n6.nabble.com>
 <201607201535.57813.even.rouault@spatialys.com>
 <CAEW=KS7Nrob4aG_94+Q5fh_C9FcAe=OhNxq+ySMpCwWNQ2AXhQ@mail.gmail.com>
 <201607201558.11518.even.rouault@spatialys.com>
Message-ID: <CAEW=KS5jXW6Xv2RhdsiwoU4gQtb7uG-pP9SVMDzPQgtpJmUF3Q@mail.gmail.com>

doh! for me - yes you have. I will double check this.

On 20 July 2016 at 14:58, Even Rouault <even.rouault at spatialys.com> wrote:

> Le mercredi 20 juillet 2016 15:55:37, James Ramm a écrit :
> > I may very well be computing the file size wrong, my calculation is:
> >
> > 1024 + nXSize * nYSize * 2
>
> This might perhaps be not the issue in your case, but I warned you before
> about the potential int32 overflow. You should cast one of nXSize or
> nYSize to
> vsi_l_offset.
>
>
> >
> > 1024 is the size of the header. Data on disk is written as an unsigned
> > short hence * 2.
> >
> > I think this is correct when comparing with calculation to seek to a
> given
> > block offset in IReadBlock/IWriteBlock:
> >
> > 1024 + nRecordSize * static_cast<vsi_l_offset>(nBlockYOff),
> >
> > Where nRecordSize = nBlockXSize * 2
> >
> > VSIFTruncateL would be preferred - I will keep looking at it to find what
> > Im doing wrong.
> >
> > On 20 July 2016 at 14:35, Even Rouault <even.rouault at spatialys.com>
> wrote:
> > > Le mercredi 20 juillet 2016 15:29:37, James Ramm a écrit :
> > > > The only 'fix' I can get working is to return a zero-filled array if
> > > > the call to VSIFReadL fails in IReadBlock.
> > > >
> > > > Given that ReadBlock checks whether the block index is valid, I think
> > > > it
> > >
> > > is
> > >
> > > > safe to assume that if IReadBlock is called, the data is expected to
> be
> > > > retrievable (i.e. VSIFReadL in IReadBlock would not fail due to a
> user
> > > > requesting a block that is out of bounds as that raise an error much
> > > > earlier), is it acceptable to do this?
> > > >
> > > > Any reason for VSIFReadL to fail for a valid block index where an
> error
> > > > would be preferable to a zero'd array?
> > >
> > > If the file is corrupted/truncated, it might be appropriate to return
> an
> > > error.
> > > Or if the operating system doesn't manage to read the block (disk
> > > corruption)
> > >
> > > I still don't get why VSIFTruncateL() wouldn't do the job. Are you sure
> > > you are computing correctly the file size when extending it ?
> > >
> > > > I also tried to see whether VSIGetRangeStatusL could be of any help.
> > > > Interestingly, for the newly created raster (without any data added),
> > > > it returns VSI_RANGE_STATUS_DATA for the very first block and
> > > > VSI_RANGE_STATUS_HOLE
> > > > for subsequent blocks.
> > >
> > > The granularity of the information is linked a disk sector (4 KB ?
> might
> > > depend on the filesystem) so it is not surprising that the first block
> > > returns
> > > DATA given there's an header.
> > >
> > > > On 14 July 2016 at 13:26, Even Rouault <even.rouault at spatialys.com>
> > >
> > > wrote:
> > > > > Le jeudi 14 juillet 2016 13:07:42, jramm a écrit :
> > > > > > I added the following to the end of the Create method in
> > > > > >
> > > > > > frmts/northwood/grddataset.cpp:
> > > > > >     vsi_l_offset nFileSize = 1024 + nXSize * nYSize * 2;
> > > > >
> > > > > --> beware of the potential int32 overflow in nXSize * nYSize
> > > > >
> > > > > >     if (VSIFTruncateL(poDS->fp, nFileSize) != 0) {
> > > > > >
> > > > > >               CPLError(CE_Failure, CPLE_FileIO,
> > > > > >
> > > > > >                               "Failed to allocate space for GRD
> > >
> > > file");
> > >
> > > > > >               delete poDS;
> > > > > >               return NULL;
> > > > > >
> > > > > >     }
> > > > > >     poDS->FlushCache(); // Write the header to disk.
> > > > > >
> > > > > > Unfortunately still receiving the error. I wonder if it would be
> > >
> > > better
> > >
> > > > > if
> > > > >
> > > > > > I explicitly write the zeros with VSIFWriteL?
> > > > >
> > > > > No, that's what VSIFTruncateL() is supposed to do, in a smarter way
> > > > > depending
> > > > > on filesystem capabilities.
> > > > >
> > > > > > --
> > >
> > > > > > View this message in context:
> > >
> http://osgeo-org.1560.x6.nabble.com/Error-in-GDALWarp-to-NWT-GRD-tp527613
> > >
> > > > > 6
> > > > >
> > > > > > p5276347.html Sent from the GDAL - Dev mailing list archive at
> > > > >
> > > > > Nabble.com.
> > > > >
> > > > > > _______________________________________________
> > > > > > gdal-dev mailing list
> > > > > > gdal-dev at lists.osgeo.org
> > > > > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > > > >
> > > > > --
> > > > > Spatialys - Geospatial professional services
> > > > > http://www.spatialys.com
> > >
> > > --
> > > Spatialys - Geospatial professional services
> > > http://www.spatialys.com
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160720/1cd93654/attachment-0001.html>

From sablok at amazon.com  Wed Jul 20 10:56:39 2016
From: sablok at amazon.com (sablok)
Date: Wed, 20 Jul 2016 10:56:39 -0700 (PDT)
Subject: [gdal-dev] Getting the following error while building GDAL 2.0.2
	from source
Message-ID: <1469037399650-5277422.post@n6.nabble.com>

I am trying to build GDAL 2.0.2 from source and while building it I am
getting the following make error, I am not too sure why is this happening,
any help is appreciated -:

/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrgeometryfactory.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrpoint.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrcurve.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrlinestring.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrlinearring.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrpolygon.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrutils.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrgeometry.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrgeometrycollection.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrmultipolygon.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrsurface.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrmultipoint.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrmultilinestring.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrcircularstring.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrcompoundcurve.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrcurvepolygon.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrcurvecollection.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrmulticurve.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrmultisurface.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_api.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrfeature.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrfeaturedefn.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrfeaturequery.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrfeaturestyle.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrfielddefn.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrspatialreference.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srsnode.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_proj4.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_fromepsg.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrct.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_opt.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_esri.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_pci.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_usgs.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_dict.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_panorama.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_ozi.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_erm.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq_expr_node.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq_parser.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq_select.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq_op_registrar.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/swq_op_general.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_validate.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_srs_xml.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ograssemblepolygon.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr2gmlgeometry.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/gml2ogrgeometry.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_expat.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrpgeogeometry.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrgeomediageometry.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogr_geocoding.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/osr_cs_wkt.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/osr_cs_wkt_parser.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ogrgeomfielddefn.o
/home/sablok/workspace/sablok/BuildDev/env/GCC-4.9.x/runtime/bin/ld: error:
cannot find ./ogr/.libs/ograpispy.o
collect2: ld returned 1 exit status
make[1]: *** [libgdal.la] Error 1
make[1]: Leaving directory
`/local/home/sablok/workspace/sablok/BuildDev/src/BuildPostGIS/configuration/gdal/gdal-2.0.2'
make: *** [check-lib] Error 2




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Getting-the-following-error-while-building-GDAL-2-0-2-from-source-tp5277422.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hannes.diedrich at gfz-potsdam.de  Thu Jul 21 05:50:06 2016
From: hannes.diedrich at gfz-potsdam.de (hannesd)
Date: Thu, 21 Jul 2016 05:50:06 -0700 (PDT)
Subject: [gdal-dev] Get Metadata from VRT file, store 4D Dataset into VRT
In-Reply-To: <201607141547.38066.even.rouault@spatialys.com>
References: <1468490715155-5276331.post@n6.nabble.com>
 <201607141547.38066.even.rouault@spatialys.com>
Message-ID: <1469105406058-5277581.post@n6.nabble.com>

Hi Even, 

thanks for your quick answer!

I have done the second suggestion you made: First made mosaik vrt files
and then performed gdalbuiltvrt -separate to merge them into a multi band
raster. 

Again two issues:
1. Is there a way to retrieve the metadata from the mosaik vrt files without
actually loading them 
into python gdal?

2. In general: I find it hard to use gdal.GetMetadataItem() and
gdal.SetMetdadatItem() or i did not get the Idea yet.

This is how my vrt file looks:
/ <VRTDataset rasterXSize="20976" rasterYSize="80982">
  <SRS>PROJCS["WGS 84 / UTM zone 32N",GEOGCS["WGS
84",DATUM["WGS_1984",SPHEROID["WGS
84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]],AXIS["Latitude",NORTH],AXIS["Longitude",EAST],AUTHORITY["EPSG","4326"]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",9],PARAMETER["scale_factor",0.9996],PARAMETER["false_easting",500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH],AUTHORITY["EPSG","32632"]]</SRS>
  <GeoTransform>  6.0000000000000000e+05,  1.0000000000000000e+01, 
0.0000000000000000e+00,  6.1000200000000000e+06,  0.0000000000000000e+00,
-1.0000000000000000e+01</GeoTransform>
  <VRTRasterBand dataType="UInt16" band="1">
    <SimpleSource>
      <SourceFilename relativeToVRT="1">20160628.vrt</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="20976" RasterYSize="40980"
DataType="UInt16" BlockXSize="128" BlockYSize="128" />
      <SrcRect xOff="0" yOff="0" xSize="20976" ySize="40980" />
      <DstRect xOff="0" yOff="40002" xSize="20976" ySize="40980" />
    </SimpleSource>
  </VRTRasterBand>
  <VRTRasterBand dataType="UInt16" band="2">
    <SimpleSource>
      <SourceFilename relativeToVRT="1">20160701.vrt</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="10980" RasterYSize="80982"
DataType="UInt16" BlockXSize="128" BlockYSize="128" />
      <SrcRect xOff="0" yOff="0" xSize="10980" ySize="80982" />
      <DstRect xOff="0" yOff="0" xSize="10980" ySize="80982" />
    </SimpleSource>
  </VRTRasterBand>
</VRTDataset>/

How can I get e.g. the value of the "SourceProperties" information?
This is what I did in Python:
ds= gdal.Open(vrtfile, gc.GA_ReadOnly )
band=ds.GetRasterBand(1)
mdi=band.GetMetadataItem("SourceProperties")

Unfortunately it returns nothing.
Of course I can read the xml file with e.g. xml.etree.ElementTree but
shouldn't it be possible with gdal as well?

Thanks again!
Hannes




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Get-Metadata-from-VRT-file-store-4D-Dataset-into-VRT-tp5276331p5277581.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From Odd-Ragnar.Lydersen at powel.no  Thu Jul 21 06:36:12 2016
From: Odd-Ragnar.Lydersen at powel.no (Odd Ragnar Lydersen)
Date: Thu, 21 Jul 2016 13:36:12 +0000
Subject: [gdal-dev] C++ API for WCS: GetCapabilities and GDALOpen()
Message-ID: <BD69AB4022C5C34DAC908920605A87025A4EFE02@MAIL.powelasa.powel.com>

This is probably a stupid question, but I'm wondering if the WCS driver is missing something.

1) I have used the WFS driver, and the description xml file, which caches the GetCapabilitis result, so that I can get info from that file later.

2) The corresponding description xml file for the WCS driver does not support any calls to GetCapabilities. 
I'm required to give <CoverageName>SomeCoverage</CoverageName>, before I really know the name of the coverage. 
I can't give the GetCapabilities request in the url either. That results in an error from GDAL.

If I'm to open a new WCS in my program and list all available coverages, then I need to call GetCapabilities first. 
Does GDAL fetch this for me in some way, or do I have to parse the result from GetFeatureInfo in a separate routine?

Shouldn't the first call to GDALOpen() get the capabilitis for a given WCS, like it does for WFS?

PS! I'm using GDAL 1.11.1

>Odd-Ragnar<




From even.rouault at spatialys.com  Thu Jul 21 07:00:39 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Jul 2016 16:00:39 +0200
Subject: [gdal-dev] C++ API for WCS: GetCapabilities and GDALOpen()
In-Reply-To: <BD69AB4022C5C34DAC908920605A87025A4EFE02@MAIL.powelasa.powel.com>
References: <BD69AB4022C5C34DAC908920605A87025A4EFE02@MAIL.powelasa.powel.com>
Message-ID: <201607211600.39883.even.rouault@spatialys.com>

Odd-Ragnar,

> Does GDAL fetch this for me in
> some way, or do I have to parse the result from GetFeatureInfo in a
> separate routine?
--> you meant GetCapabilities, not GetFeatureInfo right ?
> 
> Shouldn't the first call to GDALOpen() get the capabilitis for a given WCS,
> like it does for WFS?

your observations are true. The WCS driver doesn't support the GetCapabilities 
request currently. If it would, it should likely return the various available 
coverages as subdatasets, as the WMS driver does.

$ gdalinfo "WMS:http://demo.opengeo.org/geoserver/gwc/service/wms?"
Driver: WMS/OGC Web Map Service
Files: none associated
Size is 512, 512
Coordinate System is `'
Subdatasets:
  SUBDATASET_1_NAME=WMS:http://demo.opengeo.org/geoserver/gwc/service/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=og%3Astreams&SRS=EPSG:900913&BBOX=-1.15841845090625E7,5479006.186718751,-1.1505912992109375E7,5557277.703671876
  SUBDATASET_1_DESC=streams
  SUBDATASET_2_NAME=WMS:http://demo.opengeo.org/geoserver/gwc/service/wms?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS=og%3Aarchsites&SRS=EPSG:4326&BBOX=-104.0625,44.296875,-103.359375,45.0
  SUBDATASET_2_DESC=archsites
[...]

Place for improvement for those who want to contribute code or funding.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From yjacolin at free.fr  Thu Jul 21 08:37:31 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Thu, 21 Jul 2016 17:37:31 +0200
Subject: [gdal-dev] JP2 Segfault
Message-ID: <1603529.FRSvTi0Q8z@tatras>

Hello,

I am working on some JP2 data (total 262 Go) . I started creating a vrt file 
and then "gdal_translate" them.

I always have a segfault. I tried to use a GDAL_SKIP config to use another 
driver but it seems that I can successfully do this:

>> Stack trace in bt <<

Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW --
config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co COMPRESS=JPEG -
co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt 
ORTHO_EXPRESS_2015.tif
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
Input file size is 470000, 640000
0[New Thread 0x7fffd0278700 (LWP 14580)]
[New Thread 0x7fffcfa77700 (LWP 14581)]
[New Thread 0x7fffcf276700 (LWP 14582)]
[New Thread 0x7fffcea75700 (LWP 14583)]

Program received signal SIGSEGV, Segmentation fault.
0x00007ffff10ba0f9 in CNCSJPCPacket::ParseHeader(CNCSJPC&, CNCSJPCIOStream&, 
CNCSJPCProgression*, bool, bool*) () from /usr/local/lib/libNCSEcw.so.0
(gdb) bt
#0  0x00007ffff10ba0f9 in CNCSJPCPacket::ParseHeader(CNCSJPC&, CNCSJPCIOStream&, 
CNCSJPCProgression*, bool, bool*) () from /usr/local/lib/libNCSEcw.so.0
#1  0x00007ffff10c20b1 in CNCSJPCPrecinct::ReadPackets() () from 
/usr/local/lib/libNCSEcw.so.0
#2  0x00007ffff10c1c5b in CNCSJPCPrecinct::CreateSubBands(bool) () from 
/usr/local/lib/libNCSEcw.so.0

>> end of bt <<

Using  --config GDAL_SKIP ECW doesn't change anything.

I can't understand two things:

* first: why libNCSEcw is used instead of openjpeg200 lib?
* second: what kind of problem could trigger this kind of segfault?

I am using GDAL 2.1.1 :)

Thanks for any help,

Y.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 490 bytes
Desc: This is a digitally signed message part.
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160721/01814748/attachment.sig>

From even.rouault at spatialys.com  Thu Jul 21 11:51:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 Jul 2016 20:51:58 +0200
Subject: [gdal-dev] JP2 Segfault
In-Reply-To: <1603529.FRSvTi0Q8z@tatras>
References: <1603529.FRSvTi0Q8z@tatras>
Message-ID: <201607212051.58663.even.rouault@spatialys.com>

Salut Yves,

> Using  --config GDAL_SKIP ECW doesn't change anything.

The name of the driver in that instance is JP2ECW . ECW is for .ecw files

> 
> I can't understand two things:
> 
> * first: why libNCSEcw is used instead of openjpeg200 lib?

Answered above

> * second: what kind of problem could trigger this kind of segfault?

Probaby a bug in the SDK itself. Is it with the old 3.3 version ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jul 21 14:23:31 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 21 Jul 2016 21:23:31 +0000 (UTC)
Subject: [gdal-dev] JP2 Segfault
References: <1603529.FRSvTi0Q8z@tatras>
Message-ID: <loom.20160721T231656-750@post.gmane.org>

Yves Jacolin <yjacolin <at> free.fr> writes:

> 
> Hello,
> 
> I am working on some JP2 data (total 262 Go) . I started creating a vrt file 
> and then "gdal_translate" them.
> 
> I always have a segfault. I tried to use a GDAL_SKIP config to use another 
> driver but it seems that I can successfully do this:
> 
> >> Stack trace in bt <<
> 
> Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW --
> config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co COMPRESS=JPEG -
> co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt 
> ORTHO_EXPRESS_2015.tif

...
clip
...

> Using  --config GDAL_SKIP ECW doesn't change anything.
> 
> I can't understand two things:
> 
> * first: why libNCSEcw is used instead of openjpeg200 lib?

You have used two times the GDAL_SKIP config option 

--config GDAL_SKIP JP2ECW --config GDAL_SKIP ECW

In https://trac.osgeo.org/gdal/wiki/ConfigOptions#GDAL_SKIP it is documented
that for skipping several drivers a comma separated list is needed:

"The value of this option must be a space delimited list of the short name
of the GDAL drivers to unregister."

I suppose that with your command only the ECW driver gets skipped and that
is not for JPEG2000 at all. Using just one option (or a list) as --config
GDAL_SKIP JP2ECW should help you.

-Jukka Rahkonen-


From yjacolin at free.fr  Fri Jul 22 00:38:28 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Fri, 22 Jul 2016 09:38:28 +0200
Subject: [gdal-dev] JP2 Segfault
In-Reply-To: <loom.20160721T231656-750@post.gmane.org>
References: <1603529.FRSvTi0Q8z@tatras>
 <loom.20160721T231656-750@post.gmane.org>
Message-ID: <1535185.p3sXkgZ6bB@tatras>

Even, Jukka,

Thank both of you. 

@Even, I though that I get this kind of  issue :) I checked my formats list, 
but maybe at the end of the day, my eyes were tired.

@Jukka, I did not use two --config flags at the same time, but this information 
is a great confirmation how to manage such multi config flag, definitively useful 
for next time.

Thanks again,

Y.

On Thursday, July 21, 2016 21:23:31 Jukka Rahkonen wrote:
> Yves Jacolin <yjacolin <at> free.fr> writes:
> > Hello,
> > 
> > I am working on some JP2 data (total 262 Go) . I started creating a vrt
> > file and then "gdal_translate" them.
> > 
> > I always have a segfault. I tried to use a GDAL_SKIP config to use another
> > 
> > driver but it seems that I can successfully do this:
> > >> Stack trace in bt <<
> > 
> > Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW
> > -- config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co
> > COMPRESS=JPEG - co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt
> > ORTHO_EXPRESS_2015.tif
> 
> ...
> clip
> ...
> 
> > Using  --config GDAL_SKIP ECW doesn't change anything.
> > 
> > I can't understand two things:
> > 
> > * first: why libNCSEcw is used instead of openjpeg200 lib?
> 
> You have used two times the GDAL_SKIP config option
> 
> --config GDAL_SKIP JP2ECW --config GDAL_SKIP ECW
> 
> In https://trac.osgeo.org/gdal/wiki/ConfigOptions#GDAL_SKIP it is documented
> that for skipping several drivers a comma separated list is needed:
> 
> "The value of this option must be a space delimited list of the short name
> of the GDAL drivers to unregister."
> 
> I suppose that with your command only the ECW driver gets skipped and that
> is not for JPEG2000 at all. Using just one option (or a list) as --config
> GDAL_SKIP JP2ECW should help you.
> 
> -Jukka Rahkonen-
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jamessramm at gmail.com  Fri Jul 22 00:26:29 2016
From: jamessramm at gmail.com (jramm)
Date: Fri, 22 Jul 2016 00:26:29 -0700 (PDT)
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <201607111731.59285.even.rouault@spatialys.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <alpine.LRH.2.20.1607091728190.12814@warden.aitchison.me.uk>
 <201607101154.17484.even.rouault@spatialys.com>
 <CACmBxyv9JT21VQC5-Q4wTEOMeFwyiYsT1BcD7L66eBXbpeJnwQ@mail.gmail.com>
 <201607111731.59285.even.rouault@spatialys.com>
Message-ID: <1469172389159-5277676.post@n6.nabble.com>

Forgive me a newbie question but I'm not so familiar with the RFC process:

- Is there any kind of timescale for this appearing in trunk or what needs
to happen for that to happen?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-63-Sparse-datasets-improvements-tp5275443p5277676.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jacek.tomaka at hexagongeospatial.com  Fri Jul 22 02:26:44 2016
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Fri, 22 Jul 2016 09:26:44 +0000
Subject: [gdal-dev] JP2 Segfault
In-Reply-To: <1535185.p3sXkgZ6bB@tatras>
References: <1603529.FRSvTi0Q8z@tatras>
 <loom.20160721T231656-750@post.gmane.org>,<1535185.p3sXkgZ6bB@tatras>
Message-ID: <3ED562F633B1AE46BF141E903F9813079A9CA82E@ap-mbx3.ingrnet.com>

Yves, 
Have you tried ECW JPEG 2000 SDK 5.2 or 5.3? Is there a reason why you are still using old 3.3 version? 

Every version of the SDK contains quite a few improvements and we would also be interested in learning about the problems encountered in the supported version of the ECW Jp2 SDK. 

There is a license allowing reading ECW and JP2 in non server scenarios without any cost.  

Please note that i work for the vendor of ECW JPEG2000 SDK. 

Regards.
Jacek Tomaka
________________________________
Od: gdal-dev [gdal-dev-bounces at lists.osgeo.org] w imieniu Yves Jacolin [yjacolin at free.fr]
Wysłano: 22 lipca 2016 15:38
Do: gdal-dev at lists.osgeo.org
DW: Jukka Rahkonen
Temat: Re: [gdal-dev] JP2 Segfault

Even, Jukka,

Thank both of you.

@Even, I though that I get this kind of  issue :) I checked my formats list,
but maybe at the end of the day, my eyes were tired.

@Jukka, I did not use two --config flags at the same time, but this information
is a great confirmation how to manage such multi config flag, definitively useful
for next time.

Thanks again,

Y.

On Thursday, July 21, 2016 21:23:31 Jukka Rahkonen wrote:
> Yves Jacolin <yjacolin <at> free.fr> writes:
> > Hello,
> >
> > I am working on some JP2 data (total 262 Go) . I started creating a vrt
> > file and then "gdal_translate" them.
> >
> > I always have a segfault. I tried to use a GDAL_SKIP config to use another
> >
> > driver but it seems that I can successfully do this:
> > >> Stack trace in bt <<
> >
> > Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW
> > -- config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co
> > COMPRESS=JPEG - co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt
> > ORTHO_EXPRESS_2015.tif
>
> ...
> clip
> ...
>
> > Using  --config GDAL_SKIP ECW doesn't change anything.
> >
> > I can't understand two things:
> >
> > * first: why libNCSEcw is used instead of openjpeg200 lib?
>
> You have used two times the GDAL_SKIP config option
>
> --config GDAL_SKIP JP2ECW --config GDAL_SKIP ECW
>
> In https://trac.osgeo.org/gdal/wiki/ConfigOptions#GDAL_SKIP it is documented
> that for skipping several drivers a comma separated list is needed:
>
> "The value of this option must be a space delimited list of the short name
> of the GDAL drivers to unregister."
>
> I suppose that with your command only the ECW driver gets skipped and that
> is not for JPEG2000 at all. Using just one option (or a list) as --config
> GDAL_SKIP JP2ECW should help you.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev



From even.rouault at spatialys.com  Fri Jul 22 03:10:44 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Jul 2016 12:10:44 +0200
Subject: [gdal-dev] Call for discussion on RFC 63 : Sparse datasets
	improvements
In-Reply-To: <1469172389159-5277676.post@n6.nabble.com>
References: <201607081631.11872.even.rouault@spatialys.com>
 <201607111731.59285.even.rouault@spatialys.com>
 <1469172389159-5277676.post@n6.nabble.com>
Message-ID: <201607221210.44758.even.rouault@spatialys.com>

All,

I've updated the proposed implementation and the RFC, mostly on improving 
documentation based on the feedback of this thread.

One point I've had in mind, but didn't implement, is the possibility of having 
a GetDataCoverageStatus() at the dataset level, in addition to the raster band 
level. Could potentially be useful for pixel-interleaved datasets, but that 
can be added later if needed. But if you work with a pixel-interleaved 
GeoTIFF, you can emulate that by just calling GetDataCoverageStatus() on the 
first band.

If there are no further remarks, I'll call for a vote.

Best regards,

Even

> Forgive me a newbie question but I'm not so familiar with the RFC process:
> 
> - Is there any kind of timescale for this appearing in trunk or what needs
> to happen for that to happen?
> 
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Call-for-discussion-on-RFC-63
> -Sparse-datasets-improvements-tp5275443p5277676.html Sent from the GDAL -
> Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Fri Jul 22 03:28:15 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 22 Jul 2016 10:28:15 +0000 (UTC)
Subject: [gdal-dev] JP2 Segfault
References: <1603529.FRSvTi0Q8z@tatras>
 <loom.20160721T231656-750@post.gmane.org> <1535185.p3sXkgZ6bB@tatras>
Message-ID: <loom.20160722T122452-232@post.gmane.org>

Yves Jacolin <yjacolin <at> free.fr> writes:


> 
>  <at> Jukka, I did not use two --config flags at the same time, but this
information 
> is a great confirmation how to manage such multi config flag, definitively
useful 
> for next time.

Hi Yves,

I was carefully reading your first mail which did have two --config flags in
the debug info but perhaps it was just a copy-paste error:

Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW --
config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co COMPRESS=JPEG -
co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt 
ORTHO_EXPRESS_2015.tif

-Jukka-


From yjacolin at free.fr  Fri Jul 22 04:07:46 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Fri, 22 Jul 2016 13:07:46 +0200
Subject: [gdal-dev] JP2 Segfault
In-Reply-To: <loom.20160722T122452-232@post.gmane.org>
References: <1603529.FRSvTi0Q8z@tatras> <1535185.p3sXkgZ6bB@tatras>
 <loom.20160722T122452-232@post.gmane.org>
Message-ID: <3952624.Zhs7xVvc56@tatras>

On Friday, July 22, 2016 10:28:15 Jukka Rahkonen wrote:
> Yves Jacolin <yjacolin <at> free.fr> writes:
> >  <at> Jukka, I did not use two --config flags at the same time, but this
> 
> information
> 
> > is a great confirmation how to manage such multi config flag, definitively
> 
> useful
> 
> > for next time.
> 
> Hi Yves,
> 
> I was carefully reading your first mail which did have two --config flags in
> the debug info but perhaps it was just a copy-paste error:
> 
> Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP JP2ECW --
> config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co
> COMPRESS=JPEG - co TILED=YES -co PHOTOMETRIC=YCBCR ORTHO_EXPRESS_2015.vrt
> ORTHO_EXPRESS_2015.tif

ah! Good catch :) Too much number of test, I guess. It seems I was pretty 
close to the solution ;)

Thanks,

Y.


From yjacolin at free.fr  Fri Jul 22 02:36:21 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Fri, 22 Jul 2016 11:36:21 +0200
Subject: [gdal-dev] JP2 Segfault
In-Reply-To: <3ED562F633B1AE46BF141E903F9813079A9CA82E@ap-mbx3.ingrnet.com>
References: <1603529.FRSvTi0Q8z@tatras> <1535185.p3sXkgZ6bB@tatras>
 <3ED562F633B1AE46BF141E903F9813079A9CA82E@ap-mbx3.ingrnet.com>
Message-ID: <2365227.bqXeHVA7gl@tatras>

Tomaka,

I am using gdal with docker (https://hub.docker.com/r/homme/gdal/). I did not 
build gdal by myself even if I am able to do it but I have to use a docker 
container as we are in such infrastructure.

Anyway, using SDK 5.3 could be a solution if openjpeg lib is not fast enough.

Y.


On Friday, July 22, 2016 9:26:44 Tomaka, Jacek wrote:
> Yves,
> Have you tried ECW JPEG 2000 SDK 5.2 or 5.3? Is there a reason why you are
> still using old 3.3 version?
> 
> Every version of the SDK contains quite a few improvements and we would also
> be interested in learning about the problems encountered in the supported
> version of the ECW Jp2 SDK.
> 
> There is a license allowing reading ECW and JP2 in non server scenarios
> without any cost.
> 
> Please note that i work for the vendor of ECW JPEG2000 SDK.
> 
> Regards.
> Jacek Tomaka
> ________________________________
> Od: gdal-dev [gdal-dev-bounces at lists.osgeo.org] w imieniu Yves Jacolin
> [yjacolin at free.fr] Wysłano: 22 lipca 2016 15:38
> Do: gdal-dev at lists.osgeo.org
> DW: Jukka Rahkonen
> Temat: Re: [gdal-dev] JP2 Segfault
> 
> Even, Jukka,
> 
> Thank both of you.
> 
> @Even, I though that I get this kind of  issue :) I checked my formats list,
> but maybe at the end of the day, my eyes were tired.
> 
> @Jukka, I did not use two --config flags at the same time, but this
> information is a great confirmation how to manage such multi config flag,
> definitively useful for next time.
> 
> Thanks again,
> 
> Y.
> 
> On Thursday, July 21, 2016 21:23:31 Jukka Rahkonen wrote:
> > Yves Jacolin <yjacolin <at> free.fr> writes:
> > > Hello,
> > > 
> > > I am working on some JP2 data (total 262 Go) . I started creating a vrt
> > > file and then "gdal_translate" them.
> > > 
> > > I always have a segfault. I tried to use a GDAL_SKIP config to use
> > > another
> > > 
> > > driver but it seems that I can successfully do this:
> > > >> Stack trace in bt <<
> > > 
> > > Starting program: /usr/local/bin/gdal_translate --config GDAL_SKIP
> > > JP2ECW
> > > -- config GDAL_SKIP ECW -a_srs EPSG:2154 -co BIGTIFF=IF_SAFER -co
> > > COMPRESS=JPEG - co TILED=YES -co PHOTOMETRIC=YCBCR
> > > ORTHO_EXPRESS_2015.vrt
> > > ORTHO_EXPRESS_2015.tif
> > 
> > ...
> > clip
> > ...
> > 
> > > Using  --config GDAL_SKIP ECW doesn't change anything.
> > > 
> > > I can't understand two things:
> > > 
> > > * first: why libNCSEcw is used instead of openjpeg200 lib?
> > 
> > You have used two times the GDAL_SKIP config option
> > 
> > --config GDAL_SKIP JP2ECW --config GDAL_SKIP ECW
> > 
> > In https://trac.osgeo.org/gdal/wiki/ConfigOptions#GDAL_SKIP it is
> > documented that for skipping several drivers a comma separated list is
> > needed:
> > 
> > "The value of this option must be a space delimited list of the short name
> > of the GDAL drivers to unregister."
> > 
> > I suppose that with your command only the ECW driver gets skipped and that
> > is not for JPEG2000 at all. Using just one option (or a list) as --config
> > GDAL_SKIP JP2ECW should help you.
> > 
> > -Jukka Rahkonen-
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jukka.rahkonen at maanmittauslaitos.fi  Sat Jul 23 00:35:32 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Sat, 23 Jul 2016 07:35:32 +0000 (UTC)
Subject: [gdal-dev] GDAL reads ESRI MultiLinestring as simple Linestring
Message-ID: <loom.20160723T092759-56@post.gmane.org>

Hi,

I was reading the documentation of ESRI json from
http://resources.arcgis.com/en/help/rest/apiref/geometry.html and this
example seems to be about a MultiLinestring with two parts:

A 2D polyline

{
"paths" : [ 
 [ [-97.06138,32.837], [-97.06133,32.836], [-97.06124,32.834],
[-97.06127,32.832] ], 
 [ [-97.06326,32.759], [-97.06298,32.755] ]
],
"spatialReference" : {"wkid" : 4326}
}

However, GDAL reads the geometry as a single Linestring when I bake the
paths inside a json document. I wrote the document by hand and I am not sure
if it is correct but at least GDAL reads it:

{
 
 "geometryType": "esriGeometryPolyline",
 "spatialReference": {
  "wkid": 4326,
  "latestWkid": 4326
 },
 "fields": [
   ],
 "features": [
  {
   "attributes": {
   },
   "geometry": {
"paths" : [ 
 [ [-97.06138,32.837], [-97.06133,32.836], [-97.06124,32.834],
[-97.06127,32.832] ], 
 [ [-97.06326,32.759], [-97.06298,32.755] ]
],
"spatialReference" : {"wkid" : 4326}
}
        }
       ]
}

-Jukka Rahkonen-




From 191980 at niuitmo.ru  Sun Jul 24 08:27:46 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 24 Jul 2016 15:27:46 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 9]
Message-ID: <E4F539A9-0313-4BFF-AD97-F400381664EC@niuitmo.ru>

Blogpost link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-9-report.html> (full copy of report is below).


1. This week I've done:

OGR CAD Driver changes:

- Implemented python autotests for CAD driver (more than half of the tests are done, a small part will be done next week).

- Finally a lwpolyline tesselation (now it can have arc segments).
- Text geometries now sets up OGR Style String to LABEL(…) with correct params.
- Arc geometry reading fix.

- Small code refactoring and cleaning.


2. Plan on doing next week:

Complete python tests, testing driver with QGIS, code refactoring. Fix windows, try to fix travis build.


3. Blocking:

None.


Best regards,

Alexandr Borzykh


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160724/2070b6c5/attachment.html>

From aperi2007 at gmail.com  Mon Jul 25 07:51:13 2016
From: aperi2007 at gmail.com (Andrea Peri)
Date: Mon, 25 Jul 2016 16:51:13 +0200
Subject: [gdal-dev] Create a new shapefile using ogr utilities
Message-ID: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>

Hi,
is possible create a new empty shapefile using the ogr utilities.

I search and try using ogrinfo and a sql like "create table ..." but
without any success.

Thx.


-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty àèìòù
-----------------

From damian.dixon at gmail.com  Mon Jul 25 07:53:18 2016
From: damian.dixon at gmail.com (Damian Dixon)
Date: Mon, 25 Jul 2016 15:53:18 +0100
Subject: [gdal-dev] Combining multiple rasters using GDAL Warp API
Message-ID: <CAJjdW1xoacLuFDK_E7m9yqPKPXFio-FnvpVYr8dF5EPeiYYmxw@mail.gmail.com>

Hi,

I would like to combine multiple adjacent or overlapping rasters.

They will all be in the same projection, image format and the output
projection will be the same as the source data.

I believe that this is possible using the command line utility gdalwarp as
it can take multiple source files.

I am wondering how to do this through the GDAL Warp API as you can only
specify a single source file:

psWarpOptions->hSrcDS
<http://www.gdal.org/structGDALWarpOptions.html#a65f68e1cf7ca641c5d0a93762d0416d5>
= hSrcDS;


according to the tutorial.


Any hints or suggestions on how to pass multiple files to the Warp API
would be very helpful.

Thanks
Damian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160725/4453ed74/attachment.html>

From aperi2007 at gmail.com  Mon Jul 25 08:00:15 2016
From: aperi2007 at gmail.com (Andrea Peri)
Date: Mon, 25 Jul 2016 17:00:15 +0200
Subject: [gdal-dev] Create a new shapefile using ogr utilities
In-Reply-To: <489822679.1tqCRifNMZ@tatras>
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
 <489822679.1tqCRifNMZ@tatras>
Message-ID: <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>

Thx for response,
There is an executable for windows downloadable ?

Thx.


2016-07-25 16:53 GMT+02:00 Yves Jacolin <yjacolin at free.fr>:
> On Monday, July 25, 2016 16:51:13 Andrea Peri wrote:
>> Hi,
>> is possible create a new empty shapefile using the ogr utilities.
>>
>> I search and try using ogrinfo and a sql like "create table ..." but
>> without any success.
>>
>> Thx.
> Andrea,
>
> You can also use shpcreate (and then shpadd) from shapelib package.
>
> Y.



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty àèìòù
-----------------

From jmckenna at gatewaygeomatics.com  Mon Jul 25 08:09:55 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 25 Jul 2016 12:09:55 -0300
Subject: [gdal-dev] Create a new shapefile using ogr utilities
In-Reply-To: <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
 <489822679.1tqCRifNMZ@tatras>
 <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>
Message-ID: <146479d0-527a-bb97-15df-9e5cf9674b15@gatewaygeomatics.com>

Yes, the Shapelib utilities have always been included (for the past 14 
years) in MS4W: http://ms4w.com/

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/




On 2016-07-25 12:00 PM, Andrea Peri wrote:
> Thx for response,
> There is an executable for windows downloadable ?
>
> Thx.
>
>
> 2016-07-25 16:53 GMT+02:00 Yves Jacolin <yjacolin at free.fr>:
>> On Monday, July 25, 2016 16:51:13 Andrea Peri wrote:
>>> Hi,
>>> is possible create a new empty shapefile using the ogr utilities.
>>>
>>> I search and try using ogrinfo and a sql like "create table ..." but
>>> without any success.
>>>
>>> Thx.
>> Andrea,
>>
>> You can also use shpcreate (and then shpadd) from shapelib package.
>>
>> Y.
>
>
>



From yjacolin at free.fr  Mon Jul 25 08:04:55 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Mon, 25 Jul 2016 17:04:55 +0200
Subject: [gdal-dev] Create a new shapefile using ogr utilities
In-Reply-To: <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
 <489822679.1tqCRifNMZ@tatras>
 <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>
Message-ID: <8352400.HK20ZQMZgR@tatras>

On Monday, July 25, 2016 17:00:15 Andrea Peri wrote:
> Thx for response,
> There is an executable for windows downloadable ?
> 
> Thx.
> 
> 2016-07-25 16:53 GMT+02:00 Yves Jacolin <yjacolin at free.fr>:
> > On Monday, July 25, 2016 16:51:13 Andrea Peri wrote:
> >> Hi,
> >> is possible create a new empty shapefile using the ogr utilities.
> >> 
> >> I search and try using ogrinfo and a sql like "create table ..." but
> >> without any success.
> >> 
> >> Thx.
> > 
> > Andrea,
> > 
> > You can also use shpcreate (and then shpadd) from shapelib package.
> > 
> > Y.
You can find something here: 
http://dl.maptools.org/dl/osgeo4w/release/shapelib/

Y.

From daniele.romagnoli at geo-solutions.it  Mon Jul 25 08:28:35 2016
From: daniele.romagnoli at geo-solutions.it (Daniele Romagnoli)
Date: Mon, 25 Jul 2016 17:28:35 +0200
Subject: [gdal-dev] Combining multiple rasters using GDAL Warp API
In-Reply-To: <CAJjdW1xoacLuFDK_E7m9yqPKPXFio-FnvpVYr8dF5EPeiYYmxw@mail.gmail.com>
References: <CAJjdW1xoacLuFDK_E7m9yqPKPXFio-FnvpVYr8dF5EPeiYYmxw@mail.gmail.com>
Message-ID: <CAJaHrDxFisH_Kw9W2Ck_rUdQbktJmgYM5_5XzgrrZDOWN-BUWg@mail.gmail.com>

Hi Damian,
I'm probably going off-topic but, did you consider setting up an
intermediate VRT built on top of your sources?

Cheers,
Daniele

On Mon, Jul 25, 2016 at 4:53 PM, Damian Dixon <damian.dixon at gmail.com>
wrote:

> Hi,
>
> I would like to combine multiple adjacent or overlapping rasters.
>
> They will all be in the same projection, image format and the output
> projection will be the same as the source data.
>
> I believe that this is possible using the command line utility gdalwarp as
> it can take multiple source files.
>
> I am wondering how to do this through the GDAL Warp API as you can only
> specify a single source file:
>
> psWarpOptions->hSrcDS
> <http://www.gdal.org/structGDALWarpOptions.html#a65f68e1cf7ca641c5d0a93762d0416d5>
> = hSrcDS;
>
>
> according to the tutorial.
>
>
> Any hints or suggestions on how to pass multiple files to the Warp API
> would be very helpful.
>
> Thanks
> Damian
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Daniele Romagnoli
Senior Software Engineer

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax:      +39 0584 1660272

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160725/2783b83b/attachment-0001.html>

From aperi2007 at gmail.com  Mon Jul 25 08:34:01 2016
From: aperi2007 at gmail.com (Andrea Peri)
Date: Mon, 25 Jul 2016 17:34:01 +0200
Subject: [gdal-dev] Create a new shapefile using ogr utilities
In-Reply-To: <8352400.HK20ZQMZgR@tatras>
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
 <489822679.1tqCRifNMZ@tatras>
 <CABqTJk_U9KUH8F6U9Q5FKXY3HTcLN1kfzC+tzeuE=o1bcSi8FA@mail.gmail.com>
 <8352400.HK20ZQMZgR@tatras>
Message-ID: <CABqTJk-FpK9QZnWAijibn9xn=o3F6fE=XNwzjbO=L=q=KVYZVQ@mail.gmail.com>

Downloaded and tested.
It is exactly what I need.
Thx,
A.


2016-07-25 17:04 GMT+02:00 Yves Jacolin <yjacolin at free.fr>:
> On Monday, July 25, 2016 17:00:15 Andrea Peri wrote:
>> Thx for response,
>> There is an executable for windows downloadable ?
>>
>> Thx.
>>
>> 2016-07-25 16:53 GMT+02:00 Yves Jacolin <yjacolin at free.fr>:
>> > On Monday, July 25, 2016 16:51:13 Andrea Peri wrote:
>> >> Hi,
>> >> is possible create a new empty shapefile using the ogr utilities.
>> >>
>> >> I search and try using ogrinfo and a sql like "create table ..." but
>> >> without any success.
>> >>
>> >> Thx.
>> >
>> > Andrea,
>> >
>> > You can also use shpcreate (and then shpadd) from shapelib package.
>> >
>> > Y.
> You can find something here:
> http://dl.maptools.org/dl/osgeo4w/release/shapelib/
>
> Y.



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty àèìòù
-----------------

From damian.dixon at gmail.com  Mon Jul 25 08:39:31 2016
From: damian.dixon at gmail.com (Damian Dixon)
Date: Mon, 25 Jul 2016 16:39:31 +0100
Subject: [gdal-dev] Combining multiple rasters using GDAL Warp API
In-Reply-To: <CAJaHrDxFisH_Kw9W2Ck_rUdQbktJmgYM5_5XzgrrZDOWN-BUWg@mail.gmail.com>
References: <CAJjdW1xoacLuFDK_E7m9yqPKPXFio-FnvpVYr8dF5EPeiYYmxw@mail.gmail.com>
 <CAJaHrDxFisH_Kw9W2Ck_rUdQbktJmgYM5_5XzgrrZDOWN-BUWg@mail.gmail.com>
Message-ID: <CAJjdW1yL=Jx96bgW1TP2k8c3j2J73S5Rko304nbRZ2ZQacuPrw@mail.gmail.com>

Hi Daniele,

VRT looks a possibility. The VRT format tutorial shows how to do this
programatically:

http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation



Thanks
Damian

On 25 July 2016 at 16:28, Daniele Romagnoli <
daniele.romagnoli at geo-solutions.it> wrote:

> Hi Damian,
> I'm probably going off-topic but, did you consider setting up an
> intermediate VRT built on top of your sources?
>
> Cheers,
> Daniele
>
> On Mon, Jul 25, 2016 at 4:53 PM, Damian Dixon <damian.dixon at gmail.com>
> wrote:
>
>> Hi,
>>
>> I would like to combine multiple adjacent or overlapping rasters.
>>
>> They will all be in the same projection, image format and the output
>> projection will be the same as the source data.
>>
>> I believe that this is possible using the command line utility gdalwarp
>> as it can take multiple source files.
>>
>> I am wondering how to do this through the GDAL Warp API as you can only
>> specify a single source file:
>>
>> psWarpOptions->hSrcDS
>> <http://www.gdal.org/structGDALWarpOptions.html#a65f68e1cf7ca641c5d0a93762d0416d5>
>> = hSrcDS;
>>
>>
>> according to the tutorial.
>>
>>
>> Any hints or suggestions on how to pass multiple files to the Warp API
>> would be very helpful.
>>
>> Thanks
>> Damian
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> ==
> GeoServer Professional Services from the experts! Visit
> http://goo.gl/it488V for more information.
> ==
>
> Ing. Daniele Romagnoli
> Senior Software Engineer
>
> GeoSolutions S.A.S.
> Via di Montramito 3/A
> 55054  Massarosa (LU)
> Italy
> phone: +39 0584 962313
> fax:      +39 0584 1660272
>
> http://www.geo-solutions.it
> http://twitter.com/geosolutions_it
>
> -------------------------------------------------------
>
> *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
>
> Le informazioni contenute in questo messaggio di posta elettronica e/o
> nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
> loro utilizzo è consentito esclusivamente al destinatario del messaggio,
> per le finalità indicate nel messaggio stesso. Qualora riceviate questo
> messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
> darcene notizia via e-mail e di procedere alla distruzione del messaggio
> stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
> divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
> utilizzarlo per finalità diverse, costituisce comportamento contrario ai
> principi dettati dal D.Lgs. 196/2003.
>
>
>
> The information in this message and/or attachments, is intended solely for
> the attention and use of the named addressee(s) and may be confidential or
> proprietary in nature or covered by the provisions of privacy act
> (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
> Code).Any use not in accord with its purpose, any disclosure, reproduction,
> copying, distribution, or either dissemination, either whole or partial, is
> strictly forbidden except previous formal approval of the named
> addressee(s). If you are not the intended recipient, please contact
> immediately the sender by telephone, fax or e-mail and delete the
> information in this message that has been received in error. The sender
> does not give any warranty or accept liability as the content, accuracy or
> completeness of sent messages and accepts no responsibility  for changes
> made after they were sent or for other risks which arise as a result of
> e-mail transmission, viruses, etc.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160725/5e444f33/attachment.html>

From yjacolin at free.fr  Mon Jul 25 07:53:55 2016
From: yjacolin at free.fr (Yves Jacolin)
Date: Mon, 25 Jul 2016 16:53:55 +0200
Subject: [gdal-dev] Create a new shapefile using ogr utilities
In-Reply-To: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
Message-ID: <489822679.1tqCRifNMZ@tatras>

On Monday, July 25, 2016 16:51:13 Andrea Peri wrote:
> Hi,
> is possible create a new empty shapefile using the ogr utilities.
> 
> I search and try using ogrinfo and a sql like "create table ..." but
> without any success.
> 
> Thx.
Andrea,

You can also use shpcreate (and then shpadd) from shapelib package. 

Y.

From even.rouault at spatialys.com  Mon Jul 25 10:43:17 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Jul 2016 19:43:17 +0200
Subject: [gdal-dev] GDAL reads ESRI MultiLinestring as simple Linestring
In-Reply-To: <loom.20160723T092759-56@post.gmane.org>
References: <loom.20160723T092759-56@post.gmane.org>
Message-ID: <1793688.M85BRomS87@even-n550jk>

Hi Jukka,

> 
> I was reading the documentation of ESRI json from
> http://resources.arcgis.com/en/help/rest/apiref/geometry.html and this
> example seems to be about a MultiLinestring with two parts:

Just added support for it in trunk

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Jul 25 10:47:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 Jul 2016 19:47:33 +0200
Subject: [gdal-dev] Combining multiple rasters using GDAL Warp API
In-Reply-To: <CAJjdW1yL=Jx96bgW1TP2k8c3j2J73S5Rko304nbRZ2ZQacuPrw@mail.gmail.com>
References: <CAJjdW1xoacLuFDK_E7m9yqPKPXFio-FnvpVYr8dF5EPeiYYmxw@mail.gmail.com>
 <CAJaHrDxFisH_Kw9W2Ck_rUdQbktJmgYM5_5XzgrrZDOWN-BUWg@mail.gmail.com>
 <CAJjdW1yL=Jx96bgW1TP2k8c3j2J73S5Rko304nbRZ2ZQacuPrw@mail.gmail.com>
Message-ID: <6448874.Vv2arKNLAv@even-n550jk>

Damian,

> VRT looks a possibility. The VRT format tutorial shows how to do this
> programatically:
> 
> http://www.gdal.org/gdal_vrttut.html#gdal_vrttut_creation
> 

If you use GDAL 2.1, you can also use GDALBuildVRT() : 
http://gdal.org/gdal__utils_8h.html#a057aaea8b0ed0476809a781ffa377ea4

Or GDALWarp() : 
http://gdal.org/gdal__utils_8h.html#ab2094d5332364d63e0851dcb12398469

Regarding the low level warp API, the multi input dataset support is basically 
done by calling it as many times as you have source datasets.

Even

> 
> On 25 July 2016 at 16:28, Daniele Romagnoli <
> 
> daniele.romagnoli at geo-solutions.it> wrote:
> > Hi Damian,
> > I'm probably going off-topic but, did you consider setting up an
> > intermediate VRT built on top of your sources?
> > 
> > Cheers,
> > Daniele
> > 
> > On Mon, Jul 25, 2016 at 4:53 PM, Damian Dixon <damian.dixon at gmail.com>
> > 
> > wrote:
> >> Hi,
> >> 
> >> I would like to combine multiple adjacent or overlapping rasters.
> >> 
> >> They will all be in the same projection, image format and the output
> >> projection will be the same as the source data.
> >> 
> >> I believe that this is possible using the command line utility gdalwarp
> >> as it can take multiple source files.
> >> 
> >> I am wondering how to do this through the GDAL Warp API as you can only
> >> specify a single source file:
> >> 
> >> psWarpOptions->hSrcDS
> >> <http://www.gdal.org/structGDALWarpOptions.html#a65f68e1cf7ca641c5d0a9376
> >> 2d0416d5> = hSrcDS;
> >> 
> >> 
> >> according to the tutorial.
> >> 
> >> 
> >> Any hints or suggestions on how to pass multiple files to the Warp API
> >> would be very helpful.
> >> 
> >> Thanks
> >> Damian
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > ==
> > GeoServer Professional Services from the experts! Visit
> > http://goo.gl/it488V for more information.
> > ==
> > 
> > Ing. Daniele Romagnoli
> > Senior Software Engineer
> > 
> > GeoSolutions S.A.S.
> > Via di Montramito 3/A
> > 55054  Massarosa (LU)
> > Italy
> > phone: +39 0584 962313
> > fax:      +39 0584 1660272
> > 
> > http://www.geo-solutions.it
> > http://twitter.com/geosolutions_it
> > 
> > -------------------------------------------------------
> > 
> > *AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*
> > 
> > Le informazioni contenute in questo messaggio di posta elettronica e/o
> > nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
> > loro utilizzo è consentito esclusivamente al destinatario del messaggio,
> > per le finalità indicate nel messaggio stesso. Qualora riceviate questo
> > messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
> > darcene notizia via e-mail e di procedere alla distruzione del messaggio
> > stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
> > divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
> > utilizzarlo per finalità diverse, costituisce comportamento contrario ai
> > principi dettati dal D.Lgs. 196/2003.
> > 
> > 
> > 
> > The information in this message and/or attachments, is intended solely for
> > the attention and use of the named addressee(s) and may be confidential or
> > proprietary in nature or covered by the provisions of privacy act
> > (Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
> > Code).Any use not in accord with its purpose, any disclosure,
> > reproduction,
> > copying, distribution, or either dissemination, either whole or partial,
> > is
> > strictly forbidden except previous formal approval of the named
> > addressee(s). If you are not the intended recipient, please contact
> > immediately the sender by telephone, fax or e-mail and delete the
> > information in this message that has been received in error. The sender
> > does not give any warranty or accept liability as the content, accuracy or
> > completeness of sent messages and accepts no responsibility  for changes
> > made after they were sent or for other risks which arise as a result of
> > e-mail transmission, viruses, etc.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Mon Jul 25 13:52:55 2016
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 25 Jul 2016 14:52:55 -0600
Subject: [gdal-dev] Time for a new GeoJSON driver?
Message-ID: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>

Hi all,

The GeoJSON WG's draft-ietf-geojson,
https://datatracker.ietf.org/doc/draft-ietf-geojson/, is in the RFC Editor
queue and will be published soon. I'm considering whether adoption of the
updated GeoJSON (registered media type: application/geo+json) and support
for the older GeoJSON format (no registered media type) might be helped by
creating an entirely new driver.

A separate driver would keep the existing driver from becoming even more
complicated, yes? We would also have an opportunity to remove unnecessary
configuration options and support for other JSON formats that aren't really
GeoJSON.

Does anyone feel that the existing driver code *would not* be a good place
to start and that we shouldn't arrive at a new driver by copying the
existing GeoJSON driver and removing unneeded code?

What to call the new driver is another question. "geo+json" or "RFCxxxx"
(number yet to be determined) seem like good candidates to me.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160725/7006064f/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jul 25 14:04:09 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 25 Jul 2016 21:04:09 +0000 (UTC)
Subject: [gdal-dev] Create a new shapefile using ogr utilities
References: <CABqTJk9dGUORutUZ3Uv5gYNyC2EpGfNp1tR0jcPh27-stZq4ag@mail.gmail.com>
Message-ID: <loom.20160725T225731-375@post.gmane.org>

Andrea Peri <aperi2007 <at> gmail.com> writes:

> 
> Hi,
> is possible create a new empty shapefile using the ogr utilities.
> 
> I search and try using ogrinfo and a sql like "create table ..." but
> without any success.


ogr2ogr -f "ESRI Shapefile" -dialect sqlite -sql "select geometry
 from foo where 1=2" emptypoint.shp foo.shp -nlt point

Requires foo.shp to exist so not perfect.


-Jukka Rahkonen-






From even.rouault at spatialys.com  Mon Jul 25 15:39:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 00:39:07 +0200
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
Message-ID: <10352331.5rHi9ME0H4@even-n550jk>

Hi Sean,

> The GeoJSON WG's draft-ietf-geojson,
> https://datatracker.ietf.org/doc/draft-ietf-geojson/, is in the RFC Editor
> queue and will be published soon. I'm considering whether adoption of the
> updated GeoJSON (registered media type: application/geo+json) and support
> for the older GeoJSON format (no registered media type) might be helped by
> creating an entirely new driver.
> 
> A separate driver would keep the existing driver from becoming even more
> complicated, yes? We would also have an opportunity to remove unnecessary
> configuration options and support for other JSON formats that aren't really
> GeoJSON.

I'm not completely sure we need a new driver just to support the revised 
geo+json spec. It is still mostly compatible with the original spec, right ?

>From what I can see, the differences / new specifications are :
- SRS fixed to CRS84
- antimeridian cutting 
- right hand rule of polygons
- bbox and the poles&antimeridian
- the media type

Am I missing something ?

On the reading side, I think the existing driver requires little modification 
(extending "Accept: text/plain, application/json" to "Accept: text/plain, 
application/json, application/geo+json" for http:// or https:// datasource 
names) , so essentially the writing side would be affected.

Regarding:
- the right hand rule of polygons, it could be a new behaviour in all cases ( 
the shapefile driver e.g. modifies the winding order to comply with the shapefile 
spec )
- SRS fixed to CRS84, it is a matter of automatically reprojecting the input 
data to it if it is not CRS84, like done in the KML driver. That could be a 
default behaviour, with an option to use the deprecated crs object if really 
needed.
- antimeridian cutting: can make sense as a default behaviour if the target 
SRS is CRS84. With the difficulty in doing the cutting properly ( ogr2ogr -
wrapdateline heuristics can perhaps be improved )
- bbox and antimerdian: if the geometry has been cut by the geojson driver, it 
is obvious to make the bbox conformant to the requirement. If it has been cut 
in a previous stage ( e.g in a geo+json->geo+json conversion), then you need 
to detect that the geometry has been cut ( its extent is -180 180) and then 
detect the extent of its parts
- bbox and the poles : if the geometry is already in CRS84, then it looks like 
it should be just a matter of computing the bbox in the standard way from the 
geometry coordinates. If the geometry must be reprojected, then the issue is 
more the reprojection of the geometry itself :
https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044776.htm

None of that really seems to call for forking a new driver.

In the new spec, elevations are explictly ellipsoidal heights. In the old 
spec, it wasn't explicit. Although I'm not sure all elevations passed in a 
(x,y,z) triplet with x,y being in CRS84 are really ellipsoidal heights in 
practice, this is probably out of scope of the driver ( unless it would be fed 
with a SRS that would explictly specify the VERTCS and thus vertical datum 
transformation could potentially be done )

> 
> Does anyone feel that the existing driver code *would not* be a good place
> to start and that we shouldn't arrive at a new driver by copying the
> existing GeoJSON driver and removing unneeded code?

What could possibly justify a new driver to me is a driver that would support 
reading geojson files of arbitrary size without fully ingesting them into 
memory. That would have probably quite a big impact on the existing code base, 
especially since GDAL 2.1 where the driver assumes in-memory ingestion to be 
able to provide the update support.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jul 25 16:24:42 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 25 Jul 2016 23:24:42 +0000 (UTC)
Subject: [gdal-dev] Time for a new GeoJSON driver?
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
Message-ID: <loom.20160726T011458-196@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> - right hand rule of polygons

Which means actually left hand rule if I have understood the right hand/left
hand rules correctly. If you walk along the polygon rings the name of the
rule is telling where the interior of the polygon is. If you follow the
outer ring that is winding counterclockwise the interior in on your left
hand side.

I may be wrong. And the rule does not explicitly say anything about people
walking backwards.

-Jukka Rahkonen-


From sean at mapbox.com  Mon Jul 25 16:40:08 2016
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 25 Jul 2016 17:40:08 -0600
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <loom.20160726T011458-196@post.gmane.org>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk> <loom.20160726T011458-196@post.gmane.org>
Message-ID: <CADPhZXxroyhmA+jD9pRx-7t9uoDC_wDRqkMk2N1_FSHLCaZ2rA@mail.gmail.com>

On Mon, Jul 25, 2016 at 5:24 PM, Jukka Rahkonen <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Even Rouault <even.rouault <at> spatialys.com> writes:
>
>
> > - right hand rule of polygons
>
> Which means actually left hand rule if I have understood the right
> hand/left
> hand rules correctly. If you walk along the polygon rings the name of the
> rule is telling where the interior of the polygon is. If you follow the
> outer ring that is winding counterclockwise the interior in on your left
> hand side.
>
> I may be wrong. And the rule does not explicitly say anything about people
> walking backwards.
>

This is the reference for the right-hand rule:

  https://en.wikipedia.org/wiki/Right-hand_rule

A polygon patch with a positive area has a normal vector pointing "up",
away from the center of the earth. Point your thumb of your right hand in
the same direction and the curl of your fingers indicates the winding order
of the polygon vertices.

OGC 06-142r1 "GML 3.1.1 PIDF-LO Shape Application Schema for use by the
Internet Engineering Task Force (IETF)" uses the same right-hand rule as
GeoJSON.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160725/667b2875/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jul 25 18:36:44 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 26 Jul 2016 01:36:44 +0000 (UTC)
Subject: [gdal-dev] Time for a new GeoJSON driver?
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk> <loom.20160726T011458-196@post.gmane.org>
 <CADPhZXxroyhmA+jD9pRx-7t9uoDC_wDRqkMk2N1_FSHLCaZ2rA@mail.gmail.com>
Message-ID: <loom.20160726T031729-854@post.gmane.org>

Sean Gillies <sean <at> mapbox.com> writes:

> 
> 
> On Mon, Jul 25, 2016 at 5:24 PM, Jukka Rahkonen <jukka.rahkonen <at>
maanmittauslaitos.fi> wrote:
> Even Rouault <even.rouault <at> spatialys.com> writes:
> > - right hand rule of polygonsWhich means actually left hand rule if I
have understood the right hand/left
> hand rules correctly. If you walk along the polygon rings the name of the
> rule is telling where the interior of the polygon is. If you follow the
> outer ring that is winding counterclockwise the interior in on your left
> hand side.
> I may be wrong. And the rule does not explicitly say anything about people
> walking backwards.
> 
> This is the reference for the right-hand rule:
>   https://en.wikipedia.org/wiki/Right-hand_rule
> 
> 
> A polygon patch with a positive area has a normal vector pointing "up",
away from the center of the earth. Point your thumb of your right hand in
the same direction and the curl of your fingers indicates the winding order
of the polygon vertices.
> OGC 06-142r1 "GML 3.1.1 PIDF-LO Shape Application Schema for use by the
Internet Engineering Task Force (IETF)" uses the same right-hand rule as
GeoJSON.
> -- Sean Gillies

All right, there is one right hand rule for mathematics and physics, and
another right hand rule for GIS, as it appears in the shapefile
specification and for example PostGIS documentation
http://postgis.net/docs/ST_ForceRHR.html. Very typical, I should not be
surprised.

You throw away the CRS because it made confusion, I suggest to send the
right hand rule to the same address. Clockwise and counterclockwise are more
explicit even I know that hairdressers do have counterclockwise running
clocks for customers who can see them only from the mirrors.

I went through about hundred hits about the right hand rule and
statistically your party wins clearly. Mainly ESRI and this guy resist:

> On Sat, Mar 11, 2006 at 09:49:04PM -0800, Paul Ramsey wrote:
>> "Right hand rule" means "if I walk along the boundary of the polygon
>> with my right hand extended, it is always inside the polygon".  So
>> the external rings go clockwise, and the internal rings go anti-
>> clockwise.

Keep your right hand ready for a beer if we ever meet.

-Jukka Rahkonen-


From jukka.rahkonen at maanmittauslaitos.fi  Tue Jul 26 00:08:02 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 26 Jul 2016 07:08:02 +0000 (UTC)
Subject: [gdal-dev] Tickets that mention e00
Message-ID: <loom.20160726T090546-760@post.gmane.org>

Hi,

I wonder how likely it is that the tickets dealing with Arc/Info coverages
http://www.gdal.org/drv_avce00.html will still receive some bug fixes. Would
it be a big mistake to close them all as won't fix?

-Jukka Rahkonen-


From hema.yeedunuri at amigooptima.in  Tue Jul 26 04:07:14 2016
From: hema.yeedunuri at amigooptima.in (Hema Yeedunuri)
Date: Tue, 26 Jul 2016 16:37:14 +0530
Subject: [gdal-dev] =?utf-8?q?=28no_subject=29?=
Message-ID: <CA+8Q=fC9jasxiWyQqAPuP3vkvx8VEqSi8yjurJYaJWJ0-DredQ@mail.gmail.com>

hi all ,

I have build gdal-1.11.2 with libcurl support to read wms layers.it is
build sucessfully how can i read wms layers .I have geoserver on my
loalhost.I have loaded images which uses wms services. I tried opening with
gdalopen it is not working . the output format supported in geoserver is
png / geotiff . but for a single band data the no. of bands i am getting
are 3 . and null data is coming.


thanks,
hema
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160726/fd72e5d1/attachment-0001.html>

From mj10777 at googlemail.com  Tue Jul 26 06:10:24 2016
From: mj10777 at googlemail.com (Mark Johnson)
Date: Tue, 26 Jul 2016 15:10:24 +0200
Subject: [gdal-dev] gdal_edit with ECW, parameter woes,
	documentation is probematic
Message-ID: <CAEEbjBjuRqNKg038bkxBKUnWLi0P-xqo_qh9L7Fxh9OotBTSJA@mail.gmail.com>

While writing this, I figured put most of the problems, so this note will
be more about suggestion in making the documentation more usable.

I am going to receive an amount of ecw files that, for whatever reason, do
not contain the georeferenced information.

For the first image received, gdalinfo shows the following:

Driver: ECW/ERDAS Compressed Wavelets (SDK 3.x)
Files: 1989.423C_42348.5000.ecw
Size is 8001, 6001
Coordinate System is `'
Metadata:
  COLORSPACE=GREYSCALE
  COMPRESSION_RATE_TARGET=5
  VERSION=2
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 6001.0)
Upper Right ( 8001.0,    0.0)
Lower Right ( 8001.0, 6001.0)
Center      ( 4000.5, 3000.5)
Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
  Description = Grayscale
  Overviews: 4000x3000, 2000x1500, 1000x750, 500x375, 250x187

Since I know the position, I did the following:

1) gdal_translate -of GTiff -a_nodata 135 -a_srs EPSG:3068 -a_ullr 20800
22000 24000 19600 1989.423C_42348.5000.ecw 1989.423C_42348.5000.3068.tif

2) gdal_translate -of ECW -co TARGET=0 -a_srs EPSG:3068
1989.423C_42348.5000.3068.tif 1989.423C_42348.5000.3068.tif.ecw

gdalinfo now shows the projection information.
- but with 'COMPRESSION_RATE_TARGET=1' instead of 5
-- no doubt due to the '-co TARGET=0' (which I have no idea what it means)

gdal_translate has a note with the '-co'
'See format specific documentation for legal creation options for each
format'
a: <a href="http://www.gdal.org/formats_list.html">See format specific
documentation for legal creation options for each format</a>
which then leads to http://www.gdal.org/frmt_ecw.html
- where TARGET is then explained (percentage)
-- but no explanation on what 'COMPRESSION_RATE_TARGET' is
---> '-co TARGET=50' (percent) = 'COMPRESSION_RATE_TARGET=2'
---> '-co TARGET=75' (percent) = 'COMPRESSION_RATE_TARGET=4'
---> '-co TARGET=99.99' (percent) = 'COMPRESSION_RATE_TARGET=9997'
A comparison chart would be useful here
- comparing what gdalinfo shows to what gdal_translate needs
(I still do not know what TARGET setting is needed to get
COMPRESSION_RATE_TARGET=5)

What I would like to know is: can gdal_edit.py be used to achieve the same
result?
- base on another found sample, I worked this out, since I have never used
the combination -a_srs/-a_ullr before
-- wasted a lot of time in the past creating a world-file for this task

gdal_edit  -a_srs EPSG:3068 -a_ullr 20800 22000 24000 19600
1989.423C_42348.5000.ecw

So for both 'gdal_translate' and 'gdal_edit' a practical sample to set the
missing georeferenced information would be useful
- while searching I saw a lot of reports of people receiving ecw file 'raw'
and wondering how to get it in

Once one knows it, it is easy
But it has be hours since I found this sample:
gdal_edit -mo DATUM=WGS84 -mo PROJ=GEODETIC -a_ullr 7 47 8 46 test.ecw

and trying to adapt it to work with a non-wsg84 system.

Mark Johnson, Berlin Germany
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160726/fb0931fd/attachment.html>

From even.rouault at spatialys.com  Tue Jul 26 06:17:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 15:17:33 +0200
Subject: [gdal-dev] Tickets that mention e00
In-Reply-To: <loom.20160726T090546-760@post.gmane.org>
References: <loom.20160726T090546-760@post.gmane.org>
Message-ID: <5106402.OYzVaZdUc1@even-n550jk>

On Tuesday 26 July 2016 07:08:02 Jukka Rahkonen wrote:
> Hi,
> 
> I wonder how likely it is that the tickets dealing with Arc/Info coverages
> http://www.gdal.org/drv_avce00.html will still receive some bug fixes. Would
> it be a big mistake to close them all as won't fix?

Hi Jukka,

unless a maintainer pops up, that sounds like an appropriate action.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jul 26 06:40:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 15:40:32 +0200
Subject: [gdal-dev] gdal_edit with ECW, parameter woes,
	documentation is probematic
In-Reply-To: <CAEEbjBjuRqNKg038bkxBKUnWLi0P-xqo_qh9L7Fxh9OotBTSJA@mail.gmail.com>
References: <CAEEbjBjuRqNKg038bkxBKUnWLi0P-xqo_qh9L7Fxh9OotBTSJA@mail.gmail.com>
Message-ID: <6807263.MOb6F6xV72@even-n550jk>

Mark,

I've tried to incorporate your feedback in this changeset:

@@ -173,6 +173,16 @@
 the PROJ, DATUM or UNITS with SetMetadataItem(), the later values will 
override the values
 built from the projection string.<p>
 
+All those can for example be modified with the -a_ullr, -a_srs or -mo switches
+of the <a href="gdal_edit.html">gdal_edit.py</a> utility.<p>
+
+For example:
+<pre>
+gdal_edit.py -mo DATUM=WGS84 -mo PROJ=GEODETIC -a_ullr 7 47 8 46 test.ecw
+
+gdal_edit.py -a_srs EPSG:3068 -a_ullr 20800 22000 24000 19600 test.ecw
+</pre>
+
 <h3>File Metadata Keys: </h3>
 
 <ul>
@@ -190,7 +200,12 @@
 <li>COLORSPACE
 <li>COMPRESSION_DATE
 <li>COMPRESSION_RATE_ACTUAL
-<li>COMPRESSION_RATE_TARGET
+<li>COMPRESSION_RATE_TARGET. This is the percentage of the target compressed
+file size divided by the uncompressed file size. This is equal to
+100 / (100 - TARGET) where TARGET is the value of the TARGET
+creation option used at file creation, so a COMPRESSION_RATE_TARGET=1 is
+equivalent to a TARGET=0 (ie no compression), COMPRESSION_RATE_TARGET=5 is
+equivalent to TARGET=80 (ie dividing uncompressed file size by 5), etc...
 <li>VERSION
 </ul>
 
Even


> While writing this, I figured put most of the problems, so this note will
> be more about suggestion in making the documentation more usable.
> 
> I am going to receive an amount of ecw files that, for whatever reason, do
> not contain the georeferenced information.
> 
> For the first image received, gdalinfo shows the following:
> 
> Driver: ECW/ERDAS Compressed Wavelets (SDK 3.x)
> Files: 1989.423C_42348.5000.ecw
> Size is 8001, 6001
> Coordinate System is `'
> Metadata:
>   COLORSPACE=GREYSCALE
>   COMPRESSION_RATE_TARGET=5
>   VERSION=2
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 6001.0)
> Upper Right ( 8001.0,    0.0)
> Lower Right ( 8001.0, 6001.0)
> Center      ( 4000.5, 3000.5)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
>   Description = Grayscale
>   Overviews: 4000x3000, 2000x1500, 1000x750, 500x375, 250x187
> 
> Since I know the position, I did the following:
> 
> 1) gdal_translate -of GTiff -a_nodata 135 -a_srs EPSG:3068 -a_ullr 20800
> 22000 24000 19600 1989.423C_42348.5000.ecw 1989.423C_42348.5000.3068.tif
> 
> 2) gdal_translate -of ECW -co TARGET=0 -a_srs EPSG:3068
> 1989.423C_42348.5000.3068.tif 1989.423C_42348.5000.3068.tif.ecw
> 
> gdalinfo now shows the projection information.
> - but with 'COMPRESSION_RATE_TARGET=1' instead of 5
> -- no doubt due to the '-co TARGET=0' (which I have no idea what it means)
> 
> gdal_translate has a note with the '-co'
> 'See format specific documentation for legal creation options for each
> format'
> a: <a href="http://www.gdal.org/formats_list.html">See format specific
> documentation for legal creation options for each format</a>
> which then leads to http://www.gdal.org/frmt_ecw.html
> - where TARGET is then explained (percentage)
> -- but no explanation on what 'COMPRESSION_RATE_TARGET' is
> ---> '-co TARGET=50' (percent) = 'COMPRESSION_RATE_TARGET=2'
> ---> '-co TARGET=75' (percent) = 'COMPRESSION_RATE_TARGET=4'
> ---> '-co TARGET=99.99' (percent) = 'COMPRESSION_RATE_TARGET=9997'
> A comparison chart would be useful here
> - comparing what gdalinfo shows to what gdal_translate needs
> (I still do not know what TARGET setting is needed to get
> COMPRESSION_RATE_TARGET=5)
> 
> What I would like to know is: can gdal_edit.py be used to achieve the same
> result?
> - base on another found sample, I worked this out, since I have never used
> the combination -a_srs/-a_ullr before
> -- wasted a lot of time in the past creating a world-file for this task
> 
> gdal_edit  -a_srs EPSG:3068 -a_ullr 20800 22000 24000 19600
> 1989.423C_42348.5000.ecw
> 
> So for both 'gdal_translate' and 'gdal_edit' a practical sample to set the
> missing georeferenced information would be useful
> - while searching I saw a lot of reports of people receiving ecw file 'raw'
> and wondering how to get it in
> 
> Once one knows it, it is easy
> But it has be hours since I found this sample:
> gdal_edit -mo DATUM=WGS84 -mo PROJ=GEODETIC -a_ullr 7 47 8 46 test.ecw
> 
> and trying to adapt it to work with a non-wsg84 system.
> 
> Mark Johnson, Berlin Germany

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Jul 26 06:42:41 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 15:42:41 +0200
Subject: [gdal-dev] (no subject)
In-Reply-To: <CA+8Q=fC9jasxiWyQqAPuP3vkvx8VEqSi8yjurJYaJWJ0-DredQ@mail.gmail.com>
References: <CA+8Q=fC9jasxiWyQqAPuP3vkvx8VEqSi8yjurJYaJWJ0-DredQ@mail.gmail.com>
Message-ID: <1633038.GWzNsuUuj2@even-n550jk>

On Tuesday 26 July 2016 16:37:14 Hema Yeedunuri wrote:
> aded images which uses wms services. I tried opening with
> gdalopen it is not working . the output format supported in geoserver is
> png / geotiff . but for a single band data the no. of bands i am getting
> are 3 . and null data is coming.

Hema,

You can change the number of bands returned by the WMS driver by setting the 
<BandsCount> element. See http://gdal.org/frmt_wms.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mj10777 at googlemail.com  Tue Jul 26 07:18:21 2016
From: mj10777 at googlemail.com (Mark Johnson)
Date: Tue, 26 Jul 2016 16:18:21 +0200
Subject: [gdal-dev] gdal_edit with ECW, parameter woes,
	documentation is probematic
Message-ID: <CAEEbjBgPDg9pU1QSU0uzPNXu56R==WQuk4tSFQ98qFCadQ_uYg@mail.gmail.com>

Yes, that looks good.

But also adapting the pages that use -co NAME=VALUE
- such as http://www.gdal.org/gdal_translate.html

<dt><b>-co</b> <em>"NAME=VALUE"</em>:</dt>
<dd>Passes a creation option to the output format driver. Multiple
<b>-co</b> options may be listed. See format specific documentation for
legal creation options for each format. </dd>

<dt><b>-co</b> <em>"NAME=VALUE"</em>:</dt>
<dd>Passes a creation option to the output format driver. Multiple
<b>-co</b> options may be listed. See <a class="el"
href="formats_list.html" title=""GDAL Raster Formats">format specific
documentation for legal creation options for each format</a>. </dd>

would also be good, leading the searcher swiftly to the needed page where
they can select their needed format to look up the possible parameter
combinations.

Mark
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160726/dcd5cb53/attachment.html>

From even.rouault at spatialys.com  Tue Jul 26 08:00:51 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 17:00:51 +0200
Subject: [gdal-dev] Motion: adopt RFC 63 : Sparse datasets improvements
Message-ID: <1942550.gUkk8Jh43O@even-n550jk>

Hi,

I move to adopt RFC 63 : Sparse datasets improvements

https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements

-------

Starting with my +1

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmorissette at mapgears.com  Tue Jul 26 08:45:12 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 26 Jul 2016 11:45:12 -0400
Subject: [gdal-dev] Tickets that mention e00
In-Reply-To: <5106402.OYzVaZdUc1@even-n550jk>
References: <loom.20160726T090546-760@post.gmane.org>
 <5106402.OYzVaZdUc1@even-n550jk>
Message-ID: <165c7ff0-f91d-62e3-03df-4ca05ddb5a67@mapgears.com>

On 2016-07-26 9:17 AM, Even Rouault wrote:
> On Tuesday 26 July 2016 07:08:02 Jukka Rahkonen wrote:
>> Hi,
>>
>> I wonder how likely it is that the tickets dealing with Arc/Info coverages
>> http://www.gdal.org/drv_avce00.html will still receive some bug fixes. Would
>> it be a big mistake to close them all as won't fix?
>
> Hi Jukka,
>
> unless a maintainer pops up, that sounds like an appropriate action.
>
> Even
>


Agreed. BTW, if it helps we could move the upstream AVCBin/AVCE00 source 
to github so that Even and others GDAL devs can update them.

Daniel
-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From dmorissette at mapgears.com  Tue Jul 26 08:39:45 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 26 Jul 2016 11:39:45 -0400
Subject: [gdal-dev] Motion: adopt RFC 63 : Sparse datasets improvements
In-Reply-To: <1942550.gUkk8Jh43O@even-n550jk>
References: <1942550.gUkk8Jh43O@even-n550jk>
Message-ID: <e6e03a05-63c5-66f3-e02a-780b349bda1b@mapgears.com>

On 2016-07-26 11:00 AM, Even Rouault wrote:
> Hi,
>
> I move to adopt RFC 63 : Sparse datasets improvements
>
> https://trac.osgeo.org/gdal/wiki/rfc63_sparse_datasets_improvements
>
> -------
>
> Starting with my +1
>
> Even
>

+1 on the overall idea and proposed solution.

+0 on the implementation details as I'm not the most qualified to 
comment on those details.


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From patrick.mckendree.young at gmail.com  Tue Jul 26 09:40:23 2016
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Tue, 26 Jul 2016 10:40:23 -0600
Subject: [gdal-dev] gdalwarp -rpc with RPC_DEM default behavior not as
	described
Message-ID: <CADXYQQ7=-AEEgimfqhK2vS2JHcOtF9=2PzLsUqHAd-K9gvZVwA@mail.gmail.com>

Hi all,

We've been making some orthos with gdalwarp (gdal version 2.1.1) and
encountering resampling errors in the output (gittery output in the lines
in certain spots).  Long story short, explicitly setting the "-et" option
to "0" fixed it, but the docs for gdalwarp say the following (under the -et
flag description):

"starting with GDAL 2.1, the RPC_DEM warping option is specified, in which
case, an exact transformer, i.e. err_threshold=0, will be used"

Here's an example of the call we're making where we see the artifacts:

gdalwarp -t_srs EPSG:3857 -rpc -to RPC_DEM=dem.tif in.tif out.tif

and this guy fixes it:

gdalwarp -et 0 -t_srs EPSG:3857 -rpc -to RPC_DEM=dem.tif in.tif out.tif

I'm guessing the flag is not actually being set, but if anyone can point me
to the code where this default is supposed to be set when the dem is
specified, I might be able to provide a fix or figure out that I'm doing it
wrong!  I didn't have much luck searching through the github archive.

Thanks!

-Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160726/0e6c99f0/attachment.html>

From even.rouault at spatialys.com  Tue Jul 26 09:54:06 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Jul 2016 18:54:06 +0200
Subject: [gdal-dev] gdalwarp -rpc with RPC_DEM default behavior not as
	described
In-Reply-To: <CADXYQQ7=-AEEgimfqhK2vS2JHcOtF9=2PzLsUqHAd-K9gvZVwA@mail.gmail.com>
References: <CADXYQQ7=-AEEgimfqhK2vS2JHcOtF9=2PzLsUqHAd-K9gvZVwA@mail.gmail.com>
Message-ID: <9800849.hgi0zm3maV@even-n550jk>

Patrick,

Thanks for the report. It was indeed not working as documented. Fixed per 
https://trac.osgeo.org/gdal/ticket/6608

Even

> Hi all,
> 
> We've been making some orthos with gdalwarp (gdal version 2.1.1) and
> encountering resampling errors in the output (gittery output in the lines
> in certain spots).  Long story short, explicitly setting the "-et" option
> to "0" fixed it, but the docs for gdalwarp say the following (under the -et
> flag description):
> 
> "starting with GDAL 2.1, the RPC_DEM warping option is specified, in which
> case, an exact transformer, i.e. err_threshold=0, will be used"
> 
> Here's an example of the call we're making where we see the artifacts:
> 
> gdalwarp -t_srs EPSG:3857 -rpc -to RPC_DEM=dem.tif in.tif out.tif
> 
> and this guy fixes it:
> 
> gdalwarp -et 0 -t_srs EPSG:3857 -rpc -to RPC_DEM=dem.tif in.tif out.tif
> 
> I'm guessing the flag is not actually being set, but if anyone can point me
> to the code where this default is supposed to be set when the dem is
> specified, I might be able to provide a fix or figure out that I'm doing it
> wrong!  I didn't have much luck searching through the github archive.
> 
> Thanks!
> 
> -Patrick

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Tue Jul 26 14:39:47 2016
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 26 Jul 2016 15:39:47 -0600
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <10352331.5rHi9ME0H4@even-n550jk>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
Message-ID: <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>

On Mon, Jul 25, 2016 at 4:39 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi Sean,
>
> > The GeoJSON WG's draft-ietf-geojson,
> > https://datatracker.ietf.org/doc/draft-ietf-geojson/, is in the RFC
> Editor
> > queue and will be published soon. I'm considering whether adoption of the
> > updated GeoJSON (registered media type: application/geo+json) and support
> > for the older GeoJSON format (no registered media type) might be helped
> by
> > creating an entirely new driver.
> >
> > A separate driver would keep the existing driver from becoming even more
> > complicated, yes? We would also have an opportunity to remove unnecessary
> > configuration options and support for other JSON formats that aren't
> really
> > GeoJSON.
>
> I'm not completely sure we need a new driver just to support the revised
> geo+json spec. It is still mostly compatible with the original spec, right
> ?
>
> From what I can see, the differences / new specifications are :
> - SRS fixed to CRS84
> - antimeridian cutting
> - right hand rule of polygons
> - bbox and the poles&antimeridian
> - the media type
>
> Am I missing something ?
>

Two things (the full list of changes is at
https://tools.ietf.org/html/draft-ietf-geojson-04#appendix-B.1):

1. GeoJSON objects MUST NOT contain the defining members of other types.
For example, a GeoJSON Feature must not have a "features" member. I don't
see this coming up when converting from other formats, but OGR's GeoJSON
driver should filter these out of native data when writing GeoJSON.

2. Implementations SHOULD NOT extend position arrays beyond 3 elements. The
OGR driver should not by default write anything other than X, Y, Z. If it
currently writes X, Y, Z, and M, the M should be omitted.

There's one informative change in
https://tools.ietf.org/html/draft-ietf-geojson-04#appendix-B.2 that is
relevant. When GeoJSON output is CRS84 only we can certainly reduce the
default coordinate precision from 15 to 6 or 7.


>
> On the reading side, I think the existing driver requires little
> modification
> (extending "Accept: text/plain, application/json" to "Accept: text/plain,
> application/json, application/geo+json" for http:// or https:// datasource
> names) , so essentially the writing side would be affected.
>
> Regarding:
> - the right hand rule of polygons, it could be a new behaviour in all
> cases (
> the shapefile driver e.g. modifies the winding order to comply with the
> shapefile
> spec )
> - SRS fixed to CRS84, it is a matter of automatically reprojecting the
> input
> data to it if it is not CRS84, like done in the KML driver. That could be a
> default behaviour, with an option to use the deprecated crs object if
> really
> needed.
> - antimeridian cutting: can make sense as a default behaviour if the target
> SRS is CRS84. With the difficulty in doing the cutting properly ( ogr2ogr -
> wrapdateline heuristics can perhaps be improved )
> - bbox and antimerdian: if the geometry has been cut by the geojson
> driver, it
> is obvious to make the bbox conformant to the requirement. If it has been
> cut
> in a previous stage ( e.g in a geo+json->geo+json conversion), then you
> need
> to detect that the geometry has been cut ( its extent is -180 180) and then
> detect the extent of its parts
> - bbox and the poles : if the geometry is already in CRS84, then it looks
> like
> it should be just a matter of computing the bbox in the standard way from
> the
> geometry coordinates. If the geometry must be reprojected, then the issue
> is
> more the reprojection of the geometry itself :
> https://lists.osgeo.org/pipermail/gdal-dev/2016-July/044776.htm
>
> None of that really seems to call for forking a new driver.
>

Automatic reprojection to CRS84 would break existing systems that counted
on preservation of CRS. Addition of a configuration option like
OGR_GEOJSON_2008=TRUE would help, but this would still be a breaking
change, would it not?


> In the new spec, elevations are explictly ellipsoidal heights. In the old
> spec, it wasn't explicit. Although I'm not sure all elevations passed in a
> (x,y,z) triplet with x,y being in CRS84 are really ellipsoidal heights in
> practice, this is probably out of scope of the driver ( unless it would be
> fed
> with a SRS that would explictly specify the VERTCS and thus vertical datum
> transformation could potentially be done )
>
> >
> > Does anyone feel that the existing driver code *would not* be a good
> place
> > to start and that we shouldn't arrive at a new driver by copying the
> > existing GeoJSON driver and removing unneeded code?
>
> What could possibly justify a new driver to me is a driver that would
> support
> reading geojson files of arbitrary size without fully ingesting them into
> memory. That would have probably quite a big impact on the existing code
> base,
> especially since GDAL 2.1 where the driver assumes in-memory ingestion to
> be
> able to provide the update support.
>

I do not know how OGR supports in-place update of GeoJSON, but I'll take
your word on it.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160726/c59bbf7d/attachment.html>

From pablo.larraondo at anu.edu.au  Tue Jul 26 17:20:22 2016
From: pablo.larraondo at anu.edu.au (Pablo Rozas Larraondo)
Date: Wed, 27 Jul 2016 10:20:22 +1000
Subject: [gdal-dev] Transforming rasters with the C API
Message-ID: <CAGOzVwn37tJRUDVNhTxgBNyKqggc2P=hu0ef0RMum+vP8Nx=6g@mail.gmail.com>

Hello,

I'm trying to transform a raster into a different projection using the
public C functions exposed in gdal_alg.h

I have some code that I have been testing using the functions
GDALCreateGenImgProjTransformer()
and GDALGenImgProjTransform():

https://gist.github.com/monkeybutter/8367132e9683a4eb823a0175586a25b1

Obviously I'm doing something wrong (the code segment faults), but I cannot
find any example or tutorial that explains how this operations should be
performed. Does anyone have a recommendation or example that shows this
functionality?

Thank you very much for your help,

Kind regards,
Pablo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160727/cc88962a/attachment.html>

From leobrien at gmail.com  Tue Jul 26 23:04:54 2016
From: leobrien at gmail.com (Lauren O'Brien)
Date: Wed, 27 Jul 2016 16:04:54 +1000
Subject: [gdal-dev] gdal_translate with -projwin possible bug
Message-ID: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>

Hello all,

I've noticed what I think may be a bug with gdal_translate, just looking
for further information before deciding whether to report it.

In version 1.11.4 and earlier, using the -projwin tag to subset a raster
produces an output whose cell alignment and content matches the source
dataset - it just grabs any cells that intersect the box and writes them to
the output.

In v2.1.0 (at least in a Windows environment), this no longer occurs. The
output raster is distorted to match the exact extent of the -projwin
coordinates. No resampling is involved, but the cell origins shift, and the
cell sizes are either shrunk or stretched slightly to conform to the
projwin box. This is a substantial change in behaviour which doesn't appear
to have been documented.

>From my point of view, its an unwelcome change. I've been using
gdal_translate with -projwin and vsicurl to clip out sections of large
national datasets without having to download the whole file first, and
without needing to know things like the source dataset origin, cellsize etc
in order to ensure output aligns with input. I need each dataset I clip out
to 'stack' properly, and to represent an unaltered subset of the source
data.

Please let me know if this is a true bug or just an undocumented change,
and/or if there's a better alternative command to use.

Regards,
Lauren O'Brien
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160727/6ed24348/attachment.html>

From kassies at gmail.com  Tue Jul 26 23:37:47 2016
From: kassies at gmail.com (Rutger)
Date: Tue, 26 Jul 2016 23:37:47 -0700 (PDT)
Subject: [gdal-dev] gdal_translate with -projwin possible bug
In-Reply-To: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
Message-ID: <1469601467195-5278303.post@n6.nabble.com>

Hey Lauren,

I can replicate this with my Win64 installation of 2.1 (the conda-forge
build). 

Thanks for the heads up, i also do this all the time. Not having to
calculate the exact extent was one of the benefits of using projwin. The
current behavior could probably also be achieved with gdal_warp and
nn-resampling for example, so at least for me its also an unwelcome change.  

The srcwin option probably still leaves the pixel placement untouched, but
that would often require an additional conversion to pixel coordinates. 

I think this also impact's the 'clipper' in QGIS, since the latest (2.16)
also ships with GDAL 2.1. 


Regards,
Rutger



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-translate-with-projwin-possible-bug-tp5278296p5278303.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jul 27 01:16:41 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 27 Jul 2016 08:16:41 +0000 (UTC)
Subject: [gdal-dev]
	=?utf-8?q?gdal=5Ftranslate_with_-projwin_possible_bug?=
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
Message-ID: <loom.20160727T101031-924@post.gmane.org>

Lauren O'Brien <leobrien <at> gmail.com> writes:

> 
> 
> Hello all,
> 
> I've noticed what I think may be a bug with gdal_translate, just looking
for further information before deciding whether to report it. 
> 
> In version 1.11.4 and earlier, using the -projwin tag to subset a raster
produces an output whose cell alignment and content matches the source
dataset - it just grabs any cells that intersect the box and writes them to
the output. 

I am sure that there are also users who consider that it is a bug if the
output does not exactly match -projwin.

I would have a try with gdalwarp by using -te and -tap together. I believe
that you would like to see something like -tap (target aligned pixels) also
in gdal_translate.

-Jukka Rahkonen-

From francisco.javier.calzado at ericsson.com  Wed Jul 27 05:01:59 2016
From: francisco.javier.calzado at ericsson.com (Javier Calzado)
Date: Wed, 27 Jul 2016 12:01:59 +0000 (UTC)
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
	(GDAL 2.1.0)
Message-ID: <loom.20160727T124642-372@post.gmane.org>

Hi guys, I'm experiencing an issue when running some simple tests 
involving multithreading. I would like to know if it is something I am 
not doing correctly with GDAL or it is a GDAL business dealing with 
threads and block cache. 

To make long story short, just imagine two threads accessing different 
raster dataset (different files) and looping through all of its pixels 
to read its value. So, for each pixel I do something like:

// Lock.
GDALRasterBlock* poBlock = m_poRB->GetLockedBlockRef(blockXIndex, 
blockYIndex);
void* pData = poBlock->GetDataRef();

// Access value.
T value = ((T*)pData)[blockOffset];

// Unlock.
poBlock->DropLock();


I know this is a very aggressive way to access the pixel value as I'm 
locking/unlocking in a pixel basis instead of a block basis (I mean 
here, locking the block just once and reading all of its pixels, and 
then unlocking), and also it may decrease performance. But I'm limited 
by some requirements in my application legacy code and there is not much 
I can do. 

The problem with this implementation is that I get an assertion failed 
in gdalrasterblock.cpp line 800, which is in summary, the moment where a 
'touched' block is moved on top of the LRU block cache list. It seems 
that a race condition may be happening between threads.

So my question is: this way of accessing pixels with so many block 
locks/unlocks is fully supported by GDAL as thread-safe? Or is it a bug 
in GDAL's block cache management?

Thank you so much for your time and help.


From david.ferdoille at gmail.com  Wed Jul 27 06:12:37 2016
From: david.ferdoille at gmail.com (David Ferdoille)
Date: Wed, 27 Jul 2016 15:12:37 +0200
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
Message-ID: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>

Hello all,

We are trying to render S57 files as ENC through Geoserver.

We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile for 1 class
(ex : COALNE) and 1 geometry type (LINE) :
ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
"LNAM_REFS=ON" CELLLL.000 COALNE
ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or
OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG

We use gdal-2.1.0 with the S57_CSV environnement variable
(S57_CSV=/usr/local/share/gdal/ with s57*.csv files).


We noticed that objects (of COALNE class for example) have multiple
geometries and each sub-geometry have attributes like POSACC and QUAPOS
which are important for S52 representation.
We've succeeded to extract primitives (Edge, isolated points, connected
points, ...), but it looks very complex to operate.


We have some problems to extract geometries from s57 objects :
- we noticed that, for an object, all sub-geometries are aggregated to one
geometry
- we didn't succeed to extract geometry attributes like POSACC and QUAPOS


1) Is there a way to not aggregate sub-geometries of an object and get this
list of sub-geometries ?
2) Is there a way to extract geometry attributes like POSACC and QUAPOS ?
3) If not, are these features planned ?


Thanks for your help !


David
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160727/67cf48b4/attachment.html>

From even.rouault at spatialys.com  Wed Jul 27 08:40:45 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jul 2016 17:40:45 +0200
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
 <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>
Message-ID: <5508083.oPV583goY6@even-n550jk>

> Two things (the full list of changes is at
> https://tools.ietf.org/html/draft-ietf-geojson-04#appendix-B.1):
> 
> 1. GeoJSON objects MUST NOT contain the defining members of other types.
> For example, a GeoJSON Feature must not have a "features" member. I don't
> see this coming up when converting from other formats, but OGR's GeoJSON
> driver should filter these out of native data when writing GeoJSON.

OK indeed can only happen if contained in source native data

If I read 7.1 correctly, "coordinates", "geometries" and "features" are the 
forbidden members of Feature
And "coordinates", "geometries", "geometry", "properties" for 
FeatureCollection
Regarding geometry forbidden members, there's nothing to do as they aren't 
imported from source native data.

> 
> 2. Implementations SHOULD NOT extend position arrays beyond 3 elements. The
> OGR driver should not by default write anything other than X, Y, Z. If it
> currently writes X, Y, Z, and M, the M should be omitted.

It doesn't currently write the M dimension.

> 
> There's one informative change in
> https://tools.ietf.org/html/draft-ietf-geojson-04#appendix-B.2 that is
> relevant. When GeoJSON output is CRS84 only we can certainly reduce the
> default coordinate precision from 15 to 6 or 7.
> 

1e-7 degree gives roughly 1cm precision. Probably a reasonable default for 
most applications.

> 
> Automatic reprojection to CRS84 would break existing systems that counted
> on preservation of CRS. Addition of a configuration option like
> OGR_GEOJSON_2008=TRUE would help, but this would still be a breaking
> change, would it not?

Automatic reprojection by default would indeed be a change. Difficult to say how 
breaking it is for existing workflows. Would be happy to hear about others' 
opinions. Another option would be to make RFCxxxx conformance an explicit user 
choice.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul 27 08:42:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jul 2016 17:42:27 +0200
Subject: [gdal-dev] Transforming rasters with the C API
In-Reply-To: <CAGOzVwn37tJRUDVNhTxgBNyKqggc2P=hu0ef0RMum+vP8Nx=6g@mail.gmail.com>
References: <CAGOzVwn37tJRUDVNhTxgBNyKqggc2P=hu0ef0RMum+vP8Nx=6g@mail.gmail.com>
Message-ID: <3065573.xZCBf0zlz0@even-n550jk>

Pablo,

Have a look at http://gdal.org/warptut.html if not already done.

If using GDAL 2.1, you can also use GDALWarp() : 
http://gdal.org/gdal__utils_8h.html#ab2094d5332364d63e0851dcb12398469

Even

> Hello,
> 
> I'm trying to transform a raster into a different projection using the
> public C functions exposed in gdal_alg.h
> 
> I have some code that I have been testing using the functions
> GDALCreateGenImgProjTransformer()
> and GDALGenImgProjTransform():
> 
> https://gist.github.com/monkeybutter/8367132e9683a4eb823a0175586a25b1
> 
> Obviously I'm doing something wrong (the code segment faults), but I cannot
> find any example or tutorial that explains how this operations should be
> performed. Does anyone have a recommendation or example that shows this
> functionality?
> 
> Thank you very much for your help,
> 
> Kind regards,
> Pablo

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul 27 08:53:24 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jul 2016 17:53:24 +0200
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
	(GDAL 2.1.0)
In-Reply-To: <loom.20160727T124642-372@post.gmane.org>
References: <loom.20160727T124642-372@post.gmane.org>
Message-ID: <2073744.nS3JUVbTTZ@even-n550jk>

Javier,

Your use case looks like a legit use case of the API. I'm not aware of bugs 
regarding to locking of the raster block cache, but that doesn't mean that 
they aren't any. Could you prepare a self contained source code + dataset that 
would reproduce the issue ?

As far as I can see, GDALRasterBlock::Touch_unlocked() should only be invoked 
inside a mutex, so I wouldn't expect races.

We have a test program that stress tests the block cache, but at a higher 
level (RasterIO) : 
https://svn.osgeo.org/gdal/trunk/autotest/cpp/testblockcache.cpp
It is run in our continuous integration and works fine.

Even

> Hi guys, I'm experiencing an issue when running some simple tests
> involving multithreading. I would like to know if it is something I am
> not doing correctly with GDAL or it is a GDAL business dealing with
> threads and block cache.
> 
> To make long story short, just imagine two threads accessing different
> raster dataset (different files) and looping through all of its pixels
> to read its value. So, for each pixel I do something like:
> 
> // Lock.
> GDALRasterBlock* poBlock = m_poRB->GetLockedBlockRef(blockXIndex,
> blockYIndex);
> void* pData = poBlock->GetDataRef();
> 
> // Access value.
> T value = ((T*)pData)[blockOffset];
> 
> // Unlock.
> poBlock->DropLock();
> 
> 
> I know this is a very aggressive way to access the pixel value as I'm
> locking/unlocking in a pixel basis instead of a block basis (I mean
> here, locking the block just once and reading all of its pixels, and
> then unlocking), and also it may decrease performance. But I'm limited
> by some requirements in my application legacy code and there is not much
> I can do.
> 
> The problem with this implementation is that I get an assertion failed
> in gdalrasterblock.cpp line 800, which is in summary, the moment where a
> 'touched' block is moved on top of the LRU block cache list. It seems
> that a race condition may be happening between threads.
> 
> So my question is: this way of accessing pixels with so many block
> locks/unlocks is fully supported by GDAL as thread-safe? Or is it a bug
> in GDAL's block cache management?
> 
> Thank you so much for your time and help.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul 27 09:10:35 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jul 2016 18:10:35 +0200
Subject: [gdal-dev] gdal_translate with -projwin possible bug
In-Reply-To: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
Message-ID: <3177995.UVQ4a6Mh8Y@even-n550jk>

Hi Lauren,

This change was semi intended as far as I can remember (the change that leads 
to that was intended, the effect in this use case not) . It dates back to GDAL 
2.1.0 where the VRT driver can now support floating point coordinates for 
SrcWin / DestWin, and gdal_translate was updated accordingly to not round to 
integer pixel coordinates deduced from world coordinates specified through -
projwin.  Sub pixel accuracy makes sense when using with a resampling that is 
not nearest neighbour with the -r switch. But indeed for nearest neighbour, it 
might result in a non intended shift.
Perhaps a good compromise would be to round to integer for nearest neighbour 
only ?

Regarding Jukka's comment,
> I am sure that there are also users who consider that it is a bug if the
> output does not exactly match -projwin.

Using -a_ullr is a way of definining the output bounds for sure.

Even

> Hello all,
> 
> I've noticed what I think may be a bug with gdal_translate, just looking
> for further information before deciding whether to report it.
> 
> In version 1.11.4 and earlier, using the -projwin tag to subset a raster
> produces an output whose cell alignment and content matches the source
> dataset - it just grabs any cells that intersect the box and writes them to
> the output.
> 
> In v2.1.0 (at least in a Windows environment), this no longer occurs. The
> output raster is distorted to match the exact extent of the -projwin
> coordinates. No resampling is involved, but the cell origins shift, and the
> cell sizes are either shrunk or stretched slightly to conform to the
> projwin box. This is a substantial change in behaviour which doesn't appear
> to have been documented.
> 
> From my point of view, its an unwelcome change. I've been using
> gdal_translate with -projwin and vsicurl to clip out sections of large
> national datasets without having to download the whole file first, and
> without needing to know things like the source dataset origin, cellsize etc
> in order to ensure output aligns with input. I need each dataset I clip out
> to 'stack' properly, and to represent an unaltered subset of the source
> data.
> 
> Please let me know if this is a true bug or just an undocumented change,
> and/or if there's a better alternative command to use.
> 
> Regards,
> Lauren O'Brien

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Jul 27 10:04:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Jul 2016 19:04:37 +0200
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
Message-ID: <2507480.oUhD20l1Fk@even-n550jk>

David,

As far as I can see from s57objectclasses.csv, POSACC and QUAPOS are not 
attributes of the COALNE class, but only from the M_ACCY (Accuracy of data) 
and M_QUAL (Quality of data) for POSACC, and M_SREL (Survey reliability) for 
QUAPOS.

You might probably retrieve those attributes by identifying features of COALNE 
and M_ACCY/M_QUAL/M_SREL that share the same geometry primitives with the 
NAME_RCNM and NAME_RCID attributes added with RETURN_LINKAGES=ON. Or perhaps 
an easier way would be by layer algebra computation to find which features of 
COALNE are inside features of M_ACCY/M_QUAL/M_SREL. Probably with the Identify 
method.

See 
http://download.osgeo.org/gdal/workshop/foss4ge2015/workshop_gdal.html#__RefHeading__6015_1333016408

By the way, when testing, I identified a regression in 2.1.1 where the open 
options of the S57 driver were ignored, that I just fixed per : 
https://trac.osgeo.org/gdal/ticket/6609

Even

> Hello all,
> 
> We are trying to render S57 files as ENC through Geoserver.
> 
> We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile for 1 class
> (ex : COALNE) and 1 geometry type (LINE) :
> ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
> "LNAM_REFS=ON" CELLLL.000 COALNE
> ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or
> OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG
> 
> We use gdal-2.1.0 with the S57_CSV environnement variable
> (S57_CSV=/usr/local/share/gdal/ with s57*.csv files).
> 
> 
> We noticed that objects (of COALNE class for example) have multiple
> geometries and each sub-geometry have attributes like POSACC and QUAPOS
> which are important for S52 representation.
> We've succeeded to extract primitives (Edge, isolated points, connected
> points, ...), but it looks very complex to operate.
> 
> 
> We have some problems to extract geometries from s57 objects :
> - we noticed that, for an object, all sub-geometries are aggregated to one
> geometry
> - we didn't succeed to extract geometry attributes like POSACC and QUAPOS
> 
> 
> 1) Is there a way to not aggregate sub-geometries of an object and get this
> list of sub-geometries ?
> 2) Is there a way to extract geometry attributes like POSACC and QUAPOS ?
> 3) If not, are these features planned ?
> 
> 
> Thanks for your help !
> 
> 
> David

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Wed Jul 27 14:19:53 2016
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 27 Jul 2016 15:19:53 -0600
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <5508083.oPV583goY6@even-n550jk>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
 <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>
 <5508083.oPV583goY6@even-n550jk>
Message-ID: <CADPhZXwMCSEY4Q1MFVphVXFjPPg3dTBjTNf+d6a4yaaQ_+92+g@mail.gmail.com>

On Wed, Jul 27, 2016 at 9:40 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> ...

> Automatic reprojection to CRS84 would break existing systems that counted
> > on preservation of CRS. Addition of a configuration option like
> > OGR_GEOJSON_2008=TRUE would help, but this would still be a breaking
> > change, would it not?
>
> Automatic reprojection by default would indeed be a change. Difficult to
> say how
> breaking it is for existing workflows. Would be happy to hear about others'
> opinions. Another option would be to make RFCxxxx conformance an explicit
> user
> choice.
>

I'm concerned that requiring users to set an environment variable for
conformance will extend the period of transition from 2008 to RFC GeoJSON.
I honestly don't know that introducing a new format name ("geo+json"
instead of "GeoJSON") would be better, but I think it could be better:
`ogr2ogr -f geo+json` appears more portable (to, i.e., Windows) than
`RFCxxxx_GEOJSON=TRUE ogr2ogr -f GeoJSON`.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160727/02aae9b6/attachment.html>

From cgodkin at gmail.com  Wed Jul 27 14:44:15 2016
From: cgodkin at gmail.com (Carl Godkin)
Date: Wed, 27 Jul 2016 14:44:15 -0700
Subject: [gdal-dev] Using GDAL WMS with https
Message-ID: <CAE=8kmkyNkU6cQTpD6tzoCXhKBQrRsTLC1bok6GuevoWhKmdhQ@mail.gmail.com>

Hi,

For the first time, I'm trying to use WMS with a server with an "https" URL.

Unless I add <UnsafeSSL>true</UnsafeSSL> to the service description file or
set GDAL_HTTP_UNSAFESSL=YES before running my application, I get an error
like this:

  HTTP status code: 0, error: SSL certificate problem: unable to get local
issuer certificate.

Instead of declaring the site unsafe, I've got a root certificate bundle
that I would like to point at.  I tried setting CURL_CA_BUNDLE (suggested
by the curl documentation) to this file but it doesn't seem to help.

Is there a way to specify a CA bundle in this context?

Thanks,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160727/cb2b4228/attachment.html>

From leobrien at gmail.com  Wed Jul 27 16:18:36 2016
From: leobrien at gmail.com (Lauren O'Brien)
Date: Thu, 28 Jul 2016 09:18:36 +1000
Subject: [gdal-dev] gdal_translate with -projwin possible bug
In-Reply-To: <3177995.UVQ4a6Mh8Y@even-n550jk>
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
 <3177995.UVQ4a6Mh8Y@even-n550jk>
Message-ID: <57994144.4e42620a.13060.a865@mx.google.com>

Hi Evan,

Ok I thought it might have been at least partially intended. Unfortunately, I think the use case the change is addressing is not what the majority of users are thinking of when they choose projwin. 

As Rutger pointed out, the Clipper tool in QGIS 2.14 onwards is now incapable of producing an output that lines up with input, unless the user spends some time doing coordinate math to calculate a precise projwin. That’s a pretty major efficiency loss. Questions about how to clip a raster without resampling or alignment changes appear regularly on stackexchange (see http://gis.stackexchange.com/questions/201204/qgis-clipper-tool-misaliagnment , and http://gis.stackexchange.com/questions/203664/clip-a-tiff-raster-image-using-a-bounding-box-with-python) and gdal_translate with projwin is regularly recommended as the most viable solution.

Jukka, I tried gdal_warp with -te and -tap (one must also input -tr). It was better in that the cell sizes didn’t change, but the output cells moved slightly northwest, such that the center of the input cell became the lower right corner of the output cell. I guess that could be fixed by using gdal_edit with -a_ullr to nudge the output back into place, but that’s still extra work that shouldn’t be necessary.

I think it would be better if projwin’s functionality reverted to its previous behaviour as a default, and that an additional flag be made available for people who do want strict conformance with their specified bounding box as part of a resampling operation.

Either way, the way projwin works in different versions needs to be made explicit in the documentation. 

Regards
Lauren


From: Even Rouault
Sent: Thursday, 28 July 2016 2:10 AM
To: gdal-dev at lists.osgeo.org; Jukka Rahkonen
Cc: Lauren O'Brien
Subject: Re: [gdal-dev] gdal_translate with -projwin possible bug

Hi Lauren,

This change was semi intended as far as I can remember (the change that leads 
to that was intended, the effect in this use case not) . It dates back to GDAL 
2.1.0 where the VRT driver can now support floating point coordinates for 
SrcWin / DestWin, and gdal_translate was updated accordingly to not round to 
integer pixel coordinates deduced from world coordinates specified through -
projwin.  Sub pixel accuracy makes sense when using with a resampling that is 
not nearest neighbour with the -r switch. But indeed for nearest neighbour, it 
might result in a non intended shift.
Perhaps a good compromise would be to round to integer for nearest neighbour 
only ?

Regarding Jukka's comment,
> I am sure that there are also users who consider that it is a bug if the
> output does not exactly match -projwin.

Using -a_ullr is a way of definining the output bounds for sure.

Even

> Hello all,
> 
> I've noticed what I think may be a bug with gdal_translate, just looking
> for further information before deciding whether to report it.
> 
> In version 1.11.4 and earlier, using the -projwin tag to subset a raster
> produces an output whose cell alignment and content matches the source
> dataset - it just grabs any cells that intersect the box and writes them to
> the output.
> 
> In v2.1.0 (at least in a Windows environment), this no longer occurs. The
> output raster is distorted to match the exact extent of the -projwin
> coordinates. No resampling is involved, but the cell origins shift, and the
> cell sizes are either shrunk or stretched slightly to conform to the
> projwin box. This is a substantial change in behaviour which doesn't appear
> to have been documented.
> 
> From my point of view, its an unwelcome change. I've been using
> gdal_translate with -projwin and vsicurl to clip out sections of large
> national datasets without having to download the whole file first, and
> without needing to know things like the source dataset origin, cellsize etc
> in order to ensure output aligns with input. I need each dataset I clip out
> to 'stack' properly, and to represent an unaltered subset of the source
> data.
> 
> Please let me know if this is a true bug or just an undocumented change,
> and/or if there's a better alternative command to use.
> 
> Regards,
> Lauren O'Brien

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160728/089990ae/attachment.html>

From teddyguerin at yahoo.fr  Wed Jul 27 23:46:54 2016
From: teddyguerin at yahoo.fr (teddy guerin)
Date: Thu, 28 Jul 2016 06:46:54 +0000 (UTC)
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <2507480.oUhD20l1Fk@even-n550jk>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
 <2507480.oUhD20l1Fk@even-n550jk>
Message-ID: <2076521415.10038624.1469688414748.JavaMail.yahoo@mail.yahoo.com>

Hi, 

I apologize for my english. 
POSACC and QUAPOS are specfic attributes (only spatial attributes but we can consider as meta object attributes and not as meta object M_SREL, M_QUAL, M_*). 
Objects with POSACC and QUAPOS are points, and mainly SOUNDG, WRECKS, UWTROC, OBSTRN in S57 format.
Currently, I'm testing with HPD Caris and when I want to export datas with POSACC and QUAPOS, it don't works. 
BEst regardsTed

      De : Even Rouault <even.rouault at spatialys.com>
 À : gdal-dev at lists.osgeo.org 
 Envoyé le : Mercredi 27 juillet 2016 19h04
 Objet : Re: [gdal-dev] OGR - S57 - geometry extraction issue
   
David,

As far as I can see from s57objectclasses.csv, POSACC and QUAPOS are not 
attributes of the COALNE class, but only from the M_ACCY (Accuracy of data) 
and M_QUAL (Quality of data) for POSACC, and M_SREL (Survey reliability) for 
QUAPOS.

You might probably retrieve those attributes by identifying features of COALNE 
and M_ACCY/M_QUAL/M_SREL that share the same geometry primitives with the 
NAME_RCNM and NAME_RCID attributes added with RETURN_LINKAGES=ON. Or perhaps 
an easier way would be by layer algebra computation to find which features of 
COALNE are inside features of M_ACCY/M_QUAL/M_SREL. Probably with the Identify 
method.

See 
http://download.osgeo.org/gdal/workshop/foss4ge2015/workshop_gdal.html#__RefHeading__6015_1333016408

By the way, when testing, I identified a regression in 2.1.1 where the open 
options of the S57 driver were ignored, that I just fixed per : 
https://trac.osgeo.org/gdal/ticket/6609

Even

> Hello all,
> 
> We are trying to render S57 files as ENC through Geoserver.
> 
> We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile for 1 class
> (ex : COALNE) and 1 geometry type (LINE) :
> ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo
> "LNAM_REFS=ON" CELLLL.000 COALNE
> ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or
> OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG
> 
> We use gdal-2.1.0 with the S57_CSV environnement variable
> (S57_CSV=/usr/local/share/gdal/ with s57*.csv files).
> 
> 
> We noticed that objects (of COALNE class for example) have multiple
> geometries and each sub-geometry have attributes like POSACC and QUAPOS
> which are important for S52 representation.
> We've succeeded to extract primitives (Edge, isolated points, connected
> points, ...), but it looks very complex to operate.
> 
> 
> We have some problems to extract geometries from s57 objects :
> - we noticed that, for an object, all sub-geometries are aggregated to one
> geometry
> - we didn't succeed to extract geometry attributes like POSACC and QUAPOS
> 
> 
> 1) Is there a way to not aggregate sub-geometries of an object and get this
> list of sub-geometries ?
> 2) Is there a way to extract geometry attributes like POSACC and QUAPOS ?
> 3) If not, are these features planned ?
> 
> 
> Thanks for your help !
> 
> 
> David

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160728/0edfaa29/attachment-0001.html>

From robert.coup at koordinates.com  Thu Jul 28 03:00:51 2016
From: robert.coup at koordinates.com (Robert Coup)
Date: Thu, 28 Jul 2016 11:00:51 +0100
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <CADPhZXwMCSEY4Q1MFVphVXFjPPg3dTBjTNf+d6a4yaaQ_+92+g@mail.gmail.com>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
 <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>
 <5508083.oPV583goY6@even-n550jk>
 <CADPhZXwMCSEY4Q1MFVphVXFjPPg3dTBjTNf+d6a4yaaQ_+92+g@mail.gmail.com>
Message-ID: <CAFLLRpLYBo_kjN6Z4dRyvJ0QkXx=S0mLwTg_PAku09Tq_0K_=A@mail.gmail.com>

Hi All,

On 27 July 2016 at 22:19, Sean Gillies <sean at mapbox.com> wrote:

> On Wed, Jul 27, 2016 at 9:40 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>>
>> Automatic reprojection by default would indeed be a change. Difficult to
>> say how
>> breaking it is for existing workflows. Would be happy to hear about
>> others'
>> opinions. Another option would be to make RFCxxxx conformance an explicit
>> user
>> choice.
>>
>
> I'm concerned that requiring users to set an environment variable for
> conformance will extend the period of transition from 2008 to RFC GeoJSON.
> I honestly don't know that introducing a new format name ("geo+json"
> instead of "GeoJSON") would be better, but I think it could be better:
> `ogr2ogr -f geo+json` appears more portable (to, i.e., Windows) than
> `RFCxxxx_GEOJSON=TRUE ogr2ogr -f GeoJSON`.
>

Personally I'd prefer RFC-by-default and no automatic reprojection -- with
an error if the CRS isn't CRS84. Be able to opt into old style with config
options, which would enable outputting either fully GeoJSON2008, or opting
into or out-of individual RFC features (eg. fully RFC-style except using an
alternate CRS, or skipping antimeridian-cutting). These options should
enable people to migrate systems gradually.

The above doesn't do good things for GDAL backwards compatibility though :)

Cheers,

Rob.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160728/544def3c/attachment.html>

From mateusz at loskot.net  Thu Jul 28 03:36:32 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 28 Jul 2016 12:36:32 +0200
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <CAFLLRpLYBo_kjN6Z4dRyvJ0QkXx=S0mLwTg_PAku09Tq_0K_=A@mail.gmail.com>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <10352331.5rHi9ME0H4@even-n550jk>
 <CADPhZXw49nBQFnOkYDjPWu5A_LAWpd24D+aUx53GTU0+3Tuqzw@mail.gmail.com>
 <5508083.oPV583goY6@even-n550jk>
 <CADPhZXwMCSEY4Q1MFVphVXFjPPg3dTBjTNf+d6a4yaaQ_+92+g@mail.gmail.com>
 <CAFLLRpLYBo_kjN6Z4dRyvJ0QkXx=S0mLwTg_PAku09Tq_0K_=A@mail.gmail.com>
Message-ID: <CABUeae-hWsYMvsoDQNCVws23GLuaryvgGK-sbA8Mf1Q1PTPS_g@mail.gmail.com>

On 28 July 2016 at 12:00, Robert Coup <robert.coup at koordinates.com> wrote:
> On 27 July 2016 at 22:19, Sean Gillies <sean at mapbox.com> wrote:
>> On Wed, Jul 27, 2016 at 9:40 AM, Even Rouault <even.rouault at spatialys.com>
>> wrote:
>>>
>>>
>>> Automatic reprojection by default would indeed be a change. Difficult to
>>> say how
>>> breaking it is for existing workflows. Would be happy to hear about
>>> others'
>>> opinions. Another option would be to make RFCxxxx conformance an explicit
>>> user
>>> choice.
>>
>>
>> I'm concerned that requiring users to set an environment variable for
>> conformance will extend the period of transition from 2008 to RFC GeoJSON. I
>> honestly don't know that introducing a new format name ("geo+json" instead
>> of "GeoJSON") would be better, but I think it could be better: `ogr2ogr -f
>> geo+json` appears more portable (to, i.e., Windows) than
>> `RFCxxxx_GEOJSON=TRUE ogr2ogr -f GeoJSON`.
>
>
> Personally I'd prefer RFC-by-default and no automatic reprojection -- with
> an error if the CRS isn't CRS84. Be able to opt into old style with config

That would change the current behaviour and might be unacceptable,
by PSC or users, then that is a good reason to create a new driver.
Problem might be with the names, having two drivers means two names,
and GeoJSON would still point to old driver which became de facto
non-GeoJSON driver. Confusing.


> The above doesn't do good things for GDAL backwards compatibility though :)

Indeed.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From antonijevic.ognjen at gmail.com  Thu Jul 28 04:12:16 2016
From: antonijevic.ognjen at gmail.com (Ognjen)
Date: Thu, 28 Jul 2016 04:12:16 -0700 (PDT)
Subject: [gdal-dev] gdal_rasterize problem with polygons containing polygons
Message-ID: <1469704336965-5278563.post@n6.nabble.com>

Hi everyone,

I tried to create a raster mask from a .gml file with polygons (polygons
represent cloud coverage of a satellite image).
So I used gdal_rasterize with -i flag (because i want to cut out the clouds
from the image). The problem is that polygon layer contains polygons which
are inside one another, so gdal_rasterize is not working properly in this
case.
The first two images illustrate the vector layer, and the third is the
output raster. Can anyone help me to bypass this problem?
<http://osgeo-org.1560.x6.nabble.com/file/n5278563/1.png> 
<http://osgeo-org.1560.x6.nabble.com/file/n5278563/2.png> 
<http://osgeo-org.1560.x6.nabble.com/file/n5278563/3.png> 

Thanks, Ognjen



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-rasterize-problem-with-polygons-containing-polygons-tp5278563.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From antonijevic.ognjen at gmail.com  Thu Jul 28 04:14:37 2016
From: antonijevic.ognjen at gmail.com (Ognjen)
Date: Thu, 28 Jul 2016 04:14:37 -0700 (PDT)
Subject: [gdal-dev] gdal_rasterize problem with polygons containing
	polygons
In-Reply-To: <1469704336965-5278563.post@n6.nabble.com>
References: <1469704336965-5278563.post@n6.nabble.com>
Message-ID: <1469704477433-5278564.post@n6.nabble.com>

This is the .gml file
S2A_OPER_MSK_CLOUDS_MPS__20160616T131744_A005138_T34TER_B00_MSIL1C.gml
<http://osgeo-org.1560.x6.nabble.com/file/n5278564/S2A_OPER_MSK_CLOUDS_MPS__20160616T131744_A005138_T34TER_B00_MSIL1C.gml>  



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-rasterize-problem-with-polygons-containing-polygons-tp5278563p5278564.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From francisco.javier.calzado at ericsson.com  Thu Jul 28 06:11:13 2016
From: francisco.javier.calzado at ericsson.com (Francisco Javier Calzado)
Date: Thu, 28 Jul 2016 13:11:13 +0000
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
 (GDAL 2.1.0)
In-Reply-To: <2073744.nS3JUVbTTZ@even-n550jk>
References: <loom.20160727T124642-372@post.gmane.org>
 <2073744.nS3JUVbTTZ@even-n550jk>
Message-ID: <6BA6E0BBA9988E428FA9178AB0B28B4857628F76@ESESSMB205.ericsson.se>

Thanks Even,

I don't want to waste your time, so just before sending any code to be tested I would like to be sure it is not a bug from my side. Although I usually work with GDAL compiled in 64bits, I had to swap to x86 for these tests. When trying to compile in 32bits with Visual Studio 2015 I got the following unresolved symbols:

-----------------------------------------------
        link /nologo /dll /INCLUDE:OSRValidate  /INCLUDE:OPTGetProjectionMethods  /INCLUDE:OGR_G_GetPointCount  /INCLUDE:OGRRegisterAll /INCLUDE:GDALSimpleImageWarp  /INCLUDE:GDALReprojectImage  /INCLUDE:GDALComputeMedianCutPCT  /INCLUDE:GDALDitherRGB2PCT  /INCLUDE:OCTNewCoordinateTransformation port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib gnm\*.obj gnm\gnm_frmts\o\*.obj   apps\commonutils.obj apps\gdalinfo_lib.obj apps\gdal_translate_lib.obj apps\gdalwarp_lib.obj apps\ogr2ogr_lib.obj  apps\gdaldem_lib.obj apps\nearblack_lib.obj apps\gdal_grid_lib.obj apps\gdal_rasterize_lib.obj apps\gdalbuildvrt_lib.obj .\..\expat-2.2.0/lib/libexpat.lib                 .\..\sqlite-3.12.2\sqlite3.lib   .\..\geos-3.5.0\src\geos_c_i.lib legacy_stdio_definitions.lib odbc32.lib odbccp32.lib user32.lib ws2_32.lib gcore\Version.res  /out:gdal201.dll /implib:gdal_i.lib   /debug
   Creating library gdal_i.lib and object gdal_i.exp
LINK : error LNK2001: unresolved external symbol OCTNewCoordinateTransformation
LINK : error LNK2001: unresolved external symbol GDALDitherRGB2PCT
LINK : error LNK2001: unresolved external symbol GDALComputeMedianCutPCT
LINK : error LNK2001: unresolved external symbol GDALReprojectImage
LINK : error LNK2001: unresolved external symbol GDALSimpleImageWarp
LINK : error LNK2001: unresolved external symbol OGRRegisterAll
LINK : error LNK2001: unresolved external symbol OGR_G_GetPointCount
LINK : error LNK2001: unresolved external symbol OPTGetProjectionMethods
LINK : error LNK2001: unresolved external symbol OSRValidate
gdal201.dll : fatal error LNK1120: 9 unresolved externals
NMAKE : fatal error U1077: '"C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\BIN\link.EXE"' : return code '0x460'
Stop.
--------------------------------------

So, in order to get the DLL, I manually linked it just by invoking the previous link command without all the "/INCLUDES" that were failing:

--------------------------------------

        link /nologo /dll port\*.obj gcore\*.obj alg\*.obj frmts\o\*.obj ogr\ogrsf_frmts\ogrsf_frmts.lib ogr\ogr.lib gnm\*.obj gnm\gnm_frmts\o\*.obj   apps\commonutils.obj apps\gdalinfo_lib.obj apps\gdal_translate_lib.obj apps\gdalwarp_lib.obj apps\ogr2ogr_lib.obj  apps\gdaldem_lib.obj apps\nearblack_lib.obj apps\gdal_grid_lib.obj apps\gdal_rasterize_lib.obj apps\gdalbuildvrt_lib.obj .\..\expat-2.2.0/lib/libexpat.lib .\..\sqlite-3.12.2\sqlite3.lib   .\..\geos-3.5.0\src\geos_c_i.lib legacy_stdio_definitions.lib odbc32.lib odbccp32.lib user32.lib ws2_32.lib gcore\Version.res  /out:gdal201.dll /implib:gdal_i.lib   /debug

--------------------------------------

Although I do not call any of the missing symbols from my code, do you think this could be the reason of the problem? Why is it failing with VS2015 in x86 (I can build GDAL in x64 with no problem)?





Javier,

Your use case looks like a legit use case of the API. I'm not aware of bugs regarding to locking of the raster block cache, but that doesn't mean that they aren't any. Could you prepare a self contained source code + dataset that would reproduce the issue ?

As far as I can see, GDALRasterBlock::Touch_unlocked() should only be invoked inside a mutex, so I wouldn't expect races.

We have a test program that stress tests the block cache, but at a higher level (RasterIO) : 
https://svn.osgeo.org/gdal/trunk/autotest/cpp/testblockcache.cpp
It is run in our continuous integration and works fine.

Even

> Hi guys, I'm experiencing an issue when running some simple tests 
> involving multithreading. I would like to know if it is something I am 
> not doing correctly with GDAL or it is a GDAL business dealing with 
> threads and block cache.
> 
> To make long story short, just imagine two threads accessing different 
> raster dataset (different files) and looping through all of its pixels 
> to read its value. So, for each pixel I do something like:
> 
> // Lock.
> GDALRasterBlock* poBlock = m_poRB->GetLockedBlockRef(blockXIndex,
> blockYIndex);
> void* pData = poBlock->GetDataRef();
> 
> // Access value.
> T value = ((T*)pData)[blockOffset];
> 
> // Unlock.
> poBlock->DropLock();
> 
> 
> I know this is a very aggressive way to access the pixel value as I'm 
> locking/unlocking in a pixel basis instead of a block basis (I mean 
> here, locking the block just once and reading all of its pixels, and 
> then unlocking), and also it may decrease performance. But I'm limited 
> by some requirements in my application legacy code and there is not 
> much I can do.
> 
> The problem with this implementation is that I get an assertion failed 
> in gdalrasterblock.cpp line 800, which is in summary, the moment where 
> a 'touched' block is moved on top of the LRU block cache list. It 
> seems that a race condition may be happening between threads.
> 
> So my question is: this way of accessing pixels with so many block 
> locks/unlocks is fully supported by GDAL as thread-safe? Or is it a 
> bug in GDAL's block cache management?
> 
> Thank you so much for your time and help.
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul 28 08:36:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jul 2016 17:36:32 +0200
Subject: [gdal-dev] Using GDAL WMS with https
In-Reply-To: <CAE=8kmkyNkU6cQTpD6tzoCXhKBQrRsTLC1bok6GuevoWhKmdhQ@mail.gmail.com>
References: <CAE=8kmkyNkU6cQTpD6tzoCXhKBQrRsTLC1bok6GuevoWhKmdhQ@mail.gmail.com>
Message-ID: <3597283.VRcVCvSIJM@even-n550jk>

Carl,

As far as I can see, there's no way to currently set CURL_CA_BUNDLE through 
GDAL. Would be likely a few lines to add in port/cpl_http.cpp

Even

> Hi,
> 
> For the first time, I'm trying to use WMS with a server with an "https" URL.
> 
> Unless I add <UnsafeSSL>true</UnsafeSSL> to the service description file or
> set GDAL_HTTP_UNSAFESSL=YES before running my application, I get an error
> like this:
> 
>   HTTP status code: 0, error: SSL certificate problem: unable to get local
> issuer certificate.
> 
> Instead of declaring the site unsafe, I've got a root certificate bundle
> that I would like to point at.  I tried setting CURL_CA_BUNDLE (suggested
> by the curl documentation) to this file but it doesn't seem to help.
> 
> Is there a way to specify a CA bundle in this context?
> 
> Thanks,
> 
> carl

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul 28 08:41:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jul 2016 17:41:55 +0200
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
	(GDAL 2.1.0)
In-Reply-To: <6BA6E0BBA9988E428FA9178AB0B28B4857628F76@ESESSMB205.ericsson.se>
References: <loom.20160727T124642-372@post.gmane.org>
 <2073744.nS3JUVbTTZ@even-n550jk>
 <6BA6E0BBA9988E428FA9178AB0B28B4857628F76@ESESSMB205.ericsson.se>
Message-ID: <1546040.dbNMDothQ9@even-n550jk>

On Thursday 28 July 2016 13:11:13 Francisco Javier Calzado wrote:
> Thanks Even,
> 
> I don't want to waste your time, so just before sending any code to be
> tested I would like to be sure it is not a bug from my side. Although I
> usually work with GDAL compiled in 64bits, I had to swap to x86 for these
> tests. When trying to compile in 32bits with Visual Studio 2015 I got the
> following unresolved symbols:

Javier,

Make sure the Visual Studio 32bit environment is properly set up. Check that
WIN64 from nmake.opt is let commented out.
Example of successful build:
https://ci.appveyor.com/project/rouault/gdal-coverage/build/job/8widewvmhgjotxs5

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul 28 09:12:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jul 2016 18:12:40 +0200
Subject: [gdal-dev] Time for a new GeoJSON driver?
In-Reply-To: <CABUeae-hWsYMvsoDQNCVws23GLuaryvgGK-sbA8Mf1Q1PTPS_g@mail.gmail.com>
References: <CADPhZXy0uLwei5sbYOo9c84MsuktC=7gdVjG+qgzgdROGvZqiw@mail.gmail.com>
 <CAFLLRpLYBo_kjN6Z4dRyvJ0QkXx=S0mLwTg_PAku09Tq_0K_=A@mail.gmail.com>
 <CABUeae-hWsYMvsoDQNCVws23GLuaryvgGK-sbA8Mf1Q1PTPS_g@mail.gmail.com>
Message-ID: <2244266.tPmJZtzF6Q@even-n550jk>

> >> 
> >> I'm concerned that requiring users to set an environment variable for
> >> conformance will extend the period of transition from 2008 to RFC
> >> GeoJSON. I honestly don't know that introducing a new format name
> >> ("geo+json" instead of "GeoJSON") would be better, 

Yes, the casual user would have trouble making the difference between geo+json 
and GeoJSON without reading carefully the doc. And RFCxxxx would be too 
obscure. A GeoJSONv2 would be more intuitive but

> >> but I think it could
> >> be better: `ogr2ogr -f geo+json` appears more portable (to, i.e.,
> >> Windows) than
> >> `RFCxxxx_GEOJSON=TRUE ogr2ogr -f GeoJSON`.

I wouldn't use a config option/environment variable for that, but a new layer 
creation option added to the existing ones :

<LayerCreationOptionList>
  <Option name="WRITE_BBOX" type="boolean" description="whether to write a 
bbox property with the bounding box of the geometries at the feature and 
feature collection level" default="NO" />
  <Option name="COORDINATE_PRECISION" type="int" description="Number of 
decimal for coordinates" default="15" />
  <Option name="SIGNIFICANT_FIGURES" type="int" description="Number of 
significant figures for floating-point values" default="17" />
  <Option name="NATIVE_DATA" type="string" description="FeatureCollection 
level elements." />
  <Option name="NATIVE_MEDIA_TYPE" type="string" description="Format of 
NATIVE_DATA. Must be &quot;application/vnd.geo+json&quot;, otherwise 
NATIVE_DATA will be ignored." />
</LayerCreationOptionList>


For example:

 <Option name="FLAVOR"  type="string-select" default="TO-BE-DEFINED" 
description="Which flavor of GeoJSON must be output">
    <Value>GJ2008</Value>
    <Value>RFCxxxx</Value>
 </Option>


> Personally I'd prefer RFC-by-default and no automatic reprojection -- with
> an error if the CRS isn't CRS84. Be able to opt into old style with config
> options, which would enable outputting either fully GeoJSON2008, or opting
> into or out-of individual RFC features (eg. fully RFC-style except using an
> alternate CRS, or skipping antimeridian-cutting). These options should
> enable people to migrate systems gradually.

Having option to turn on/off each individual RFC features seems overkill to me, 
unless there is a clear need that is expressed.

> 
> That would change the current behaviour and might be unacceptable,
> by PSC or users, then that is a good reason to create a new driver.
> Problem might be with the names, having two drivers means two names,
> and GeoJSON would still point to old driver which became de facto
> non-GeoJSON driver. Confusing.

To support RFCxxxx I really think creating a new driver would be technically 
an inferior choice given the likely high percentage of common code between 
both. On the reading side, how would you decide which driver would be selected 
? etc...
A similar situation is SQLite and Spatialite that are both handled by the same 
driver, where you select the spatialite flavor with a SPATIALITE=YES dataset 
creation option.

> 
> > The above doesn't do good things for GDAL backwards compatibility though
> > :)

My feeling is that the main point of incompatibility is the crs object no 
longer being allowed, and CRS84 being compulsory. All other points are really 
details or corner cases that wouldn't impact most use cases

An option would be, if FLAVOR is not specified, if the SRS passed to 
CreateLayer() is CRS84, then select RFCxxxx. Otherwise default to GJ2008.


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Jul 28 09:40:35 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Jul 2016 18:40:35 +0200
Subject: [gdal-dev] gdal_translate with -projwin possible bug
In-Reply-To: <57994144.4e42620a.13060.a865@mx.google.com>
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
 <3177995.UVQ4a6Mh8Y@even-n550jk> <57994144.4e42620a.13060.a865@mx.google.com>
Message-ID: <1633241.nAXmYSBtJv@even-n550jk>

On Thursday 28 July 2016 09:18:36 Lauren O'Brien wrote:
> Hi Evan,
> 
> Ok I thought it might have been at least partially intended. Unfortunately,
> I think the use case the change is addressing is not what the majority of
> users are thinking of when they choose projwin.

I've pushed a fix in line with my previous email: 
https://trac.osgeo.org/gdal/ticket/6610

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From kassies at gmail.com  Thu Jul 28 23:22:17 2016
From: kassies at gmail.com (Rutger)
Date: Thu, 28 Jul 2016 23:22:17 -0700 (PDT)
Subject: [gdal-dev] gdal_translate with -projwin possible bug
In-Reply-To: <1633241.nAXmYSBtJv@even-n550jk>
References: <CADbdL_GEb8wKRADJTyE1JH0sfQ9shU-dqb5cwhe7zfWHUPQ6oA@mail.gmail.com>
 <3177995.UVQ4a6Mh8Y@even-n550jk> <57994144.4e42620a.13060.a865@mx.google.com>
 <1633241.nAXmYSBtJv@even-n550jk>
Message-ID: <1469773337946-5278651.post@n6.nabble.com>

Thanks Even, 

There is probably, like Jukka mentioned, a use case for both ways, but i
personally prefer your fix. If i want warp/shift functionality i use
gdalwarp anyway, and then you know you have to be careful about pixel
alignment etc.  


Even Rouault-2 wrote
> I've pushed a fix in line with my previous email: 
> https://trac.osgeo.org/gdal/ticket/6610
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> http://lists.osgeo.org/mailman/listinfo/gdal-dev





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-translate-with-projwin-possible-bug-tp5278296p5278651.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From teddyguerin at yahoo.fr  Fri Jul 29 02:31:06 2016
From: teddyguerin at yahoo.fr (teddy guerin)
Date: Fri, 29 Jul 2016 09:31:06 +0000 (UTC)
Subject: [gdal-dev] OGR - S57 - geometry extraction issue
In-Reply-To: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
References: <CAJ=7T6XOgm+EsZ0zBhF4qPYemYEyHBTAEpnuHevEBFaR4MqMmg@mail.gmail.com>
Message-ID: <331331746.11256708.1469784666364.JavaMail.yahoo@mail.yahoo.com>

Hi,Up for my previous answer.
I was wrong for lines and area values POSACC, QUAPOS are on edges and not on "real object".
RegardsTed


      De : David Ferdoille <david.ferdoille at gmail.com>
 À : gdal-dev at lists.osgeo.org 
 Envoyé le : Mercredi 27 juillet 2016 15h12
 Objet : [gdal-dev] OGR - S57 - geometry extraction issue
   
Hello all,
We are trying to render S57 files as ENC through Geoserver.
We convert S57 to shapefiles thanks to ogr2ogr : 1 shapefile for 1 class (ex : COALNE) and 1 geometry type (LINE) :  ogrinfo -oo "RETURN_PRIMITIVES=ON" -oo "RETURN_LINKAGES=ON" -oo "LNAM_REFS=ON" CELLLL.000 COALNE ogr2ogr -skipfailures  -where "OGR_GEOMETRY='POINT' or OGR_GEOMETRY='MULTIPOINT'" SOUNDG_points.shp CELLLL.000 SOUNDG 
We use gdal-2.1.0 with the S57_CSV environnement variable (S57_CSV=/usr/local/share/gdal/ with s57*.csv files).

We noticed that objects (of COALNE class for example) have multiple geometries and each sub-geometry have attributes like POSACC and QUAPOS which are important for S52 representation. We've succeeded to extract primitives (Edge, isolated points, connected points, ...), but it looks very complex to operate.

We have some problems to extract geometries from s57 objects :- we noticed that, for an object, all sub-geometries are aggregated to one geometry- we didn't succeed to extract geometry attributes like POSACC and QUAPOS

1) Is there a way to not aggregate sub-geometries of an object and get this list of sub-geometries ?2) Is there a way to extract geometry attributes like POSACC and QUAPOS ?3) If not, are these features planned ?

Thanks for your help !

David
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160729/9b9323f0/attachment.html>

From francisco.javier.calzado at ericsson.com  Fri Jul 29 04:30:49 2016
From: francisco.javier.calzado at ericsson.com (Francisco Javier Calzado)
Date: Fri, 29 Jul 2016 11:30:49 +0000
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
 (GDAL 2.1.0)
In-Reply-To: <1546040.dbNMDothQ9@even-n550jk>
References: <loom.20160727T124642-372@post.gmane.org>
 <2073744.nS3JUVbTTZ@even-n550jk>
 <6BA6E0BBA9988E428FA9178AB0B28B4857628F76@ESESSMB205.ericsson.se>
 <1546040.dbNMDothQ9@even-n550jk>
Message-ID: <6BA6E0BBA9988E428FA9178AB0B28B485762A272@ESESSMB205.ericsson.se>

Thank you Even,

I maganed to compile properly in x86 today. I was setting WIN64 to NO, instead of just commenting it out. Maybe that was the culprit. 

Unfortunately, I still get the same error:

ERROR 7: Assertion `poNewest->poPrevious == NULL' failed
in file `c:\ericsson\3rdparties\gdal-2.1.0\gcore\gdalrasterblock.cpp', line 800

I have attached a simple code to reproduce it (Test.cpp). If you need the whole solution just ask me, although it is a very simple console test. I have also shared with you the zipped datasets through this link:
https://drive.google.com/file/d/0B-OCl1FjBi0YblRPRGZlQWx4eEE/view?usp=sharing
Just place them along with Test.exe file.

IMPORTANT: Bear in mind that these datasets come in a format still not supported officially by GDAL, as I am developing the driver. It is almost finished (just a few details pending) and fully working. Find the driver attached (Wizard_Driver.7z). 
By the way, what do we have to do to contribute with this new driver for GDAL?

Thank you so much Even.

Javier.


-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: 28 July, 2016 17:42
To: Francisco Javier Calzado <francisco.javier.calzado at ericsson.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Multithreading issue on pixel-based intensive access (GDAL 2.1.0)

On Thursday 28 July 2016 13:11:13 Francisco Javier Calzado wrote:
> Thanks Even,
> 
> I don't want to waste your time, so just before sending any code to be 
> tested I would like to be sure it is not a bug from my side. Although 
> I usually work with GDAL compiled in 64bits, I had to swap to x86 for 
> these tests. When trying to compile in 32bits with Visual Studio 2015 
> I got the following unresolved symbols:

Javier,

Make sure the Visual Studio 32bit environment is properly set up. Check that
WIN64 from nmake.opt is let commented out.
Example of successful build:
https://ci.appveyor.com/project/rouault/gdal-coverage/build/job/8widewvmhgjotxs5

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Wizard_Driver.7z
Type: application/octet-stream
Size: 12935 bytes
Desc: Wizard_Driver.7z
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160729/99609554/attachment-0001.obj>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Test.cpp
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160729/99609554/attachment-0001.ksh>

From even.rouault at spatialys.com  Sat Jul 30 08:09:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 30 Jul 2016 17:09:33 +0200
Subject: [gdal-dev] Multithreading issue on pixel-based intensive access
	(GDAL 2.1.0)
In-Reply-To: <6BA6E0BBA9988E428FA9178AB0B28B485762A272@ESESSMB205.ericsson.se>
References: <loom.20160727T124642-372@post.gmane.org>
 <1546040.dbNMDothQ9@even-n550jk>
 <6BA6E0BBA9988E428FA9178AB0B28B485762A272@ESESSMB205.ericsson.se>
Message-ID: <3263018.0GIK8gnYoZ@even-n550jk>

Javier,

> I have attached a simple code to reproduce it (Test.cpp). If you need the
> whole solution just ask me, although it is a very simple console test. I
> have also shared with you the zipped datasets through this link:
> https://drive.google.com/file/d/0B-OCl1FjBi0YblRPRGZlQWx4eEE/view?usp=shari
> ng Just place them along with Test.exe file.

I managed to reproduce on Linux after some compilation fixes in your driver 
(constants _UI8_MAX and similar ones aren't recognized. I just commented out 
that code), and changing your Test.cpp to use GDAL thread machinery, since 
std::future/std::async doesn't create threads with gcc (4.8.4) for some reason 
but runs everything sequentially in the main thread.
The issue was that the call to GDALSetCacheMax() prevented the raster block 
mutex from being created. Fixed per https://trac.osgeo.org/gdal/ticket/6611. 
As a workaround you can call GDALGetCacheMax() just before.

> 
> IMPORTANT: Bear in mind that these datasets come in a format still not
> supported officially by GDAL, as I am developing the driver. It is almost
> finished (just a few details pending) and fully working. Find the driver
> attached (Wizard_Driver.7z). By the way, what do we have to do to
> contribute with this new driver for GDAL?

See https://trac.osgeo.org/gdal/wiki/HowToContribute

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From 191980 at niuitmo.ru  Sun Jul 31 11:24:19 2016
From: 191980 at niuitmo.ru (=?utf-8?B?0JHQvtGA0LfRi9GFINCQ0LvQtdC60YHQsNC90LTRgCDQkNC90LTRgNC10LU=?= =?utf-8?B?0LLQuNGH?=)
Date: Sun, 31 Jul 2016 18:24:19 +0000
Subject: [gdal-dev] GSoC GDAL DWG Support [Week 10]
Message-ID: <021C7431-C7FC-4FD6-8FFD-9566EC508E31@niuitmo.ru>

Blogpost <http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-9-report.html> link<http://gsoc2016gdaldwg.blogspot.ru/2016/07/week-10-report.html>.


1. This week I've done:

Pull request to GDAL-trunk was opened<https://github.com/OSGeo/gdal/pull/145>.

OGR CAD Driver changes:

- Python tests are done.

- Code style fixes, memory leaks removements.

- Custom geometries attributes support (which are taken from BlockReference attdefs). Example in blogpost.

- Code refactoring and cleaning.


2. Plan on doing next week:

Fix builds (travis/windows), testing and documentation update.


3. Blocking:

None.


Best regards,

Alexandr Borzykh


Links:

libopencad github<https://github.com/sandyre/libopencad>

gdal + libopencad fork github<https://github.com/sandyre/gdal_libopencad>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160731/379fb00c/attachment-0001.html>

