From sfkeller at gmail.com  Mon Feb  1 00:06:16 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 1 Feb 2016 09:06:16 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
Message-ID: <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>

Hi Blake

It's clear to me that a good generic c++ library for encoding and
decoding vector tiles is needed.
On the other hand, I'd like to experiment with vector tiles and
related QGIS parallel loading issues for which Python is more
convenient.

It seems that Mapzen's [1] Python implementation is further along.
Or do you know if Jesse (or somebody) is still working on Mapbox's variant [2] ?

:Stefan

[1] https://github.com/mapzen/mapbox-vector-tile
[2] https://github.com/mapbox/vector-tile-py


2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
> All,
>
> The first thing that is going to be required likely is a good generic c++ library for encoding and decoding vector tiles IMO.
>
> I have spent a lot of time working on developing the mapnik vector tile library to be a solid implementation, especially around all the work done for 2.0 of Mapbox vector tile specification. I would love to eventually help make this a generalized implementation so that it is portable to a library like GDAL.
>
> We have talked about doing something like this at Mapbox but will require a good deal of time, so it hasn't been pushed forward yet. The other issues that come to mind to me is that some of the libraries that mapnik vector tile depends upon most likely need good custom implementations if we wanted to make it more generic.
>
> The reason for this is that I would prefer for it to be a header only library with no dependencies. Adding more dependencies for GDAL seems like it could be a mess.
>
> Blake Thompson
>
>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Hi Petr, Blake, Even and everybody
>>
>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>> I'd already asked Even a similar question.
>> I'm advising now an intern to implement such a MVT Vector Tiles reader
>> client in Python if possible as part of a QGIS plugin.
>> And I'm interested not to do redundant implementations.
>> Are there any news on this matter?
>>
>> :Stefan
>> Prof. at HSR and leader of Geometa Lab
>>
>> @Even: Regarding OGR MVT development can you send to me (directly) a
>> contact name of the group which won the bidding?
>>
>>
>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>> Hi everybody,
>>>
>>> thanks for the comments. Regarding the technical details:
>>>
>>>> Each Tile is its own discrete dataset therefore the hardest part would be
>>>> merging of features into the original features across tiles. You could use
>>>> some complicated merging technique, but that could be very expensive.
>>>
>>>
>>> The driver could require "id" parameter, which specifies name of an
>>> attribute with unique identifier on the features shared across the tiles.
>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
>>> "osm_id" in place. The first version of driver could read only features with
>>> such ID. The identifier does not have to be always filled, but often it is,
>>> especially in deeper zoom levels derived purely from OpenStreetMap - but
>>> yeh, a completely general stitching would be much harder.
>>>
>>> The clipping + merging of shapes itself can be implemented with underlaying
>>> GEOS library functions.
>>>
>>> BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>
>>> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
>>> powered X-Ray:
>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>
>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>> JavaScript:
>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>
>>> The OGR driver could be also practical for the unsimplified / ungeneralised
>>> MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/
>>>
>>>>
>>>> If you wanted to simply view vector tile data it could get confusing as
>>>> well since most vector tiles need a buffer when they are used for
>>>> visualization programs. This is important for things like labeling on maps
>>>> etc. Therefore, you could get a large amount of overlapping data on tiles if
>>>> you loaded them all in at once.
>>>
>>>
>>> Clipping on border of each tile must be applied before stitching the vector
>>> features together  - so the buffer is removed. Buffer is there only for
>>> visualisation and labeling.
>>>
>>>>
>>>> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
>>>> currently able to decode vector tiles into a form not supported by mapnik.
>>>> Therefore, OGR would not be able to easily use this.
>>>
>>>
>>> Correct. It can't be used directly (GDAL can't link against), but the
>>> relevant code can be extracted and reused directly. For basic decoding
>>> critical is the Protobuf library (which is already in GDAL) and
>>> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
>>> + the code for converting pixel coordinates in features to relevant geo
>>> coordinates and GEOS-based merging of features.
>>>
>>>> We plan to write a generalized encoder and decoder eventually so that any
>>>> other library can plugin with out the mapnik requirement.
>>>
>>>
>>> This would be amazing.
>>>
>>>> If you have any questions specifically about Mapnik Vector Tile or the
>>>> Mapbox Vector Tile Specification feel free to ask me. I would note that you
>>>> guys will want to update your vector tiles once the V2 specification changes
>>>> are into Mapnik-Vector-Tile.
>>>
>>>
>>> Cool! Thanks. Our world tiles are generated via Docker containers on a
>>> cluster of computers - using Mapnik via Tilelive directly - so upgrades on
>>> Mapnik-Vector-Tile will propagate to the open-source rendering software.
>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>
>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't
>>>> see
>>>> mention of that neither in the MVT spec (
>>>> https://github.com/mapbox/vector-
>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although
>>>> I
>>>> guess it is just a matter of storing a MVT blob in the tile_data column.
>>>
>>>
>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside -
>>> and Mapnik reads them directly when rasterising. Storing the vector tiles in
>>> SQLite make sense - and it simplifies deployment, and you can then easily
>>> have complete world on each node of a cluster of tileservers. If you don't
>>> want to upgrade your base map too often, this approach is pretty efficient
>>> and removes the centralised database as typical bottleneck.
>>>
>>> I did some tests on vector tiles vs raster in MBTiles and documented these
>>> in README.md at and https://github.com/klokantech/vector-tiles-sample before
>>> we started to work on OSM2VectorTiles project.
>>> There are also sample data and offline MapBox GL JS viewer in that repo.
>>> Vector tiles can be hosted also "unpacked", just as files in folders on a
>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
>>> default for raster tiles.
>>>
>>> If OGR driver is implemented, the primary source should be probably reading
>>> from an URL via curl.
>>>
>>> Reading PBFs from an MBTiles (or another SQLite) is just the most practical
>>> portable alternative to it.
>>>
>>> Technically people may store the tiles in different ways - for example
>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>> https://github.com/kartotherian/) use Cassandra for tile storage, I guess
>>> MapBox internally is also on a different storage for production servers ...
>>> for transfers and streaming tilesets there is the  - but tiles are ALWAYS
>>> exposed via HTTP.
>>>
>>> Regards,
>>>
>>> Petr
>>> --
>>> Petr Pridal, Ph.D.
>>> CEO
>>>
>>> Klokan Technologies GmbH
>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>> Tel: +41 (0)41 511 26 12
>>> Email: info at klokantech.com
>>> Web: http://www.klokantech.com/
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb  1 04:56:06 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 1 Feb 2016 12:56:06 +0000 (UTC)
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
Message-ID: <loom.20160201T133331-176@post.gmane.org>

Hi,

I would like to collect data from a bunch of GML files into one GeoPackage
but GML files may contain more than 20 layers and ogr2ogr does not want to
append data for me because the -append switch probably has an effect only to
one explicitly given layer.

ogr2ogr -f gpkg -update -append mtk.gpkg /vsizip/K2433L_mtk.zip
ERROR 1: Layer Kunta already exists, and -append not specified.
        Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation of layer Kunta (use -skipfailures to skip errors)

Is it reasonable to imagine that there could be an "append_all" switch which
would allow appending to all the layers in the target datastore? 

-Jukka Rahkonen-




From even.rouault at spatialys.com  Mon Feb  1 05:19:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Feb 2016 14:19:58 +0100
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
In-Reply-To: <loom.20160201T133331-176@post.gmane.org>
References: <loom.20160201T133331-176@post.gmane.org>
Message-ID: <201602011419.58827.even.rouault@spatialys.com>

Jukka,

> 
> I would like to collect data from a bunch of GML files into one GeoPackage
> but GML files may contain more than 20 layers and ogr2ogr does not want to
> append data for me because the -append switch probably has an effect only
> to one explicitly given layer.

-append is supposed to work with several layers too.

I've just downloaded 
http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/K2/K24/K2433L_mtk.zip 
and tried your below command, both a non inexisting mtk.gpkg, and one created 
with it, and it works as expected for me.

Perhaps the bug only triggers with some initial content of mtk.gpkg ?

> 
> ogr2ogr -f gpkg -update -append mtk.gpkg /vsizip/K2433L_mtk.zip

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb  1 05:25:50 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 1 Feb 2016 13:25:50 +0000
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
Message-ID: <8897ce9e425d432b80b3abcde2b1cd80@C119S212VM022.msvyvi.vaha.local>

Hi,

Did you try to add another GML file into existing GeoPackege?

First run OK:
ogr2ogr -f gpkg -update -append mtk.gpkg /vsizip/K2344R_mtk.zip

Secong run gives an error:
ogr2ogr -f gpkg -update -append mtk.gpkg /vsizip/K2433L_mtk.zip
ERROR 1: Layer Kunta already exists, and -append not specified.
        Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation of layer Kunta (use -skipfailures to skip errors)

-Jukka-

Even Rouault wrote:


> Jukka,

>> 
>> I would like to collect data from a bunch of GML files into one 
>> GeoPackage but GML files may contain more than 20 layers and ogr2ogr 
>> does not want to append data for me because the -append switch 
>> probably has an effect only to one explicitly given layer.

> -append is supposed to work with several layers too.

> I've just downloaded
> http://kartat.kapsi.fi/files/maastotietokanta/kaikki/etrs89/gml/K2/K24/K2433L_mtk.zip
> and tried your below command, both a non inexisting mtk.gpkg, and one created with it, and it works as expected for me.

> Perhaps the bug only triggers with some initial content of mtk.gpkg ?

> 
> >ogr2ogr -f gpkg -update -append mtk.gpkg /vsizip/K2433L_mtk.zip

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb  1 05:53:22 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 1 Feb 2016 13:53:22 +0000
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
Message-ID: <7420362f9396402992368276e5d5040c@C119S212VM022.msvyvi.vaha.local>

More intormation:

Reason may be that GML files do not have same layers but the second one has one layer more:

ogrinfo /vsizip/K2344R_mtk.zip
ERROR 1: Random access not supported for /vsizip
Had to open data source read-only.
INFO: Open of `/vsizip/K2344R_mtk.zip'
      using driver `GML' successful.
1: MaastokuvionReuna (3D Line String)
2: Meri (3D Polygon)
3: AluemerenUlkoraja (3D Line String)
4: Kunta (3D Polygon)

ogrinfo /vsizip/K2433L_mtk.zip
ERROR 1: Random access not supported for /vsizip
Had to open data source read-only.
INFO: Open of `/vsizip/K2433L_mtk.zip'
      using driver `GML' successful.
1: MaastokuvionReuna (3D Line String)
2: Meri (3D Polygon)
3: AluemerenUlkoraja (3D Line String)
4: KunnanHallintoraja (3D Line String)
5: Kunta (3D Polygon)

Output from running ogr2ogr with  --debug on

GML: Using Expat reader
GML: Layers are monoblock. Using SEQUENTIAL_LAYERS read mode
GDAL: GDALOpen(/vsizip/K2433L_mtk.zip, this=0000000003DA65F0) succeeds as GML.
GDAL: GDALOpen(mtk.gpkg, this=0000000003DADDC0) succeeds as GPKG.
GML: ResetReading()
GML: ResetReading()
GDALVectorTranslate: 3 features written in layer 'MaastokuvionReuna'
GDALVectorTranslate: 2 features written in layer 'Meri'
GDALVectorTranslate: 2 features written in layer 'AluemerenUlkoraja'
GDALVectorTranslate: 1 features written in layer 'KunnanHallintoraja'
ERROR 1: Layer Kunta already exists, and -append not specified.
        Consider using -append, or -overwrite.
ERROR 1: Terminating translation prematurely after failed
translation of layer Kunta (use -skipfailures to skip errors)
GDAL: GDALClose(mtk.gpkg, this=0000000003DADDC0)
GDAL: GDALClose(/vsizip/K2433L_mtk.zip, this=0000000003DA65F0)


-Jukka-

From even.rouault at spatialys.com  Mon Feb  1 06:06:04 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Feb 2016 15:06:04 +0100
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
In-Reply-To: <7420362f9396402992368276e5d5040c@C119S212VM022.msvyvi.vaha.local>
References: <7420362f9396402992368276e5d5040c@C119S212VM022.msvyvi.vaha.local>
Message-ID: <201602011506.05080.even.rouault@spatialys.com>

Le lundi 01 février 2016 14:53:22, Rahkonen Jukka (MML) a écrit :
> More intormation:
> 
> Reason may be that GML files do not have same layers but the second one has
> one layer more:

Yes that's exactly the reason. When 'KunnanHallintoraja' was processed, it was 
seen as non existing in the target dataset, and this erroneously reseted the 
"bAppend" flag to false. When dealing with Kunta afterwards, which already 
existed, this caused the error.

Fixed per https://trac.osgeo.org/gdal/ticket/6345

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb  1 06:30:00 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 1 Feb 2016 14:30:00 +0000 (UTC)
Subject: [gdal-dev] How to append to all layers with ogr2ogr?
References: <7420362f9396402992368276e5d5040c@C119S212VM022.msvyvi.vaha.local>
 <201602011506.05080.even.rouault@spatialys.com>
Message-ID: <loom.20160201T152448-219@post.gmane.org>

Even Rouault <even.rouault <at> spatialys.com> writes:


> Yes that's exactly the reason. When 'KunnanHallintoraja' was processed, it
was 
> seen as non existing in the target dataset, and this erroneously reseted the 
> "bAppend" flag to false. When dealing with Kunta afterwards, which already 
> existed, this caused the error.
> 
> Fixed per https://trac.osgeo.org/gdal/ticket/6345


Just perfect, eagerly waiting for the next gisinternals build.

-Jukka-




From even.rouault at spatialys.com  Mon Feb  1 07:17:45 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 1 Feb 2016 16:17:45 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56ADCCB7.4040008@gmail.com>
References: <56AA2102.9030102@gmail.com> <56ADCCB7.4040008@gmail.com>
Message-ID: <201602011617.46069.even.rouault@spatialys.com>

Le dimanche 31 janvier 2016 09:58:31, Ari Jolma a écrit :
> This seems to be a pretty big thing to add but doable.
> 
> So, one more thing to discuss before going to vote later is the target
> milestone. Maybe add it to 2.1 as "an experimental feature" and aim for
> 2.2 as a more production ready? This of course assuming that I can get
> it implemented before 2.1. By "implemented" I mean generic support + one
> or two drivers (shape, pg) & passing current tests + basic set of new
> tests.

We have until end of march for the feature feeze of GDAL 2.1, so that lets 
some time. I could also potentially help if you need, for example during the 
OSGeo code sprint end of this month (for example on the spatialite M support, 
that is needed for SQLite dialect support or adding tests in Python test 
suite).
If we have core support (C++ changes, C API, WKB/WKT importer/exporters) + 
shape + pg working, that's enough I think to advertize as non-experimental.
GPKG support should also not require a lot of work (likely just advertizing 
the M capability) as it relies on WKB.

> 
> I've also edited the RFC draft according to what I've found / thought
> while developing. I'd be happy to get feedback about the proposed
> additions to the APIs.

Looks good to me.

I'm not completely sure about the opportunity to have #define wkbPointZ 
wkbPoint25D alias. Or at least it would deserve an explicit Doxygen comment to 
warn that it is an alias to the value used in the old 2.5D 99-402 extension, 
and not the value of the ISO SQL/MM Part 3 as one could expect from the name.
The situation is a bit messy. I thought about using ISO values for the 
existing 3D geometry types when implementing curve support in 2.0 but finally 
decided it wasn't worth the breakage.

> 
> What I right now have is a working WKT and WKB API for point geometries.
> Next I plan to test constructing and modifying geometries with
> get/set/add methods and then move to building the support into shape
> driver, while also adding more geometries to the WKT, WKB tests.
> 
> Best,
> 
> Ari
> 
> 28.01.2016, 16:09, Ari Jolma kirjoitti:
> > Folks, especially the PSC,
> > 
> > I'd like to call for discussion about RFC 61: Adding support for
> > measures in geometries.
> > 
> > Measures (M) are a sort of fourth coordinate for points in geometries.
> > A typical use of measures is for distance from origin in line strings
> > that represent roads but they can be used for other things as well.
> > 
> > Measures are a part of the simple features model and they are
> > supported by many vector data formats.
> > 
> > Since measures are a rather fundamental element, adding them will
> > require quite many changes into the basic building blocks of the GDAL
> > API. Most importantly, the 'int nCoordDimension' property of
> > OGRGeometry is proposed to be replaced by 'int flags', which will have
> > bit flags denoting whether the geometry is empty and has Z or M
> > coordinates.
> > 
> > No backwards incompatible changes (syntactic nor semantic) will be
> > done but the methods getCoordinateDimension and setCoordinateDimension
> > will be deprecated since they do not take into account M coordinate.
> > 
> > The RFC is as usual in the wiki:
> > 
> > https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> > 
> > There are a couple of decisions to be made (if the overall decision is
> > positive).
> > 
> > Should the set3D(b3D) method (and also for example AddGeometry method)
> > of GeometryCollection force all child geometries to be 3D (or 2D and
> > remove possible Z values)? Maybe just unsetting the flag when
> > downgrading is enough?
> > 
> > Should storing data, with measures, into a format, which does not
> > support measures, remove M values from the data? This would be similar
> > to the current behavior with curved geometries and formats which do
> > not support them.
> > 
> > Some smaller issues are mentioned/hinted to in the draft RFC.
> > 
> > I have set up a github repository for the work at
> > 
> > https://github.com/ajolma/GDAL-XYZM
> > 
> > It has an associated travis builder - which however seems to have some
> > problems right now. I have committed the API changes from the draft
> > RFC and it compiles but there is a lot to do with actually
> > implementing the support.
> > 
> > Best regards,
> > 
> > Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From flippmoke at gmail.com  Mon Feb  1 09:27:46 2016
From: flippmoke at gmail.com (Flippmoke)
Date: Mon, 1 Feb 2016 10:27:46 -0700
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
Message-ID: <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>


Stefan,

I am not aware of any libraries besides mapnik vector tile that have been attempting to implement v2 specification. I think mapzen's implementation might be best? We have been wanting to add vector tiles to the python mapnik bindings for quite some time but we don't have the time to do it right now. 

I will try to think this week about how we could make a generic C++ library quickly for Mapbox vector tiles.

Thanks,

Blake Thompson

> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
> 
> Hi Blake
> 
> It's clear to me that a good generic c++ library for encoding and
> decoding vector tiles is needed.
> On the other hand, I'd like to experiment with vector tiles and
> related QGIS parallel loading issues for which Python is more
> convenient.
> 
> It seems that Mapzen's [1] Python implementation is further along.
> Or do you know if Jesse (or somebody) is still working on Mapbox's variant [2] ?
> 
> :Stefan
> 
> [1] https://github.com/mapzen/mapbox-vector-tile
> [2] https://github.com/mapbox/vector-tile-py
> 
> 
> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>> All,
>> 
>> The first thing that is going to be required likely is a good generic c++ library for encoding and decoding vector tiles IMO.
>> 
>> I have spent a lot of time working on developing the mapnik vector tile library to be a solid implementation, especially around all the work done for 2.0 of Mapbox vector tile specification. I would love to eventually help make this a generalized implementation so that it is portable to a library like GDAL.
>> 
>> We have talked about doing something like this at Mapbox but will require a good deal of time, so it hasn't been pushed forward yet. The other issues that come to mind to me is that some of the libraries that mapnik vector tile depends upon most likely need good custom implementations if we wanted to make it more generic.
>> 
>> The reason for this is that I would prefer for it to be a header only library with no dependencies. Adding more dependencies for GDAL seems like it could be a mess.
>> 
>> Blake Thompson
>> 
>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>> 
>>> Hi Petr, Blake, Even and everybody
>>> 
>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>> I'd already asked Even a similar question.
>>> I'm advising now an intern to implement such a MVT Vector Tiles reader
>>> client in Python if possible as part of a QGIS plugin.
>>> And I'm interested not to do redundant implementations.
>>> Are there any news on this matter?
>>> 
>>> :Stefan
>>> Prof. at HSR and leader of Geometa Lab
>>> 
>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>> contact name of the group which won the bidding?
>>> 
>>> 
>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>> Hi everybody,
>>>> 
>>>> thanks for the comments. Regarding the technical details:
>>>> 
>>>>> Each Tile is its own discrete dataset therefore the hardest part would be
>>>>> merging of features into the original features across tiles. You could use
>>>>> some complicated merging technique, but that could be very expensive.
>>>> 
>>>> 
>>>> The driver could require "id" parameter, which specifies name of an
>>>> attribute with unique identifier on the features shared across the tiles.
>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
>>>> "osm_id" in place. The first version of driver could read only features with
>>>> such ID. The identifier does not have to be always filled, but often it is,
>>>> especially in deeper zoom levels derived purely from OpenStreetMap - but
>>>> yeh, a completely general stitching would be much harder.
>>>> 
>>>> The clipping + merging of shapes itself can be implemented with underlaying
>>>> GEOS library functions.
>>>> 
>>>> BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>> 
>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
>>>> powered X-Ray:
>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>> 
>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>> JavaScript:
>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>> 
>>>> The OGR driver could be also practical for the unsimplified / ungeneralised
>>>> MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/
>>>> 
>>>>> 
>>>>> If you wanted to simply view vector tile data it could get confusing as
>>>>> well since most vector tiles need a buffer when they are used for
>>>>> visualization programs. This is important for things like labeling on maps
>>>>> etc. Therefore, you could get a large amount of overlapping data on tiles if
>>>>> you loaded them all in at once.
>>>> 
>>>> 
>>>> Clipping on border of each tile must be applied before stitching the vector
>>>> features together  - so the buffer is removed. Buffer is there only for
>>>> visualisation and labeling.
>>>> 
>>>>> 
>>>>> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
>>>>> currently able to decode vector tiles into a form not supported by mapnik.
>>>>> Therefore, OGR would not be able to easily use this.
>>>> 
>>>> 
>>>> Correct. It can't be used directly (GDAL can't link against), but the
>>>> relevant code can be extracted and reused directly. For basic decoding
>>>> critical is the Protobuf library (which is already in GDAL) and
>>>> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
>>>> + the code for converting pixel coordinates in features to relevant geo
>>>> coordinates and GEOS-based merging of features.
>>>> 
>>>>> We plan to write a generalized encoder and decoder eventually so that any
>>>>> other library can plugin with out the mapnik requirement.
>>>> 
>>>> 
>>>> This would be amazing.
>>>> 
>>>>> If you have any questions specifically about Mapnik Vector Tile or the
>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note that you
>>>>> guys will want to update your vector tiles once the V2 specification changes
>>>>> are into Mapnik-Vector-Tile.
>>>> 
>>>> 
>>>> Cool! Thanks. Our world tiles are generated via Docker containers on a
>>>> cluster of computers - using Mapnik via Tilelive directly - so upgrades on
>>>> Mapnik-Vector-Tile will propagate to the open-source rendering software.
>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>> 
>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't
>>>>> see
>>>>> mention of that neither in the MVT spec (
>>>>> https://github.com/mapbox/vector-
>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although
>>>>> I
>>>>> guess it is just a matter of storing a MVT blob in the tile_data column.
>>>> 
>>>> 
>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside -
>>>> and Mapnik reads them directly when rasterising. Storing the vector tiles in
>>>> SQLite make sense - and it simplifies deployment, and you can then easily
>>>> have complete world on each node of a cluster of tileservers. If you don't
>>>> want to upgrade your base map too often, this approach is pretty efficient
>>>> and removes the centralised database as typical bottleneck.
>>>> 
>>>> I did some tests on vector tiles vs raster in MBTiles and documented these
>>>> in README.md at and https://github.com/klokantech/vector-tiles-sample before
>>>> we started to work on OSM2VectorTiles project.
>>>> There are also sample data and offline MapBox GL JS viewer in that repo.
>>>> Vector tiles can be hosted also "unpacked", just as files in folders on a
>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
>>>> default for raster tiles.
>>>> 
>>>> If OGR driver is implemented, the primary source should be probably reading
>>>> from an URL via curl.
>>>> 
>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most practical
>>>> portable alternative to it.
>>>> 
>>>> Technically people may store the tiles in different ways - for example
>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I guess
>>>> MapBox internally is also on a different storage for production servers ...
>>>> for transfers and streaming tilesets there is the  - but tiles are ALWAYS
>>>> exposed via HTTP.
>>>> 
>>>> Regards,
>>>> 
>>>> Petr
>>>> --
>>>> Petr Pridal, Ph.D.
>>>> CEO
>>>> 
>>>> Klokan Technologies GmbH
>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>> Tel: +41 (0)41 511 26 12
>>>> Email: info at klokantech.com
>>>> Web: http://www.klokantech.com/
>>>> 
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From sfkeller at gmail.com  Mon Feb  1 11:16:34 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Mon, 1 Feb 2016 20:16:34 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
Message-ID: <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>

That's good news!
We'll be happy to add Python bindings to such a generic C++ library
for Mapbox vector tiles.
We have still some time (say few weeks?) left here to decide to
contribute either to these bindings or to Mapzen's pure Python lib.

One reason why I'm insisting on Python (bindings) - besides easier
testing with QGIS - is the following:
AFAIK with vector tiles we have to deal with quite a new kind of
feature provider:
One which contains "zoom levels" and one which "suddenly" changes
feature class at different zoom levels.
If a client like QGIS consumes vector tiles from OGR in a one-shot
call, how should the client deal with such "zoom level" dependent
issues?
So my thinking is, to consume only the most appropriate zoom level,
probably only within current map canvas...

:Stefan

2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>
> Stefan,
>
> I am not aware of any libraries besides mapnik vector tile that have been attempting to implement v2 specification. I think mapzen's implementation might be best? We have been wanting to add vector tiles to the python mapnik bindings for quite some time but we don't have the time to do it right now.
>
> I will try to think this week about how we could make a generic C++ library quickly for Mapbox vector tiles.
>
> Thanks,
>
> Blake Thompson
>
>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Hi Blake
>>
>> It's clear to me that a good generic c++ library for encoding and
>> decoding vector tiles is needed.
>> On the other hand, I'd like to experiment with vector tiles and
>> related QGIS parallel loading issues for which Python is more
>> convenient.
>>
>> It seems that Mapzen's [1] Python implementation is further along.
>> Or do you know if Jesse (or somebody) is still working on Mapbox's variant [2] ?
>>
>> :Stefan
>>
>> [1] https://github.com/mapzen/mapbox-vector-tile
>> [2] https://github.com/mapbox/vector-tile-py
>>
>>
>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> All,
>>>
>>> The first thing that is going to be required likely is a good generic c++ library for encoding and decoding vector tiles IMO.
>>>
>>> I have spent a lot of time working on developing the mapnik vector tile library to be a solid implementation, especially around all the work done for 2.0 of Mapbox vector tile specification. I would love to eventually help make this a generalized implementation so that it is portable to a library like GDAL.
>>>
>>> We have talked about doing something like this at Mapbox but will require a good deal of time, so it hasn't been pushed forward yet. The other issues that come to mind to me is that some of the libraries that mapnik vector tile depends upon most likely need good custom implementations if we wanted to make it more generic.
>>>
>>> The reason for this is that I would prefer for it to be a header only library with no dependencies. Adding more dependencies for GDAL seems like it could be a mess.
>>>
>>> Blake Thompson
>>>
>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>>
>>>> Hi Petr, Blake, Even and everybody
>>>>
>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>> I'd already asked Even a similar question.
>>>> I'm advising now an intern to implement such a MVT Vector Tiles reader
>>>> client in Python if possible as part of a QGIS plugin.
>>>> And I'm interested not to do redundant implementations.
>>>> Are there any news on this matter?
>>>>
>>>> :Stefan
>>>> Prof. at HSR and leader of Geometa Lab
>>>>
>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>>> contact name of the group which won the bidding?
>>>>
>>>>
>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>>> Hi everybody,
>>>>>
>>>>> thanks for the comments. Regarding the technical details:
>>>>>
>>>>>> Each Tile is its own discrete dataset therefore the hardest part would be
>>>>>> merging of features into the original features across tiles. You could use
>>>>>> some complicated merging technique, but that could be very expensive.
>>>>>
>>>>>
>>>>> The driver could require "id" parameter, which specifies name of an
>>>>> attribute with unique identifier on the features shared across the tiles.
>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique non-zero
>>>>> "osm_id" in place. The first version of driver could read only features with
>>>>> such ID. The identifier does not have to be always filled, but often it is,
>>>>> especially in deeper zoom levels derived purely from OpenStreetMap - but
>>>>> yeh, a completely general stitching would be much harder.
>>>>>
>>>>> The clipping + merging of shapes itself can be implemented with underlaying
>>>>> GEOS library functions.
>>>>>
>>>>> BTW It is possible to examine vector tiles data in pure JavaScript X-Ray
>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>>
>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
>>>>> powered X-Ray:
>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>>
>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>> JavaScript:
>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>>
>>>>> The OGR driver could be also practical for the unsimplified / ungeneralised
>>>>> MBTiles with OSM data available at: http://osmlab.github.io/osm-qa-tiles/
>>>>>
>>>>>>
>>>>>> If you wanted to simply view vector tile data it could get confusing as
>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>> visualization programs. This is important for things like labeling on maps
>>>>>> etc. Therefore, you could get a large amount of overlapping data on tiles if
>>>>>> you loaded them all in at once.
>>>>>
>>>>>
>>>>> Clipping on border of each tile must be applied before stitching the vector
>>>>> features together  - so the buffer is removed. Buffer is there only for
>>>>> visualisation and labeling.
>>>>>
>>>>>>
>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile decoder isn't
>>>>>> currently able to decode vector tiles into a form not supported by mapnik.
>>>>>> Therefore, OGR would not be able to easily use this.
>>>>>
>>>>>
>>>>> Correct. It can't be used directly (GDAL can't link against), but the
>>>>> relevant code can be extracted and reused directly. For basic decoding
>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_tile.proto
>>>>> + the code for converting pixel coordinates in features to relevant geo
>>>>> coordinates and GEOS-based merging of features.
>>>>>
>>>>>> We plan to write a generalized encoder and decoder eventually so that any
>>>>>> other library can plugin with out the mapnik requirement.
>>>>>
>>>>>
>>>>> This would be amazing.
>>>>>
>>>>>> If you have any questions specifically about Mapnik Vector Tile or the
>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note that you
>>>>>> guys will want to update your vector tiles once the V2 specification changes
>>>>>> are into Mapnik-Vector-Tile.
>>>>>
>>>>>
>>>>> Cool! Thanks. Our world tiles are generated via Docker containers on a
>>>>> cluster of computers - using Mapnik via Tilelive directly - so upgrades on
>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering software.
>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>>
>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I don't
>>>>>> see
>>>>>> mention of that neither in the MVT spec (
>>>>>> https://github.com/mapbox/vector-
>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ), although
>>>>>> I
>>>>>> guess it is just a matter of storing a MVT blob in the tile_data column.
>>>>>
>>>>>
>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles inside -
>>>>> and Mapnik reads them directly when rasterising. Storing the vector tiles in
>>>>> SQLite make sense - and it simplifies deployment, and you can then easily
>>>>> have complete world on each node of a cluster of tileservers. If you don't
>>>>> want to upgrade your base map too often, this approach is pretty efficient
>>>>> and removes the centralised database as typical bottleneck.
>>>>>
>>>>> I did some tests on vector tiles vs raster in MBTiles and documented these
>>>>> in README.md at and https://github.com/klokantech/vector-tiles-sample before
>>>>> we started to work on OSM2VectorTiles project.
>>>>> There are also sample data and offline MapBox GL JS viewer in that repo.
>>>>> Vector tiles can be hosted also "unpacked", just as files in folders on a
>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
>>>>> default for raster tiles.
>>>>>
>>>>> If OGR driver is implemented, the primary source should be probably reading
>>>>> from an URL via curl.
>>>>>
>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most practical
>>>>> portable alternative to it.
>>>>>
>>>>> Technically people may store the tiles in different ways - for example
>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I guess
>>>>> MapBox internally is also on a different storage for production servers ...
>>>>> for transfers and streaming tilesets there is the  - but tiles are ALWAYS
>>>>> exposed via HTTP.
>>>>>
>>>>> Regards,
>>>>>
>>>>> Petr
>>>>> --
>>>>> Petr Pridal, Ph.D.
>>>>> CEO
>>>>>
>>>>> Klokan Technologies GmbH
>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>> Tel: +41 (0)41 511 26 12
>>>>> Email: info at klokantech.com
>>>>> Web: http://www.klokantech.com/
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Benjamin.Stadin at heidelberg-mobil.com  Mon Feb  1 11:25:58 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Mon, 1 Feb 2016 19:25:58 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
Message-ID: <D2D56D80.32083%benjamin.stadin@heidelberg-mobil.com>

Hi Blake,

There is TileMaker [1]. It implements a MVT writer for v1 only as it
seems, but looks lightweight enough as a good base for a portable library.

Ben

[1] 
https://github.com/systemed/tilemaker/blob/master/src/write_geometry.cpp


Am 01.02.16, 18:27 schrieb "gdal-dev on behalf of Flippmoke" unter
<gdal-dev-bounces at lists.osgeo.org on behalf of flippmoke at gmail.com>:

>
>Stefan,
>
>I am not aware of any libraries besides mapnik vector tile that have been
>attempting to implement v2 specification. I think mapzen's implementation
>might be best? We have been wanting to add vector tiles to the python
>mapnik bindings for quite some time but we don't have the time to do it
>right now. 
>
>I will try to think this week about how we could make a generic C++
>library quickly for Mapbox vector tiles.
>
>Thanks,
>
>Blake Thompson
>
>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>> 
>> Hi Blake
>> 
>> It's clear to me that a good generic c++ library for encoding and
>> decoding vector tiles is needed.
>> On the other hand, I'd like to experiment with vector tiles and
>> related QGIS parallel loading issues for which Python is more
>> convenient.
>> 
>> It seems that Mapzen's [1] Python implementation is further along.
>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>variant [2] ?
>> 
>> :Stefan
>> 
>> [1] https://github.com/mapzen/mapbox-vector-tile
>> [2] https://github.com/mapbox/vector-tile-py
>> 
>> 
>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> All,
>>> 
>>> The first thing that is going to be required likely is a good generic
>>>c++ library for encoding and decoding vector tiles IMO.
>>> 
>>> I have spent a lot of time working on developing the mapnik vector
>>>tile library to be a solid implementation, especially around all the
>>>work done for 2.0 of Mapbox vector tile specification. I would love to
>>>eventually help make this a generalized implementation so that it is
>>>portable to a library like GDAL.
>>> 
>>> We have talked about doing something like this at Mapbox but will
>>>require a good deal of time, so it hasn't been pushed forward yet. The
>>>other issues that come to mind to me is that some of the libraries that
>>>mapnik vector tile depends upon most likely need good custom
>>>implementations if we wanted to make it more generic.
>>> 
>>> The reason for this is that I would prefer for it to be a header only
>>>library with no dependencies. Adding more dependencies for GDAL seems
>>>like it could be a mess.
>>> 
>>> Blake Thompson
>>> 
>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>>>wrote:
>>>> 
>>>> Hi Petr, Blake, Even and everybody
>>>> 
>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>> I'd already asked Even a similar question.
>>>> I'm advising now an intern to implement such a MVT Vector Tiles reader
>>>> client in Python if possible as part of a QGIS plugin.
>>>> And I'm interested not to do redundant implementations.
>>>> Are there any news on this matter?
>>>> 
>>>> :Stefan
>>>> Prof. at HSR and leader of Geometa Lab
>>>> 
>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>>> contact name of the group which won the bidding?
>>>> 
>>>> 
>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>>> Hi everybody,
>>>>> 
>>>>> thanks for the comments. Regarding the technical details:
>>>>> 
>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>>>>>>would be
>>>>>> merging of features into the original features across tiles. You
>>>>>>could use
>>>>>> some complicated merging technique, but that could be very
>>>>>>expensive.
>>>>> 
>>>>> 
>>>>> The driver could require "id" parameter, which specifies name of an
>>>>> attribute with unique identifier on the features shared across the
>>>>>tiles.
>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>>>>>non-zero
>>>>> "osm_id" in place. The first version of driver could read only
>>>>>features with
>>>>> such ID. The identifier does not have to be always filled, but often
>>>>>it is,
>>>>> especially in deeper zoom levels derived purely from OpenStreetMap -
>>>>>but
>>>>> yeh, a completely general stitching would be much harder.
>>>>> 
>>>>> The clipping + merging of shapes itself can be implemented with
>>>>>underlaying
>>>>> GEOS library functions.
>>>>> 
>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>>>>>X-Ray
>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>> 
>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL JS
>>>>> powered X-Ray:
>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>> 
>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>> JavaScript:
>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>> 
>>>>> The OGR driver could be also practical for the unsimplified /
>>>>>ungeneralised
>>>>> MBTiles with OSM data available at:
>>>>>http://osmlab.github.io/osm-qa-tiles/
>>>>> 
>>>>>> 
>>>>>> If you wanted to simply view vector tile data it could get
>>>>>>confusing as
>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>> visualization programs. This is important for things like labeling
>>>>>>on maps
>>>>>> etc. Therefore, you could get a large amount of overlapping data on
>>>>>>tiles if
>>>>>> you loaded them all in at once.
>>>>> 
>>>>> 
>>>>> Clipping on border of each tile must be applied before stitching the
>>>>>vector
>>>>> features together  - so the buffer is removed. Buffer is there only
>>>>>for
>>>>> visualisation and labeling.
>>>>> 
>>>>>> 
>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>>>>>decoder isn't
>>>>>> currently able to decode vector tiles into a form not supported by
>>>>>>mapnik.
>>>>>> Therefore, OGR would not be able to easily use this.
>>>>> 
>>>>> 
>>>>> Correct. It can't be used directly (GDAL can't link against), but the
>>>>> relevant code can be extracted and reused directly. For basic
>>>>>decoding
>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>> 
>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector_
>>>>>tile.proto
>>>>> + the code for converting pixel coordinates in features to relevant
>>>>>geo
>>>>> coordinates and GEOS-based merging of features.
>>>>> 
>>>>>> We plan to write a generalized encoder and decoder eventually so
>>>>>>that any
>>>>>> other library can plugin with out the mapnik requirement.
>>>>> 
>>>>> 
>>>>> This would be amazing.
>>>>> 
>>>>>> If you have any questions specifically about Mapnik Vector Tile or
>>>>>>the
>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note
>>>>>>that you
>>>>>> guys will want to update your vector tiles once the V2
>>>>>>specification changes
>>>>>> are into Mapnik-Vector-Tile.
>>>>> 
>>>>> 
>>>>> Cool! Thanks. Our world tiles are generated via Docker containers on
>>>>>a
>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>>>>upgrades on
>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>>>>software.
>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>> 
>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>>>>>>don't
>>>>>> see
>>>>>> mention of that neither in the MVT spec (
>>>>>> https://github.com/mapbox/vector-
>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>>>>>>although
>>>>>> I
>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>>>>>>column.
>>>>> 
>>>>> 
>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles
>>>>>inside -
>>>>> and Mapnik reads them directly when rasterising. Storing the vector
>>>>>tiles in
>>>>> SQLite make sense - and it simplifies deployment, and you can then
>>>>>easily
>>>>> have complete world on each node of a cluster of tileservers. If you
>>>>>don't
>>>>> want to upgrade your base map too often, this approach is pretty
>>>>>efficient
>>>>> and removes the centralised database as typical bottleneck.
>>>>> 
>>>>> I did some tests on vector tiles vs raster in MBTiles and documented
>>>>>these
>>>>> in README.md at and
>>>>>https://github.com/klokantech/vector-tiles-sample before
>>>>> we started to work on OSM2VectorTiles project.
>>>>> There are also sample data and offline MapBox GL JS viewer in that
>>>>>repo.
>>>>> Vector tiles can be hosted also "unpacked", just as files in folders
>>>>>on a
>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does by
>>>>> default for raster tiles.
>>>>> 
>>>>> If OGR driver is implemented, the primary source should be probably
>>>>>reading
>>>>> from an URL via curl.
>>>>> 
>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>>>>>practical
>>>>> portable alternative to it.
>>>>> 
>>>>> Technically people may store the tiles in different ways - for
>>>>>example
>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I
>>>>>guess
>>>>> MapBox internally is also on a different storage for production
>>>>>servers ...
>>>>> for transfers and streaming tilesets there is the  - but tiles are
>>>>>ALWAYS
>>>>> exposed via HTTP.
>>>>> 
>>>>> Regards,
>>>>> 
>>>>> Petr
>>>>> --
>>>>> Petr Pridal, Ph.D.
>>>>> CEO
>>>>> 
>>>>> Klokan Technologies GmbH
>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>> Tel: +41 (0)41 511 26 12
>>>>> Email: info at klokantech.com
>>>>> Web: http://www.klokantech.com/
>>>>> 
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Benjamin.Stadin at heidelberg-mobil.com  Mon Feb  1 14:48:32 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Mon, 1 Feb 2016 22:48:32 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
Message-ID: <D2D57017.3209C%benjamin.stadin@heidelberg-mobil.com>

All,

I¹d like to share a few thoughts about the current state of vector tiles.
I believe that, with vector data, there is a chance to get rid of some of
the problems that current mapping tools face in practice, especially in
regards to projections. And this chance should be used in my opinion,
instead of doing things the "old way³, as with MVT.

The current specification and implementation of MVT is both depending on a
certain projection when the tiles are created, and with the
relative-to-screen coordinates per tile it also depends on how the
renderer is implemented (e.g. Commonly in other OpenGL applications, as in
our OpenGL based map, input data, screen scale and perspective
transformation are mostly handled in the GL shaders).
The dependency on a specific projection also means that none of the issues
occurring in practice when dealing with map projections gets fixed. Tom
MacWright from MapBox gave his feedback in the comment section at [1]
about why MapBox has limited support for other projections. He nails it
mostly, but I draw different conclusions. It is well possible to separate
data from representation with vector tiles, and thus a general purpose
vector tile format must deal with.

This isn¹t a rant against MapBox Vector Tiles or Mapbox. This isn¹t an
easy thing. I just want to raise awareness that MVT is, currently, a
particular implementation for a particular rendering engine.
 It works well for Mapbox maps, and it would be nice to have conversion
support for MVT. But I think that, without major braking changes, this
should not be considered to be a general purpose vector format at all.
This seems to be what some are hoping for.

There is enough interest from our side that we¹d be interested in
contributing (maybe monetary or with code, or both) to define and
implement a better general purpose tile format.

~Ben

[1] https://vis4.net/blog/posts/no-more-mercator-tiles/



Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
<gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:

>That's good news!
>We'll be happy to add Python bindings to such a generic C++ library
>for Mapbox vector tiles.
>We have still some time (say few weeks?) left here to decide to
>contribute either to these bindings or to Mapzen's pure Python lib.
>
>One reason why I'm insisting on Python (bindings) - besides easier
>testing with QGIS - is the following:
>AFAIK with vector tiles we have to deal with quite a new kind of
>feature provider:
>One which contains "zoom levels" and one which "suddenly" changes
>feature class at different zoom levels.
>If a client like QGIS consumes vector tiles from OGR in a one-shot
>call, how should the client deal with such "zoom level" dependent
>issues?
>So my thinking is, to consume only the most appropriate zoom level,
>probably only within current map canvas...
>
>:Stefan
>
>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>
>> Stefan,
>>
>> I am not aware of any libraries besides mapnik vector tile that have
>>been attempting to implement v2 specification. I think mapzen's
>>implementation might be best? We have been wanting to add vector tiles
>>to the python mapnik bindings for quite some time but we don't have the
>>time to do it right now.
>>
>> I will try to think this week about how we could make a generic C++
>>library quickly for Mapbox vector tiles.
>>
>> Thanks,
>>
>> Blake Thompson
>>
>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>
>>> Hi Blake
>>>
>>> It's clear to me that a good generic c++ library for encoding and
>>> decoding vector tiles is needed.
>>> On the other hand, I'd like to experiment with vector tiles and
>>> related QGIS parallel loading issues for which Python is more
>>> convenient.
>>>
>>> It seems that Mapzen's [1] Python implementation is further along.
>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>>variant [2] ?
>>>
>>> :Stefan
>>>
>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>> [2] https://github.com/mapbox/vector-tile-py
>>>
>>>
>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>> All,
>>>>
>>>> The first thing that is going to be required likely is a good generic
>>>>c++ library for encoding and decoding vector tiles IMO.
>>>>
>>>> I have spent a lot of time working on developing the mapnik vector
>>>>tile library to be a solid implementation, especially around all the
>>>>work done for 2.0 of Mapbox vector tile specification. I would love to
>>>>eventually help make this a generalized implementation so that it is
>>>>portable to a library like GDAL.
>>>>
>>>> We have talked about doing something like this at Mapbox but will
>>>>require a good deal of time, so it hasn't been pushed forward yet. The
>>>>other issues that come to mind to me is that some of the libraries
>>>>that mapnik vector tile depends upon most likely need good custom
>>>>implementations if we wanted to make it more generic.
>>>>
>>>> The reason for this is that I would prefer for it to be a header only
>>>>library with no dependencies. Adding more dependencies for GDAL seems
>>>>like it could be a mess.
>>>>
>>>> Blake Thompson
>>>>
>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>>>>wrote:
>>>>>
>>>>> Hi Petr, Blake, Even and everybody
>>>>>
>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>>> I'd already asked Even a similar question.
>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>>>>reader
>>>>> client in Python if possible as part of a QGIS plugin.
>>>>> And I'm interested not to do redundant implementations.
>>>>> Are there any news on this matter?
>>>>>
>>>>> :Stefan
>>>>> Prof. at HSR and leader of Geometa Lab
>>>>>
>>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>>>> contact name of the group which won the bidding?
>>>>>
>>>>>
>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>>>> Hi everybody,
>>>>>>
>>>>>> thanks for the comments. Regarding the technical details:
>>>>>>
>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>>>>>>>would be
>>>>>>> merging of features into the original features across tiles. You
>>>>>>>could use
>>>>>>> some complicated merging technique, but that could be very
>>>>>>>expensive.
>>>>>>
>>>>>>
>>>>>> The driver could require "id" parameter, which specifies name of an
>>>>>> attribute with unique identifier on the features shared across the
>>>>>>tiles.
>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>>>>>>non-zero
>>>>>> "osm_id" in place. The first version of driver could read only
>>>>>>features with
>>>>>> such ID. The identifier does not have to be always filled, but
>>>>>>often it is,
>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
>>>>>>- but
>>>>>> yeh, a completely general stitching would be much harder.
>>>>>>
>>>>>> The clipping + merging of shapes itself can be implemented with
>>>>>>underlaying
>>>>>> GEOS library functions.
>>>>>>
>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>>>>>>X-Ray
>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>>>
>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
>>>>>>JS
>>>>>> powered X-Ray:
>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>>>
>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>>> JavaScript:
>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>>>
>>>>>> The OGR driver could be also practical for the unsimplified /
>>>>>>ungeneralised
>>>>>> MBTiles with OSM data available at:
>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>>>>>
>>>>>>>
>>>>>>> If you wanted to simply view vector tile data it could get
>>>>>>>confusing as
>>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>>> visualization programs. This is important for things like labeling
>>>>>>>on maps
>>>>>>> etc. Therefore, you could get a large amount of overlapping data
>>>>>>>on tiles if
>>>>>>> you loaded them all in at once.
>>>>>>
>>>>>>
>>>>>> Clipping on border of each tile must be applied before stitching
>>>>>>the vector
>>>>>> features together  - so the buffer is removed. Buffer is there only
>>>>>>for
>>>>>> visualisation and labeling.
>>>>>>
>>>>>>>
>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>>>>>>decoder isn't
>>>>>>> currently able to decode vector tiles into a form not supported by
>>>>>>>mapnik.
>>>>>>> Therefore, OGR would not be able to easily use this.
>>>>>>
>>>>>>
>>>>>> Correct. It can't be used directly (GDAL can't link against), but
>>>>>>the
>>>>>> relevant code can be extracted and reused directly. For basic
>>>>>>decoding
>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>>> 
>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>>>>>>_tile.proto
>>>>>> + the code for converting pixel coordinates in features to relevant
>>>>>>geo
>>>>>> coordinates and GEOS-based merging of features.
>>>>>>
>>>>>>> We plan to write a generalized encoder and decoder eventually so
>>>>>>>that any
>>>>>>> other library can plugin with out the mapnik requirement.
>>>>>>
>>>>>>
>>>>>> This would be amazing.
>>>>>>
>>>>>>> If you have any questions specifically about Mapnik Vector Tile or
>>>>>>>the
>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note
>>>>>>>that you
>>>>>>> guys will want to update your vector tiles once the V2
>>>>>>>specification changes
>>>>>>> are into Mapnik-Vector-Tile.
>>>>>>
>>>>>>
>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
>>>>>>on a
>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>>>>>upgrades on
>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>>>>>software.
>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>>>
>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>>>>>>>don't
>>>>>>> see
>>>>>>> mention of that neither in the MVT spec (
>>>>>>> https://github.com/mapbox/vector-
>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>>>>>>>although
>>>>>>> I
>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>>>>>>>column.
>>>>>>
>>>>>>
>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles
>>>>>>inside -
>>>>>> and Mapnik reads them directly when rasterising. Storing the vector
>>>>>>tiles in
>>>>>> SQLite make sense - and it simplifies deployment, and you can then
>>>>>>easily
>>>>>> have complete world on each node of a cluster of tileservers. If
>>>>>>you don't
>>>>>> want to upgrade your base map too often, this approach is pretty
>>>>>>efficient
>>>>>> and removes the centralised database as typical bottleneck.
>>>>>>
>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>>>>>documented these
>>>>>> in README.md at and
>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>>>>> we started to work on OSM2VectorTiles project.
>>>>>> There are also sample data and offline MapBox GL JS viewer in that
>>>>>>repo.
>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>>>>>folders on a
>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
>>>>>>by
>>>>>> default for raster tiles.
>>>>>>
>>>>>> If OGR driver is implemented, the primary source should be probably
>>>>>>reading
>>>>>> from an URL via curl.
>>>>>>
>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>>>>>>practical
>>>>>> portable alternative to it.
>>>>>>
>>>>>> Technically people may store the tiles in different ways - for
>>>>>>example
>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I
>>>>>>guess
>>>>>> MapBox internally is also on a different storage for production
>>>>>>servers ...
>>>>>> for transfers and streaming tilesets there is the  - but tiles are
>>>>>>ALWAYS
>>>>>> exposed via HTTP.
>>>>>>
>>>>>> Regards,
>>>>>>
>>>>>> Petr
>>>>>> --
>>>>>> Petr Pridal, Ph.D.
>>>>>> CEO
>>>>>>
>>>>>> Klokan Technologies GmbH
>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>>> Tel: +41 (0)41 511 26 12
>>>>>> Email: info at klokantech.com
>>>>>> Web: http://www.klokantech.com/
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev


From Benjamin.Stadin at heidelberg-mobil.com  Mon Feb  1 15:04:31 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Mon, 1 Feb 2016 23:04:31 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
Message-ID: <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>

Hi Stefan,

A vector tile may contain data for several zoom levels. But what data is
shown at which zoom level is defined by the styling, not by the data
itself. It is handled on client side, by the web (or native) tile
renderer. 

The path is the same as with mercator tiles (zoomLevel/x/y):
https://example.com/17/65535/43602.mvt


The tile for zoom level 17 may contain features of class „building“, and
the style definition may contain a rule that filters type „building“ for
zoomLevels <= 18.

~Ben

Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
<gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:

>That's good news!
>We'll be happy to add Python bindings to such a generic C++ library
>for Mapbox vector tiles.
>We have still some time (say few weeks?) left here to decide to
>contribute either to these bindings or to Mapzen's pure Python lib.
>
>One reason why I'm insisting on Python (bindings) - besides easier
>testing with QGIS - is the following:
>AFAIK with vector tiles we have to deal with quite a new kind of
>feature provider:
>One which contains "zoom levels" and one which "suddenly" changes
>feature class at different zoom levels.
>If a client like QGIS consumes vector tiles from OGR in a one-shot
>call, how should the client deal with such "zoom level" dependent
>issues?
>So my thinking is, to consume only the most appropriate zoom level,
>probably only within current map canvas...
>
>:Stefan
>
>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>
>> Stefan,
>>
>> I am not aware of any libraries besides mapnik vector tile that have
>>been attempting to implement v2 specification. I think mapzen's
>>implementation might be best? We have been wanting to add vector tiles
>>to the python mapnik bindings for quite some time but we don't have the
>>time to do it right now.
>>
>> I will try to think this week about how we could make a generic C++
>>library quickly for Mapbox vector tiles.
>>
>> Thanks,
>>
>> Blake Thompson
>>
>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>
>>> Hi Blake
>>>
>>> It's clear to me that a good generic c++ library for encoding and
>>> decoding vector tiles is needed.
>>> On the other hand, I'd like to experiment with vector tiles and
>>> related QGIS parallel loading issues for which Python is more
>>> convenient.
>>>
>>> It seems that Mapzen's [1] Python implementation is further along.
>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>>variant [2] ?
>>>
>>> :Stefan
>>>
>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>> [2] https://github.com/mapbox/vector-tile-py
>>>
>>>
>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>> All,
>>>>
>>>> The first thing that is going to be required likely is a good generic
>>>>c++ library for encoding and decoding vector tiles IMO.
>>>>
>>>> I have spent a lot of time working on developing the mapnik vector
>>>>tile library to be a solid implementation, especially around all the
>>>>work done for 2.0 of Mapbox vector tile specification. I would love to
>>>>eventually help make this a generalized implementation so that it is
>>>>portable to a library like GDAL.
>>>>
>>>> We have talked about doing something like this at Mapbox but will
>>>>require a good deal of time, so it hasn't been pushed forward yet. The
>>>>other issues that come to mind to me is that some of the libraries
>>>>that mapnik vector tile depends upon most likely need good custom
>>>>implementations if we wanted to make it more generic.
>>>>
>>>> The reason for this is that I would prefer for it to be a header only
>>>>library with no dependencies. Adding more dependencies for GDAL seems
>>>>like it could be a mess.
>>>>
>>>> Blake Thompson
>>>>
>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>>>>wrote:
>>>>>
>>>>> Hi Petr, Blake, Even and everybody
>>>>>
>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>>> I'd already asked Even a similar question.
>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>>>>reader
>>>>> client in Python if possible as part of a QGIS plugin.
>>>>> And I'm interested not to do redundant implementations.
>>>>> Are there any news on this matter?
>>>>>
>>>>> :Stefan
>>>>> Prof. at HSR and leader of Geometa Lab
>>>>>
>>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>>>> contact name of the group which won the bidding?
>>>>>
>>>>>
>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>>>> Hi everybody,
>>>>>>
>>>>>> thanks for the comments. Regarding the technical details:
>>>>>>
>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>>>>>>>would be
>>>>>>> merging of features into the original features across tiles. You
>>>>>>>could use
>>>>>>> some complicated merging technique, but that could be very
>>>>>>>expensive.
>>>>>>
>>>>>>
>>>>>> The driver could require "id" parameter, which specifies name of an
>>>>>> attribute with unique identifier on the features shared across the
>>>>>>tiles.
>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>>>>>>non-zero
>>>>>> "osm_id" in place. The first version of driver could read only
>>>>>>features with
>>>>>> such ID. The identifier does not have to be always filled, but
>>>>>>often it is,
>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
>>>>>>- but
>>>>>> yeh, a completely general stitching would be much harder.
>>>>>>
>>>>>> The clipping + merging of shapes itself can be implemented with
>>>>>>underlaying
>>>>>> GEOS library functions.
>>>>>>
>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>>>>>>X-Ray
>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>>>
>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
>>>>>>JS
>>>>>> powered X-Ray:
>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>>>
>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>>> JavaScript:
>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>>>
>>>>>> The OGR driver could be also practical for the unsimplified /
>>>>>>ungeneralised
>>>>>> MBTiles with OSM data available at:
>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>>>>>
>>>>>>>
>>>>>>> If you wanted to simply view vector tile data it could get
>>>>>>>confusing as
>>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>>> visualization programs. This is important for things like labeling
>>>>>>>on maps
>>>>>>> etc. Therefore, you could get a large amount of overlapping data
>>>>>>>on tiles if
>>>>>>> you loaded them all in at once.
>>>>>>
>>>>>>
>>>>>> Clipping on border of each tile must be applied before stitching
>>>>>>the vector
>>>>>> features together  - so the buffer is removed. Buffer is there only
>>>>>>for
>>>>>> visualisation and labeling.
>>>>>>
>>>>>>>
>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>>>>>>decoder isn't
>>>>>>> currently able to decode vector tiles into a form not supported by
>>>>>>>mapnik.
>>>>>>> Therefore, OGR would not be able to easily use this.
>>>>>>
>>>>>>
>>>>>> Correct. It can't be used directly (GDAL can't link against), but
>>>>>>the
>>>>>> relevant code can be extracted and reused directly. For basic
>>>>>>decoding
>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>>> 
>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>>>>>>_tile.proto
>>>>>> + the code for converting pixel coordinates in features to relevant
>>>>>>geo
>>>>>> coordinates and GEOS-based merging of features.
>>>>>>
>>>>>>> We plan to write a generalized encoder and decoder eventually so
>>>>>>>that any
>>>>>>> other library can plugin with out the mapnik requirement.
>>>>>>
>>>>>>
>>>>>> This would be amazing.
>>>>>>
>>>>>>> If you have any questions specifically about Mapnik Vector Tile or
>>>>>>>the
>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note
>>>>>>>that you
>>>>>>> guys will want to update your vector tiles once the V2
>>>>>>>specification changes
>>>>>>> are into Mapnik-Vector-Tile.
>>>>>>
>>>>>>
>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
>>>>>>on a
>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>>>>>upgrades on
>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>>>>>software.
>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>>>
>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>>>>>>>don't
>>>>>>> see
>>>>>>> mention of that neither in the MVT spec (
>>>>>>> https://github.com/mapbox/vector-
>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>>>>>>>although
>>>>>>> I
>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>>>>>>>column.
>>>>>>
>>>>>>
>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles
>>>>>>inside -
>>>>>> and Mapnik reads them directly when rasterising. Storing the vector
>>>>>>tiles in
>>>>>> SQLite make sense - and it simplifies deployment, and you can then
>>>>>>easily
>>>>>> have complete world on each node of a cluster of tileservers. If
>>>>>>you don't
>>>>>> want to upgrade your base map too often, this approach is pretty
>>>>>>efficient
>>>>>> and removes the centralised database as typical bottleneck.
>>>>>>
>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>>>>>documented these
>>>>>> in README.md at and
>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>>>>> we started to work on OSM2VectorTiles project.
>>>>>> There are also sample data and offline MapBox GL JS viewer in that
>>>>>>repo.
>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>>>>>folders on a
>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
>>>>>>by
>>>>>> default for raster tiles.
>>>>>>
>>>>>> If OGR driver is implemented, the primary source should be probably
>>>>>>reading
>>>>>> from an URL via curl.
>>>>>>
>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>>>>>>practical
>>>>>> portable alternative to it.
>>>>>>
>>>>>> Technically people may store the tiles in different ways - for
>>>>>>example
>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I
>>>>>>guess
>>>>>> MapBox internally is also on a different storage for production
>>>>>>servers ...
>>>>>> for transfers and streaming tilesets there is the  - but tiles are
>>>>>>ALWAYS
>>>>>> exposed via HTTP.
>>>>>>
>>>>>> Regards,
>>>>>>
>>>>>> Petr
>>>>>> --
>>>>>> Petr Pridal, Ph.D.
>>>>>> CEO
>>>>>>
>>>>>> Klokan Technologies GmbH
>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>>> Tel: +41 (0)41 511 26 12
>>>>>> Email: info at klokantech.com
>>>>>> Web: http://www.klokantech.com/
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev


From sfkeller at gmail.com  Mon Feb  1 15:27:19 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Tue, 2 Feb 2016 00:27:19 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
Message-ID: <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>

Hi Ben

Thanks for explaining - Petr and I are the maintainers of OSM2Vectortiles.
I like projections (and also GeoPackage :-) ).
But reprojection is solved here, since OGR/QGIS can transform on the fly.
This thread is about Petr's question about a reader "for mapbox-like
vector tiles stored in MBTiles or downloaded from a url...".

So I'd like to come back to the issue:
1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
2. and of a "feature provider" in an interactive environment (like
QGIS) or a file/stream converter (like OGR) => anybody?

:Stefan



2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
<Benjamin.Stadin at heidelberg-mobil.com>:
> Hi Stefan,
>
> A vector tile may contain data for several zoom levels. But what data is
> shown at which zoom level is defined by the styling, not by the data
> itself. It is handled on client side, by the web (or native) tile
> renderer.
>
> The path is the same as with mercator tiles (zoomLevel/x/y):
> https://example.com/17/65535/43602.mvt
>
>
> The tile for zoom level 17 may contain features of class „building“, and
> the style definition may contain a rule that filters type „building“ for
> zoomLevels <= 18.
>
> ~Ben
>
> Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
> <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>
>>That's good news!
>>We'll be happy to add Python bindings to such a generic C++ library
>>for Mapbox vector tiles.
>>We have still some time (say few weeks?) left here to decide to
>>contribute either to these bindings or to Mapzen's pure Python lib.
>>
>>One reason why I'm insisting on Python (bindings) - besides easier
>>testing with QGIS - is the following:
>>AFAIK with vector tiles we have to deal with quite a new kind of
>>feature provider:
>>One which contains "zoom levels" and one which "suddenly" changes
>>feature class at different zoom levels.
>>If a client like QGIS consumes vector tiles from OGR in a one-shot
>>call, how should the client deal with such "zoom level" dependent
>>issues?
>>So my thinking is, to consume only the most appropriate zoom level,
>>probably only within current map canvas...
>>
>>:Stefan
>>
>>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>
>>> Stefan,
>>>
>>> I am not aware of any libraries besides mapnik vector tile that have
>>>been attempting to implement v2 specification. I think mapzen's
>>>implementation might be best? We have been wanting to add vector tiles
>>>to the python mapnik bindings for quite some time but we don't have the
>>>time to do it right now.
>>>
>>> I will try to think this week about how we could make a generic C++
>>>library quickly for Mapbox vector tiles.
>>>
>>> Thanks,
>>>
>>> Blake Thompson
>>>
>>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>>
>>>> Hi Blake
>>>>
>>>> It's clear to me that a good generic c++ library for encoding and
>>>> decoding vector tiles is needed.
>>>> On the other hand, I'd like to experiment with vector tiles and
>>>> related QGIS parallel loading issues for which Python is more
>>>> convenient.
>>>>
>>>> It seems that Mapzen's [1] Python implementation is further along.
>>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>>>variant [2] ?
>>>>
>>>> :Stefan
>>>>
>>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>>> [2] https://github.com/mapbox/vector-tile-py
>>>>
>>>>
>>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>>> All,
>>>>>
>>>>> The first thing that is going to be required likely is a good generic
>>>>>c++ library for encoding and decoding vector tiles IMO.
>>>>>
>>>>> I have spent a lot of time working on developing the mapnik vector
>>>>>tile library to be a solid implementation, especially around all the
>>>>>work done for 2.0 of Mapbox vector tile specification. I would love to
>>>>>eventually help make this a generalized implementation so that it is
>>>>>portable to a library like GDAL.
>>>>>
>>>>> We have talked about doing something like this at Mapbox but will
>>>>>require a good deal of time, so it hasn't been pushed forward yet. The
>>>>>other issues that come to mind to me is that some of the libraries
>>>>>that mapnik vector tile depends upon most likely need good custom
>>>>>implementations if we wanted to make it more generic.
>>>>>
>>>>> The reason for this is that I would prefer for it to be a header only
>>>>>library with no dependencies. Adding more dependencies for GDAL seems
>>>>>like it could be a mess.
>>>>>
>>>>> Blake Thompson
>>>>>
>>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>>>>>wrote:
>>>>>>
>>>>>> Hi Petr, Blake, Even and everybody
>>>>>>
>>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>>>> I'd already asked Even a similar question.
>>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>>>>>reader
>>>>>> client in Python if possible as part of a QGIS plugin.
>>>>>> And I'm interested not to do redundant implementations.
>>>>>> Are there any news on this matter?
>>>>>>
>>>>>> :Stefan
>>>>>> Prof. at HSR and leader of Geometa Lab
>>>>>>
>>>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
>>>>>> contact name of the group which won the bidding?
>>>>>>
>>>>>>
>>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com>:
>>>>>>> Hi everybody,
>>>>>>>
>>>>>>> thanks for the comments. Regarding the technical details:
>>>>>>>
>>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>>>>>>>>would be
>>>>>>>> merging of features into the original features across tiles. You
>>>>>>>>could use
>>>>>>>> some complicated merging technique, but that could be very
>>>>>>>>expensive.
>>>>>>>
>>>>>>>
>>>>>>> The driver could require "id" parameter, which specifies name of an
>>>>>>> attribute with unique identifier on the features shared across the
>>>>>>>tiles.
>>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>>>>>>>non-zero
>>>>>>> "osm_id" in place. The first version of driver could read only
>>>>>>>features with
>>>>>>> such ID. The identifier does not have to be always filled, but
>>>>>>>often it is,
>>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
>>>>>>>- but
>>>>>>> yeh, a completely general stitching would be much harder.
>>>>>>>
>>>>>>> The clipping + merging of shapes itself can be implemented with
>>>>>>>underlaying
>>>>>>> GEOS library functions.
>>>>>>>
>>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>>>>>>>X-Ray
>>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>>>>
>>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
>>>>>>>JS
>>>>>>> powered X-Ray:
>>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>>>>
>>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>>>> JavaScript:
>>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>>>>
>>>>>>> The OGR driver could be also practical for the unsimplified /
>>>>>>>ungeneralised
>>>>>>> MBTiles with OSM data available at:
>>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>>>>>>
>>>>>>>>
>>>>>>>> If you wanted to simply view vector tile data it could get
>>>>>>>>confusing as
>>>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>>>> visualization programs. This is important for things like labeling
>>>>>>>>on maps
>>>>>>>> etc. Therefore, you could get a large amount of overlapping data
>>>>>>>>on tiles if
>>>>>>>> you loaded them all in at once.
>>>>>>>
>>>>>>>
>>>>>>> Clipping on border of each tile must be applied before stitching
>>>>>>>the vector
>>>>>>> features together  - so the buffer is removed. Buffer is there only
>>>>>>>for
>>>>>>> visualisation and labeling.
>>>>>>>
>>>>>>>>
>>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>>>>>>>decoder isn't
>>>>>>>> currently able to decode vector tiles into a form not supported by
>>>>>>>>mapnik.
>>>>>>>> Therefore, OGR would not be able to easily use this.
>>>>>>>
>>>>>>>
>>>>>>> Correct. It can't be used directly (GDAL can't link against), but
>>>>>>>the
>>>>>>> relevant code can be extracted and reused directly. For basic
>>>>>>>decoding
>>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>>>>
>>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>>>>>>>_tile.proto
>>>>>>> + the code for converting pixel coordinates in features to relevant
>>>>>>>geo
>>>>>>> coordinates and GEOS-based merging of features.
>>>>>>>
>>>>>>>> We plan to write a generalized encoder and decoder eventually so
>>>>>>>>that any
>>>>>>>> other library can plugin with out the mapnik requirement.
>>>>>>>
>>>>>>>
>>>>>>> This would be amazing.
>>>>>>>
>>>>>>>> If you have any questions specifically about Mapnik Vector Tile or
>>>>>>>>the
>>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note
>>>>>>>>that you
>>>>>>>> guys will want to update your vector tiles once the V2
>>>>>>>>specification changes
>>>>>>>> are into Mapnik-Vector-Tile.
>>>>>>>
>>>>>>>
>>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
>>>>>>>on a
>>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>>>>>>upgrades on
>>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>>>>>>software.
>>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>>>>
>>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>>>>>>>>don't
>>>>>>>> see
>>>>>>>> mention of that neither in the MVT spec (
>>>>>>>> https://github.com/mapbox/vector-
>>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>>>>>>>>although
>>>>>>>> I
>>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>>>>>>>>column.
>>>>>>>
>>>>>>>
>>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles
>>>>>>>inside -
>>>>>>> and Mapnik reads them directly when rasterising. Storing the vector
>>>>>>>tiles in
>>>>>>> SQLite make sense - and it simplifies deployment, and you can then
>>>>>>>easily
>>>>>>> have complete world on each node of a cluster of tileservers. If
>>>>>>>you don't
>>>>>>> want to upgrade your base map too often, this approach is pretty
>>>>>>>efficient
>>>>>>> and removes the centralised database as typical bottleneck.
>>>>>>>
>>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>>>>>>documented these
>>>>>>> in README.md at and
>>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>>>>>> we started to work on OSM2VectorTiles project.
>>>>>>> There are also sample data and offline MapBox GL JS viewer in that
>>>>>>>repo.
>>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>>>>>>folders on a
>>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
>>>>>>>by
>>>>>>> default for raster tiles.
>>>>>>>
>>>>>>> If OGR driver is implemented, the primary source should be probably
>>>>>>>reading
>>>>>>> from an URL via curl.
>>>>>>>
>>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>>>>>>>practical
>>>>>>> portable alternative to it.
>>>>>>>
>>>>>>> Technically people may store the tiles in different ways - for
>>>>>>>example
>>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage, I
>>>>>>>guess
>>>>>>> MapBox internally is also on a different storage for production
>>>>>>>servers ...
>>>>>>> for transfers and streaming tilesets there is the  - but tiles are
>>>>>>>ALWAYS
>>>>>>> exposed via HTTP.
>>>>>>>
>>>>>>> Regards,
>>>>>>>
>>>>>>> Petr
>>>>>>> --
>>>>>>> Petr Pridal, Ph.D.
>>>>>>> CEO
>>>>>>>
>>>>>>> Klokan Technologies GmbH
>>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>>>> Tel: +41 (0)41 511 26 12
>>>>>>> Email: info at klokantech.com
>>>>>>> Web: http://www.klokantech.com/
>>>>>>>
>>>>>>> _______________________________________________
>>>>>>> gdal-dev mailing list
>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>_______________________________________________
>>gdal-dev mailing list
>>gdal-dev at lists.osgeo.org
>>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>

From Benjamin.Stadin at heidelberg-mobil.com  Mon Feb  1 15:59:30 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Mon, 1 Feb 2016 23:59:30 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
Message-ID: <D2D5ABB2.321EB%benjamin.stadin@heidelberg-mobil.com>

Hi Stefan,

"If there would be OGR driver for vector tiles it would make a similar
resource extremely useful also for other purposes in GIS tools - not only
for tileservers and direct visualisation.“

I was thinking you want to do more than just rendering. Then at least, as
Blake also mentioned, the features need to be merged. And I think some
degenerate geometries are to be expected for a few cases. You will also
have multiple polygons cut along tile bounds for what should be a single
polygon. And the introduced points to close a polygon’s path at the tile
bounds may add another inaccuracy when you later reproject the data.

It depends what your goal is. Serious map editing isn’t possible.

~Ben


Am 02.02.16, 00:27 schrieb "Stefan Keller" unter <sfkeller at gmail.com>:

>Hi Ben
>
>Thanks for explaining - Petr and I are the maintainers of OSM2Vectortiles.
>I like projections (and also GeoPackage :-) ).
>But reprojection is solved here, since OGR/QGIS can transform on the fly.
>This thread is about Petr's question about a reader "for mapbox-like
>vector tiles stored in MBTiles or downloaded from a url...".
>
>So I'd like to come back to the issue:
>1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
>2. and of a "feature provider" in an interactive environment (like
>QGIS) or a file/stream converter (like OGR) => anybody?
>
>:Stefan
>
>
>
>2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
><Benjamin.Stadin at heidelberg-mobil.com>:
>> Hi Stefan,
>>
>> A vector tile may contain data for several zoom levels. But what data is
>> shown at which zoom level is defined by the styling, not by the data
>> itself. It is handled on client side, by the web (or native) tile
>> renderer.
>>
>> The path is the same as with mercator tiles (zoomLevel/x/y):
>> https://example.com/17/65535/43602.mvt
>>
>>
>> The tile for zoom level 17 may contain features of class „building“, and
>> the style definition may contain a rule that filters type „building“ for
>> zoomLevels <= 18.
>>
>> ~Ben
>>
>> Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
>> <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>>
>>>That's good news!
>>>We'll be happy to add Python bindings to such a generic C++ library
>>>for Mapbox vector tiles.
>>>We have still some time (say few weeks?) left here to decide to
>>>contribute either to these bindings or to Mapzen's pure Python lib.
>>>
>>>One reason why I'm insisting on Python (bindings) - besides easier
>>>testing with QGIS - is the following:
>>>AFAIK with vector tiles we have to deal with quite a new kind of
>>>feature provider:
>>>One which contains "zoom levels" and one which "suddenly" changes
>>>feature class at different zoom levels.
>>>If a client like QGIS consumes vector tiles from OGR in a one-shot
>>>call, how should the client deal with such "zoom level" dependent
>>>issues?
>>>So my thinking is, to consume only the most appropriate zoom level,
>>>probably only within current map canvas...
>>>
>>>:Stefan
>>>
>>>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>>
>>>> Stefan,
>>>>
>>>> I am not aware of any libraries besides mapnik vector tile that have
>>>>been attempting to implement v2 specification. I think mapzen's
>>>>implementation might be best? We have been wanting to add vector tiles
>>>>to the python mapnik bindings for quite some time but we don't have the
>>>>time to do it right now.
>>>>
>>>> I will try to think this week about how we could make a generic C++
>>>>library quickly for Mapbox vector tiles.
>>>>
>>>> Thanks,
>>>>
>>>> Blake Thompson
>>>>
>>>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>>>
>>>>> Hi Blake
>>>>>
>>>>> It's clear to me that a good generic c++ library for encoding and
>>>>> decoding vector tiles is needed.
>>>>> On the other hand, I'd like to experiment with vector tiles and
>>>>> related QGIS parallel loading issues for which Python is more
>>>>> convenient.
>>>>>
>>>>> It seems that Mapzen's [1] Python implementation is further along.
>>>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>>>>variant [2] ?
>>>>>
>>>>> :Stefan
>>>>>
>>>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>>>> [2] https://github.com/mapbox/vector-tile-py
>>>>>
>>>>>
>>>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>>>>> All,
>>>>>>
>>>>>> The first thing that is going to be required likely is a good
>>>>>>generic
>>>>>>c++ library for encoding and decoding vector tiles IMO.
>>>>>>
>>>>>> I have spent a lot of time working on developing the mapnik vector
>>>>>>tile library to be a solid implementation, especially around all the
>>>>>>work done for 2.0 of Mapbox vector tile specification. I would love
>>>>>>to
>>>>>>eventually help make this a generalized implementation so that it is
>>>>>>portable to a library like GDAL.
>>>>>>
>>>>>> We have talked about doing something like this at Mapbox but will
>>>>>>require a good deal of time, so it hasn't been pushed forward yet.
>>>>>>The
>>>>>>other issues that come to mind to me is that some of the libraries
>>>>>>that mapnik vector tile depends upon most likely need good custom
>>>>>>implementations if we wanted to make it more generic.
>>>>>>
>>>>>> The reason for this is that I would prefer for it to be a header
>>>>>>only
>>>>>>library with no dependencies. Adding more dependencies for GDAL seems
>>>>>>like it could be a mess.
>>>>>>
>>>>>> Blake Thompson
>>>>>>
>>>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>>>>>>wrote:
>>>>>>>
>>>>>>> Hi Petr, Blake, Even and everybody
>>>>>>>
>>>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>>>>>> I'd already asked Even a similar question.
>>>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>>>>>>reader
>>>>>>> client in Python if possible as part of a QGIS plugin.
>>>>>>> And I'm interested not to do redundant implementations.
>>>>>>> Are there any news on this matter?
>>>>>>>
>>>>>>> :Stefan
>>>>>>> Prof. at HSR and leader of Geometa Lab
>>>>>>>
>>>>>>> @Even: Regarding OGR MVT development can you send to me (directly)
>>>>>>>a
>>>>>>> contact name of the group which won the bidding?
>>>>>>>
>>>>>>>
>>>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal
>>>>>>><petr.pridal at klokantech.com>:
>>>>>>>> Hi everybody,
>>>>>>>>
>>>>>>>> thanks for the comments. Regarding the technical details:
>>>>>>>>
>>>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>>>>>>>>>would be
>>>>>>>>> merging of features into the original features across tiles. You
>>>>>>>>>could use
>>>>>>>>> some complicated merging technique, but that could be very
>>>>>>>>>expensive.
>>>>>>>>
>>>>>>>>
>>>>>>>> The driver could require "id" parameter, which specifies name of
>>>>>>>>an
>>>>>>>> attribute with unique identifier on the features shared across the
>>>>>>>>tiles.
>>>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>>>>>>>>non-zero
>>>>>>>> "osm_id" in place. The first version of driver could read only
>>>>>>>>features with
>>>>>>>> such ID. The identifier does not have to be always filled, but
>>>>>>>>often it is,
>>>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
>>>>>>>>- but
>>>>>>>> yeh, a completely general stitching would be much harder.
>>>>>>>>
>>>>>>>> The clipping + merging of shapes itself can be implemented with
>>>>>>>>underlaying
>>>>>>>> GEOS library functions.
>>>>>>>>
>>>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>>>>>>>>X-Ray
>>>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>>>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>>>>>>>
>>>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
>>>>>>>>JS
>>>>>>>> powered X-Ray:
>>>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>>>>>>>
>>>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>>>>>>>> JavaScript:
>>>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>>>>>>>
>>>>>>>> The OGR driver could be also practical for the unsimplified /
>>>>>>>>ungeneralised
>>>>>>>> MBTiles with OSM data available at:
>>>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>>>>>>>
>>>>>>>>>
>>>>>>>>> If you wanted to simply view vector tile data it could get
>>>>>>>>>confusing as
>>>>>>>>> well since most vector tiles need a buffer when they are used for
>>>>>>>>> visualization programs. This is important for things like
>>>>>>>>>labeling
>>>>>>>>>on maps
>>>>>>>>> etc. Therefore, you could get a large amount of overlapping data
>>>>>>>>>on tiles if
>>>>>>>>> you loaded them all in at once.
>>>>>>>>
>>>>>>>>
>>>>>>>> Clipping on border of each tile must be applied before stitching
>>>>>>>>the vector
>>>>>>>> features together  - so the buffer is removed. Buffer is there
>>>>>>>>only
>>>>>>>>for
>>>>>>>> visualisation and labeling.
>>>>>>>>
>>>>>>>>>
>>>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>>>>>>>>decoder isn't
>>>>>>>>> currently able to decode vector tiles into a form not supported
>>>>>>>>>by
>>>>>>>>>mapnik.
>>>>>>>>> Therefore, OGR would not be able to easily use this.
>>>>>>>>
>>>>>>>>
>>>>>>>> Correct. It can't be used directly (GDAL can't link against), but
>>>>>>>>the
>>>>>>>> relevant code can be extracted and reused directly. For basic
>>>>>>>>decoding
>>>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>>>>>>>
>>>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vect
>>>>>>>>or
>>>>>>>>_tile.proto
>>>>>>>> + the code for converting pixel coordinates in features to
>>>>>>>>relevant
>>>>>>>>geo
>>>>>>>> coordinates and GEOS-based merging of features.
>>>>>>>>
>>>>>>>>> We plan to write a generalized encoder and decoder eventually so
>>>>>>>>>that any
>>>>>>>>> other library can plugin with out the mapnik requirement.
>>>>>>>>
>>>>>>>>
>>>>>>>> This would be amazing.
>>>>>>>>
>>>>>>>>> If you have any questions specifically about Mapnik Vector Tile
>>>>>>>>>or
>>>>>>>>>the
>>>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would
>>>>>>>>>note
>>>>>>>>>that you
>>>>>>>>> guys will want to update your vector tiles once the V2
>>>>>>>>>specification changes
>>>>>>>>> are into Mapnik-Vector-Tile.
>>>>>>>>
>>>>>>>>
>>>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
>>>>>>>>on a
>>>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>>>>>>>upgrades on
>>>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>>>>>>>software.
>>>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>>>>>>>
>>>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>>>>>>>>>don't
>>>>>>>>> see
>>>>>>>>> mention of that neither in the MVT spec (
>>>>>>>>> https://github.com/mapbox/vector-
>>>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>>>>>>>>>although
>>>>>>>>> I
>>>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>>>>>>>>>column.
>>>>>>>>
>>>>>>>>
>>>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector
>>>>>>>>Tiles
>>>>>>>>inside -
>>>>>>>> and Mapnik reads them directly when rasterising. Storing the
>>>>>>>>vector
>>>>>>>>tiles in
>>>>>>>> SQLite make sense - and it simplifies deployment, and you can then
>>>>>>>>easily
>>>>>>>> have complete world on each node of a cluster of tileservers. If
>>>>>>>>you don't
>>>>>>>> want to upgrade your base map too often, this approach is pretty
>>>>>>>>efficient
>>>>>>>> and removes the centralised database as typical bottleneck.
>>>>>>>>
>>>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>>>>>>>documented these
>>>>>>>> in README.md at and
>>>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>>>>>>> we started to work on OSM2VectorTiles project.
>>>>>>>> There are also sample data and offline MapBox GL JS viewer in that
>>>>>>>>repo.
>>>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>>>>>>>folders on a
>>>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
>>>>>>>>by
>>>>>>>> default for raster tiles.
>>>>>>>>
>>>>>>>> If OGR driver is implemented, the primary source should be
>>>>>>>>probably
>>>>>>>>reading
>>>>>>>> from an URL via curl.
>>>>>>>>
>>>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>>>>>>>>practical
>>>>>>>> portable alternative to it.
>>>>>>>>
>>>>>>>> Technically people may store the tiles in different ways - for
>>>>>>>>example
>>>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage,
>>>>>>>>I
>>>>>>>>guess
>>>>>>>> MapBox internally is also on a different storage for production
>>>>>>>>servers ...
>>>>>>>> for transfers and streaming tilesets there is the  - but tiles are
>>>>>>>>ALWAYS
>>>>>>>> exposed via HTTP.
>>>>>>>>
>>>>>>>> Regards,
>>>>>>>>
>>>>>>>> Petr
>>>>>>>> --
>>>>>>>> Petr Pridal, Ph.D.
>>>>>>>> CEO
>>>>>>>>
>>>>>>>> Klokan Technologies GmbH
>>>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>>>>>>> Tel: +41 (0)41 511 26 12
>>>>>>>> Email: info at klokantech.com
>>>>>>>> Web: http://www.klokantech.com/
>>>>>>>>
>>>>>>>> _______________________________________________
>>>>>>>> gdal-dev mailing list
>>>>>>>> gdal-dev at lists.osgeo.org
>>>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>_______________________________________________
>>>gdal-dev mailing list
>>>gdal-dev at lists.osgeo.org
>>>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>


From flippmoke at gmail.com  Mon Feb  1 16:03:42 2016
From: flippmoke at gmail.com (Blake Thompson)
Date: Mon, 1 Feb 2016 17:03:42 -0700
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
Message-ID: <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>

Benjamin Stadin,

As an author of the specification, I have to disagree with you on the
support for other projections. There is no limitation on vector tiles being
required to being in mercator. The specification in fact mentions that
other projections may be used:

https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds

While it is not accessible via the node-mapnik bindings, we do in fact
support encoding as different projections in mapnik-vector-tile. We have
implemented the decoder so that it could accept other projections, but have
not added a mapnik datasource that would support them, but if there is
demand for such a thing we could do it.

Your comments about the entire stack of Mapbox supporting mostly mercator
could be very accurate, but this is not at all related to the Vector Tile
Specification. We purposefully attempt to make our tools as projection-less
as possible and hope that others find awesome ways to build upon the
standard.

"But what data is shown at which zoom level is defined by the styling" --
This is not true because you could make your data not even provide data at
certain zoom levels. At Mapbox we do this quite often, street data is never
included at very low zoom levels. Therefore, the style isn't the only
control here. In fact, I would encourage you to view styling and rendering
of vector tiles as an entirely different topic.

"There is enough interest from our side that we¹d be interested in contributing
(maybe monetary or with code, or both) to define and implement a better
general purpose tile format." -- Any issues you might have with the Mapbox
Vector Tile Specification or any ideas you might have with the format are
very much welcome. We want to make sure the spec migrates for community
needs. Please see
https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md for
how you might help!

Finally, I would like to stress that while Mapbox Vector Tiles were
designed to be for rendering, it was well known during their design that
they could be used for other applications. This was especially true when I
was writing 2.0 of the specification as I tried to limit what would be
considered even the most common uses of vector tiles.

Thanks,

Blake Thompson

On Mon, Feb 1, 2016 at 4:27 PM, Stefan Keller <sfkeller at gmail.com> wrote:

> Hi Ben
>
> Thanks for explaining - Petr and I are the maintainers of OSM2Vectortiles.
> I like projections (and also GeoPackage :-) ).
> But reprojection is solved here, since OGR/QGIS can transform on the fly.
> This thread is about Petr's question about a reader "for mapbox-like
> vector tiles stored in MBTiles or downloaded from a url...".
>
> So I'd like to come back to the issue:
> 1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
> 2. and of a "feature provider" in an interactive environment (like
> QGIS) or a file/stream converter (like OGR) => anybody?
>
> :Stefan
>
>
>
> 2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
> <Benjamin.Stadin at heidelberg-mobil.com>:
> > Hi Stefan,
> >
> > A vector tile may contain data for several zoom levels. But what data is
> > shown at which zoom level is defined by the styling, not by the data
> > itself. It is handled on client side, by the web (or native) tile
> > renderer.
> >
> > The path is the same as with mercator tiles (zoomLevel/x/y):
> > https://example.com/17/65535/43602.mvt
> >
> >
> > The tile for zoom level 17 may contain features of class „building“, and
> > the style definition may contain a rule that filters type „building“ for
> > zoomLevels <= 18.
> >
> > ~Ben
> >
> > Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
> > <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
> >
> >>That's good news!
> >>We'll be happy to add Python bindings to such a generic C++ library
> >>for Mapbox vector tiles.
> >>We have still some time (say few weeks?) left here to decide to
> >>contribute either to these bindings or to Mapzen's pure Python lib.
> >>
> >>One reason why I'm insisting on Python (bindings) - besides easier
> >>testing with QGIS - is the following:
> >>AFAIK with vector tiles we have to deal with quite a new kind of
> >>feature provider:
> >>One which contains "zoom levels" and one which "suddenly" changes
> >>feature class at different zoom levels.
> >>If a client like QGIS consumes vector tiles from OGR in a one-shot
> >>call, how should the client deal with such "zoom level" dependent
> >>issues?
> >>So my thinking is, to consume only the most appropriate zoom level,
> >>probably only within current map canvas...
> >>
> >>:Stefan
> >>
> >>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
> >>>
> >>> Stefan,
> >>>
> >>> I am not aware of any libraries besides mapnik vector tile that have
> >>>been attempting to implement v2 specification. I think mapzen's
> >>>implementation might be best? We have been wanting to add vector tiles
> >>>to the python mapnik bindings for quite some time but we don't have the
> >>>time to do it right now.
> >>>
> >>> I will try to think this week about how we could make a generic C++
> >>>library quickly for Mapbox vector tiles.
> >>>
> >>> Thanks,
> >>>
> >>> Blake Thompson
> >>>
> >>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
> >>>>
> >>>> Hi Blake
> >>>>
> >>>> It's clear to me that a good generic c++ library for encoding and
> >>>> decoding vector tiles is needed.
> >>>> On the other hand, I'd like to experiment with vector tiles and
> >>>> related QGIS parallel loading issues for which Python is more
> >>>> convenient.
> >>>>
> >>>> It seems that Mapzen's [1] Python implementation is further along.
> >>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
> >>>>variant [2] ?
> >>>>
> >>>> :Stefan
> >>>>
> >>>> [1] https://github.com/mapzen/mapbox-vector-tile
> >>>> [2] https://github.com/mapbox/vector-tile-py
> >>>>
> >>>>
> >>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
> >>>>> All,
> >>>>>
> >>>>> The first thing that is going to be required likely is a good generic
> >>>>>c++ library for encoding and decoding vector tiles IMO.
> >>>>>
> >>>>> I have spent a lot of time working on developing the mapnik vector
> >>>>>tile library to be a solid implementation, especially around all the
> >>>>>work done for 2.0 of Mapbox vector tile specification. I would love to
> >>>>>eventually help make this a generalized implementation so that it is
> >>>>>portable to a library like GDAL.
> >>>>>
> >>>>> We have talked about doing something like this at Mapbox but will
> >>>>>require a good deal of time, so it hasn't been pushed forward yet. The
> >>>>>other issues that come to mind to me is that some of the libraries
> >>>>>that mapnik vector tile depends upon most likely need good custom
> >>>>>implementations if we wanted to make it more generic.
> >>>>>
> >>>>> The reason for this is that I would prefer for it to be a header only
> >>>>>library with no dependencies. Adding more dependencies for GDAL seems
> >>>>>like it could be a mess.
> >>>>>
> >>>>> Blake Thompson
> >>>>>
> >>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
> >>>>>>wrote:
> >>>>>>
> >>>>>> Hi Petr, Blake, Even and everybody
> >>>>>>
> >>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
> >>>>>> I'd already asked Even a similar question.
> >>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
> >>>>>>reader
> >>>>>> client in Python if possible as part of a QGIS plugin.
> >>>>>> And I'm interested not to do redundant implementations.
> >>>>>> Are there any news on this matter?
> >>>>>>
> >>>>>> :Stefan
> >>>>>> Prof. at HSR and leader of Geometa Lab
> >>>>>>
> >>>>>> @Even: Regarding OGR MVT development can you send to me (directly) a
> >>>>>> contact name of the group which won the bidding?
> >>>>>>
> >>>>>>
> >>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal <petr.pridal at klokantech.com
> >:
> >>>>>>> Hi everybody,
> >>>>>>>
> >>>>>>> thanks for the comments. Regarding the technical details:
> >>>>>>>
> >>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
> >>>>>>>>would be
> >>>>>>>> merging of features into the original features across tiles. You
> >>>>>>>>could use
> >>>>>>>> some complicated merging technique, but that could be very
> >>>>>>>>expensive.
> >>>>>>>
> >>>>>>>
> >>>>>>> The driver could require "id" parameter, which specifies name of an
> >>>>>>> attribute with unique identifier on the features shared across the
> >>>>>>>tiles.
> >>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
> >>>>>>>non-zero
> >>>>>>> "osm_id" in place. The first version of driver could read only
> >>>>>>>features with
> >>>>>>> such ID. The identifier does not have to be always filled, but
> >>>>>>>often it is,
> >>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
> >>>>>>>- but
> >>>>>>> yeh, a completely general stitching would be much harder.
> >>>>>>>
> >>>>>>> The clipping + merging of shapes itself can be implemented with
> >>>>>>>underlaying
> >>>>>>> GEOS library functions.
> >>>>>>>
> >>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
> >>>>>>>X-Ray
> >>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
> >>>>>>>
> >>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
> >>>>>>>JS
> >>>>>>> powered X-Ray:
> >>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
> >>>>>>>
> >>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
> >>>>>>> JavaScript:
> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
> >>>>>>>
> >>>>>>> The OGR driver could be also practical for the unsimplified /
> >>>>>>>ungeneralised
> >>>>>>> MBTiles with OSM data available at:
> >>>>>>>http://osmlab.github.io/osm-qa-tiles/
> >>>>>>>
> >>>>>>>>
> >>>>>>>> If you wanted to simply view vector tile data it could get
> >>>>>>>>confusing as
> >>>>>>>> well since most vector tiles need a buffer when they are used for
> >>>>>>>> visualization programs. This is important for things like labeling
> >>>>>>>>on maps
> >>>>>>>> etc. Therefore, you could get a large amount of overlapping data
> >>>>>>>>on tiles if
> >>>>>>>> you loaded them all in at once.
> >>>>>>>
> >>>>>>>
> >>>>>>> Clipping on border of each tile must be applied before stitching
> >>>>>>>the vector
> >>>>>>> features together  - so the buffer is removed. Buffer is there only
> >>>>>>>for
> >>>>>>> visualisation and labeling.
> >>>>>>>
> >>>>>>>>
> >>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
> >>>>>>>>decoder isn't
> >>>>>>>> currently able to decode vector tiles into a form not supported by
> >>>>>>>>mapnik.
> >>>>>>>> Therefore, OGR would not be able to easily use this.
> >>>>>>>
> >>>>>>>
> >>>>>>> Correct. It can't be used directly (GDAL can't link against), but
> >>>>>>>the
> >>>>>>> relevant code can be extracted and reused directly. For basic
> >>>>>>>decoding
> >>>>>>> critical is the Protobuf library (which is already in GDAL) and
> >>>>>>>
> >>>>>>>
> https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
> >>>>>>>_tile.proto
> >>>>>>> + the code for converting pixel coordinates in features to relevant
> >>>>>>>geo
> >>>>>>> coordinates and GEOS-based merging of features.
> >>>>>>>
> >>>>>>>> We plan to write a generalized encoder and decoder eventually so
> >>>>>>>>that any
> >>>>>>>> other library can plugin with out the mapnik requirement.
> >>>>>>>
> >>>>>>>
> >>>>>>> This would be amazing.
> >>>>>>>
> >>>>>>>> If you have any questions specifically about Mapnik Vector Tile or
> >>>>>>>>the
> >>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would note
> >>>>>>>>that you
> >>>>>>>> guys will want to update your vector tiles once the V2
> >>>>>>>>specification changes
> >>>>>>>> are into Mapnik-Vector-Tile.
> >>>>>>>
> >>>>>>>
> >>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
> >>>>>>>on a
> >>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
> >>>>>>>upgrades on
> >>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
> >>>>>>>software.
> >>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
> >>>>>>>
> >>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
> >>>>>>>>don't
> >>>>>>>> see
> >>>>>>>> mention of that neither in the MVT spec (
> >>>>>>>> https://github.com/mapbox/vector-
> >>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
> >>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
> >>>>>>>>although
> >>>>>>>> I
> >>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
> >>>>>>>>column.
> >>>>>>>
> >>>>>>>
> >>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector Tiles
> >>>>>>>inside -
> >>>>>>> and Mapnik reads them directly when rasterising. Storing the vector
> >>>>>>>tiles in
> >>>>>>> SQLite make sense - and it simplifies deployment, and you can then
> >>>>>>>easily
> >>>>>>> have complete world on each node of a cluster of tileservers. If
> >>>>>>>you don't
> >>>>>>> want to upgrade your base map too often, this approach is pretty
> >>>>>>>efficient
> >>>>>>> and removes the centralised database as typical bottleneck.
> >>>>>>>
> >>>>>>> I did some tests on vector tiles vs raster in MBTiles and
> >>>>>>>documented these
> >>>>>>> in README.md at and
> >>>>>>>https://github.com/klokantech/vector-tiles-sample before
> >>>>>>> we started to work on OSM2VectorTiles project.
> >>>>>>> There are also sample data and offline MapBox GL JS viewer in that
> >>>>>>>repo.
> >>>>>>> Vector tiles can be hosted also "unpacked", just as files in
> >>>>>>>folders on a
> >>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
> >>>>>>>by
> >>>>>>> default for raster tiles.
> >>>>>>>
> >>>>>>> If OGR driver is implemented, the primary source should be probably
> >>>>>>>reading
> >>>>>>> from an URL via curl.
> >>>>>>>
> >>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
> >>>>>>>practical
> >>>>>>> portable alternative to it.
> >>>>>>>
> >>>>>>> Technically people may store the tiles in different ways - for
> >>>>>>>example
> >>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
> >>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage,
> I
> >>>>>>>guess
> >>>>>>> MapBox internally is also on a different storage for production
> >>>>>>>servers ...
> >>>>>>> for transfers and streaming tilesets there is the  - but tiles are
> >>>>>>>ALWAYS
> >>>>>>> exposed via HTTP.
> >>>>>>>
> >>>>>>> Regards,
> >>>>>>>
> >>>>>>> Petr
> >>>>>>> --
> >>>>>>> Petr Pridal, Ph.D.
> >>>>>>> CEO
> >>>>>>>
> >>>>>>> Klokan Technologies GmbH
> >>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
> >>>>>>> Tel: +41 (0)41 511 26 12
> >>>>>>> Email: info at klokantech.com
> >>>>>>> Web: http://www.klokantech.com/
> >>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> gdal-dev mailing list
> >>>>>>> gdal-dev at lists.osgeo.org
> >>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >>_______________________________________________
> >>gdal-dev mailing list
> >>gdal-dev at lists.osgeo.org
> >>http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160201/b4ae5f97/attachment-0001.html>

From sfkeller at gmail.com  Mon Feb  1 16:45:22 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Tue, 2 Feb 2016 01:45:22 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
 <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
Message-ID: <CAFcOn2-JUx5+4xMuLSmTMd_-AGvgmooW=eymbEfkc0msrFULHw@mail.gmail.com>

Blake,

Now the vector tiles spec. and the Mapbox approach became clearer to me.

I'm still pondering about realizing a vector tiles reader (especially
for QGIS) and for vector tiles uses cases like 1. base maps and 2.
spatial analysis:

Regarding clipped linestrings and polygons arriving at reader, there
seems to exist no hint (clipped) nor id mentioned in the spec. to help
the reader merging them?

While there's overzoom, what's about leaving out data in intermediate
zoom levels to save space? Does the spec. regulate that and who's
responsible for handling this: server or client?

Finally and back to my implementation concerns: How should an
interactive client deal occurring/disappearing feature classes in a
single "layer"? Is it forced to read all features on all zoom levels
in order to announce all feature classes?

:Stefan


2016-02-02 1:03 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
> Benjamin Stadin,
>
> As an author of the specification, I have to disagree with you on the
> support for other projections. There is no limitation on vector tiles being
> required to being in mercator. The specification in fact mentions that other
> projections may be used:
>
> https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds
>
> While it is not accessible via the node-mapnik bindings, we do in fact
> support encoding as different projections in mapnik-vector-tile. We have
> implemented the decoder so that it could accept other projections, but have
> not added a mapnik datasource that would support them, but if there is
> demand for such a thing we could do it.
>
> Your comments about the entire stack of Mapbox supporting mostly mercator
> could be very accurate, but this is not at all related to the Vector Tile
> Specification. We purposefully attempt to make our tools as projection-less
> as possible and hope that others find awesome ways to build upon the
> standard.
>
> "But what data is shown at which zoom level is defined by the styling" --
> This is not true because you could make your data not even provide data at
> certain zoom levels. At Mapbox we do this quite often, street data is never
> included at very low zoom levels. Therefore, the style isn't the only
> control here. In fact, I would encourage you to view styling and rendering
> of vector tiles as an entirely different topic.
>
> "There is enough interest from our side that we¹d be interested in
> contributing (maybe monetary or with code, or both) to define and implement
> a better general purpose tile format." -- Any issues you might have with the
> Mapbox Vector Tile Specification or any ideas you might have with the format
> are very much welcome. We want to make sure the spec migrates for community
> needs. Please see
> https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md for
> how you might help!
>
> Finally, I would like to stress that while Mapbox Vector Tiles were designed
> to be for rendering, it was well known during their design that they could
> be used for other applications. This was especially true when I was writing
> 2.0 of the specification as I tried to limit what would be considered even
> the most common uses of vector tiles.
>
> Thanks,
>
> Blake Thompson
>
> On Mon, Feb 1, 2016 at 4:27 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Hi Ben
>>
>> Thanks for explaining - Petr and I are the maintainers of OSM2Vectortiles.
>> I like projections (and also GeoPackage :-) ).
>> But reprojection is solved here, since OGR/QGIS can transform on the fly.
>> This thread is about Petr's question about a reader "for mapbox-like
>> vector tiles stored in MBTiles or downloaded from a url...".
>>
>> So I'd like to come back to the issue:
>> 1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
>> 2. and of a "feature provider" in an interactive environment (like
>> QGIS) or a file/stream converter (like OGR) => anybody?
>>
>> :Stefan
>>
>>
>>
>> 2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
>> <Benjamin.Stadin at heidelberg-mobil.com>:
>> > Hi Stefan,
>> >
>> > A vector tile may contain data for several zoom levels. But what data is
>> > shown at which zoom level is defined by the styling, not by the data
>> > itself. It is handled on client side, by the web (or native) tile
>> > renderer.
>> >
>> > The path is the same as with mercator tiles (zoomLevel/x/y):
>> > https://example.com/17/65535/43602.mvt
>> >
>> >
>> > The tile for zoom level 17 may contain features of class „building“, and
>> > the style definition may contain a rule that filters type „building“ for
>> > zoomLevels <= 18.
>> >
>> > ~Ben
>> >
>> > Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller" unter
>> > <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>> >
>> >>That's good news!
>> >>We'll be happy to add Python bindings to such a generic C++ library
>> >>for Mapbox vector tiles.
>> >>We have still some time (say few weeks?) left here to decide to
>> >>contribute either to these bindings or to Mapzen's pure Python lib.
>> >>
>> >>One reason why I'm insisting on Python (bindings) - besides easier
>> >>testing with QGIS - is the following:
>> >>AFAIK with vector tiles we have to deal with quite a new kind of
>> >>feature provider:
>> >>One which contains "zoom levels" and one which "suddenly" changes
>> >>feature class at different zoom levels.
>> >>If a client like QGIS consumes vector tiles from OGR in a one-shot
>> >>call, how should the client deal with such "zoom level" dependent
>> >>issues?
>> >>So my thinking is, to consume only the most appropriate zoom level,
>> >>probably only within current map canvas...
>> >>
>> >>:Stefan
>> >>
>> >>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>> >>>
>> >>> Stefan,
>> >>>
>> >>> I am not aware of any libraries besides mapnik vector tile that have
>> >>>been attempting to implement v2 specification. I think mapzen's
>> >>>implementation might be best? We have been wanting to add vector tiles
>> >>>to the python mapnik bindings for quite some time but we don't have the
>> >>>time to do it right now.
>> >>>
>> >>> I will try to think this week about how we could make a generic C++
>> >>>library quickly for Mapbox vector tiles.
>> >>>
>> >>> Thanks,
>> >>>
>> >>> Blake Thompson
>> >>>
>> >>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>> >>>>
>> >>>> Hi Blake
>> >>>>
>> >>>> It's clear to me that a good generic c++ library for encoding and
>> >>>> decoding vector tiles is needed.
>> >>>> On the other hand, I'd like to experiment with vector tiles and
>> >>>> related QGIS parallel loading issues for which Python is more
>> >>>> convenient.
>> >>>>
>> >>>> It seems that Mapzen's [1] Python implementation is further along.
>> >>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>> >>>>variant [2] ?
>> >>>>
>> >>>> :Stefan
>> >>>>
>> >>>> [1] https://github.com/mapzen/mapbox-vector-tile
>> >>>> [2] https://github.com/mapbox/vector-tile-py
>> >>>>
>> >>>>
>> >>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>> >>>>> All,
>> >>>>>
>> >>>>> The first thing that is going to be required likely is a good
>> >>>>> generic
>> >>>>>c++ library for encoding and decoding vector tiles IMO.
>> >>>>>
>> >>>>> I have spent a lot of time working on developing the mapnik vector
>> >>>>>tile library to be a solid implementation, especially around all the
>> >>>>>work done for 2.0 of Mapbox vector tile specification. I would love
>> >>>>> to
>> >>>>>eventually help make this a generalized implementation so that it is
>> >>>>>portable to a library like GDAL.
>> >>>>>
>> >>>>> We have talked about doing something like this at Mapbox but will
>> >>>>>require a good deal of time, so it hasn't been pushed forward yet.
>> >>>>> The
>> >>>>>other issues that come to mind to me is that some of the libraries
>> >>>>>that mapnik vector tile depends upon most likely need good custom
>> >>>>>implementations if we wanted to make it more generic.
>> >>>>>
>> >>>>> The reason for this is that I would prefer for it to be a header
>> >>>>> only
>> >>>>>library with no dependencies. Adding more dependencies for GDAL seems
>> >>>>>like it could be a mess.
>> >>>>>
>> >>>>> Blake Thompson
>> >>>>>
>> >>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>> >>>>>>wrote:
>> >>>>>>
>> >>>>>> Hi Petr, Blake, Even and everybody
>> >>>>>>
>> >>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>> >>>>>> I'd already asked Even a similar question.
>> >>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>> >>>>>>reader
>> >>>>>> client in Python if possible as part of a QGIS plugin.
>> >>>>>> And I'm interested not to do redundant implementations.
>> >>>>>> Are there any news on this matter?
>> >>>>>>
>> >>>>>> :Stefan
>> >>>>>> Prof. at HSR and leader of Geometa Lab
>> >>>>>>
>> >>>>>> @Even: Regarding OGR MVT development can you send to me (directly)
>> >>>>>> a
>> >>>>>> contact name of the group which won the bidding?
>> >>>>>>
>> >>>>>>
>> >>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal
>> >>>>>> <petr.pridal at klokantech.com>:
>> >>>>>>> Hi everybody,
>> >>>>>>>
>> >>>>>>> thanks for the comments. Regarding the technical details:
>> >>>>>>>
>> >>>>>>>> Each Tile is its own discrete dataset therefore the hardest part
>> >>>>>>>>would be
>> >>>>>>>> merging of features into the original features across tiles. You
>> >>>>>>>>could use
>> >>>>>>>> some complicated merging technique, but that could be very
>> >>>>>>>>expensive.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> The driver could require "id" parameter, which specifies name of
>> >>>>>>> an
>> >>>>>>> attribute with unique identifier on the features shared across the
>> >>>>>>>tiles.
>> >>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an unique
>> >>>>>>>non-zero
>> >>>>>>> "osm_id" in place. The first version of driver could read only
>> >>>>>>>features with
>> >>>>>>> such ID. The identifier does not have to be always filled, but
>> >>>>>>>often it is,
>> >>>>>>> especially in deeper zoom levels derived purely from OpenStreetMap
>> >>>>>>>- but
>> >>>>>>> yeh, a completely general stitching would be much harder.
>> >>>>>>>
>> >>>>>>> The clipping + merging of shapes itself can be implemented with
>> >>>>>>>underlaying
>> >>>>>>> GEOS library functions.
>> >>>>>>>
>> >>>>>>> BTW It is possible to examine vector tiles data in pure JavaScript
>> >>>>>>>X-Ray
>> >>>>>>> viewer (no WebGL support on browser required) made in OpenLayers3:
>> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>> >>>>>>>
>> >>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox GL
>> >>>>>>>JS
>> >>>>>>> powered X-Ray:
>> >>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>> >>>>>>>
>> >>>>>>> A debug viewer for each vector tile (made in OL3) decoded in pure
>> >>>>>>> JavaScript:
>> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>> >>>>>>>
>> >>>>>>> The OGR driver could be also practical for the unsimplified /
>> >>>>>>>ungeneralised
>> >>>>>>> MBTiles with OSM data available at:
>> >>>>>>>http://osmlab.github.io/osm-qa-tiles/
>> >>>>>>>
>> >>>>>>>>
>> >>>>>>>> If you wanted to simply view vector tile data it could get
>> >>>>>>>>confusing as
>> >>>>>>>> well since most vector tiles need a buffer when they are used for
>> >>>>>>>> visualization programs. This is important for things like
>> >>>>>>>> labeling
>> >>>>>>>>on maps
>> >>>>>>>> etc. Therefore, you could get a large amount of overlapping data
>> >>>>>>>>on tiles if
>> >>>>>>>> you loaded them all in at once.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> Clipping on border of each tile must be applied before stitching
>> >>>>>>>the vector
>> >>>>>>> features together  - so the buffer is removed. Buffer is there
>> >>>>>>> only
>> >>>>>>>for
>> >>>>>>> visualisation and labeling.
>> >>>>>>>
>> >>>>>>>>
>> >>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>> >>>>>>>>decoder isn't
>> >>>>>>>> currently able to decode vector tiles into a form not supported
>> >>>>>>>> by
>> >>>>>>>>mapnik.
>> >>>>>>>> Therefore, OGR would not be able to easily use this.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> Correct. It can't be used directly (GDAL can't link against), but
>> >>>>>>>the
>> >>>>>>> relevant code can be extracted and reused directly. For basic
>> >>>>>>>decoding
>> >>>>>>> critical is the Protobuf library (which is already in GDAL) and
>> >>>>>>>
>>
>> >>>>>>> >>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>> >>>>>>>_tile.proto
>> >>>>>>> + the code for converting pixel coordinates in features to
>> >>>>>>> relevant
>> >>>>>>>geo
>> >>>>>>> coordinates and GEOS-based merging of features.
>> >>>>>>>
>> >>>>>>>> We plan to write a generalized encoder and decoder eventually so
>> >>>>>>>>that any
>> >>>>>>>> other library can plugin with out the mapnik requirement.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> This would be amazing.
>> >>>>>>>
>> >>>>>>>> If you have any questions specifically about Mapnik Vector Tile
>> >>>>>>>> or
>> >>>>>>>>the
>> >>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would
>> >>>>>>>> note
>> >>>>>>>>that you
>> >>>>>>>> guys will want to update your vector tiles once the V2
>> >>>>>>>>specification changes
>> >>>>>>>> are into Mapnik-Vector-Tile.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> Cool! Thanks. Our world tiles are generated via Docker containers
>> >>>>>>>on a
>> >>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>> >>>>>>>upgrades on
>> >>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>> >>>>>>>software.
>> >>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>> >>>>>>>
>> >>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice ? I
>> >>>>>>>>don't
>> >>>>>>>> see
>> >>>>>>>> mention of that neither in the MVT spec (
>> >>>>>>>> https://github.com/mapbox/vector-
>> >>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>> >>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md ),
>> >>>>>>>>although
>> >>>>>>>> I
>> >>>>>>>> guess it is just a matter of storing a MVT blob in the tile_data
>> >>>>>>>>column.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector
>> >>>>>>> Tiles
>> >>>>>>>inside -
>> >>>>>>> and Mapnik reads them directly when rasterising. Storing the
>> >>>>>>> vector
>> >>>>>>>tiles in
>> >>>>>>> SQLite make sense - and it simplifies deployment, and you can then
>> >>>>>>>easily
>> >>>>>>> have complete world on each node of a cluster of tileservers. If
>> >>>>>>>you don't
>> >>>>>>> want to upgrade your base map too often, this approach is pretty
>> >>>>>>>efficient
>> >>>>>>> and removes the centralised database as typical bottleneck.
>> >>>>>>>
>> >>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>> >>>>>>>documented these
>> >>>>>>> in README.md at and
>> >>>>>>>https://github.com/klokantech/vector-tiles-sample before
>> >>>>>>> we started to work on OSM2VectorTiles project.
>> >>>>>>> There are also sample data and offline MapBox GL JS viewer in that
>> >>>>>>>repo.
>> >>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>> >>>>>>>folders on a
>> >>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com does
>> >>>>>>>by
>> >>>>>>> default for raster tiles.
>> >>>>>>>
>> >>>>>>> If OGR driver is implemented, the primary source should be
>> >>>>>>> probably
>> >>>>>>>reading
>> >>>>>>> from an URL via curl.
>> >>>>>>>
>> >>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the most
>> >>>>>>>practical
>> >>>>>>> portable alternative to it.
>> >>>>>>>
>> >>>>>>> Technically people may store the tiles in different ways - for
>> >>>>>>>example
>> >>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>> >>>>>>> https://github.com/kartotherian/) use Cassandra for tile storage,
>> >>>>>>> I
>> >>>>>>>guess
>> >>>>>>> MapBox internally is also on a different storage for production
>> >>>>>>>servers ...
>> >>>>>>> for transfers and streaming tilesets there is the  - but tiles are
>> >>>>>>>ALWAYS
>> >>>>>>> exposed via HTTP.
>> >>>>>>>
>> >>>>>>> Regards,
>> >>>>>>>
>> >>>>>>> Petr
>> >>>>>>> --
>> >>>>>>> Petr Pridal, Ph.D.
>> >>>>>>> CEO
>> >>>>>>>
>> >>>>>>> Klokan Technologies GmbH
>> >>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>> >>>>>>> Tel: +41 (0)41 511 26 12
>> >>>>>>> Email: info at klokantech.com
>> >>>>>>> Web: http://www.klokantech.com/
>> >>>>>>>
>> >>>>>>> _______________________________________________
>> >>>>>>> gdal-dev mailing list
>> >>>>>>> gdal-dev at lists.osgeo.org
>> >>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >>_______________________________________________
>> >>gdal-dev mailing list
>> >>gdal-dev at lists.osgeo.org
>> >>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >
>
>

From stambler at nearearth.aero  Mon Feb  1 18:07:09 2016
From: stambler at nearearth.aero (Adam Stambler)
Date: Mon, 1 Feb 2016 21:07:09 -0500
Subject: [gdal-dev] GDAL Warp API : Transforms on Z
Message-ID: <CABBH22uO-L1LEXv1MOvA0O34saUJKZogxCDKG3reD50T+87S_g@mail.gmail.com>

Hi All,

I am trying to implement a warp from a latitude, longitude, altitude (LLA)
image into a custom coordinate system using the GDAL Warp API.  The
transform between LLA and my coordinate requires scaling and shifting the
elevation.  My coordinate system is  a local tangent plane on the Earth's
surface where x is north, y is east, and z is pointed into the Earth.

When I follow the instructions in the GDAL Warp API tutorial
<http://www.gdal.org/warptut.html>,  my custom transform function supplied
to "psWarpOptions->pTransformerArg
<http://www.gdal.org/structGDALWarpOptions.html#a35647845a2629da876f379f82d58a2cd>"
only receives input z=0 values.  From the source code, it looks like the
internal GDALWarpKernel only passes z=0 values to to the pTransformerArg.
The Z values from the source elevation map are never used and therefore can
never be re-projected.

How can GDAL properly transform the source elevation data if the source
elevation is never passed to the transform function?

 How are transforms between ellipsoids or elevation units performed if not
through the GDALWarpOperation
<http://www.gdal.org/classGDALWarpOperation.html> API?


Thank you for any insights.

-Adam Stambler
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160201/c12e6110/attachment.html>

From sfkeller at gmail.com  Mon Feb  1 22:46:08 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Tue, 2 Feb 2016 07:46:08 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAPxHBh-U5TJeOHrqbgqe_Ck1wQd24PdMdt0mMBv1ee0HS-POsw@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
 <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
 <CAFcOn2-JUx5+4xMuLSmTMd_-AGvgmooW=eymbEfkc0msrFULHw@mail.gmail.com>
 <CAPxHBh-U5TJeOHrqbgqe_Ck1wQd24PdMdt0mMBv1ee0HS-POsw@mail.gmail.com>
Message-ID: <CAFcOn299HJpb7rmsAeGB49C6F8uNk1MRxzRQLaqOgKxfiysy+g@mail.gmail.com>

Blake,

Thanks for the comments.
Regarding leaving out data at intermediate zoom levels I also meant
omitting (setting to null) the entire tile.
In fact I just realize that the spec. even does not mention how a
reader knows at which level it should expect data if a tile is
null/empty.

:Stefan


2016-02-02 2:18 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
> Stefan,
>
> Consistent recognition of specific features can be done by proper use of the
> id field in features:
>
> https://github.com/mapbox/vector-tile-spec/tree/master/2.1#42-features
>
> You can definitely leave out data at intermediate zooms if you wished, we
> have considered this on many occasions at Mapbox. As far as the
> specification is concerned currently, the vector tile itself purposefully
> does not contain all the metadata necessary for this specific task. This is
> mentioned directly in the specification that each tile does not contain
> information about its projection or bounds. The Vector Tile Specification is
> purposeful in this because it leaves others specifications or an
> implementation to explicitly provide all the necessary information.
>
> I have considered that we could define a metafile to define all this
> information explicitly, but for now as far as I am concerned the
> specification just for the tiles is very young! We could make a decision on
> this sort of implementation, but it could very well be better placed inside
> another standard. I will not shy away from the fact that the specification
> very well might change as time goes on and perhaps adding more things that
> will more narrowly define it such things as projection and bounds. The needs
> of those using the format will definitely provide influence on how it
> changes.
>
> There currently is no indexing or listing of features within a layer, other
> then the layer classes themselves. We could provide such a feature perhaps,
> but currently it would likely just take more memory with out much benefit.
> It is very quick for our decoder to iterate over features, and in general
> processing of vector tile data is expected to be done in memory.
>
> Most client are only concerned about the vector tiles that are currently
> within a "view". Therefore, if a feature is missing within a view it is
> considered not to have that feature. However, this doesn't limit people from
> doing analysis across a large number of tiles. At Mapbox we have used
> map-reduce type solutions to process large number of tiles for different
> projects:
>
> https://github.com/mapbox/tile-reduce
>
> The idea is that vector tiles themselves should be relatively small in size
> in most situations. If you data becomes too dense you could put the data at
> a higher zoom or provide an abstraction of features. The format itself is a
> "lossy" format as you are putting your data in a projection that is unique
> to the tile, so the format is not designed for situations where accuracy is
> extremely important. If you need more accuracy you can increase the "extent"
> of a layer, which adds more precision, but this could also increase the size
> of your tiles.
>
> As far as the concerns with making a solid GDAL driver from vector tiles, I
> am not certain what the solution should be honestly. I want to be here as a
> reference to help something be grown, but I can't point at a great
> implementation like this because we have not put into mapnik even yet "a
> datasource of many vector tiles" as a plugin. We have left such operations
> up to a large number of open source javascript libraries that can provide
> things like caching etc. (See tilelive https://github.com/mapbox/tilelive/ )
>
> In a limited sense to think of Vector Tiles for Mapbox Tools in the same
> sense you would think about WKB for PostGIS. It is not the entire solution
> alone.
>
> Thanks,
>
> Blake Thompson
>
> On Mon, Feb 1, 2016 at 5:45 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Blake,
>>
>> Now the vector tiles spec. and the Mapbox approach became clearer to me.
>>
>> I'm still pondering about realizing a vector tiles reader (especially
>> for QGIS) and for vector tiles uses cases like 1. base maps and 2.
>> spatial analysis:
>>
>> Regarding clipped linestrings and polygons arriving at reader, there
>> seems to exist no hint (clipped) nor id mentioned in the spec. to help
>> the reader merging them?
>>
>> While there's overzoom, what's about leaving out data in intermediate
>> zoom levels to save space? Does the spec. regulate that and who's
>> responsible for handling this: server or client?
>>
>> Finally and back to my implementation concerns: How should an
>> interactive client deal occurring/disappearing feature classes in a
>> single "layer"? Is it forced to read all features on all zoom levels
>> in order to announce all feature classes?
>>
>> :Stefan
>>
>>
>> 2016-02-02 1:03 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
>> > Benjamin Stadin,
>> >
>> > As an author of the specification, I have to disagree with you on the
>> > support for other projections. There is no limitation on vector tiles
>> > being
>> > required to being in mercator. The specification in fact mentions that
>> > other
>> > projections may be used:
>> >
>> >
>> > https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds
>> >
>> > While it is not accessible via the node-mapnik bindings, we do in fact
>> > support encoding as different projections in mapnik-vector-tile. We have
>> > implemented the decoder so that it could accept other projections, but
>> > have
>> > not added a mapnik datasource that would support them, but if there is
>> > demand for such a thing we could do it.
>> >
>> > Your comments about the entire stack of Mapbox supporting mostly
>> > mercator
>> > could be very accurate, but this is not at all related to the Vector
>> > Tile
>> > Specification. We purposefully attempt to make our tools as
>> > projection-less
>> > as possible and hope that others find awesome ways to build upon the
>> > standard.
>> >
>> > "But what data is shown at which zoom level is defined by the styling"
>> > --
>> > This is not true because you could make your data not even provide data
>> > at
>> > certain zoom levels. At Mapbox we do this quite often, street data is
>> > never
>> > included at very low zoom levels. Therefore, the style isn't the only
>> > control here. In fact, I would encourage you to view styling and
>> > rendering
>> > of vector tiles as an entirely different topic.
>> >
>> > "There is enough interest from our side that we¹d be interested in
>> > contributing (maybe monetary or with code, or both) to define and
>> > implement
>> > a better general purpose tile format." -- Any issues you might have with
>> > the
>> > Mapbox Vector Tile Specification or any ideas you might have with the
>> > format
>> > are very much welcome. We want to make sure the spec migrates for
>> > community
>> > needs. Please see
>> > https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md
>> > for
>> > how you might help!
>> >
>> > Finally, I would like to stress that while Mapbox Vector Tiles were
>> > designed
>> > to be for rendering, it was well known during their design that they
>> > could
>> > be used for other applications. This was especially true when I was
>> > writing
>> > 2.0 of the specification as I tried to limit what would be considered
>> > even
>> > the most common uses of vector tiles.
>> >
>> > Thanks,
>> >
>> > Blake Thompson
>> >
>> > On Mon, Feb 1, 2016 at 4:27 PM, Stefan Keller <sfkeller at gmail.com>
>> > wrote:
>> >>
>> >> Hi Ben
>> >>
>> >> Thanks for explaining - Petr and I are the maintainers of
>> >> OSM2Vectortiles.
>> >> I like projections (and also GeoPackage :-) ).
>> >> But reprojection is solved here, since OGR/QGIS can transform on the
>> >> fly.
>> >> This thread is about Petr's question about a reader "for mapbox-like
>> >> vector tiles stored in MBTiles or downloaded from a url...".
>> >>
>> >> So I'd like to come back to the issue:
>> >> 1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
>> >> 2. and of a "feature provider" in an interactive environment (like
>> >> QGIS) or a file/stream converter (like OGR) => anybody?
>> >>
>> >> :Stefan
>> >>
>> >>
>> >>
>> >> 2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
>> >> <Benjamin.Stadin at heidelberg-mobil.com>:
>> >> > Hi Stefan,
>> >> >
>> >> > A vector tile may contain data for several zoom levels. But what data
>> >> > is
>> >> > shown at which zoom level is defined by the styling, not by the data
>> >> > itself. It is handled on client side, by the web (or native) tile
>> >> > renderer.
>> >> >
>> >> > The path is the same as with mercator tiles (zoomLevel/x/y):
>> >> > https://example.com/17/65535/43602.mvt
>> >> >
>> >> >
>> >> > The tile for zoom level 17 may contain features of class „building“,
>> >> > and
>> >> > the style definition may contain a rule that filters type „building“
>> >> > for
>> >> > zoomLevels <= 18.
>> >> >
>> >> > ~Ben
>> >> >
>> >> > Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller"
>> >> > unter
>> >> > <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>> >> >
>> >> >>That's good news!
>> >> >>We'll be happy to add Python bindings to such a generic C++ library
>> >> >>for Mapbox vector tiles.
>> >> >>We have still some time (say few weeks?) left here to decide to
>> >> >>contribute either to these bindings or to Mapzen's pure Python lib.
>> >> >>
>> >> >>One reason why I'm insisting on Python (bindings) - besides easier
>> >> >>testing with QGIS - is the following:
>> >> >>AFAIK with vector tiles we have to deal with quite a new kind of
>> >> >>feature provider:
>> >> >>One which contains "zoom levels" and one which "suddenly" changes
>> >> >>feature class at different zoom levels.
>> >> >>If a client like QGIS consumes vector tiles from OGR in a one-shot
>> >> >>call, how should the client deal with such "zoom level" dependent
>> >> >>issues?
>> >> >>So my thinking is, to consume only the most appropriate zoom level,
>> >> >>probably only within current map canvas...
>> >> >>
>> >> >>:Stefan
>> >> >>
>> >> >>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>> >> >>>
>> >> >>> Stefan,
>> >> >>>
>> >> >>> I am not aware of any libraries besides mapnik vector tile that
>> >> >>> have
>> >> >>>been attempting to implement v2 specification. I think mapzen's
>> >> >>>implementation might be best? We have been wanting to add vector
>> >> >>> tiles
>> >> >>>to the python mapnik bindings for quite some time but we don't have
>> >> >>> the
>> >> >>>time to do it right now.
>> >> >>>
>> >> >>> I will try to think this week about how we could make a generic C++
>> >> >>>library quickly for Mapbox vector tiles.
>> >> >>>
>> >> >>> Thanks,
>> >> >>>
>> >> >>> Blake Thompson
>> >> >>>
>> >> >>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com>
>> >> >>>> wrote:
>> >> >>>>
>> >> >>>> Hi Blake
>> >> >>>>
>> >> >>>> It's clear to me that a good generic c++ library for encoding and
>> >> >>>> decoding vector tiles is needed.
>> >> >>>> On the other hand, I'd like to experiment with vector tiles and
>> >> >>>> related QGIS parallel loading issues for which Python is more
>> >> >>>> convenient.
>> >> >>>>
>> >> >>>> It seems that Mapzen's [1] Python implementation is further along.
>> >> >>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>> >> >>>>variant [2] ?
>> >> >>>>
>> >> >>>> :Stefan
>> >> >>>>
>> >> >>>> [1] https://github.com/mapzen/mapbox-vector-tile
>> >> >>>> [2] https://github.com/mapbox/vector-tile-py
>> >> >>>>
>> >> >>>>
>> >> >>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>> >> >>>>> All,
>> >> >>>>>
>> >> >>>>> The first thing that is going to be required likely is a good
>> >> >>>>> generic
>> >> >>>>>c++ library for encoding and decoding vector tiles IMO.
>> >> >>>>>
>> >> >>>>> I have spent a lot of time working on developing the mapnik
>> >> >>>>> vector
>> >> >>>>>tile library to be a solid implementation, especially around all
>> >> >>>>> the
>> >> >>>>>work done for 2.0 of Mapbox vector tile specification. I would
>> >> >>>>> love
>> >> >>>>> to
>> >> >>>>>eventually help make this a generalized implementation so that it
>> >> >>>>> is
>> >> >>>>>portable to a library like GDAL.
>> >> >>>>>
>> >> >>>>> We have talked about doing something like this at Mapbox but will
>> >> >>>>>require a good deal of time, so it hasn't been pushed forward yet.
>> >> >>>>> The
>> >> >>>>>other issues that come to mind to me is that some of the libraries
>> >> >>>>>that mapnik vector tile depends upon most likely need good custom
>> >> >>>>>implementations if we wanted to make it more generic.
>> >> >>>>>
>> >> >>>>> The reason for this is that I would prefer for it to be a header
>> >> >>>>> only
>> >> >>>>>library with no dependencies. Adding more dependencies for GDAL
>> >> >>>>> seems
>> >> >>>>>like it could be a mess.
>> >> >>>>>
>> >> >>>>> Blake Thompson
>> >> >>>>>
>> >> >>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>> >> >>>>>>wrote:
>> >> >>>>>>
>> >> >>>>>> Hi Petr, Blake, Even and everybody
>> >> >>>>>>
>> >> >>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>> >> >>>>>> I'd already asked Even a similar question.
>> >> >>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>> >> >>>>>>reader
>> >> >>>>>> client in Python if possible as part of a QGIS plugin.
>> >> >>>>>> And I'm interested not to do redundant implementations.
>> >> >>>>>> Are there any news on this matter?
>> >> >>>>>>
>> >> >>>>>> :Stefan
>> >> >>>>>> Prof. at HSR and leader of Geometa Lab
>> >> >>>>>>
>> >> >>>>>> @Even: Regarding OGR MVT development can you send to me
>> >> >>>>>> (directly)
>> >> >>>>>> a
>> >> >>>>>> contact name of the group which won the bidding?
>> >> >>>>>>
>> >> >>>>>>
>> >> >>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal
>> >> >>>>>> <petr.pridal at klokantech.com>:
>> >> >>>>>>> Hi everybody,
>> >> >>>>>>>
>> >> >>>>>>> thanks for the comments. Regarding the technical details:
>> >> >>>>>>>
>> >> >>>>>>>> Each Tile is its own discrete dataset therefore the hardest
>> >> >>>>>>>> part
>> >> >>>>>>>>would be
>> >> >>>>>>>> merging of features into the original features across tiles.
>> >> >>>>>>>> You
>> >> >>>>>>>>could use
>> >> >>>>>>>> some complicated merging technique, but that could be very
>> >> >>>>>>>>expensive.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> The driver could require "id" parameter, which specifies name
>> >> >>>>>>> of
>> >> >>>>>>> an
>> >> >>>>>>> attribute with unique identifier on the features shared across
>> >> >>>>>>> the
>> >> >>>>>>>tiles.
>> >> >>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an
>> >> >>>>>>> unique
>> >> >>>>>>>non-zero
>> >> >>>>>>> "osm_id" in place. The first version of driver could read only
>> >> >>>>>>>features with
>> >> >>>>>>> such ID. The identifier does not have to be always filled, but
>> >> >>>>>>>often it is,
>> >> >>>>>>> especially in deeper zoom levels derived purely from
>> >> >>>>>>> OpenStreetMap
>> >> >>>>>>>- but
>> >> >>>>>>> yeh, a completely general stitching would be much harder.
>> >> >>>>>>>
>> >> >>>>>>> The clipping + merging of shapes itself can be implemented with
>> >> >>>>>>>underlaying
>> >> >>>>>>> GEOS library functions.
>> >> >>>>>>>
>> >> >>>>>>> BTW It is possible to examine vector tiles data in pure
>> >> >>>>>>> JavaScript
>> >> >>>>>>>X-Ray
>> >> >>>>>>> viewer (no WebGL support on browser required) made in
>> >> >>>>>>> OpenLayers3:
>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>> >> >>>>>>>
>> >> >>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox
>> >> >>>>>>> GL
>> >> >>>>>>>JS
>> >> >>>>>>> powered X-Ray:
>> >> >>>>>>>
>> >> >>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>> >> >>>>>>>
>> >> >>>>>>> A debug viewer for each vector tile (made in OL3) decoded in
>> >> >>>>>>> pure
>> >> >>>>>>> JavaScript:
>> >> >>>>>>>
>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>> >> >>>>>>>
>> >> >>>>>>> The OGR driver could be also practical for the unsimplified /
>> >> >>>>>>>ungeneralised
>> >> >>>>>>> MBTiles with OSM data available at:
>> >> >>>>>>>http://osmlab.github.io/osm-qa-tiles/
>> >> >>>>>>>
>> >> >>>>>>>>
>> >> >>>>>>>> If you wanted to simply view vector tile data it could get
>> >> >>>>>>>>confusing as
>> >> >>>>>>>> well since most vector tiles need a buffer when they are used
>> >> >>>>>>>> for
>> >> >>>>>>>> visualization programs. This is important for things like
>> >> >>>>>>>> labeling
>> >> >>>>>>>>on maps
>> >> >>>>>>>> etc. Therefore, you could get a large amount of overlapping
>> >> >>>>>>>> data
>> >> >>>>>>>>on tiles if
>> >> >>>>>>>> you loaded them all in at once.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> Clipping on border of each tile must be applied before
>> >> >>>>>>> stitching
>> >> >>>>>>>the vector
>> >> >>>>>>> features together  - so the buffer is removed. Buffer is there
>> >> >>>>>>> only
>> >> >>>>>>>for
>> >> >>>>>>> visualisation and labeling.
>> >> >>>>>>>
>> >> >>>>>>>>
>> >> >>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>> >> >>>>>>>>decoder isn't
>> >> >>>>>>>> currently able to decode vector tiles into a form not
>> >> >>>>>>>> supported
>> >> >>>>>>>> by
>> >> >>>>>>>>mapnik.
>> >> >>>>>>>> Therefore, OGR would not be able to easily use this.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> Correct. It can't be used directly (GDAL can't link against),
>> >> >>>>>>> but
>> >> >>>>>>>the
>> >> >>>>>>> relevant code can be extracted and reused directly. For basic
>> >> >>>>>>>decoding
>> >> >>>>>>> critical is the Protobuf library (which is already in GDAL) and
>> >> >>>>>>>
>> >>
>> >> >>>>>>>
>> >> >>>>>>> >>>>>>> >>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>> >> >>>>>>>_tile.proto
>> >> >>>>>>> + the code for converting pixel coordinates in features to
>> >> >>>>>>> relevant
>> >> >>>>>>>geo
>> >> >>>>>>> coordinates and GEOS-based merging of features.
>> >> >>>>>>>
>> >> >>>>>>>> We plan to write a generalized encoder and decoder eventually
>> >> >>>>>>>> so
>> >> >>>>>>>>that any
>> >> >>>>>>>> other library can plugin with out the mapnik requirement.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> This would be amazing.
>> >> >>>>>>>
>> >> >>>>>>>> If you have any questions specifically about Mapnik Vector
>> >> >>>>>>>> Tile
>> >> >>>>>>>> or
>> >> >>>>>>>>the
>> >> >>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would
>> >> >>>>>>>> note
>> >> >>>>>>>>that you
>> >> >>>>>>>> guys will want to update your vector tiles once the V2
>> >> >>>>>>>>specification changes
>> >> >>>>>>>> are into Mapnik-Vector-Tile.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> Cool! Thanks. Our world tiles are generated via Docker
>> >> >>>>>>> containers
>> >> >>>>>>>on a
>> >> >>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>> >> >>>>>>>upgrades on
>> >> >>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>> >> >>>>>>>software.
>> >> >>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>> >> >>>>>>>
>> >> >>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice
>> >> >>>>>>>> ? I
>> >> >>>>>>>>don't
>> >> >>>>>>>> see
>> >> >>>>>>>> mention of that neither in the MVT spec (
>> >> >>>>>>>> https://github.com/mapbox/vector-
>> >> >>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>> >> >>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md
>> >> >>>>>>>> ),
>> >> >>>>>>>>although
>> >> >>>>>>>> I
>> >> >>>>>>>> guess it is just a matter of storing a MVT blob in the
>> >> >>>>>>>> tile_data
>> >> >>>>>>>>column.
>> >> >>>>>>>
>> >> >>>>>>>
>> >> >>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector
>> >> >>>>>>> Tiles
>> >> >>>>>>>inside -
>> >> >>>>>>> and Mapnik reads them directly when rasterising. Storing the
>> >> >>>>>>> vector
>> >> >>>>>>>tiles in
>> >> >>>>>>> SQLite make sense - and it simplifies deployment, and you can
>> >> >>>>>>> then
>> >> >>>>>>>easily
>> >> >>>>>>> have complete world on each node of a cluster of tileservers.
>> >> >>>>>>> If
>> >> >>>>>>>you don't
>> >> >>>>>>> want to upgrade your base map too often, this approach is
>> >> >>>>>>> pretty
>> >> >>>>>>>efficient
>> >> >>>>>>> and removes the centralised database as typical bottleneck.
>> >> >>>>>>>
>> >> >>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>> >> >>>>>>>documented these
>> >> >>>>>>> in README.md at and
>> >> >>>>>>>https://github.com/klokantech/vector-tiles-sample before
>> >> >>>>>>> we started to work on OSM2VectorTiles project.
>> >> >>>>>>> There are also sample data and offline MapBox GL JS viewer in
>> >> >>>>>>> that
>> >> >>>>>>>repo.
>> >> >>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>> >> >>>>>>>folders on a
>> >> >>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com
>> >> >>>>>>> does
>> >> >>>>>>>by
>> >> >>>>>>> default for raster tiles.
>> >> >>>>>>>
>> >> >>>>>>> If OGR driver is implemented, the primary source should be
>> >> >>>>>>> probably
>> >> >>>>>>>reading
>> >> >>>>>>> from an URL via curl.
>> >> >>>>>>>
>> >> >>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the
>> >> >>>>>>> most
>> >> >>>>>>>practical
>> >> >>>>>>> portable alternative to it.
>> >> >>>>>>>
>> >> >>>>>>> Technically people may store the tiles in different ways - for
>> >> >>>>>>>example
>> >> >>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>> >> >>>>>>> https://github.com/kartotherian/) use Cassandra for tile
>> >> >>>>>>> storage,
>> >> >>>>>>> I
>> >> >>>>>>>guess
>> >> >>>>>>> MapBox internally is also on a different storage for production
>> >> >>>>>>>servers ...
>> >> >>>>>>> for transfers and streaming tilesets there is the  - but tiles
>> >> >>>>>>> are
>> >> >>>>>>>ALWAYS
>> >> >>>>>>> exposed via HTTP.
>> >> >>>>>>>
>> >> >>>>>>> Regards,
>> >> >>>>>>>
>> >> >>>>>>> Petr
>> >> >>>>>>> --
>> >> >>>>>>> Petr Pridal, Ph.D.
>> >> >>>>>>> CEO
>> >> >>>>>>>
>> >> >>>>>>> Klokan Technologies GmbH
>> >> >>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>> >> >>>>>>> Tel: +41 (0)41 511 26 12
>> >> >>>>>>> Email: info at klokantech.com
>> >> >>>>>>> Web: http://www.klokantech.com/
>> >> >>>>>>>
>> >> >>>>>>> _______________________________________________
>> >> >>>>>>> gdal-dev mailing list
>> >> >>>>>>> gdal-dev at lists.osgeo.org
>> >> >>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >> >>_______________________________________________
>> >> >>gdal-dev mailing list
>> >> >>gdal-dev at lists.osgeo.org
>> >> >>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> >> >
>> >
>> >
>
>

From Benjamin.Stadin at heidelberg-mobil.com  Tue Feb  2 01:10:57 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Tue, 2 Feb 2016 09:10:57 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <D2D5B596.3221B%benjamin.stadin@heidelberg-mobil.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
 <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
 <D2D5B596.3221B%benjamin.stadin@heidelberg-mobil.com>
Message-ID: <D2D63101.3233C%benjamin.stadin@heidelberg-mobil.com>

Hi Blake,

I know that the MVT spec supports different projections. But I said they are "depending on a certain projection when the tiles are created". Maybe I found the wrong words – I did not mean to say that this is a misconception of MVT, but something "that current mapping tools face in practice“.

Combining and accessing data from different projections is still a practical issue, as well as their reprojection when you need a certain accuracy. It begins with the fact just web mercator tiling is widely enough adopted. I can create my own MVT tiles with my own projection – and have to make several assumptions and code hacks get the result right. Again, I’m not saying this is a misconception with MVT but a legacy problem not solved yet. It is possible to tackle this problem with vector tiles in a different, maybe new, way.

> Your comments about the entire stack of Mapbox supporting mostly mercator could be very accurate, but this is not at all related to the Vector Tile Specification.

Once the (not so trivial) polygon reconstruction challenge is solved, it is entirely possible to define a single tiling format / scheme that fits various projections. Maybe an adaptation of a MODIS Grid with tile sizes in meters correlating with zoom levels as we know them from web mercator. It could store all data as, e.g. as longitude latitude pairs by default (and would not capped at the poles like web mercator).

This storage format may then contain data of different projections. However, I believe unprojected WGS84 long / lat would be the proper default for a future map storage format, since it should be possible to do the projection in realtime (web mercator is trivial enough to do in code in realtime, for other more compute intense projections it could be done in realtime via OpenGL shaders: https://github.com/rjw57/proj4webgl).

> Any issues you might have with the Mapbox Vector Tile Specification or any ideas you might have with the format are very much welcome.

I’ll try to contribute. But I have a feeling that my ideas outlined above, and what we need for our own rendering and data subsystem, would be breaking to much for you.

> Finally, I would like to stress that while Mapbox Vector Tiles were designed to be for rendering, it was well known during their design that they could be used for other applications.

Here I have to disagree. To summarize, tiled vector data (not just MVT)  does a) not solve practical (legacy) issues in regards to projections and combinations of different projections. But it b) also adds new and challenging problems to deal with split polygons and degenerated geometries (in some cases).

In my opinion, it shouldn’t be considered reliable, or maybe accurate, enough for general purpose GIS usage other than rendering.

~Ben

Von: Blake Thompson <flippmoke at gmail.com<mailto:flippmoke at gmail.com>>
Datum: Dienstag, 2. Februar 2016 um 01:03
An: Stefan Keller <sfkeller at gmail.com<mailto:sfkeller at gmail.com>>
Cc: Benjamin Stadin <benjamin.stadin at heidelberg-mobil.com<mailto:benjamin.stadin at heidelberg-mobil.com>>, Gdal-Dev <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>, Even Rouault <even.rouault at mines-paris.org<mailto:even.rouault at mines-paris.org>>
Betreff: Re: [gdal-dev] Vector Tiles in OGR

Benjamin Stadin,

As an author of the specification, I have to disagree with you on the support for other projections. There is no limitation on vector tiles being required to being in mercator. The specification in fact mentions that other projections may be used:

https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds

While it is not accessible via the node-mapnik bindings, we do in fact support encoding as different projections in mapnik-vector-tile. We have implemented the decoder so that it could accept other projections, but have not added a mapnik datasource that would support them, but if there is demand for such a thing we could do it.

Your comments about the entire stack of Mapbox supporting mostly mercator could be very accurate, but this is not at all related to the Vector Tile Specification. We purposefully attempt to make our tools as projection-less as possible and hope that others find awesome ways to build upon the standard.

"But what data is shown at which zoom level is defined by the styling" -- This is not true because you could make your data not even provide data at certain zoom levels. At Mapbox we do this quite often, street data is never included at very low zoom levels. Therefore, the style isn't the only control here. In fact, I would encourage you to view styling and rendering of vector tiles as an entirely different topic.

"There is enough interest from our side that we¹d be interested in contributing (maybe monetary or with code, or both) to define and implement a better general purpose tile format." -- Any issues you might have with the Mapbox Vector Tile Specification or any ideas you might have with the format are very much welcome. We want to make sure the spec migrates for community needs. Please see https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md for how you might help!

Finally, I would like to stress that while Mapbox Vector Tiles were designed to be for rendering, it was well known during their design that they could be used for other applications. This was especially true when I was writing 2.0 of the specification as I tried to limit what would be considered even the most common uses of vector tiles.

Thanks,

Blake Thompson

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160202/e6b58e87/attachment.html>

From ari.jolma at gmail.com  Tue Feb  2 01:42:07 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 2 Feb 2016 11:42:07 +0200
Subject: [gdal-dev] export to WKT oddity
Message-ID: <56B079EF.5020307@gmail.com>

Even

Why the forcing to ISO variant in MultiCurve etc. exportToWkt method?

That leads currently to outputs like

GEOMETRYCOLLECTION (POINT EMPTY,MULTISURFACE Z EMPTY,POINT EMPTY)

which seems illogical to me.

Ari


From even.rouault at spatialys.com  Tue Feb  2 02:23:11 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Feb 2016 11:23:11 +0100
Subject: [gdal-dev] export to WKT oddity
In-Reply-To: <56B079EF.5020307@gmail.com>
References: <56B079EF.5020307@gmail.com>
Message-ID: <201602021123.11994.even.rouault@spatialys.com>

Le mardi 02 février 2016 10:42:07, Ari Jolma a écrit :
> Even
> 
> Why the forcing to ISO variant in MultiCurve etc. exportToWkt method?

To avoid continuing generating legacy WKT with new geometry types.

 * For backward compatibility purposes, it exports the Old-style 99-402
 * extended dimension (Z) WKB types for types Point, LineString, Polygon,
 * MultiPoint, MultiLineString, MultiPolygon and GeometryCollection.
 * For other geometry types, it is equivalent to OGR_G_ExportToIsoWkt().

> 
> That leads currently to outputs like
> 
> GEOMETRYCOLLECTION (POINT EMPTY,MULTISURFACE Z EMPTY,POINT EMPTY)

Ah indeed, there might be some corner cases like the above one where this does 
not work very well. 
In the above, OGR_G_ExportToIsoWkt() should be rather used.
We could perhaps fix exportToWkt() in that situation to switch completely to 
IsoWkt() as soon as there's a non-legacy geometry type in the collection ?

> 
> which seems illogical to me.
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Feb  2 03:13:53 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 2 Feb 2016 12:13:53 +0100
Subject: [gdal-dev] GDAL Warp API : Transforms on Z
In-Reply-To: <CABBH22uO-L1LEXv1MOvA0O34saUJKZogxCDKG3reD50T+87S_g@mail.gmail.com>
References: <CABBH22uO-L1LEXv1MOvA0O34saUJKZogxCDKG3reD50T+87S_g@mail.gmail.com>
Message-ID: <201602021213.53348.even.rouault@spatialys.com>

Le mardi 02 février 2016 03:07:09, Adam Stambler a écrit :
> Hi All,
> 
> I am trying to implement a warp from a latitude, longitude, altitude (LLA)
> image into a custom coordinate system using the GDAL Warp API.  The
> transform between LLA and my coordinate requires scaling and shifting the
> elevation.  My coordinate system is  a local tangent plane on the Earth's
> surface where x is north, y is east, and z is pointed into the Earth.
> 
> When I follow the instructions in the GDAL Warp API tutorial
> <http://www.gdal.org/warptut.html>,  my custom transform function supplied
> to "psWarpOptions->pTransformerArg
> <http://www.gdal.org/structGDALWarpOptions.html#a35647845a2629da876f379f82d
> 58a2cd>" only receives input z=0 values.  From the source code, it looks
> like the internal GDALWarpKernel only passes z=0 values to to the
> pTransformerArg. The Z values from the source elevation map 

GDALWarpKernel is aimed at warping images that can represent anything, and not 
only elevation maps, so there's no z value to read from. When reprojection is 
involved, the imagery is indeed assumed to be at z=0.

You can specify a DEM in particular cases like RPC transformation. Or if you 
use a coordinate system that uses a proj.4 vertical datum shift grid.
But I'm not completely clear that any of the above really matches your needs.
Perhaps you would need to consider your input raster as a collection of 
points, transform each point independantly with a custom transformation 
method, and then create a grid from the scattered points. GDALWarpKernel 
itself will not alter pixel values other than the effect of the resampling 
kernel used.

> are never used
> and therefore can never be re-projected.
> 
> How can GDAL properly transform the source elevation data if the source
> elevation is never passed to the transform function?
> 
>  How are transforms between ellipsoids or elevation units performed if not
> through the GDALWarpOperation
> <http://www.gdal.org/classGDALWarpOperation.html> API?

> 
> 
> Thank you for any insights.
> 
> -Adam Stambler

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From piotrpachol at gmail.com  Tue Feb  2 06:37:34 2016
From: piotrpachol at gmail.com (=?UTF-8?B?UGlvdHIgUGFjaMOzxYI=?=)
Date: Tue, 2 Feb 2016 15:37:34 +0100
Subject: [gdal-dev] pdf file - raster and vector differences
Message-ID: <56B0BF2E.1090205@gmail.com>

Hello,

I would like to ask If there is a way (by means of gdal tools) to 
recognize that pdf has vector features ?
I have hundreds of geospatial pdf files (raster and vector) and I don't 
want  to open each of file in Acrobat Reader to verify if it is raster 
or vector.
Instead I would like to make a script to produce result in text files, 
which I can later process automatically.
I must add that in standard result of gdalinfo command I can't see any 
difference between raster and vector pdf file.

Regards,
Piotr

From andre+joost at nurfuerspam.de  Tue Feb  2 09:35:49 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 02 Feb 2016 18:35:49 +0100
Subject: [gdal-dev] pdf file - raster and vector differences
In-Reply-To: <56B0BF2E.1090205@gmail.com>
References: <56B0BF2E.1090205@gmail.com>
Message-ID: <n8qpkd$odf$1@ger.gmane.org>

Am 02.02.2016 um 15:37 schrieb Piotr Pachół:
> Hello,
>
> I would like to ask If there is a way (by means of gdal tools) to
> recognize that pdf has vector features ?
> I have hundreds of geospatial pdf files (raster and vector) and I don't
> want  to open each of file in Acrobat Reader to verify if it is raster
> or vector.
> Instead I would like to make a script to produce result in text files,
> which I can later process automatically.
> I must add that in standard result of gdalinfo command I can't see any
> difference between raster and vector pdf file.
>

Apart from gdalinfo you can run ogrinfo on the files, which will only 
return vector layers.

See my answer here for an example:

http://gis.stackexchange.com/questions/156299/how-to-have-gdal-print-layers-of-geopdf-and-say-which-are-raster-vs-vector

gdalinfo also reports meta layers, which only consist of sublayers 
(vector or raster or both), without own data.

HTH,
André Joost



From ari.jolma at gmail.com  Wed Feb  3 05:36:14 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 3 Feb 2016 15:36:14 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201602011617.46069.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com> <56ADCCB7.4040008@gmail.com>
 <201602011617.46069.even.rouault@spatialys.com>
Message-ID: <56B2024E.6040102@gmail.com>

I finally have the (existing) autotests passing with the new API - 
basically just replacing the nCoordDimension property of OGRGeometry 
with flags (for Z and M) - and a rather large set of tests for 
import/export WKT and WKB with M passing.

https://travis-ci.org/ajolma/GDAL-XYZM/builds/106725974

Maybe we should move to a vote on the RFC?

Ari

01.02.2016, 17:17, Even Rouault kirjoitti:
> Le dimanche 31 janvier 2016 09:58:31, Ari Jolma a écrit :
>> This seems to be a pretty big thing to add but doable.
>>
>> So, one more thing to discuss before going to vote later is the target
>> milestone. Maybe add it to 2.1 as "an experimental feature" and aim for
>> 2.2 as a more production ready? This of course assuming that I can get
>> it implemented before 2.1. By "implemented" I mean generic support + one
>> or two drivers (shape, pg) & passing current tests + basic set of new
>> tests.
> We have until end of march for the feature feeze of GDAL 2.1, so that lets
> some time. I could also potentially help if you need, for example during the
> OSGeo code sprint end of this month (for example on the spatialite M support,
> that is needed for SQLite dialect support or adding tests in Python test
> suite).
> If we have core support (C++ changes, C API, WKB/WKT importer/exporters) +
> shape + pg working, that's enough I think to advertize as non-experimental.
> GPKG support should also not require a lot of work (likely just advertizing
> the M capability) as it relies on WKB.
>
>> I've also edited the RFC draft according to what I've found / thought
>> while developing. I'd be happy to get feedback about the proposed
>> additions to the APIs.
> Looks good to me.
>
> I'm not completely sure about the opportunity to have #define wkbPointZ
> wkbPoint25D alias. Or at least it would deserve an explicit Doxygen comment to
> warn that it is an alias to the value used in the old 2.5D 99-402 extension,
> and not the value of the ISO SQL/MM Part 3 as one could expect from the name.
> The situation is a bit messy. I thought about using ISO values for the
> existing 3D geometry types when implementing curve support in 2.0 but finally
> decided it wasn't worth the breakage.
>
>> What I right now have is a working WKT and WKB API for point geometries.
>> Next I plan to test constructing and modifying geometries with
>> get/set/add methods and then move to building the support into shape
>> driver, while also adding more geometries to the WKT, WKB tests.
>>
>> Best,
>>
>> Ari
>>
>> 28.01.2016, 16:09, Ari Jolma kirjoitti:
>>> Folks, especially the PSC,
>>>
>>> I'd like to call for discussion about RFC 61: Adding support for
>>> measures in geometries.
>>>
>>> Measures (M) are a sort of fourth coordinate for points in geometries.
>>> A typical use of measures is for distance from origin in line strings
>>> that represent roads but they can be used for other things as well.
>>>
>>> Measures are a part of the simple features model and they are
>>> supported by many vector data formats.
>>>
>>> Since measures are a rather fundamental element, adding them will
>>> require quite many changes into the basic building blocks of the GDAL
>>> API. Most importantly, the 'int nCoordDimension' property of
>>> OGRGeometry is proposed to be replaced by 'int flags', which will have
>>> bit flags denoting whether the geometry is empty and has Z or M
>>> coordinates.
>>>
>>> No backwards incompatible changes (syntactic nor semantic) will be
>>> done but the methods getCoordinateDimension and setCoordinateDimension
>>> will be deprecated since they do not take into account M coordinate.
>>>
>>> The RFC is as usual in the wiki:
>>>
>>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>>
>>> There are a couple of decisions to be made (if the overall decision is
>>> positive).
>>>
>>> Should the set3D(b3D) method (and also for example AddGeometry method)
>>> of GeometryCollection force all child geometries to be 3D (or 2D and
>>> remove possible Z values)? Maybe just unsetting the flag when
>>> downgrading is enough?
>>>
>>> Should storing data, with measures, into a format, which does not
>>> support measures, remove M values from the data? This would be similar
>>> to the current behavior with curved geometries and formats which do
>>> not support them.
>>>
>>> Some smaller issues are mentioned/hinted to in the draft RFC.
>>>
>>> I have set up a github repository for the work at
>>>
>>> https://github.com/ajolma/GDAL-XYZM
>>>
>>> It has an associated travis builder - which however seems to have some
>>> problems right now. I have committed the API changes from the draft
>>> RFC and it compiles but there is a lot to do with actually
>>> implementing the support.
>>>
>>> Best regards,
>>>
>>> Ari
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Wed Feb  3 06:11:30 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Feb 2016 15:11:30 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56B2024E.6040102@gmail.com>
References: <56AA2102.9030102@gmail.com>
 <201602011617.46069.even.rouault@spatialys.com> <56B2024E.6040102@gmail.com>
Message-ID: <201602031511.30484.even.rouault@spatialys.com>

Le mercredi 03 février 2016 14:36:14, Ari Jolma a écrit :
> I finally have the (existing) autotests passing with the new API -
> basically just replacing the nCoordDimension property of OGRGeometry
> with flags (for Z and M) - and a rather large set of tests for
> import/export WKT and WKB with M passing.

That's great !

> 
> https://travis-ci.org/ajolma/GDAL-XYZM/builds/106725974
> 
> Maybe we should move to a vote on the RFC?

Sounds good.

A few notes:

- in the implementation, OGR_G_NOT_EMPTY has become OGR_G_NOT_EMPTY_POINT
So the mention os "IsEmpty = !(flags & OGR_G_NOT_EMPTY)" is probably no longer 
relevant

- The signature of the following methods
	int getFlags() const;
 	int setFlags( int newFlags ) const;
  is :
	virtual int getFlags() const;
 	virtual int setFlags( int newFlags );  <<< no const

- "It needs to be decided but when any of these flags is set, the corresponding 
data becomes invalid and may be discarded." : what did you implement ?

- Regarding "There is some discrepancy in documentation. Their documentation 
says that they may return zero for empty points while in ogrpoint.cpp it says 
that negative nCoordDimension values are used for empty points and the 
getCoordinateDimension method of point returns absolute value of 
nCoordDimension - thus not zero. ". 
From what I can see from history, I'm the likely culprit to have change that 
in GDAL 2.0. I think this is a side effect of the nCoordDimension trick to have 
-3 to be able to have "POINT Z EMPTY". But your approach with OGR_G_NOT_EMPTY 
can probably now solve the issue while having getCoordinateDimension() to 
return 0, but probably not worth changing that back now. By the way, I've just 
have a look at Simple Feature Access 1.2.1 and it does not specify what the 
method should do. I've checked with PostGIS 
http://postgis.net/docs/ST_CoordDim.html and it returns 3 for POINT Z EMPTY. 
So we perhaps just need to fix the doc to remove the mention of 0 being 
returned for point empty.

- "Change the semantics of OGRReadWKBGeometryType: b3D is not used and the 
returned eGeometryType may may any valid type" : why not just dropping the b3D 
parameter ? This is an internal function (ogr_p.h is not intended to be used 
other than in core and drivers)

- Regarding "Compatibility Issues", do you intend doing similarly to curve 
support in the I* methods if MeasuredGeometries is not advertized ?

- We would also probably need a section in MIGRATION_GUIDE.TXT to mention that 
new geometry types can be returned, that shape XYM-as-XYZ hack will be 
replaced by proper XYM

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bo.victor.thomsen at gmail.com  Wed Feb  3 06:32:56 2016
From: bo.victor.thomsen at gmail.com (Bo Victor Thomsen)
Date: Wed, 3 Feb 2016 15:32:56 +0100
Subject: [gdal-dev] ogr2ogr sqlserver identity field generation.
Message-ID: <CAAJbAXuy4W5uTJ2pVhmTCccRcH2-SXoiDFip6_aGykeXuLxwWg@mail.gmail.com>

Is it possible for ogr2ogr to generate a "normal" integer field  instead of
a "identity" field for the primary key field when creating a new table in
MS sqlserver ?
(I can't find it in the documentation)

Kind regards

Bo Victor Thomsen
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160203/5a61b76c/attachment.html>

From ari.jolma at gmail.com  Wed Feb  3 06:51:44 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 3 Feb 2016 16:51:44 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201602031511.30484.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com>
 <201602011617.46069.even.rouault@spatialys.com> <56B2024E.6040102@gmail.com>
 <201602031511.30484.even.rouault@spatialys.com>
Message-ID: <56B21400.5000508@gmail.com>

03.02.2016, 16:11, Even Rouault kirjoitti:
> Le mercredi 03 février 2016 14:36:14, Ari Jolma a écrit :
>> I finally have the (existing) autotests passing with the new API -
>> basically just replacing the nCoordDimension property of OGRGeometry
>> with flags (for Z and M) - and a rather large set of tests for
>> import/export WKT and WKB with M passing.
> That's great !
>
>> https://travis-ci.org/ajolma/GDAL-XYZM/builds/106725974
>>
>> Maybe we should move to a vote on the RFC?
> Sounds good.
>
> A few notes:
>
> - in the implementation, OGR_G_NOT_EMPTY has become OGR_G_NOT_EMPTY_POINT
> So the mention os "IsEmpty = !(flags & OGR_G_NOT_EMPTY)" is probably no longer
> relevant
>
> - The signature of the following methods
> 	int getFlags() const;
>   	int setFlags( int newFlags ) const;
>    is :
> 	virtual int getFlags() const;
>   	virtual int setFlags( int newFlags );  <<< no const

changed into the draft

>
> - "It needs to be decided but when any of these flags is set, the corresponding
> data becomes invalid and may be discarded." : what did you implement ?

the data is lost; changed into the draft

>
> - Regarding "There is some discrepancy in documentation. Their documentation
> says that they may return zero for empty points while in ogrpoint.cpp it says
> that negative nCoordDimension values are used for empty points and the
> getCoordinateDimension method of point returns absolute value of
> nCoordDimension - thus not zero. ".
>  From what I can see from history, I'm the likely culprit to have change that
> in GDAL 2.0. I think this is a side effect of the nCoordDimension trick to have
> -3 to be able to have "POINT Z EMPTY". But your approach with OGR_G_NOT_EMPTY
> can probably now solve the issue while having getCoordinateDimension() to
> return 0, but probably not worth changing that back now. By the way, I've just
> have a look at Simple Feature Access 1.2.1 and it does not specify what the
> method should do. I've checked with PostGIS
> http://postgis.net/docs/ST_CoordDim.html and it returns 3 for POINT Z EMPTY.
> So we perhaps just need to fix the doc to remove the mention of 0 being
> returned for point empty.

added "fix the doc" to the draft

>
> - "Change the semantics of OGRReadWKBGeometryType: b3D is not used and the
> returned eGeometryType may may any valid type" : why not just dropping the b3D
> parameter ? This is an internal function (ogr_p.h is not intended to be used
> other than in core and drivers)

Hm. It is installed. Then by definition it is not internal. If it is 
changed, doesn't it make the shared object binary incompatible? (I see 
it doesn't have CPL_DLL) I don't think there is a ogr_internal.h, maybe 
there should be and move this function there?

>
> - Regarding "Compatibility Issues", do you intend doing similarly to curve
> support in the I* methods if MeasuredGeometries is not advertized ?

I don't have a very strong opinion, so I'm ok to follow the pattern used 
for curves.

> - We would also probably need a section in MIGRATION_GUIDE.TXT to mention that
> new geometry types can be returned, that shape XYM-as-XYZ hack will be
> replaced by proper XYM
Yes.

Ari


>
> Even
>


From even.rouault at spatialys.com  Wed Feb  3 06:55:49 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Feb 2016 15:55:49 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56B21400.5000508@gmail.com>
References: <56AA2102.9030102@gmail.com>
 <201602031511.30484.even.rouault@spatialys.com> <56B21400.5000508@gmail.com>
Message-ID: <201602031555.49242.even.rouault@spatialys.com>

> Hm. It is installed. Then by definition it is not internal. If it is
> changed, doesn't it make the shared object binary incompatible?

As in almost every non bug-fix release, the ABI will be broken anyway. In 
particular because of the changes in OGRGeometry class (and probably other 
changes)

> (I see
> it doesn't have CPL_DLL) I don't think there is a ogr_internal.h, maybe
> there should be and move this function there?

From the header 
""" * Purpose:  Some private helper functions and stuff for OGR 
implementation."""

(and the _p suffix meaning protected/private)

And as you noticed this symbol is not exported, so it can only be used by in-
tree code.

The header might be installed for some external plugins that could use CPL_DLL 
symbols I guess.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Wed Feb  3 07:16:17 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 3 Feb 2016 17:16:17 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201602031555.49242.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com>
 <201602031511.30484.even.rouault@spatialys.com> <56B21400.5000508@gmail.com>
 <201602031555.49242.even.rouault@spatialys.com>
Message-ID: <56B219C1.5060605@gmail.com>


>> (I see
>> it doesn't have CPL_DLL) I don't think there is a ogr_internal.h, maybe
>> there should be and move this function there?
>  From the header
> """ * Purpose:  Some private helper functions and stuff for OGR
> implementation."""
>
> (and the _p suffix meaning protected/private)
>
> And as you noticed this symbol is not exported, so it can only be used by in-
> tree code.

Perfectly usable in Linux :)

>
> The header might be installed for some external plugins that could use CPL_DLL
> symbols I guess.
>

That's an unknown area for me, except building Perl bindings outside of 
GDAL source tree. The wrappers seem to require ogr_p.h. I haven't 
checked how seriously.

Ari


From even.rouault at spatialys.com  Wed Feb  3 07:23:37 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Feb 2016 16:23:37 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56B219C1.5060605@gmail.com>
References: <56AA2102.9030102@gmail.com>
 <201602031555.49242.even.rouault@spatialys.com> <56B219C1.5060605@gmail.com>
Message-ID: <201602031623.37900.even.rouault@spatialys.com>

Le mercredi 03 février 2016 16:16:17, Ari Jolma a écrit :
> >> (I see
> >> it doesn't have CPL_DLL) I don't think there is a ogr_internal.h, maybe
> >> there should be and move this function there?
> >> 
> >  From the header
> > 
> > """ * Purpose:  Some private helper functions and stuff for OGR
> > implementation."""
> > 
> > (and the _p suffix meaning protected/private)
> > 
> > And as you noticed this symbol is not exported, so it can only be used by
> > in- tree code.
> 
> Perfectly usable in Linux :)

Not if you ./configure --with-hide-internal-symbols  (which some distro such as 
UbuntuGIS use)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sfkeller at gmail.com  Wed Feb  3 09:52:37 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 3 Feb 2016 18:52:37 +0100
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn299HJpb7rmsAeGB49C6F8uNk1MRxzRQLaqOgKxfiysy+g@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
 <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
 <CAFcOn2-JUx5+4xMuLSmTMd_-AGvgmooW=eymbEfkc0msrFULHw@mail.gmail.com>
 <CAPxHBh-U5TJeOHrqbgqe_Ck1wQd24PdMdt0mMBv1ee0HS-POsw@mail.gmail.com>
 <CAFcOn299HJpb7rmsAeGB49C6F8uNk1MRxzRQLaqOgKxfiysy+g@mail.gmail.com>
Message-ID: <CAFcOn28dPEsQ1gLDyC1AtwpcHzeXcWcqBm=xkhVfffPBLoJNbg@mail.gmail.com>

Blake,

Sorry for iterating: I checked the spec. and analyzed a sample of
Mapbox vector tiles:
The spec. does not mention null tiles but there are tiles generated by
Mapbox which are empty/null (to save space).
I seems to me that Mapbox GL JS then backs up and takes the data from
a tile at a predefined "upper" zoom level.
Can elaborate on this?

:Stefan


2016-02-02 7:46 GMT+01:00 Stefan Keller <sfkeller at gmail.com>:
> Blake,
>
> Thanks for the comments.
> Regarding leaving out data at intermediate zoom levels I also meant
> omitting (setting to null) the entire tile.
> In fact I just realize that the spec. even does not mention how a
> reader knows at which level it should expect data if a tile is
> null/empty.
>
> :Stefan
>
>
> 2016-02-02 2:18 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
>> Stefan,
>>
>> Consistent recognition of specific features can be done by proper use of the
>> id field in features:
>>
>> https://github.com/mapbox/vector-tile-spec/tree/master/2.1#42-features
>>
>> You can definitely leave out data at intermediate zooms if you wished, we
>> have considered this on many occasions at Mapbox. As far as the
>> specification is concerned currently, the vector tile itself purposefully
>> does not contain all the metadata necessary for this specific task. This is
>> mentioned directly in the specification that each tile does not contain
>> information about its projection or bounds. The Vector Tile Specification is
>> purposeful in this because it leaves others specifications or an
>> implementation to explicitly provide all the necessary information.
>>
>> I have considered that we could define a metafile to define all this
>> information explicitly, but for now as far as I am concerned the
>> specification just for the tiles is very young! We could make a decision on
>> this sort of implementation, but it could very well be better placed inside
>> another standard. I will not shy away from the fact that the specification
>> very well might change as time goes on and perhaps adding more things that
>> will more narrowly define it such things as projection and bounds. The needs
>> of those using the format will definitely provide influence on how it
>> changes.
>>
>> There currently is no indexing or listing of features within a layer, other
>> then the layer classes themselves. We could provide such a feature perhaps,
>> but currently it would likely just take more memory with out much benefit.
>> It is very quick for our decoder to iterate over features, and in general
>> processing of vector tile data is expected to be done in memory.
>>
>> Most client are only concerned about the vector tiles that are currently
>> within a "view". Therefore, if a feature is missing within a view it is
>> considered not to have that feature. However, this doesn't limit people from
>> doing analysis across a large number of tiles. At Mapbox we have used
>> map-reduce type solutions to process large number of tiles for different
>> projects:
>>
>> https://github.com/mapbox/tile-reduce
>>
>> The idea is that vector tiles themselves should be relatively small in size
>> in most situations. If you data becomes too dense you could put the data at
>> a higher zoom or provide an abstraction of features. The format itself is a
>> "lossy" format as you are putting your data in a projection that is unique
>> to the tile, so the format is not designed for situations where accuracy is
>> extremely important. If you need more accuracy you can increase the "extent"
>> of a layer, which adds more precision, but this could also increase the size
>> of your tiles.
>>
>> As far as the concerns with making a solid GDAL driver from vector tiles, I
>> am not certain what the solution should be honestly. I want to be here as a
>> reference to help something be grown, but I can't point at a great
>> implementation like this because we have not put into mapnik even yet "a
>> datasource of many vector tiles" as a plugin. We have left such operations
>> up to a large number of open source javascript libraries that can provide
>> things like caching etc. (See tilelive https://github.com/mapbox/tilelive/ )
>>
>> In a limited sense to think of Vector Tiles for Mapbox Tools in the same
>> sense you would think about WKB for PostGIS. It is not the entire solution
>> alone.
>>
>> Thanks,
>>
>> Blake Thompson
>>
>> On Mon, Feb 1, 2016 at 5:45 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>
>>> Blake,
>>>
>>> Now the vector tiles spec. and the Mapbox approach became clearer to me.
>>>
>>> I'm still pondering about realizing a vector tiles reader (especially
>>> for QGIS) and for vector tiles uses cases like 1. base maps and 2.
>>> spatial analysis:
>>>
>>> Regarding clipped linestrings and polygons arriving at reader, there
>>> seems to exist no hint (clipped) nor id mentioned in the spec. to help
>>> the reader merging them?
>>>
>>> While there's overzoom, what's about leaving out data in intermediate
>>> zoom levels to save space? Does the spec. regulate that and who's
>>> responsible for handling this: server or client?
>>>
>>> Finally and back to my implementation concerns: How should an
>>> interactive client deal occurring/disappearing feature classes in a
>>> single "layer"? Is it forced to read all features on all zoom levels
>>> in order to announce all feature classes?
>>>
>>> :Stefan
>>>
>>>
>>> 2016-02-02 1:03 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
>>> > Benjamin Stadin,
>>> >
>>> > As an author of the specification, I have to disagree with you on the
>>> > support for other projections. There is no limitation on vector tiles
>>> > being
>>> > required to being in mercator. The specification in fact mentions that
>>> > other
>>> > projections may be used:
>>> >
>>> >
>>> > https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds
>>> >
>>> > While it is not accessible via the node-mapnik bindings, we do in fact
>>> > support encoding as different projections in mapnik-vector-tile. We have
>>> > implemented the decoder so that it could accept other projections, but
>>> > have
>>> > not added a mapnik datasource that would support them, but if there is
>>> > demand for such a thing we could do it.
>>> >
>>> > Your comments about the entire stack of Mapbox supporting mostly
>>> > mercator
>>> > could be very accurate, but this is not at all related to the Vector
>>> > Tile
>>> > Specification. We purposefully attempt to make our tools as
>>> > projection-less
>>> > as possible and hope that others find awesome ways to build upon the
>>> > standard.
>>> >
>>> > "But what data is shown at which zoom level is defined by the styling"
>>> > --
>>> > This is not true because you could make your data not even provide data
>>> > at
>>> > certain zoom levels. At Mapbox we do this quite often, street data is
>>> > never
>>> > included at very low zoom levels. Therefore, the style isn't the only
>>> > control here. In fact, I would encourage you to view styling and
>>> > rendering
>>> > of vector tiles as an entirely different topic.
>>> >
>>> > "There is enough interest from our side that we¹d be interested in
>>> > contributing (maybe monetary or with code, or both) to define and
>>> > implement
>>> > a better general purpose tile format." -- Any issues you might have with
>>> > the
>>> > Mapbox Vector Tile Specification or any ideas you might have with the
>>> > format
>>> > are very much welcome. We want to make sure the spec migrates for
>>> > community
>>> > needs. Please see
>>> > https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md
>>> > for
>>> > how you might help!
>>> >
>>> > Finally, I would like to stress that while Mapbox Vector Tiles were
>>> > designed
>>> > to be for rendering, it was well known during their design that they
>>> > could
>>> > be used for other applications. This was especially true when I was
>>> > writing
>>> > 2.0 of the specification as I tried to limit what would be considered
>>> > even
>>> > the most common uses of vector tiles.
>>> >
>>> > Thanks,
>>> >
>>> > Blake Thompson
>>> >
>>> > On Mon, Feb 1, 2016 at 4:27 PM, Stefan Keller <sfkeller at gmail.com>
>>> > wrote:
>>> >>
>>> >> Hi Ben
>>> >>
>>> >> Thanks for explaining - Petr and I are the maintainers of
>>> >> OSM2Vectortiles.
>>> >> I like projections (and also GeoPackage :-) ).
>>> >> But reprojection is solved here, since OGR/QGIS can transform on the
>>> >> fly.
>>> >> This thread is about Petr's question about a reader "for mapbox-like
>>> >> vector tiles stored in MBTiles or downloaded from a url...".
>>> >>
>>> >> So I'd like to come back to the issue:
>>> >> 1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
>>> >> 2. and of a "feature provider" in an interactive environment (like
>>> >> QGIS) or a file/stream converter (like OGR) => anybody?
>>> >>
>>> >> :Stefan
>>> >>
>>> >>
>>> >>
>>> >> 2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
>>> >> <Benjamin.Stadin at heidelberg-mobil.com>:
>>> >> > Hi Stefan,
>>> >> >
>>> >> > A vector tile may contain data for several zoom levels. But what data
>>> >> > is
>>> >> > shown at which zoom level is defined by the styling, not by the data
>>> >> > itself. It is handled on client side, by the web (or native) tile
>>> >> > renderer.
>>> >> >
>>> >> > The path is the same as with mercator tiles (zoomLevel/x/y):
>>> >> > https://example.com/17/65535/43602.mvt
>>> >> >
>>> >> >
>>> >> > The tile for zoom level 17 may contain features of class „building“,
>>> >> > and
>>> >> > the style definition may contain a rule that filters type „building“
>>> >> > for
>>> >> > zoomLevels <= 18.
>>> >> >
>>> >> > ~Ben
>>> >> >
>>> >> > Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller"
>>> >> > unter
>>> >> > <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>>> >> >
>>> >> >>That's good news!
>>> >> >>We'll be happy to add Python bindings to such a generic C++ library
>>> >> >>for Mapbox vector tiles.
>>> >> >>We have still some time (say few weeks?) left here to decide to
>>> >> >>contribute either to these bindings or to Mapzen's pure Python lib.
>>> >> >>
>>> >> >>One reason why I'm insisting on Python (bindings) - besides easier
>>> >> >>testing with QGIS - is the following:
>>> >> >>AFAIK with vector tiles we have to deal with quite a new kind of
>>> >> >>feature provider:
>>> >> >>One which contains "zoom levels" and one which "suddenly" changes
>>> >> >>feature class at different zoom levels.
>>> >> >>If a client like QGIS consumes vector tiles from OGR in a one-shot
>>> >> >>call, how should the client deal with such "zoom level" dependent
>>> >> >>issues?
>>> >> >>So my thinking is, to consume only the most appropriate zoom level,
>>> >> >>probably only within current map canvas...
>>> >> >>
>>> >> >>:Stefan
>>> >> >>
>>> >> >>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> >> >>>
>>> >> >>> Stefan,
>>> >> >>>
>>> >> >>> I am not aware of any libraries besides mapnik vector tile that
>>> >> >>> have
>>> >> >>>been attempting to implement v2 specification. I think mapzen's
>>> >> >>>implementation might be best? We have been wanting to add vector
>>> >> >>> tiles
>>> >> >>>to the python mapnik bindings for quite some time but we don't have
>>> >> >>> the
>>> >> >>>time to do it right now.
>>> >> >>>
>>> >> >>> I will try to think this week about how we could make a generic C++
>>> >> >>>library quickly for Mapbox vector tiles.
>>> >> >>>
>>> >> >>> Thanks,
>>> >> >>>
>>> >> >>> Blake Thompson
>>> >> >>>
>>> >> >>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com>
>>> >> >>>> wrote:
>>> >> >>>>
>>> >> >>>> Hi Blake
>>> >> >>>>
>>> >> >>>> It's clear to me that a good generic c++ library for encoding and
>>> >> >>>> decoding vector tiles is needed.
>>> >> >>>> On the other hand, I'd like to experiment with vector tiles and
>>> >> >>>> related QGIS parallel loading issues for which Python is more
>>> >> >>>> convenient.
>>> >> >>>>
>>> >> >>>> It seems that Mapzen's [1] Python implementation is further along.
>>> >> >>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>> >> >>>>variant [2] ?
>>> >> >>>>
>>> >> >>>> :Stefan
>>> >> >>>>
>>> >> >>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>> >> >>>> [2] https://github.com/mapbox/vector-tile-py
>>> >> >>>>
>>> >> >>>>
>>> >> >>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> >> >>>>> All,
>>> >> >>>>>
>>> >> >>>>> The first thing that is going to be required likely is a good
>>> >> >>>>> generic
>>> >> >>>>>c++ library for encoding and decoding vector tiles IMO.
>>> >> >>>>>
>>> >> >>>>> I have spent a lot of time working on developing the mapnik
>>> >> >>>>> vector
>>> >> >>>>>tile library to be a solid implementation, especially around all
>>> >> >>>>> the
>>> >> >>>>>work done for 2.0 of Mapbox vector tile specification. I would
>>> >> >>>>> love
>>> >> >>>>> to
>>> >> >>>>>eventually help make this a generalized implementation so that it
>>> >> >>>>> is
>>> >> >>>>>portable to a library like GDAL.
>>> >> >>>>>
>>> >> >>>>> We have talked about doing something like this at Mapbox but will
>>> >> >>>>>require a good deal of time, so it hasn't been pushed forward yet.
>>> >> >>>>> The
>>> >> >>>>>other issues that come to mind to me is that some of the libraries
>>> >> >>>>>that mapnik vector tile depends upon most likely need good custom
>>> >> >>>>>implementations if we wanted to make it more generic.
>>> >> >>>>>
>>> >> >>>>> The reason for this is that I would prefer for it to be a header
>>> >> >>>>> only
>>> >> >>>>>library with no dependencies. Adding more dependencies for GDAL
>>> >> >>>>> seems
>>> >> >>>>>like it could be a mess.
>>> >> >>>>>
>>> >> >>>>> Blake Thompson
>>> >> >>>>>
>>> >> >>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>> >> >>>>>>wrote:
>>> >> >>>>>>
>>> >> >>>>>> Hi Petr, Blake, Even and everybody
>>> >> >>>>>>
>>> >> >>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>> >> >>>>>> I'd already asked Even a similar question.
>>> >> >>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>> >> >>>>>>reader
>>> >> >>>>>> client in Python if possible as part of a QGIS plugin.
>>> >> >>>>>> And I'm interested not to do redundant implementations.
>>> >> >>>>>> Are there any news on this matter?
>>> >> >>>>>>
>>> >> >>>>>> :Stefan
>>> >> >>>>>> Prof. at HSR and leader of Geometa Lab
>>> >> >>>>>>
>>> >> >>>>>> @Even: Regarding OGR MVT development can you send to me
>>> >> >>>>>> (directly)
>>> >> >>>>>> a
>>> >> >>>>>> contact name of the group which won the bidding?
>>> >> >>>>>>
>>> >> >>>>>>
>>> >> >>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal
>>> >> >>>>>> <petr.pridal at klokantech.com>:
>>> >> >>>>>>> Hi everybody,
>>> >> >>>>>>>
>>> >> >>>>>>> thanks for the comments. Regarding the technical details:
>>> >> >>>>>>>
>>> >> >>>>>>>> Each Tile is its own discrete dataset therefore the hardest
>>> >> >>>>>>>> part
>>> >> >>>>>>>>would be
>>> >> >>>>>>>> merging of features into the original features across tiles.
>>> >> >>>>>>>> You
>>> >> >>>>>>>>could use
>>> >> >>>>>>>> some complicated merging technique, but that could be very
>>> >> >>>>>>>>expensive.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> The driver could require "id" parameter, which specifies name
>>> >> >>>>>>> of
>>> >> >>>>>>> an
>>> >> >>>>>>> attribute with unique identifier on the features shared across
>>> >> >>>>>>> the
>>> >> >>>>>>>tiles.
>>> >> >>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an
>>> >> >>>>>>> unique
>>> >> >>>>>>>non-zero
>>> >> >>>>>>> "osm_id" in place. The first version of driver could read only
>>> >> >>>>>>>features with
>>> >> >>>>>>> such ID. The identifier does not have to be always filled, but
>>> >> >>>>>>>often it is,
>>> >> >>>>>>> especially in deeper zoom levels derived purely from
>>> >> >>>>>>> OpenStreetMap
>>> >> >>>>>>>- but
>>> >> >>>>>>> yeh, a completely general stitching would be much harder.
>>> >> >>>>>>>
>>> >> >>>>>>> The clipping + merging of shapes itself can be implemented with
>>> >> >>>>>>>underlaying
>>> >> >>>>>>> GEOS library functions.
>>> >> >>>>>>>
>>> >> >>>>>>> BTW It is possible to examine vector tiles data in pure
>>> >> >>>>>>> JavaScript
>>> >> >>>>>>>X-Ray
>>> >> >>>>>>> viewer (no WebGL support on browser required) made in
>>> >> >>>>>>> OpenLayers3:
>>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>> >> >>>>>>>
>>> >> >>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox
>>> >> >>>>>>> GL
>>> >> >>>>>>>JS
>>> >> >>>>>>> powered X-Ray:
>>> >> >>>>>>>
>>> >> >>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>> >> >>>>>>>
>>> >> >>>>>>> A debug viewer for each vector tile (made in OL3) decoded in
>>> >> >>>>>>> pure
>>> >> >>>>>>> JavaScript:
>>> >> >>>>>>>
>>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>> >> >>>>>>>
>>> >> >>>>>>> The OGR driver could be also practical for the unsimplified /
>>> >> >>>>>>>ungeneralised
>>> >> >>>>>>> MBTiles with OSM data available at:
>>> >> >>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>> >> >>>>>>>
>>> >> >>>>>>>>
>>> >> >>>>>>>> If you wanted to simply view vector tile data it could get
>>> >> >>>>>>>>confusing as
>>> >> >>>>>>>> well since most vector tiles need a buffer when they are used
>>> >> >>>>>>>> for
>>> >> >>>>>>>> visualization programs. This is important for things like
>>> >> >>>>>>>> labeling
>>> >> >>>>>>>>on maps
>>> >> >>>>>>>> etc. Therefore, you could get a large amount of overlapping
>>> >> >>>>>>>> data
>>> >> >>>>>>>>on tiles if
>>> >> >>>>>>>> you loaded them all in at once.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Clipping on border of each tile must be applied before
>>> >> >>>>>>> stitching
>>> >> >>>>>>>the vector
>>> >> >>>>>>> features together  - so the buffer is removed. Buffer is there
>>> >> >>>>>>> only
>>> >> >>>>>>>for
>>> >> >>>>>>> visualisation and labeling.
>>> >> >>>>>>>
>>> >> >>>>>>>>
>>> >> >>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>> >> >>>>>>>>decoder isn't
>>> >> >>>>>>>> currently able to decode vector tiles into a form not
>>> >> >>>>>>>> supported
>>> >> >>>>>>>> by
>>> >> >>>>>>>>mapnik.
>>> >> >>>>>>>> Therefore, OGR would not be able to easily use this.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Correct. It can't be used directly (GDAL can't link against),
>>> >> >>>>>>> but
>>> >> >>>>>>>the
>>> >> >>>>>>> relevant code can be extracted and reused directly. For basic
>>> >> >>>>>>>decoding
>>> >> >>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>> >> >>>>>>>
>>> >>
>>> >> >>>>>>>
>>> >> >>>>>>> >>>>>>> >>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>>> >> >>>>>>>_tile.proto
>>> >> >>>>>>> + the code for converting pixel coordinates in features to
>>> >> >>>>>>> relevant
>>> >> >>>>>>>geo
>>> >> >>>>>>> coordinates and GEOS-based merging of features.
>>> >> >>>>>>>
>>> >> >>>>>>>> We plan to write a generalized encoder and decoder eventually
>>> >> >>>>>>>> so
>>> >> >>>>>>>>that any
>>> >> >>>>>>>> other library can plugin with out the mapnik requirement.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> This would be amazing.
>>> >> >>>>>>>
>>> >> >>>>>>>> If you have any questions specifically about Mapnik Vector
>>> >> >>>>>>>> Tile
>>> >> >>>>>>>> or
>>> >> >>>>>>>>the
>>> >> >>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would
>>> >> >>>>>>>> note
>>> >> >>>>>>>>that you
>>> >> >>>>>>>> guys will want to update your vector tiles once the V2
>>> >> >>>>>>>>specification changes
>>> >> >>>>>>>> are into Mapnik-Vector-Tile.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Cool! Thanks. Our world tiles are generated via Docker
>>> >> >>>>>>> containers
>>> >> >>>>>>>on a
>>> >> >>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>> >> >>>>>>>upgrades on
>>> >> >>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>> >> >>>>>>>software.
>>> >> >>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>> >> >>>>>>>
>>> >> >>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice
>>> >> >>>>>>>> ? I
>>> >> >>>>>>>>don't
>>> >> >>>>>>>> see
>>> >> >>>>>>>> mention of that neither in the MVT spec (
>>> >> >>>>>>>> https://github.com/mapbox/vector-
>>> >> >>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>> >> >>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md
>>> >> >>>>>>>> ),
>>> >> >>>>>>>>although
>>> >> >>>>>>>> I
>>> >> >>>>>>>> guess it is just a matter of storing a MVT blob in the
>>> >> >>>>>>>> tile_data
>>> >> >>>>>>>>column.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector
>>> >> >>>>>>> Tiles
>>> >> >>>>>>>inside -
>>> >> >>>>>>> and Mapnik reads them directly when rasterising. Storing the
>>> >> >>>>>>> vector
>>> >> >>>>>>>tiles in
>>> >> >>>>>>> SQLite make sense - and it simplifies deployment, and you can
>>> >> >>>>>>> then
>>> >> >>>>>>>easily
>>> >> >>>>>>> have complete world on each node of a cluster of tileservers.
>>> >> >>>>>>> If
>>> >> >>>>>>>you don't
>>> >> >>>>>>> want to upgrade your base map too often, this approach is
>>> >> >>>>>>> pretty
>>> >> >>>>>>>efficient
>>> >> >>>>>>> and removes the centralised database as typical bottleneck.
>>> >> >>>>>>>
>>> >> >>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>> >> >>>>>>>documented these
>>> >> >>>>>>> in README.md at and
>>> >> >>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>> >> >>>>>>> we started to work on OSM2VectorTiles project.
>>> >> >>>>>>> There are also sample data and offline MapBox GL JS viewer in
>>> >> >>>>>>> that
>>> >> >>>>>>>repo.
>>> >> >>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>> >> >>>>>>>folders on a
>>> >> >>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com
>>> >> >>>>>>> does
>>> >> >>>>>>>by
>>> >> >>>>>>> default for raster tiles.
>>> >> >>>>>>>
>>> >> >>>>>>> If OGR driver is implemented, the primary source should be
>>> >> >>>>>>> probably
>>> >> >>>>>>>reading
>>> >> >>>>>>> from an URL via curl.
>>> >> >>>>>>>
>>> >> >>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the
>>> >> >>>>>>> most
>>> >> >>>>>>>practical
>>> >> >>>>>>> portable alternative to it.
>>> >> >>>>>>>
>>> >> >>>>>>> Technically people may store the tiles in different ways - for
>>> >> >>>>>>>example
>>> >> >>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>> >> >>>>>>> https://github.com/kartotherian/) use Cassandra for tile
>>> >> >>>>>>> storage,
>>> >> >>>>>>> I
>>> >> >>>>>>>guess
>>> >> >>>>>>> MapBox internally is also on a different storage for production
>>> >> >>>>>>>servers ...
>>> >> >>>>>>> for transfers and streaming tilesets there is the  - but tiles
>>> >> >>>>>>> are
>>> >> >>>>>>>ALWAYS
>>> >> >>>>>>> exposed via HTTP.
>>> >> >>>>>>>
>>> >> >>>>>>> Regards,
>>> >> >>>>>>>
>>> >> >>>>>>> Petr
>>> >> >>>>>>> --
>>> >> >>>>>>> Petr Pridal, Ph.D.
>>> >> >>>>>>> CEO
>>> >> >>>>>>>
>>> >> >>>>>>> Klokan Technologies GmbH
>>> >> >>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>> >> >>>>>>> Tel: +41 (0)41 511 26 12
>>> >> >>>>>>> Email: info at klokantech.com
>>> >> >>>>>>> Web: http://www.klokantech.com/
>>> >> >>>>>>>
>>> >> >>>>>>> _______________________________________________
>>> >> >>>>>>> gdal-dev mailing list
>>> >> >>>>>>> gdal-dev at lists.osgeo.org
>>> >> >>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >> >>_______________________________________________
>>> >> >>gdal-dev mailing list
>>> >> >>gdal-dev at lists.osgeo.org
>>> >> >>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >> >
>>> >
>>> >
>>
>>

From Benjamin.Stadin at heidelberg-mobil.com  Wed Feb  3 10:12:44 2016
From: Benjamin.Stadin at heidelberg-mobil.com (Stadin, Benjamin)
Date: Wed, 3 Feb 2016 18:12:44 +0000
Subject: [gdal-dev] Vector Tiles in OGR
In-Reply-To: <CAFcOn28dPEsQ1gLDyC1AtwpcHzeXcWcqBm=xkhVfffPBLoJNbg@mail.gmail.com>
References: <CAH-RUCSWA55kmEW6=tH0=xb7qUFm9R4oJ6iBSxdeSrnetyRM0g@mail.gmail.com>
 <CAPxHBh_-i1i8_85J517SWUo8N1GB9557Om4CvRwi4iMxTXswOQ@mail.gmail.com>
 <CAH-RUCQwki_Di08JCy2C8E8RkR3X3AdLjRQXo-312EWOVobL3g@mail.gmail.com>
 <CAFcOn2-rF8_=wC6Y5dpmmbLHccN2SG6Qqj_GNsEuzbKF+1ocpA@mail.gmail.com>
 <661A1F30-F0B6-4514-92A1-B9782D109958@gmail.com>
 <CAFcOn28Zbxx+xOYgK3i9v9rAWnHO-Ky0aekWOg6TNusb9J7ReA@mail.gmail.com>
 <016D88B5-3EF5-4B4D-A864-2071DAD92ECA@gmail.com>
 <CAFcOn2-5Gw-Pu-4jRq_dyS++Aq5aHdBD5uLjap6EXA3K1KMuAQ@mail.gmail.com>
 <D2D5A00C.321C5%benjamin.stadin@heidelberg-mobil.com>
 <CAFcOn2-=ewYd6d6JC7FdQiqnu+GgwXeMOJtEv9xt40-EwhiGVQ@mail.gmail.com>
 <CAPxHBh-B+TLyXC9jkAHujBqfzUDA9-_MReBY8CcpyxS-aVK7Ug@mail.gmail.com>
 <CAFcOn2-JUx5+4xMuLSmTMd_-AGvgmooW=eymbEfkc0msrFULHw@mail.gmail.com>
 <CAPxHBh-U5TJeOHrqbgqe_Ck1wQd24PdMdt0mMBv1ee0HS-POsw@mail.gmail.com>
 <CAFcOn299HJpb7rmsAeGB49C6F8uNk1MRxzRQLaqOgKxfiysy+g@mail.gmail.com>,
 <CAFcOn28dPEsQ1gLDyC1AtwpcHzeXcWcqBm=xkhVfffPBLoJNbg@mail.gmail.com>
Message-ID: <1454523163845.75380@heidelberg-mobil.com>

Stefan,

the behavor is as you said. Kartotherian (quite new Wikipedia map stack which aims to also support Mapbox Vector tiles) implements this.

https://github.com/kartotherian/kartotherian

In particular, the getTile method in the kartotherian-overzoom module might be of interest.

https://github.com/kartotherian/kartotherian-overzoom/blob/master/lib/overzoomer.js

Ben


________________________________________
Von: Stefan Keller <sfkeller at gmail.com>
Gesendet: Mittwoch, 3. Februar 2016 18:52:37
An: Blake Thompson
Cc: Stadin, Benjamin; Gdal-Dev; Even Rouault
Betreff: Re: [gdal-dev] Vector Tiles in OGR

Blake,

Sorry for iterating: I checked the spec. and analyzed a sample of
Mapbox vector tiles:
The spec. does not mention null tiles but there are tiles generated by
Mapbox which are empty/null (to save space).
I seems to me that Mapbox GL JS then backs up and takes the data from
a tile at a predefined "upper" zoom level.
Can elaborate on this?

:Stefan


2016-02-02 7:46 GMT+01:00 Stefan Keller <sfkeller at gmail.com>:
> Blake,
>
> Thanks for the comments.
> Regarding leaving out data at intermediate zoom levels I also meant
> omitting (setting to null) the entire tile.
> In fact I just realize that the spec. even does not mention how a
> reader knows at which level it should expect data if a tile is
> null/empty.
>
> :Stefan
>
>
> 2016-02-02 2:18 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
>> Stefan,
>>
>> Consistent recognition of specific features can be done by proper use of the
>> id field in features:
>>
>> https://github.com/mapbox/vector-tile-spec/tree/master/2.1#42-features
>>
>> You can definitely leave out data at intermediate zooms if you wished, we
>> have considered this on many occasions at Mapbox. As far as the
>> specification is concerned currently, the vector tile itself purposefully
>> does not contain all the metadata necessary for this specific task. This is
>> mentioned directly in the specification that each tile does not contain
>> information about its projection or bounds. The Vector Tile Specification is
>> purposeful in this because it leaves others specifications or an
>> implementation to explicitly provide all the necessary information.
>>
>> I have considered that we could define a metafile to define all this
>> information explicitly, but for now as far as I am concerned the
>> specification just for the tiles is very young! We could make a decision on
>> this sort of implementation, but it could very well be better placed inside
>> another standard. I will not shy away from the fact that the specification
>> very well might change as time goes on and perhaps adding more things that
>> will more narrowly define it such things as projection and bounds. The needs
>> of those using the format will definitely provide influence on how it
>> changes.
>>
>> There currently is no indexing or listing of features within a layer, other
>> then the layer classes themselves. We could provide such a feature perhaps,
>> but currently it would likely just take more memory with out much benefit.
>> It is very quick for our decoder to iterate over features, and in general
>> processing of vector tile data is expected to be done in memory.
>>
>> Most client are only concerned about the vector tiles that are currently
>> within a "view". Therefore, if a feature is missing within a view it is
>> considered not to have that feature. However, this doesn't limit people from
>> doing analysis across a large number of tiles. At Mapbox we have used
>> map-reduce type solutions to process large number of tiles for different
>> projects:
>>
>> https://github.com/mapbox/tile-reduce
>>
>> The idea is that vector tiles themselves should be relatively small in size
>> in most situations. If you data becomes too dense you could put the data at
>> a higher zoom or provide an abstraction of features. The format itself is a
>> "lossy" format as you are putting your data in a projection that is unique
>> to the tile, so the format is not designed for situations where accuracy is
>> extremely important. If you need more accuracy you can increase the "extent"
>> of a layer, which adds more precision, but this could also increase the size
>> of your tiles.
>>
>> As far as the concerns with making a solid GDAL driver from vector tiles, I
>> am not certain what the solution should be honestly. I want to be here as a
>> reference to help something be grown, but I can't point at a great
>> implementation like this because we have not put into mapnik even yet "a
>> datasource of many vector tiles" as a plugin. We have left such operations
>> up to a large number of open source javascript libraries that can provide
>> things like caching etc. (See tilelive https://github.com/mapbox/tilelive/ )
>>
>> In a limited sense to think of Vector Tiles for Mapbox Tools in the same
>> sense you would think about WKB for PostGIS. It is not the entire solution
>> alone.
>>
>> Thanks,
>>
>> Blake Thompson
>>
>> On Mon, Feb 1, 2016 at 5:45 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>>>
>>> Blake,
>>>
>>> Now the vector tiles spec. and the Mapbox approach became clearer to me.
>>>
>>> I'm still pondering about realizing a vector tiles reader (especially
>>> for QGIS) and for vector tiles uses cases like 1. base maps and 2.
>>> spatial analysis:
>>>
>>> Regarding clipped linestrings and polygons arriving at reader, there
>>> seems to exist no hint (clipped) nor id mentioned in the spec. to help
>>> the reader merging them?
>>>
>>> While there's overzoom, what's about leaving out data in intermediate
>>> zoom levels to save space? Does the spec. regulate that and who's
>>> responsible for handling this: server or client?
>>>
>>> Finally and back to my implementation concerns: How should an
>>> interactive client deal occurring/disappearing feature classes in a
>>> single "layer"? Is it forced to read all features on all zoom levels
>>> in order to announce all feature classes?
>>>
>>> :Stefan
>>>
>>>
>>> 2016-02-02 1:03 GMT+01:00 Blake Thompson <flippmoke at gmail.com>:
>>> > Benjamin Stadin,
>>> >
>>> > As an author of the specification, I have to disagree with you on the
>>> > support for other projections. There is no limitation on vector tiles
>>> > being
>>> > required to being in mercator. The specification in fact mentions that
>>> > other
>>> > projections may be used:
>>> >
>>> >
>>> > https://github.com/mapbox/vector-tile-spec/tree/master/2.1#3-projection-and-bounds
>>> >
>>> > While it is not accessible via the node-mapnik bindings, we do in fact
>>> > support encoding as different projections in mapnik-vector-tile. We have
>>> > implemented the decoder so that it could accept other projections, but
>>> > have
>>> > not added a mapnik datasource that would support them, but if there is
>>> > demand for such a thing we could do it.
>>> >
>>> > Your comments about the entire stack of Mapbox supporting mostly
>>> > mercator
>>> > could be very accurate, but this is not at all related to the Vector
>>> > Tile
>>> > Specification. We purposefully attempt to make our tools as
>>> > projection-less
>>> > as possible and hope that others find awesome ways to build upon the
>>> > standard.
>>> >
>>> > "But what data is shown at which zoom level is defined by the styling"
>>> > --
>>> > This is not true because you could make your data not even provide data
>>> > at
>>> > certain zoom levels. At Mapbox we do this quite often, street data is
>>> > never
>>> > included at very low zoom levels. Therefore, the style isn't the only
>>> > control here. In fact, I would encourage you to view styling and
>>> > rendering
>>> > of vector tiles as an entirely different topic.
>>> >
>>> > "There is enough interest from our side that we¹d be interested in
>>> > contributing (maybe monetary or with code, or both) to define and
>>> > implement
>>> > a better general purpose tile format." -- Any issues you might have with
>>> > the
>>> > Mapbox Vector Tile Specification or any ideas you might have with the
>>> > format
>>> > are very much welcome. We want to make sure the spec migrates for
>>> > community
>>> > needs. Please see
>>> > https://github.com/mapbox/vector-tile-spec/blob/master/CONTRIBUTING.md
>>> > for
>>> > how you might help!
>>> >
>>> > Finally, I would like to stress that while Mapbox Vector Tiles were
>>> > designed
>>> > to be for rendering, it was well known during their design that they
>>> > could
>>> > be used for other applications. This was especially true when I was
>>> > writing
>>> > 2.0 of the specification as I tried to limit what would be considered
>>> > even
>>> > the most common uses of vector tiles.
>>> >
>>> > Thanks,
>>> >
>>> > Blake Thompson
>>> >
>>> > On Mon, Feb 1, 2016 at 4:27 PM, Stefan Keller <sfkeller at gmail.com>
>>> > wrote:
>>> >>
>>> >> Hi Ben
>>> >>
>>> >> Thanks for explaining - Petr and I are the maintainers of
>>> >> OSM2Vectortiles.
>>> >> I like projections (and also GeoPackage :-) ).
>>> >> But reprojection is solved here, since OGR/QGIS can transform on the
>>> >> fly.
>>> >> This thread is about Petr's question about a reader "for mapbox-like
>>> >> vector tiles stored in MBTiles or downloaded from a url...".
>>> >>
>>> >> So I'd like to come back to the issue:
>>> >> 1. of a generic MVT decoder/enoder library (C++ or Python) => Blake?
>>> >> 2. and of a "feature provider" in an interactive environment (like
>>> >> QGIS) or a file/stream converter (like OGR) => anybody?
>>> >>
>>> >> :Stefan
>>> >>
>>> >>
>>> >>
>>> >> 2016-02-02 0:04 GMT+01:00 Stadin, Benjamin
>>> >> <Benjamin.Stadin at heidelberg-mobil.com>:
>>> >> > Hi Stefan,
>>> >> >
>>> >> > A vector tile may contain data for several zoom levels. But what data
>>> >> > is
>>> >> > shown at which zoom level is defined by the styling, not by the data
>>> >> > itself. It is handled on client side, by the web (or native) tile
>>> >> > renderer.
>>> >> >
>>> >> > The path is the same as with mercator tiles (zoomLevel/x/y):
>>> >> > https://example.com/17/65535/43602.mvt
>>> >> >
>>> >> >
>>> >> > The tile for zoom level 17 may contain features of class „building“,
>>> >> > and
>>> >> > the style definition may contain a rule that filters type „building“
>>> >> > for
>>> >> > zoomLevels <= 18.
>>> >> >
>>> >> > ~Ben
>>> >> >
>>> >> > Am 01.02.16, 20:16 schrieb "gdal-dev on behalf of Stefan Keller"
>>> >> > unter
>>> >> > <gdal-dev-bounces at lists.osgeo.org on behalf of sfkeller at gmail.com>:
>>> >> >
>>> >> >>That's good news!
>>> >> >>We'll be happy to add Python bindings to such a generic C++ library
>>> >> >>for Mapbox vector tiles.
>>> >> >>We have still some time (say few weeks?) left here to decide to
>>> >> >>contribute either to these bindings or to Mapzen's pure Python lib.
>>> >> >>
>>> >> >>One reason why I'm insisting on Python (bindings) - besides easier
>>> >> >>testing with QGIS - is the following:
>>> >> >>AFAIK with vector tiles we have to deal with quite a new kind of
>>> >> >>feature provider:
>>> >> >>One which contains "zoom levels" and one which "suddenly" changes
>>> >> >>feature class at different zoom levels.
>>> >> >>If a client like QGIS consumes vector tiles from OGR in a one-shot
>>> >> >>call, how should the client deal with such "zoom level" dependent
>>> >> >>issues?
>>> >> >>So my thinking is, to consume only the most appropriate zoom level,
>>> >> >>probably only within current map canvas...
>>> >> >>
>>> >> >>:Stefan
>>> >> >>
>>> >> >>2016-02-01 18:27 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> >> >>>
>>> >> >>> Stefan,
>>> >> >>>
>>> >> >>> I am not aware of any libraries besides mapnik vector tile that
>>> >> >>> have
>>> >> >>>been attempting to implement v2 specification. I think mapzen's
>>> >> >>>implementation might be best? We have been wanting to add vector
>>> >> >>> tiles
>>> >> >>>to the python mapnik bindings for quite some time but we don't have
>>> >> >>> the
>>> >> >>>time to do it right now.
>>> >> >>>
>>> >> >>> I will try to think this week about how we could make a generic C++
>>> >> >>>library quickly for Mapbox vector tiles.
>>> >> >>>
>>> >> >>> Thanks,
>>> >> >>>
>>> >> >>> Blake Thompson
>>> >> >>>
>>> >> >>>> On Feb 1, 2016, at 1:06 AM, Stefan Keller <sfkeller at gmail.com>
>>> >> >>>> wrote:
>>> >> >>>>
>>> >> >>>> Hi Blake
>>> >> >>>>
>>> >> >>>> It's clear to me that a good generic c++ library for encoding and
>>> >> >>>> decoding vector tiles is needed.
>>> >> >>>> On the other hand, I'd like to experiment with vector tiles and
>>> >> >>>> related QGIS parallel loading issues for which Python is more
>>> >> >>>> convenient.
>>> >> >>>>
>>> >> >>>> It seems that Mapzen's [1] Python implementation is further along.
>>> >> >>>> Or do you know if Jesse (or somebody) is still working on Mapbox's
>>> >> >>>>variant [2] ?
>>> >> >>>>
>>> >> >>>> :Stefan
>>> >> >>>>
>>> >> >>>> [1] https://github.com/mapzen/mapbox-vector-tile
>>> >> >>>> [2] https://github.com/mapbox/vector-tile-py
>>> >> >>>>
>>> >> >>>>
>>> >> >>>> 2016-01-31 23:22 GMT+01:00 Flippmoke <flippmoke at gmail.com>:
>>> >> >>>>> All,
>>> >> >>>>>
>>> >> >>>>> The first thing that is going to be required likely is a good
>>> >> >>>>> generic
>>> >> >>>>>c++ library for encoding and decoding vector tiles IMO.
>>> >> >>>>>
>>> >> >>>>> I have spent a lot of time working on developing the mapnik
>>> >> >>>>> vector
>>> >> >>>>>tile library to be a solid implementation, especially around all
>>> >> >>>>> the
>>> >> >>>>>work done for 2.0 of Mapbox vector tile specification. I would
>>> >> >>>>> love
>>> >> >>>>> to
>>> >> >>>>>eventually help make this a generalized implementation so that it
>>> >> >>>>> is
>>> >> >>>>>portable to a library like GDAL.
>>> >> >>>>>
>>> >> >>>>> We have talked about doing something like this at Mapbox but will
>>> >> >>>>>require a good deal of time, so it hasn't been pushed forward yet.
>>> >> >>>>> The
>>> >> >>>>>other issues that come to mind to me is that some of the libraries
>>> >> >>>>>that mapnik vector tile depends upon most likely need good custom
>>> >> >>>>>implementations if we wanted to make it more generic.
>>> >> >>>>>
>>> >> >>>>> The reason for this is that I would prefer for it to be a header
>>> >> >>>>> only
>>> >> >>>>>library with no dependencies. Adding more dependencies for GDAL
>>> >> >>>>> seems
>>> >> >>>>>like it could be a mess.
>>> >> >>>>>
>>> >> >>>>> Blake Thompson
>>> >> >>>>>
>>> >> >>>>>> On Jan 31, 2016, at 10:10 AM, Stefan Keller <sfkeller at gmail.com>
>>> >> >>>>>>wrote:
>>> >> >>>>>>
>>> >> >>>>>> Hi Petr, Blake, Even and everybody
>>> >> >>>>>>
>>> >> >>>>>> I'm (besides Petr) the other maintainer of OSM2VectorTiles.
>>> >> >>>>>> I'd already asked Even a similar question.
>>> >> >>>>>> I'm advising now an intern to implement such a MVT Vector Tiles
>>> >> >>>>>>reader
>>> >> >>>>>> client in Python if possible as part of a QGIS plugin.
>>> >> >>>>>> And I'm interested not to do redundant implementations.
>>> >> >>>>>> Are there any news on this matter?
>>> >> >>>>>>
>>> >> >>>>>> :Stefan
>>> >> >>>>>> Prof. at HSR and leader of Geometa Lab
>>> >> >>>>>>
>>> >> >>>>>> @Even: Regarding OGR MVT development can you send to me
>>> >> >>>>>> (directly)
>>> >> >>>>>> a
>>> >> >>>>>> contact name of the group which won the bidding?
>>> >> >>>>>>
>>> >> >>>>>>
>>> >> >>>>>> 2016-01-06 15:24 GMT+01:00 Petr Pridal
>>> >> >>>>>> <petr.pridal at klokantech.com>:
>>> >> >>>>>>> Hi everybody,
>>> >> >>>>>>>
>>> >> >>>>>>> thanks for the comments. Regarding the technical details:
>>> >> >>>>>>>
>>> >> >>>>>>>> Each Tile is its own discrete dataset therefore the hardest
>>> >> >>>>>>>> part
>>> >> >>>>>>>>would be
>>> >> >>>>>>>> merging of features into the original features across tiles.
>>> >> >>>>>>>> You
>>> >> >>>>>>>>could use
>>> >> >>>>>>>> some complicated merging technique, but that could be very
>>> >> >>>>>>>>expensive.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> The driver could require "id" parameter, which specifies name
>>> >> >>>>>>> of
>>> >> >>>>>>> an
>>> >> >>>>>>> attribute with unique identifier on the features shared across
>>> >> >>>>>>> the
>>> >> >>>>>>>tiles.
>>> >> >>>>>>> Both MapBox vector tiles and OSM2VectorTiles tiles have an
>>> >> >>>>>>> unique
>>> >> >>>>>>>non-zero
>>> >> >>>>>>> "osm_id" in place. The first version of driver could read only
>>> >> >>>>>>>features with
>>> >> >>>>>>> such ID. The identifier does not have to be always filled, but
>>> >> >>>>>>>often it is,
>>> >> >>>>>>> especially in deeper zoom levels derived purely from
>>> >> >>>>>>> OpenStreetMap
>>> >> >>>>>>>- but
>>> >> >>>>>>> yeh, a completely general stitching would be much harder.
>>> >> >>>>>>>
>>> >> >>>>>>> The clipping + merging of shapes itself can be implemented with
>>> >> >>>>>>>underlaying
>>> >> >>>>>>> GEOS library functions.
>>> >> >>>>>>>
>>> >> >>>>>>> BTW It is possible to examine vector tiles data in pure
>>> >> >>>>>>> JavaScript
>>> >> >>>>>>>X-Ray
>>> >> >>>>>>> viewer (no WebGL support on browser required) made in
>>> >> >>>>>>> OpenLayers3:
>>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/xray.html
>>> >> >>>>>>>
>>> >> >>>>>>> or with WebGL-enabled webbrowser with higher performance MapBox
>>> >> >>>>>>> GL
>>> >> >>>>>>>JS
>>> >> >>>>>>> powered X-Ray:
>>> >> >>>>>>>
>>> >> >>>>>>> http://klokantech.github.io/mapbox-gl-js-offline-example/xray.html
>>> >> >>>>>>>
>>> >> >>>>>>> A debug viewer for each vector tile (made in OL3) decoded in
>>> >> >>>>>>> pure
>>> >> >>>>>>> JavaScript:
>>> >> >>>>>>>
>>> >> >>>>>>> http://klokantech.github.io/ol3-sandbox/vector/tile-inspector.html
>>> >> >>>>>>>
>>> >> >>>>>>> The OGR driver could be also practical for the unsimplified /
>>> >> >>>>>>>ungeneralised
>>> >> >>>>>>> MBTiles with OSM data available at:
>>> >> >>>>>>>http://osmlab.github.io/osm-qa-tiles/
>>> >> >>>>>>>
>>> >> >>>>>>>>
>>> >> >>>>>>>> If you wanted to simply view vector tile data it could get
>>> >> >>>>>>>>confusing as
>>> >> >>>>>>>> well since most vector tiles need a buffer when they are used
>>> >> >>>>>>>> for
>>> >> >>>>>>>> visualization programs. This is important for things like
>>> >> >>>>>>>> labeling
>>> >> >>>>>>>>on maps
>>> >> >>>>>>>> etc. Therefore, you could get a large amount of overlapping
>>> >> >>>>>>>> data
>>> >> >>>>>>>>on tiles if
>>> >> >>>>>>>> you loaded them all in at once.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Clipping on border of each tile must be applied before
>>> >> >>>>>>> stitching
>>> >> >>>>>>>the vector
>>> >> >>>>>>> features together  - so the buffer is removed. Buffer is there
>>> >> >>>>>>> only
>>> >> >>>>>>>for
>>> >> >>>>>>> visualisation and labeling.
>>> >> >>>>>>>
>>> >> >>>>>>>>
>>> >> >>>>>>>> As far as writing a simple decoder -- the mapnik-vector-tile
>>> >> >>>>>>>>decoder isn't
>>> >> >>>>>>>> currently able to decode vector tiles into a form not
>>> >> >>>>>>>> supported
>>> >> >>>>>>>> by
>>> >> >>>>>>>>mapnik.
>>> >> >>>>>>>> Therefore, OGR would not be able to easily use this.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Correct. It can't be used directly (GDAL can't link against),
>>> >> >>>>>>> but
>>> >> >>>>>>>the
>>> >> >>>>>>> relevant code can be extracted and reused directly. For basic
>>> >> >>>>>>>decoding
>>> >> >>>>>>> critical is the Protobuf library (which is already in GDAL) and
>>> >> >>>>>>>
>>> >>
>>> >> >>>>>>>
>>> >> >>>>>>> >>>>>>> >>>>>>>https://github.com/mapbox/mapnik-vector-tile/blob/master/proto/vector
>>> >> >>>>>>>_tile.proto
>>> >> >>>>>>> + the code for converting pixel coordinates in features to
>>> >> >>>>>>> relevant
>>> >> >>>>>>>geo
>>> >> >>>>>>> coordinates and GEOS-based merging of features.
>>> >> >>>>>>>
>>> >> >>>>>>>> We plan to write a generalized encoder and decoder eventually
>>> >> >>>>>>>> so
>>> >> >>>>>>>>that any
>>> >> >>>>>>>> other library can plugin with out the mapnik requirement.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> This would be amazing.
>>> >> >>>>>>>
>>> >> >>>>>>>> If you have any questions specifically about Mapnik Vector
>>> >> >>>>>>>> Tile
>>> >> >>>>>>>> or
>>> >> >>>>>>>>the
>>> >> >>>>>>>> Mapbox Vector Tile Specification feel free to ask me. I would
>>> >> >>>>>>>> note
>>> >> >>>>>>>>that you
>>> >> >>>>>>>> guys will want to update your vector tiles once the V2
>>> >> >>>>>>>>specification changes
>>> >> >>>>>>>> are into Mapnik-Vector-Tile.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Cool! Thanks. Our world tiles are generated via Docker
>>> >> >>>>>>> containers
>>> >> >>>>>>>on a
>>> >> >>>>>>> cluster of computers - using Mapnik via Tilelive directly - so
>>> >> >>>>>>>upgrades on
>>> >> >>>>>>> Mapnik-Vector-Tile will propagate to the open-source rendering
>>> >> >>>>>>>software.
>>> >> >>>>>>> I expect V2 spec will mean also new MapBox Streets V7, right?
>>> >> >>>>>>>
>>> >> >>>>>>>> I see you mention MVT in MBTiles. Is it a recognized practice
>>> >> >>>>>>>> ? I
>>> >> >>>>>>>>don't
>>> >> >>>>>>>> see
>>> >> >>>>>>>> mention of that neither in the MVT spec (
>>> >> >>>>>>>> https://github.com/mapbox/vector-
>>> >> >>>>>>>> tile-spec/tree/master/2.0 ) nor the MBTiles one (
>>> >> >>>>>>>> https://github.com/mapbox/mbtiles-spec/blob/master/1.2/spec.md
>>> >> >>>>>>>> ),
>>> >> >>>>>>>>although
>>> >> >>>>>>>> I
>>> >> >>>>>>>> guess it is just a matter of storing a MVT blob in the
>>> >> >>>>>>>> tile_data
>>> >> >>>>>>>>column.
>>> >> >>>>>>>
>>> >> >>>>>>>
>>> >> >>>>>>> Yes. MapBox Studio Classic generates such MBTiles with Vector
>>> >> >>>>>>> Tiles
>>> >> >>>>>>>inside -
>>> >> >>>>>>> and Mapnik reads them directly when rasterising. Storing the
>>> >> >>>>>>> vector
>>> >> >>>>>>>tiles in
>>> >> >>>>>>> SQLite make sense - and it simplifies deployment, and you can
>>> >> >>>>>>> then
>>> >> >>>>>>>easily
>>> >> >>>>>>> have complete world on each node of a cluster of tileservers.
>>> >> >>>>>>> If
>>> >> >>>>>>>you don't
>>> >> >>>>>>> want to upgrade your base map too often, this approach is
>>> >> >>>>>>> pretty
>>> >> >>>>>>>efficient
>>> >> >>>>>>> and removes the centralised database as typical bottleneck.
>>> >> >>>>>>>
>>> >> >>>>>>> I did some tests on vector tiles vs raster in MBTiles and
>>> >> >>>>>>>documented these
>>> >> >>>>>>> in README.md at and
>>> >> >>>>>>>https://github.com/klokantech/vector-tiles-sample before
>>> >> >>>>>>> we started to work on OSM2VectorTiles project.
>>> >> >>>>>>> There are also sample data and offline MapBox GL JS viewer in
>>> >> >>>>>>> that
>>> >> >>>>>>>repo.
>>> >> >>>>>>> Vector tiles can be hosted also "unpacked", just as files in
>>> >> >>>>>>>folders on a
>>> >> >>>>>>> standard web server - exactly like GDAL2Tiles or MapTiler.com
>>> >> >>>>>>> does
>>> >> >>>>>>>by
>>> >> >>>>>>> default for raster tiles.
>>> >> >>>>>>>
>>> >> >>>>>>> If OGR driver is implemented, the primary source should be
>>> >> >>>>>>> probably
>>> >> >>>>>>>reading
>>> >> >>>>>>> from an URL via curl.
>>> >> >>>>>>>
>>> >> >>>>>>> Reading PBFs from an MBTiles (or another SQLite) is just the
>>> >> >>>>>>> most
>>> >> >>>>>>>practical
>>> >> >>>>>>> portable alternative to it.
>>> >> >>>>>>>
>>> >> >>>>>>> Technically people may store the tiles in different ways - for
>>> >> >>>>>>>example
>>> >> >>>>>>> Wikimedia guys (http://maps.wikimedia.org/ and
>>> >> >>>>>>> https://github.com/kartotherian/) use Cassandra for tile
>>> >> >>>>>>> storage,
>>> >> >>>>>>> I
>>> >> >>>>>>>guess
>>> >> >>>>>>> MapBox internally is also on a different storage for production
>>> >> >>>>>>>servers ...
>>> >> >>>>>>> for transfers and streaming tilesets there is the  - but tiles
>>> >> >>>>>>> are
>>> >> >>>>>>>ALWAYS
>>> >> >>>>>>> exposed via HTTP.
>>> >> >>>>>>>
>>> >> >>>>>>> Regards,
>>> >> >>>>>>>
>>> >> >>>>>>> Petr
>>> >> >>>>>>> --
>>> >> >>>>>>> Petr Pridal, Ph.D.
>>> >> >>>>>>> CEO
>>> >> >>>>>>>
>>> >> >>>>>>> Klokan Technologies GmbH
>>> >> >>>>>>> Hofnerstrasse 98, 6314 Unterageri, Switzerland
>>> >> >>>>>>> Tel: +41 (0)41 511 26 12
>>> >> >>>>>>> Email: info at klokantech.com
>>> >> >>>>>>> Web: http://www.klokantech.com/
>>> >> >>>>>>>
>>> >> >>>>>>> _______________________________________________
>>> >> >>>>>>> gdal-dev mailing list
>>> >> >>>>>>> gdal-dev at lists.osgeo.org
>>> >> >>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >> >>_______________________________________________
>>> >> >>gdal-dev mailing list
>>> >> >>gdal-dev at lists.osgeo.org
>>> >> >>http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> >> >
>>> >
>>> >
>>
>>

From boxerab at gmail.com  Wed Feb  3 11:28:06 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Wed, 3 Feb 2016 14:28:06 -0500
Subject: [gdal-dev] Fork Yeah!
Message-ID: <CAK8GPyAtB0jCxo6F7d3-+yqMQtceULkQ6VzZYcgYbzzZR2HCrg@mail.gmail.com>

Dear GDAL Developers,

I am developing a new open source JPEG 2000 toolkit, based on OpenJPEG.

It is a drop-in replacement for OpenJPEG, but features:

- fast precinct-level decode
- lower memory usage
- better performance - currently it is roughly 1/3 the perf of Kakadu,
(tested on windows), and I am hoping to get it down to around 1/2

I was originally hoping to merge these changes into OpenJPEG. For a number
of reasons, I decided to start a new project instead.  One of my main
motivations is the fact that  OpenJPEG is a reference implementation,
designed for correctness and portability. My main interest is performance.

I have ported the code to C++14, so developers get access to all of the
modern C++ goodness such as class hierarchies, lambdas, threading library,
exceptions, standard template library, etc.

Gone is support for older compilers, including VS 2010.

The code is licensed under the AGPL, to ensure that all code modifications
get contributed back to the community.

It you find this useful, please visit

https://github.com/GrokImageCompression/ronin

For those who need a more permissive license, or who prefer using the
reference implementation, there is always good old OpenJPEG.

Kind Regards,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160203/1a98fb97/attachment.html>

From damian.dixon at gmail.com  Wed Feb  3 11:57:43 2016
From: damian.dixon at gmail.com (Damian Dixon)
Date: Wed, 3 Feb 2016 19:57:43 +0000
Subject: [gdal-dev] Fork Yeah!
In-Reply-To: <CAK8GPyAtB0jCxo6F7d3-+yqMQtceULkQ6VzZYcgYbzzZR2HCrg@mail.gmail.com>
References: <CAK8GPyAtB0jCxo6F7d3-+yqMQtceULkQ6VzZYcgYbzzZR2HCrg@mail.gmail.com>
Message-ID: <CAJjdW1xvXmN4RPi9FdGO25CAC5u6FMCUmscaHp-Bu=3oW8kKZg@mail.gmail.com>

Hi Aaron,

The use of AGPL means that your OpenJPEG fork will not be used for
commercial projects and any enhancements you make will not make there way
into OpenJPEG.

You may have a good reason for choosing this licence and as such it is your
choice.

Either way good luck.

Regards
Damian

On 3 February 2016 at 19:28, Aaron Boxer <boxerab at gmail.com> wrote:

> Dear GDAL Developers,
>
> I am developing a new open source JPEG 2000 toolkit, based on OpenJPEG.
>
> It is a drop-in replacement for OpenJPEG, but features:
>
> - fast precinct-level decode
> - lower memory usage
> - better performance - currently it is roughly 1/3 the perf of Kakadu,
> (tested on windows), and I am hoping to get it down to around 1/2
>
> I was originally hoping to merge these changes into OpenJPEG. For a number
> of reasons, I decided to start a new project instead.  One of my main
> motivations is the fact that  OpenJPEG is a reference implementation,
> designed for correctness and portability. My main interest is performance.
>
> I have ported the code to C++14, so developers get access to all of the
> modern C++ goodness such as class hierarchies, lambdas, threading library,
> exceptions, standard template library, etc.
>
> Gone is support for older compilers, including VS 2010.
>
> The code is licensed under the AGPL, to ensure that all code modifications
> get contributed back to the community.
>
> It you find this useful, please visit
>
> https://github.com/GrokImageCompression/ronin
>
> For those who need a more permissive license, or who prefer using the
> reference implementation, there is always good old OpenJPEG.
>
> Kind Regards,
> Aaron
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160203/98c78926/attachment.html>

From boxerab at gmail.com  Wed Feb  3 12:22:43 2016
From: boxerab at gmail.com (Aaron Boxer)
Date: Wed, 3 Feb 2016 15:22:43 -0500
Subject: [gdal-dev] Fork Yeah!
In-Reply-To: <CAJjdW1xvXmN4RPi9FdGO25CAC5u6FMCUmscaHp-Bu=3oW8kKZg@mail.gmail.com>
References: <CAK8GPyAtB0jCxo6F7d3-+yqMQtceULkQ6VzZYcgYbzzZR2HCrg@mail.gmail.com>
 <CAJjdW1xvXmN4RPi9FdGO25CAC5u6FMCUmscaHp-Bu=3oW8kKZg@mail.gmail.com>
Message-ID: <CAK8GPyDHo-6q=3YiUCDVG+exXxv8HiuapSc_ZsFEut5tWJ6iWw@mail.gmail.com>

Hi Damian,



> The use of AGPL means that your OpenJPEG fork will not be used for
> commercial projects and any enhancements you make will not make there way
> into OpenJPEG.
>

Correct.

>
> You may have a good reason for choosing this licence and as such it is
> your choice.
>

Yes.

>
> Either way good luck.
>


Thank you.


Cheers,
Aaron


>
>
> On 3 February 2016 at 19:28, Aaron Boxer <boxerab at gmail.com> wrote:
>
>> Dear GDAL Developers,
>>
>> I am developing a new open source JPEG 2000 toolkit, based on OpenJPEG.
>>
>> It is a drop-in replacement for OpenJPEG, but features:
>>
>> - fast precinct-level decode
>> - lower memory usage
>> - better performance - currently it is roughly 1/3 the perf of Kakadu,
>> (tested on windows), and I am hoping to get it down to around 1/2
>>
>> I was originally hoping to merge these changes into OpenJPEG. For a
>> number of reasons, I decided to start a new project instead.  One of my
>> main motivations is the fact that  OpenJPEG is a reference implementation,
>> designed for correctness and portability. My main interest is performance.
>>
>> I have ported the code to C++14, so developers get access to all of the
>> modern C++ goodness such as class hierarchies, lambdas, threading library,
>> exceptions, standard template library, etc.
>>
>> Gone is support for older compilers, including VS 2010.
>>
>> The code is licensed under the AGPL, to ensure that all code
>> modifications get contributed back to the community.
>>
>> It you find this useful, please visit
>>
>> https://github.com/GrokImageCompression/ronin
>>
>> For those who need a more permissive license, or who prefer using the
>> reference implementation, there is always good old OpenJPEG.
>>
>> Kind Regards,
>> Aaron
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160203/8b3b186a/attachment.html>

From landa.martin at gmail.com  Wed Feb  3 14:24:07 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 3 Feb 2016 23:24:07 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1OfBWfv1U9X5GKXnn43=qZdZsQZgBzL5E7tUemda3NaynQ@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <1411484194.54218a223fad3@imp.free.fr>
 <CA+Ei1OeBxoKauR_q1GajDxBkyMt0_Z7JV0=4EU63nwOitn0RBg@mail.gmail.com>
 <CA+Ei1OfBWfv1U9X5GKXnn43=qZdZsQZgBzL5E7tUemda3NaynQ@mail.gmail.com>
Message-ID: <CA+Ei1Od6E3m4iCdSMGvt5DBASparcxhrmKXkGbxuLS2=K78yxQ@mail.gmail.com>

Hi,

2015-04-17 12:26 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
>>> to the user, we could have a generic XML driver that would try several XSLT
>>> documents and then feed the transformed document to the GML driver. I don't
>>
>> Anybody here is interested to implement such driver or at least to
>> collaborate on such project?
>>
>>> If you go with a from-the-scratch driver, I would not recommand to go from the
>>> GML one which has become very complicated. GeoRSS or GPX are probably better
>>> starting points.
>
> it's seems to me that I will go this way (from-the-scratch driver).
> Unfortunately I do not have enough time to start working on generic
> driver first.

I am back with this topic again, I was thinking to use xsd2cpp way,
but it seems to be not possible (or hardly possible) [1]. I was also
thinking to design VFP driver classes as descendant of GML driver
classes (I could basically write gfs file for VFP format). The
difference would be how to read geometry, example:

      <par>
        <pa parid="2402887611" vymo="291" vzd="296" cir="0" vymg="280.568">
          <gpar>
            <area>
              <reg>
                <solid>
                  <polygon xmlns:v="http://www.hsi.cz/vfp" xsi:type="v:linpol">
                    <segment xsi:type="v:se">
                      <c x="1074884.94" y="610475.72" />
                      <c x="1074902.12" y="610470.6" />
                      <c x="1074875.22" y="610462.44" />
                      <c x="1074873.4" y="610461.76" />
                      <c x="1074861.4" y="610470.26" />
                      <c x="1074862.21" y="610470.45" />
                      <c x="1074884.94" y="610475.72" />
                    </segment>
                  </polygon>
                </solid>
              </reg>
              <t hod="60" vys="4.5" sir="5.5" j="33">
                <c x="1074877.99" y="610469.04" />
              </t>
            </area>
          </gpar>
          ...
          </pa>
        </par>


But it doesn't seems to be a reasonable way. So I end up again with
plan to write a special driver from scratch. Or is there any other way
which I overlooked?

Thanks, Martin

[1] http://codesynthesis.com/pipermail/xsd-users/2016-January/004755.html

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Wed Feb  3 14:31:50 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Feb 2016 23:31:50 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1Od6E3m4iCdSMGvt5DBASparcxhrmKXkGbxuLS2=K78yxQ@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <CA+Ei1OfBWfv1U9X5GKXnn43=qZdZsQZgBzL5E7tUemda3NaynQ@mail.gmail.com>
 <CA+Ei1Od6E3m4iCdSMGvt5DBASparcxhrmKXkGbxuLS2=K78yxQ@mail.gmail.com>
Message-ID: <201602032331.50906.even.rouault@spatialys.com>

Le mercredi 03 février 2016 23:24:07, Martin Landa a écrit :
> Hi,
> 
> 2015-04-17 12:26 GMT+02:00 Martin Landa <landa.martin at gmail.com>:
> >>> to the user, we could have a generic XML driver that would try several
> >>> XSLT documents and then feed the transformed document to the GML
> >>> driver. I don't
> >> 
> >> Anybody here is interested to implement such driver or at least to
> >> collaborate on such project?
> >> 
> >>> If you go with a from-the-scratch driver, I would not recommand to go
> >>> from the GML one which has become very complicated. GeoRSS or GPX are
> >>> probably better starting points.
> > 
> > it's seems to me that I will go this way (from-the-scratch driver).
> > Unfortunately I do not have enough time to start working on generic
> > driver first.
> 
> I am back with this topic again, I was thinking to use xsd2cpp way,
> but it seems to be not possible (or hardly possible) [1]. I was also
> thinking to design VFP driver classes as descendant of GML driver
> classes (I could basically write gfs file for VFP format). The
> difference would be how to read geometry, example:
> 
>       <par>
>         <pa parid="2402887611" vymo="291" vzd="296" cir="0" vymg="280.568">
>           <gpar>
>             <area>
>               <reg>
>                 <solid>
>                   <polygon xmlns:v="http://www.hsi.cz/vfp"
> xsi:type="v:linpol"> <segment xsi:type="v:se">
>                       <c x="1074884.94" y="610475.72" />
>                       <c x="1074902.12" y="610470.6" />
>                       <c x="1074875.22" y="610462.44" />
>                       <c x="1074873.4" y="610461.76" />
>                       <c x="1074861.4" y="610470.26" />
>                       <c x="1074862.21" y="610470.45" />
>                       <c x="1074884.94" y="610475.72" />
>                     </segment>
>                   </polygon>
>                 </solid>
>               </reg>
>               <t hod="60" vys="4.5" sir="5.5" j="33">
>                 <c x="1074877.99" y="610469.04" />
>               </t>
>             </area>
>           </gpar>
>           ...
>           </pa>
>         </par>
> 
> 
> But it doesn't seems to be a reasonable way. So I end up again with
> plan to write a special driver from scratch. Or is there any other way
> which I overlooked?

If it can be handled by the GML driver except for the geometries, you could 
probably add a special processing like done for AIXM ElevatedPoint. Have a 
look in ogr/ogrsf_frmts/gml/gmlhandler.cpp at :
- ParseAIXMElevationPoint() : transform a custom geometry format into standard 
GML
- where it is called : line 1498
- GMLHandler::IsGeometryElement()

> 
> Thanks, Martin
> 
> [1] http://codesynthesis.com/pipermail/xsd-users/2016-January/004755.html

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Wed Feb  3 14:56:04 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 3 Feb 2016 23:56:04 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <201602032331.50906.even.rouault@spatialys.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <CA+Ei1OfBWfv1U9X5GKXnn43=qZdZsQZgBzL5E7tUemda3NaynQ@mail.gmail.com>
 <CA+Ei1Od6E3m4iCdSMGvt5DBASparcxhrmKXkGbxuLS2=K78yxQ@mail.gmail.com>
 <201602032331.50906.even.rouault@spatialys.com>
Message-ID: <CA+Ei1Ofop4irdGmU91DWedGpzoLFNpKVSzdWLKs7wWvLim=tug@mail.gmail.com>

Hi,

2016-02-03 23:31 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> If it can be handled by the GML driver except for the geometries, you could

can GFS handle such data

<uca id="0" jm="a" pr="b" />

?

<GMLFeatureClassList>
  <GMLFeatureClass>
    <Name>ucastnici</Name>
    <ElementPath>ucastnici</ElementPath>
    <SRSName>urn:ogc:def:crs:EPSG::5514</SRSName>
    <PropertyDefn>
      <Name>id</Name>
      <ElementPath>uca|id</ElementPath>
      <Type>Integer64</Type>
    </PropertyDefn>
  </GMLFeatureClas>
</GMLFeatureClassList>

The above GFS files should handle:

<uca>
  <id>0</id>
 ...
</uca>

But not XML notation shown above, right? Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Wed Feb  3 14:57:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 3 Feb 2016 23:57:15 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1Ofop4irdGmU91DWedGpzoLFNpKVSzdWLKs7wWvLim=tug@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <201602032331.50906.even.rouault@spatialys.com>
 <CA+Ei1Ofop4irdGmU91DWedGpzoLFNpKVSzdWLKs7wWvLim=tug@mail.gmail.com>
Message-ID: <201602032357.15362.even.rouault@spatialys.com>

Le mercredi 03 février 2016 23:56:04, Martin Landa a écrit :
> Hi,
> 
> 2016-02-03 23:31 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > If it can be handled by the GML driver except for the geometries, you
> > could
> 
> can GFS handle such data
> 
> <uca id="0" jm="a" pr="b" />
> 
> ?
> 
> <GMLFeatureClassList>
>   <GMLFeatureClass>
>     <Name>ucastnici</Name>
>     <ElementPath>ucastnici</ElementPath>
>     <SRSName>urn:ogc:def:crs:EPSG::5514</SRSName>
>     <PropertyDefn>
>       <Name>id</Name>
>       <ElementPath>uca|id</ElementPath>
>       <Type>Integer64</Type>
>     </PropertyDefn>
>   </GMLFeatureClas>
> </GMLFeatureClassList>
> 
> The above GFS files should handle:
> 
> <uca>
>   <id>0</id>
>  ...
> </uca>
> 
> But not XML notation shown above, right? Thanks, Martin

Have a look at the "Getting XML attributes as OGR fields" section of 
http://gdal.org/drv_gml.html


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Wed Feb  3 15:00:42 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Thu, 4 Feb 2016 00:00:42 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <201602032357.15362.even.rouault@spatialys.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <201602032331.50906.even.rouault@spatialys.com>
 <CA+Ei1Ofop4irdGmU91DWedGpzoLFNpKVSzdWLKs7wWvLim=tug@mail.gmail.com>
 <201602032357.15362.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OeAaWMmk4G0LjgN1o0r206YTBb3OrMzYHN5RnJj+btVQQ@mail.gmail.com>

2016-02-03 23:57 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:

> Have a look at the "Getting XML attributes as OGR fields" section of
> http://gdal.org/drv_gml.html

oh, thanks, I overlooked this part. Ma

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From ari.jolma at gmail.com  Wed Feb  3 22:54:07 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 4 Feb 2016 08:54:07 +0200
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
 measures in geometries
In-Reply-To: <201602031511.30484.even.rouault@spatialys.com>
References: <56AA2102.9030102@gmail.com>
 <201602011617.46069.even.rouault@spatialys.com> <56B2024E.6040102@gmail.com>
 <201602031511.30484.even.rouault@spatialys.com>
Message-ID: <56B2F58F.7060307@gmail.com>


03.02.2016, 16:11, Even Rouault kirjoitti:
> Le mercredi 03 février 2016 14:36:14, Ari Jolma a écrit :
>> I finally have the (existing) autotests passing with the new API -
>> basically just replacing the nCoordDimension property of OGRGeometry
>> with flags (for Z and M) - and a rather large set of tests for
>> import/export WKT and WKB with M passing.
> That's great !

Yes, except that I just found out that despite of the already large set 
of test WKT strings, a simple one like

GEOMETRYCOLLECTION M (POINT (1 2 3))

produces, when read in and printed out as ISO WKT

GEOMETRYCOLLECTION Z (POINT (1 2 3))

The problem is that neither OGR_G_CreateFromWkt() nor 
OGRGeometryFactory::createFromWkt does not have OGRwkbVariant 
eWkbVariant parameter (as OGRGeometryFactory::createFromWkb but not 
OGR_G_CreateFromWkb), which would at least make the case more clear in 
the code.

Reading OGC common architecture (1.2.1) it seems to me that the WKT is 
in fact invalid and it should be

GEOMETRYCOLLECTION M (POINT M (1 2 3))

Also PostGIS returns the error " can not mix dimensionality" with the 
above one.

However, interestingly, PostGIS accepts

MULTICURVE M (CIRCULARSTRING (0 0 2,1 0 2,0 0 2),(0 0 2,1 1 2))

and

MULTICURVE M (CIRCULARSTRING Z (0 0 2,1 0 2,0 0 2),(0 0 2,1 1 2))

although, in the latter one PostGIS converts the Z into M.

I think the path I'll take will be to rather easily spit out "corrupt 
data" (or a new "mixed geometries" error) for cases which involve M.

Ari

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160204/2fb28c94/attachment-0001.html>

From yhema.2705 at gmail.com  Wed Feb  3 23:59:02 2016
From: yhema.2705 at gmail.com (y hema)
Date: Thu, 4 Feb 2016 13:29:02 +0530
Subject: [gdal-dev] how to get attribute values from shape layer which is in
 geoserver using gdal.
Message-ID: <CAMvxtC9LyRtzgorXXSL=DK3GestkgP2Wbxwx6zwSMagsx8WSyg@mail.gmail.com>

hi all,


I have shape file loaded on geoserver. now using gdal i want the attribute
values of the shape layer.how can this be done.


thanks,
hema
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160204/396f4d5e/attachment.html>

From even.rouault at spatialys.com  Thu Feb  4 00:46:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Feb 2016 09:46:08 +0100
Subject: [gdal-dev] Call for discussion about RFC 61: Support for
	measures in geometries
In-Reply-To: <56B2F58F.7060307@gmail.com>
References: <56AA2102.9030102@gmail.com>
 <201602031511.30484.even.rouault@spatialys.com> <56B2F58F.7060307@gmail.com>
Message-ID: <201602040946.08364.even.rouault@spatialys.com>

Le jeudi 04 février 2016 07:54:07, Ari Jolma a écrit :
> 03.02.2016, 16:11, Even Rouault kirjoitti:
> > Le mercredi 03 février 2016 14:36:14, Ari Jolma a écrit :
> >> I finally have the (existing) autotests passing with the new API -
> >> basically just replacing the nCoordDimension property of OGRGeometry
> >> with flags (for Z and M) - and a rather large set of tests for
> >> import/export WKT and WKB with M passing.
> > 
> > That's great !
> 
> Yes, except that I just found out that despite of the already large set
> of test WKT strings, a simple one like
> 
> GEOMETRYCOLLECTION M (POINT (1 2 3))
> 
> produces, when read in and printed out as ISO WKT
> 
> GEOMETRYCOLLECTION Z (POINT (1 2 3))
> 
> The problem is that neither OGR_G_CreateFromWkt() nor
> OGRGeometryFactory::createFromWkt does not have OGRwkbVariant
> eWkbVariant parameter (as OGRGeometryFactory::createFromWkb but not
> OGR_G_CreateFromWkb), which would at least make the case more clear in
> the code.
> 
> Reading OGC common architecture (1.2.1) it seems to me that the WKT is
> in fact invalid and it should be
> 
> GEOMETRYCOLLECTION M (POINT M (1 2 3))
> 
> Also PostGIS returns the error " can not mix dimensionality" with the
> above one.
> 
> However, interestingly, PostGIS accepts
> 
> MULTICURVE M (CIRCULARSTRING (0 0 2,1 0 2,0 0 2),(0 0 2,1 1 2))
> 
> and
> 
> MULTICURVE M (CIRCULARSTRING Z (0 0 2,1 0 2,0 0 2),(0 0 2,1 1 2))
> 
> although, in the latter one PostGIS converts the Z into M.
> 
> I think the path I'll take will be to rather easily spit out "corrupt
> data" (or a new "mixed geometries" error) for cases which involve M.

That sounds reasonable to be more strict for M.

> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Thu Feb  4 01:30:55 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Thu, 4 Feb 2016 10:30:55 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1OeAaWMmk4G0LjgN1o0r206YTBb3OrMzYHN5RnJj+btVQQ@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <201602032331.50906.even.rouault@spatialys.com>
 <CA+Ei1Ofop4irdGmU91DWedGpzoLFNpKVSzdWLKs7wWvLim=tug@mail.gmail.com>
 <201602032357.15362.even.rouault@spatialys.com>
 <CA+Ei1OeAaWMmk4G0LjgN1o0r206YTBb3OrMzYHN5RnJj+btVQQ@mail.gmail.com>
Message-ID: <CA+Ei1Od=ByJHCwX8101fevtamE2drHmsdEvdrzXzVp=208zJpA@mail.gmail.com>

Hi,

2016-02-04 0:00 GMT+01:00 Martin Landa <landa.martin at gmail.com>:
>> Have a look at the "Getting XML attributes as OGR fields" section of
>> http://gdal.org/drv_gml.html
>
> oh, thanks, I overlooked this part. Ma

after various experiments I still must miss something. The input data:

  <ucastnici>
    <uca id="0" />
    <uca id="1" />
 </ucastnici>

GFS:

<GMLFeatureClassList>
  <!-- ucastnici -->
  <GMLFeatureClass>
    <Name>ucastnici</Name>
    <ElementPath>ucastnici|uca</ElementPath>
    <GeometryType>100</GeometryType>
    <PropertyDefn>
      <Name>id</Name>
      <ElementPath>@id</ElementPath>
      <Type>Integer</Type>
    </PropertyDefn>
  </GMLFeatureClass>
</GMLFeatureClassList>

I tried:

      <ElementPath>uca at id</ElementPath>

But the attribute is still null.

When I try

    <ElementPath>ucastnici|uca</ElementPath>
...
      <ElementPath>uca at id</ElementPath>

then I am still getting 0 features.

Thanks, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Thu Feb  4 01:42:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Feb 2016 10:42:48 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1Od=ByJHCwX8101fevtamE2drHmsdEvdrzXzVp=208zJpA@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <CA+Ei1OeAaWMmk4G0LjgN1o0r206YTBb3OrMzYHN5RnJj+btVQQ@mail.gmail.com>
 <CA+Ei1Od=ByJHCwX8101fevtamE2drHmsdEvdrzXzVp=208zJpA@mail.gmail.com>
Message-ID: <201602041042.48512.even.rouault@spatialys.com>

Le jeudi 04 février 2016 10:30:55, Martin Landa a écrit :
> Hi,
> 
> 2016-02-04 0:00 GMT+01:00 Martin Landa <landa.martin at gmail.com>:
> >> Have a look at the "Getting XML attributes as OGR fields" section of
> >> http://gdal.org/drv_gml.html
> > 
> > oh, thanks, I overlooked this part. Ma
> 
> after various experiments I still must miss something. The input data:
> 
>   <ucastnici>
>     <uca id="0" />
>     <uca id="1" />
>  </ucastnici>
> 
> GFS:
> 
> <GMLFeatureClassList>
>   <!-- ucastnici -->
>   <GMLFeatureClass>
>     <Name>ucastnici</Name>
>     <ElementPath>ucastnici|uca</ElementPath>
>     <GeometryType>100</GeometryType>
>     <PropertyDefn>
>       <Name>id</Name>
>       <ElementPath>@id</ElementPath>
>       <Type>Integer</Type>
>     </PropertyDefn>
>   </GMLFeatureClass>
> </GMLFeatureClassList>
> 
> I tried:
> 
>       <ElementPath>uca at id</ElementPath>
> 
> But the attribute is still null.
> 
> When I try
> 
>     <ElementPath>ucastnici|uca</ElementPath>
> ...
>       <ElementPath>uca at id</ElementPath>

Ah, you want to get an attribute of the root element of the feature ? Hum, 
from a quick test with 

<?xml version="1.0" encoding="utf-8" ?>
<ogr:FeatureCollection
     xmlns:ogr="http://ogr.maptools.org/"
     xmlns:gml="http://www.opengis.net/gml">
  <gml:featureMember>
    <ogr:poly fid="poly.0" foo="bar">
      <baz baw="yeah"/>
    </ogr:poly>
  </gml:featureMember>
</ogr:FeatureCollection>

and

<GMLFeatureClassList>
  <GMLFeatureClass>
    <Name>poly</Name>
    <ElementPath>poly</ElementPath>
    <PropertyDefn>
      <Name>foo</Name>
      <ElementPath>@foo</ElementPath>
      <Type>String</Type>
    </PropertyDefn>
    <PropertyDefn>
      <Name>baw</Name>
      <ElementPath>baz at baw</ElementPath>
      <Type>String</Type>
    </PropertyDefn>
  </GMLFeatureClass>
</GMLFeatureClassList>

it looks indeed that the @xxxx syntax isn't supported on the root node. It 
could likely be implemented


> 
> then I am still getting 0 features.
> 
> Thanks, Martin

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From landa.martin at gmail.com  Thu Feb  4 01:46:24 2016
From: landa.martin at gmail.com (Martin Landa)
Date: Thu, 4 Feb 2016 10:46:24 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <201602041042.48512.even.rouault@spatialys.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <CA+Ei1OeAaWMmk4G0LjgN1o0r206YTBb3OrMzYHN5RnJj+btVQQ@mail.gmail.com>
 <CA+Ei1Od=ByJHCwX8101fevtamE2drHmsdEvdrzXzVp=208zJpA@mail.gmail.com>
 <201602041042.48512.even.rouault@spatialys.com>
Message-ID: <CA+Ei1OejP6f5ZBq3fNAD8C68Fvpje4HTka-nv+YTnJOYiAcSZQ@mail.gmail.com>

Hi,

2016-02-04 10:42 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> it looks indeed that the @xxxx syntax isn't supported on the root node. It
> could likely be implemented

please could you tell where I should take a look? Thanks, Ma

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From even.rouault at spatialys.com  Thu Feb  4 01:51:48 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 4 Feb 2016 10:51:48 +0100
Subject: [gdal-dev] support for Czech Exchange Format for Land
	Consolidation
In-Reply-To: <CA+Ei1OejP6f5ZBq3fNAD8C68Fvpje4HTka-nv+YTnJOYiAcSZQ@mail.gmail.com>
References: <CA+Ei1OdXVntkFOL=OamAPM3BhKg+NAXUmoPR_5sYxap5OfmacQ@mail.gmail.com>
 <201602041042.48512.even.rouault@spatialys.com>
 <CA+Ei1OejP6f5ZBq3fNAD8C68Fvpje4HTka-nv+YTnJOYiAcSZQ@mail.gmail.com>
Message-ID: <201602041051.48829.even.rouault@spatialys.com>

Le jeudi 04 février 2016 10:46:24, Martin Landa a écrit :
> Hi,
> 
> 2016-02-04 10:42 GMT+01:00 Even Rouault <even.rouault at spatialys.com>:
> > it looks indeed that the @xxxx syntax isn't supported on the root node.
> > It could likely be implemented
> 
> please could you tell where I should take a look?

Should be added in GMLHandler::startElementDefault(), probably using 
DealWithAttributes(). Admitedly this code is non-trivial.


> Thanks, Ma

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Feb  4 03:20:45 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 4 Feb 2016 13:20:45 +0200
Subject: [gdal-dev] how to get attribute values from shape layer which
 is in geoserver using gdal.
In-Reply-To: <CAMvxtC9LyRtzgorXXSL=DK3GestkgP2Wbxwx6zwSMagsx8WSyg@mail.gmail.com>
References: <CAMvxtC9LyRtzgorXXSL=DK3GestkgP2Wbxwx6zwSMagsx8WSyg@mail.gmail.com>
Message-ID: <56B3340D.2040202@gmail.com>

hema,

You can get the attribute values of a shape layer with ogrinfo:

http://www.gdal.org/ogrinfo.html

Ari

04.02.2016, 09:59, y hema kirjoitti:
> hi all,
>
>
> I have shape file loaded on geoserver. now using gdal i want the 
> attribute values of the shape layer.how can this be done.
>
>
> thanks,
> hema
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160204/545c16cd/attachment.html>

From foss4g at osgeo.org  Thu Feb  4 04:38:30 2016
From: foss4g at osgeo.org (foss4g at osgeo.org)
Date: Thu, 04 Feb 2016 13:38:30 +0100
Subject: [gdal-dev] FOSS4G 2016 Code Sprint Bonn August
Message-ID: <f2f57df24572b1e7dbb35ecb6f5e9221@foss4g2016.org>

Dear developers,

this year, once again, we are following the old tradition of hosting a 
codesprint on the FOSS4G. More precisely, we offer a setting so that  
individual projects can meet for their codesprint. Since projects 
benefit from each other as well, the codesprint will naturally be held 
conjointly at one place.
Unfortunately, circumstances have forced us to divide the codesprint 
timetable-wise.

The first part is scheduled to take place directly before the 
conference, the second immediately after. The first two and a half days 
start on Sunday, August 21, 2016 at around noon and are scheduled to end 
on Tuesday, August 23, 2016 (open end). The 2nd part starts in the 
morning of Saturday, August 27, 2016 and ends on Sunday at 12 pm.

We are happy to have found a really awesome location for you. Codesprint 
and accommodations are combined in one hall. Check out  
http://www.basecamp-bonn.com/ for details about the venue.
Working zones will be created for you in the breakfast area and 
hallways. There’s the option of finding relatively inexpensive sleeping 
accommodations in train sleeping cars, camping buses, classic cars and 
more. Additionally, an outdoor area is available for you to enjoy Bonn’s 
summer weather in August, while working. Healthy and not-so-healthy 
catering of drinks and snacks will be provided by us. Participation in 
codesprint is free of charge. However, overnight stays will have to be 
reserved and paid for by you.

Another hint: the BaseCamp is within walking distance from the 
conference venue (WCCB) and has good access to public transportation –  
the Icebreaker takes place here, too.
You see, it’s worthwhile booking here!

As the accommodations are available to all FOSS4G participants, we will 
make an effort to make advance booking possible for you a few days 
ahead, to ensure you have the opportunity to sleep on-site and wrap up 
the evenings jointly. For that, it’s necessary for you to sign up 
(https://wiki.osgeo.org/wiki/FOSS4G_2016_Code_Sprint) and leave your 
email address so that we can contact you immediately accomodation 
booking is available. We need your sign-up for the planning of snacks 
and drinks, too!

This is open to all who wish to participate in one or more projects. 
There’s always plenty to do – it’s not all about programming. 
Translation, documentation, feedback, discussions, testing – all this is 
also important for  project so everyone is cordially invited to attend 
the codesprints! Registration with the conference is not a prerequisite 
for participation in codesprint.

One thing we’d like to ask you: with an approx. 120 participants 
anticipated, the WLAN capacity will naturally be exhausted at some 
point. Please be sure to avoid huge on-site downloads of data, as this 
could impact the work of others. Thank you!

The Codesprint Organizing Team is looking forward to your coming!

Summarily:

When:
  Part I: Sun 2016-⁠⁠08-⁠⁠21 12:00 noon -⁠⁠ Tue 2016-⁠⁠08-⁠⁠23 (open end)
  Part II: Sat 2016-⁠⁠08-⁠⁠27 -⁠⁠ Sun 2016-⁠⁠08-⁠⁠28 12:00 noon

Where:

  Venue & Accommodation: BaseCamp. (For more informations: 
http://www.basecamp-bonn.com/)
  Nearby Hotel: Bonnox (http://www.bonnox.de/en/)

Questions/⁠⁠Comments/⁠⁠Ideas

  If you have questions/comments/ideas please let us know. Send an email 
to codesprint at foss4g2016.org. You are welcome!

From woklist at kyngchaos.com  Thu Feb  4 14:55:57 2016
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu, 4 Feb 2016 16:55:57 -0600
Subject: [gdal-dev] NetCDF+HDF5 and threadsafety
Message-ID: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>

I'm updating my HDF5 library and ran into a catch-22: I build my HDF5 with threadsafety (threadsafe is good, right?), and NetCDF4 requires HDF5 with the high-level library.  At HDF5 1.8.12 I could do this combination, but HDF5 1.8.16 (I think it started with 1.8.13) says threadsafe and high-level options are not compatible.

Is threadsafety in HDF5 important for GDAL?

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"Those people who most want to rule people are, ipso-facto, those least suited to do it."

- A rule of the universe, from the HitchHiker's Guide to the Galaxy



From even.rouault at spatialys.com  Thu Feb  4 15:09:59 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Feb 2016 00:09:59 +0100
Subject: [gdal-dev] NetCDF+HDF5 and threadsafety
In-Reply-To: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>
References: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>
Message-ID: <201602050010.00220.even.rouault@spatialys.com>

Le jeudi 04 février 2016 23:55:57, William Kyngesburye a écrit :
> I'm updating my HDF5 library and ran into a catch-22: I build my HDF5 with
> threadsafety (threadsafe is good, right?), and NetCDF4 requires HDF5 with
> the high-level library.  At HDF5 1.8.12 I could do this combination, but
> HDF5 1.8.16 (I think it started with 1.8.13) says threadsafe and
> high-level options are not compatible.
> 
> Is threadsafety in HDF5 important for GDAL?

Hum, likely if people use the HDF5 driver in a multi-threaded context. GDAL 
has explicit mutex around calls to the netCDF and HDF4 lib in the netCDF and 
HDF4 drivers (since at least the versions of those lib I use are not thread-
safe), but not from the HDF5 driver. So if the HDF5 lib is not re-entrant, 
there might be issues.

There's an optionnaly compiled app you can use to test threadsafety :

cd apps
make multireadtest
./multireadtest -nlo [-oi number_of_iterations] file_to_test

Increase number_of_iterations so that it runs for a few seconds.

Just testing it on my own HDF5 lib (ancient 1.8.4-5 on Ubuntu 10.04), I see 
crashes... Looking at the stacktrace, I see my HDF5 lib has however mutex 
protection, but apparently not sufficiently robust for this stress test.

> 
> -----
> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
> http://www.kyngchaos.com/
> 
> "Those people who most want to rule people are, ipso-facto, those least
> suited to do it."
> 
> - A rule of the universe, from the HitchHiker's Guide to the Galaxy
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From woklist at kyngchaos.com  Thu Feb  4 16:41:14 2016
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Thu, 4 Feb 2016 18:41:14 -0600
Subject: [gdal-dev] NetCDF+HDF5 and threadsafety
In-Reply-To: <201602050010.00220.even.rouault@spatialys.com>
References: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>
 <201602050010.00220.even.rouault@spatialys.com>
Message-ID: <364C496A-7E57-4EF9-B671-168279F7AA50@kyngchaos.com>

On Feb 4, 2016, at 5:09 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Le jeudi 04 février 2016 23:55:57, William Kyngesburye a écrit :
>> I'm updating my HDF5 library and ran into a catch-22: I build my HDF5 with
>> threadsafety (threadsafe is good, right?), and NetCDF4 requires HDF5 with
>> the high-level library.  At HDF5 1.8.12 I could do this combination, but
>> HDF5 1.8.16 (I think it started with 1.8.13) says threadsafe and
>> high-level options are not compatible.
>> 
>> Is threadsafety in HDF5 important for GDAL?
> 
> Hum, likely if people use the HDF5 driver in a multi-threaded context. GDAL 
> has explicit mutex around calls to the netCDF and HDF4 lib in the netCDF and 
> HDF4 drivers (since at least the versions of those lib I use are not thread-
> safe), but not from the HDF5 driver. So if the HDF5 lib is not re-entrant, 
> there might be issues.
> 
> There's an optionnaly compiled app you can use to test threadsafety :
> 
> cd apps
> make multireadtest
> ./multireadtest -nlo [-oi number_of_iterations] file_to_test
> 
> Increase number_of_iterations so that it runs for a few seconds.
> 
How do I trigger building that?  I see it in the source and the apps/gnumakefile, but it looks like it should build by default.

> Just testing it on my own HDF5 lib (ancient 1.8.4-5 on Ubuntu 10.04), I see 
> crashes... Looking at the stacktrace, I see my HDF5 lib has however mutex 
> protection, but apparently not sufficiently robust for this stress test.
> 
>> 
>> -----
>> William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
>> http://www.kyngchaos.com/
>> 
>> "Those people who most want to rule people are, ipso-facto, those least
>> suited to do it."
>> 
>> - A rule of the universe, from the HitchHiker's Guide to the Galaxy
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

"I ache, therefore I am.  Or in my case - I am, therefore I ache."

- Marvin



From bfraser at geoanalytic.com  Thu Feb  4 19:22:55 2016
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Thu, 4 Feb 2016 20:22:55 -0700
Subject: [gdal-dev] PDF and EXTRA_STREAM
Message-ID: <56B4158F.3030805@geoanalytic.com>

I've been experimenting with generating Geospatial PDFs with GDAL and 
would like to wrtie some extra text and lines to the PDF file. The PDF 
drive has a Create Option of EXTRA_STREAM which looks pretty good.  I 
can add text, lines and rectangles by doing:

   -co EXTRA_STREAM="BT 0 0 255 rg /FTimesRoman 50 Tf 1 0 0 1 1 1 Tm 100 
200 Td (Hello World!) Tj ET 80 260 m 80 50 l h S 0.9 0.5 0.0 rg 400 50 
300 200 re f"

But I think the length of the stream could get very long.  Any interest 
in adding another Create Option like

EXTRA_STREAM_FILE=my_stuff.txt

so I could put all the extra in a separate file?

-- 
Best Regards,
Brent Fraser



From ari.jolma at gmail.com  Fri Feb  5 00:04:00 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 5 Feb 2016 10:04:00 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
Message-ID: <56B45770.7000405@gmail.com>

I'd like to ask the PSC and others to vote on adopting RFC 61: Support 
for measured geometries.

The draft RFC is at

https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries

and a draft implementation is at

https://github.com/ajolma/GDAL-XYZM

which is tested at

https://travis-ci.org/ajolma/GDAL-XYZM

(the test #34, which passed, was the so far last one after core changes 
with unchanged autotests and a rather comprehensive set of WKT tests in 
the Perl tests directory)

This is seemingly a small change but it is at the heart of OGR so it has 
some important implications. The only backwards incompatibilities that 
have appeared so far are with some drivers, for example shapefile, which 
can be lessened with, e.g., open options.

Best,

Ari

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160205/f360136b/attachment.html>

From even.rouault at spatialys.com  Fri Feb  5 00:38:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Feb 2016 09:38:40 +0100
Subject: [gdal-dev] NetCDF+HDF5 and threadsafety
In-Reply-To: <364C496A-7E57-4EF9-B671-168279F7AA50@kyngchaos.com>
References: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>
 <201602050010.00220.even.rouault@spatialys.com>
 <364C496A-7E57-4EF9-B671-168279F7AA50@kyngchaos.com>
Message-ID: <201602050938.40831.even.rouault@spatialys.com>

Le vendredi 05 février 2016 01:41:14, William Kyngesburye a écrit :
> On Feb 4, 2016, at 5:09 PM, Even Rouault <even.rouault at spatialys.com> wrote:
> > Le jeudi 04 février 2016 23:55:57, William Kyngesburye a écrit :
> >> I'm updating my HDF5 library and ran into a catch-22: I build my HDF5
> >> with threadsafety (threadsafe is good, right?), and NetCDF4 requires
> >> HDF5 with the high-level library.  At HDF5 1.8.12 I could do this
> >> combination, but HDF5 1.8.16 (I think it started with 1.8.13) says
> >> threadsafe and high-level options are not compatible.
> >> 
> >> Is threadsafety in HDF5 important for GDAL?
> > 
> > Hum, likely if people use the HDF5 driver in a multi-threaded context.
> > GDAL has explicit mutex around calls to the netCDF and HDF4 lib in the
> > netCDF and HDF4 drivers (since at least the versions of those lib I use
> > are not thread- safe), but not from the HDF5 driver. So if the HDF5 lib
> > is not re-entrant, there might be issues.
> > 
> > There's an optionnaly compiled app you can use to test threadsafety :
> > 
> > cd apps
> > make multireadtest
> > ./multireadtest -nlo [-oi number_of_iterations] file_to_test
> > 
> > Increase number_of_iterations so that it runs for a few seconds.
> 
> How do I trigger building that? 

Just like the above mentionned lines :-) After you've initially built GDAL 
from the top directory

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb  5 00:40:43 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Feb 2016 09:40:43 +0100
Subject: [gdal-dev] PDF and EXTRA_STREAM
In-Reply-To: <56B4158F.3030805@geoanalytic.com>
References: <56B4158F.3030805@geoanalytic.com>
Message-ID: <201602050940.44176.even.rouault@spatialys.com>

Le vendredi 05 février 2016 04:22:55, Brent Fraser a écrit :
> I've been experimenting with generating Geospatial PDFs with GDAL and
> would like to wrtie some extra text and lines to the PDF file. The PDF
> drive has a Create Option of EXTRA_STREAM which looks pretty good.  I
> can add text, lines and rectangles by doing:
> 
>    -co EXTRA_STREAM="BT 0 0 255 rg /FTimesRoman 50 Tf 1 0 0 1 1 1 Tm 100
> 200 Td (Hello World!) Tj ET 80 260 m 80 50 l h S 0.9 0.5 0.0 rg 400 50
> 300 200 re f"
> 
> But I think the length of the stream could get very long.  Any interest
> in adding another Create Option like
> 
> EXTRA_STREAM_FILE=my_stuff.txt
> 
> so I could put all the extra in a separate file?

You could also use the "--optfile filename" option available in all GDAL/OGR 
utilities (bottom of http://gdal.org/gdal_utilities.html ) that appends the 
content of filename to the command line.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Feb  5 00:49:40 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 5 Feb 2016 09:49:40 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B45770.7000405@gmail.com>
References: <56B45770.7000405@gmail.com>
Message-ID: <201602050949.40544.even.rouault@spatialys.com>

Le vendredi 05 février 2016 09:04:00, Ari Jolma a écrit :
> I'd like to ask the PSC and others to vote on adopting RFC 61: Support
> for measured geometries.

+1

> 
> The draft RFC is at
> 
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> 
> and a draft implementation is at
> 
> https://github.com/ajolma/GDAL-XYZM
> 
> which is tested at
> 
> https://travis-ci.org/ajolma/GDAL-XYZM
> 
> (the test #34, 

What is test #34 ?

> which passed, was the so far last one after core changes
> with unchanged autotests and a rather comprehensive set of WKT tests in
> the Perl tests directory)
> 

I see some failures in latest build, apparently related to -nlt POLYGON25D / -
lco SHPT=POLYGONZ in the shapefile driver

https://s3.amazonaws.com/archive.travis-ci.org/jobs/107177078/log.txt

 ------------ Failures ------------
Script: utilities/test_ogr2ogr_lib.py
  TEST: test_ogr2ogr_lib_7 ... fail
Script: utilities/test_gdal_grid_lib.py
  TEST: test_gdal_grid_lib_1 ... fail
Script: utilities/test_ogr2ogr.py
  TEST: test_ogr2ogr_11 ... fail
  TEST: test_ogr2ogr_12 ... fail
  TEST: test_ogr2ogr_43 ... fail
Script: pyscripts/test_ogr2ogr_py.py
  TEST: test_ogr2ogr_py_11 ... fail
  TEST: test_ogr2ogr_py_12 ... fail
  TEST: test_ogr2ogr_py_43 ... fail
 ----------------------------------

> This is seemingly a small change but it is at the heart of OGR so it has
> some important implications. The only backwards incompatibilities that
> have appeared so far are with some drivers, for example shapefile, which
> can be lessened with, e.g., open options.
> 
> Best,
> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Fri Feb  5 01:34:11 2016
From: szekerest at gmail.com (Tamas Szekeres)
Date: Fri, 5 Feb 2016 10:34:11 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B45770.7000405@gmail.com>
References: <56B45770.7000405@gmail.com>
Message-ID: <CACALY+Qv0e+_Fz+82r38X=XWNS2Ek5jSNU2gamvGZxVtvakbDg@mail.gmail.com>

+1

I'll update the mssql spatial driver accordingly.

Best regards,

Tamas


2016-02-05 9:04 GMT+01:00 Ari Jolma <ari.jolma at gmail.com>:

> I'd like to ask the PSC and others to vote on adopting RFC 61:  Support
> for measured geometries.
>
> The draft RFC is at
>
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>
> and a draft implementation is at
>
> https://github.com/ajolma/GDAL-XYZM
>
> which is tested at
>
> https://travis-ci.org/ajolma/GDAL-XYZM
>
> (the test #34, which passed, was the so far last one after core changes
> with unchanged autotests and a rather comprehensive set of WKT tests in the
> Perl tests directory)
>
> This is seemingly a small change but it is at the heart of OGR so it has
> some important implications. The only backwards incompatibilities that have
> appeared so far are with some drivers, for example shapefile, which can be
> lessened with, e.g., open options.
>
> Best,
>
> Ari
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160205/52bfbaa3/attachment-0001.html>

From ari.jolma at gmail.com  Fri Feb  5 03:57:06 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 5 Feb 2016 13:57:06 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602050949.40544.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com>
 <201602050949.40544.even.rouault@spatialys.com>
Message-ID: <56B48E12.1020409@gmail.com>



05.02.2016, 10:49, Even Rouault kirjoitti:
> Le vendredi 05 février 2016 09:04:00, Ari Jolma a écrit :
>> I'd like to ask the PSC and others to vote on adopting RFC 61: Support
>> for measured geometries.
> +1
>
>> The draft RFC is at
>>
>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>
>> and a draft implementation is at
>>
>> https://github.com/ajolma/GDAL-XYZM
>>
>> which is tested at
>>
>> https://travis-ci.org/ajolma/GDAL-XYZM
>>
>> (the test #34,
> What is test #34 ?

https://travis-ci.org/ajolma/GDAL-XYZM/builds/106980691

...it has #34


>
>> which passed, was the so far last one after core changes
>> with unchanged autotests and a rather comprehensive set of WKT tests in
>> the Perl tests directory)
>>
> I see some failures in latest build, apparently related to -nlt POLYGON25D / -
> lco SHPT=POLYGONZ in the shapefile driver

Yes, it fails now since the shapefile driver is partially implemented - 
only points and linestrings so far.

I made it skip one test in ogr_shape.py, which relied on the M to Z hacks.


>
> https://s3.amazonaws.com/archive.travis-ci.org/jobs/107177078/log.txt
>
>   ------------ Failures ------------
> Script: utilities/test_ogr2ogr_lib.py
>    TEST: test_ogr2ogr_lib_7 ... fail
> Script: utilities/test_gdal_grid_lib.py
>    TEST: test_gdal_grid_lib_1 ... fail
> Script: utilities/test_ogr2ogr.py
>    TEST: test_ogr2ogr_11 ... fail
>    TEST: test_ogr2ogr_12 ... fail
>    TEST: test_ogr2ogr_43 ... fail
> Script: pyscripts/test_ogr2ogr_py.py
>    TEST: test_ogr2ogr_py_11 ... fail
>    TEST: test_ogr2ogr_py_12 ... fail
>    TEST: test_ogr2ogr_py_43 ... fail
>   ----------------------------------
>
>> This is seemingly a small change but it is at the heart of OGR so it has
>> some important implications. The only backwards incompatibilities that
>> have appeared so far are with some drivers, for example shapefile, which
>> can be lessened with, e.g., open options.
>>
>> Best,
>>
>> Ari


From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb  5 05:33:01 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 5 Feb 2016 13:33:01 +0000 (UTC)
Subject: [gdal-dev] RFC 61: Call for vote on adoption
References: <56B45770.7000405@gmail.com>
Message-ID: <loom.20160205T132216-952@post.gmane.org>

Ari Jolma <ari.jolma <at> gmail.com> writes:

> 
> 
>     I'd like to ask the PSC and others to vote on adopting RFC 61: 
>     
>     Support for measured geometries.

+1

-Jukka Rahkonen-

From paulopires16 at gmail.com  Fri Feb  5 11:02:07 2016
From: paulopires16 at gmail.com (Paulo Pires)
Date: Fri, 5 Feb 2016 11:02:07 -0800 (PST)
Subject: [gdal-dev] Change resolution tiff image
Message-ID: <1454698927074-5249156.post@n6.nabble.com>

Hello,

I tried to change resolution (dpi) from a raster cmyk file without soccess

Is it possible? Change for example 508 to 254 dpi and mantein cmyk mode

Thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Change-resolution-tiff-image-tp5249156.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From lucena_ivan at hotmail.com  Fri Feb  5 11:24:06 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Fri, 5 Feb 2016 19:24:06 +0000
Subject: [gdal-dev] fail to building GDAL in AIX 7.1
Message-ID: <BLUPR19MB014570D9626D02EFB07A3FD4F2D20@BLUPR19MB0145.namprd19.prod.outlook.com>

I am getting this error:


/usr/local/remote/packages/gcc_remote/4.2.1/bin/../lib/gcc/powerpc-ibm-aix5.2.0.0/4.2.1/../../../../include/c++/4.2.1/cmath:447: error: 'long double std::tanh(long double)' conflicts with previous using declaration 'long double tanh(long double)'
gdalwarpkernel.cpp: In function 'void GWKAverageOrModeThread(void*)':
gdalwarpkernel.cpp:5017: error: call of overloaded 'ceil(float)' is ambiguous
/usr/include/math.h:975: note: candidates are: long double ceil(long double)
/usr/include/math.h:945: note:                 float ceil(float)
/usr/include/math.h:345: note:                 double ceil(double)


I don't get this error when building with gcc 4.7.1 in a Linux 64 Intel environment.


Is this error related to the gcc version or AIX? Any suggestions?


Regards,


Ivan



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160205/8e96308b/attachment.html>

From sean at mapbox.com  Sat Feb  6 08:00:45 2016
From: sean at mapbox.com (Sean Gillies)
Date: Sat, 6 Feb 2016 09:00:45 -0700
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B45770.7000405@gmail.com>
References: <56B45770.7000405@gmail.com>
Message-ID: <CADPhZXzLMbY2o6ovhaBRhfmkFkoM0Vcdvg7fbOBio+zMawJp7A@mail.gmail.com>

Hi Ari,

On Fri, Feb 5, 2016 at 1:04 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

> I'd like to ask the PSC and others to vote on adopting RFC 61:  Support
> for measured geometries.
>
> The draft RFC is at
>
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>
> and a draft implementation is at
>
> https://github.com/ajolma/GDAL-XYZM
>
> which is tested at
>
> https://travis-ci.org/ajolma/GDAL-XYZM
>
> (the test #34, which passed, was the so far last one after core changes
> with unchanged autotests and a rather comprehensive set of WKT tests in the
> Perl tests directory)
>
> This is seemingly a small change but it is at the heart of OGR so it has
> some important implications. The only backwards incompatibilities that have
> appeared so far are with some drivers, for example shapefile, which can be
> lessened with, e.g., open options.
>

Can you explain more in detail about the backwards incompatibilities and
how to soften them? What's going to break and what are the specific options?

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160206/a04b5628/attachment.html>

From even.rouault at spatialys.com  Sat Feb  6 12:16:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 6 Feb 2016 21:16:34 +0100
Subject: [gdal-dev] GDAL Agenda for Paris Code Sprint
Message-ID: <201602062116.34844.even.rouault@spatialys.com>

Hi,

I've initialited a GDAL related agenda for the OSGeo Code Sprint with a few 
topics I've in mind.

https://wiki.osgeo.org/wiki/Paris_Code_Sprint_2016_:_GDAL_Agenda

Please add yours. Even if you don't plan to attend, feel free to suggest 
topics.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Feb  7 00:29:34 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 7 Feb 2016 09:29:34 +0100
Subject: [gdal-dev] fail to building GDAL in AIX 7.1
In-Reply-To: <BLUPR19MB014570D9626D02EFB07A3FD4F2D20@BLUPR19MB0145.namprd19.prod.outlook.com>
References: <BLUPR19MB014570D9626D02EFB07A3FD4F2D20@BLUPR19MB0145.namprd19.prod.outlook.com>
Message-ID: <201602070929.34322.even.rouault@spatialys.com>

Le vendredi 05 février 2016 20:24:06, Ivan Lucena a écrit :
> I am getting this error:
> 
> 
> /usr/local/remote/packages/gcc_remote/4.2.1/bin/../lib/gcc/powerpc-ibm-aix5
> .2.0.0/4.2.1/../../../../include/c++/4.2.1/cmath:447: error: 'long double
> std::tanh(long double)' conflicts with previous using declaration 'long
> double tanh(long double)' gdalwarpkernel.cpp: In function 'void
> GWKAverageOrModeThread(void*)': gdalwarpkernel.cpp:5017: error: call of
> overloaded 'ceil(float)' is ambiguous /usr/include/math.h:975: note:
> candidates are: long double ceil(long double) /usr/include/math.h:945:
> note:                 float ceil(float)
> /usr/include/math.h:345: note:                 double ceil(double)
> 
> 
> I don't get this error when building with gcc 4.7.1 in a Linux 64 Intel
> environment.
> 
> 
> Is this error related to the gcc version or AIX? Any suggestions?

Perhaps some incompatibility betwenn GCC cmath header and
AIX /usr/include/math.h ?
You could try removing #include <cmath> in that file and replacing
the use of std::ceil() with just ceil(). This still builds on x86 :

Index: alg/gdalwarpkernel.cpp
===================================================================
--- alg/gdalwarpkernel.cpp	(revision 33113)
+++ alg/gdalwarpkernel.cpp	(working copy)
@@ -32,7 +32,6 @@
 
 #include <vector>
 #include <algorithm>
-#include <cmath>
 #include <cfloat>
 #include "gdalwarper.h"
 #include "gdal_alg_priv.h"
@@ -5014,7 +5013,7 @@
                     if ( nCount > 0 )
                     {
                         std::sort(dfValuesTmp.begin(), dfValuesTmp.end());
-                        int quantIdx = std::ceil(quant * dfValuesTmp.size() - 1);
+                        int quantIdx = ceil(quant * dfValuesTmp.size() - 1);
                         dfValueReal = dfValuesTmp[quantIdx];
 
                         dfBandDensity = 1;

But this is a sign that the compilation environment is not sane and you
may have other issues elsewhere, and you'd likely get even more problems with trunk

gcc 4.2 is very ancient. Perhaps you need to upgrade to a more recent version
to get it working on AIX. Looking at
http://www.perzl.org/aix/index.php?n=Main.Gcc , gcc 4.2 & AIX 7.1 doesn't look as a
supported combination (at least not by this site)


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Feb  7 01:04:07 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 7 Feb 2016 10:04:07 +0100
Subject: [gdal-dev] Change resolution tiff image
In-Reply-To: <1454698927074-5249156.post@n6.nabble.com>
References: <1454698927074-5249156.post@n6.nabble.com>
Message-ID: <201602071004.07123.even.rouault@spatialys.com>

Le vendredi 05 février 2016 20:02:07, Paulo Pires a écrit :
> Hello,
> 
> I tried to change resolution (dpi) from a raster cmyk file without soccess
> 
> Is it possible? Change for example 508 to 254 dpi and mantein cmyk mode

Paulo,

Yes, with something like :

gdal_translate GTIFF_RAW:in.tif out.tif -co PHOTOMETRIC=CMYK [other switches]

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrea.aime at geo-solutions.it  Sun Feb  7 02:56:05 2016
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Sun, 7 Feb 2016 11:56:05 +0100
Subject: [gdal-dev] What does "per dataset alpha" mean?
Message-ID: <CA+nxMTu8XtWDnOx34FPTH=XseXjnbQUNNk6C3m_Jy8BLGGfThA@mail.gmail.com>

Hi,
I'm looking at a geotiff file that has the following band information:

Band 1 Block=256x8 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=256x8 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=256x8 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=256x8 Type=Byte, ColorInterp=Alpha

I'm not sure what a "mask with per dataset alpha" means.... if I had to
venture a guess,
it looks like each band has its own private extra information as a sidecar
8 bit band.
(but if it's the case, why have a alpha band, with its own per dataset
alpha?).

tiffinfo also just reports 4 samples per pixel:

> tiffinfo /tmp/gwc_test.tiff
TIFFReadDirectory: Warning, Unknown field with tag 33550 (0x830e)
encountered.
TIFFReadDirectory: Warning, Unknown field with tag 33922 (0x8482)
encountered.
TIFFReadDirectory: Warning, Unknown field with tag 34735 (0x87af)
encountered.
TIFFReadDirectory: Warning, Unknown field with tag 34737 (0x87b1)
encountered.
TIFF Directory at offset 0x8 (8)
  Image Width: 2048 Image Length: 1096
  Bits/Sample: 8
  Sample Format: unsigned integer
  Compression Scheme: LZW
  Photometric Interpretation: RGB color
  Extra Samples: 1<unassoc-alpha>
  Samples/Pixel: 4
  Rows/Strip: 1
  Planar Configuration: single image plane
  Tag 33550: 0.008343,0.008343,0.000000
  Tag 33922:
0.000000,0.000000,0.000000,492999.995534,5878229.148718,0.000000
  Tag 34735:
1,1,0,7,1024,0,1,1,1025,0,1,1,1026,34737,22,0,2049,34737,7,22,2054,0,1,9102,3072,0,1,32632,3076,0,1,9001
  Tag 34737: WGS 84 / UTM zone 32N|WGS 84|
  Predictor: none 1 (0x1)

Also wondering, if this "per dataset alpha" a GDAL specific extension, or
is it part of the TIFF standard?
Looking at the spec it might be related to the ExtraSamples tag, but I'm
understanding how
it related with the above band interpretation.

Cheers
Andrea

-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/it488V for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via Poggio alle Viti 1187
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

*AVVERTENZE AI SENSI DEL D.Lgs. 196/2003*

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.



The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160207/01a2a2b2/attachment.html>

From even.rouault at spatialys.com  Sun Feb  7 03:01:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 7 Feb 2016 12:01:33 +0100
Subject: [gdal-dev] What does "per dataset alpha" mean?
In-Reply-To: <CA+nxMTu8XtWDnOx34FPTH=XseXjnbQUNNk6C3m_Jy8BLGGfThA@mail.gmail.com>
References: <CA+nxMTu8XtWDnOx34FPTH=XseXjnbQUNNk6C3m_Jy8BLGGfThA@mail.gmail.com>
Message-ID: <201602071201.33996.even.rouault@spatialys.com>

Andrea,

This relates to https://trac.osgeo.org/gdal/wiki/rfc15_nodatabitmask . 
Basically in the GDAL abstraction, each band can have its (possibly own 
dedicated) mask band. The flag "PER_DATASET ALPHA" means that the mask band is 
in fact shared by all bands, and it is an alpha band (some formats may have 
only a mask with binary 0/255 values). A "classic" alpha channel to say things 
otherwise. 

Like in the case of this TIFF file with an "unassoc-alpha" extrasample channel.

Even

> Hi,
> I'm looking at a geotiff file that has the following band information:
> 
> Band 1 Block=256x8 Type=Byte, ColorInterp=Red
>   Mask Flags: PER_DATASET ALPHA
> Band 2 Block=256x8 Type=Byte, ColorInterp=Green
>   Mask Flags: PER_DATASET ALPHA
> Band 3 Block=256x8 Type=Byte, ColorInterp=Blue
>   Mask Flags: PER_DATASET ALPHA
> Band 4 Block=256x8 Type=Byte, ColorInterp=Alpha
> 
> I'm not sure what a "mask with per dataset alpha" means.... if I had to
> venture a guess,
> it looks like each band has its own private extra information as a sidecar
> 8 bit band.
> (but if it's the case, why have a alpha band, with its own per dataset
> alpha?).
> 
> tiffinfo also just reports 4 samples per pixel:
> > tiffinfo /tmp/gwc_test.tiff
> 
> TIFFReadDirectory: Warning, Unknown field with tag 33550 (0x830e)
> encountered.
> TIFFReadDirectory: Warning, Unknown field with tag 33922 (0x8482)
> encountered.
> TIFFReadDirectory: Warning, Unknown field with tag 34735 (0x87af)
> encountered.
> TIFFReadDirectory: Warning, Unknown field with tag 34737 (0x87b1)
> encountered.
> TIFF Directory at offset 0x8 (8)
>   Image Width: 2048 Image Length: 1096
>   Bits/Sample: 8
>   Sample Format: unsigned integer
>   Compression Scheme: LZW
>   Photometric Interpretation: RGB color
>   Extra Samples: 1<unassoc-alpha>
>   Samples/Pixel: 4
>   Rows/Strip: 1
>   Planar Configuration: single image plane
>   Tag 33550: 0.008343,0.008343,0.000000
>   Tag 33922:
> 0.000000,0.000000,0.000000,492999.995534,5878229.148718,0.000000
>   Tag 34735:
> 1,1,0,7,1024,0,1,1,1025,0,1,1,1026,34737,22,0,2049,34737,7,22,2054,0,1,9102
> ,3072,0,1,32632,3076,0,1,9001 Tag 34737: WGS 84 / UTM zone 32N|WGS 84|
>   Predictor: none 1 (0x1)
> 
> Also wondering, if this "per dataset alpha" a GDAL specific extension, or
> is it part of the TIFF standard?
> Looking at the spec it might be related to the ExtraSamples tag, but I'm
> understanding how
> it related with the above band interpretation.
> 
> Cheers
> Andrea

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From piotrpachol at gmail.com  Sun Feb  7 14:08:29 2016
From: piotrpachol at gmail.com (=?UTF-8?B?UGlvdHIgUGFjaMOzxYI=?=)
Date: Sun, 7 Feb 2016 23:08:29 +0100
Subject: [gdal-dev] pdf file - raster and vector differences
In-Reply-To: <n8qpkd$odf$1@ger.gmane.org>
References: <56B0BF2E.1090205@gmail.com> <n8qpkd$odf$1@ger.gmane.org>
Message-ID: <56B7C05D.8070401@gmail.com>

Hello,

Some types of vector pdf files are not recognizeable by ogrinfo command.
For instance pdf made by Acrobat Distiller. For example file: 
https://en.wikipedia.org/wiki/File:APISmap1.pdf
So is it possible by means of gdal tools to recognize that pdf like that 
is vectorial ?

Regards,
Piotr

W dniu 2016-02-02 o 18:35, Andre Joost pisze:
> Am 02.02.2016 um 15:37 schrieb Piotr Pachół:
>> Hello,
>>
>> I would like to ask If there is a way (by means of gdal tools) to
>> recognize that pdf has vector features ?
>> I have hundreds of geospatial pdf files (raster and vector) and I don't
>> want  to open each of file in Acrobat Reader to verify if it is raster
>> or vector.
>> Instead I would like to make a script to produce result in text files,
>> which I can later process automatically.
>> I must add that in standard result of gdalinfo command I can't see any
>> difference between raster and vector pdf file.
>>
>
> Apart from gdalinfo you can run ogrinfo on the files, which will only 
> return vector layers.
>
> See my answer here for an example:
>
> http://gis.stackexchange.com/questions/156299/how-to-have-gdal-print-layers-of-geopdf-and-say-which-are-raster-vs-vector 
>
>
> gdalinfo also reports meta layers, which only consist of sublayers 
> (vector or raster or both), without own data.
>
> HTH,
> André Joost
>


From ari.jolma at gmail.com  Sun Feb  7 23:17:28 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 8 Feb 2016 09:17:28 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <CADPhZXzLMbY2o6ovhaBRhfmkFkoM0Vcdvg7fbOBio+zMawJp7A@mail.gmail.com>
References: <56B45770.7000405@gmail.com>
 <CADPhZXzLMbY2o6ovhaBRhfmkFkoM0Vcdvg7fbOBio+zMawJp7A@mail.gmail.com>
Message-ID: <56B84108.3040505@gmail.com>

06.02.2016, 18:00, Sean Gillies kirjoitti:
>
>
> Can you explain more in detail about the backwards incompatibilities 
> and how to soften them? What's going to break and what are the 
> specific options?

Hi Sean,

In the C++ and C API there are no backwards incompatibilities but the 
get/setCoordinateDimension() methods become deprecated since XYM and XYZ 
have the same dimension.  Is3D(), IsMeasured(), set3D(), and 
setMeasured() should be used instead.

I don't know about the other drivers but Shapefile driver currently 
reads XYM geometries as XYZ and that will be changed so that XYM are 
read as XYM. I think that is the only incompatibility. A new open option 
MEASURE_AS_Z=YES/NO (or something) can be defined for backwards 
compatibility. Similar option can be defined for other drivers if they 
have the same feature.

Ari

ps: Sorry for the late answer, I was offline the weekend.

>
> -- 
> Sean Gillies


From even.rouault at spatialys.com  Mon Feb  8 00:54:22 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 8 Feb 2016 09:54:22 +0100
Subject: [gdal-dev] pdf file - raster and vector differences
In-Reply-To: <56B7C05D.8070401@gmail.com>
References: <56B0BF2E.1090205@gmail.com> <n8qpkd$odf$1@ger.gmane.org>
 <56B7C05D.8070401@gmail.com>
Message-ID: <201602080954.22570.even.rouault@spatialys.com>

Le dimanche 07 février 2016 23:08:29, Piotr Pachół a écrit :
> Hello,
> 
> Some types of vector pdf files are not recognizeable by ogrinfo command.
> For instance pdf made by Acrobat Distiller. For example file:
> https://en.wikipedia.org/wiki/File:APISmap1.pdf
> So is it possible by means of gdal tools to recognize that pdf like that
> is vectorial ?

Piotr,

Quoting the doc http://gdal.org/frmt_pdf.html, the PDF driver can """read 
vector features encoded according to PDF's logical structure facilities (as 
described by "§10.6 - Logical Structure" of PDF spec 
http://www.adobe.com/devnet/acrobat/pdfs/pdf_reference_1-7.pdf), or retrieve 
only vector geometries for other vector PDF files."""
Actually looking closer, the current code is a bit more restrictive than the 
above sentence, and apparently it doesn't read that file since it has no 
explicit layer in it. I don't recall if it is for a fundamental reason or not. 
Anyway the best you'd get is non georeferenced vector features, as this PDF 
file doesn't use any geospatial registration mechanism.

Even

> 
> Regards,
> Piotr
> 
> W dniu 2016-02-02 o 18:35, Andre Joost pisze:
> > Am 02.02.2016 um 15:37 schrieb Piotr Pachół:
> >> Hello,
> >> 
> >> I would like to ask If there is a way (by means of gdal tools) to
> >> recognize that pdf has vector features ?
> >> I have hundreds of geospatial pdf files (raster and vector) and I don't
> >> want  to open each of file in Acrobat Reader to verify if it is raster
> >> or vector.
> >> Instead I would like to make a script to produce result in text files,
> >> which I can later process automatically.
> >> I must add that in standard result of gdalinfo command I can't see any
> >> difference between raster and vector pdf file.
> > 
> > Apart from gdalinfo you can run ogrinfo on the files, which will only
> > return vector layers.
> > 
> > See my answer here for an example:
> > 
> > http://gis.stackexchange.com/questions/156299/how-to-have-gdal-print-laye
> > rs-of-geopdf-and-say-which-are-raster-vs-vector
> > 
> > 
> > gdalinfo also reports meta layers, which only consist of sublayers
> > (vector or raster or both), without own data.
> > 
> > HTH,
> > André Joost
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Feb  8 01:04:55 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 8 Feb 2016 10:04:55 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B84108.3040505@gmail.com>
References: <56B45770.7000405@gmail.com>
 <CADPhZXzLMbY2o6ovhaBRhfmkFkoM0Vcdvg7fbOBio+zMawJp7A@mail.gmail.com>
 <56B84108.3040505@gmail.com>
Message-ID: <201602081004.55852.even.rouault@spatialys.com>

Le lundi 08 février 2016 08:17:28, vous avez écrit :
> 06.02.2016, 18:00, Sean Gillies kirjoitti:
> > Can you explain more in detail about the backwards incompatibilities
> > and how to soften them? What's going to break and what are the
> > specific options?
> 
> Hi Sean,
> 
> In the C++ and C API there are no backwards incompatibilities but the
> get/setCoordinateDimension() methods become deprecated since XYM and XYZ
> have the same dimension.  Is3D(), IsMeasured(), set3D(), and
> setMeasured() should be used instead.
> 
> I don't know about the other drivers but Shapefile driver currently
> reads XYM geometries as XYZ and that will be changed so that XYM are
> read as XYM. I think that is the only incompatibility. A new open option
> MEASURE_AS_Z=YES/NO (or something) can be defined for backwards
> compatibility. 

I don't think there's a strong need for such an option without confirmation 
from users. The XYM support as XYZ was really a hack (people had no way to 
know if the XYZ was XYM or XYZ, unless they read the .shp/.shx themselves). 
And it is not clear how that would work in update scenarios (currently the M/Z 
is discarded on update :  https://trac.osgeo.org/gdal/ticket/6331 )

Pirmin: as I see from https://trac.osgeo.org/gdal/ticket/2374 you were the one 
to contribute the patch, what is your opinion on this ?

> Similar option can be defined for other drivers if they
> have the same feature.

I believe all other drivers currently discard the M values

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pi_ml at sourcepole.com  Mon Feb  8 02:31:09 2016
From: pi_ml at sourcepole.com (Pirmin Kalberer)
Date: Mon, 08 Feb 2016 11:31:09 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602081004.55852.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56B84108.3040505@gmail.com>
 <201602081004.55852.even.rouault@spatialys.com>
Message-ID: <1459207.7PT8yCpJMV@robbe2>

Hi,

Am Montag, 8. Februar 2016, 10.04:55 schrieb Even Rouault:
> Le lundi 08 février 2016 08:17:28, vous avez écrit :
> > 06.02.2016, 18:00, Sean Gillies kirjoitti:
> > > Can you explain more in detail about the backwards incompatibilities
> > > and how to soften them? What's going to break and what are the
> > > specific options?
> > 
> > Hi Sean,
> > 
> > In the C++ and C API there are no backwards incompatibilities but the
> > get/setCoordinateDimension() methods become deprecated since XYM and XYZ
> > have the same dimension.  Is3D(), IsMeasured(), set3D(), and
> > setMeasured() should be used instead.
> > 
> > I don't know about the other drivers but Shapefile driver currently
> > reads XYM geometries as XYZ and that will be changed so that XYM are
> > read as XYM. I think that is the only incompatibility. A new open option
> > MEASURE_AS_Z=YES/NO (or something) can be defined for backwards
> > compatibility.
> 
> I don't think there's a strong need for such an option without confirmation
> from users. The XYM support as XYZ was really a hack (people had no way to
> know if the XYZ was XYM or XYZ, unless they read the .shp/.shx themselves).
> And it is not clear how that would work in update scenarios (currently the
> M/Z is discarded on update :  https://trac.osgeo.org/gdal/ticket/6331 )
> 
> Pirmin: as I see from https://trac.osgeo.org/gdal/ticket/2374 you were the
> one to contribute the patch, what is your opinion on this ?

Completeley forgot that... We had a customer request for accessing M values in 
Shapefiles from QGIS and the result was this hacky solution.
In my opinion we can live without a compatibilty switch to this intermediate 
solution when a proper API for XYZM is provided. It will be easy to adapt that 
in a coming version of QGIS (update would be needed also for setting the 
compatibility switch) and in the meantime they have to stay on their GDAL 
version (what they usually do anyway). So an incompatibility warning in the 
release notes would be enough for me.

Regards
Pirmin

-- 
Pirmin Kalberer
Sourcepole  -  Linux & Open Source Solutions
http://www.sourcepole.com


From emmanuel.sambale at gmail.com  Mon Feb  8 03:55:34 2016
From: emmanuel.sambale at gmail.com (maning sambale)
Date: Mon, 8 Feb 2016 17:25:34 +0530
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
Message-ID: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>

Hi,

I'm trying to convert LA City building data from State Plane to EPSG:4326.
I converted the data using ogr2ogr.  Visually inspecting using Bing
imagery, I'm seeing an offset.

Details of SRS info and sample images here:
https://gist.github.com/maning/093a866fd465ea880032

It is possible that Bing has the offset, but the source of Bing comes
from LARIAC (Los Angeles Region Imagery Acquisition Consortium)
imagery, the same source as the building footprints were traced.

Any hints on the "proper" conversion from State Plane to EPSG:4326.

-- 
cheers,
maning
------------------------------------------------------
"Freedom is still the most radical idea of all" -N.Branden
https://epsg4253.wordpress.com/
http://twitter.com/maningsambale
------------------------------------------------------

From lucena_ivan at hotmail.com  Mon Feb  8 06:00:49 2016
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 8 Feb 2016 14:00:49 +0000
Subject: [gdal-dev] fail to building GDAL in AIX 7.1
In-Reply-To: <201602070929.34322.even.rouault@spatialys.com>
References: <BLUPR19MB014570D9626D02EFB07A3FD4F2D20@BLUPR19MB0145.namprd19.prod.outlook.com>,
 <201602070929.34322.even.rouault@spatialys.com>
Message-ID: <BLUPR19MB01453E0C38718AF5F7D8876CF2D40@BLUPR19MB0145.namprd19.prod.outlook.com>

Hi Even,

I switched to GCC 4.7.1 and I applied the tips from here: 

http://grasswiki.osgeo.org/wiki/Talk:Compile_and_Install#AIX_7.x_compilation_hints

One think I added to the compiler option is -maix64 but I am still getting some errors:

In file included from cpl_vsi.h:61:0,
                 from cpl_conv.h:36,
                 from cpl_conv.cpp:33:
/usr/include/unistd.h:1042:23: error: 'rid_t' was not declared in this scope
/usr/include/unistd.h:1042:30: error: expected primary-expression before ']' token
/usr/include/unistd.h:1042:33: error: expected primary-expression before 'int'
/usr/include/unistd.h:1042:36: error: expression list treated as compound expression in initializer [-fpermissive]
/usr/include/unistd.h:1043:30: error: 'rid_t' has not been declared

It looks manageable. Let's see how it goes from here.

Thanks,
Ivan





________________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Sunday, February 7, 2016 3:29 AM
To: gdal-dev at lists.osgeo.org
Cc: Ivan Lucena
Subject: Re: [gdal-dev] fail to building GDAL in AIX 7.1

Le vendredi 05 février 2016 20:24:06, Ivan Lucena a écrit :
> I am getting this error:
>
>
> /usr/local/remote/packages/gcc_remote/4.2.1/bin/../lib/gcc/powerpc-ibm-aix5
> .2.0.0/4.2.1/../../../../include/c++/4.2.1/cmath:447: error: 'long double
> std::tanh(long double)' conflicts with previous using declaration 'long
> double tanh(long double)' gdalwarpkernel.cpp: In function 'void
> GWKAverageOrModeThread(void*)': gdalwarpkernel.cpp:5017: error: call of
> overloaded 'ceil(float)' is ambiguous /usr/include/math.h:975: note:
> candidates are: long double ceil(long double) /usr/include/math.h:945:
> note:                 float ceil(float)
> /usr/include/math.h:345: note:                 double ceil(double)
>
>
> I don't get this error when building with gcc 4.7.1 in a Linux 64 Intel
> environment.
>
>
> Is this error related to the gcc version or AIX? Any suggestions?

Perhaps some incompatibility betwenn GCC cmath header and
AIX /usr/include/math.h ?
You could try removing #include <cmath> in that file and replacing
the use of std::ceil() with just ceil(). This still builds on x86 :

Index: alg/gdalwarpkernel.cpp
===================================================================
--- alg/gdalwarpkernel.cpp      (revision 33113)
+++ alg/gdalwarpkernel.cpp      (working copy)
@@ -32,7 +32,6 @@

 #include <vector>
 #include <algorithm>
-#include <cmath>
 #include <cfloat>
 #include "gdalwarper.h"
 #include "gdal_alg_priv.h"
@@ -5014,7 +5013,7 @@
                     if ( nCount > 0 )
                     {
                         std::sort(dfValuesTmp.begin(), dfValuesTmp.end());
-                        int quantIdx = std::ceil(quant * dfValuesTmp.size() - 1);
+                        int quantIdx = ceil(quant * dfValuesTmp.size() - 1);
                         dfValueReal = dfValuesTmp[quantIdx];

                         dfBandDensity = 1;

But this is a sign that the compilation environment is not sane and you
may have other issues elsewhere, and you'd likely get even more problems with trunk

gcc 4.2 is very ancient. Perhaps you need to upgrade to a more recent version
to get it working on AIX. Looking at
http://www.perzl.org/aix/index.php?n=Main.Gcc , gcc 4.2 & AIX 7.1 doesn't look as a
supported combination (at least not by this site)


Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmfenton at gmail.com  Mon Feb  8 06:54:11 2016
From: dmfenton at gmail.com (Daniel Fenton)
Date: Mon, 08 Feb 2016 14:54:11 +0000
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
In-Reply-To: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
References: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
Message-ID: <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>

Hi Maning,

For NAD83 you need to convert the Datum to WGS84. The WKT string you show
does not include that conversion. Proj.4 is missing these in a lot of cases.

Try this string instead:

PROJCS["NAD83_California_zone_5_ftUS",GEOGCS["GCS_North_American_1983",DATUM["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],TOWGS84[-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062],PRIMEM["Greenwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal_Conic"],PARAMETER["standard_parallel_1",35.46666666666667],PARAMETER["standard_parallel_2",34.03333333333333],PARAMETER["latitude_of_origin",33.5],PARAMETER["central_meridian",-118],PARAMETER["false_easting",6561666.667],PARAMETER["false_northing",1640416.667],UNIT["Foot_US",0.30480060960121924]]

Hopefully that works for you. Let me know if it doesn't.

Daniel Fenton
Software Engineer
Esri R&D

On Mon, Feb 8, 2016 at 6:56 AM maning sambale <emmanuel.sambale at gmail.com>
wrote:

> Hi,
>
> I'm trying to convert LA City building data from State Plane to EPSG:4326.
> I converted the data using ogr2ogr.  Visually inspecting using Bing
> imagery, I'm seeing an offset.
>
> Details of SRS info and sample images here:
> https://gist.github.com/maning/093a866fd465ea880032
>
> It is possible that Bing has the offset, but the source of Bing comes
> from LARIAC (Los Angeles Region Imagery Acquisition Consortium)
> imagery, the same source as the building footprints were traced.
>
> Any hints on the "proper" conversion from State Plane to EPSG:4326.
>
> --
> cheers,
> maning
> ------------------------------------------------------
> "Freedom is still the most radical idea of all" -N.Branden
> https://epsg4253.wordpress.com/
> http://twitter.com/maningsambale
> ------------------------------------------------------
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160208/8e2f4acc/attachment.html>

From cgodkin at gmail.com  Mon Feb  8 07:01:27 2016
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 8 Feb 2016 07:01:27 -0800
Subject: [gdal-dev] Building multiple versions of GDAL from the same tree...
Message-ID: <CAE=8km=Q79VK+vHmotFrFYEYHk2o1cbCwoavVk4pkMiJ6jPZWg@mail.gmail.com>

Hi,

With a shiny new version of GDAL now available (thanks!), I'm wondering
about a problem with the builds that I always have but have never asked
about before.

Since I need to build several Linux variants of various third party
libraries, I can usually persuade "configure" and make to work from a
sub-directory like this:

cd library && mkdir version1 && cd version1
../configure options...
make

followed by

cd library && mkdir version2 && cd version2
../configure options...
make

and

cd library && mkdir version3 && cd version3
../configure options...
make

so that I end up with three completely independent builds of the library in
the sub-directories.

I've never been able to get this sort of build to work with GDAL however.
I know configure has a million options so I may have overlooked a trick for
this.

Has anyone else been successful trying this with GDAL?

Thanks,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160208/4542bedf/attachment.html>

From schwehr at gmail.com  Mon Feb  8 08:11:33 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Mon, 8 Feb 2016 08:11:33 -0800
Subject: [gdal-dev] Building multiple versions of GDAL from the same
	tree...
In-Reply-To: <CAE=8km=Q79VK+vHmotFrFYEYHk2o1cbCwoavVk4pkMiJ6jPZWg@mail.gmail.com>
References: <CAE=8km=Q79VK+vHmotFrFYEYHk2o1cbCwoavVk4pkMiJ6jPZWg@mail.gmail.com>
Message-ID: <CACmBxyu9kRS+b9_4e3SC2RpD01p1Yh0NTa61ZNopAgWquxpKog@mail.gmail.com>

Hi Carl,

Adding "VPATH" support for the autoconf setup has been on my wish list of
things to have in the current build system.  It will take a bit of
patching.  And hasn't made it up to the top of my priority list (and won't
for a while)

So the answer is:  Not yet.

If anyone wants to take a stab at it and post the patch, I'd be happy to
give it a look and test it.

-kurt

On Mon, Feb 8, 2016 at 7:01 AM, Carl Godkin <cgodkin at gmail.com> wrote:

>
> Hi,
>
> With a shiny new version of GDAL now available (thanks!), I'm wondering
> about a problem with the builds that I always have but have never asked
> about before.
>
> Since I need to build several Linux variants of various third party
> libraries, I can usually persuade "configure" and make to work from a
> sub-directory like this:
>
> cd library && mkdir version1 && cd version1
> ../configure options...
> make
>
> followed by
>
> cd library && mkdir version2 && cd version2
> ../configure options...
> make
>
> and
>
> cd library && mkdir version3 && cd version3
> ../configure options...
> make
>
> so that I end up with three completely independent builds of the library
> in the sub-directories.
>
> I've never been able to get this sort of build to work with GDAL however.
> I know configure has a million options so I may have overlooked a trick for
> this.
>
> Has anyone else been successful trying this with GDAL?
>
> Thanks,
>
> carl
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160208/d40eecfe/attachment.html>

From cgodkin at gmail.com  Mon Feb  8 08:14:48 2016
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 8 Feb 2016 08:14:48 -0800
Subject: [gdal-dev] Building multiple versions of GDAL from the same
	tree...
In-Reply-To: <CACmBxyu9kRS+b9_4e3SC2RpD01p1Yh0NTa61ZNopAgWquxpKog@mail.gmail.com>
References: <CAE=8km=Q79VK+vHmotFrFYEYHk2o1cbCwoavVk4pkMiJ6jPZWg@mail.gmail.com>
 <CACmBxyu9kRS+b9_4e3SC2RpD01p1Yh0NTa61ZNopAgWquxpKog@mail.gmail.com>
Message-ID: <CAE=8kmm5e5_R+KyPMkTbKSxUaXfwcMOpWwHqUsKJO=B31MSRMQ@mail.gmail.com>

Thanks.  I'm glad it isn't just me!  I have never messed with autoconfig
but I'm certainly capable of testing when the time comes.

carl

On Mon, Feb 8, 2016 at 8:11 AM, Kurt Schwehr <schwehr at gmail.com> wrote:

> Hi Carl,
>
> Adding "VPATH" support for the autoconf setup has been on my wish list of
> things to have in the current build system.  It will take a bit of
> patching.  And hasn't made it up to the top of my priority list (and won't
> for a while)
>
> So the answer is:  Not yet.
>
> If anyone wants to take a stab at it and post the patch, I'd be happy to
> give it a look and test it.
>
> -kurt
>
> On Mon, Feb 8, 2016 at 7:01 AM, Carl Godkin <cgodkin at gmail.com> wrote:
>
>>
>> Hi,
>>
>> With a shiny new version of GDAL now available (thanks!), I'm wondering
>> about a problem with the builds that I always have but have never asked
>> about before.
>>
>> Since I need to build several Linux variants of various third party
>> libraries, I can usually persuade "configure" and make to work from a
>> sub-directory like this:
>>
>> cd library && mkdir version1 && cd version1
>> ../configure options...
>> make
>>
>> followed by
>>
>> cd library && mkdir version2 && cd version2
>> ../configure options...
>> make
>>
>> and
>>
>> cd library && mkdir version3 && cd version3
>> ../configure options...
>> make
>>
>> so that I end up with three completely independent builds of the library
>> in the sub-directories.
>>
>> I've never been able to get this sort of build to work with GDAL
>> however.  I know configure has a million options so I may have overlooked a
>> trick for this.
>>
>> Has anyone else been successful trying this with GDAL?
>>
>> Thanks,
>>
>> carl
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> --
> http://schwehr.org
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160208/95ded141/attachment-0001.html>

From even.rouault at spatialys.com  Mon Feb  8 08:16:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 8 Feb 2016 17:16:47 +0100
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
In-Reply-To: <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>
References: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
 <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>
Message-ID: <201602081716.48098.even.rouault@spatialys.com>

Le lundi 08 février 2016 15:54:11, Daniel Fenton a écrit :
> Hi Maning,
> 
> For NAD83 you need to convert the Datum to WGS84. The WKT string you show
> does not include that conversion. Proj.4 is missing these in a lot of
> cases.
> 
> Try this string instead:
> 
> PROJCS["NAD83_California_zone_5_ftUS",GEOGCS["GCS_North_American_1983",DATU
> M["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],TOWGS
> 84[-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062],PRIMEM["Green
> wich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal
> _Conic"],PARAMETER["standard_parallel_1",35.46666666666667],PARAMETER["stan
> dard_parallel_2",34.03333333333333],PARAMETER["latitude_of_origin",33.5],PA
> RAMETER["central_meridian",-118],PARAMETER["false_easting",6561666.667],PAR
> AMETER["false_northing",1640416.667],UNIT["Foot_US",0.30480060960121924]]
> 
> Hopefully that works for you. Let me know if it doesn't.

(CC'ing proj mailing list)

That's interesting, as indeed, proj assumes that WGS84 == NAD83, if no extra parameters
are specified. Comparing the TOWGS84 values you suggest with the EPSG database,
I see you suggest using EPSG:6866 coordinate transformation "ITRF2000 to NAD83(CORS96)"
(actually the opposite transformation, NAD83(CORS96) to ITRF2000).

Wondering if it might be appropriate to change proj.4 defaults to the above ?

Although it is not clear to me which realization of WGS84 is supposed to be the one used
by proj.4 as its pivot when datum transformations are involved. I guess this must depends
on the semantics of the grid or towgs84 parameters used...

There's also the EPSG:6864 (ITRF96 to NAD83(CORS96)) values that could be used if we rely rather
on the original WGS84 realization : -0.9910, 1.9072,0.5129,0.02579,0.00965,0.01166,0


Using the HTDP grids ( https://trac.osgeo.org/proj/wiki/HTDPGrids ) might also be an option.


Indeed Daniel's suggestion seems to do the trick, or at least better match
other data from the site http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0 
. I see it has also a geojson output :
http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0.geojson

And the first feature returned is OBJECT_ID=4001 whose first vertex is :
-118.276946349107,33.7920287419671

If I do, 
ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where "OBJECTID=4001" 

I get :
-118.276934177326,33.7920239166625

which is off by a bit more than 1 meter from the position of the geojson output.

But If I do :

ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where "OBJECTID=4001" \
 -s_srs "+proj=lcc +lat_1=35.46666666666667 +lat_2=34.03333333333333 \
+lat_0=33.5 +lon_0=-118 +x_0=2000000.000101601 +y_0=500000.0001016002 \
+ellps=GRS80 +towgs84=-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062 +units=us-ft +no_defs" \
-t_srs EPSG:4326

I get:

-118.276946349109,33.7920287419681

which is identical to the geojson output (difference is in the 10 micrometer precision range)

> 
> Daniel Fenton
> Software Engineer
> Esri R&D
> 
> On Mon, Feb 8, 2016 at 6:56 AM maning sambale <emmanuel.sambale at gmail.com>
> 
> wrote:
> > Hi,
> > 
> > I'm trying to convert LA City building data from State Plane to
> > EPSG:4326. I converted the data using ogr2ogr.  Visually inspecting
> > using Bing imagery, I'm seeing an offset.
> > 
> > Details of SRS info and sample images here:
> > https://gist.github.com/maning/093a866fd465ea880032
> > 
> > It is possible that Bing has the offset, but the source of Bing comes
> > from LARIAC (Los Angeles Region Imagery Acquisition Consortium)
> > imagery, the same source as the building footprints were traced.
> > 
> > Any hints on the "proper" conversion from State Plane to EPSG:4326.
> > 
> > --
> > cheers,
> > maning
> > ------------------------------------------------------
> > "Freedom is still the most radical idea of all" -N.Branden
> > https://epsg4253.wordpress.com/
> > http://twitter.com/maningsambale
> > ------------------------------------------------------
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dmfenton at gmail.com  Mon Feb  8 08:30:39 2016
From: dmfenton at gmail.com (Daniel Fenton)
Date: Mon, 08 Feb 2016 16:30:39 +0000
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
In-Reply-To: <201602081716.48098.even.rouault@spatialys.com>
References: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
 <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>
 <201602081716.48098.even.rouault@spatialys.com>
Message-ID: <CAHmEjOXufY5VqEszZOMqWi39mA8juradm_Tq0-vAhLThmqhUaQ@mail.gmail.com>

I don't pretend to be an expert on this subject although we certainly do
have experts at Esri.

Anyways, it's been explained to me that the exact datum transformation
depends on the geography of the source data, as well as the exact time. The
datum conversion I offered was given to me as the most general
transformation between NAD83 and WGS84.

One should expect the transformed data to be slightly off from the source.
This is not a worry though because it is highly unlikely that the source
data capture is rated to the precision level that matches the change.

On Mon, Feb 8, 2016 at 11:17 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Le lundi 08 février 2016 15:54:11, Daniel Fenton a écrit :
> > Hi Maning,
> >
> > For NAD83 you need to convert the Datum to WGS84. The WKT string you show
> > does not include that conversion. Proj.4 is missing these in a lot of
> > cases.
> >
> > Try this string instead:
> >
> >
> PROJCS["NAD83_California_zone_5_ftUS",GEOGCS["GCS_North_American_1983",DATU
> >
> M["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],TOWGS
> >
> 84[-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062],PRIMEM["Green
> >
> wich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal
> >
> _Conic"],PARAMETER["standard_parallel_1",35.46666666666667],PARAMETER["stan
> >
> dard_parallel_2",34.03333333333333],PARAMETER["latitude_of_origin",33.5],PA
> >
> RAMETER["central_meridian",-118],PARAMETER["false_easting",6561666.667],PAR
> > AMETER["false_northing",1640416.667],UNIT["Foot_US",0.30480060960121924]]
> >
> > Hopefully that works for you. Let me know if it doesn't.
>
> (CC'ing proj mailing list)
>
> That's interesting, as indeed, proj assumes that WGS84 == NAD83, if no
> extra parameters
> are specified. Comparing the TOWGS84 values you suggest with the EPSG
> database,
> I see you suggest using EPSG:6866 coordinate transformation "ITRF2000 to
> NAD83(CORS96)"
> (actually the opposite transformation, NAD83(CORS96) to ITRF2000).
>
> Wondering if it might be appropriate to change proj.4 defaults to the
> above ?
>
> Although it is not clear to me which realization of WGS84 is supposed to
> be the one used
> by proj.4 as its pivot when datum transformations are involved. I guess
> this must depends
> on the semantics of the grid or towgs84 parameters used...
>
> There's also the EPSG:6864 (ITRF96 to NAD83(CORS96)) values that could be
> used if we rely rather
> on the original WGS84 realization : -0.9910,
> 1.9072,0.5129,0.02579,0.00965,0.01166,0
>
>
> Using the HTDP grids ( https://trac.osgeo.org/proj/wiki/HTDPGrids ) might
> also be an option.
>
>
> Indeed Daniel's suggestion seems to do the trick, or at least better match
> other data from the site
> http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0
> . I see it has also a geojson output :
>
> http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0.geojson
>
> And the first feature returned is OBJECT_ID=4001 whose first vertex is :
> -118.276946349107,33.7920287419671
>
> If I do,
> ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where
> "OBJECTID=4001"
>
> I get :
> -118.276934177326,33.7920239166625
>
> which is off by a bit more than 1 meter from the position of the geojson
> output.
>
> But If I do :
>
> ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where
> "OBJECTID=4001" \
>  -s_srs "+proj=lcc +lat_1=35.46666666666667 +lat_2=34.03333333333333 \
> +lat_0=33.5 +lon_0=-118 +x_0=2000000.000101601 +y_0=500000.0001016002 \
> +ellps=GRS80
> +towgs84=-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062
> +units=us-ft +no_defs" \
> -t_srs EPSG:4326
>
> I get:
>
> -118.276946349109,33.7920287419681
>
> which is identical to the geojson output (difference is in the 10
> micrometer precision range)
>
> >
> > Daniel Fenton
> > Software Engineer
> > Esri R&D
> >
> > On Mon, Feb 8, 2016 at 6:56 AM maning sambale <
> emmanuel.sambale at gmail.com>
> >
> > wrote:
> > > Hi,
> > >
> > > I'm trying to convert LA City building data from State Plane to
> > > EPSG:4326. I converted the data using ogr2ogr.  Visually inspecting
> > > using Bing imagery, I'm seeing an offset.
> > >
> > > Details of SRS info and sample images here:
> > > https://gist.github.com/maning/093a866fd465ea880032
> > >
> > > It is possible that Bing has the offset, but the source of Bing comes
> > > from LARIAC (Los Angeles Region Imagery Acquisition Consortium)
> > > imagery, the same source as the building footprints were traced.
> > >
> > > Any hints on the "proper" conversion from State Plane to EPSG:4326.
> > >
> > > --
> > > cheers,
> > > maning
> > > ------------------------------------------------------
> > > "Freedom is still the most radical idea of all" -N.Branden
> > > https://epsg4253.wordpress.com/
> > > http://twitter.com/maningsambale
> > > ------------------------------------------------------
> > > _______________________________________________
> > > gdal-dev mailing list
> > > gdal-dev at lists.osgeo.org
> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160208/40fc0685/attachment.html>

From dmorissette at mapgears.com  Mon Feb  8 09:06:44 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Mon, 8 Feb 2016 12:06:44 -0500
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B45770.7000405@gmail.com>
References: <56B45770.7000405@gmail.com>
Message-ID: <56B8CB24.4060102@mapgears.com>

On 2016-02-05 3:04 AM, Ari Jolma wrote:
> I'd like to ask the PSC and others to vote on adopting RFC 61: Support
> for measured geometries.
>
> The draft RFC is at
>
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>


+1

Daniel

-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From paulopires16 at gmail.com  Mon Feb  8 12:55:31 2016
From: paulopires16 at gmail.com (Paulo Pires)
Date: Mon, 8 Feb 2016 12:55:31 -0800 (PST)
Subject: [gdal-dev] Change resolution tiff image
In-Reply-To: <201602071004.07123.even.rouault@spatialys.com>
References: <1454698927074-5249156.post@n6.nabble.com>
 <201602071004.07123.even.rouault@spatialys.com>
Message-ID: <1454964931832-5249576.post@n6.nabble.com>

Thanks Even 

I use TIFFTAG_XRESOLUTION...



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Change-resolution-tiff-image-tp5249156p5249576.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From paulopires16 at gmail.com  Mon Feb  8 12:59:01 2016
From: paulopires16 at gmail.com (Paulo Pires)
Date: Mon, 8 Feb 2016 12:59:01 -0800 (PST)
Subject: [gdal-dev] shp to raster
Message-ID: <1454965141708-5249577.post@n6.nabble.com>

Hello

I try to use: gdal_rasterize -a xxx -burn 255 -burn 0 -ts 3000 3000 -l xxx
aaa.shp bbb.tif for create raster from line shapefile but the output is a
black raster...

Something is wrong on my command line?

Thanks





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/shp-to-raster-tp5249577.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From emmanuel.sambale at gmail.com  Mon Feb  8 18:35:51 2016
From: emmanuel.sambale at gmail.com (maning sambale)
Date: Tue, 9 Feb 2016 08:05:51 +0530
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
In-Reply-To: <CAHmEjOXufY5VqEszZOMqWi39mA8juradm_Tq0-vAhLThmqhUaQ@mail.gmail.com>
References: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
 <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>
 <201602081716.48098.even.rouault@spatialys.com>
 <CAHmEjOXufY5VqEszZOMqWi39mA8juradm_Tq0-vAhLThmqhUaQ@mail.gmail.com>
Message-ID: <CAPzumuH4uosY9CAXy+Tco8VjHFtjR=c2KMaXYJV4CRzD4XZWZA@mail.gmail.com>

Thanks Daniel and Even,

Using following Even's advice, I get better results:
https://gist.github.com/maning/093a866fd465ea880032#better-conversion

> Wondering if it might be appropriate to change proj.4 defaults to the above ?

+1

On Mon, Feb 8, 2016 at 10:00 PM, Daniel Fenton <dmfenton at gmail.com> wrote:
> I don't pretend to be an expert on this subject although we certainly do
> have experts at Esri.
>
> Anyways, it's been explained to me that the exact datum transformation
> depends on the geography of the source data, as well as the exact time. The
> datum conversion I offered was given to me as the most general
> transformation between NAD83 and WGS84.
>
> One should expect the transformed data to be slightly off from the source.
> This is not a worry though because it is highly unlikely that the source
> data capture is rated to the precision level that matches the change.
>
> On Mon, Feb 8, 2016 at 11:17 AM Even Rouault <even.rouault at spatialys.com>
> wrote:
>>
>> Le lundi 08 février 2016 15:54:11, Daniel Fenton a écrit :
>> > Hi Maning,
>> >
>> > For NAD83 you need to convert the Datum to WGS84. The WKT string you
>> > show
>> > does not include that conversion. Proj.4 is missing these in a lot of
>> > cases.
>> >
>> > Try this string instead:
>> >
>> >
>> > PROJCS["NAD83_California_zone_5_ftUS",GEOGCS["GCS_North_American_1983",DATU
>> >
>> > M["D_North_American_1983",SPHEROID["GRS_1980",6378137,298.257222101]],TOWGS
>> >
>> > 84[-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062],PRIMEM["Green
>> >
>> > wich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Conformal
>> >
>> > _Conic"],PARAMETER["standard_parallel_1",35.46666666666667],PARAMETER["stan
>> >
>> > dard_parallel_2",34.03333333333333],PARAMETER["latitude_of_origin",33.5],PA
>> >
>> > RAMETER["central_meridian",-118],PARAMETER["false_easting",6561666.667],PAR
>> >
>> > AMETER["false_northing",1640416.667],UNIT["Foot_US",0.30480060960121924]]
>> >
>> > Hopefully that works for you. Let me know if it doesn't.
>>
>> (CC'ing proj mailing list)
>>
>> That's interesting, as indeed, proj assumes that WGS84 == NAD83, if no
>> extra parameters
>> are specified. Comparing the TOWGS84 values you suggest with the EPSG
>> database,
>> I see you suggest using EPSG:6866 coordinate transformation "ITRF2000 to
>> NAD83(CORS96)"
>> (actually the opposite transformation, NAD83(CORS96) to ITRF2000).
>>
>> Wondering if it might be appropriate to change proj.4 defaults to the
>> above ?
>>
>> Although it is not clear to me which realization of WGS84 is supposed to
>> be the one used
>> by proj.4 as its pivot when datum transformations are involved. I guess
>> this must depends
>> on the semantics of the grid or towgs84 parameters used...
>>
>> There's also the EPSG:6864 (ITRF96 to NAD83(CORS96)) values that could be
>> used if we rely rather
>> on the original WGS84 realization : -0.9910,
>> 1.9072,0.5129,0.02579,0.00965,0.01166,0
>>
>>
>> Using the HTDP grids ( https://trac.osgeo.org/proj/wiki/HTDPGrids ) might
>> also be an option.
>>
>>
>> Indeed Daniel's suggestion seems to do the trick, or at least better match
>> other data from the site
>> http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0
>> . I see it has also a geojson output :
>>
>> http://geohub.lacity.org/datasets/813fcefde1f64b209103107b26a8909f_0.geojson
>>
>> And the first feature returned is OBJECT_ID=4001 whose first vertex is :
>> -118.276946349107,33.7920287419671
>>
>> If I do,
>> ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where
>> "OBJECTID=4001"
>>
>> I get :
>> -118.276934177326,33.7920239166625
>>
>> which is off by a bit more than 1 meter from the position of the geojson
>> output.
>>
>> But If I do :
>>
>> ogr2ogr -f kml /vsistdout/ /vsizip/Building_Footprints.zip  -where
>> "OBJECTID=4001" \
>>  -s_srs "+proj=lcc +lat_1=35.46666666666667 +lat_2=34.03333333333333 \
>> +lat_0=33.5 +lon_0=-118 +x_0=2000000.000101601 +y_0=500000.0001016002 \
>> +ellps=GRS80
>> +towgs84=-0.9956,1.9013,0.5215,0.025915,0.009426,0.011599,-0.00062
>> +units=us-ft +no_defs" \
>> -t_srs EPSG:4326
>>
>> I get:
>>
>> -118.276946349109,33.7920287419681
>>
>> which is identical to the geojson output (difference is in the 10
>> micrometer precision range)
>>
>> >
>> > Daniel Fenton
>> > Software Engineer
>> > Esri R&D
>> >
>> > On Mon, Feb 8, 2016 at 6:56 AM maning sambale
>> > <emmanuel.sambale at gmail.com>
>> >
>> > wrote:
>> > > Hi,
>> > >
>> > > I'm trying to convert LA City building data from State Plane to
>> > > EPSG:4326. I converted the data using ogr2ogr.  Visually inspecting
>> > > using Bing imagery, I'm seeing an offset.
>> > >
>> > > Details of SRS info and sample images here:
>> > > https://gist.github.com/maning/093a866fd465ea880032
>> > >
>> > > It is possible that Bing has the offset, but the source of Bing comes
>> > > from LARIAC (Los Angeles Region Imagery Acquisition Consortium)
>> > > imagery, the same source as the building footprints were traced.
>> > >
>> > > Any hints on the "proper" conversion from State Plane to EPSG:4326.
>> > >
>> > > --
>> > > cheers,
>> > > maning
>> > > ------------------------------------------------------
>> > > "Freedom is still the most radical idea of all" -N.Branden
>> > > https://epsg4253.wordpress.com/
>> > > http://twitter.com/maningsambale
>> > > ------------------------------------------------------
>> > > _______________________________________________
>> > > gdal-dev mailing list
>> > > gdal-dev at lists.osgeo.org
>> > > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com



-- 
cheers,
maning
------------------------------------------------------
"Freedom is still the most radical idea of all" -N.Branden
https://epsg4253.wordpress.com/
http://twitter.com/maningsambale
------------------------------------------------------

From ari.jolma at gmail.com  Tue Feb  9 00:18:00 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 9 Feb 2016 10:18:00 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B8CB24.4060102@mapgears.com>
References: <56B45770.7000405@gmail.com> <56B8CB24.4060102@mapgears.com>
Message-ID: <56B9A0B8.5040500@gmail.com>

Thanks,

We now have +1 from Even, Tamas, Jukka and Daniel. Is that formally enough?

I have a small change to the draft. I now think that the coordinate 
flags should be managed/queried solely through Is3D(), IsMeasured() 
(which are standard) and set3D(boolean) and setMeasured(boolean), (which 
are extensions to the SF specification). I.e., the getFlags() and 
setFlags(int) should be removed. The reason is that there is one flag, 
which is used only for points, and thus the API can be easily misused.

Similarly the bit #defines for the coordinate flags sh/could be private. 
In practice that means to move them to ogr_p.h.

Even, there are strange errors in the ogr_pg.py tests.

https://s3.amazonaws.com/archive.travis-ci.org/jobs/107782519/log.txt

Test 24 fails because the layer is NoneType, i.e., it does not open the 
datatypetest table. However, if I run the tests up to 24 but quit before 
it, the table exists and seems to be ok. I had similar problems with the 
shape driver - temporary datasets disappearing midtests. Any idea what's 
the reason?

Ari

08.02.2016, 19:06, Daniel Morissette kirjoitti:
> On 2016-02-05 3:04 AM, Ari Jolma wrote:
>> I'd like to ask the PSC and others to vote on adopting RFC 61: Support
>> for measured geometries.
>>
>> The draft RFC is at
>>
>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>
>
>
> +1
>
> Daniel
>


From andre+joost at nurfuerspam.de  Tue Feb  9 00:17:08 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 09 Feb 2016 09:17:08 +0100
Subject: [gdal-dev] convert shapefile from California State Plane to
	EPSG:4326
In-Reply-To: <CAPzumuH4uosY9CAXy+Tco8VjHFtjR=c2KMaXYJV4CRzD4XZWZA@mail.gmail.com>
References: <CAPzumuH5gXz+ofpqSCpATg4z+sbNCE86yx2YuJ2dRGS75U26JA@mail.gmail.com>
 <CAHmEjOXUWcvQfGKpdEDx-_-pWHqdqzvwfmy+rK5DTM9bP2kpCw@mail.gmail.com>
 <201602081716.48098.even.rouault@spatialys.com>
 <CAHmEjOXufY5VqEszZOMqWi39mA8juradm_Tq0-vAhLThmqhUaQ@mail.gmail.com>
 <CAPzumuH4uosY9CAXy+Tco8VjHFtjR=c2KMaXYJV4CRzD4XZWZA@mail.gmail.com>
Message-ID: <n9c801$cr$1@ger.gmane.org>

Am 09.02.2016 um 03:35 schrieb maning sambale:
> Thanks Daniel and Even,
>
> Using following Even's advice, I get better results:
> https://gist.github.com/maning/093a866fd465ea880032#better-conversion
>
>> Wondering if it might be appropriate to change proj.4 defaults to the above ?
>
> +1

The datum shift between WGS84 and NAD83 is related to the tectonic plate 
shift, which varies across North America, and over the time.

So it makes not much sense to change the proj.4 values, unless it is 
checked for accuracy at several places across the continent, and bound 
to a certain time.

Locally, you get good fitting vectors and images if you use the same 
shift as was used for georeferencing the orthoimages.

Greetings,
André Joost



From ari.jolma at gmail.com  Tue Feb  9 00:47:13 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 9 Feb 2016 10:47:13 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B9A0B8.5040500@gmail.com>
References: <56B45770.7000405@gmail.com> <56B8CB24.4060102@mapgears.com>
 <56B9A0B8.5040500@gmail.com>
Message-ID: <56B9A791.1060100@gmail.com>

09.02.2016, 10:18, Ari Jolma kirjoitti:
>
>
> Even, there are strange errors in the ogr_pg.py tests.
>
> https://s3.amazonaws.com/archive.travis-ci.org/jobs/107782519/log.txt
>
> Test 24 fails because the layer is NoneType, i.e., it does not open 
> the datatypetest table. However, if I run the tests up to 24 but quit 
> before it, the table exists and seems to be ok. I had similar problems 
> with the shape driver - temporary datasets disappearing midtests. Any 
> idea what's the reason?

A bit more on this:

If I run the tests until 24, i.e., including it, and then quit. The 
table datatypetest is in the database.

If I run the test under gdb just until where test 24 attempts to open 
the table, the table is not in the database. I can see this also from 
pgAdmin.

The table seems to disappear just for the test. Which is very confusing.

Ari


From even.rouault at spatialys.com  Tue Feb  9 01:17:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 9 Feb 2016 10:17:54 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B9A0B8.5040500@gmail.com>
References: <56B45770.7000405@gmail.com> <56B8CB24.4060102@mapgears.com>
 <56B9A0B8.5040500@gmail.com>
Message-ID: <201602091017.55253.even.rouault@spatialys.com>

Le mardi 09 février 2016 09:18:00, Ari Jolma a écrit :
> Thanks,
> 
> We now have +1 from Even, Tamas, Jukka and Daniel. Is that formally enough?

Yes. at least 2 business days, 2 +1 votes and no -1.

> 
> I have a small change to the draft. I now think that the coordinate
> flags should be managed/queried solely through Is3D(), IsMeasured()
> (which are standard) and set3D(boolean) and setMeasured(boolean), (which
> are extensions to the SF specification). I.e., the getFlags() and
> setFlags(int) should be removed. The reason is that there is one flag,
> which is used only for points, and thus the API can be easily misused.

Sounds good. I had a bit that feeling too when looking at the code but didn't 
dive enough into the implementation to have a strong opinion on it.

> 
> Similarly the bit #defines for the coordinate flags sh/could be private.
> In practice that means to move them to ogr_p.h.
> 
> Even, there are strange errors in the ogr_pg.py tests.
> 
> https://s3.amazonaws.com/archive.travis-ci.org/jobs/107782519/log.txt
> 
> Test 24 fails because the layer is NoneType, i.e., it does not open the
> datatypetest table. However, if I run the tests up to 24 but quit before
> it, the table exists and seems to be ok.

Tests are not independant from each other, so I suspect the failure in 
ogr_pg_21 might let a (implicit) transaction non committed. Thus ogr_pg_24 
which opens a new connection doesn't see the table created before. Whereas if 
you quit, the transaction will be committed.

> I had similar problems with the
> shape driver - temporary datasets disappearing midtests. Any idea what's
> the reason?

This cannot be due to transactions here, but here too steps may have 
dependencies.

> 
> Ari
> 
> 08.02.2016, 19:06, Daniel Morissette kirjoitti:
> > On 2016-02-05 3:04 AM, Ari Jolma wrote:
> >> I'd like to ask the PSC and others to vote on adopting RFC 61: Support
> >> for measured geometries.
> >> 
> >> The draft RFC is at
> >> 
> >> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> > 
> > +1
> > 
> > Daniel
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Feb  9 01:22:45 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 9 Feb 2016 11:22:45 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602091017.55253.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56B8CB24.4060102@mapgears.com>
 <56B9A0B8.5040500@gmail.com> <201602091017.55253.even.rouault@spatialys.com>
Message-ID: <56B9AFE5.4080202@gmail.com>

09.02.2016, 11:17, Even Rouault kirjoitti:
> Tests are not independant from each other, so I suspect the failure in
> ogr_pg_21 might let a (implicit) transaction non committed. Thus ogr_pg_24
> which opens a new connection doesn't see the table created before. Whereas if
> you quit, the transaction will be committed.

That's it. I think it is a bug.

Ari


From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb  9 04:05:56 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 9 Feb 2016 12:05:56 +0000 (UTC)
Subject: [gdal-dev] shp to raster
References: <1454965141708-5249577.post@n6.nabble.com>
Message-ID: <loom.20160209T125740-476@post.gmane.org>

Paulo Pires <paulopires16 <at> gmail.com> writes:

> 
> Hello
> 
> I try to use: gdal_rasterize -a xxx -burn 255 -burn 0 -ts 3000 3000 -l xxx
> aaa.shp bbb.tif for create raster from line shapefile but the output is a
> black raster...
> 
> Something is wrong on my command line?

Hi,

I suppose that the command is planned to take the burn value either from an
attribute with -a or from user given values with -burn. Your command has -a
and two -burn parameters. You do not have -b parameters for defining the
bands. I recommend to read http://www.gdal.org/gdal_rasterize.html again and
test with the first example command. Once you see that it works change the
parameters one by one to fine tune the result.

-Jukka Rahkonen-



From ari.jolma at gmail.com  Tue Feb  9 07:07:19 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 9 Feb 2016 17:07:19 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56B45770.7000405@gmail.com>
References: <56B45770.7000405@gmail.com>
Message-ID: <56BA00A7.8080404@gmail.com>

I declare this motion passed with +1 from Even, Tamas, Jukka and Daniel 
and no -1.

I'll commit soon the changes to the core and then later the drivers: 
memory, shape and pg. The goal is to keep the travis test build passing.

Ari

05.02.2016, 10:04, Ari Jolma kirjoitti:
> I'd like to ask the PSC and others to vote on adopting RFC 61: Support 
> for measured geometries.
>
> The draft RFC is at
>
> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>
> and a draft implementation is at
>
> https://github.com/ajolma/GDAL-XYZM
>
> which is tested at
>
> https://travis-ci.org/ajolma/GDAL-XYZM
>
> (the test #34, which passed, was the so far last one after core 
> changes with unchanged autotests and a rather comprehensive set of WKT 
> tests in the Perl tests directory)
>
> This is seemingly a small change but it is at the heart of OGR so it 
> has some important implications. The only backwards incompatibilities 
> that have appeared so far are with some drivers, for example 
> shapefile, which can be lessened with, e.g., open options.
>
> Best,
>
> Ari
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160209/4a556682/attachment.html>

From ssaniev at gmail.com  Tue Feb  9 08:28:33 2016
From: ssaniev at gmail.com (ssaniev)
Date: Tue, 9 Feb 2016 08:28:33 -0800 (PST)
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
Message-ID: <1455035313516-5249728.post@n6.nabble.com>

Hey guys, 

First time GDAL user here. 

We are trying to load shapefiles into postgresql DB, and were able to do so
with GDAL ogr2ogr CLI utility. 
Following cmd works via cmd: 
ogr2ogr -f PostgreSQL PG:"host='hostName' port='5432' user='userName'
dbname='dbName' password='aPassword'" shapeFileName.shp 


*Next step is to accomplish this in java with GDAL bindings. *

There is a maven dependency for gdal which we included in our pom.xml: 
                <dependency>
                   <groupId>org.gdal</groupId>
                   <artifactId>gdal</artifactId>
                   <version>2.0.0</version>
                </dependency>
                

*We import and simply want to output the version of gdal in java: *

import org.gdal.gdal.gdal; 

public class ShapeFileWorker { 
    public void process(String fileName, String hostAddress) { 
        gdal.VersionInfo() 
    } 
} 


*While trying to use gdal library in our java class, we are getting the
following error: *
java.lang.UnsatisfiedLinkError: no gdaljni in java.library.path 


The development project is in SPRING, and Eclipse IDE. 

After reading many online gdal discussions, I have added GDAL_DATA and
LD_LIBRARY_PATH variables. 

But since we are using gdal maven dependency, we shouldn't need them.

Anyone could point us in the right direction?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jdeolive at gmail.com  Tue Feb  9 08:55:43 2016
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 09 Feb 2016 16:55:43 +0000
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
In-Reply-To: <1455035313516-5249728.post@n6.nabble.com>
References: <1455035313516-5249728.post@n6.nabble.com>
Message-ID: <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>

Hi,

Have you set the java.library.path system property to the location of the
gdal libraries on the system? The gdal jar doesn’t contain any of the
native libraries, just the java parts.

I’ve found that usually I do need to set LD_LIBRARY_PATH to include the
location of the gdal libraries, and the location of any libraries that it
is linked to.

For example if you I had the native GDAL libraries in /usr/local/lib I
would set up my java IDE as follows:

- Set the environment variable LD_LIBRARY_PATH (linux) or DYLD_LIBRARY_PATH
(osx) to /usr/local/lib
- Add the java system property “-Djava.library.path=/usr/local/lib”

And that usually does the trick for me. Hope that helps.

-Justin

On Tue, Feb 9, 2016 at 9:40 AM ssaniev <ssaniev at gmail.com> wrote:

> Hey guys,
>
> First time GDAL user here.
>
> We are trying to load shapefiles into postgresql DB, and were able to do so
> with GDAL ogr2ogr CLI utility.
> Following cmd works via cmd:
> ogr2ogr -f PostgreSQL PG:"host='hostName' port='5432' user='userName'
> dbname='dbName' password='aPassword'" shapeFileName.shp
>
>
> *Next step is to accomplish this in java with GDAL bindings. *
>
> There is a maven dependency for gdal which we included in our pom.xml:
>                 <dependency>
>                    <groupId>org.gdal</groupId>
>                    <artifactId>gdal</artifactId>
>                    <version>2.0.0</version>
>                 </dependency>
>
>
> *We import and simply want to output the version of gdal in java: *
>
> import org.gdal.gdal.gdal;
>
> public class ShapeFileWorker {
>     public void process(String fileName, String hostAddress) {
>         gdal.VersionInfo()
>     }
> }
>
>
> *While trying to use gdal library in our java class, we are getting the
> following error: *
> java.lang.UnsatisfiedLinkError: no gdaljni in java.library.path
>
>
> The development project is in SPRING, and Eclipse IDE.
>
> After reading many online gdal discussions, I have added GDAL_DATA and
> LD_LIBRARY_PATH variables.
>
> But since we are using gdal maven dependency, we shouldn't need them.
>
> Anyone could point us in the right direction?
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160209/d3ee22f4/attachment.html>

From ssaniev at gmail.com  Tue Feb  9 11:46:50 2016
From: ssaniev at gmail.com (ssaniev)
Date: Tue, 9 Feb 2016 11:46:50 -0800 (PST)
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
In-Reply-To: <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>
References: <1455035313516-5249728.post@n6.nabble.com>
 <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>
Message-ID: <1455047210358-5249767.post@n6.nabble.com>

Hi Justin,

Coding in java Windows7/Eclipse/spring/maven.

*As told before, added dependency to pom, and see the gdal-2.0.0.jar in
maven dependencies and able to import to my java class.*
<dependency>
	<groupId>org.gdal</groupId>
	<artifactId>gdal</artifactId>
	<version>2.0.0</version>
</dependency>


I downloaded the libraries from here:
http://download.gisinternals.com/sdk/downloads/release-1800-x64-gdal-1-11-3-mapserver-6-4-2.zip

unzippped... and added the both paths below to my environment PATH variable:
..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin
..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java

Created another environment variable
GDAL_DATA=..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal-data

Inside Eclipse, added a VM argument to my project runtume:
-Djava.library.path="..\workspace\GISDataDirectory\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java\;${env_var:PATH}"



*And after all this, I am getting a different related error:*

Native library load failed.
java.lang.UnsatisfiedLinkError:
..\workspace\GISDataDirectory\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java\gdaljni.dll:
The specified procedure could not be found

nested exception is java.lang.UnsatisfiedLinkError:
org.gdal.gdal.gdalJNI.VersionInfo__SWIG_1()Ljava/lang/String;] with root
cause


What am I missing here?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728p5249767.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jdeolive at gmail.com  Tue Feb  9 12:27:04 2016
From: jdeolive at gmail.com (Justin Deoliveira)
Date: Tue, 09 Feb 2016 20:27:04 +0000
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
In-Reply-To: <1455047210358-5249767.post@n6.nabble.com>
References: <1455035313516-5249728.post@n6.nabble.com>
 <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>
 <1455047210358-5249767.post@n6.nabble.com>
Message-ID: <CAGLyg+r1nkcPa09H0kTuKERdjqtHMdMNQrCjrnNR5sqdydQJAw@mail.gmail.com>

Looks like you have everything configured properly. I have seen reports
from users having issue with using a gdal jar compiled on a different
system. I’ve never seen that personally but from what I understand the
solution in that case was to just compile the java (and the rest of the
gdal libs) themselves locally.

On Tue, Feb 9, 2016 at 12:58 PM ssaniev <ssaniev at gmail.com> wrote:

> Hi Justin,
>
> Coding in java Windows7/Eclipse/spring/maven.
>
> *As told before, added dependency to pom, and see the gdal-2.0.0.jar in
> maven dependencies and able to import to my java class.*
> <dependency>
>         <groupId>org.gdal</groupId>
>         <artifactId>gdal</artifactId>
>         <version>2.0.0</version>
> </dependency>
>
>
> I downloaded the libraries from here:
>
> http://download.gisinternals.com/sdk/downloads/release-1800-x64-gdal-1-11-3-mapserver-6-4-2.zip
>
> unzippped... and added the both paths below to my environment PATH
> variable:
> ..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin
> ..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java
>
> Created another environment variable
>
> GDAL_DATA=..\Downloads\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal-data
>
> Inside Eclipse, added a VM argument to my project runtume:
>
> -Djava.library.path="..\workspace\GISDataDirectory\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java\;${env_var:PATH}"
>
>
>
> *And after all this, I am getting a different related error:*
>
> Native library load failed.
> java.lang.UnsatisfiedLinkError:
>
> ..\workspace\GISDataDirectory\release-1800-x64-gdal-1-11-3-mapserver-6-4-2\bin\gdal\java\gdaljni.dll:
> The specified procedure could not be found
>
> nested exception is java.lang.UnsatisfiedLinkError:
> org.gdal.gdal.gdalJNI.VersionInfo__SWIG_1()Ljava/lang/String;] with root
> cause
>
>
> What am I missing here?
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728p5249767.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160209/31e4d7f5/attachment.html>

From ssaniev at gmail.com  Tue Feb  9 12:23:46 2016
From: ssaniev at gmail.com (ssaniev)
Date: Tue, 9 Feb 2016 12:23:46 -0800 (PST)
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
In-Reply-To: <CAGLyg+r1nkcPa09H0kTuKERdjqtHMdMNQrCjrnNR5sqdydQJAw@mail.gmail.com>
References: <1455035313516-5249728.post@n6.nabble.com>
 <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>
 <1455047210358-5249767.post@n6.nabble.com>
 <CAGLyg+r1nkcPa09H0kTuKERdjqtHMdMNQrCjrnNR5sqdydQJAw@mail.gmail.com>
Message-ID: <1455049426771-5249772.post@n6.nabble.com>

Thanks. Will be looking into that soon. Will report back here if it works.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728p5249772.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Wed Feb 10 03:26:59 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 10 Feb 2016 13:26:59 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BA00A7.8080404@gmail.com>
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
Message-ID: <56BB1E83.5000701@gmail.com>

One more issue came up.

Shapefiles, which have Z will also have M, at least a placeholder for it.

Having shapefiles as XYZM always in that case may be problematic.

It is possible to use the open options SHPT=type to override the 
default. We could have Z => XYZ as default for backwards compatibility 
and require open option for Z  => XYZM.

Ari


09.02.2016, 17:07, Ari Jolma kirjoitti:
> I declare this motion passed with +1 from Even, Tamas, Jukka and 
> Daniel and no -1.
>
> I'll commit soon the changes to the core and then later the drivers: 
> memory, shape and pg. The goal is to keep the travis test build passing.
>
> Ari
>
> 05.02.2016, 10:04, Ari Jolma kirjoitti:
>> I'd like to ask the PSC and others to vote on adopting RFC 61: 
>> Support for measured geometries.
>>
>> The draft RFC is at
>>
>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>
>> and a draft implementation is at
>>
>> https://github.com/ajolma/GDAL-XYZM
>>
>> which is tested at
>>
>> https://travis-ci.org/ajolma/GDAL-XYZM
>>
>> (the test #34, which passed, was the so far last one after core 
>> changes with unchanged autotests and a rather comprehensive set of 
>> WKT tests in the Perl tests directory)
>>
>> This is seemingly a small change but it is at the heart of OGR so it 
>> has some important implications. The only backwards incompatibilities 
>> that have appeared so far are with some drivers, for example 
>> shapefile, which can be lessened with, e.g., open options.
>>
>> Best,
>>
>> Ari
>>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160210/892edd10/attachment.html>

From even.rouault at spatialys.com  Wed Feb 10 03:55:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Feb 2016 12:55:57 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BB1E83.5000701@gmail.com>
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
 <56BB1E83.5000701@gmail.com>
Message-ID: <201602101255.57193.even.rouault@spatialys.com>

Le mercredi 10 février 2016 12:26:59, Ari Jolma a écrit :
> One more issue came up.
> 
> Shapefiles, which have Z will also have M, at least a placeholder for it.
> 
> Having shapefiles as XYZM always in that case may be problematic.

Small precision for those not necessarily familiar with the internals of the 
shapefile format. The .shp and .shx header have a declared shape type (used to 
set the OGR layer geometry type), that can be (restricting to the case of 
polygon for the sake of clarity, but true for other geometry types) :
SHPT_POLYGON : the shapefile contains only Polygon 2D shapes
SHPT_POLYGONZ:  the shapefile may contain a mix of PolygonZ or PolygonZM shapes
SHPT_POLYGONM: the shapefile may contain a mix of Polygon or PolygonM shapes

Declaring a SHPT_POLYGONM as a PolygonM layer is OK (if the shapefile doesn't 
contain PolygonM shapes, it should declare only SHPT_POLYGON)

But declaring SHPT_POLYGONZ as a PolygonZM layer, when there are in fact no 
PolygonZM shapes in it but just PolygonZ, is more problematic for backward 
compatibility issues. Ideally when dealing with shapefiles without M values we 
shouldn't advertize M neither in the layer geometry type, nor in the feature 
geometry.

> 
> It is possible to use the open options SHPT=type to override the
> default. We could have Z => XYZ as default for backwards compatibility
> and require open option for Z  => XYZM.

That's one possibility. As open options should be a last resort, if SHPT isn't 
specified perhaps we could do a probing of the first shape. If it has a M 
component then advertize xxxxZM geometry type, otherwise just xxxxxZ. That's 
of course not completely bullet proof as there can be in theory a mix of Z and 
ZM shapes, but my feeling is that this should work in > 90% of the cases.

That's an improvement I could have a look at during the Code Sprint if you 
don't feel confident enough in the shape driver.


~~~~~

Somehow related issue I've noticed but that should be more easily fixable. Now 
creating a Polygon25D shapefile creates PolygonZM and not PolygonZ shapes (and 
perhaps true for other shape types).

trunk:
$ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
$ ll poly25d.*
-rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
-rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
-rw-r--r-- 1 even even 8820 2016-02-10 12:36 poly25d.shp
-rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx

2.0:
$ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
$ ll poly25d.*
-rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
-rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
-rw-r--r-- 1 even even 6700 2016-02-10 12:36 poly25d.shp
-rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx

On the read size, I've commited https://trac.osgeo.org/gdal/changeset/33408
"Shape: fix crash when reading a MultiPointZ without M values, and when reading 
a PointZ without M do not create a PointZM geometry (trunk only)"

Quickly checking at the code, I think other geometry types are OK, but perhaps 
we should have more extensive cases :
- adding Z shapefiles of other geometry types generated with GDAL 2.0 and 
checking that the ExportToIsoWKT() read with trunk is the one expected
- and/or generating Z shapes with trunk and checking they are read as Z only 
with ExportToIsoWKT()

> 
> Ari
> 
> 09.02.2016, 17:07, Ari Jolma kirjoitti:
> > I declare this motion passed with +1 from Even, Tamas, Jukka and
> > Daniel and no -1.
> > 
> > I'll commit soon the changes to the core and then later the drivers:
> > memory, shape and pg. The goal is to keep the travis test build passing.
> > 
> > Ari
> > 
> > 05.02.2016, 10:04, Ari Jolma kirjoitti:
> >> I'd like to ask the PSC and others to vote on adopting RFC 61:
> >> Support for measured geometries.
> >> 
> >> The draft RFC is at
> >> 
> >> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> >> 
> >> and a draft implementation is at
> >> 
> >> https://github.com/ajolma/GDAL-XYZM
> >> 
> >> which is tested at
> >> 
> >> https://travis-ci.org/ajolma/GDAL-XYZM
> >> 
> >> (the test #34, which passed, was the so far last one after core
> >> changes with unchanged autotests and a rather comprehensive set of
> >> WKT tests in the Perl tests directory)
> >> 
> >> This is seemingly a small change but it is at the heart of OGR so it
> >> has some important implications. The only backwards incompatibilities
> >> that have appeared so far are with some drivers, for example
> >> shapefile, which can be lessened with, e.g., open options.
> >> 
> >> Best,
> >> 
> >> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb 10 04:04:38 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 10 Feb 2016 12:04:38 +0000 (UTC)
Subject: [gdal-dev] RFC 61: Call for vote on adoption
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
 <56BB1E83.5000701@gmail.com>
Message-ID: <loom.20160210T125516-929@post.gmane.org>

Ari Jolma <ari.jolma <at> gmail.com> writes:

> 
> 
>     One more issue came up.
>     Shapefiles, which have Z will also have M, at least a placeholder
>     for it.
>     Having shapefiles as XYZM always in that case may be problematic.
>     It is possible to use the open options SHPT=type to override the
>     default. We could have Z => XYZ as default for backwards
>     compatibility and require open option for Z  => XYZM.
>     Ari09.02.2016, 17:07, Ari Jolma kirjoitti:

I noticed your changeset and I was just reading the shapefile specification.
I never knew that there are no separate XYZ and XYZM shapetypes. I also
believe I have never met a shapefile that really contains XYZM data.

I agree that the default should be to convert such shapefiles to XYZ instead
of XYZM. That would affect shapetype values

11 PointZ
13 PolyLineZ
15 PolygonZ
18 MultiPointZ

-Jukka Rahkonen-



From p.halls at york.ac.uk  Wed Feb 10 04:05:20 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Wed, 10 Feb 2016 12:05:20 +0000
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BB1E83.5000701@gmail.com>
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
 <56BB1E83.5000701@gmail.com>
Message-ID: <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>

Ari, et al,

      ESRI handle this in a non-intuitive way:  XYM is supported, but Z
always has a Measure, so is XYZM!   The formal definition is here:
https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf   (1998)

      Shape Types having Z are defined on pp19ff where it states:

"Shape Types inX,Y,Z Space
Shapes of this type have an optional coordinate
M. Note that "no data" value can be specified as a value for M (see Numeric
Types on page 2).
PointZ
A PointZ consists of a triplet of double-precision coordinates in the order
X, Y, Z plus a measure"

I had misinterpreted their meaning of "optional" here and submitted a
documentation query to ESRI on being told I was wrong.  The response was
that M being optional means that it can be valueless, but is always present.

Best wishes,

Peter
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160210/6b85ced4/attachment-0001.html>

From ari.jolma at gmail.com  Wed Feb 10 04:22:49 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 10 Feb 2016 14:22:49 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602101255.57193.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
 <56BB1E83.5000701@gmail.com> <201602101255.57193.even.rouault@spatialys.com>
Message-ID: <56BB2B99.30506@gmail.com>

10.02.2016, 13:55, Even Rouault kirjoitti:
> Le mercredi 10 février 2016 12:26:59, Ari Jolma a écrit :
>> One more issue came up.
>>
>> Shapefiles, which have Z will also have M, at least a placeholder for it.
>>
>> Having shapefiles as XYZM always in that case may be problematic.
> Small precision for those not necessarily familiar with the internals of the
> shapefile format. The .shp and .shx header have a declared shape type (used to
> set the OGR layer geometry type), that can be (restricting to the case of
> polygon for the sake of clarity, but true for other geometry types) :
> SHPT_POLYGON : the shapefile contains only Polygon 2D shapes
> SHPT_POLYGONZ:  the shapefile may contain a mix of PolygonZ or PolygonZM shapes

Would you differentiate between *Z or *ZM and * and *M shapes using the 
ESRI "no data":

"Nevertheless, shapefiles support the concept of "no data" values, but 
they are currently used only for measures. Any floating point number 
smaller than –1038 is considered by a shapefile reader to
represent a "no data" value."



> SHPT_POLYGONM: the shapefile may contain a mix of Polygon or PolygonM shapes
>
> Declaring a SHPT_POLYGONM as a PolygonM layer is OK (if the shapefile doesn't
> contain PolygonM shapes, it should declare only SHPT_POLYGON)
>
> But declaring SHPT_POLYGONZ as a PolygonZM layer, when there are in fact no
> PolygonZM shapes in it but just PolygonZ, is more problematic for backward
> compatibility issues. Ideally when dealing with shapefiles without M values we
> shouldn't advertize M neither in the layer geometry type, nor in the feature
> geometry.
>
>> It is possible to use the open options SHPT=type to override the
>> default. We could have Z => XYZ as default for backwards compatibility
>> and require open option for Z  => XYZM.
> That's one possibility. As open options should be a last resort, if SHPT isn't
> specified perhaps we could do a probing of the first shape. If it has a M
> component then advertize xxxxZM geometry type, otherwise just xxxxxZ. That's
> of course not completely bullet proof as there can be in theory a mix of Z and
> ZM shapes, but my feeling is that this should work in > 90% of the cases.
>
> That's an improvement I could have a look at during the Code Sprint if you
> don't feel confident enough in the shape driver.

Feel free to have a look. I'm now stuck with the pg driver :)

Maybe, if what I wrote above is correct, read the whole shapefile in and 
then, if all M values are "no data" downgrade all geometries to XY or XYZ?

Ari


>
>
> ~~~~~
>
> Somehow related issue I've noticed but that should be more easily fixable. Now
> creating a Polygon25D shapefile creates PolygonZM and not PolygonZ shapes (and
> perhaps true for other shape types).
>
> trunk:
> $ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
> $ ll poly25d.*
> -rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
> -rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
> -rw-r--r-- 1 even even 8820 2016-02-10 12:36 poly25d.shp
> -rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx
>
> 2.0:
> $ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
> $ ll poly25d.*
> -rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
> -rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
> -rw-r--r-- 1 even even 6700 2016-02-10 12:36 poly25d.shp
> -rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx
>
> On the read size, I've commited https://trac.osgeo.org/gdal/changeset/33408
> "Shape: fix crash when reading a MultiPointZ without M values, and when reading
> a PointZ without M do not create a PointZM geometry (trunk only)"
>
> Quickly checking at the code, I think other geometry types are OK, but perhaps
> we should have more extensive cases :
> - adding Z shapefiles of other geometry types generated with GDAL 2.0 and
> checking that the ExportToIsoWKT() read with trunk is the one expected
> - and/or generating Z shapes with trunk and checking they are read as Z only
> with ExportToIsoWKT()
>
>> Ari
>>
>> 09.02.2016, 17:07, Ari Jolma kirjoitti:
>>> I declare this motion passed with +1 from Even, Tamas, Jukka and
>>> Daniel and no -1.
>>>
>>> I'll commit soon the changes to the core and then later the drivers:
>>> memory, shape and pg. The goal is to keep the travis test build passing.
>>>
>>> Ari
>>>
>>> 05.02.2016, 10:04, Ari Jolma kirjoitti:
>>>> I'd like to ask the PSC and others to vote on adopting RFC 61:
>>>> Support for measured geometries.
>>>>
>>>> The draft RFC is at
>>>>
>>>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>>>
>>>> and a draft implementation is at
>>>>
>>>> https://github.com/ajolma/GDAL-XYZM
>>>>
>>>> which is tested at
>>>>
>>>> https://travis-ci.org/ajolma/GDAL-XYZM
>>>>
>>>> (the test #34, which passed, was the so far last one after core
>>>> changes with unchanged autotests and a rather comprehensive set of
>>>> WKT tests in the Perl tests directory)
>>>>
>>>> This is seemingly a small change but it is at the heart of OGR so it
>>>> has some important implications. The only backwards incompatibilities
>>>> that have appeared so far are with some drivers, for example
>>>> shapefile, which can be lessened with, e.g., open options.
>>>>
>>>> Best,
>>>>
>>>> Ari


From even.rouault at spatialys.com  Wed Feb 10 04:31:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Feb 2016 13:31:14 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
Message-ID: <201602101331.14654.even.rouault@spatialys.com>

Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
> Ari, et al,
> 
>       ESRI handle this in a non-intuitive way:  XYM is supported, but Z
> always has a Measure, so is XYZM!   The formal definition is here:
> https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf   (1998)
> 
>       Shape Types having Z are defined on pp19ff where it states:
> 
> "Shape Types inX,Y,Z Space
> Shapes of this type have an optional coordinate
> M. Note that "no data" value can be specified as a value for M (see Numeric
> Types on page 2).
> PointZ
> A PointZ consists of a triplet of double-precision coordinates in the order
> X, Y, Z plus a measure"
> 
> I had misinterpreted their meaning of "optional" here and submitted a
> documentation query to ESRI on being told I was wrong.  The response was
> that M being optional means that it can be valueless, but is always
> present.

Woo, really ???? That's a genuine scoop.

Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles 
without M values for more than 20 years. I'm surprised we wouldn't have heard 
about that if such shapefiles couldn't be read. Or perhaps ESRI software is 
robust to missing M too

> 
> Best wishes,
> 
> Peter

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Feb 10 04:38:58 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Feb 2016 13:38:58 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BB2B99.30506@gmail.com>
References: <56B45770.7000405@gmail.com>
 <201602101255.57193.even.rouault@spatialys.com> <56BB2B99.30506@gmail.com>
Message-ID: <201602101338.58882.even.rouault@spatialys.com>

Le mercredi 10 février 2016 13:22:49, Ari Jolma a écrit :
> 10.02.2016, 13:55, Even Rouault kirjoitti:
> > Le mercredi 10 février 2016 12:26:59, Ari Jolma a écrit :
> >> One more issue came up.
> >> 
> >> Shapefiles, which have Z will also have M, at least a placeholder for
> >> it.
> >> 
> >> Having shapefiles as XYZM always in that case may be problematic.
> > 
> > Small precision for those not necessarily familiar with the internals of
> > the shapefile format. The .shp and .shx header have a declared shape
> > type (used to set the OGR layer geometry type), that can be (restricting
> > to the case of polygon for the sake of clarity, but true for other
> > geometry types) : SHPT_POLYGON : the shapefile contains only Polygon 2D
> > shapes
> > SHPT_POLYGONZ:  the shapefile may contain a mix of PolygonZ or PolygonZM
> > shapes
> 
> Would you differentiate between *Z or *ZM and * and *M shapes using the
> ESRI "no data":
> 
> "Nevertheless, shapefiles support the concept of "no data" values, but
> they are currently used only for measures. Any floating point number
> smaller than –1038 is considered by a shapefile reader to
> represent a "no data" value."

Given latest Peter's message, yes likely. And also completely missing M as 
produced by shapelib up to now.

> 
> > SHPT_POLYGONM: the shapefile may contain a mix of Polygon or PolygonM
> > shapes
> > 
> > Declaring a SHPT_POLYGONM as a PolygonM layer is OK (if the shapefile
> > doesn't contain PolygonM shapes, it should declare only SHPT_POLYGON)
> > 
> > But declaring SHPT_POLYGONZ as a PolygonZM layer, when there are in fact
> > no PolygonZM shapes in it but just PolygonZ, is more problematic for
> > backward compatibility issues. Ideally when dealing with shapefiles
> > without M values we shouldn't advertize M neither in the layer geometry
> > type, nor in the feature geometry.
> > 
> >> It is possible to use the open options SHPT=type to override the
> >> default. We could have Z => XYZ as default for backwards compatibility
> >> and require open option for Z  => XYZM.
> > 
> > That's one possibility. As open options should be a last resort, if SHPT
> > isn't specified perhaps we could do a probing of the first shape. If it
> > has a M component then advertize xxxxZM geometry type, otherwise just
> > xxxxxZ. That's of course not completely bullet proof as there can be in
> > theory a mix of Z and ZM shapes, but my feeling is that this should work
> > in > 90% of the cases.
> > 
> > That's an improvement I could have a look at during the Code Sprint if
> > you don't feel confident enough in the shape driver.
> 
> Feel free to have a look. I'm now stuck with the pg driver :)

Hopefully it is less tricky than shapefiles. I see there are other test 
failures related to shapefiles as well

> 
> Maybe, if what I wrote above is correct, read the whole shapefile in and
> then, if all M values are "no data" downgrade all geometries to XY or XYZ?

For performance reason, I'd perhaps not read all M values of all shapes, but 
only the ones of the first shape.

An extra enhancement would be to have an option to do a full scan of the 
shapefile. We could also use that to avoid advertizing Polygon layer geometry 
type when there's a mix of Polygon/MultiPolygon. 

> 
> Ari
> 
> > ~~~~~
> > 
> > Somehow related issue I've noticed but that should be more easily
> > fixable. Now creating a Polygon25D shapefile creates PolygonZM and not
> > PolygonZ shapes (and perhaps true for other shape types).
> > 
> > trunk:
> > $ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
> > $ ll poly25d.*
> > -rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
> > -rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
> > -rw-r--r-- 1 even even 8820 2016-02-10 12:36 poly25d.shp
> > -rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx
> > 
> > 2.0:
> > $ ogr2ogr poly25d.shp poly.shp -nlt multipolygon25d -overwrite
> > $ ll poly25d.*
> > -rw-r--r-- 1 even even  529 2016-02-10 12:36 poly25d.dbf
> > -rw-r--r-- 1 even even  557 2016-02-10 12:36 poly25d.prj
> > -rw-r--r-- 1 even even 6700 2016-02-10 12:36 poly25d.shp
> > -rw-r--r-- 1 even even  180 2016-02-10 12:36 poly25d.shx
> > 
> > On the read size, I've commited
> > https://trac.osgeo.org/gdal/changeset/33408 "Shape: fix crash when
> > reading a MultiPointZ without M values, and when reading a PointZ
> > without M do not create a PointZM geometry (trunk only)"
> > 
> > Quickly checking at the code, I think other geometry types are OK, but
> > perhaps we should have more extensive cases :
> > - adding Z shapefiles of other geometry types generated with GDAL 2.0 and
> > checking that the ExportToIsoWKT() read with trunk is the one expected
> > - and/or generating Z shapes with trunk and checking they are read as Z
> > only with ExportToIsoWKT()
> > 
> >> Ari
> >> 
> >> 09.02.2016, 17:07, Ari Jolma kirjoitti:
> >>> I declare this motion passed with +1 from Even, Tamas, Jukka and
> >>> Daniel and no -1.
> >>> 
> >>> I'll commit soon the changes to the core and then later the drivers:
> >>> memory, shape and pg. The goal is to keep the travis test build
> >>> passing.
> >>> 
> >>> Ari
> >>> 
> >>> 05.02.2016, 10:04, Ari Jolma kirjoitti:
> >>>> I'd like to ask the PSC and others to vote on adopting RFC 61:
> >>>> Support for measured geometries.
> >>>> 
> >>>> The draft RFC is at
> >>>> 
> >>>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> >>>> 
> >>>> and a draft implementation is at
> >>>> 
> >>>> https://github.com/ajolma/GDAL-XYZM
> >>>> 
> >>>> which is tested at
> >>>> 
> >>>> https://travis-ci.org/ajolma/GDAL-XYZM
> >>>> 
> >>>> (the test #34, which passed, was the so far last one after core
> >>>> changes with unchanged autotests and a rather comprehensive set of
> >>>> WKT tests in the Perl tests directory)
> >>>> 
> >>>> This is seemingly a small change but it is at the heart of OGR so it
> >>>> has some important implications. The only backwards incompatibilities
> >>>> that have appeared so far are with some drivers, for example
> >>>> shapefile, which can be lessened with, e.g., open options.
> >>>> 
> >>>> Best,
> >>>> 
> >>>> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From p.halls at york.ac.uk  Wed Feb 10 04:53:28 2016
From: p.halls at york.ac.uk (Peter Halls)
Date: Wed, 10 Feb 2016 12:53:28 +0000
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602101331.14654.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
Message-ID: <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>

> Types on page 2).
> PointZ
> A PointZ consists of a triplet of double-precision coordinates in the
order
> X, Y, Z plus a measure"
>
> I had misinterpreted their meaning of "optional" here and submitted a
> documentation query to ESRI on being told I was wrong.  The response was
> that M being optional means that it can be valueless, but is always
> present.

Woo, really ???? That's a genuine scoop.

I reported it to  Frank at the time ... but several email systems later, I
no longer have my copies of the correspondence with ESRI nor the OGR bug
report, in which these were copied.  Somewhere I may still have a backup of
my work area, to see what I did in my code.  However, as you say, this is
20+ years ago ....  It was something which, at the time, was causing us
some problems ....

I think you to be correct in your Shapelib summary below:

Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
without M values for more than 20 years. I'm surprised we wouldn't have
heard about that if such shapefiles couldn't be read. Or perhaps ESRI
software is robust to missing M too

Best wishes,

Peter




On 10 February 2016 at 12:31, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
> > Ari, et al,
> >
> >       ESRI handle this in a non-intuitive way:  XYM is supported, but Z
> > always has a Measure, so is XYZM!   The formal definition is here:
> > https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf   (1998)
> >
> >       Shape Types having Z are defined on pp19ff where it states:
> >
> > "Shape Types inX,Y,Z Space
> > Shapes of this type have an optional coordinate
> > M. Note that "no data" value can be specified as a value for M (see
> Numeric
> > Types on page 2).
> > PointZ
> > A PointZ consists of a triplet of double-precision coordinates in the
> order
> > X, Y, Z plus a measure"
> >
> > I had misinterpreted their meaning of "optional" here and submitted a
> > documentation query to ESRI on being told I was wrong.  The response was
> > that M being optional means that it can be valueless, but is always
> > present.
>
> Woo, really ???? That's a genuine scoop.
>
> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
> without M values for more than 20 years. I'm surprised we wouldn't have
> heard
> about that if such shapefiles couldn't be read. Or perhaps ESRI software is
> robust to missing M too
>
> >
> > Best wishes,
> >
> > Peter
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
----------------------------------------------------------------------------------------------------------------
Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
(PRDU),
                      University of York

Snail mail: PRDU, Derwent College, University of York,
                Heslington, York YO10 5DD
This message has the status of a private and personal communication
----------------------------------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160210/34753d79/attachment.html>

From even.rouault at spatialys.com  Wed Feb 10 05:05:18 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 10 Feb 2016 14:05:18 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
References: <56B45770.7000405@gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
Message-ID: <201602101405.19117.even.rouault@spatialys.com>

Le mercredi 10 février 2016 13:53:28, Peter Halls a écrit :
> > Types on page 2).
> > PointZ
> > A PointZ consists of a triplet of double-precision coordinates in the
> 
> order
> 
> > X, Y, Z plus a measure"
> > 
> > I had misinterpreted their meaning of "optional" here and submitted a
> > documentation query to ESRI on being told I was wrong.  The response was
> > that M being optional means that it can be valueless, but is always
> > present.
> 
> Woo, really ???? That's a genuine scoop.
> 
> I reported it to  Frank at the time ... but several email systems later, I
> no longer have my copies of the correspondence with ESRI nor the OGR bug
> report, in which these were copied.  Somewhere I may still have a backup of
> my work area, to see what I did in my code.  However, as you say, this is
> 20+ years ago ....  It was something which, at the time, was causing us
> some problems ....
> 
> I think you to be correct in your Shapelib summary below:
> 
> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
> without M values for more than 20 years. I'm surprised we wouldn't have
> heard about that if such shapefiles couldn't be read. Or perhaps ESRI
> software is robust to missing M too

Would someone looking at this discussion and having access to ESRI software be 
willing to generate tiny (meaning just one single shape, with the smallest 
number of vertices) shapefiles of type PointZ, ArcZ, PolygonZ and MultiPointZ, 
and *without* M values ? So as to enhance the test suite and see in particular 
which value is set exactly as the nodata value in the M component

I was wondering if we should change the behaviour of the shape driver to add 
that nodata M component for XYZ shapes. This wouldn't cause compat problems 
with previous versions of GDAL, but it would cause .shp sizes to grow by ~ 
1/3. So perhaps go on with current behaviour of stripping M component if most 
implementations seem to be OK with that ?

> 
> Best wishes,
> 
> Peter
> 
> 
> 
> 
> On 10 February 2016 at 12:31, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
> > > Ari, et al,
> > > 
> > >       ESRI handle this in a non-intuitive way:  XYM is supported, but Z
> > > 
> > > always has a Measure, so is XYZM!   The formal definition is here:
> > > https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf  
> > > (1998)
> > > 
> > >       Shape Types having Z are defined on pp19ff where it states:
> > > "Shape Types inX,Y,Z Space
> > > Shapes of this type have an optional coordinate
> > > M. Note that "no data" value can be specified as a value for M (see
> > 
> > Numeric
> > 
> > > Types on page 2).
> > > PointZ
> > > A PointZ consists of a triplet of double-precision coordinates in the
> > 
> > order
> > 
> > > X, Y, Z plus a measure"
> > > 
> > > I had misinterpreted their meaning of "optional" here and submitted a
> > > documentation query to ESRI on being told I was wrong.  The response
> > > was that M being optional means that it can be valueless, but is
> > > always present.
> > 
> > Woo, really ???? That's a genuine scoop.
> > 
> > Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
> > without M values for more than 20 years. I'm surprised we wouldn't have
> > heard
> > about that if such shapefiles couldn't be read. Or perhaps ESRI software
> > is robust to missing M too
> > 
> > > Best wishes,
> > > 
> > > Peter
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Wed Feb 10 05:21:02 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 10 Feb 2016 05:21:02 -0800
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
Message-ID: <CACmBxyvpWagaihjr8Oexmz-CN6iUv_mGMmpN95ojORbin9h23A@mail.gmail.com>

I'm +0.  Neither for nor against.

One request:

#define OGR_G_NOT_EMPTY_POINT 0x1
#define OGR_G_3D 0x2
#define OGR_G_MEASURED 0x4
#define OGR_G_IGNORE_MEASURED 0x8

Can you make these a static const int or static const unsigned int member
of the OGRGeometry class?  #defines make life more difficult.

find . -name \*.h -o -name \*.cpp | xargs grep '#define' | egrep '[0-9"]' |
egrep -v '[(]|\[' | wc -l
    4517

A random example of doing this:

https://trac.osgeo.org/gdal/browser/trunk/gdal/alg/gdal_simplesurf.h?rev=33127#L93

// Descriptor length
static const int DESC_SIZE = 64;

-kurt


On Wed, Feb 10, 2016 at 4:53 AM, Peter Halls <p.halls at york.ac.uk> wrote:

> > Types on page 2).
> > PointZ
> > A PointZ consists of a triplet of double-precision coordinates in the
> order
> > X, Y, Z plus a measure"
> >
> > I had misinterpreted their meaning of "optional" here and submitted a
> > documentation query to ESRI on being told I was wrong.  The response was
> > that M being optional means that it can be valueless, but is always
> > present.
>
> Woo, really ???? That's a genuine scoop.
>
> I reported it to  Frank at the time ... but several email systems later, I
> no longer have my copies of the correspondence with ESRI nor the OGR bug
> report, in which these were copied.  Somewhere I may still have a backup of
> my work area, to see what I did in my code.  However, as you say, this is
> 20+ years ago ....  It was something which, at the time, was causing us
> some problems ....
>
> I think you to be correct in your Shapelib summary below:
>
> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
> without M values for more than 20 years. I'm surprised we wouldn't have
> heard about that if such shapefiles couldn't be read. Or perhaps ESRI
> software is robust to missing M too
>
> Best wishes,
>
> Peter
>
>
>
>
> On 10 February 2016 at 12:31, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
>> > Ari, et al,
>> >
>> >       ESRI handle this in a non-intuitive way:  XYM is supported, but Z
>> > always has a Measure, so is XYZM!   The formal definition is here:
>> > https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf
>>  (1998)
>> >
>> >       Shape Types having Z are defined on pp19ff where it states:
>> >
>> > "Shape Types inX,Y,Z Space
>> > Shapes of this type have an optional coordinate
>> > M. Note that "no data" value can be specified as a value for M (see
>> Numeric
>> > Types on page 2).
>> > PointZ
>> > A PointZ consists of a triplet of double-precision coordinates in the
>> order
>> > X, Y, Z plus a measure"
>> >
>> > I had misinterpreted their meaning of "optional" here and submitted a
>> > documentation query to ESRI on being told I was wrong.  The response was
>> > that M being optional means that it can be valueless, but is always
>> > present.
>>
>> Woo, really ???? That's a genuine scoop.
>>
>> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
>> without M values for more than 20 years. I'm surprised we wouldn't have
>> heard
>> about that if such shapefiles couldn't be read. Or perhaps ESRI software
>> is
>> robust to missing M too
>>
>> >
>> > Best wishes,
>> >
>> > Peter
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
>
> --
>
> ----------------------------------------------------------------------------------------------------------------
> Peter J Halls, PhD Student, Post-war Reconstruction and Development Unit
> (PRDU),
>                       University of York
>
> Snail mail: PRDU, Derwent College, University of York,
>                 Heslington, York YO10 5DD
> This message has the status of a private and personal communication
>
> ----------------------------------------------------------------------------------------------------------------
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160210/74a2e4b8/attachment.html>

From ssaniev at gmail.com  Wed Feb 10 06:29:18 2016
From: ssaniev at gmail.com (ssaniev)
Date: Wed, 10 Feb 2016 06:29:18 -0800 (PST)
Subject: [gdal-dev] Native library load failed while using gdal maven
 dependency - UnsatisfiedLinkError
In-Reply-To: <1455049426771-5249772.post@n6.nabble.com>
References: <1455035313516-5249728.post@n6.nabble.com>
 <CAGLyg+okLXSTHh7vyb3ktSSQw5iWKUorUEcf_egr83KZX5MT+w@mail.gmail.com>
 <1455047210358-5249767.post@n6.nabble.com>
 <CAGLyg+r1nkcPa09H0kTuKERdjqtHMdMNQrCjrnNR5sqdydQJAw@mail.gmail.com>
 <1455049426771-5249772.post@n6.nabble.com>
Message-ID: <1455114558084-5249930.post@n6.nabble.com>

So the solution for using gdal bindings in java was to install the proper
version which came with all the dll's and simply using the jar from the
maven repo.

I installed core gdal installer in windows, and set my environment
variables, and gdal jar started to work correctly in my maven project.

Installer used:
http://www.gisinternals.com/release.php
gdal-111-1800-x64-core.msi	Generic installer for the GDAL core components
http://download.gisinternals.com/sdk/downloads/release-1800-x64-gdal-1-11-3-mapserver-6-4-2/gdal-111-1800-x64-core.msi

maven dependency:
<dependency>
	<groupId>org.gdal</groupId>
	<artifactId>gdal</artifactId>
	<version>1.11.2</version>
</dependency>
			

Environment variables:
GDAL_BIN=C:\Program Files\GDAL
GDAL_DATA=C:\Program Files\GDAL\gdal-data
GDAL_DRIVER=C:\Program Files\GDAL\gdalplugins

Also in eclipse, passing in as a VM argument to find needed *.dll-s :
-Djava.library.path="C:\Program Files\GDAL;${env_var:PATH}"

---------------------------------------

So code works at this point. 

import org.gdal.gdal.gdal;
import org.gdal.ogr.ogr;

public class ShapeFileWorker {
    ogr.RegisterAll();
    gdal.AllRegister();
    gdal.VersionInfo();
}



Pulled a lot of hairs until now, but finally works.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Native-library-load-failed-while-using-gdal-maven-dependency-UnsatisfiedLinkError-tp5249728p5249930.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From ari.jolma at gmail.com  Wed Feb 10 07:34:08 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 10 Feb 2016 17:34:08 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <CACmBxyvpWagaihjr8Oexmz-CN6iUv_mGMmpN95ojORbin9h23A@mail.gmail.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
 <CACmBxyvpWagaihjr8Oexmz-CN6iUv_mGMmpN95ojORbin9h23A@mail.gmail.com>
Message-ID: <56BB5870.2090907@gmail.com>


10.02.2016, 15:21, Kurt Schwehr kirjoitti:
>
> One request:
>
> #define OGR_G_NOT_EMPTY_POINT 0x1
> #define OGR_G_3D 0x2
> #define OGR_G_MEASURED 0x4
> #define OGR_G_IGNORE_MEASURED 0x8
> Can you make these a static const int or static const unsigned int 
> member of the OGRGeometry class?  #defines make life more difficult.

These constants are used also outside the classes. How does one access 
those for example in OGRWktReadPointsM, which receives the flags as a 
parameter?

Ari


From schwehr at gmail.com  Wed Feb 10 07:56:25 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Wed, 10 Feb 2016 07:56:25 -0800
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BB5870.2090907@gmail.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
 <CACmBxyvpWagaihjr8Oexmz-CN6iUv_mGMmpN95ojORbin9h23A@mail.gmail.com>
 <56BB5870.2090907@gmail.com>
Message-ID: <CACmBxysZPD4h1+kKiQv9KvszrVQaUpt6mobffv+mDSd+S73AVA@mail.gmail.com>

OGRGeometry::OGR_G_NOT_EMPTY_POINT

On Wed, Feb 10, 2016 at 7:34 AM, Ari Jolma <ari.jolma at gmail.com> wrote:

>
> 10.02.2016, 15:21, Kurt Schwehr kirjoitti:
>
>>
>> One request:
>>
>> #define OGR_G_NOT_EMPTY_POINT 0x1
>> #define OGR_G_3D 0x2
>> #define OGR_G_MEASURED 0x4
>> #define OGR_G_IGNORE_MEASURED 0x8
>> Can you make these a static const int or static const unsigned int member
>> of the OGRGeometry class?  #defines make life more difficult.
>>
>
> These constants are used also outside the classes. How does one access
> those for example in OGRWktReadPointsM, which receives the flags as a
> parameter?
>
> Ari
>
>


-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160210/f171c152/attachment.html>

From ari.jolma at gmail.com  Wed Feb 10 08:11:39 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 10 Feb 2016 18:11:39 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602101405.19117.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
 <201602101405.19117.even.rouault@spatialys.com>
Message-ID: <56BB613B.1060703@gmail.com>

I've started a wiki page for the status of the drivers regarding 
measured geometries:

https://trac.osgeo.org/gdal/wiki/MeasuredGeometriesInDrivers

Ari

10.02.2016, 15:05, Even Rouault kirjoitti:
> Le mercredi 10 février 2016 13:53:28, Peter Halls a écrit :
>>> Types on page 2).
>>> PointZ
>>> A PointZ consists of a triplet of double-precision coordinates in the
>> order
>>
>>> X, Y, Z plus a measure"
>>>
>>> I had misinterpreted their meaning of "optional" here and submitted a
>>> documentation query to ESRI on being told I was wrong.  The response was
>>> that M being optional means that it can be valueless, but is always
>>> present.
>> Woo, really ???? That's a genuine scoop.
>>
>> I reported it to  Frank at the time ... but several email systems later, I
>> no longer have my copies of the correspondence with ESRI nor the OGR bug
>> report, in which these were copied.  Somewhere I may still have a backup of
>> my work area, to see what I did in my code.  However, as you say, this is
>> 20+ years ago ....  It was something which, at the time, was causing us
>> some problems ....
>>
>> I think you to be correct in your Shapelib summary below:
>>
>> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
>> without M values for more than 20 years. I'm surprised we wouldn't have
>> heard about that if such shapefiles couldn't be read. Or perhaps ESRI
>> software is robust to missing M too
> Would someone looking at this discussion and having access to ESRI software be
> willing to generate tiny (meaning just one single shape, with the smallest
> number of vertices) shapefiles of type PointZ, ArcZ, PolygonZ and MultiPointZ,
> and *without* M values ? So as to enhance the test suite and see in particular
> which value is set exactly as the nodata value in the M component
>
> I was wondering if we should change the behaviour of the shape driver to add
> that nodata M component for XYZ shapes. This wouldn't cause compat problems
> with previous versions of GDAL, but it would cause .shp sizes to grow by ~
> 1/3. So perhaps go on with current behaviour of stripping M component if most
> implementations seem to be OK with that ?
>
>> Best wishes,
>>
>> Peter
>>
>>
>>
>>
>> On 10 February 2016 at 12:31, Even Rouault <even.rouault at spatialys.com>
>>
>> wrote:
>>> Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
>>>> Ari, et al,
>>>>
>>>>        ESRI handle this in a non-intuitive way:  XYM is supported, but Z
>>>>
>>>> always has a Measure, so is XYZM!   The formal definition is here:
>>>> https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf
>>>> (1998)
>>>>
>>>>        Shape Types having Z are defined on pp19ff where it states:
>>>> "Shape Types inX,Y,Z Space
>>>> Shapes of this type have an optional coordinate
>>>> M. Note that "no data" value can be specified as a value for M (see
>>> Numeric
>>>
>>>> Types on page 2).
>>>> PointZ
>>>> A PointZ consists of a triplet of double-precision coordinates in the
>>> order
>>>
>>>> X, Y, Z plus a measure"
>>>>
>>>> I had misinterpreted their meaning of "optional" here and submitted a
>>>> documentation query to ESRI on being told I was wrong.  The response
>>>> was that M being optional means that it can be valueless, but is
>>>> always present.
>>> Woo, really ???? That's a genuine scoop.
>>>
>>> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
>>> without M values for more than 20 years. I'm surprised we wouldn't have
>>> heard
>>> about that if such shapefiles couldn't be read. Or perhaps ESRI software
>>> is robust to missing M too
>>>
>>>> Best wishes,
>>>>
>>>> Peter
>>> --
>>> Spatialys - Geospatial professional services
>>> http://www.spatialys.com


From mwtoews at gmail.com  Wed Feb 10 14:22:05 2016
From: mwtoews at gmail.com (Mike Toews)
Date: Thu, 11 Feb 2016 11:22:05 +1300
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602101331.14654.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <CADEnnONWLMLCHe7WEC4tWpCAfpqsD0R3EK2W3n5NytZ0SWwz6Q@mail.gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
Message-ID: <CAM2FmMrd4SZ6NHwzoeYXRosh--Fidxt8PF4pnsj7EYOaA7rF8g@mail.gmail.com>

On 11 February 2016 at 01:31, Even Rouault <even.rouault at spatialys.com> wrote:
> Le mercredi 10 février 2016 13:05:20, Peter Halls a écrit :
>>       ESRI handle this in a non-intuitive way:  XYM is supported, but Z
>> always has a Measure, so is XYZM!   The formal definition is here:
>> https://www.*esri*.com/library/whitepapers/pdfs/*shapefile*.pdf   (1998)
>>
>>       Shape Types having Z are defined on pp19ff where it states:
>>
>> "Shape Types inX,Y,Z Space
>> Shapes of this type have an optional coordinate
>
> Woo, really ???? That's a genuine scoop.
>
> Unless I'm seriously mistaken, shapelib / OGR has produced XYZ shapefiles
> without M values for more than 20 years. I'm surprised we wouldn't have heard
> about that if such shapefiles couldn't be read. Or perhaps ESRI software is
> robust to missing M too

I've looked into this a few years ago, because I found differences in
XYZ files written by GDAL and Esri software. There are two styles of
(e.g.) PointZ files, where the coordinates are written with either
three or four doubles (the last with "no data" if M is not used). The
style of PointZ is determined by the content length provided in the
record header as 16-bit words (either 14 or 18). Therefore, the specs
are correct when they describe M as an "optional coordinate" (p.15).

For XYZ shapefiles, GDAL always write three doubles, whereas Esri
write four doubles with "no data" as the last coordinate. As a result,
Esri's XYZ shp files are slightly larger than GDAL's.

Occasionally I use software that requires PointZ shapefiles to have
four doubles, so my existing workaround is to use Esri's
CopyFeatures_management tool to rewrite the shapefile.

Could "ogr2ogr -dim 4" be added to this RFC to write XYZ[M] Shapefiles
that always use four floats for coordinates, as Esri software does?


On 11 February 2016 at 02:05, Even Rouault <even.rouault at spatialys.com> wrote:
> Would someone looking at this discussion and having access to ESRI software be
> willing to generate tiny (meaning just one single shape, with the smallest
> number of vertices) shapefiles of type PointZ, ArcZ, PolygonZ and MultiPointZ,
> and *without* M values ? So as to enhance the test suite and see in particular
> which value is set exactly as the nodata value in the M component

I can generate these today, and will attach a zip file to
https://trac.osgeo.org/gdal/wiki/MeasuredGeometriesInDrivers

From woklist at kyngchaos.com  Wed Feb 10 14:52:01 2016
From: woklist at kyngchaos.com (William Kyngesburye)
Date: Wed, 10 Feb 2016 16:52:01 -0600
Subject: [gdal-dev] NetCDF+HDF5 and threadsafety
In-Reply-To: <1E0B9380-F71C-4483-853D-EB6B4D59EE7D@kyngchaos.com>
References: <96E7312E-F13B-427F-8B63-F1ED4452D309@kyngchaos.com>
 <201602050010.00220.even.rouault@spatialys.com>
 <364C496A-7E57-4EF9-B671-168279F7AA50@kyngchaos.com>
 <201602050938.40831.even.rouault@spatialys.com>
 <1E0B9380-F71C-4483-853D-EB6B4D59EE7D@kyngchaos.com>
Message-ID: <C9AAB9FE-7B9B-468D-A9B8-BB2BB7B32CC6@kyngchaos.com>

Finally got a chance to test this.

With HDF5 built with thread safety, without HL (of course, no NetCDF4), the multireadtest has no problems on a HDF5 file.

The opposite - no thread safety + HL and NetCDF4, I get a bunch of "pointer being freed was not allocated" errors.

If I force HL + threadsafety (new config option for HDF5), multireadtest again succeeds, and also on a NetCDF4 file.  Austotests also succeed on both.

> On Feb 5, 2016, at 9:23 AM, William Kyngesburye <kyngchaos at kyngchaos.com> wrote:
> 
> On Feb 5, 2016, at 2:38 AM, Even Rouault <even.rouault at spatialys.com> wrote:
>> 
>>>> There's an optionnaly compiled app you can use to test threadsafety :
>>>> 
>>>> cd apps
>>>> make multireadtest
>>>> ./multireadtest -nlo [-oi number_of_iterations] file_to_test
>>>> 
>>>> Increase number_of_iterations so that it runs for a few seconds.
>>> 
>>> How do I trigger building that? 
>> 
>> Just like the above mentionned lines :-) After you've initially built GDAL 
>> from the top directory
> 
> Ah, I'm not reading the details, my brain just saw the run line ;)
> 

-----
William Kyngesburye <kyngchaos*at*kyngchaos*dot*com>
http://www.kyngchaos.com/

[Trillian]  What are you supposed to do WITH a maniacally depressed robot?

[Marvin]  You think you have problems?  What are you supposed to do if you ARE a maniacally depressed robot?  No, don't try and answer, I'm 50,000 times more intelligent than you and even I don't know the answer...

- HitchHiker's Guide to the Galaxy



From mwtoews at gmail.com  Wed Feb 10 16:00:54 2016
From: mwtoews at gmail.com (Mike Toews)
Date: Thu, 11 Feb 2016 13:00:54 +1300
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602101405.19117.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com>
 <201602101331.14654.even.rouault@spatialys.com>
 <CADEnnOMURFmyeWXAg4DWi95-SNikFSspRVY6aB0Cxoy1ZFPRYw@mail.gmail.com>
 <201602101405.19117.even.rouault@spatialys.com>
Message-ID: <CAM2FmMp_u6nHzDcrXmfr9K2KA+AKnjm_tqO-t6mQ=JUj1DsG+g@mail.gmail.com>

On 11 February 2016 at 02:05, Even Rouault <even.rouault at spatialys.com> wrote:
> Would someone looking at this discussion and having access to ESRI software be
> willing to generate tiny (meaning just one single shape, with the smallest
> number of vertices) shapefiles of type PointZ, ArcZ, PolygonZ and MultiPointZ,
> and *without* M values ? So as to enhance the test suite and see in particular
> which value is set exactly as the nodata value in the M component

Done, see https://trac.osgeo.org/gdal/attachment/wiki/MeasuredGeometriesInDrivers/

I created two geometry examples per shapefile, and added an "Expected"
attribute to describe the WKT of the expected geometry. While the M
values were editable (despite not requesting this creation option in
ArcCatalog), I left these as "NaN".

From jukka.rahkonen at maanmittauslaitos.fi  Thu Feb 11 01:53:06 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 11 Feb 2016 09:53:06 +0000 (UTC)
Subject: [gdal-dev] Ogrinfo, WKT and geometries with Z
Message-ID: <loom.20160211T104109-257@post.gmane.org>

Hi,

Ogrinfo is printing the WKT of XYZ geometries this way:

ogrinfo polygonz.gpkg -al
INFO: Open of `polygonz.gpkg'
      using driver `GPKG' successful.

Layer name: polygonz
Geometry: Unknown (any)
Feature Count: 1
Extent: (340.000000, 420.000000) - (560.000000, 580.000000)
Layer SRS WKT:
(unknown)
FID Column = fid
Geometry Column = geom
OGRFeature(polygonz):1
  POLYGON ((340 580 1,560 580 2,560 420 3,340 580 1))


In "OpenGIS® Implementation Standard for Geographic information - Simple
feature access - Part 1: Common architecture" POINT is defined as 2
dimensional. Wouldn't the right WKT be
  POLYGON Z ((340 580 1,560 580 2,560 420 3,340 580 1)) ?

I have tested that some software like OpenJUMP and PostGIS do accept POLYGON
with 3 coordinates while some other like Spatialite do not. Because Ari is
now working with XYZ(M) code would this also be worth a review?

-Jukka Rahkonen-

From ari.jolma at gmail.com  Thu Feb 11 02:14:11 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 11 Feb 2016 12:14:11 +0200
Subject: [gdal-dev] Ogrinfo, WKT and geometries with Z
In-Reply-To: <loom.20160211T104109-257@post.gmane.org>
References: <loom.20160211T104109-257@post.gmane.org>
Message-ID: <56BC5EF3.4050400@gmail.com>

11.02.2016, 11:53, Jukka Rahkonen kirjoitti:
> Hi,
>
> Ogrinfo is printing the WKT of XYZ geometries this way:
>
> ogrinfo polygonz.gpkg -al
> INFO: Open of `polygonz.gpkg'
>        using driver `GPKG' successful.
>
> Layer name: polygonz
> Geometry: Unknown (any)
> Feature Count: 1
> Extent: (340.000000, 420.000000) - (560.000000, 580.000000)
> Layer SRS WKT:
> (unknown)
> FID Column = fid
> Geometry Column = geom
> OGRFeature(polygonz):1
>    POLYGON ((340 580 1,560 580 2,560 420 3,340 580 1))
>
>
> In "OpenGIS® Implementation Standard for Geographic information - Simple
> feature access - Part 1: Common architecture" POINT is defined as 2
> dimensional. Wouldn't the right WKT be
>    POLYGON Z ((340 580 1,560 580 2,560 420 3,340 580 1)) ?
>
> I have tested that some software like OpenJUMP and PostGIS do accept POLYGON
> with 3 coordinates while some other like Spatialite do not. Because Ari is
> now working with XYZ(M) code would this also be worth a review?

In GDAL there are two WKT formats. Legacy one and ISO one. Legacy one is 
like above and ISO one prints the Z. I guess ogrinfo is using the legacy 
one.

Ari

>
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu Feb 11 02:15:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 11 Feb 2016 11:15:33 +0100
Subject: [gdal-dev] Ogrinfo, WKT and geometries with Z
In-Reply-To: <loom.20160211T104109-257@post.gmane.org>
References: <loom.20160211T104109-257@post.gmane.org>
Message-ID: <201602111115.33450.even.rouault@spatialys.com>

Le jeudi 11 février 2016 10:53:06, Jukka Rahkonen a écrit :
> Hi,
> 
> Ogrinfo is printing the WKT of XYZ geometries this way:
> 
> ogrinfo polygonz.gpkg -al
> INFO: Open of `polygonz.gpkg'
>       using driver `GPKG' successful.
> 
> Layer name: polygonz
> Geometry: Unknown (any)
> Feature Count: 1
> Extent: (340.000000, 420.000000) - (560.000000, 580.000000)
> Layer SRS WKT:
> (unknown)
> FID Column = fid
> Geometry Column = geom
> OGRFeature(polygonz):1
>   POLYGON ((340 580 1,560 580 2,560 420 3,340 580 1))
> 
> 
> In "OpenGIS® Implementation Standard for Geographic information - Simple
> feature access - Part 1: Common architecture" POINT is defined as 2
> dimensional. Wouldn't the right WKT be
>   POLYGON Z ((340 580 1,560 580 2,560 420 3,340 580 1)) ?
> 
> I have tested that some software like OpenJUMP and PostGIS do accept
> POLYGON with 3 coordinates while some other like Spatialite do not.
> Because Ari is now working with XYZ(M) code would this also be worth a
> review?

Jukka,

The OGRGeometry class can, since GDAL 2.0, depending on a parameter, export 
WKT as the "traditional" form GDAL has always used without Z suffix  (and for M 
/ ZM geometries, it drop the M component), or to be ISO compliant with Z/M/ZM 
suffix.

In C, 
OGR_G_ExportToWkt(): traditional WKT
OGR_G_ExportToIsoWkt(): ISO WKT


>>> print ogr.CreateGeometryFromWkt('POINT Z (1 2 3)').ExportToWkt()
POINT (1 2 3)
>>> print ogr.CreateGeometryFromWkt('POINT M (1 2 3)').ExportToWkt()
POINT (1 2)
>>> print ogr.CreateGeometryFromWkt('POINT ZM (1 2 3 4)').ExportToWkt()
POINT (1 2 3)

>>> print ogr.CreateGeometryFromWkt('POINT Z (1 2 3)').ExportToIsoWkt()
POINT Z (1 2 3)
>>> print ogr.CreateGeometryFromWkt('POINT M (1 2 3)').ExportToIsoWkt()
POINT M (1 2 3)
>>> print ogr.CreateGeometryFromWkt('POINT ZM (1 2 3 4)').ExportToIsoWkt()
POINT ZM (1 2 3 4)


The OGRGeometry::DumpReadable() method used by ogrinfo uses this traditional 
form. There are other places where traditional WKT is used: CSV WKT export, 
...

I'm somewhat ambivalent about switching those places to the ISO compliant way. 
It would require adjustments in the autotest suite, and it's hard to evaluate 
the compatibility impact on third-party software. But on the other hand, it 
would probably a good time to do so.

Even


> 
> -Jukka Rahkonen-
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Feb 11 02:25:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 11 Feb 2016 11:25:14 +0100
Subject: [gdal-dev] Ogrinfo, WKT and geometries with Z
In-Reply-To: <201602111115.33450.even.rouault@spatialys.com>
References: <loom.20160211T104109-257@post.gmane.org>
 <201602111115.33450.even.rouault@spatialys.com>
Message-ID: <201602111125.14601.even.rouault@spatialys.com>

Le jeudi 11 février 2016 11:15:33, Even Rouault a écrit :
> Le jeudi 11 février 2016 10:53:06, Jukka Rahkonen a écrit :
> > Hi,
> > 
> > Ogrinfo is printing the WKT of XYZ geometries this way:
> > 
> > ogrinfo polygonz.gpkg -al
> > INFO: Open of `polygonz.gpkg'
> > 
> >       using driver `GPKG' successful.
> > 
> > Layer name: polygonz
> > Geometry: Unknown (any)
> > Feature Count: 1
> > Extent: (340.000000, 420.000000) - (560.000000, 580.000000)
> > Layer SRS WKT:
> > (unknown)
> > FID Column = fid
> > Geometry Column = geom
> > OGRFeature(polygonz):1
> > 
> >   POLYGON ((340 580 1,560 580 2,560 420 3,340 580 1))
> > 
> > In "OpenGIS® Implementation Standard for Geographic information - Simple
> > feature access - Part 1: Common architecture" POINT is defined as 2
> > dimensional. Wouldn't the right WKT be
> > 
> >   POLYGON Z ((340 580 1,560 580 2,560 420 3,340 580 1)) ?
> > 
> > I have tested that some software like OpenJUMP and PostGIS do accept
> > POLYGON with 3 coordinates while some other like Spatialite do not.
> > Because Ari is now working with XYZ(M) code would this also be worth a
> > review?
> 
> Jukka,
> 
> The OGRGeometry class can, since GDAL 2.0, depending on a parameter, export
> WKT as the "traditional" form GDAL has always used without Z suffix  (and
> for M / ZM geometries, it drop the M component), or to be ISO compliant
> with Z/M/ZM suffix.
> 
> In C,
> OGR_G_ExportToWkt(): traditional WKT
> OGR_G_ExportToIsoWkt(): ISO WKT
> 
> >>> print ogr.CreateGeometryFromWkt('POINT Z (1 2 3)').ExportToWkt()
> 
> POINT (1 2 3)
> 
> >>> print ogr.CreateGeometryFromWkt('POINT M (1 2 3)').ExportToWkt()
> 
> POINT (1 2)
> 
> >>> print ogr.CreateGeometryFromWkt('POINT ZM (1 2 3 4)').ExportToWkt()
> 
> POINT (1 2 3)
> 
> >>> print ogr.CreateGeometryFromWkt('POINT Z (1 2 3)').ExportToIsoWkt()
> 
> POINT Z (1 2 3)
> 
> >>> print ogr.CreateGeometryFromWkt('POINT M (1 2 3)').ExportToIsoWkt()
> 
> POINT M (1 2 3)
> 
> >>> print ogr.CreateGeometryFromWkt('POINT ZM (1 2 3 4)').ExportToIsoWkt()
> 
> POINT ZM (1 2 3 4)
> 
> 
> The OGRGeometry::DumpReadable() method used by ogrinfo uses this
> traditional form. There are other places where traditional WKT is used:
> CSV WKT export, ...
> 
> I'm somewhat ambivalent about switching those places to the ISO compliant
> way. It would require adjustments in the autotest suite, and it's hard to
> evaluate the compatibility impact on third-party software. But on the
> other hand, it would probably a good time to do so.

Hum reading what I've written above, we certainly want, at least, M and ZM 
geometries to be displayed as such by ogrinfo.
So yes I guess we have to switch to the ISO way (or implement a dual mode, 
where we use traditional way for XY and XYZ, and ISO way for XYM and XYZM ? 
Probably not a good idea)

Currently, if I have :

$ cat zm.csv
id,WKT
1,"POINT ZM (1 2 3 4)"

I get

$ ogrinfo zm.csv -al
INFO: Open of `zm.csv'
      using driver `CSV' successful.

Layer name: zm
Geometry: Unknown (any)
Feature Count: 1
Extent: (1.000000, 2.000000) - (1.000000, 2.000000)
Layer SRS WKT:
(unknown)
id: String (0.0)
WKT: String (0.0)
OGRFeature(zm):1
  id (String) = 1
  WKT (String) = POINT ZM (1 2 3 4) <-- this is just the string column, so 
ignore that
  POINT (1 2 3) <-- this is the geometry

Which is clearly not what we want


> 
> Even
> 
> > -Jukka Rahkonen-
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From timothy.astle at caris.com  Thu Feb 11 11:01:39 2016
From: timothy.astle at caris.com (Timothy Astle)
Date: Thu, 11 Feb 2016 15:01:39 -0400
Subject: [gdal-dev] Thoughts about including /I for xcopy in nmake.opt?
Message-ID: <56BCDA93.2030406@caris.com>

I was building GDAL on Windows today and hit a case where the DATADIR 
was defined with a path that did not end with a backslash. That resulted 
in the following prompts:

Does D:\yadda\yadda\gdal specify a file name
or directory name on the target
(F = file, D = directory)?

I was wondering if it'd make sense to update the nmake.opt to include 
the /I switch on xcopy as follows?

INSTALL    =    xcopy /y /r /d /f /I

/I           If destination does not exist and copying more than one file,
              assumes that destination must be a directory.

Tim

From jmckenna at gatewaygeomatics.com  Thu Feb 11 11:16:19 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 11 Feb 2016 15:16:19 -0400
Subject: [gdal-dev] Thoughts about including /I for xcopy in nmake.opt?
In-Reply-To: <56BCDA93.2030406@caris.com>
References: <56BCDA93.2030406@caris.com>
Message-ID: <56BCDE03.2040305@gatewaygeomatics.com>

On 2016-02-11 3:01 PM, Timothy Astle wrote:
> I was building GDAL on Windows today and hit a case where the DATADIR
> was defined with a path that did not end with a backslash. That resulted
> in the following prompts:
>
> Does D:\yadda\yadda\gdal specify a file name
> or directory name on the target
> (F = file, D = directory)?
>
> I was wondering if it'd make sense to update the nmake.opt to include
> the /I switch on xcopy as follows?
>
> INSTALL    =    xcopy /y /r /d /f /I
>
> /I           If destination does not exist and copying more than one file,
>               assumes that destination must be a directory.
>
> Tim
> _______________________________________________

Yes, as I've been answering that question at the prompt when building, 
for over 15 years :)

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/

From timothy.astle at caris.com  Thu Feb 11 11:34:00 2016
From: timothy.astle at caris.com (Timothy Astle)
Date: Thu, 11 Feb 2016 15:34:00 -0400
Subject: [gdal-dev] Thoughts about including /I for xcopy in nmake.opt?
In-Reply-To: <56BCDE03.2040305@gatewaygeomatics.com>
References: <56BCDA93.2030406@caris.com>
 <56BCDE03.2040305@gatewaygeomatics.com>
Message-ID: <56BCE228.7030107@caris.com>

Oh, I'm sorry then.  I better not break your workflow :-P

I'll open up a pull request.

Tim

PS.  Fine job heading up OSGeo Jeff.  Best of luck in the future!


On 11/02/2016 3:16 PM, Jeff McKenna wrote:
> On 2016-02-11 3:01 PM, Timothy Astle wrote:
>> I was building GDAL on Windows today and hit a case where the DATADIR
>> was defined with a path that did not end with a backslash. That resulted
>> in the following prompts:
>>
>> Does D:\yadda\yadda\gdal specify a file name
>> or directory name on the target
>> (F = file, D = directory)?
>>
>> I was wondering if it'd make sense to update the nmake.opt to include
>> the /I switch on xcopy as follows?
>>
>> INSTALL    =    xcopy /y /r /d /f /I
>>
>> /I           If destination does not exist and copying more than one 
>> file,
>>               assumes that destination must be a directory.
>>
>> Tim
>> _______________________________________________
>
> Yes, as I've been answering that question at the prompt when building, 
> for over 15 years :)
>
> -jeff
>
>
>
>

-- 
Tim Astle
Development Manager for Web Technologies

CARIS
115 Waggoners Lane
Fredericton, New Brunswick
Canada     E3B 2L4
Tel: + 1 (506) 458-8533
Fax: +1 (506) 459-3849
www.caris.com

CARIS World Tour 2016
Join Us! For more information
www.caris.com/worldtour

Connect with CARIS
Twitter  |  LinkedIn  |  Facebook  |  YouTube

Download your free copy of CARIS Easy View today! www.caris.com/easyview/


This email and any files transmitted with it are confidential and intended only for the addressee(s). If you are not the intended recipient(s) please notify us by email reply. You should not use, disclose, distribute or copy this communication if received in error.
Any views or opinions expressed in this email are solely those of the author and do not necessarily represent those of the company. No binding contract will result from this email until such time as a written document is signed on behalf of the company.


From andre.hollstein at gfz-potsdam.de  Fri Feb 12 00:36:26 2016
From: andre.hollstein at gfz-potsdam.de (Andre Hollstein)
Date: Fri, 12 Feb 2016 09:36:26 +0100
Subject: [gdal-dev] GDAL 2.0.2 doesn't compile with Kakadu 7.7.1
Message-ID: <56BD998A.1040309@gfz-potsdam.de>

Dear GDAL developers,

I'm trying to build gdal with support to the Kakadu library. My problems 
occur both with gdal 2.0.2 as well which what I checked out from github. 
I have configured a minimal example:

./configure --prefix $prefix_opt \
--with-openjpeg=no --with-jasper=no \
--with-ecw=no \
--with-libtiff=no --without-libtool \
--with-hdf4=no --with-hdf5=no --with-netcdf=no \
--with-geotiff=internal \
--with-grass=no --with-sqlite3=no \
--with-kakadu=/misc/fluo6/andre/projekte/install_py_et_al/python_GFZ/opt
--with-pic \
--with-python=$prefix_python/bin/python \

Output:

GDAL is now configured for x86_64-pc-linux-gnu

   Installation directory: 
/misc/fluo6/andre/projekte/install_py_et_al/python_GFZ/opt
   C compiler:                gcc -fPIC -O3 -fPIC
   C++ compiler:              g++ -g -O2 -fPIC

   LIBTOOL support: no

   LIBZ support: external
   LIBLZMA support: no
   cryptopp support: no
   GRASS support: no
   CFITSIO support: no
   PCRaster support: internal
   LIBPNG support: external
   DDS support: no
   GTA support: no
   LIBTIFF support:           external (BigTIFF=yes)
   LIBGEOTIFF support: internal
   LIBJPEG support: external
   12 bit JPEG: no
   12 bit JPEG-in-TIFF: no
   LIBGIF support: external
   OGDI support: no
   HDF4 support: no
   HDF5 support: no
   Kea support: no
   NetCDF support: no
   Kakadu support: yes
   JasPer support: no
   OpenJPEG support: no
   ECW support: no
   MrSID support: no
   MrSID/MG4 Lidar support: no
   MSG support: no
   GRIB support: yes
   EPSILON support: no
   WebP support: no
   cURL support (wms/wcs/...):yes
   PostgreSQL support: yes
   MRF support: yes
   MySQL support: no
   Ingres support: no
   Xerces-C support: yes
   NAS support: yes
   Expat support: yes
   libxml2 support: no
   Google libkml support: no
   ODBC support: yes
   PGeo support: yes
   FGDB support: no
   MDB support: no
   PCIDSK support:            internal
   OCI support:               no
   GEORASTER support:         no
   SDE support:               no
   Rasdaman support:          no
   DODS support:              no
   SQLite support:            no
   PCRE support:              yes
   SpatiaLite support:        no
   DWGdirect support          no
   INFORMIX DataBlade support:no
   GEOS support:              yes
   QHull support:             internal
   Poppler support:           no
   Podofo support:            no
   PDFium support:            no
   OpenCL support:            no
   Armadillo support:         no
   FreeXL support:            yes
   SOSI support:              no
   MongoDB support:           no


   SWIG Bindings:             python

   Statically link PROJ.4:    no
   enable OGR building:       yes
   enable GNM building:       no
   enable pthread support:    yes
   enable POSIX iconv support:yes
   hide internal symbols:     no


After calling make, it throws an error:


make[1]: Entering directory 
`/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/apps'
g++  gdalinfo_bin.o 
-L/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal 
-lgdal  -lfreexl -L/usr/lib64 -lgeos_c -lodbc -lodbcinst -lexpat 
-lxerces-c -lpthread -lgif -ljpeg -Lno/lib -ltiff -lpng 
-L/usr/lib/postgresql92/lib64 -lpq -lz -lpthread -lm -lrt -ldl 
-L/misc/fluo6/andre/projekte/install_py_et_al/python_GFZ/opt/lib -lkdu 
-lpcre   -lcurl                  -o gdalinfo
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_horz_resample_float(int, 
float*, float*, unsigned int, unsigned int, unsigned int, int, void**, 
int, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to 
`kd_supp_simd::avx2_interleaved_transfer_fix16_to_bytes(void const*, 
void const*, void const*, void const*, int, int, int, int, unsigned 
char*, int, unsigned int, unsigned int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to 
`kd_supp_simd::avx2_convert_and_copy_to_fix16(void const**, int const*, 
int const*, int, int, int, void*, int, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to 
`kd_supp_simd::avx2_transfer_fix16_to_bytes_gap1(void const*, int, int, 
int, int, void*, int, int, bool, float)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_vert_resample_float(int, 
float**, float*, void*, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_horz_resample_fix16(int, 
short*, short*, unsigned int, unsigned int, unsigned int, int, void**, 
int, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_hshuf_fix16_2tap_expand(int, 
short*, short*, unsigned int, unsigned int, unsigned int, int, void**, 
int, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_white_stretch(short const*, 
short*, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_vert_resample_fix16(int, 
short**, short*, void*, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to `kd_supp_simd::avx2_hshuf_float_2tap_expand(int, 
float*, float*, unsigned int, unsigned int, unsigned int, int, void**, 
int, int, int)'
/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/libgdal.so: 
undefined reference to 
`kd_supp_simd::avx2_transfer_fix16_to_bytes_gap4(void const*, int, int, 
int, int, void*, int, int, bool, float)'
collect2: error: ld returned 1 exit status
make[1]: *** [gdalinfo] Error 1
make[1]: Leaving directory 
`/misc/fluo6/andre/projekte/install_py_et_al/tmp/gdal/gdal-2.0.2/github/gdal/gdal/apps'
make: *** [apps-target] Error 2

I did communicate with the folks over at Kakadu and Professor David 
Taubman gave the following comment:

 >Looks like the GDAL build is not building or including the Kakadu 
"avx2_region_decompressor.o" file.
 >You will find this referenced in the standard Kakadu makefiles.  This 
makes sense since that file
 >was added after Kakadu version 7.5 was released. I have not looked 
into the GDAL build system,
 >but it may be selectively building or including Kakadu object files 
rather than using Kakadu's
 >build environment to do so.  The preferred way to include all the 
Kakadu API's is to link against
 >both libkdu_v77R.o and libkdu_a77R.o, where the latter is built by the 
"managed" makefiles.
 >
 >Anyway, it may be that all you have to do is add 
"avx2_region_deocmpressor.o" (and possibly
 >"avx2_region_compositor.o") to the GDAL build environment.

I checked the fmts/o directory and copied all *.o files from kakadu into 
this directory. Then, called make again which ran without errors. When 
using python, I was able to read a jpeg200 image with gdal. However, 
this worked only with 2.0.2, using the version from github, the gdal 
module was missing from python.

So it seems there is a bug in the gdal build system when compiling with 
kakadu 7.7.1

Kind Regards, André Hollstein



-- 
Dr. André Hollstein
Sektion 1.4 Fernerkundung
Tel.: +49 (0)331/288-28969
Fax: +49 (0)331/288-28969
E-Mail: andre.hollstein at gfz-potsdam.de
___________________________________

Helmholtz-Zentrum Potsdam
Deutsches GeoForschungsZentrum GFZ
Stiftung des öff. Rechts Land Brandenburg
Telegrafenberg, 14473 Potsdam
Haus 17, Raum 20.23


From even.rouault at spatialys.com  Fri Feb 12 01:03:16 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Feb 2016 10:03:16 +0100
Subject: [gdal-dev] GDAL 2.0.2 doesn't compile with Kakadu 7.7.1
In-Reply-To: <56BD998A.1040309@gfz-potsdam.de>
References: <56BD998A.1040309@gfz-potsdam.de>
Message-ID: <201602121003.16551.even.rouault@spatialys.com>

Andre,

> The preferred way to include all the
> Kakadu API's is to link against
>  >both libkdu_v77R.o and libkdu_a77R.o, where the latter is built by the
> "managed" makefiles.
>  >Anyway, it may be that all you have to do is add
> "avx2_region_deocmpressor.o" (and possibly
>  >"avx2_region_compositor.o") to the GDAL build environment.

Yes, the kakadu support would probably need to be revisited and linking to a 
single file would be better (although that its changing name, see the v77, is 
kind of annoying...)

Anyway since GDAL 2.0, you need to pass explicitly the Kakadu version by 
defining CXXFLAGS like CXXFLAGS="-DKDU_MAJOR_VERSION=7 -DKDU_MINOR_VERSION=7" 
./configure [other_options]

But Kakadu v7.7 support is in trunk only : you likely need to apply 
https://trac.osgeo.org/gdal/changeset/31517

> 
> I checked the fmts/o directory and copied all *.o files from kakadu into
> this directory. Then, called make again which ran without errors. When
> using python, I was able to read a jpeg200 image with gdal. However,
> this worked only with 2.0.2, using the version from github, the gdal
> module was missing from python.

Perhaps the GDAL Python bindings you use don't link to the GDAL library you 
built manually ? You may have to play with LD_LIBRARY_PATH to point to your 
GDAL libs.

> 
> So it seems there is a bug in the gdal build system when compiling with
> kakadu 7.7.1
> 
> Kind Regards, André Hollstein

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre.hollstein at gfz-potsdam.de  Fri Feb 12 01:13:06 2016
From: andre.hollstein at gfz-potsdam.de (Andre Hollstein)
Date: Fri, 12 Feb 2016 10:13:06 +0100
Subject: [gdal-dev] GDAL 2.0.2 doesn't compile with Kakadu 7.7.1
In-Reply-To: <201602121003.16551.even.rouault@spatialys.com>
References: <56BD998A.1040309@gfz-potsdam.de>
 <201602121003.16551.even.rouault@spatialys.com>
Message-ID: <56BDA222.5090507@gfz-potsdam.de>

Dear Even,

thanks for pointing me to https://trac.osgeo.org/gdal/changeset/31517, I 
will use this. Maybe it would help to avoid confusion to reflect the 
need to set
CXXFLAGS="-DKDU_MAJOR_VERSION=7 -DKDU_MINOR_VERSION=7 in the ./configure 
--help message. I was missing this info.

Thanks a lot again,

André

On 02/12/2016 10:03 AM, Even Rouault wrote:
> Andre,
>
>> The preferred way to include all the
>> Kakadu API's is to link against
>>   >both libkdu_v77R.o and libkdu_a77R.o, where the latter is built by the
>> "managed" makefiles.
>>   >Anyway, it may be that all you have to do is add
>> "avx2_region_deocmpressor.o" (and possibly
>>   >"avx2_region_compositor.o") to the GDAL build environment.
> Yes, the kakadu support would probably need to be revisited and linking to a
> single file would be better (although that its changing name, see the v77, is
> kind of annoying...)
>
> Anyway since GDAL 2.0, you need to pass explicitly the Kakadu version by
> defining CXXFLAGS like CXXFLAGS="-DKDU_MAJOR_VERSION=7 -DKDU_MINOR_VERSION=7"
> ./configure [other_options]
>
> But Kakadu v7.7 support is in trunk only : you likely need to apply
> https://trac.osgeo.org/gdal/changeset/31517
>
>> I checked the fmts/o directory and copied all *.o files from kakadu into
>> this directory. Then, called make again which ran without errors. When
>> using python, I was able to read a jpeg200 image with gdal. However,
>> this worked only with 2.0.2, using the version from github, the gdal
>> module was missing from python.
> Perhaps the GDAL Python bindings you use don't link to the GDAL library you
> built manually ? You may have to play with LD_LIBRARY_PATH to point to your
> GDAL libs.
>
>> So it seems there is a bug in the gdal build system when compiling with
>> kakadu 7.7.1
>>
>> Kind Regards, André Hollstein

-- 
Dr. André Hollstein
Sektion 1.4 Fernerkundung
Tel.: +49 (0)331/288-28969
Fax: +49 (0)331/288-28969
E-Mail: andre.hollstein at gfz-potsdam.de
___________________________________

Helmholtz-Zentrum Potsdam
Deutsches GeoForschungsZentrum GFZ
Stiftung des öff. Rechts Land Brandenburg
Telegrafenberg, 14473 Potsdam
Haus 17, Raum 20.23


From ari.jolma at gmail.com  Fri Feb 12 02:26:46 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 12 Feb 2016 12:26:46 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BB1E83.5000701@gmail.com>
References: <56B45770.7000405@gmail.com> <56BA00A7.8080404@gmail.com>
 <56BB1E83.5000701@gmail.com>
Message-ID: <56BDB366.7080209@gmail.com>

I've fixed this so that currently all tests pass (at least locally).

Now Shapefiles, which are created XY come back as XY, XYM as XYM, XYZ as 
XYZ, and XYZM as XYZM. Also one should be able to set the required 
coordinate combination using parameters - that's not comprehensively 
tested however.

There are still a couple of fixme's in the code (shape2ogr.cpp), writing 
a shape should take into account the requested coordinate combination 
and whether to skip Ms or write them as "no data" (value < 1038 
according to the doc).

I changed the code for OGRFeature::SetGeomFieldDirectly to set or unset 
the geometry M or Z coordinates depending on the geometry field type of 
the feature. That's somewhat bold but the way I did it at least did not 
break anything in the tests.

Ari

10.02.2016, 13:26, Ari Jolma kirjoitti:
> One more issue came up.
>
> Shapefiles, which have Z will also have M, at least a placeholder for it.
>
> Having shapefiles as XYZM always in that case may be problematic.
>
> It is possible to use the open options SHPT=type to override the 
> default. We could have Z => XYZ as default for backwards compatibility 
> and require open option for Z  => XYZM.
>
> Ari
>
>
> 09.02.2016, 17:07, Ari Jolma kirjoitti:
>> I declare this motion passed with +1 from Even, Tamas, Jukka and 
>> Daniel and no -1.
>>
>> I'll commit soon the changes to the core and then later the drivers: 
>> memory, shape and pg. The goal is to keep the travis test build passing.
>>
>> Ari
>>
>> 05.02.2016, 10:04, Ari Jolma kirjoitti:
>>> I'd like to ask the PSC and others to vote on adopting RFC 61: 
>>> Support for measured geometries.
>>>
>>> The draft RFC is at
>>>
>>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
>>>
>>> and a draft implementation is at
>>>
>>> https://github.com/ajolma/GDAL-XYZM
>>>
>>> which is tested at
>>>
>>> https://travis-ci.org/ajolma/GDAL-XYZM
>>>
>>> (the test #34, which passed, was the so far last one after core 
>>> changes with unchanged autotests and a rather comprehensive set of 
>>> WKT tests in the Perl tests directory)
>>>
>>> This is seemingly a small change but it is at the heart of OGR so it 
>>> has some important implications. The only backwards 
>>> incompatibilities that have appeared so far are with some drivers, 
>>> for example shapefile, which can be lessened with, e.g., open options.
>>>
>>> Best,
>>>
>>> Ari
>>>
>>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160212/ad1e8ff4/attachment.html>

From even.rouault at spatialys.com  Fri Feb 12 02:43:18 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Feb 2016 11:43:18 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BDB366.7080209@gmail.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <56BDB366.7080209@gmail.com>
Message-ID: <201602121143.18369.even.rouault@spatialys.com>

Le vendredi 12 février 2016 11:26:46, Ari Jolma a écrit :
> I've fixed this so that currently all tests pass (at least locally).
> 
> Now Shapefiles, which are created XY come back as XY, XYM as XYM, XYZ as
> XYZ, and XYZM as XYZM. Also one should be able to set the required
> coordinate combination using parameters - that's not comprehensively
> tested however.
> 

Great

> There are still a couple of fixme's in the code (shape2ogr.cpp), writing
> a shape should take into account the requested coordinate combination
> and whether to skip Ms or write them as "no data" (value < 1038
> according to the doc).

-10^38

> 
> I changed the code for OGRFeature::SetGeomFieldDirectly to set or unset
> the geometry M or Z coordinates depending on the geometry field type of
> the feature. That's somewhat bold but the way I did it at least did not
> break anything in the tests.

Agreed it is a non trivial change. But it does break things. Crashes in the 
CSW driver for example :
https://travis-ci.org/rouault/gdal_coverage/builds/108752731 .
And other non crashing failures.
Perhaps do this dimension harmonization not in SetGeomFieldDirectly() but in a 
helper function and call it in the shapefile driver if you need it ?
We could also try to fix drivers/tests, but there may be cases where drivers 
cannot declare a consistant coordinate dimensionnality because they have a mix 
of {Geom} and {Geom}Z features

> 
> Ari
> 
> 10.02.2016, 13:26, Ari Jolma kirjoitti:
> > One more issue came up.
> > 
> > Shapefiles, which have Z will also have M, at least a placeholder for it.
> > 
> > Having shapefiles as XYZM always in that case may be problematic.
> > 
> > It is possible to use the open options SHPT=type to override the
> > default. We could have Z => XYZ as default for backwards compatibility
> > and require open option for Z  => XYZM.
> > 
> > Ari
> > 
> > 09.02.2016, 17:07, Ari Jolma kirjoitti:
> >> I declare this motion passed with +1 from Even, Tamas, Jukka and
> >> Daniel and no -1.
> >> 
> >> I'll commit soon the changes to the core and then later the drivers:
> >> memory, shape and pg. The goal is to keep the travis test build passing.
> >> 
> >> Ari
> >> 
> >> 05.02.2016, 10:04, Ari Jolma kirjoitti:
> >>> I'd like to ask the PSC and others to vote on adopting RFC 61:
> >>> Support for measured geometries.
> >>> 
> >>> The draft RFC is at
> >>> 
> >>> https://trac.osgeo.org/gdal/wiki/rfc61_support_for_measured_geometries
> >>> 
> >>> and a draft implementation is at
> >>> 
> >>> https://github.com/ajolma/GDAL-XYZM
> >>> 
> >>> which is tested at
> >>> 
> >>> https://travis-ci.org/ajolma/GDAL-XYZM
> >>> 
> >>> (the test #34, which passed, was the so far last one after core
> >>> changes with unchanged autotests and a rather comprehensive set of
> >>> WKT tests in the Perl tests directory)
> >>> 
> >>> This is seemingly a small change but it is at the heart of OGR so it
> >>> has some important implications. The only backwards
> >>> incompatibilities that have appeared so far are with some drivers,
> >>> for example shapefile, which can be lessened with, e.g., open options.
> >>> 
> >>> Best,
> >>> 
> >>> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Feb 12 04:04:54 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 12 Feb 2016 14:04:54 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602121143.18369.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com> <56BB1E83.5000701@gmail.com>
 <56BDB366.7080209@gmail.com> <201602121143.18369.even.rouault@spatialys.com>
Message-ID: <56BDCA66.1040608@gmail.com>

12.02.2016, 12:43, Even Rouault kirjoitti:
>> There are still a couple of fixme's in the code (shape2ogr.cpp), writing
>> a shape should take into account the requested coordinate combination
>> and whether to skip Ms or write them as "no data" (value < 1038
>> according to the doc).
> -10^38

copy paste error from pdf :)

>
>> I changed the code for OGRFeature::SetGeomFieldDirectly to set or unset
>> the geometry M or Z coordinates depending on the geometry field type of
>> the feature. That's somewhat bold but the way I did it at least did not
>> break anything in the tests.
> Agreed it is a non trivial change. But it does break things. Crashes in the
> CSW driver for example :
> https://travis-ci.org/rouault/gdal_coverage/builds/108752731 .
> And other non crashing failures.
> Perhaps do this dimension harmonization not in SetGeomFieldDirectly() but in a
> helper function and call it in the shapefile driver if you need it ?
> We could also try to fix drivers/tests, but there may be cases where drivers
> cannot declare a consistant coordinate dimensionnality because they have a mix
> of {Geom} and {Geom}Z features

ok, I should perhaps set up a better local test environment.

I now limit the dimension harmonization to the shape driver @33440.

Ari


From even.rouault at spatialys.com  Fri Feb 12 04:54:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 12 Feb 2016 13:54:14 +0100
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <56BDCA66.1040608@gmail.com>
References: <56B45770.7000405@gmail.com>
 <201602121143.18369.even.rouault@spatialys.com> <56BDCA66.1040608@gmail.com>
Message-ID: <201602121354.15088.even.rouault@spatialys.com>

> ok, I should perhaps set up a better local test environment.
> 
> I now limit the dimension harmonization to the shape driver @33440.

Travis seems to be stalled right now, but locally I get a crash with latest 
rev :

  TEST: ogr_shape_15 ... ==4768== Invalid read of size 8
==4768==    at 0x8928771: SHPReadOGRFeature(SHPInfo*, DBFInfo*, 
OGRFeatureDefn*, int, tagSHPObject*, char const*) (shape2ogr.cpp:1164)
==4768==    by 0x8810A30: OGRShapeLayer::FetchShape(int) 
(ogrshapelayer.cpp:730)
==4768==    by 0x8810C14: OGRShapeLayer::GetNextFeature() 
(ogrshapelayer.cpp:794)
==4768==    by 0x86B1359: OGR_L_GetNextFeature (ogrlayer.cpp:550)
==4768==    by 0x2047E979: _wrap_Layer_GetNextFeature (ogr_wrap.cpp:3845)
==4768==    by 0x4A7766: PyEval_EvalFrameEx (in /usr/bin/python2.6)
==4768==    by 0x4A93D0: PyEval_EvalCodeEx (in /usr/bin/python2.6)
==4768==    by 0x4A7568: PyEval_EvalFrameEx (in /usr/bin/python2.6)
==4768==    by 0x4A82AF: PyEval_EvalFrameEx (in /usr/bin/python2.6)
==4768==    by 0x4A82AF: PyEval_EvalFrameEx (in /usr/bin/python2.6)
==4768==    by 0x4A82AF: PyEval_EvalFrameEx (in /usr/bin/python2.6)
==4768==    by 0x4A93D0: PyEval_EvalCodeEx (in /usr/bin/python2.6)
==4768==  Address 0x0 is not stack'd, malloc'd or (recently) free'd


> 
> Ari

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Fri Feb 12 05:40:39 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 12 Feb 2016 15:40:39 +0200
Subject: [gdal-dev] RFC 61: Call for vote on adoption
In-Reply-To: <201602121354.15088.even.rouault@spatialys.com>
References: <56B45770.7000405@gmail.com>
 <201602121143.18369.even.rouault@spatialys.com> <56BDCA66.1040608@gmail.com>
 <201602121354.15088.even.rouault@spatialys.com>
Message-ID: <56BDE0D7.9050404@gmail.com>


12.02.2016, 14:54, Even Rouault kirjoitti:
>> ok, I should perhaps set up a better local test environment.
>>
>> I now limit the dimension harmonization to the shape driver @33440.
> Travis seems to be stalled right now, but locally I get a crash with latest
> rev :
>

Thanks. Fixed. It is sometime difficult to spot errors in the log output 
of the autotests.

Ari


From paulopires16 at gmail.com  Sat Feb 13 03:59:43 2016
From: paulopires16 at gmail.com (Paulo Pires)
Date: Sat, 13 Feb 2016 03:59:43 -0800 (PST)
Subject: [gdal-dev] gdal_translate crop tiff (cmyk)
Message-ID: <1455364783014-5250378.post@n6.nabble.com>

Hello

I use the command *gdal_translate *with *-projwin* option to crop a tiff
image but I lose the CMYK SOURCE_COLOR_SPACE

The croped image is in RGB :/ 

*D:\raster>gdalinfo D:\raster\cmyk.tif*
Driver: GTiff/GeoTIFF
Files: D:\raster\cmyk.tif
       D:\raster\cmyk.tfw
Size is 11568, 20061
Coordinate System is `'
Origin = (191513.750000000000000,516826.250000000000000)
Pixel Size = (12.500000000000000,-12.500000000000000)
Metadata:
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  TIFFTAG_XRESOLUTION=508
  TIFFTAG_YRESOLUTION=508
Image Structure Metadata:
  COMPRESSION=PACKBITS
  INTERLEAVE=BAND
  SOURCE_COLOR_SPACE=CMYK
Corner Coordinates:
Upper Left  (  191513.750,  516826.250)
Lower Left  (  191513.750,  266063.750)
Upper Right (  336113.750,  516826.250)
Lower Right (  336113.750,  266063.750)
Center      (  263813.750,  391445.000)
Band 1 Block=11568x1 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=11568x1 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=11568x1 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=11568x1 Type=Byte, ColorInterp=Alpha

*D:\raster>gdalinfo D:\raster\cmyk_crop.tif*
Driver: GTiff/GeoTIFF
Files: D:\raster\cmyk_crop.tif
       D:\raster\cmyk_crop.tfw
Size is 80, 800
Coordinate System is `'
Origin = (191513.750000000000000,516826.250000000000000)
Pixel Size = (12.500000000000000,-12.500000000000000)
Metadata:
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  TIFFTAG_XRESOLUTION=508
  TIFFTAG_YRESOLUTION=508
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  191513.750,  516826.250)
Lower Left  (  191513.750,  506826.250)
Upper Right (  192513.750,  516826.250)
Lower Right (  192513.750,  506826.250)
Center      (  192013.750,  511826.250)
Band 1 Block=80x25 Type=Byte, ColorInterp=Red
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=80x25 Type=Byte, ColorInterp=Green
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=80x25 Type=Byte, ColorInterp=Blue
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=80x25 Type=Byte, ColorInterp=Alpha



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-crop-tiff-cmyk-tp5250378.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Sat Feb 13 04:58:59 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Sat, 13 Feb 2016 12:58:59 +0000 (UTC)
Subject: [gdal-dev] MapInfo and number format limits
Message-ID: <loom.20160213T135527-326@post.gmane.org>

Hi,

This question
http://gis.stackexchange.com/questions/180627/qgis-ogr-shp-to-tab-export-crashing-mapinfo-due-to-number-format-issues
 and a referred forum topic
https://groups.google.com/forum/#!topic/mapinfo-l/sO-wcp9bnuQ claim that
MapInfo format allows number format to be 20,16) or shorter. Is this known
and should the mitab driver handle the case?


-Jukka Rahkonen-


From btx at rutrus.com  Sat Feb 13 12:11:56 2016
From: btx at rutrus.com (byte)
Date: Sat, 13 Feb 2016 12:11:56 -0800 (PST)
Subject: [gdal-dev] Dropping Windows-CE support?
In-Reply-To: <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
References: <CACmBxyssp2iKzd_asYFbkN43eqDiYQEgrx2OqjEwV+Xjn2iDbg@mail.gmail.com>
 <201510071905.13467.even.rouault@spatialys.com>
 <CACmBxyvhygarCDokmEX-YJg+=F36GS1Pqnh98HO6GqG_9-RH5w@mail.gmail.com>
 <1444335493397-5228858.post@n6.nabble.com>
 <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
Message-ID: <1455394316165-5250415.post@n6.nabble.com>

Very interested in GDAL for WinCE since I'm working with this platform
mostly. 

What is the latest version of GDAL that can be compiled for WinCE ? 

I have tried gdal-2.0.1, 1.7.1, no succes, errors and errors, can not be
compiled.. 

thanks



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-Windows-CE-support-tp5228341p5250415.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Sat Feb 13 12:36:15 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 13 Feb 2016 21:36:15 +0100
Subject: [gdal-dev] Dropping Windows-CE support?
In-Reply-To: <1455394316165-5250415.post@n6.nabble.com>
References: <CACmBxyssp2iKzd_asYFbkN43eqDiYQEgrx2OqjEwV+Xjn2iDbg@mail.gmail.com>
 <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
 <1455394316165-5250415.post@n6.nabble.com>
Message-ID: <201602132136.15297.even.rouault@spatialys.com>

Le samedi 13 février 2016 21:11:56, byte a écrit :
> Very interested in GDAL for WinCE since I'm working with this platform
> mostly.
> 
> What is the latest version of GDAL that can be compiled for WinCE ?
> 
> I have tried gdal-2.0.1, 1.7.1, no succes, errors and errors, can not be
> compiled..

From the NEWS file:

GDAL/OGR 1.4.0 - General Changes
--------------------------------
 
WinCE Porting:
 - CPL 
 - base OGR, OSR and mitab and shape drivers.
 - GDAL, including GeoTIFF, DTED, AAIGrid drivers

Perhaps a few later versions work too with this subset of drivers.

Anyway, have a look at http://www.gdal.org/wince.html that mentions a special 
MSVC project to use, presumably with the subset of ported drivers.


> 
> thanks
> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-Windows-CE-support-t
> p5228341p5250415.html Sent from the GDAL - Dev mailing list archive at
> Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From btx at rutrus.com  Sat Feb 13 12:30:10 2016
From: btx at rutrus.com (byte)
Date: Sat, 13 Feb 2016 12:30:10 -0800 (PST)
Subject: [gdal-dev] Dropping Windows-CE support?
In-Reply-To: <201602132136.15297.even.rouault@spatialys.com>
References: <CACmBxyssp2iKzd_asYFbkN43eqDiYQEgrx2OqjEwV+Xjn2iDbg@mail.gmail.com>
 <201510071905.13467.even.rouault@spatialys.com>
 <CACmBxyvhygarCDokmEX-YJg+=F36GS1Pqnh98HO6GqG_9-RH5w@mail.gmail.com>
 <1444335493397-5228858.post@n6.nabble.com>
 <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
 <1455394316165-5250415.post@n6.nabble.com>
 <201602132136.15297.even.rouault@spatialys.com>
Message-ID: <1455395410892-5250417.post@n6.nabble.com>

1.4 version has started wince support, so just have to try later versions one
by one until it compiles ? :-) or maybe someone know the _latest_ working
one ?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Dropping-Windows-CE-support-tp5228341p5250417.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mateusz at loskot.net  Sun Feb 14 12:13:26 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 14 Feb 2016 21:13:26 +0100
Subject: [gdal-dev] Dropping Windows-CE support?
In-Reply-To: <1455395410892-5250417.post@n6.nabble.com>
References: <CACmBxyssp2iKzd_asYFbkN43eqDiYQEgrx2OqjEwV+Xjn2iDbg@mail.gmail.com>
 <201510071905.13467.even.rouault@spatialys.com>
 <CACmBxyvhygarCDokmEX-YJg+=F36GS1Pqnh98HO6GqG_9-RH5w@mail.gmail.com>
 <1444335493397-5228858.post@n6.nabble.com>
 <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
 <1455394316165-5250415.post@n6.nabble.com>
 <201602132136.15297.even.rouault@spatialys.com>
 <1455395410892-5250417.post@n6.nabble.com>
Message-ID: <CABUeae9hBRZ0mk6Fxyi=xhppoS981KyUX+0QE415LRTZo4puqA@mail.gmail.com>

On 13 February 2016 at 21:30, byte <btx at rutrus.com> wrote:
> 1.4 version has started wince support, so just have to try later versions one
> by one until it compiles ? :-) or maybe someone know the _latest_ working
> one ?

AFAIR, Windows CE had been maintained across 1.4.x line only,
or may be even 1.5.x.
You may have a luck with later releases though.

Best regards,
-- 
Mateusz Łoskot, http://mateusz.loskot.net

From schwehr at gmail.com  Sun Feb 14 13:24:19 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Sun, 14 Feb 2016 13:24:19 -0800
Subject: [gdal-dev] Dropping Windows-CE support?
In-Reply-To: <CABUeae9hBRZ0mk6Fxyi=xhppoS981KyUX+0QE415LRTZo4puqA@mail.gmail.com>
References: <CACmBxyssp2iKzd_asYFbkN43eqDiYQEgrx2OqjEwV+Xjn2iDbg@mail.gmail.com>
 <201510071905.13467.even.rouault@spatialys.com>
 <CACmBxyvhygarCDokmEX-YJg+=F36GS1Pqnh98HO6GqG_9-RH5w@mail.gmail.com>
 <1444335493397-5228858.post@n6.nabble.com>
 <CACmBxytHE8f=x6j3FFAXDdDNsaM+M0p+dpooeH9f_iJGATL9-g@mail.gmail.com>
 <1455394316165-5250415.post@n6.nabble.com>
 <201602132136.15297.even.rouault@spatialys.com>
 <1455395410892-5250417.post@n6.nabble.com>
 <CABUeae9hBRZ0mk6Fxyi=xhppoS981KyUX+0QE415LRTZo4puqA@mail.gmail.com>
Message-ID: <CACmBxyuLdA4Ng0vKOY2jOShEHX_537RMnkAiAesoSjr+f9tqDw@mail.gmail.com>

Andrew,

You might find useful the changes listed in the ticket that I used for the
remove of macos <= 9 and wince:

https://trac.osgeo.org/gdal/ticket/6133

-kurt


On Sun, Feb 14, 2016 at 12:13 PM, Mateusz Loskot <mateusz at loskot.net> wrote:

> On 13 February 2016 at 21:30, byte <btx at rutrus.com> wrote:
> > 1.4 version has started wince support, so just have to try later
> versions one
> > by one until it compiles ? :-) or maybe someone know the _latest_ working
> > one ?
>
> AFAIR, Windows CE had been maintained across 1.4.x line only,
> or may be even 1.5.x.
> You may have a luck with later releases though.
>
> Best regards,
> --
> Mateusz Łoskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160214/08728777/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Feb 15 01:11:18 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Mon, 15 Feb 2016 09:11:18 +0000 (UTC)
Subject: [gdal-dev] MapInfo and number format limits
References: <loom.20160213T135527-326@post.gmane.org>
Message-ID: <loom.20160215T100440-964@post.gmane.org>

Jukka Rahkonen <jukka.rahkonen <at> maanmittauslaitos.fi> writes:

> 
> Hi,
> 
> This question
>
http://gis.stackexchange.com/questions/180627/qgis-ogr-shp-to-tab-export-crashing-mapinfo-due-to-number-format-issues
>  and a referred forum topic
> https://groups.google.com/forum/#!topic/mapinfo-l/sO-wcp9bnuQ claim that
> MapInfo format allows number format to be 20,16) or shorter. Is this known
> and should the mitab driver handle the case?

The best specification about MapInfo format that I found is this official
MapInfo document
http://resource.mapinfo.com/static/files/document/1074660800077/interchange_file.pdf

The document does define "decimal" datatype but unfortunately it does not
tell which are the accepted values for "width" and "decimals"

Columns
Specify the number of columns. Then, for each column, 
create a row containing the column name, the column type, 
and, for character and decimal columns, a number to 
indicate the width of the field. Valid column types are:  
•     char (width)
•     integer (which is 4 bytes)
•     smallint (which is 2 bytes, so it can only store numbers between
      -32767 and +32767)
•     decimal (width,decimals)
•     float
•     date
•     logical

-Jukka-

From jlmcgraw at gmail.com  Mon Feb 15 06:46:15 2016
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Mon, 15 Feb 2016 09:46:15 -0500
Subject: [gdal-dev] Core dump using gdal_translate to create geopackage
Message-ID: <56C1E4B7.7090705@gmail.com>

I was fiddling with Even's geopackage examples 
<http://erouault.blogspot.com/2014/12/gdal-geopackage-raster-support.html> 
when I came across a core dump issue in gdal_translate

gdal version is compiled from github trunk as of 15 February 2016 under 
Ubuntu 15.10 x64

    gdal_translate --version
    GDAL 2.1.0dev, released 2015/99/99



I can share the geotiff in question if need be.  Let me know if I can 
provide any other helpful information

Basic command is:

    gdal_translate \
         Washington_SEC.tif \
         test.gpkg \
         -of GPKG \
         -co TILE_FORMAT=PNG \
         -co TILING_SCHEME=GoogleMapsCompatible


Out from Valgrind is:

    jlmcgraw at UbuntuMate1504:~/Documents/myPrograms/gdal_tests$
    CPL_DEBUG=ON \
     > valgrind --tool=memcheck --leak-check=yes --read-var-info=yes \
     > gdal_translate \
     >     Washington_SEC.tif \
     >     test.gpkg \
     >     -of GPKG \
     >     -co TILE_FORMAT=PNG \
     >     -co TILING_SCHEME=GoogleMapsCompatible
    ==30978== Memcheck, a memory error detector
    ==30978== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward
    et al.
    ==30978== Using Valgrind-3.11.0 and LibVEX; rerun with -h for
    copyright info
    ==30978== Command: gdal_translate Washington_SEC.tif test.gpkg -of
    GPKG -co TILE_FORMAT=PNG -co TILING_SCHEME=GoogleMapsCompatible
    ==30978==
    GDAL: GDALOpen(Washington_SEC.tif, this=0xf7e9d80) succeeds as GTiff.
    Input file size is 15538, 11309
    GDAL: GDAL_CACHEMAX = 100 MB
    GDAL: GDALWarpKernel()::GWKGeneralCase()
    Src=0,0,1944x1415 Dst=0,0,2737x1992
    0GDAL: GDALWarpKernel()::GWKGeneralCase()
    Src=1941,0,1945x1415 Dst=2737,0,2737x1992
    .GDAL: GDALWarpKernel()::GWKGeneralCase()
    Src=3883,0,1945x1415 Dst=5474,0,2737x1992
    --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
    --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
    --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
    --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
    ==30978== Invalid write of size 8
    ==30978==    at 0x4C3259F: memset (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x5692CD8: memset (string3.h:90)
    ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
    unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
    ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
    (gdalgeopackagerasterband.cpp:489)
    ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
    int, void*) (gdalgeopackagerasterband.cpp:733)
    ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
    int, int) (gdalrasterband.cpp:1142)
    ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
    int, int, int, int, void*, int, int, GDALDataType, long long, long
    long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
    ==30978==    by 0x557312A:
    GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
    void*, int, int, GDALDataType, int, int*, long long, long long, long
    long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
    ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
    int, int, int, void*, int, int, GDALDataType, int, int*, long long,
    long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
    ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
    ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
    int, int, int, int, int, int, int, int, double, double)
    (gdalwarpoperation.cpp:1370)
    ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
    int, int, int) (gdalwarpoperation.cpp:720)
    ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
    const*, GDALDataset*, int, char**, int (*)(double, char const*,
    void*), void*) (ogrgeopackagedatasource.cpp:3242)
    ==30978==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
    ==30978==
    ==30978==
    ==30978== Process terminating with default action of signal 11 (SIGSEGV)
    ==30978==  Access not within mapped region at address 0x0
    ==30978==    at 0x4C3259F: memset (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x5692CD8: memset (string3.h:90)
    ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
    unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
    ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
    (gdalgeopackagerasterband.cpp:489)
    ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
    int, void*) (gdalgeopackagerasterband.cpp:733)
    ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
    int, int) (gdalrasterband.cpp:1142)
    ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
    int, int, int, int, void*, int, int, GDALDataType, long long, long
    long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
    ==30978==    by 0x557312A:
    GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
    void*, int, int, GDALDataType, int, int*, long long, long long, long
    long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
    ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
    int, int, int, void*, int, int, GDALDataType, int, int*, long long,
    long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
    ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
    ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
    int, int, int, int, int, int, int, int, double, double)
    (gdalwarpoperation.cpp:1370)
    ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
    int, int, int) (gdalwarpoperation.cpp:720)
    ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
    const*, GDALDataset*, int, char**, int (*)(double, char const*,
    void*), void*) (ogrgeopackagedatasource.cpp:3242)
    ==30978==  If you believe this happened as a result of a stack
    ==30978==  overflow in your program's main thread (unlikely but
    ==30978==  possible), you can try to increase the size of the
    ==30978==  main thread stack using the --main-stacksize= flag.
    ==30978==  The main thread stack size used in this run was 8388608.
    ==30978==
    ==30978== HEAP SUMMARY:
    ==30978==     in use at exit: 138,658,730 bytes in 10,473 blocks
    ==30978==   total heap usage: 58,500 allocs, 48,027 frees,
    326,332,504 bytes allocated
    ==30978==
    ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
    4,171 of 4,283
    ==30978==    at 0x4C2BBCF: malloc (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x7CECC56: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CC92F5: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCC5A6: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CEB222: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D200D7: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D29826: sqlite3_step (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D2A899: sqlite3_exec (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
    (ogrgeopackageutility.cpp:41)
    ==30978==    by 0x57A4D5C:
    GDALGeoPackageDataset::FinalizeRasterRegistration()
    (ogrgeopackagedatasource.cpp:1383)
    ==30978==    by 0x57A9CBA: GDALGeoPackageDataset::CreateCopy(char
    const*, GDALDataset*, int, char**, int (*)(double, char const*,
    void*), void*) (ogrgeopackagedatasource.cpp:3150)
    ==30978==    by 0x5522F48: GDALDriver::CreateCopy(char const*,
    GDALDataset*, int, char**, int (*)(double, char const*, void*),
    void*) (gdaldriver.cpp:803)
    ==30978==
    ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
    4,172 of 4,283
    ==30978==    at 0x4C2BBCF: malloc (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x7CECC56: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CC92F5: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCC5A6: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CEB222: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D200D7: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D29826: sqlite3_step (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D2A899: sqlite3_exec (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
    (ogrgeopackageutility.cpp:41)
    ==30978==    by 0x5695415:
    GDALGeoPackageDataset::WriteShiftedTile(int, int, int, int, int,
    int, int) (gdalgeopackagerasterband.cpp:1645)
    ==30978==    by 0x5695CAC:
    GDALGeoPackageRasterBand::IWriteBlock(int, int, void*)
    (gdalgeopackagerasterband.cpp:2121)
    ==30978==    by 0x555805F: GDALRasterBlock::Write()
    (gdalrasterblock.cpp:743)
    ==30978==
    ==30978== 1,304 bytes in 1 blocks are possibly lost in loss record
    4,186 of 4,283
    ==30978==    at 0x4C2BBCF: malloc (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x7CECC56: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CC92F5: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCC5A6: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCD0FF: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D003AE: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D007FA: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D012E8: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D0374F: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D06D63: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D09554: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D2346A: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==
    ==30978== 3,912 bytes in 3 blocks are possibly lost in loss record
    4,228 of 4,283
    ==30978==    at 0x4C2BBCF: malloc (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x7CECC56: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CC92F5: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCC5A6: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCD0FF: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D003AE: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D007FA: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D012E8: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D0374F: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D06EB7: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D09554: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D2346A: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==
    ==30978== 710,680 bytes in 545 blocks are possibly lost in loss
    record 4,275 of 4,283
    ==30978==    at 0x4C2BBCF: malloc (in
    /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
    ==30978==    by 0x7CECC56: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CC92F5: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCC5A6: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7CCD0FF: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D003AE: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D007FA: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D012E8: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D0374F: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D09228: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D2346A: ??? (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==    by 0x7D29826: sqlite3_step (in
    /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
    ==30978==
    ==30978== LEAK SUMMARY:
    ==30978==    definitely lost: 0 bytes in 0 blocks
    ==30978==    indirectly lost: 0 bytes in 0 blocks
    ==30978==      possibly lost: 717,960 bytes in 551 blocks
    ==30978==    still reachable: 137,940,770 bytes in 9,922 blocks
    ==30978==                       of which reachable via heuristic:
    ==30978==                         length64           : 483,616 bytes
    in 2,334 blocks
    ==30978==         suppressed: 0 bytes in 0 blocks
    ==30978== Reachable blocks (those to which a pointer was found) are
    not shown.
    ==30978== To see them, rerun with: --leak-check=full
    --show-leak-kinds=all
    ==30978==
    ==30978== For counts of detected and suppressed errors, rerun with: -v
    ==30978== ERROR SUMMARY: 6 errors from 6 contexts (suppressed: 0 from 0)
    Segmentation fault (core dumped)


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160215/e56f22cb/attachment-0001.html>

From even.rouault at spatialys.com  Mon Feb 15 06:53:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Feb 2016 15:53:14 +0100
Subject: [gdal-dev] Core dump using gdal_translate to create geopackage
In-Reply-To: <56C1E4B7.7090705@gmail.com>
References: <56C1E4B7.7090705@gmail.com>
Message-ID: <201602151553.14964.even.rouault@spatialys.com>

Jesse,

The geotiff would be necessary to replicate.

Even

Le lundi 15 février 2016 15:46:15, Jesse McGraw a écrit :
> I was fiddling with Even's geopackage examples
> <http://erouault.blogspot.com/2014/12/gdal-geopackage-raster-support.html>
> when I came across a core dump issue in gdal_translate
> 
> gdal version is compiled from github trunk as of 15 February 2016 under
> Ubuntu 15.10 x64
> 
>     gdal_translate --version
>     GDAL 2.1.0dev, released 2015/99/99
> 
> 
> 
> I can share the geotiff in question if need be.  Let me know if I can
> provide any other helpful information
> 
> Basic command is:
> 
>     gdal_translate \
>          Washington_SEC.tif \
>          test.gpkg \
>          -of GPKG \
>          -co TILE_FORMAT=PNG \
>          -co TILING_SCHEME=GoogleMapsCompatible
> 
> 
> Out from Valgrind is:
> 
>     jlmcgraw at UbuntuMate1504:~/Documents/myPrograms/gdal_tests$
>     CPL_DEBUG=ON \
> 
>      > valgrind --tool=memcheck --leak-check=yes --read-var-info=yes \
>      > gdal_translate \
>      > 
>      >     Washington_SEC.tif \
>      >     test.gpkg \
>      >     -of GPKG \
>      >     -co TILE_FORMAT=PNG \
>      >     -co TILING_SCHEME=GoogleMapsCompatible
> 
>     ==30978== Memcheck, a memory error detector
>     ==30978== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward
>     et al.
>     ==30978== Using Valgrind-3.11.0 and LibVEX; rerun with -h for
>     copyright info
>     ==30978== Command: gdal_translate Washington_SEC.tif test.gpkg -of
>     GPKG -co TILE_FORMAT=PNG -co TILING_SCHEME=GoogleMapsCompatible
>     ==30978==
>     GDAL: GDALOpen(Washington_SEC.tif, this=0xf7e9d80) succeeds as GTiff.
>     Input file size is 15538, 11309
>     GDAL: GDAL_CACHEMAX = 100 MB
>     GDAL: GDALWarpKernel()::GWKGeneralCase()
>     Src=0,0,1944x1415 Dst=0,0,2737x1992
>     0GDAL: GDALWarpKernel()::GWKGeneralCase()
>     Src=1941,0,1945x1415 Dst=2737,0,2737x1992
>     .GDAL: GDALWarpKernel()::GWKGeneralCase()
>     Src=3883,0,1945x1415 Dst=5474,0,2737x1992
>     --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>     --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>     --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>     --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>     ==30978== Invalid write of size 8
>     ==30978==    at 0x4C3259F: memset (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x5692CD8: memset (string3.h:90)
>     ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
>     unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
>     ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
>     (gdalgeopackagerasterband.cpp:489)
>     ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
>     int, void*) (gdalgeopackagerasterband.cpp:733)
>     ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
>     int, int) (gdalrasterband.cpp:1142)
>     ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
>     int, int, int, int, void*, int, int, GDALDataType, long long, long
>     long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
>     ==30978==    by 0x557312A:
>     GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
>     void*, int, int, GDALDataType, int, int*, long long, long long, long
>     long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
>     ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
>     int, int, int, void*, int, int, GDALDataType, int, int*, long long,
>     long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
>     ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
>     ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
>     int, int, int, int, int, int, int, int, double, double)
>     (gdalwarpoperation.cpp:1370)
>     ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
>     int, int, int) (gdalwarpoperation.cpp:720)
>     ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
>     const*, GDALDataset*, int, char**, int (*)(double, char const*,
>     void*), void*) (ogrgeopackagedatasource.cpp:3242)
>     ==30978==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
>     ==30978==
>     ==30978==
>     ==30978== Process terminating with default action of signal 11
> (SIGSEGV) ==30978==  Access not within mapped region at address 0x0
>     ==30978==    at 0x4C3259F: memset (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x5692CD8: memset (string3.h:90)
>     ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
>     unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
>     ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
>     (gdalgeopackagerasterband.cpp:489)
>     ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
>     int, void*) (gdalgeopackagerasterband.cpp:733)
>     ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
>     int, int) (gdalrasterband.cpp:1142)
>     ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
>     int, int, int, int, void*, int, int, GDALDataType, long long, long
>     long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
>     ==30978==    by 0x557312A:
>     GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
>     void*, int, int, GDALDataType, int, int*, long long, long long, long
>     long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
>     ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
>     int, int, int, void*, int, int, GDALDataType, int, int*, long long,
>     long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
>     ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
>     ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
>     int, int, int, int, int, int, int, int, double, double)
>     (gdalwarpoperation.cpp:1370)
>     ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
>     int, int, int) (gdalwarpoperation.cpp:720)
>     ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
>     const*, GDALDataset*, int, char**, int (*)(double, char const*,
>     void*), void*) (ogrgeopackagedatasource.cpp:3242)
>     ==30978==  If you believe this happened as a result of a stack
>     ==30978==  overflow in your program's main thread (unlikely but
>     ==30978==  possible), you can try to increase the size of the
>     ==30978==  main thread stack using the --main-stacksize= flag.
>     ==30978==  The main thread stack size used in this run was 8388608.
>     ==30978==
>     ==30978== HEAP SUMMARY:
>     ==30978==     in use at exit: 138,658,730 bytes in 10,473 blocks
>     ==30978==   total heap usage: 58,500 allocs, 48,027 frees,
>     326,332,504 bytes allocated
>     ==30978==
>     ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
>     4,171 of 4,283
>     ==30978==    at 0x4C2BBCF: malloc (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x7CECC56: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CC92F5: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCC5A6: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CEB222: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D200D7: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D29826: sqlite3_step (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D2A899: sqlite3_exec (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
>     (ogrgeopackageutility.cpp:41)
>     ==30978==    by 0x57A4D5C:
>     GDALGeoPackageDataset::FinalizeRasterRegistration()
>     (ogrgeopackagedatasource.cpp:1383)
>     ==30978==    by 0x57A9CBA: GDALGeoPackageDataset::CreateCopy(char
>     const*, GDALDataset*, int, char**, int (*)(double, char const*,
>     void*), void*) (ogrgeopackagedatasource.cpp:3150)
>     ==30978==    by 0x5522F48: GDALDriver::CreateCopy(char const*,
>     GDALDataset*, int, char**, int (*)(double, char const*, void*),
>     void*) (gdaldriver.cpp:803)
>     ==30978==
>     ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
>     4,172 of 4,283
>     ==30978==    at 0x4C2BBCF: malloc (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x7CECC56: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CC92F5: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCC5A6: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CEB222: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D200D7: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D29826: sqlite3_step (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D2A899: sqlite3_exec (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
>     (ogrgeopackageutility.cpp:41)
>     ==30978==    by 0x5695415:
>     GDALGeoPackageDataset::WriteShiftedTile(int, int, int, int, int,
>     int, int) (gdalgeopackagerasterband.cpp:1645)
>     ==30978==    by 0x5695CAC:
>     GDALGeoPackageRasterBand::IWriteBlock(int, int, void*)
>     (gdalgeopackagerasterband.cpp:2121)
>     ==30978==    by 0x555805F: GDALRasterBlock::Write()
>     (gdalrasterblock.cpp:743)
>     ==30978==
>     ==30978== 1,304 bytes in 1 blocks are possibly lost in loss record
>     4,186 of 4,283
>     ==30978==    at 0x4C2BBCF: malloc (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x7CECC56: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CC92F5: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCC5A6: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCD0FF: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D003AE: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D007FA: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D012E8: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D0374F: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D06D63: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D09554: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D2346A: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==
>     ==30978== 3,912 bytes in 3 blocks are possibly lost in loss record
>     4,228 of 4,283
>     ==30978==    at 0x4C2BBCF: malloc (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x7CECC56: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CC92F5: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCC5A6: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCD0FF: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D003AE: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D007FA: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D012E8: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D0374F: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D06EB7: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D09554: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D2346A: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==
>     ==30978== 710,680 bytes in 545 blocks are possibly lost in loss
>     record 4,275 of 4,283
>     ==30978==    at 0x4C2BBCF: malloc (in
>     /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>     ==30978==    by 0x7CECC56: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CC92F5: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCC5A6: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7CCD0FF: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D003AE: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D007FA: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D012E8: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D0374F: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D09228: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D2346A: ??? (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==    by 0x7D29826: sqlite3_step (in
>     /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>     ==30978==
>     ==30978== LEAK SUMMARY:
>     ==30978==    definitely lost: 0 bytes in 0 blocks
>     ==30978==    indirectly lost: 0 bytes in 0 blocks
>     ==30978==      possibly lost: 717,960 bytes in 551 blocks
>     ==30978==    still reachable: 137,940,770 bytes in 9,922 blocks
>     ==30978==                       of which reachable via heuristic:
>     ==30978==                         length64           : 483,616 bytes
>     in 2,334 blocks
>     ==30978==         suppressed: 0 bytes in 0 blocks
>     ==30978== Reachable blocks (those to which a pointer was found) are
>     not shown.
>     ==30978== To see them, rerun with: --leak-check=full
>     --show-leak-kinds=all
>     ==30978==
>     ==30978== For counts of detected and suppressed errors, rerun with: -v
>     ==30978== ERROR SUMMARY: 6 errors from 6 contexts (suppressed: 0 from
> 0) Segmentation fault (core dumped)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jlmcgraw at gmail.com  Mon Feb 15 08:15:08 2016
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Mon, 15 Feb 2016 11:15:08 -0500
Subject: [gdal-dev] Core dump using gdal_translate to create geopackage
In-Reply-To: <201602151553.14964.even.rouault@spatialys.com>
References: <56C1E4B7.7090705@gmail.com>
 <201602151553.14964.even.rouault@spatialys.com>
Message-ID: <56C1F98C.5040601@gmail.com>

Thanks Even.

I've uploaded it to dropbox here: 
https://www.dropbox.com/s/7tcxh9bvk4127c6/Washington_SEC.tif?dl=0



On 02/15/2016 09:53 AM, Even Rouault wrote:
> Jesse,
>
> The geotiff would be necessary to replicate.
>
> Even
>
> Le lundi 15 février 2016 15:46:15, Jesse McGraw a écrit :
>> I was fiddling with Even's geopackage examples
>> <http://erouault.blogspot.com/2014/12/gdal-geopackage-raster-support.html>
>> when I came across a core dump issue in gdal_translate
>>
>> gdal version is compiled from github trunk as of 15 February 2016 under
>> Ubuntu 15.10 x64
>>
>>      gdal_translate --version
>>      GDAL 2.1.0dev, released 2015/99/99
>>
>>
>>
>> I can share the geotiff in question if need be.  Let me know if I can
>> provide any other helpful information
>>
>> Basic command is:
>>
>>      gdal_translate \
>>           Washington_SEC.tif \
>>           test.gpkg \
>>           -of GPKG \
>>           -co TILE_FORMAT=PNG \
>>           -co TILING_SCHEME=GoogleMapsCompatible
>>
>>
>> Out from Valgrind is:
>>
>>      jlmcgraw at UbuntuMate1504:~/Documents/myPrograms/gdal_tests$
>>      CPL_DEBUG=ON \
>>
>>       > valgrind --tool=memcheck --leak-check=yes --read-var-info=yes \
>>       > gdal_translate \
>>       >
>>       >     Washington_SEC.tif \
>>       >     test.gpkg \
>>       >     -of GPKG \
>>       >     -co TILE_FORMAT=PNG \
>>       >     -co TILING_SCHEME=GoogleMapsCompatible
>>
>>      ==30978== Memcheck, a memory error detector
>>      ==30978== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward
>>      et al.
>>      ==30978== Using Valgrind-3.11.0 and LibVEX; rerun with -h for
>>      copyright info
>>      ==30978== Command: gdal_translate Washington_SEC.tif test.gpkg -of
>>      GPKG -co TILE_FORMAT=PNG -co TILING_SCHEME=GoogleMapsCompatible
>>      ==30978==
>>      GDAL: GDALOpen(Washington_SEC.tif, this=0xf7e9d80) succeeds as GTiff.
>>      Input file size is 15538, 11309
>>      GDAL: GDAL_CACHEMAX = 100 MB
>>      GDAL: GDALWarpKernel()::GWKGeneralCase()
>>      Src=0,0,1944x1415 Dst=0,0,2737x1992
>>      0GDAL: GDALWarpKernel()::GWKGeneralCase()
>>      Src=1941,0,1945x1415 Dst=2737,0,2737x1992
>>      .GDAL: GDALWarpKernel()::GWKGeneralCase()
>>      Src=3883,0,1945x1415 Dst=5474,0,2737x1992
>>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
>>      ==30978== Invalid write of size 8
>>      ==30978==    at 0x4C3259F: memset (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x5692CD8: memset (string3.h:90)
>>      ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
>>      unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
>>      ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
>>      (gdalgeopackagerasterband.cpp:489)
>>      ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
>>      int, void*) (gdalgeopackagerasterband.cpp:733)
>>      ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
>>      int, int) (gdalrasterband.cpp:1142)
>>      ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
>>      int, int, int, int, void*, int, int, GDALDataType, long long, long
>>      long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
>>      ==30978==    by 0x557312A:
>>      GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
>>      void*, int, int, GDALDataType, int, int*, long long, long long, long
>>      long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
>>      ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
>>      int, int, int, void*, int, int, GDALDataType, int, int*, long long,
>>      long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
>>      ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
>>      ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
>>      int, int, int, int, int, int, int, int, double, double)
>>      (gdalwarpoperation.cpp:1370)
>>      ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
>>      int, int, int) (gdalwarpoperation.cpp:720)
>>      ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
>>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
>>      void*), void*) (ogrgeopackagedatasource.cpp:3242)
>>      ==30978==  Address 0x0 is not stack'd, malloc'd or (recently) free'd
>>      ==30978==
>>      ==30978==
>>      ==30978== Process terminating with default action of signal 11
>> (SIGSEGV) ==30978==  Access not within mapped region at address 0x0
>>      ==30978==    at 0x4C3259F: memset (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x5692CD8: memset (string3.h:90)
>>      ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int, int,
>>      unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
>>      ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int, int)
>>      (gdalgeopackagerasterband.cpp:489)
>>      ==30978==    by 0x5694B51: GDALGeoPackageRasterBand::IReadBlock(int,
>>      int, void*) (gdalgeopackagerasterband.cpp:733)
>>      ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
>>      int, int) (gdalrasterband.cpp:1142)
>>      ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
>>      int, int, int, int, void*, int, int, GDALDataType, long long, long
>>      long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
>>      ==30978==    by 0x557312A:
>>      GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
>>      void*, int, int, GDALDataType, int, int*, long long, long long, long
>>      long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
>>      ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
>>      int, int, int, void*, int, int, GDALDataType, int, int*, long long,
>>      long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
>>      ==30978==    by 0x551B11D: GDALDatasetRasterIO (gdaldataset.cpp:2034)
>>      ==30978==    by 0x56384C4: GDALWarpOperation::WarpRegion(int, int,
>>      int, int, int, int, int, int, int, int, double, double)
>>      (gdalwarpoperation.cpp:1370)
>>      ==30978==    by 0x56387C6: GDALWarpOperation::ChunkAndWarpImage(int,
>>      int, int, int) (gdalwarpoperation.cpp:720)
>>      ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
>>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
>>      void*), void*) (ogrgeopackagedatasource.cpp:3242)
>>      ==30978==  If you believe this happened as a result of a stack
>>      ==30978==  overflow in your program's main thread (unlikely but
>>      ==30978==  possible), you can try to increase the size of the
>>      ==30978==  main thread stack using the --main-stacksize= flag.
>>      ==30978==  The main thread stack size used in this run was 8388608.
>>      ==30978==
>>      ==30978== HEAP SUMMARY:
>>      ==30978==     in use at exit: 138,658,730 bytes in 10,473 blocks
>>      ==30978==   total heap usage: 58,500 allocs, 48,027 frees,
>>      326,332,504 bytes allocated
>>      ==30978==
>>      ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
>>      4,171 of 4,283
>>      ==30978==    at 0x4C2BBCF: malloc (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x7CECC56: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CC92F5: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCC5A6: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CEB222: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D200D7: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D29826: sqlite3_step (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D2A899: sqlite3_exec (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
>>      (ogrgeopackageutility.cpp:41)
>>      ==30978==    by 0x57A4D5C:
>>      GDALGeoPackageDataset::FinalizeRasterRegistration()
>>      (ogrgeopackagedatasource.cpp:1383)
>>      ==30978==    by 0x57A9CBA: GDALGeoPackageDataset::CreateCopy(char
>>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
>>      void*), void*) (ogrgeopackagedatasource.cpp:3150)
>>      ==30978==    by 0x5522F48: GDALDriver::CreateCopy(char const*,
>>      GDALDataset*, int, char**, int (*)(double, char const*, void*),
>>      void*) (gdaldriver.cpp:803)
>>      ==30978==
>>      ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
>>      4,172 of 4,283
>>      ==30978==    at 0x4C2BBCF: malloc (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x7CECC56: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CC92F5: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCC5A6: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CEB222: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D200D7: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D29826: sqlite3_step (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D2A899: sqlite3_exec (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
>>      (ogrgeopackageutility.cpp:41)
>>      ==30978==    by 0x5695415:
>>      GDALGeoPackageDataset::WriteShiftedTile(int, int, int, int, int,
>>      int, int) (gdalgeopackagerasterband.cpp:1645)
>>      ==30978==    by 0x5695CAC:
>>      GDALGeoPackageRasterBand::IWriteBlock(int, int, void*)
>>      (gdalgeopackagerasterband.cpp:2121)
>>      ==30978==    by 0x555805F: GDALRasterBlock::Write()
>>      (gdalrasterblock.cpp:743)
>>      ==30978==
>>      ==30978== 1,304 bytes in 1 blocks are possibly lost in loss record
>>      4,186 of 4,283
>>      ==30978==    at 0x4C2BBCF: malloc (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x7CECC56: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CC92F5: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCC5A6: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCD0FF: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D003AE: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D007FA: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D012E8: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D0374F: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D06D63: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D09554: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D2346A: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==
>>      ==30978== 3,912 bytes in 3 blocks are possibly lost in loss record
>>      4,228 of 4,283
>>      ==30978==    at 0x4C2BBCF: malloc (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x7CECC56: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CC92F5: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCC5A6: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCD0FF: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D003AE: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D007FA: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D012E8: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D0374F: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D06EB7: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D09554: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D2346A: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==
>>      ==30978== 710,680 bytes in 545 blocks are possibly lost in loss
>>      record 4,275 of 4,283
>>      ==30978==    at 0x4C2BBCF: malloc (in
>>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
>>      ==30978==    by 0x7CECC56: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CC92F5: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCC5A6: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7CCD0FF: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D003AE: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D007FA: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D012E8: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D0374F: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D09228: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D2346A: ??? (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==    by 0x7D29826: sqlite3_step (in
>>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
>>      ==30978==
>>      ==30978== LEAK SUMMARY:
>>      ==30978==    definitely lost: 0 bytes in 0 blocks
>>      ==30978==    indirectly lost: 0 bytes in 0 blocks
>>      ==30978==      possibly lost: 717,960 bytes in 551 blocks
>>      ==30978==    still reachable: 137,940,770 bytes in 9,922 blocks
>>      ==30978==                       of which reachable via heuristic:
>>      ==30978==                         length64           : 483,616 bytes
>>      in 2,334 blocks
>>      ==30978==         suppressed: 0 bytes in 0 blocks
>>      ==30978== Reachable blocks (those to which a pointer was found) are
>>      not shown.
>>      ==30978== To see them, rerun with: --leak-check=full
>>      --show-leak-kinds=all
>>      ==30978==
>>      ==30978== For counts of detected and suppressed errors, rerun with: -v
>>      ==30978== ERROR SUMMARY: 6 errors from 6 contexts (suppressed: 0 from
>> 0) Segmentation fault (core dumped)


From Dominik.Schneider at Colorado.EDU  Mon Feb 15 09:54:51 2016
From: Dominik.Schneider at Colorado.EDU (Dominik Schneider)
Date: Mon, 15 Feb 2016 10:54:51 -0700
Subject: [gdal-dev] gdal not recognizing ellpsoid properly in esri grid
	format
Message-ID: <CAHYDKLa4vf=dtbOGO76Hqq8OMYqaGXXTwQN8ANZ612WWZL0DgA@mail.gmail.com>

Hi,
I was sent an esri grid that uses a spherical ellpsoid with +a and +b
parameters but this not being read properly. It is being assigned
+ellps=WGS84 when read with raster::raster() in R 3.2.3 but also when using
gdalinfo on the command line.  I'm using GDAL 1.11.3 from kyngchaos.com on
OS X 10.11.3

Not sure if this is a known issue or subsequently fixed in later versions
so I wanted to report it here. I didn't see a ticket that addresses this in
particular.

> gdalinfo dem
gdalinfo dem
Driver: AIG/Arc/Info Binary Grid
Files: dem
       dem/dblbnd.adf
       dem/hdr.adf
       dem/metadata.xml
       dem/prj.adf
       dem/sta.adf
       dem/w001001.adf
       dem/w001001x.adf
Size is 317, 263
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9108"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",33],
    PARAMETER["standard_parallel_2",45],
    PARAMETER["latitude_of_origin",39.00000381472222],
    PARAMETER["central_meridian",-107],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["METERS",1]]
Origin = (-633999.740890799090266,525999.667091785930097)
Pixel Size = (4000.000000000000000,-4000.000000000000000)
Corner Coordinates:
Upper Left  ( -633999.741,  525999.667) (114d52' 9.29"W, 43d30'32.73"N)
Lower Left  ( -633999.741, -526000.333) (113d52'56.93"W, 34d 1'21.79"N)
Upper Right (  634000.259,  525999.667) ( 99d 7'50.68"W, 43d30'32.73"N)
Lower Right (  634000.259, -526000.333) (100d 7' 3.05"W, 34d 1'21.79"N)
Center      (   0.2591092,  -0.3329082) (106d59'59.99"W, 39d 0' 0.00"N)
Band 1 Block=256x16 Type=Float32, ColorInterp=Undefined
  Min=274.508 Max=3824.624
  NoData Value=-3.4028234663852886e+38


prj.adf reads:
Projection    LAMBERT
Units         METERS
Zunits        NO
Xshift        0.0
Yshift        0.0
Parameters    6370000.0  6370000.0
  33  0  0.0 /* 1st standard parallel
  45  0  0.0 /* 2nd standard parallel
-107  0  0.0 /* central meridian
  39  0  0.013733 /* latitude of projection's origin
0.0 /* false easting (meters)
0.0 /* false northing (meters)

The file is here:
https://www.odrive.com/s/4516b311-380e-4d94-8912-16f39c7d0259-56c21076
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160215/050d8cd7/attachment.html>

From even.rouault at spatialys.com  Mon Feb 15 10:12:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Feb 2016 19:12:57 +0100
Subject: [gdal-dev] Core dump using gdal_translate to create geopackage
In-Reply-To: <56C1F98C.5040601@gmail.com>
References: <56C1E4B7.7090705@gmail.com>
 <201602151553.14964.even.rouault@spatialys.com> <56C1F98C.5040601@gmail.com>
Message-ID: <201602151912.58249.even.rouault@spatialys.com>

Le lundi 15 février 2016 17:15:08, Jesse McGraw a écrit :
> Thanks Even.
> 
> I've uploaded it to dropbox here:
> https://www.dropbox.com/s/7tcxh9bvk4127c6/Washington_SEC.tif?dl=0

Fixed per https://trac.osgeo.org/gdal/ticket/6365 (the complexity of the own 
tile caching mechanisms of the driver, correlated with the GDAL block cache, 
has gone a bit out of control...)

A workaround would likely be to increase GDAL_CACHEMAX to a number exceeding 
the uncompressed size of the input + output raster.

Even

> 
> On 02/15/2016 09:53 AM, Even Rouault wrote:
> > Jesse,
> > 
> > The geotiff would be necessary to replicate.
> > 
> > Even
> > 
> > Le lundi 15 février 2016 15:46:15, Jesse McGraw a écrit :
> >> I was fiddling with Even's geopackage examples
> >> <http://erouault.blogspot.com/2014/12/gdal-geopackage-raster-support.htm
> >> l> when I came across a core dump issue in gdal_translate
> >> 
> >> gdal version is compiled from github trunk as of 15 February 2016 under
> >> Ubuntu 15.10 x64
> >> 
> >>      gdal_translate --version
> >>      GDAL 2.1.0dev, released 2015/99/99
> >> 
> >> I can share the geotiff in question if need be.  Let me know if I can
> >> provide any other helpful information
> >> 
> >> Basic command is:
> >>      gdal_translate \
> >>      
> >>           Washington_SEC.tif \
> >>           test.gpkg \
> >>           -of GPKG \
> >>           -co TILE_FORMAT=PNG \
> >>           -co TILING_SCHEME=GoogleMapsCompatible
> >> 
> >> Out from Valgrind is:
> >>      jlmcgraw at UbuntuMate1504:~/Documents/myPrograms/gdal_tests$
> >>      CPL_DEBUG=ON \
> >>      
> >>       > valgrind --tool=memcheck --leak-check=yes --read-var-info=yes \
> >>       > gdal_translate \
> >>       > 
> >>       >     Washington_SEC.tif \
> >>       >     test.gpkg \
> >>       >     -of GPKG \
> >>       >     -co TILE_FORMAT=PNG \
> >>       >     -co TILING_SCHEME=GoogleMapsCompatible
> >>      
> >>      ==30978== Memcheck, a memory error detector
> >>      ==30978== Copyright (C) 2002-2015, and GNU GPL'd, by Julian Seward
> >>      et al.
> >>      ==30978== Using Valgrind-3.11.0 and LibVEX; rerun with -h for
> >>      copyright info
> >>      ==30978== Command: gdal_translate Washington_SEC.tif test.gpkg -of
> >>      GPKG -co TILE_FORMAT=PNG -co TILING_SCHEME=GoogleMapsCompatible
> >>      ==30978==
> >>      GDAL: GDALOpen(Washington_SEC.tif, this=0xf7e9d80) succeeds as
> >>      GTiff. Input file size is 15538, 11309
> >>      GDAL: GDAL_CACHEMAX = 100 MB
> >>      GDAL: GDALWarpKernel()::GWKGeneralCase()
> >>      Src=0,0,1944x1415 Dst=0,0,2737x1992
> >>      0GDAL: GDALWarpKernel()::GWKGeneralCase()
> >>      Src=1941,0,1945x1415 Dst=2737,0,2737x1992
> >>      .GDAL: GDALWarpKernel()::GWKGeneralCase()
> >>      Src=3883,0,1945x1415 Dst=5474,0,2737x1992
> >>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
> >>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
> >>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
> >>      --30978-- warning: evaluate_Dwarf3_Expr: unhandled DW_OP_ 0xf2
> >>      ==30978== Invalid write of size 8
> >>      ==30978==    at 0x4C3259F: memset (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x5692CD8: memset (string3.h:90)
> >>      ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int,
> >>      int, unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
> >>      ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int,
> >>      int) (gdalgeopackagerasterband.cpp:489)
> >>      ==30978==    by 0x5694B51:
> >>      GDALGeoPackageRasterBand::IReadBlock(int, int, void*)
> >>      (gdalgeopackagerasterband.cpp:733)
> >>      ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
> >>      int, int) (gdalrasterband.cpp:1142)
> >>      ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
> >>      int, int, int, int, void*, int, int, GDALDataType, long long, long
> >>      long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
> >>      ==30978==    by 0x557312A:
> >>      GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
> >>      void*, int, int, GDALDataType, int, int*, long long, long long,
> >>      long long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
> >>      ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
> >>      int, int, int, void*, int, int, GDALDataType, int, int*, long long,
> >>      long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
> >>      ==30978==    by 0x551B11D: GDALDatasetRasterIO
> >>      (gdaldataset.cpp:2034) ==30978==    by 0x56384C4:
> >>      GDALWarpOperation::WarpRegion(int, int, int, int, int, int, int,
> >>      int, int, int, double, double)
> >>      (gdalwarpoperation.cpp:1370)
> >>      ==30978==    by 0x56387C6:
> >>      GDALWarpOperation::ChunkAndWarpImage(int, int, int, int)
> >>      (gdalwarpoperation.cpp:720)
> >>      ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
> >>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
> >>      void*), void*) (ogrgeopackagedatasource.cpp:3242)
> >>      ==30978==  Address 0x0 is not stack'd, malloc'd or (recently)
> >>      free'd ==30978==
> >>      ==30978==
> >>      ==30978== Process terminating with default action of signal 11
> >> 
> >> (SIGSEGV) ==30978==  Access not within mapped region at address 0x0
> >> 
> >>      ==30978==    at 0x4C3259F: memset (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x5692CD8: memset (string3.h:90)
> >>      ==30978==    by 0x5692CD8: GDALGeoPackageDataset::ReadTile(int,
> >>      int, unsigned char*, bool*) (gdalgeopackagerasterband.cpp:641)
> >>      ==30978==    by 0x5692FA2: GDALGeoPackageDataset::ReadTile(int,
> >>      int) (gdalgeopackagerasterband.cpp:489)
> >>      ==30978==    by 0x5694B51:
> >>      GDALGeoPackageRasterBand::IReadBlock(int, int, void*)
> >>      (gdalgeopackagerasterband.cpp:733)
> >>      ==30978==    by 0x5553B15: GDALRasterBand::GetLockedBlockRef(int,
> >>      int, int) (gdalrasterband.cpp:1142)
> >>      ==30978==    by 0x5572525: GDALRasterBand::IRasterIO(GDALRWFlag,
> >>      int, int, int, int, void*, int, int, GDALDataType, long long, long
> >>      long, GDALRasterIOExtraArg*) (rasterio.cpp:307)
> >>      ==30978==    by 0x557312A:
> >>      GDALDataset::BlockBasedRasterIO(GDALRWFlag, int, int, int, int,
> >>      void*, int, int, GDALDataType, int, int*, long long, long long,
> >>      long long, GDALRasterIOExtraArg*) (rasterio.cpp:2938)
> >>      ==30978==    by 0x551B09C: GDALDataset::RasterIO(GDALRWFlag, int,
> >>      int, int, int, void*, int, int, GDALDataType, int, int*, long long,
> >>      long long, long long, GDALRasterIOExtraArg*) (gdaldataset.cpp:1991)
> >>      ==30978==    by 0x551B11D: GDALDatasetRasterIO
> >>      (gdaldataset.cpp:2034) ==30978==    by 0x56384C4:
> >>      GDALWarpOperation::WarpRegion(int, int, int, int, int, int, int,
> >>      int, int, int, double, double)
> >>      (gdalwarpoperation.cpp:1370)
> >>      ==30978==    by 0x56387C6:
> >>      GDALWarpOperation::ChunkAndWarpImage(int, int, int, int)
> >>      (gdalwarpoperation.cpp:720)
> >>      ==30978==    by 0x57A9F5A: GDALGeoPackageDataset::CreateCopy(char
> >>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
> >>      void*), void*) (ogrgeopackagedatasource.cpp:3242)
> >>      ==30978==  If you believe this happened as a result of a stack
> >>      ==30978==  overflow in your program's main thread (unlikely but
> >>      ==30978==  possible), you can try to increase the size of the
> >>      ==30978==  main thread stack using the --main-stacksize= flag.
> >>      ==30978==  The main thread stack size used in this run was 8388608.
> >>      ==30978==
> >>      ==30978== HEAP SUMMARY:
> >>      ==30978==     in use at exit: 138,658,730 bytes in 10,473 blocks
> >>      ==30978==   total heap usage: 58,500 allocs, 48,027 frees,
> >>      326,332,504 bytes allocated
> >>      ==30978==
> >>      ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
> >>      4,171 of 4,283
> >>      ==30978==    at 0x4C2BBCF: malloc (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x7CECC56: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CC92F5: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCC5A6: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CEB222: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D200D7: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D29826: sqlite3_step (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D2A899: sqlite3_exec (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
> >>      (ogrgeopackageutility.cpp:41)
> >>      ==30978==    by 0x57A4D5C:
> >>      GDALGeoPackageDataset::FinalizeRasterRegistration()
> >>      (ogrgeopackagedatasource.cpp:1383)
> >>      ==30978==    by 0x57A9CBA: GDALGeoPackageDataset::CreateCopy(char
> >>      const*, GDALDataset*, int, char**, int (*)(double, char const*,
> >>      void*), void*) (ogrgeopackagedatasource.cpp:3150)
> >>      ==30978==    by 0x5522F48: GDALDriver::CreateCopy(char const*,
> >>      GDALDataset*, int, char**, int (*)(double, char const*, void*),
> >>      void*) (gdaldriver.cpp:803)
> >>      ==30978==
> >>      ==30978== 1,032 bytes in 1 blocks are possibly lost in loss record
> >>      4,172 of 4,283
> >>      ==30978==    at 0x4C2BBCF: malloc (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x7CECC56: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CC92F5: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCC5A6: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CEB222: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D200D7: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D29826: sqlite3_step (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D2A899: sqlite3_exec (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x57B297B: SQLCommand(sqlite3*, char const*)
> >>      (ogrgeopackageutility.cpp:41)
> >>      ==30978==    by 0x5695415:
> >>      GDALGeoPackageDataset::WriteShiftedTile(int, int, int, int, int,
> >>      int, int) (gdalgeopackagerasterband.cpp:1645)
> >>      ==30978==    by 0x5695CAC:
> >>      GDALGeoPackageRasterBand::IWriteBlock(int, int, void*)
> >>      (gdalgeopackagerasterband.cpp:2121)
> >>      ==30978==    by 0x555805F: GDALRasterBlock::Write()
> >>      (gdalrasterblock.cpp:743)
> >>      ==30978==
> >>      ==30978== 1,304 bytes in 1 blocks are possibly lost in loss record
> >>      4,186 of 4,283
> >>      ==30978==    at 0x4C2BBCF: malloc (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x7CECC56: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CC92F5: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCC5A6: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCD0FF: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D003AE: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D007FA: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D012E8: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D0374F: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D06D63: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D09554: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D2346A: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==
> >>      ==30978== 3,912 bytes in 3 blocks are possibly lost in loss record
> >>      4,228 of 4,283
> >>      ==30978==    at 0x4C2BBCF: malloc (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x7CECC56: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CC92F5: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCC5A6: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCD0FF: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D003AE: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D007FA: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D012E8: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D0374F: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D06EB7: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D09554: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D2346A: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==
> >>      ==30978== 710,680 bytes in 545 blocks are possibly lost in loss
> >>      record 4,275 of 4,283
> >>      ==30978==    at 0x4C2BBCF: malloc (in
> >>      /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
> >>      ==30978==    by 0x7CECC56: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CC92F5: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCC5A6: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7CCD0FF: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D003AE: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D007FA: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D012E8: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D0374F: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D09228: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D2346A: ??? (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==    by 0x7D29826: sqlite3_step (in
> >>      /usr/lib/x86_64-linux-gnu/libsqlite3.so.0.8.6)
> >>      ==30978==
> >>      ==30978== LEAK SUMMARY:
> >>      ==30978==    definitely lost: 0 bytes in 0 blocks
> >>      ==30978==    indirectly lost: 0 bytes in 0 blocks
> >>      ==30978==      possibly lost: 717,960 bytes in 551 blocks
> >>      ==30978==    still reachable: 137,940,770 bytes in 9,922 blocks
> >>      ==30978==                       of which reachable via heuristic:
> >>      ==30978==                         length64           : 483,616
> >>      bytes in 2,334 blocks
> >>      ==30978==         suppressed: 0 bytes in 0 blocks
> >>      ==30978== Reachable blocks (those to which a pointer was found) are
> >>      not shown.
> >>      ==30978== To see them, rerun with: --leak-check=full
> >>      --show-leak-kinds=all
> >>      ==30978==
> >>      ==30978== For counts of detected and suppressed errors, rerun with:
> >>      -v ==30978== ERROR SUMMARY: 6 errors from 6 contexts (suppressed:
> >>      0 from
> >> 
> >> 0) Segmentation fault (core dumped)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Feb 15 10:37:13 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 15 Feb 2016 19:37:13 +0100
Subject: [gdal-dev] gdal not recognizing ellpsoid properly in esri grid
	format
In-Reply-To: <CAHYDKLa4vf=dtbOGO76Hqq8OMYqaGXXTwQN8ANZ612WWZL0DgA@mail.gmail.com>
References: <CAHYDKLa4vf=dtbOGO76Hqq8OMYqaGXXTwQN8ANZ612WWZL0DgA@mail.gmail.com>
Message-ID: <201602151937.13387.even.rouault@spatialys.com>

Le lundi 15 février 2016 18:54:51, Dominik Schneider a écrit :
> Hi,
> I was sent an esri grid that uses a spherical ellpsoid with +a and +b
> parameters but this not being read properly. It is being assigned
> +ellps=WGS84 when read with raster::raster() in R 3.2.3 but also when using
> gdalinfo on the command line.  I'm using GDAL 1.11.3 from kyngchaos.com on
> OS X 10.11.3
> 
> Not sure if this is a known issue or subsequently fixed in later versions
> so I wanted to report it here. I didn't see a ticket that addresses this in
> particular.

There was no support for reading custom ellipsoid from old-style .prj. I've 
just added it in trunk.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jonvwill at verizon.net  Mon Feb 15 10:40:30 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Mon, 15 Feb 2016 13:40:30 -0500
Subject: [gdal-dev] GDAL using Nvidia - won't use OpenCL
Message-ID: <56C21B9E.7050400@verizon.net>

Hello,
I've been trying to compile GDAL with OpenCL support for an Nvidia
gt555m (this is an Alienware m14x r1 laptop) on Ubuntu desktop (I wanted
to run it headless, but Ubuntu server failed to boot with the Nvidia
drivers and without X installed).

Per the instructions at various sites, including here:
https://wiki.tiker.net/OpenCLHowTo , I installed Ubuntu packages
nvidia-346, nvidia-346-uvm, nvidia-libopencl1-346 and
nvidia-opencl-icd-346. Other combinations seemed to fail, including
adding nvidia-opencl-dev, and more recent Ubuntu Nvidia driver versions
didn't include the uvm package (I think the current driver is the 361
series).

So, after installing these packages and making sure everything was in
order in /etc/OpenCL/vendors, I verified OpenCL was functional using
test packages like MandelGPU/MandelCPU. The OpenCL speedup was obvious
using these tests.

After a lot of trial-and-error compilations, this is my configuration
for GDAL with OpenCL:

./configure \
--prefix=/usr \
--disable-rpath \
--with-threads=yes \
--with-ogr \
--with-geos \
--without-libtool \
--with-libz=internal \
--with-libtiff=internal \
--with-geotiff=internal \
--with-pg=/usr/bin/pg_config \
--with-expat-lib=/usr/lib/x86_64-linux-gnu/libexpat.so \
--with-netcdf=/usr/lib \
--with-png=internal \
--with-jpeg=internal \
--with-gif=internal \
--without-kakadu \
--without-mrsid \
--without-jp2mrsid \
--with-liblzma=yes \
--with-curl=/usr/lib/x86_64-linux-gnu \
--with-ecw=/usr/local/hexagon \
--with-python=yes \
--with-hide-internal-symbols \
--with-jasper=/usr/local \
--with-openjpeg=/usr/local \
--with-opencl=yes \
--with-opencl-include=/usr/include \
--with-opencl-lib="-L/usr/lib/x86_64-linux-gnu -lOpenCL"

While I did get a couple of errors with this, they seem unrelated to
anything important (complaining of a zero-length gnu_printf format
string, ./config.rpath not existing, and GDALmake.opt.in ignoring the
--datarootdir setting), and a look at the output indicates OpenCL
support is selected.

Compilation itself completes with no obvious errors, and the resulting
functions run correctly. However, there is no speedup from using -wo
"USE_OPENCL=TRUE" over -wo "USE_OPENCL=FALSE", nor is there any effect
seen using nvidia-smi monitoring.

The GDALWARP command I'm running is this:
gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=TRUE" tmp.grib2 tmp.tif

vs.

gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=FALSE" tmp.grib2 tmp.tif


This system has four cores and is multithreading, so -wo
"NUM_THREADS=ALL_CPUS" does produce a speedup. But again, USE_OPENCL
does not. In fact, the program is entirely functional and does exactly
what I want, except for opencl functionality.

I'm at a bit of a loss as to what might be wrong. I've tried various
combinations of the with-opencl flags. I'm running all functions as
root, and have tried modprobe nvidia-uvm. No errors, no debug problems
noted, it just won't use the GPU. Part of my problem is I'm not sure
what problems would produce an error, and what just would fail silently.

Any insight would be appreciated!

Best regards,
Jonathan Williams

From ilanit at defensoft.com  Tue Feb 16 00:37:15 2016
From: ilanit at defensoft.com (Ilanit Karpassi)
Date: Tue, 16 Feb 2016 10:37:15 +0200
Subject: [gdal-dev] Resample elevation GeoTiff to 1 meter resolution.
Message-ID: <ce9a1a5f10d93263ef38523b98473978@mail.gmail.com>

Hi,



I need to resample any resolution GeoTiff with Z heights, to 1 meter per
pixel GeoTiff.  I need a Z value in each pixel according to the algorithm

 If I use GDAL_Warp, .  (using the C++ code)  it seems that it does that
with 0 values to all pixels.



Can you give me a good advice please?

Ilanit
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160216/b3fc9596/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Feb 16 01:53:11 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Tue, 16 Feb 2016 09:53:11 +0000 (UTC)
Subject: [gdal-dev] Resample elevation GeoTiff to 1 meter resolution.
References: <ce9a1a5f10d93263ef38523b98473978@mail.gmail.com>
Message-ID: <loom.20160216T104714-649@post.gmane.org>

Ilanit Karpassi <ilanit <at> defensoft.com> writes:


> Hi,
> 
> I
> need to resample any resolution GeoTiff with Z heights, to 1 meter per
pixel GeoTiff.  I
> need a Z value in each pixel according to the algorithm 
> 
>  If
> I use GDAL_Warp, .  (using the C++ code)  it seems that it does that with 0
> values to all pixels. 
> 
> Can
> you give me a good advice please? 

So you have written an algorithm in C++ and it converts all Z values into
zeroes? Why not to show your code? As a non-programmer I would resample the
GeoTIFF first with "gdalwarp -tr 1 1" and continue then with gdal_calc.py
http://www.gdal.org/gdal_calc.html

-Jukka Rahkonen-

From even.rouault at spatialys.com  Tue Feb 16 02:28:33 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Feb 2016 11:28:33 +0100
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required] GSoC
	2016 Ideas page
Message-ID: <201602161128.33644.even.rouault@spatialys.com>

Hi,

Potential mentors and students: time to update 
https://trac.osgeo.org/gdal/wiki/SummerOfCode

Even

----------  Message transmis  ----------

Sujet : [OSGeo-Discuss] [@Mentors: Action required] GSoC 2016 Ideas page
Date : mardi 16 février 2016, 11:16:03
De : Margherita Di Leo <diregola at gmail.com>
À : OSGeo Discussions <discuss at lists.osgeo.org>, "OSGeo-SoC" 
<soc at lists.osgeo.org>

Dear All,

we would like to inform you all that we have applied on behalf of OSGeo, as
a mentor organization for Google Summer of Code 2016. The application can
be found at [1]. We ask your cooperation to set up the ideas page within
few days. It is extremely important that the ideas page looks in good shape
as it is the key page Google will be looking at when evaluating OSGeo. As
usual, each community will set up its ideas page on its own wiki and will
send us the link, that will be added by us to the main page [2]. Please
forward this email to your communities.

As past years, OSGeo welcomes like minded projects that wish to participate
under the org’s umbrella, not being official OSGeo projects. Please contact
us to discuss it further.

Your OSGeo GSoC 2016 Admins

Margherita Di Leo (madi)

Anne Ghisla (aghisla)

[1] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_Application_2016

[2] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2016_Ideas


-- 
Margherita Di Leo

-------------------------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Feb 16 05:17:12 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 16 Feb 2016 15:17:12 +0200
Subject: [gdal-dev] Supporting measures in ogrinfo
Message-ID: <56C32158.1020900@gmail.com>

I committed a change which adds WKT2 as a new option to the -geom 
switch. Setting -geom=WKT2 makes ogrinfo print the geometry using WKT 
according to the new specification ("POINT M (1 2 3)" etc).

Where can one edit the (source) of the page

http://www.gdal.org/ogrinfo.html

?

Ari


From even.rouault at spatialys.com  Tue Feb 16 05:31:42 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 16 Feb 2016 14:31:42 +0100
Subject: [gdal-dev] Supporting measures in ogrinfo
In-Reply-To: <56C32158.1020900@gmail.com>
References: <56C32158.1020900@gmail.com>
Message-ID: <201602161431.42181.even.rouault@spatialys.com>

Le mardi 16 février 2016 14:17:12, Ari Jolma a écrit :
> I committed a change which adds WKT2 as a new option to the -geom
> switch. Setting -geom=WKT2 makes ogrinfo print the geometry using WKT
> according to the new specification ("POINT M (1 2 3)" etc).

WKT2 makes me rather think to the SRS WKT-2 spec ( 
http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ). Why not ISO_WKT ?

I'm wondering if we shouldn't default to this WKT2/ISO_WKT for ogrinfo ? There 
might be some incompatibility effect, but having to pass a switch to see M 
values is a bit counter-intuitive.

> 
> Where can one edit the (source) of the page
> 
> http://www.gdal.org/ogrinfo.html

apps/ogr_utilities.dox

> 
> ?
> 
> Ari
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Tue Feb 16 05:54:40 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 16 Feb 2016 15:54:40 +0200
Subject: [gdal-dev] Supporting measures in ogrinfo
In-Reply-To: <201602161431.42181.even.rouault@spatialys.com>
References: <56C32158.1020900@gmail.com>
 <201602161431.42181.even.rouault@spatialys.com>
Message-ID: <56C32A20.2040006@gmail.com>

16.02.2016, 15:31, Even Rouault kirjoitti:
> Le mardi 16 février 2016 14:17:12, Ari Jolma a écrit :
>> I committed a change which adds WKT2 as a new option to the -geom
>> switch. Setting -geom=WKT2 makes ogrinfo print the geometry using WKT
>> according to the new specification ("POINT M (1 2 3)" etc).
> WKT2 makes me rather think to the SRS WKT-2 spec (
> http://docs.opengeospatial.org/is/12-063r5/12-063r5.html ). Why not ISO_WKT ?

Ops. So it seems. I was looking at some pages but they indeed talk about 
new WKT for CRS.


>
> I'm wondering if we shouldn't default to this WKT2/ISO_WKT for ogrinfo ? There
> might be some incompatibility effect, but having to pass a switch to see M
> values is a bit counter-intuitive.

I really have no opinion. I'd be happy to have it the default.

>
>> Where can one edit the (source) of the page
>>
>> http://www.gdal.org/ogrinfo.html
> apps/ogr_utilities.dox

ok


Ari

>
>> ?
>>
>> Ari
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From JPalmer at linz.govt.nz  Tue Feb 16 10:40:04 2016
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Wed, 17 Feb 2016 07:40:04 +1300
Subject: [gdal-dev] CSV spatial data on the web
Message-ID: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>

For forks that are interested W3C has setup a CSV on the Web Working Group https://www.w3.org/2013/csvw/wiki/Main_Page to provide recommendations for better interoperability when working with CSV datasets.

I raised an issue a few months ago on the working documents, with my main issue being that spatial datatypes are not really accounted for:

https://github.com/w3c/csvw/issues/795

I believe this is an important thing to solve as publishing large open datasets is something that is not well addressed and keeps getting reinvented by multiple groups or vendors.

They have now responded to my issue with this response:

https://github.com/w3c/csvw/pull/822

But I think this response needs a wider community view.

Cheers,
Jeremy

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From sfkeller at gmail.com  Tue Feb 16 10:57:43 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Tue, 16 Feb 2016 19:57:43 +0100
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
Message-ID: <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>

Hi Jeremy

Thanks for the info.
I assume you are aware of GeoCSV and related software like the
well-known OGR (and the #TheShapefileChallenge ):
http://giswiki.hsr.ch/GeoCSV

:Stefan


2016-02-16 19:40 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
> For forks that are interested W3C has setup a CSV on the Web Working Group https://www.w3.org/2013/csvw/wiki/Main_Page to provide recommendations for better interoperability when working with CSV datasets.
>
> I raised an issue a few months ago on the working documents, with my main issue being that spatial datatypes are not really accounted for:
>
> https://github.com/w3c/csvw/issues/795
>
> I believe this is an important thing to solve as publishing large open datasets is something that is not well addressed and keeps getting reinvented by multiple groups or vendors.
>
> They have now responded to my issue with this response:
>
> https://github.com/w3c/csvw/pull/822
>
> But I think this response needs a wider community view.
>
> Cheers,
> Jeremy
>
> This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.
> _______________________________________________
> Standards mailing list
> Standards at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/standards

From jonvwill at verizon.net  Tue Feb 16 12:51:03 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Tue, 16 Feb 2016 15:51:03 -0500
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
Message-ID: <56C38BB7.3030207@verizon.net>

Hello,
In addition to my previous question regarding OpenCL support bafflement,
I've run into difficulty compiling GDAL 2.02 with ECW support.

I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
located there, and symlinked the
/usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
/usr/local/lib/libNCSEcw.so .

Configuration completes with no errors, as does compilation. The
./configure output indicates that support is selected, and config.log
says all libraries were found.

However, the completed utilities do not list ecw as a readable format,
and indeed, they cannot read ecw files (much less jpeg2000 ones).

I understand there have been libgdal-ecw scripts that some have run to
enable support; however, I haven't found one for this situation (Ubuntu
desktop 14.04.3 LTS 64 bit, with gdal 2.02).

Is it the case that these scripts also need to be run to enable ecw
support? or am I foolishly missing something?

I see in the config.log that -ECW_FLAGS are set to
'-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
-DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library had
been selected; however, manually modifying the flag "DX86" to "DX64"
simply produced an error.

Any insight would be appreciated.

Best regards,
Jonathan Williams


From andrew.bell.ia at gmail.com  Tue Feb 16 15:23:26 2016
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 16 Feb 2016 17:23:26 -0600
Subject: [gdal-dev] GDALApplyGeoTransform
Message-ID: <CACJ51z0JAzcsEBN5Vv3ek2+NjD=fn_yxVfS=Jgp6ii2KkbkynQ@mail.gmail.com>

Hi,

I'm trying to understand why GDALApplyGeoTransform behaves as it does.
I would think that when you use it to transform a raster coordinate to
a geo coordinate, it would apply what is known about the raster and
the transformation to get the correct location.  What I see happening
is some drivers is an adjustment to "center" the points in the middle
of a raster cell.  This is fine, but I don't understand why
GDALApplyGeoTransform doesn't do this if this is always the proper
operation.  The GeoTiff spec (see 2.5.2.2) says that this behavior is
the default unless the key GTRasterTypeGeoKey is set to
RasterPixelIsPoint.

Then I found this:
https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint which was
supposed to address this issue, but I'm not sure it was implemented or
how.

Anyway, I'm not sure what's supposed to happen and I'm not sure why I
should have to manually adjust a pixel's position when converted to a
geolocation rather than expect the correct value to be generated by
GDALApplyGeoTransform.

Of course, I may well be missing something, so please correct me if I am.

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com

From jacek.tomaka at hexagongeospatial.com  Tue Feb 16 21:26:39 2016
From: jacek.tomaka at hexagongeospatial.com (Tomaka, Jacek)
Date: Wed, 17 Feb 2016 05:26:39 +0000
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <56C38BB7.3030207@verizon.net>
References: <56C38BB7.3030207@verizon.net>
Message-ID: <3ED562F633B1AE46BF141E903F9813078AE5D107@ap-mbx3.ingrnet.com>

HI Jonathan, 
Have you tried compiling in  ECW/JP2 support as a plugin?
Regards.
Jacek Tomaka

-----Original Message-----
From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jonathan Williams
Sent: Wednesday, 17 February 2016 4:51 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled

Hello,
In addition to my previous question regarding OpenCL support bafflement, I've run into difficulty compiling GDAL 2.02 with ECW support.

I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is located there, and symlinked the /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to /usr/local/lib/libNCSEcw.so .

Configuration completes with no errors, as does compilation. The ./configure output indicates that support is selected, and config.log says all libraries were found.

However, the completed utilities do not list ecw as a readable format, and indeed, they cannot read ecw files (much less jpeg2000 ones).

I understand there have been libgdal-ecw scripts that some have run to enable support; however, I haven't found one for this situation (Ubuntu desktop 14.04.3 LTS 64 bit, with gdal 2.02).

Is it the case that these scripts also need to be run to enable ecw support? or am I foolishly missing something?

I see in the config.log that -ECW_FLAGS are set to '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library had been selected; however, manually modifying the flag "DX86" to "DX64"
simply produced an error.

Any insight would be appreciated.

Best regards,
Jonathan Williams

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

From sarah.lawrie at ga.gov.au  Tue Feb 16 21:38:34 2016
From: sarah.lawrie at ga.gov.au (budgie26)
Date: Tue, 16 Feb 2016 21:38:34 -0800 (PST)
Subject: [gdal-dev] Creating geotiff with rotation, but image is flipped
Message-ID: <1455687514273-5251005.post@n6.nabble.com>

Hi,

I've been trying to convert a *.png file to geotiff and I have the necessary
coordinates to do so. However I'm having problems trying to get the geotiff
to display properly (it's flipped) and I need some advice! 

The *.png details are:
UL: 37.686398 23.744484
LL: 38.073174 21.922295
UR: 40.149170 24.165144
LR: 40.501301 22.346598
CEN: 39.0938495 23.0437195
Skew/rotation: -12.3321408987529 (anti-clockwise from North)

After extensive searching on the web for solutions, this is how far I've
got:

Start by converting *.png to *.tif using ImageMagick: 

Get information on the *.tif with gdal: 
Driver: GTiff/GeoTIFF
Files: image.tif
Size is 1488, 2447
Coordinate System is `'
Metadata:
  TIFFTAG_DOCUMENTNAME=image.tif
  TIFFTAG_RESOLUTIONUNIT=1 (unitless)
  TIFFTAG_XRESOLUTION=72
  TIFFTAG_YRESOLUTION=72
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 2447.0)
Upper Right ( 1488.0,    0.0)
Lower Right ( 1488.0, 2447.0)
Center      (  744.0, 1223.5)
Band 1 Block=1488x1 Type=Byte, ColorInterp=Red
Band 2 Block=1488x1 Type=Byte, ColorInterp=Green
Band 3 Block=1488x1 Type=Byte, ColorInterp=Blue

Convert the *.tif to a geotif by using GCPs:


Apply the projection, WGS84:


The resulting image is:

<http://osgeo-org.1560.x6.nabble.com/file/n5251005/image_init_geo.png> 

The image is in the correct orientation and coordinate location, but the
image is upside down.

I found a python script (
http://blog.perrygeo.net/2007/09/05/the-world-turned-right-side-up/
<http://blog.perrygeo.net/2007/09/05/the-world-turned-right-side-up/>  )
that will flip the image to the correct view, but the orientation is now
wrong:

<http://osgeo-org.1560.x6.nabble.com/file/n5251005/image_geo.png> 

I’m new to python so I haven’t been able to work out if there is something
in the python script that can be changed to resolve this problem. 

Initially I tried to manually create a world file (
https://en.wikipedia.org/wiki/World_file
<https://en.wikipedia.org/wiki/World_file>  ), but I just couldn’t get it to
plot in the correct location, even with the rotation values set to zero:


*.tfw contents:
0.001891736
0.0000000000
0.0000000000
-0.000916571
37.68734387
23.74494229

metadata.txt contents:
Geotiff_Information:
   Version: 1
   Key_Revision: 1.0
   Tagged_Information:
      ModelTiepointTag (2,3):
         0                0                0
        37.686398  23.744484     0
      ModelPixelScaleTag (1,3):
         0.001891736       -0.000916571      0
      End_Of_Tags.
   Keyed_Information:
      GTModelTypeGeoKey (Short,1): ModelTypeGeographic
      GTRasterTypeGeoKey (Short,1): RasterPixelIsArea
      GeographicTypeGeoKey (Short,1): GCS_WGS_84
      End_Of_Keys.
   End_Of_Geotiff.

GCS: 4326/WGS 84
Datum: 6326/World Geodetic System 1984
Ellipsoid: 7030/WGS 84 (6378137.00,6356752.31)
Prime Meridian: 8901/Greenwich (0.000000/  0d 0' 0.00"E)

PROJ.4 Definition: +proj=latlong +ellps=WGS84 +to_meter=1.0000000000

Corner Coordinates:
Upper Left    (37.686398, 23.744484)
Lower Left    (38.073174, 21.922295)
Upper Right   (40.14917, 24.165144)
Lower Right   (40.501301, 22.346598)
Center        (39.0938495, 23.0437195)


Does anyone have any ideas on how I can keep the image’s orientation correct
while flipping it? 




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Creating-geotiff-with-rotation-but-image-is-flipped-tp5251005.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gane.prog at gmail.com  Tue Feb 16 23:33:02 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 17 Feb 2016 13:03:02 +0530
Subject: [gdal-dev] Question on using SetFID
Message-ID: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>

Hi all,

I am creating a layer for geopackage, But I don't see the fid I set using
setFID here is my code flow.

Step1:
poLayer = OGRDataSource::CreateLayer(....);

Step2:
adding all the fields

Step3:
poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );

then
Step 4:
poFeature->SetFID(100);
 setting to a layer using
 poLayer->CreateFeature( poFeature )

Step 5:

OGRFeature::DestroyFeature( poFeature );
then destroying the poFeature,
again creating the feature using Step 3:

Every thing is fine but the feature id is set to start from 1, but I was
expecting
as 100 for the code flow above,

did I miss some GDAL API call ?.

Thanks
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/98de8353/attachment.html>

From ari.jolma at gmail.com  Wed Feb 17 00:16:42 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Wed, 17 Feb 2016 10:16:42 +0200
Subject: [gdal-dev] Question on using SetFID
In-Reply-To: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>
References: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>
Message-ID: <56C42C6A.8040500@gmail.com>

17.02.2016, 09:33, Gane R kirjoitti:
> Hi all,
>
> I am creating a layer for geopackage, But I don't see the fid I set 
> using setFID here is my code flow.
>
> Step1:
> poLayer = OGRDataSource::CreateLayer(....);
>
> Step2:
> adding all the fields
>
> Step3:
> poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
>
> then
> Step 4:
> poFeature->SetFID(100);
>  setting to a layer using
>  poLayer->CreateFeature( poFeature )
>
> Step 5:
>
> OGRFeature::DestroyFeature( poFeature );
> then destroying the poFeature,
> again creating the feature using Step 3:
>
> Every thing is fine but the feature id is set to start from 1, but I 
> was expecting
> as 100 for the code flow above,

Please post the whole code. I did a small test using the Perl bindings 
and code, which should be similar

my $ds = Geo::OGR::Driver('GPKG')->Create('test.db');
my $l = $ds->CreateLayer(GeometryType => 'Point');
my $f = Geo::OGR::Feature->new($l->Schema);
$f->Geometry({WKT => 'POINT (1 2)'});
$f->FID(2);
$l->CreateFeature($f);

and the result is a small database with one spatial table, which has two 
columns: fid and geom, and one row. The fid is 2 on the row.

Ari


>
> did I miss some GDAL API call ?.
>
> Thanks
> Gane
>
>
>
>
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/cd36195c/attachment.html>

From even.rouault at spatialys.com  Wed Feb 17 02:07:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Feb 2016 11:07:54 +0100
Subject: [gdal-dev] Question on using SetFID
In-Reply-To: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>
References: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>
Message-ID: <201602171107.54885.even.rouault@spatialys.com>

Le mercredi 17 février 2016 08:33:02, Gane R a écrit :
> Hi all,
> 
> I am creating a layer for geopackage, But I don't see the fid I set using
> setFID here is my code flow.
> 
> Step1:
> poLayer = OGRDataSource::CreateLayer(....);
> 
> Step2:
> adding all the fields
> 
> Step3:
> poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
> 
> then
> Step 4:
> poFeature->SetFID(100);
>  setting to a layer using
>  poLayer->CreateFeature( poFeature )
> 
> Step 5:
> 
> OGRFeature::DestroyFeature( poFeature );
> then destroying the poFeature,
> again creating the feature using Step 3:
> 
> Every thing is fine but the feature id is set to start from 1, but I was
> expecting
> as 100 for the code flow above,
> 
> did I miss some GDAL API call ?.

Do you use GDAL 2.0 or above ? The GPKG driver only takes into account user-
set FID in CreateFeature() starting with GDAL 2.0

> 
> Thanks
> Gane

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Feb 17 02:12:19 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Feb 2016 11:12:19 +0100
Subject: [gdal-dev] GDALApplyGeoTransform
In-Reply-To: <CACJ51z0JAzcsEBN5Vv3ek2+NjD=fn_yxVfS=Jgp6ii2KkbkynQ@mail.gmail.com>
References: <CACJ51z0JAzcsEBN5Vv3ek2+NjD=fn_yxVfS=Jgp6ii2KkbkynQ@mail.gmail.com>
Message-ID: <201602171112.19375.even.rouault@spatialys.com>

Le mercredi 17 février 2016 00:23:26, Andrew Bell a écrit :
> Hi,
> 
> I'm trying to understand why GDALApplyGeoTransform behaves as it does.
> I would think that when you use it to transform a raster coordinate to
> a geo coordinate, it would apply what is known about the raster and
> the transformation to get the correct location.  What I see happening
> is some drivers is an adjustment to "center" the points in the middle
> of a raster cell.  This is fine, but I don't understand why
> GDALApplyGeoTransform doesn't do this if this is always the proper
> operation. 

GDALApplyGeoTransform() doesn't do this, as adjusting to pixel center or pixel 
top-left corner depends on the convention of each driver (and for some drivers 
like GTiff, both conventions can exist depending on datasets), so the logic is 
in driver code.


> The GeoTiff spec (see 2.5.2.2) says that this behavior is
> the default unless the key GTRasterTypeGeoKey is set to
> RasterPixelIsPoint.
> 
> Then I found this:
> https://trac.osgeo.org/gdal/wiki/rfc33_gtiff_pixelispoint which was
> supposed to address this issue, but I'm not sure it was implemented or
> how.

This is implemented in the GTiff driver.

> 
> Anyway, I'm not sure what's supposed to happen and I'm not sure why I
> should have to manually adjust a pixel's position when converted to a
> geolocation rather than expect the correct value to be generated by
> GDALApplyGeoTransform.

Drivers that need to convert from a format pixel-is-center logic to the GDAL 
pixel-origin-at-top-left-corner convention already do that by altering their 
geotransform matrix, so if you apply GDALApplyGeoTransform() you should get 
the "correct" answer (assuming you use the GDAL convention for your input 
values)

> 
> Of course, I may well be missing something, so please correct me if I am.
> 
> Thanks,

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JPalmer at linz.govt.nz  Wed Feb 17 02:16:07 2016
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Wed, 17 Feb 2016 23:16:07 +1300
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
Message-ID: <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>

Hi Stefan,

Yes I’m aware of the GeoCSV specific and the implementation within OGR. We actually support CSV+VRT from the NZ land data service: https://data.linz.govt.nz/. When we did the implementation about 4 years ago I don’t think your specification was around. I do like the simple approach of the CSVT. 

However looking at the GeoCSV specification it would be a step backwards for our users due to the field delimiter being semicolon. We also advertise the geometry datatype (useful for software quickly reading the data field metadata), field lengths/widths in the VRT, and have datasets with legitimate carriage returns within fields. What are the reasons for these design decisions or restrictions?

Cheers,
Jeremy

> On 17/02/2016, at 7:57 AM, Stefan Keller <sfkeller at gmail.com> wrote:
> 
> Hi Jeremy
> 
> Thanks for the info.
> I assume you are aware of GeoCSV and related software like the
> well-known OGR (and the #TheShapefileChallenge ):
> http://giswiki.hsr.ch/GeoCSV
> 
> :Stefan
> 
> 
> 2016-02-16 19:40 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
>> For forks that are interested W3C has setup a CSV on the Web Working Group https://www.w3.org/2013/csvw/wiki/Main_Page to provide recommendations for better interoperability when working with CSV datasets.
>> 
>> I raised an issue a few months ago on the working documents, with my main issue being that spatial datatypes are not really accounted for:
>> 
>> https://github.com/w3c/csvw/issues/795
>> 
>> I believe this is an important thing to solve as publishing large open datasets is something that is not well addressed and keeps getting reinvented by multiple groups or vendors.
>> 
>> They have now responded to my issue with this response:
>> 
>> https://github.com/w3c/csvw/pull/822
>> 
>> But I think this response needs a wider community view.
>> 
>> Cheers,
>> Jeremy
>> 
>> This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.
>> _______________________________________________
>> Standards mailing list
>> Standards at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/standards


From sfkeller at gmail.com  Wed Feb 17 02:31:09 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 17 Feb 2016 11:31:09 +0100
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
 <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
Message-ID: <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>

Hi Jeremy

> However looking at the GeoCSV specification it would be a step
> backwards for our users due to the field delimiter being semicolon.

Semicolon is well supported in software.
Tab is poorly supported in some text editors.
Comma is heavy used in number values in european countries.
What delimiter do you prefer and why?

> We also advertise the geometry datatype (useful for software quickly
> reading the data field metadata), field lengths/widths in the VRT,

That's covered by CSVT, isn't it?

> and have datasets with legitimate carriage returns within fields.

Allowing non-printable control-characters in strings makes it very
complicated and disables mainly all existing CSV software.
carriage returns is one of the few undisputed end-of-line things in
CSV (besides CR, LF, CR/LF differences).
Markup to the rescue.
What do you prefer?

:Stefan

[1] http://tools.ietf.org/html/rfc4180



2016-02-17 11:16 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
> Hi Stefan,
>
> Yes I’m aware of the GeoCSV specific and the implementation within OGR. We actually support CSV+VRT from the NZ land data service: https://data.linz.govt.nz/. When we did the implementation about 4 years ago I don’t think your specification was around. I do like the simple approach of the CSVT.
>
> However looking at the GeoCSV specification it would be a step backwards for our users due to the field delimiter being semicolon. We also advertise the geometry datatype (useful for software quickly reading the data field metadata), field lengths/widths in the VRT, and have datasets with legitimate carriage returns within fields. What are the reasons for these design decisions or restrictions?
>
> Cheers,
> Jeremy
>
>> On 17/02/2016, at 7:57 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Hi Jeremy
>>
>> Thanks for the info.
>> I assume you are aware of GeoCSV and related software like the
>> well-known OGR (and the #TheShapefileChallenge ):
>> http://giswiki.hsr.ch/GeoCSV
>>
>> :Stefan
>>
>>
>> 2016-02-16 19:40 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
>>> For forks that are interested W3C has setup a CSV on the Web Working Group https://www.w3.org/2013/csvw/wiki/Main_Page to provide recommendations for better interoperability when working with CSV datasets.
>>>
>>> I raised an issue a few months ago on the working documents, with my main issue being that spatial datatypes are not really accounted for:
>>>
>>> https://github.com/w3c/csvw/issues/795
>>>
>>> I believe this is an important thing to solve as publishing large open datasets is something that is not well addressed and keeps getting reinvented by multiple groups or vendors.
>>>
>>> They have now responded to my issue with this response:
>>>
>>> https://github.com/w3c/csvw/pull/822
>>>
>>> But I think this response needs a wider community view.
>>>
>>> Cheers,
>>> Jeremy
>>>
>>> This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.
>>> _______________________________________________
>>> Standards mailing list
>>> Standards at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/standards
>

From gane.prog at gmail.com  Wed Feb 17 02:38:08 2016
From: gane.prog at gmail.com (Gane R)
Date: Wed, 17 Feb 2016 16:08:08 +0530
Subject: [gdal-dev] Question on using SetFID
In-Reply-To: <201602171107.54885.even.rouault@spatialys.com>
References: <CALMrLdCpOsjOPrwxqrKLb0f2JAh86HNLPW5rTWUHJwnZ9M1Nyw@mail.gmail.com>
 <201602171107.54885.even.rouault@spatialys.com>
Message-ID: <CALMrLdCLM8kATtDZhGJSr5YeG27K7mYK2hTQxZojwcc-83oUyA@mail.gmail.com>

I am using gdal-1.11.3

I see the nFID have the value at debug when the
poFeature->setFID(100);
is called.
then poLayer->CreateFeature( poFeature ) is called.

Thanks
Gane



On Wed, Feb 17, 2016 at 3:37 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 17 février 2016 08:33:02, Gane R a écrit :
> > Hi all,
> >
> > I am creating a layer for geopackage, But I don't see the fid I set using
> > setFID here is my code flow.
> >
> > Step1:
> > poLayer = OGRDataSource::CreateLayer(....);
> >
> > Step2:
> > adding all the fields
> >
> > Step3:
> > poFeature = OGRFeature::CreateFeature( poLayer->GetLayerDefn() );
> >
> > then
> > Step 4:
> > poFeature->SetFID(100);
> >  setting to a layer using
> >  poLayer->CreateFeature( poFeature )
> >
> > Step 5:
> >
> > OGRFeature::DestroyFeature( poFeature );
> > then destroying the poFeature,
> > again creating the feature using Step 3:
> >
> > Every thing is fine but the feature id is set to start from 1, but I was
> > expecting
> > as 100 for the code flow above,
> >
> > did I miss some GDAL API call ?.
>
> Do you use GDAL 2.0 or above ? The GPKG driver only takes into account
> user-
> set FID in CreateFeature() starting with GDAL 2.0
>
> >
> > Thanks
> > Gane
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/16e73362/attachment.html>

From JPalmer at linz.govt.nz  Wed Feb 17 02:48:47 2016
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Wed, 17 Feb 2016 23:48:47 +1300
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
 <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
 <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>
Message-ID: <36DF4CF2-802F-4579-961C-B52E6786B79A@linz.govt.nz>

Hi Sfefan,

> On 17/02/2016, at 11:31 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>
> Hi Jeremy
>
> Semicolon is well supported in software.
> Tab is poorly supported in some text editors.
> Comma is heavy used in number values in european countries.
> What delimiter do you prefer and why?
>

Comma because it’s a well known default for most software. I agree semicolon is support almost as well. I see your european issue.

>> We also advertise the geometry datatype (useful for software quickly
>> reading the data field metadata), field lengths/widths in the VRT,
>
> That's covered by CSVT, isn't it?

Specification wasn’t clear and mentioned it could be supported. Looking at the actual OGR implementation is seems field width/lengths are supported (!), but still not the definition of the geometry field and type.

>
>> and have datasets with legitimate carriage returns within fields.
>
> Allowing non-printable control-characters in strings makes it very
> complicated and disables mainly all existing CSV software.

Yes but Excel handles it. So does OGR and QGIS Delimited Text Provider. From memory the Microsoft ODBC CSV driver doesn’t - but that’s got lots of issues.

> carriage returns is one of the few undisputed end-of-line things in
> CSV (besides CR, LF, CR/LF differences).
> Markup to the rescue.
> What do you prefer?
>

Markup can work but then it becomes about the reader being about to turn that markup into real carriage returns again. Mostly a pre-processing script is required first.

Cheers
Jeremy


This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From JPalmer at linz.govt.nz  Wed Feb 17 03:02:37 2016
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Thu, 18 Feb 2016 00:02:37 +1300
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <CAJOp35mn-bK9b5VdPbrGPS3-_WCz4YVBZdgn2z0a6ApDwAf99A@mail.gmail.com>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
 <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
 <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>
 <CAJOp35mn-bK9b5VdPbrGPS3-_WCz4YVBZdgn2z0a6ApDwAf99A@mail.gmail.com>
Message-ID: <84FB6FB4-1C9B-4847-8852-586F868D6F3F@linz.govt.nz>

We have all sorts or data within our fields, including pipe - think free description text field where users cut and paste all sorts of stuff!


Cheers
Jeremy

> On 17/02/2016, at 11:58 PM, Johan Van de Wauw <johan.vandewauw at gmail.com> wrote:
>
> On Wed, Feb 17, 2016 at 11:31 AM, Stefan Keller <sfkeller at gmail.com> wrote:
>> Hi Jeremy
>>
>>> However looking at the GeoCSV specification it would be a step
>>> backwards for our users due to the field delimiter being semicolon.
>>
>> Semicolon is well supported in software.
>> Tab is poorly supported in some text editors.
>> Comma is heavy used in number values in european countries.
>> What delimiter do you prefer and why?
>
> I would choose a delimiter which is uncommon in text. Eg pipe "|"
> seems a reasonable choice.


This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From mdsumner at gmail.com  Wed Feb 17 03:25:24 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 17 Feb 2016 11:25:24 +0000
Subject: [gdal-dev] vector drivers with mixed topology types in a single
	layer?
Message-ID: <CAAcGz9_GKUqy+kDH1m=5Q52j6P9Fo7Sn1Mk90LAXZZaKituLMw@mail.gmail.com>

Hi there, is there an easy way to discover which formats allow mixing of
vector types in a single layer?

I.e. a single layer MapInfo file with points, lines, and polygons - I know
there is MapInfo (tab) and MapInfo (mif) and GeoJSON,

I'd also like to know what drivers can present as a single data set but
with these types separated into different layers, like SDTS.

I consider the multiple shapefiles in one folder feature to be a somewhat
different, third case.

Is there a clear way to categorize these three kinds, and classify all
existing drivers this way?

Am I on the right track, or is it more complicated?

Cheers, Mike.



-- 
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/0db58905/attachment.html>

From even.rouault at spatialys.com  Wed Feb 17 04:18:18 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Feb 2016 13:18:18 +0100
Subject: [gdal-dev] vector drivers with mixed topology types in a single
	layer?
In-Reply-To: <CAAcGz9_GKUqy+kDH1m=5Q52j6P9Fo7Sn1Mk90LAXZZaKituLMw@mail.gmail.com>
References: <CAAcGz9_GKUqy+kDH1m=5Q52j6P9Fo7Sn1Mk90LAXZZaKituLMw@mail.gmail.com>
Message-ID: <201602171318.18647.even.rouault@spatialys.com>

Le mercredi 17 février 2016 12:25:24, Michael Sumner a écrit :
> Hi there, is there an easy way to discover which formats allow mixing of
> vector types in a single layer?

No, there is no such driver metadata currently. You need to open the dataset 
and query the layer geometry type. If it is unknown, then it allows mix of 
geometry types.

> 
> I.e. a single layer MapInfo file with points, lines, and polygons - I know
> there is MapInfo (tab) and MapInfo (mif) and GeoJSON,
> 
> I'd also like to know what drivers can present as a single data set but
> with these types separated into different layers, like SDTS.
> 
> I consider the multiple shapefiles in one folder feature to be a somewhat
> different, third case.
From the point of view of the OGR API, a directory of shapefile = a dataset 
with several layers
> 
> Is there a clear way to categorize these three kinds, and classify all
> existing drivers this way?

I think there are 2 orthogonal isssues :
- which drivers support mixed of geometry type in a single layer
- which drivers support multiple layers in a dataset (in general, datasets 
that support multiple layers do not set a constraint on the unicity of the 
geometry type among layers)

And perhaps to address your shapefile case :
- which drivers support only opening a file
- which drivers support only opening a directory
- which drivers support both
- which drivers are not file related (already addressed by checking if the 
GDAL_DMD_CONNECTION_PREFIX / "DMD_CONNECTION_PREFIX" metadata item is present. 
Was added in GDAL 2.0)

> 
> Am I on the right track, or is it more complicated?
> 
> Cheers, Mike.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mdsumner at gmail.com  Wed Feb 17 04:24:57 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 17 Feb 2016 12:24:57 +0000
Subject: [gdal-dev] vector drivers with mixed topology types in a single
	layer?
In-Reply-To: <201602171318.18647.even.rouault@spatialys.com>
References: <CAAcGz9_GKUqy+kDH1m=5Q52j6P9Fo7Sn1Mk90LAXZZaKituLMw@mail.gmail.com>
 <201602171318.18647.even.rouault@spatialys.com>
Message-ID: <CAAcGz9_JwAueQ1NAEiEpKCe_JzM7QAy140FEj6o_J+X2BezvgQ@mail.gmail.com>

On Wed, 17 Feb 2016 11:18 pm Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mercredi 17 février 2016 12:25:24, Michael Sumner a écrit :
> > Hi there, is there an easy way to discover which formats allow mixing of
> > vector types in a single layer?
>
> No, there is no such driver metadata currently. You need to open the
> dataset
> and query the layer geometry type. If it is unknown, then it allows mix of
> geometry types.
>
> >
> > I.e. a single layer MapInfo file with points, lines, and polygons - I
> know
> > there is MapInfo (tab) and MapInfo (mif) and GeoJSON,
> >
> > I'd also like to know what drivers can present as a single data set but
> > with these types separated into different layers, like SDTS.
> >
> > I consider the multiple shapefiles in one folder feature to be a somewhat
> > different, third case.
> From the point of view of the OGR API, a directory of shapefile = a dataset
> with several layers
> >
> > Is there a clear way to categorize these three kinds, and classify all
> > existing drivers this way?
>
> I think there are 2 orthogonal isssues :
> - which drivers support mixed of geometry type in a single layer
> - which drivers support multiple layers in a dataset (in general, datasets
> that support multiple layers do not set a constraint on the unicity of the
> geometry type among layers)
>
> And perhaps to address your shapefile case :
> - which drivers support only opening a file
> - which drivers support only opening a directory
> - which drivers support both
> - which drivers are not file related (already addressed by checking if the
> GDAL_DMD_CONNECTION_PREFIX / "DMD_CONNECTION_PREFIX" metadata item is
> present.
> Was added in GDAL 2.0)
>
>
>
>
> >
> > Am I on the right track, or is it more complicated?
> >
> > Cheers, Mike.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com


Thank you Even, very helpful.

Cheers, Mike



> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/602363eb/attachment.html>

From sfkeller at gmail.com  Wed Feb 17 04:53:44 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 17 Feb 2016 13:53:44 +0100
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <36DF4CF2-802F-4579-961C-B52E6786B79A@linz.govt.nz>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
 <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
 <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>
 <36DF4CF2-802F-4579-961C-B52E6786B79A@linz.govt.nz>
Message-ID: <CAFcOn2_7TJ=07tKPEq_2TSNxOsUwEAzLbQwRe28Eg4iJYJOiUw@mail.gmail.com>

Jeremy,

2016-02-17 11:48 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
>> Allowing non-printable control-characters in strings makes it very
>> complicated and disables mainly all existing CSV software.
>
> Yes but Excel handles it. So does OGR and QGIS Delimited Text Provider.
> From memory the Microsoft ODBC CSV driver doesn’t - but that’s got lots of issues.

No, it does'nt handle linebreaks as one record - nor is this allowed
in any of the CSV standardization approaches I know.
Actually, Excel is very bad at reading and exchanging CSV.
You probably meant Exel's .xls/.xslx?
CSV is a line oriented human-readable text format.
A text field is not "formatted": Technically spoken it's an array of characters.
There is no way to copy&paste "anything" into a pure string including
non-printable chars -
unless it's either encoded/binary or has a markup (and both would need
pre- and postformatting).

:Stefan



2016-02-17 11:48 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
> Hi Sfefan,
>
>> On 17/02/2016, at 11:31 PM, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> Hi Jeremy
>>
>> Semicolon is well supported in software.
>> Tab is poorly supported in some text editors.
>> Comma is heavy used in number values in european countries.
>> What delimiter do you prefer and why?
>>
>
> Comma because it’s a well known default for most software. I agree semicolon is support almost as well. I see your european issue.
>
>>> We also advertise the geometry datatype (useful for software quickly
>>> reading the data field metadata), field lengths/widths in the VRT,
>>
>> That's covered by CSVT, isn't it?
>
> Specification wasn’t clear and mentioned it could be supported. Looking at the actual OGR implementation is seems field width/lengths are supported (!), but still not the definition of the geometry field and type.
>
>>
>>> and have datasets with legitimate carriage returns within fields.
>>
>> Allowing non-printable control-characters in strings makes it very
>> complicated and disables mainly all existing CSV software.
>
> Yes but Excel handles it. So does OGR and QGIS Delimited Text Provider. From memory the Microsoft ODBC CSV driver doesn’t - but that’s got lots of issues.
>
>> carriage returns is one of the few undisputed end-of-line things in
>> CSV (besides CR, LF, CR/LF differences).
>> Markup to the rescue.
>> What do you prefer?
>>
>
> Markup can work but then it becomes about the reader being about to turn that markup into real carriage returns again. Mostly a pre-processing script is required first.
>
> Cheers
> Jeremy
>
>
> This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From andrew.bell.ia at gmail.com  Wed Feb 17 05:36:12 2016
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Wed, 17 Feb 2016 07:36:12 -0600
Subject: [gdal-dev] GDALApplyGeoTransform
In-Reply-To: <201602171112.19375.even.rouault@spatialys.com>
References: <CACJ51z0JAzcsEBN5Vv3ek2+NjD=fn_yxVfS=Jgp6ii2KkbkynQ@mail.gmail.com>
 <201602171112.19375.even.rouault@spatialys.com>
Message-ID: <CACJ51z0bY5mU-gT+LG5-6qa3J7r3dTL694s+o_=AC3vfqJ2V5Q@mail.gmail.com>

On Wed, Feb 17, 2016 at 4:12 AM, Even Rouault
<even.rouault at spatialys.com> wrote:
> Le mercredi 17 février 2016 00:23:26, Andrew Bell a écrit :
>> Hi,
>>
>> I'm trying to understand why GDALApplyGeoTransform behaves as it does.
>> I would think that when you use it to transform a raster coordinate to
>> a geo coordinate, it would apply what is known about the raster and
>> the transformation to get the correct location.  What I see happening
>> is some drivers is an adjustment to "center" the points in the middle
>> of a raster cell.  This is fine, but I don't understand why
>> GDALApplyGeoTransform doesn't do this if this is always the proper
>> operation.
>
> GDALApplyGeoTransform() doesn't do this, as adjusting to pixel center or pixel
> top-left corner depends on the convention of each driver (and for some drivers
> like GTiff, both conventions can exist depending on datasets), so the logic is
> in driver code.

But given a GDAL raster and it's associated SRS/transformation matrix,
how do I know if the 1/2 pixel offset should be applied to arrive at
the proper geolocation?  Do rasters internally to GDAL always follow
one or the other of PixelIsArea or PixelIsPoint?

Thanks,

-- 
Andrew Bell
andrew.bell.ia at gmail.com

From jonathan-lists at lightpear.com  Wed Feb 17 05:51:35 2016
From: jonathan-lists at lightpear.com (Jonathan Moules)
Date: Wed, 17 Feb 2016 13:51:35 +0000
Subject: [gdal-dev] Verbose mode in GDAL
Message-ID: <152ef801809.11de59e4115205.2325161708615978546@lightpear.com>

Hi List,
I'm running the following four queries against the same data (a packbits compressed geotiff):

    gdaladdo -r average --config COMPRESS_OVERVIEW JPEG --config PHOTOMETRIC_OVERVIEW YCBCR i1.tif 2 4 8 16

    gdaladdo -r average --config PHOTOMETRIC_OVERVIEW YCBCR i2.tif 2 4 8 16

    gdaladdo -r average i3.tif 2 4 8 16

    gdaladdo -r average --config COMPRESS_OVERVIEW PACKBITS i4.tif 2 4 8 16

All four outputs are binary identical and contain the requested internal overviews.

I can think of several possible reasons for this outcome (different compression type seems most probable), but invisibly failing to action semantically valid flags isn't good for raising or debugging errors. Does GDAL have a "verbose" mode? I can't seem to find one.

Cheers,
Jonathan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/07f29c0a/attachment-0001.html>

From sfkeller at gmail.com  Wed Feb 17 06:41:16 2016
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 17 Feb 2016 15:41:16 +0100
Subject: [gdal-dev] [OSGeo-Standards] CSV spatial data on the web
In-Reply-To: <9D8FF5F6-F8BF-4511-B6C2-E7EB6304F4F3@bogosoft.com>
References: <56492AEE-0173-4EA4-BA48-F9B42C17DBDC@linz.govt.nz>
 <CAFcOn28iZ6wtc7BLmUGBphw6XsswNGL3aJDQxFEPVPiC8XLiQw@mail.gmail.com>
 <F1110CA2-513A-416A-B46D-F5469121E47F@linz.govt.nz>
 <CAFcOn2_Bc=WzoEvwq6c-kX+7mUwWPowoiCA2Af3SjKc_W3pTZg@mail.gmail.com>
 <36DF4CF2-802F-4579-961C-B52E6786B79A@linz.govt.nz>
 <CAFcOn2_7TJ=07tKPEq_2TSNxOsUwEAzLbQwRe28Eg4iJYJOiUw@mail.gmail.com>
 <9D8FF5F6-F8BF-4511-B6C2-E7EB6304F4F3@bogosoft.com>
Message-ID: <CAFcOn29FGP68kR-PByNmPPZok1WGgd8XiLMJk0KNoe_EKWuang@mail.gmail.com>

2016-02-17 14:02 GMT+01:00 Oliver Tonnhofer <olt at bogosoft.com>:
> RFC4180 allows newlines as long as they are inside of double quotes. This is at least supported by the Python and Go standard libraries, not sure how other software handles this.

Thanks, Oliver. That's correct.
I have to be more specific:
The ABNF of RFC4180 says:

escaped = DQUOTE *(TEXTDATA / COMMA / CR / LF / 2DQUOTE) DQUOTE

:Stefan

2016-02-17 14:02 GMT+01:00 Oliver Tonnhofer <olt at bogosoft.com>:
> Hi Stefan,
>
>
>> On 17.02.2016, at 13:53, Stefan Keller <sfkeller at gmail.com> wrote:
>>
>> 2016-02-17 11:48 GMT+01:00 Jeremy Palmer <JPalmer at linz.govt.nz>:
>>>> Allowing non-printable control-characters in strings makes it very
>>>> complicated and disables mainly all existing CSV software.
>>>
>>> Yes but Excel handles it. So does OGR and QGIS Delimited Text Provider.
>>> From memory the Microsoft ODBC CSV driver doesn’t - but that’s got lots of issues.
>>
>> No, it does'nt handle linebreaks as one record - nor is this allowed
>> in any of the CSV standardization approaches I know.
>
> RFC4180 allows newlines as long as they are inside of double quotes. This is at least supported by the Python and Go standard libraries, not sure how other software handles this.
>
>
>
> Regards,
> Oliver

From William.Kelly.Magee at leidos.com  Wed Feb 17 07:29:16 2016
From: William.Kelly.Magee at leidos.com (William Kelly Magee)
Date: Wed, 17 Feb 2016 10:29:16 -0500
Subject: [gdal-dev] Windows10 & RHEL7
Message-ID: <56C491CC.6040101@leidos.com>

Hi,

We are currently using gdal-1.11.1 on both Windows7 and RHEL6 and are 
looking to upgrade to Windows10 and RHEL7 in the upcoming months.  Are 
there any known issues with using gdal-1.11.1 on Win10 and RHEL7 or do 
we need to upgrade to the latest gdal stable release (2.0.x)?  I've 
deferred upgrading to gdal 2.0.x until now as we are using a number of 
class methods that have been deprecated in gdal-2.0.1.

Appreciate the help,

Best regards,

- Kelly


-- 


*William Kelly Magee | Leidos*

*Senior Software Engineer | Maritime Solutions Division*

phone: 401.847.4210
_<mailto:william.kelly.magee at leidos.com>__william.kelly.magee at leidos.com 
<mailto:william.kelly.magee at leidos.com>_ | _leidos.com/natsec 
<http://www.leidos.com/natsec>_


This email and any attachments to it are intended only for the 
identified recipients. It may contain proprietary or otherwise legally 
protect ed information of Leidos. Any unauthorized use or disclosure of 
this communication is strictly prohibited. If you have received this 
communic ation in error, please notify the sender and delete or 
otherwise destroy the email and all attachments immediately.



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/f983e752/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: kmagee-signature_html_2d3ec5e1.gif
Type: image/gif
Size: 3947 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/f983e752/attachment.gif>

From robert.coup at koordinates.com  Wed Feb 17 07:52:09 2016
From: robert.coup at koordinates.com (Robert Coup)
Date: Wed, 17 Feb 2016 15:52:09 +0000
Subject: [gdal-dev] Verbose mode in GDAL
In-Reply-To: <152ef801809.11de59e4115205.2325161708615978546@lightpear.com>
References: <152ef801809.11de59e4115205.2325161708615978546@lightpear.com>
Message-ID: <CAFLLRpJgr0oq0gXfyhO0FAumK74iDP7McmoCNKVSR6jTD8AthQ@mail.gmail.com>

Hi Jonathan,

You can try setting CPL_DEBUG=ON as a config option (see
https://trac.osgeo.org/gdal/wiki/ConfigOptions). Some specific
formats/drivers also have additional debug settings, but not GeoTIFF.

Rob :)

On 17 February 2016 at 13:51, Jonathan Moules <jonathan-lists at lightpear.com>
wrote:

> Hi List,
> I'm running the following four queries against the same data (a packbits
> compressed geotiff):
>
>     gdaladdo -r average --config COMPRESS_OVERVIEW JPEG --config
> PHOTOMETRIC_OVERVIEW YCBCR i1.tif 2 4 8 16
>
>     gdaladdo -r average --config PHOTOMETRIC_OVERVIEW YCBCR i2.tif 2 4 8 16
>
>     gdaladdo -r average i3.tif 2 4 8 16
>
>     gdaladdo -r average --config COMPRESS_OVERVIEW PACKBITS i4.tif 2 4 8 16
>
> All four outputs are binary identical and contain the requested internal
> overviews.
>
> I can think of several possible reasons for this outcome (different
> compression type seems most probable), but invisibly failing to action
> semantically valid flags isn't good for raising or debugging errors. Does
> GDAL have a "verbose" mode? I can't seem to find one.
>
> Cheers,
> Jonathan
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 

Chief Technical Officer Koordinates

+44 759 987 3480 <+44%20759%209873480> / koordinates.com / @koordinates
<https://twitter.com/koordinates>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160217/8c821294/attachment.html>

From jonvwill at verizon.net  Wed Feb 17 07:38:30 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Wed, 17 Feb 2016 10:38:30 -0500
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <3ED562F633B1AE46BF141E903F9813078AE5D107@ap-mbx3.ingrnet.com>
References: <56C38BB7.3030207@verizon.net>
 <3ED562F633B1AE46BF141E903F9813078AE5D107@ap-mbx3.ingrnet.com>
Message-ID: <56C493F6.2020008@verizon.net>

I have tried this; I've added the Ubuntu-GIS repository, but none of the
builds are for 64 bit 14.04 LTS, from what I've seen.

I've also tried to force the issue with the instructions here:
http://gis.stackexchange.com/a/102088

However, the build fails, perhaps because I'm using version 5.2.1 of
ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
2.0.2? the compile messages indicate a couple of errors.


/usr/local/include/gdal_priv.h:226:19: error: ‘char**
GDALOpenInfo::papszSiblingFiles’ is private
     char        **papszSiblingFiles;
                   ^
ecwdataset.cpp:2526:48: error: within this context
                                    poOpenInfo->papszSiblingFiles, NULL );
                                                ^
make: *** [ecwdataset.o] Error 1

...as well as...

ecwdataset.cpp:440:91: error: no matching function for call to
‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’


Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
concerned some of the other dependencies might regress work that I'd
done with compiling Jasper, etc.

Best,
Jonathan


On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
> HI Jonathan, 
> Have you tried compiling in  ECW/JP2 support as a plugin?
> Regards.
> Jacek Tomaka
>
> -----Original Message-----
> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jonathan Williams
> Sent: Wednesday, 17 February 2016 4:51 AM
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
>
> Hello,
> In addition to my previous question regarding OpenCL support bafflement, I've run into difficulty compiling GDAL 2.02 with ECW support.
>
> I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is located there, and symlinked the /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to /usr/local/lib/libNCSEcw.so .
>
> Configuration completes with no errors, as does compilation. The ./configure output indicates that support is selected, and config.log says all libraries were found.
>
> However, the completed utilities do not list ecw as a readable format, and indeed, they cannot read ecw files (much less jpeg2000 ones).
>
> I understand there have been libgdal-ecw scripts that some have run to enable support; however, I haven't found one for this situation (Ubuntu desktop 14.04.3 LTS 64 bit, with gdal 2.02).
>
> Is it the case that these scripts also need to be run to enable ecw support? or am I foolishly missing something?
>
> I see in the config.log that -ECW_FLAGS are set to '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library had been selected; however, manually modifying the flag "DX86" to "DX64"
> simply produced an error.
>
> Any insight would be appreciated.
>
> Best regards,
> Jonathan Williams
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Wed Feb 17 08:47:12 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Feb 2016 17:47:12 +0100
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <56C493F6.2020008@verizon.net>
References: <56C38BB7.3030207@verizon.net>
 <3ED562F633B1AE46BF141E903F9813078AE5D107@ap-mbx3.ingrnet.com>
 <56C493F6.2020008@verizon.net>
Message-ID: <201602171747.12714.even.rouault@spatialys.com>

Le mercredi 17 février 2016 16:38:30, Jonathan Williams a écrit :
> I have tried this; I've added the Ubuntu-GIS repository, but none of the
> builds are for 64 bit 14.04 LTS, from what I've seen.
> 
> I've also tried to force the issue with the instructions here:
> http://gis.stackexchange.com/a/102088
> 
> However, the build fails, perhaps because I'm using version 5.2.1 of
> ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
> 2.0.2? the compile messages indicate a couple of errors.
> 
> 
> /usr/local/include/gdal_priv.h:226:19: error: ‘char**
> GDALOpenInfo::papszSiblingFiles’ is private
>      char        **papszSiblingFiles;
>                    ^
> ecwdataset.cpp:2526:48: error: within this context
>                                     poOpenInfo->papszSiblingFiles, NULL );
>                                                 ^
> make: *** [ecwdataset.o] Error 1
> 
> ...as well as...
> 
> ecwdataset.cpp:440:91: error: no matching function for call to
> ‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’

My bet is that you are building the ECW driver code from GDAL 1.X against GDAL 
2.X headers.

> 
> 
> Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
> concerned some of the other dependencies might regress work that I'd
> done with compiling Jasper, etc.
> 
> Best,
> Jonathan
> 
> On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
> > HI Jonathan,
> > Have you tried compiling in  ECW/JP2 support as a plugin?
> > Regards.
> > Jacek Tomaka
> > 
> > -----Original Message-----
> > From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
> > Jonathan Williams Sent: Wednesday, 17 February 2016 4:51 AM
> > To: gdal-dev at lists.osgeo.org
> > Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
> > 
> > Hello,
> > In addition to my previous question regarding OpenCL support bafflement,
> > I've run into difficulty compiling GDAL 2.02 with ECW support.
> > 
> > I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
> > located there, and symlinked the
> > /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
> > /usr/local/lib/libNCSEcw.so .
> > 
> > Configuration completes with no errors, as does compilation. The
> > ./configure output indicates that support is selected, and config.log
> > says all libraries were found.
> > 
> > However, the completed utilities do not list ecw as a readable format,
> > and indeed, they cannot read ecw files (much less jpeg2000 ones).
> > 
> > I understand there have been libgdal-ecw scripts that some have run to
> > enable support; however, I haven't found one for this situation (Ubuntu
> > desktop 14.04.3 LTS 64 bit, with gdal 2.02).
> > 
> > Is it the case that these scripts also need to be run to enable ecw
> > support? or am I foolishly missing something?
> > 
> > I see in the config.log that -ECW_FLAGS are set to
> > '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
> > -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library had
> > been selected; however, manually modifying the flag "DX86" to "DX64"
> > simply produced an error.
> > 
> > Any insight would be appreciated.
> > 
> > Best regards,
> > Jonathan Williams
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jonvwill at verizon.net  Wed Feb 17 09:13:02 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Wed, 17 Feb 2016 12:13:02 -0500
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <201602171747.12714.even.rouault@spatialys.com>
References: <56C38BB7.3030207@verizon.net>
 <3ED562F633B1AE46BF141E903F9813078AE5D107@ap-mbx3.ingrnet.com>
 <56C493F6.2020008@verizon.net> <201602171747.12714.even.rouault@spatialys.com>
Message-ID: <56C4AA1E.6070003@verizon.net>

That's exactly correct, for the plugin attempt. I tried it just to see
if it would get anywhere, as I couldn't find a plugin build script that
supported GDAL >2.0.

As for trying to build the ecw/jp2ecw support into GDAL 2.0.2 itself,
I've now tried the old libecwj2 3.3 code in lieu of the SDK 5.2.1
libraries; as usual, it configures and compiles without complaint, but
the ecw support is simply absent in the final product.

I'd like to use some of the GDAL >2.0 features, but if I'm not able to
get ecw and OpenCL working, I may drop back to the <2.0 series to see if
that helps.

Best,
Jonathan

On 2/17/2016 11:47 AM, Even Rouault wrote:
> Le mercredi 17 février 2016 16:38:30, Jonathan Williams a écrit :
>> I have tried this; I've added the Ubuntu-GIS repository, but none of the
>> builds are for 64 bit 14.04 LTS, from what I've seen.
>>
>> I've also tried to force the issue with the instructions here:
>> http://gis.stackexchange.com/a/102088
>>
>> However, the build fails, perhaps because I'm using version 5.2.1 of
>> ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
>> 2.0.2? the compile messages indicate a couple of errors.
>>
>>
>> /usr/local/include/gdal_priv.h:226:19: error: ‘char**
>> GDALOpenInfo::papszSiblingFiles’ is private
>>      char        **papszSiblingFiles;
>>                    ^
>> ecwdataset.cpp:2526:48: error: within this context
>>                                     poOpenInfo->papszSiblingFiles, NULL );
>>                                                 ^
>> make: *** [ecwdataset.o] Error 1
>>
>> ...as well as...
>>
>> ecwdataset.cpp:440:91: error: no matching function for call to
>> ‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’
> My bet is that you are building the ECW driver code from GDAL 1.X against GDAL 
> 2.X headers.
>
>>
>> Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
>> concerned some of the other dependencies might regress work that I'd
>> done with compiling Jasper, etc.
>>
>> Best,
>> Jonathan
>>
>> On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
>>> HI Jonathan,
>>> Have you tried compiling in  ECW/JP2 support as a plugin?
>>> Regards.
>>> Jacek Tomaka
>>>
>>> -----Original Message-----
>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>> Jonathan Williams Sent: Wednesday, 17 February 2016 4:51 AM
>>> To: gdal-dev at lists.osgeo.org
>>> Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
>>>
>>> Hello,
>>> In addition to my previous question regarding OpenCL support bafflement,
>>> I've run into difficulty compiling GDAL 2.02 with ECW support.
>>>
>>> I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
>>> located there, and symlinked the
>>> /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
>>> /usr/local/lib/libNCSEcw.so .
>>>
>>> Configuration completes with no errors, as does compilation. The
>>> ./configure output indicates that support is selected, and config.log
>>> says all libraries were found.
>>>
>>> However, the completed utilities do not list ecw as a readable format,
>>> and indeed, they cannot read ecw files (much less jpeg2000 ones).
>>>
>>> I understand there have been libgdal-ecw scripts that some have run to
>>> enable support; however, I haven't found one for this situation (Ubuntu
>>> desktop 14.04.3 LTS 64 bit, with gdal 2.02).
>>>
>>> Is it the case that these scripts also need to be run to enable ecw
>>> support? or am I foolishly missing something?
>>>
>>> I see in the config.log that -ECW_FLAGS are set to
>>> '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
>>> -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library had
>>> been selected; however, manually modifying the flag "DX86" to "DX64"
>>> simply produced an error.
>>>
>>> Any insight would be appreciated.
>>>
>>> Best regards,
>>> Jonathan Williams
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Wed Feb 17 10:20:18 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 17 Feb 2016 19:20:18 +0100
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <56C4AA1E.6070003@verizon.net>
References: <56C38BB7.3030207@verizon.net>
 <201602171747.12714.even.rouault@spatialys.com>
 <56C4AA1E.6070003@verizon.net>
Message-ID: <201602171920.18909.even.rouault@spatialys.com>

Le mercredi 17 février 2016 18:13:02, Jonathan Williams a écrit :
> That's exactly correct, for the plugin attempt. I tried it just to see
> if it would get anywhere, as I couldn't find a plugin build script that
> supported GDAL >2.0.
> 
> As for trying to build the ecw/jp2ecw support into GDAL 2.0.2 itself,
> I've now tried the old libecwj2 3.3 code in lieu of the SDK 5.2.1
> libraries; as usual, it configures and compiles without complaint, but
> the ecw support is simply absent in the final product.

In case you do multiple ./configure attempts, do you do "make clean" after 
running ./configure ? ( "touch frmts/gdalallregister.cpp" should be sufficient 
for just new drivers )

> 
> I'd like to use some of the GDAL >2.0 features, but if I'm not able to
> get ecw and OpenCL working, I may drop back to the <2.0 series to see if
> that helps.
> 
> Best,
> Jonathan
> 
> On 2/17/2016 11:47 AM, Even Rouault wrote:
> > Le mercredi 17 février 2016 16:38:30, Jonathan Williams a écrit :
> >> I have tried this; I've added the Ubuntu-GIS repository, but none of the
> >> builds are for 64 bit 14.04 LTS, from what I've seen.
> >> 
> >> I've also tried to force the issue with the instructions here:
> >> http://gis.stackexchange.com/a/102088
> >> 
> >> However, the build fails, perhaps because I'm using version 5.2.1 of
> >> ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
> >> 2.0.2? the compile messages indicate a couple of errors.
> >> 
> >> 
> >> /usr/local/include/gdal_priv.h:226:19: error: ‘char**
> >> GDALOpenInfo::papszSiblingFiles’ is private
> >> 
> >>      char        **papszSiblingFiles;
> >>      
> >>                    ^
> >> 
> >> ecwdataset.cpp:2526:48: error: within this context
> >> 
> >>                                     poOpenInfo->papszSiblingFiles, NULL
> >>                                     );
> >>                                     
> >>                                                 ^
> >> 
> >> make: *** [ecwdataset.o] Error 1
> >> 
> >> ...as well as...
> >> 
> >> ecwdataset.cpp:440:91: error: no matching function for call to
> >> ‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’
> > 
> > My bet is that you are building the ECW driver code from GDAL 1.X against
> > GDAL 2.X headers.
> > 
> >> Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
> >> concerned some of the other dependencies might regress work that I'd
> >> done with compiling Jasper, etc.
> >> 
> >> Best,
> >> Jonathan
> >> 
> >> On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
> >>> HI Jonathan,
> >>> Have you tried compiling in  ECW/JP2 support as a plugin?
> >>> Regards.
> >>> Jacek Tomaka
> >>> 
> >>> -----Original Message-----
> >>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
> >>> Jonathan Williams Sent: Wednesday, 17 February 2016 4:51 AM
> >>> To: gdal-dev at lists.osgeo.org
> >>> Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
> >>> 
> >>> Hello,
> >>> In addition to my previous question regarding OpenCL support
> >>> bafflement, I've run into difficulty compiling GDAL 2.02 with ECW
> >>> support.
> >>> 
> >>> I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
> >>> located there, and symlinked the
> >>> /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
> >>> /usr/local/lib/libNCSEcw.so .
> >>> 
> >>> Configuration completes with no errors, as does compilation. The
> >>> ./configure output indicates that support is selected, and config.log
> >>> says all libraries were found.
> >>> 
> >>> However, the completed utilities do not list ecw as a readable format,
> >>> and indeed, they cannot read ecw files (much less jpeg2000 ones).
> >>> 
> >>> I understand there have been libgdal-ecw scripts that some have run to
> >>> enable support; however, I haven't found one for this situation (Ubuntu
> >>> desktop 14.04.3 LTS 64 bit, with gdal 2.02).
> >>> 
> >>> Is it the case that these scripts also need to be run to enable ecw
> >>> support? or am I foolishly missing something?
> >>> 
> >>> I see in the config.log that -ECW_FLAGS are set to
> >>> '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
> >>> -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library
> >>> had been selected; however, manually modifying the flag "DX86" to
> >>> "DX64" simply produced an error.
> >>> 
> >>> Any insight would be appreciated.
> >>> 
> >>> Best regards,
> >>> Jonathan Williams
> >>> 
> >>> _______________________________________________
> >>> gdal-dev mailing list
> >>> gdal-dev at lists.osgeo.org
> >>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >> 
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jonvwill at verizon.net  Wed Feb 17 10:41:22 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Wed, 17 Feb 2016 13:41:22 -0500
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <201602171920.18909.even.rouault@spatialys.com>
References: <56C38BB7.3030207@verizon.net>
 <201602171747.12714.even.rouault@spatialys.com> <56C4AA1E.6070003@verizon.net>
 <201602171920.18909.even.rouault@spatialys.com>
Message-ID: <56C4BED2.8060101@verizon.net>

I do, though I'm afraid to admit I may have discovered a simple path
issue with an early compilation run that may have been obscuring
subsequent work.

If that's the case, I'll send my apologies.

Best
Jonathan

On 2/17/2016 1:20 PM, Even Rouault wrote:
> Le mercredi 17 février 2016 18:13:02, Jonathan Williams a écrit :
>> That's exactly correct, for the plugin attempt. I tried it just to see
>> if it would get anywhere, as I couldn't find a plugin build script that
>> supported GDAL >2.0.
>>
>> As for trying to build the ecw/jp2ecw support into GDAL 2.0.2 itself,
>> I've now tried the old libecwj2 3.3 code in lieu of the SDK 5.2.1
>> libraries; as usual, it configures and compiles without complaint, but
>> the ecw support is simply absent in the final product.
> In case you do multiple ./configure attempts, do you do "make clean" after 
> running ./configure ? ( "touch frmts/gdalallregister.cpp" should be sufficient 
> for just new drivers )
>
>> I'd like to use some of the GDAL >2.0 features, but if I'm not able to
>> get ecw and OpenCL working, I may drop back to the <2.0 series to see if
>> that helps.
>>
>> Best,
>> Jonathan
>>
>> On 2/17/2016 11:47 AM, Even Rouault wrote:
>>> Le mercredi 17 février 2016 16:38:30, Jonathan Williams a écrit :
>>>> I have tried this; I've added the Ubuntu-GIS repository, but none of the
>>>> builds are for 64 bit 14.04 LTS, from what I've seen.
>>>>
>>>> I've also tried to force the issue with the instructions here:
>>>> http://gis.stackexchange.com/a/102088
>>>>
>>>> However, the build fails, perhaps because I'm using version 5.2.1 of
>>>> ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
>>>> 2.0.2? the compile messages indicate a couple of errors.
>>>>
>>>>
>>>> /usr/local/include/gdal_priv.h:226:19: error: ‘char**
>>>> GDALOpenInfo::papszSiblingFiles’ is private
>>>>
>>>>      char        **papszSiblingFiles;
>>>>      
>>>>                    ^
>>>>
>>>> ecwdataset.cpp:2526:48: error: within this context
>>>>
>>>>                                     poOpenInfo->papszSiblingFiles, NULL
>>>>                                     );
>>>>                                     
>>>>                                                 ^
>>>>
>>>> make: *** [ecwdataset.o] Error 1
>>>>
>>>> ...as well as...
>>>>
>>>> ecwdataset.cpp:440:91: error: no matching function for call to
>>>> ‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’
>>> My bet is that you are building the ECW driver code from GDAL 1.X against
>>> GDAL 2.X headers.
>>>
>>>> Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
>>>> concerned some of the other dependencies might regress work that I'd
>>>> done with compiling Jasper, etc.
>>>>
>>>> Best,
>>>> Jonathan
>>>>
>>>> On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
>>>>> HI Jonathan,
>>>>> Have you tried compiling in  ECW/JP2 support as a plugin?
>>>>> Regards.
>>>>> Jacek Tomaka
>>>>>
>>>>> -----Original Message-----
>>>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>>>> Jonathan Williams Sent: Wednesday, 17 February 2016 4:51 AM
>>>>> To: gdal-dev at lists.osgeo.org
>>>>> Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
>>>>>
>>>>> Hello,
>>>>> In addition to my previous question regarding OpenCL support
>>>>> bafflement, I've run into difficulty compiling GDAL 2.02 with ECW
>>>>> support.
>>>>>
>>>>> I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
>>>>> located there, and symlinked the
>>>>> /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
>>>>> /usr/local/lib/libNCSEcw.so .
>>>>>
>>>>> Configuration completes with no errors, as does compilation. The
>>>>> ./configure output indicates that support is selected, and config.log
>>>>> says all libraries were found.
>>>>>
>>>>> However, the completed utilities do not list ecw as a readable format,
>>>>> and indeed, they cannot read ecw files (much less jpeg2000 ones).
>>>>>
>>>>> I understand there have been libgdal-ecw scripts that some have run to
>>>>> enable support; however, I haven't found one for this situation (Ubuntu
>>>>> desktop 14.04.3 LTS 64 bit, with gdal 2.02).
>>>>>
>>>>> Is it the case that these scripts also need to be run to enable ecw
>>>>> support? or am I foolishly missing something?
>>>>>
>>>>> I see in the config.log that -ECW_FLAGS are set to
>>>>> '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
>>>>> -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library
>>>>> had been selected; however, manually modifying the flag "DX86" to
>>>>> "DX64" simply produced an error.
>>>>>
>>>>> Any insight would be appreciated.
>>>>>
>>>>> Best regards,
>>>>> Jonathan Williams
>>>>>
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jonvwill at verizon.net  Wed Feb 17 11:21:28 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Wed, 17 Feb 2016 14:21:28 -0500
Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
In-Reply-To: <56C4BED2.8060101@verizon.net>
References: <56C38BB7.3030207@verizon.net>
 <201602171747.12714.even.rouault@spatialys.com> <56C4AA1E.6070003@verizon.net>
 <201602171920.18909.even.rouault@spatialys.com> <56C4BED2.8060101@verizon.net>
Message-ID: <56C4C838.7010301@verizon.net>

Indeed, my work fell victim to a path error. My apologies, all. I have
ECW support working for SDK 5.2.1 and Gdal 2.0.2.

Hopefully, the OpenCL issue is similar.

Best,
Jonathan

On 2/17/2016 1:41 PM, Jonathan Williams wrote:
> I do, though I'm afraid to admit I may have discovered a simple path
> issue with an early compilation run that may have been obscuring
> subsequent work.
>
> If that's the case, I'll send my apologies.
>
> Best
> Jonathan
>
> On 2/17/2016 1:20 PM, Even Rouault wrote:
>> Le mercredi 17 février 2016 18:13:02, Jonathan Williams a écrit :
>>> That's exactly correct, for the plugin attempt. I tried it just to see
>>> if it would get anywhere, as I couldn't find a plugin build script that
>>> supported GDAL >2.0.
>>>
>>> As for trying to build the ecw/jp2ecw support into GDAL 2.0.2 itself,
>>> I've now tried the old libecwj2 3.3 code in lieu of the SDK 5.2.1
>>> libraries; as usual, it configures and compiles without complaint, but
>>> the ecw support is simply absent in the final product.
>> In case you do multiple ./configure attempts, do you do "make clean" after 
>> running ./configure ? ( "touch frmts/gdalallregister.cpp" should be sufficient 
>> for just new drivers )
>>
>>> I'd like to use some of the GDAL >2.0 features, but if I'm not able to
>>> get ecw and OpenCL working, I may drop back to the <2.0 series to see if
>>> that helps.
>>>
>>> Best,
>>> Jonathan
>>>
>>> On 2/17/2016 11:47 AM, Even Rouault wrote:
>>>> Le mercredi 17 février 2016 16:38:30, Jonathan Williams a écrit :
>>>>> I have tried this; I've added the Ubuntu-GIS repository, but none of the
>>>>> builds are for 64 bit 14.04 LTS, from what I've seen.
>>>>>
>>>>> I've also tried to force the issue with the instructions here:
>>>>> http://gis.stackexchange.com/a/102088
>>>>>
>>>>> However, the build fails, perhaps because I'm using version 5.2.1 of
>>>>> ERDAS' SDK with libNCSEcw.so.5.2.1, or perhaps because I'm using Gdal
>>>>> 2.0.2? the compile messages indicate a couple of errors.
>>>>>
>>>>>
>>>>> /usr/local/include/gdal_priv.h:226:19: error: ‘char**
>>>>> GDALOpenInfo::papszSiblingFiles’ is private
>>>>>
>>>>>      char        **papszSiblingFiles;
>>>>>      
>>>>>                    ^
>>>>>
>>>>> ecwdataset.cpp:2526:48: error: within this context
>>>>>
>>>>>                                     poOpenInfo->papszSiblingFiles, NULL
>>>>>                                     );
>>>>>                                     
>>>>>                                                 ^
>>>>>
>>>>> make: *** [ecwdataset.o] Error 1
>>>>>
>>>>> ...as well as...
>>>>>
>>>>> ecwdataset.cpp:440:91: error: no matching function for call to
>>>>> ‘ECWRasterBand::SetDefaultHistogram(double&, double&, int&, int*&)’
>>>> My bet is that you are building the ECW driver code from GDAL 1.X against
>>>> GDAL 2.X headers.
>>>>
>>>>> Note that I did *not* attempt to install QGIS or libgdal-dev, as I was
>>>>> concerned some of the other dependencies might regress work that I'd
>>>>> done with compiling Jasper, etc.
>>>>>
>>>>> Best,
>>>>> Jonathan
>>>>>
>>>>> On 2/17/2016 12:26 AM, Tomaka, Jacek wrote:
>>>>>> HI Jonathan,
>>>>>> Have you tried compiling in  ECW/JP2 support as a plugin?
>>>>>> Regards.
>>>>>> Jacek Tomaka
>>>>>>
>>>>>> -----Original Message-----
>>>>>> From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of
>>>>>> Jonathan Williams Sent: Wednesday, 17 February 2016 4:51 AM
>>>>>> To: gdal-dev at lists.osgeo.org
>>>>>> Subject: [gdal-dev] Compiling with ECW/JP2ECW support enabled
>>>>>>
>>>>>> Hello,
>>>>>> In addition to my previous question regarding OpenCL support
>>>>>> bafflement, I've run into difficulty compiling GDAL 2.02 with ECW
>>>>>> support.
>>>>>>
>>>>>> I've compiled with "--with-ecw=/usr/local/hexagon", as the 5.2 SDK is
>>>>>> located there, and symlinked the
>>>>>> /usr/local/hexagon/lib/(x64|x86)/release/libNCSEcw.so library to
>>>>>> /usr/local/lib/libNCSEcw.so .
>>>>>>
>>>>>> Configuration completes with no errors, as does compilation. The
>>>>>> ./configure output indicates that support is selected, and config.log
>>>>>> says all libraries were found.
>>>>>>
>>>>>> However, the completed utilities do not list ecw as a readable format,
>>>>>> and indeed, they cannot read ecw files (much less jpeg2000 ones).
>>>>>>
>>>>>> I understand there have been libgdal-ecw scripts that some have run to
>>>>>> enable support; however, I haven't found one for this situation (Ubuntu
>>>>>> desktop 14.04.3 LTS 64 bit, with gdal 2.02).
>>>>>>
>>>>>> Is it the case that these scripts also need to be run to enable ecw
>>>>>> support? or am I foolishly missing something?
>>>>>>
>>>>>> I see in the config.log that -ECW_FLAGS are set to
>>>>>> '-DHAVE_ECW_BUILDNUMBER_H -DLINUX -DX86 -DPOSIX -DHAVE_COMPRESS
>>>>>> -DECW_COMPRESS_RW_SDK_VERSION', and thought perhaps a 32 bit library
>>>>>> had been selected; however, manually modifying the flag "DX86" to
>>>>>> "DX64" simply produced an error.
>>>>>>
>>>>>> Any insight would be appreciated.
>>>>>>
>>>>>> Best regards,
>>>>>> Jonathan Williams
>>>>>>
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>> _______________________________________________
>>>>> gdal-dev mailing list
>>>>> gdal-dev at lists.osgeo.org
>>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From gane.prog at gmail.com  Thu Feb 18 04:09:05 2016
From: gane.prog at gmail.com (Gane R)
Date: Thu, 18 Feb 2016 17:39:05 +0530
Subject: [gdal-dev] Get EPSG code from WKT
Message-ID: <CALMrLdCqZ-_pwcLmO74UsnewbQ1jV-DbfkOHPR69Hg0in4iKFQ@mail.gmail.com>

When I try to convert to different projection using the gdalwarp
*without *specifying
the* -s_srs option* it reprojects to a *different location*, for some
raster it projects to a correct location.

But when try to run gdalinfo and I see a lot of EPSG code, when I use the
last AUTHORITY EPSG code as -s_srs option the above mention problem is
solved.

Is it that I have use the last AUTHORITY EPSG code or any thing will help

Expecting your suggestion

Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160218/30844078/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Feb 18 05:48:30 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Thu, 18 Feb 2016 13:48:30 +0000 (UTC)
Subject: [gdal-dev] Get EPSG code from WKT
References: <CALMrLdCqZ-_pwcLmO74UsnewbQ1jV-DbfkOHPR69Hg0in4iKFQ@mail.gmail.com>
Message-ID: <loom.20160218T144721-299@post.gmane.org>

Gane R <gane.prog <at> gmail.com> writes:


> When I try to convert to different projection using the gdalwarp without
specifying the -s_srs option it reprojects to a different location, for some
raster it projects to a correct location.
> 
> But when try to run gdalinfo and I see a lot of EPSG code, when I use the
last AUTHORITY EPSG code as -s_srs option the above mention problem is solved.
> 
> Is it that I have use the last AUTHORITY EPSG code or any thing will help
> 
> Expecting your suggestion

Expecting some sample data that could be used for reproducing the problem.

-Jukka Rahkonen-


From dwelch at urthecast.com  Thu Feb 18 07:44:27 2016
From: dwelch at urthecast.com (Dave Welch)
Date: Thu, 18 Feb 2016 15:44:27 +0000
Subject: [gdal-dev] Mask value data type in Python wrappings
Message-ID: <F7A15A73-1953-419A-AD62-66443BC65C18@urthecast.com>

Hi all,

I’m trying to mask a band from a GeoTiff file like so:

>>> from osgeo import gdal, ogr, osr
>>> from gdalconst import *
>>> import numpy as np
>>> import matplotlib as mpl
>>> dataset = gdal.Open('001.tif')
>>> band = dataset.GetRasterBand(1)
>>> ba = band.ReadAsArray()

>>> print "Origin:", ba[0, 0], type(ba[0, 0])  # NODATA value in image == zero

Origin: 0 <type 'numpy.uint16'>

>>> print "(5, 5):", ba[5, 5], type(ba[5, 5])

(5, 5): 42271 <type 'numpy.uint16'>

>>> print "Nodata:", band.GetNoDataValue()     # NODATA from file == None

Nodata: None

>>> print "Mask flags:", band.GetMaskFlags()

Mask flags: 1


>>> band.SetNoDataValue(0)                     # Set the NODATA value to zero
>>> print "Nodata:", band.GetNoDataValue(), type(band.GetNoDataValue())

Nodata: 0.0 <type 'float’>


>>> mb = band.GetMaskBand()
>>> ma = mb.ReadAsArray()


>>> print "Origin:", ma[0, 0], type(ma[0, 0])  # *** SHOULD BE ZERO!!! ***


Origin: 255 <type 'numpy.uint8'>


>>> print "(5, 5):", ma[5, 5], type(ma[5, 5])  # Correct

(5, 5): 255 <type 'numpy.uint8'>


>>> print np.any(ma==0)                        # Mask band is entirely 255

False

As you can see, the mask covers the entire image and not the zeros on the edge.

The band.GetNoDataValue() is returning a Python float() which leads me to suspect that there is incorrect type handling within GDAL’s Python wrapping such that the mask generation is trying to compare the band’s raster values (GDAL_UInt16) to whatever the NoDataValue type is stored internally.  Am I way off base or is there something I’m missing?

Cheers!
______________________________________________
Dave Welch Software Engineer
URTHECAST

111 West Port Plaza Suite 300  l  St. Louis, MO l USA l 63146

urthecast.com<http://www.urthecast.com/>  l  Connect @urthecast<https://twitter.com/urthecast>

This e-mail and any attachments are for the use of the intended recipient(s) and may contain legally privileged, proprietary and/or confidential information.
Any use or disclosure of this e-mail (including attachments) for any purpose other than those specifically authorized is prohibited.
If you are not the intended recipient, please immediately notify the sender and permanently delete all copies.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160218/233037ec/attachment-0001.html>

From jonvwill at verizon.net  Thu Feb 18 07:10:34 2016
From: jonvwill at verizon.net (Jonathan Williams)
Date: Thu, 18 Feb 2016 10:10:34 -0500
Subject: [gdal-dev] GDAL using Nvidia - won't use OpenCL
In-Reply-To: <56C21B9E.7050400@verizon.net>
References: <56C21B9E.7050400@verizon.net>
Message-ID: <56C5DEEA.5060901@verizon.net>

OK, I've solved this one, too, but it took a bit more hunting and
inserting of debug messages...

The issue in this case was the data.  I was using weather data in .grib2
files, which comes in Float64 format. Digging into the
gdalwarpkernel.cpp code, I see it is explicitly designed to only use up
to Float32 with OpenCL. After running the file through GDAL_Translate
first, it now makes use of OpenCL.

By any chance, does anyone know whether current GPU's, with current
OpenCL code, can handle double-precision floating point?  I thought that
was the case.

Anyway, OpenCL problem solved, and with the expected significant speedup.

Best,
Jonathan

On 2/15/2016 1:40 PM, Jonathan Williams wrote:
> Hello,
> I've been trying to compile GDAL with OpenCL support for an Nvidia
> gt555m (this is an Alienware m14x r1 laptop) on Ubuntu desktop (I wanted
> to run it headless, but Ubuntu server failed to boot with the Nvidia
> drivers and without X installed).
>
> Per the instructions at various sites, including here:
> https://wiki.tiker.net/OpenCLHowTo , I installed Ubuntu packages
> nvidia-346, nvidia-346-uvm, nvidia-libopencl1-346 and
> nvidia-opencl-icd-346. Other combinations seemed to fail, including
> adding nvidia-opencl-dev, and more recent Ubuntu Nvidia driver versions
> didn't include the uvm package (I think the current driver is the 361
> series).
>
> So, after installing these packages and making sure everything was in
> order in /etc/OpenCL/vendors, I verified OpenCL was functional using
> test packages like MandelGPU/MandelCPU. The OpenCL speedup was obvious
> using these tests.
>
> After a lot of trial-and-error compilations, this is my configuration
> for GDAL with OpenCL:
>
> ./configure \
> --prefix=/usr \
> --disable-rpath \
> --with-threads=yes \
> --with-ogr \
> --with-geos \
> --without-libtool \
> --with-libz=internal \
> --with-libtiff=internal \
> --with-geotiff=internal \
> --with-pg=/usr/bin/pg_config \
> --with-expat-lib=/usr/lib/x86_64-linux-gnu/libexpat.so \
> --with-netcdf=/usr/lib \
> --with-png=internal \
> --with-jpeg=internal \
> --with-gif=internal \
> --without-kakadu \
> --without-mrsid \
> --without-jp2mrsid \
> --with-liblzma=yes \
> --with-curl=/usr/lib/x86_64-linux-gnu \
> --with-ecw=/usr/local/hexagon \
> --with-python=yes \
> --with-hide-internal-symbols \
> --with-jasper=/usr/local \
> --with-openjpeg=/usr/local \
> --with-opencl=yes \
> --with-opencl-include=/usr/include \
> --with-opencl-lib="-L/usr/lib/x86_64-linux-gnu -lOpenCL"
>
> While I did get a couple of errors with this, they seem unrelated to
> anything important (complaining of a zero-length gnu_printf format
> string, ./config.rpath not existing, and GDALmake.opt.in ignoring the
> --datarootdir setting), and a look at the output indicates OpenCL
> support is selected.
>
> Compilation itself completes with no obvious errors, and the resulting
> functions run correctly. However, there is no speedup from using -wo
> "USE_OPENCL=TRUE" over -wo "USE_OPENCL=FALSE", nor is there any effect
> seen using nvidia-smi monitoring.
>
> The GDALWARP command I'm running is this:
> gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
> 0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=TRUE" tmp.grib2 tmp.tif
>
> vs.
>
> gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
> 0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=FALSE" tmp.grib2 tmp.tif
>
>
> This system has four cores and is multithreading, so -wo
> "NUM_THREADS=ALL_CPUS" does produce a speedup. But again, USE_OPENCL
> does not. In fact, the program is entirely functional and does exactly
> what I want, except for opencl functionality.
>
> I'm at a bit of a loss as to what might be wrong. I've tried various
> combinations of the with-opencl flags. I'm running all functions as
> root, and have tried modprobe nvidia-uvm. No errors, no debug problems
> noted, it just won't use the GPU. Part of my problem is I'm not sure
> what problems would produce an error, and what just would fail silently.
>
> Any insight would be appreciated!
>
> Best regards,
> Jonathan Williams
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu Feb 18 08:20:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Feb 2016 17:20:14 +0100
Subject: [gdal-dev] Mask value data type in Python wrappings
In-Reply-To: <F7A15A73-1953-419A-AD62-66443BC65C18@urthecast.com>
References: <F7A15A73-1953-419A-AD62-66443BC65C18@urthecast.com>
Message-ID: <201602181720.14929.even.rouault@spatialys.com>

Dave,

> >>> band.SetNoDataValue(0)                     # Set the NODATA value to
> >>> zero print "Nodata:", band.GetNoDataValue(),
> >>> type(band.GetNoDataValue())
> 
> Nodata: 0.0 <type 'float’>
> 
> >>> mb = band.GetMaskBand()
> >>> ma = mb.ReadAsArray()
> >>> 
> >>> 
> >>> print "Origin:", ma[0, 0], type(ma[0, 0])  # *** SHOULD BE ZERO!!! ***

--> (Implicit) mask bands (such as the one generated for mask flag = 
GMF_ALL_VALID or GMF_NODATA), once fetched a first time, are no longer 
influenced by later actions. Re-opening the file should expose an updated mask 
band.

> 
> Origin: 255 <type 'numpy.uint8'>
> 
> >>> print "(5, 5):", ma[5, 5], type(ma[5, 5])  # Correct
> 
> (5, 5): 255 <type 'numpy.uint8'>
> 
> >>> print np.any(ma==0)                        # Mask band is entirely 255
> 
> False
> 
> As you can see, the mask covers the entire image and not the zeros on the
> edge.
> 
> The band.GetNoDataValue() is returning a Python float()

The C++ method always return a double, whatever the raster data type, hence 
the same for the Python bindings.

> which leads me to
> suspect that there is incorrect type handling within GDAL’s Python
> wrapping such that the mask generation is trying to compare the band’s
> raster values (GDAL_UInt16) to whatever the NoDataValue type is stored
> internally.  

See my first explanation

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Feb 18 08:21:46 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Feb 2016 17:21:46 +0100
Subject: [gdal-dev] GDAL using Nvidia - won't use OpenCL
In-Reply-To: <56C5DEEA.5060901@verizon.net>
References: <56C21B9E.7050400@verizon.net> <56C5DEEA.5060901@verizon.net>
Message-ID: <201602181721.46296.even.rouault@spatialys.com>

Le jeudi 18 février 2016 16:10:34, Jonathan Williams a écrit :
> OK, I've solved this one, too, but it took a bit more hunting and
> inserting of debug messages...
> 
> The issue in this case was the data.  I was using weather data in .grib2
> files, which comes in Float64 format. Digging into the
> gdalwarpkernel.cpp code, I see it is explicitly designed to only use up
> to Float32 with OpenCL. After running the file through GDAL_Translate
> first, it now makes use of OpenCL.

You don't necessarily have to gdal_translate. You could use the -wt Float32 
option of gdalwarp to select the working data type.

> 
> By any chance, does anyone know whether current GPU's, with current
> OpenCL code, can handle double-precision floating point?  I thought that
> was the case.
> 
> Anyway, OpenCL problem solved, and with the expected significant speedup.
> 
> Best,
> Jonathan
> 
> On 2/15/2016 1:40 PM, Jonathan Williams wrote:
> > Hello,
> > I've been trying to compile GDAL with OpenCL support for an Nvidia
> > gt555m (this is an Alienware m14x r1 laptop) on Ubuntu desktop (I wanted
> > to run it headless, but Ubuntu server failed to boot with the Nvidia
> > drivers and without X installed).
> > 
> > Per the instructions at various sites, including here:
> > https://wiki.tiker.net/OpenCLHowTo , I installed Ubuntu packages
> > nvidia-346, nvidia-346-uvm, nvidia-libopencl1-346 and
> > nvidia-opencl-icd-346. Other combinations seemed to fail, including
> > adding nvidia-opencl-dev, and more recent Ubuntu Nvidia driver versions
> > didn't include the uvm package (I think the current driver is the 361
> > series).
> > 
> > So, after installing these packages and making sure everything was in
> > order in /etc/OpenCL/vendors, I verified OpenCL was functional using
> > test packages like MandelGPU/MandelCPU. The OpenCL speedup was obvious
> > using these tests.
> > 
> > After a lot of trial-and-error compilations, this is my configuration
> > for GDAL with OpenCL:
> > 
> > ./configure \
> > --prefix=/usr \
> > --disable-rpath \
> > --with-threads=yes \
> > --with-ogr \
> > --with-geos \
> > --without-libtool \
> > --with-libz=internal \
> > --with-libtiff=internal \
> > --with-geotiff=internal \
> > --with-pg=/usr/bin/pg_config \
> > --with-expat-lib=/usr/lib/x86_64-linux-gnu/libexpat.so \
> > --with-netcdf=/usr/lib \
> > --with-png=internal \
> > --with-jpeg=internal \
> > --with-gif=internal \
> > --without-kakadu \
> > --without-mrsid \
> > --without-jp2mrsid \
> > --with-liblzma=yes \
> > --with-curl=/usr/lib/x86_64-linux-gnu \
> > --with-ecw=/usr/local/hexagon \
> > --with-python=yes \
> > --with-hide-internal-symbols \
> > --with-jasper=/usr/local \
> > --with-openjpeg=/usr/local \
> > --with-opencl=yes \
> > --with-opencl-include=/usr/include \
> > --with-opencl-lib="-L/usr/lib/x86_64-linux-gnu -lOpenCL"
> > 
> > While I did get a couple of errors with this, they seem unrelated to
> > anything important (complaining of a zero-length gnu_printf format
> > string, ./config.rpath not existing, and GDALmake.opt.in ignoring the
> > --datarootdir setting), and a look at the output indicates OpenCL
> > support is selected.
> > 
> > Compilation itself completes with no obvious errors, and the resulting
> > functions run correctly. However, there is no speedup from using -wo
> > "USE_OPENCL=TRUE" over -wo "USE_OPENCL=FALSE", nor is there any effect
> > seen using nvidia-smi monitoring.
> > 
> > The GDALWARP command I'm running is this:
> > gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
> > 0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=TRUE" tmp.grib2 tmp.tif
> > 
> > vs.
> > 
> > gdalwarp -srcnodata 9999 -dstnodata 9999 -t_srs EPSG:4326 -of GTiff -tr
> > 0.03 0.03 -r cubicspline -multi -wo "USE_OPENCL=FALSE" tmp.grib2 tmp.tif
> > 
> > 
> > This system has four cores and is multithreading, so -wo
> > "NUM_THREADS=ALL_CPUS" does produce a speedup. But again, USE_OPENCL
> > does not. In fact, the program is entirely functional and does exactly
> > what I want, except for opencl functionality.
> > 
> > I'm at a bit of a loss as to what might be wrong. I've tried various
> > combinations of the with-opencl flags. I'm running all functions as
> > root, and have tried modprobe nvidia-uvm. No errors, no debug problems
> > noted, it just won't use the GPU. Part of my problem is I'm not sure
> > what problems would produce an error, and what just would fail silently.
> > 
> > Any insight would be appreciated!
> > 
> > Best regards,
> > Jonathan Williams
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Feb 18 08:32:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 18 Feb 2016 17:32:27 +0100
Subject: [gdal-dev] Mask value data type in Python wrappings
In-Reply-To: <201602181720.14929.even.rouault@spatialys.com>
References: <F7A15A73-1953-419A-AD62-66443BC65C18@urthecast.com>
 <201602181720.14929.even.rouault@spatialys.com>
Message-ID: <201602181732.27639.even.rouault@spatialys.com>

Le jeudi 18 février 2016 17:20:14, Even Rouault a écrit :
> Dave,
> 
> > >>> band.SetNoDataValue(0)                     # Set the NODATA value to
> > >>> zero print "Nodata:", band.GetNoDataValue(),
> > >>> type(band.GetNoDataValue())
> > 
> > Nodata: 0.0 <type 'float’>
> > 
> > >>> mb = band.GetMaskBand()
> > >>> ma = mb.ReadAsArray()
> > >>> 
> > >>> 
> > >>> print "Origin:", ma[0, 0], type(ma[0, 0])  # *** SHOULD BE ZERO!!!
> > >>> ***
> 
> --> (Implicit) mask bands (such as the one generated for mask flag =
> GMF_ALL_VALID or GMF_NODATA), once fetched a first time, are no longer
> influenced by later actions. Re-opening the file should expose an updated
> mask band.

Looking at the code, I think that this could be fixed to behave as you'd expect 
with some refactoring : using an intermediate mask band class that would 
dynamically select the appropriate method, instead of returning directly a 
specialize instance of one of GDALNoDataValuesMaskBand / GDALNoDataMaskBand / 
GDALAllValidMaskBand

> 
> > Origin: 255 <type 'numpy.uint8'>
> > 
> > >>> print "(5, 5):", ma[5, 5], type(ma[5, 5])  # Correct
> > 
> > (5, 5): 255 <type 'numpy.uint8'>
> > 
> > >>> print np.any(ma==0)                        # Mask band is entirely
> > >>> 255
> > 
> > False
> > 
> > As you can see, the mask covers the entire image and not the zeros on the
> > edge.
> > 
> > The band.GetNoDataValue() is returning a Python float()
> 
> The C++ method always return a double, whatever the raster data type, hence
> the same for the Python bindings.
> 
> > which leads me to
> > suspect that there is incorrect type handling within GDAL’s Python
> > wrapping such that the mask generation is trying to compare the band’s
> > raster values (GDAL_UInt16) to whatever the NoDataValue type is stored
> > internally.
> 
> See my first explanation
> 
> Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From dwelch at urthecast.com  Thu Feb 18 09:52:45 2016
From: dwelch at urthecast.com (Dave Welch)
Date: Thu, 18 Feb 2016 17:52:45 +0000
Subject: [gdal-dev] Mask value data type in Python wrappings
In-Reply-To: <201602181732.27639.even.rouault@spatialys.com>
References: <F7A15A73-1953-419A-AD62-66443BC65C18@urthecast.com>
 <201602181720.14929.even.rouault@spatialys.com>
 <201602181732.27639.even.rouault@spatialys.com>
Message-ID: <5A897FC1-FB32-4DC6-8C61-782ED61F658E@urthecast.com>

Thanks for the help!  

When you mention refactoring, that was in regards to GDAL not my script, yes?  (Remember, GDAL n00b here…)
______________________________________________
Dave Welch Software Engineer
URTHECAST




On 2/18/16, 10:32 AM, "gdal-dev on behalf of Even Rouault" <gdal-dev-bounces at lists.osgeo.org on behalf of even.rouault at spatialys.com> wrote:

>Le jeudi 18 février 2016 17:20:14, Even Rouault a écrit :
>> Dave,
>> 
>> > >>> band.SetNoDataValue(0)                     # Set the NODATA value to
>> > >>> zero print "Nodata:", band.GetNoDataValue(),
>> > >>> type(band.GetNoDataValue())
>> > 
>> > Nodata: 0.0 <type 'float’>
>> > 
>> > >>> mb = band.GetMaskBand()
>> > >>> ma = mb.ReadAsArray()
>> > >>> 
>> > >>> 
>> > >>> print "Origin:", ma[0, 0], type(ma[0, 0])  # *** SHOULD BE ZERO!!!
>> > >>> ***
>> 
>> --> (Implicit) mask bands (such as the one generated for mask flag =
>> GMF_ALL_VALID or GMF_NODATA), once fetched a first time, are no longer
>> influenced by later actions. Re-opening the file should expose an updated
>> mask band.
>
>Looking at the code, I think that this could be fixed to behave as you'd expect 
>with some refactoring : using an intermediate mask band class that would 
>dynamically select the appropriate method, instead of returning directly a 
>specialize instance of one of GDALNoDataValuesMaskBand / GDALNoDataMaskBand / 
>GDALAllValidMaskBand
>
>> 
>> > Origin: 255 <type 'numpy.uint8'>
>> > 
>> > >>> print "(5, 5):", ma[5, 5], type(ma[5, 5])  # Correct
>> > 
>> > (5, 5): 255 <type 'numpy.uint8'>
>> > 
>> > >>> print np.any(ma==0)                        # Mask band is entirely
>> > >>> 255
>> > 
>> > False
>> > 
>> > As you can see, the mask covers the entire image and not the zeros on the
>> > edge.
>> > 
>> > The band.GetNoDataValue() is returning a Python float()
>> 
>> The C++ method always return a double, whatever the raster data type, hence
>> the same for the Python bindings.
>> 
>> > which leads me to
>> > suspect that there is incorrect type handling within GDAL’s Python
>> > wrapping such that the mask generation is trying to compare the band’s
>> > raster values (GDAL_UInt16) to whatever the NoDataValue type is stored
>> > internally.
>> 
>> See my first explanation
>> 
>> Even
>
>-- 
>Spatialys - Geospatial professional services
>http://www.spatialys.com
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 4493 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160218/596e71ef/attachment-0001.bin>

From nyall.dawson at gmail.com  Thu Feb 18 15:55:21 2016
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 19 Feb 2016 10:55:21 +1100
Subject: [gdal-dev] Possible to test for a layer capability before creating
	a layer?
Message-ID: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>

Hi all,

I'm aware that for drivers I can use OGR_Dr_TestCapability to
determine whether a particular driver as a specific capability. But is
there anyway to test whether a specific driver also has support for a
layer capability?

The situation is that I'd like to populate a list with all available
OGR drivers for which a created layer would then be able to support
SequentialWrite, DeleteFeature, RandomWrite and CreateField.

What would be the best way to go about this?

Nyall

From even.rouault at spatialys.com  Thu Feb 18 16:23:54 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 01:23:54 +0100
Subject: [gdal-dev] Possible to test for a layer capability before
	creating a layer?
In-Reply-To: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
References: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
Message-ID: <201602190123.54718.even.rouault@spatialys.com>

Le vendredi 19 février 2016 00:55:21, Nyall Dawson a écrit :
> Hi all,
> 
> I'm aware that for drivers I can use OGR_Dr_TestCapability to
> determine whether a particular driver as a specific capability. But is
> there anyway to test whether a specific driver also has support for a
> layer capability?
> 
> The situation is that I'd like to populate a list with all available
> OGR drivers for which a created layer would then be able to support
> SequentialWrite, DeleteFeature, RandomWrite and CreateField.
> 
> What would be the best way to go about this?

There seems to be growing interests for such topic (see yesterday similar 
thread : https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043782.html 
)

The way to go is to add such capability flags at the driver metadata level. 
This is now possible since GDAL 2.0 since OGR drivers can expose arbitrary 
metadata items.
What has to be done :
- define which capabilities must be exposed
- enhance drivers to advertize them

> 
> Nyall
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nyall.dawson at gmail.com  Thu Feb 18 16:34:27 2016
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 19 Feb 2016 11:34:27 +1100
Subject: [gdal-dev] Possible to test for a layer capability before
 creating a layer?
In-Reply-To: <201602190123.54718.even.rouault@spatialys.com>
References: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
 <201602190123.54718.even.rouault@spatialys.com>
Message-ID: <CAB28AsjLoafD56moQDe2yAfyLd1YyYMGKHbiA6OCz8wKJxUdMQ@mail.gmail.com>

On 19 February 2016 at 11:23, Even Rouault <even.rouault at spatialys.com> wrote:
> Le vendredi 19 février 2016 00:55:21, Nyall Dawson a écrit :
>> Hi all,
>>
>> I'm aware that for drivers I can use OGR_Dr_TestCapability to
>> determine whether a particular driver as a specific capability. But is
>> there anyway to test whether a specific driver also has support for a
>> layer capability?
>>
>> The situation is that I'd like to populate a list with all available
>> OGR drivers for which a created layer would then be able to support
>> SequentialWrite, DeleteFeature, RandomWrite and CreateField.
>>
>> What would be the best way to go about this?
>
> There seems to be growing interests for such topic (see yesterday similar
> thread : https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043782.html
> )

Yes, this would be very handy!

>
> The way to go is to add such capability flags at the driver metadata level.
> This is now possible since GDAL 2.0 since OGR drivers can expose arbitrary
> metadata items.
> What has to be done :
> - define which capabilities must be exposed
> - enhance drivers to advertize them

Ok. Does this mean there's no approach which would work for past GDAL
releases? (inc GDAL < 2.0)

Nyall




>
>>
>> Nyall
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From even.rouault at spatialys.com  Thu Feb 18 16:37:27 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 01:37:27 +0100
Subject: [gdal-dev] Possible to test for a layer capability before
	creating a layer?
In-Reply-To: <CAB28AsjLoafD56moQDe2yAfyLd1YyYMGKHbiA6OCz8wKJxUdMQ@mail.gmail.com>
References: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
 <201602190123.54718.even.rouault@spatialys.com>
 <CAB28AsjLoafD56moQDe2yAfyLd1YyYMGKHbiA6OCz8wKJxUdMQ@mail.gmail.com>
Message-ID: <201602190137.27706.even.rouault@spatialys.com>

Le vendredi 19 février 2016 01:34:27, Nyall Dawson a écrit :
> On 19 February 2016 at 11:23, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > Le vendredi 19 février 2016 00:55:21, Nyall Dawson a écrit :
> >> Hi all,
> >> 
> >> I'm aware that for drivers I can use OGR_Dr_TestCapability to
> >> determine whether a particular driver as a specific capability. But is
> >> there anyway to test whether a specific driver also has support for a
> >> layer capability?
> >> 
> >> The situation is that I'd like to populate a list with all available
> >> OGR drivers for which a created layer would then be able to support
> >> SequentialWrite, DeleteFeature, RandomWrite and CreateField.
> >> 
> >> What would be the best way to go about this?
> > 
> > There seems to be growing interests for such topic (see yesterday similar
> > thread :
> > https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043782.html )
> 
> Yes, this would be very handy!
> 
> > The way to go is to add such capability flags at the driver metadata
> > level. This is now possible since GDAL 2.0 since OGR drivers can expose
> > arbitrary metadata items.
> > What has to be done :
> > - define which capabilities must be exposed
> > - enhance drivers to advertize them
> 
> Ok. Does this mean there's no approach which would work for past GDAL
> releases? (inc GDAL < 2.0)

Unless someone is sent back to the past, no ;-) (but I guess they would have 
more interesting things to fix or do)

> 
> Nyall
> 
> >> Nyall
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> > 
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Feb 18 17:42:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 02:42:14 +0100
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required]
	GSoC 2016 Ideas page
In-Reply-To: <201602161128.33644.even.rouault@spatialys.com>
References: <201602161128.33644.even.rouault@spatialys.com>
Message-ID: <201602190242.14644.even.rouault@spatialys.com>

Le mardi 16 février 2016 11:28:33, Even Rouault a écrit :
> Hi,
> 
> Potential mentors and students: time to update
> https://trac.osgeo.org/gdal/wiki/SummerOfCode

To help resolving the blank page syndrome, I've drafted, with heterogeneous 
level of details, a few ideas : https://trac.osgeo.org/gdal/wiki/SummerOfCode
Edit, add your owns, or kill the bad ones.

> 
> Even
> 
> ----------  Message transmis  ----------
> 
> Sujet : [OSGeo-Discuss] [@Mentors: Action required] GSoC 2016 Ideas page
> Date : mardi 16 février 2016, 11:16:03
> De : Margherita Di Leo <diregola at gmail.com>
> À : OSGeo Discussions <discuss at lists.osgeo.org>, "OSGeo-SoC"
> <soc at lists.osgeo.org>
> 
> Dear All,
> 
> we would like to inform you all that we have applied on behalf of OSGeo, as
> a mentor organization for Google Summer of Code 2016. The application can
> be found at [1]. We ask your cooperation to set up the ideas page within
> few days. It is extremely important that the ideas page looks in good shape
> as it is the key page Google will be looking at when evaluating OSGeo. As
> usual, each community will set up its ideas page on its own wiki and will
> send us the link, that will be added by us to the main page [2]. Please
> forward this email to your communities.
> 
> As past years, OSGeo welcomes like minded projects that wish to participate
> under the org’s umbrella, not being official OSGeo projects. Please contact
> us to discuss it further.
> 
> Your OSGeo GSoC 2016 Admins
> 
> Margherita Di Leo (madi)
> 
> Anne Ghisla (aghisla)
> 
> [1] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_Application_2016
> 
> [2] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2016_Ideas

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ari.jolma at gmail.com  Thu Feb 18 22:23:42 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 19 Feb 2016 08:23:42 +0200
Subject: [gdal-dev] Possible to test for a layer capability before
 creating a layer?
In-Reply-To: <201602190123.54718.even.rouault@spatialys.com>
References: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
 <201602190123.54718.even.rouault@spatialys.com>
Message-ID: <56C6B4EE.7090209@gmail.com>

19.02.2016, 02:23, Even Rouault kirjoitti:
> Le vendredi 19 février 2016 00:55:21, Nyall Dawson a écrit :
>> Hi all,
>>
>> I'm aware that for drivers I can use OGR_Dr_TestCapability to
>> determine whether a particular driver as a specific capability. But is
>> there anyway to test whether a specific driver also has support for a
>> layer capability?
>>
>> The situation is that I'd like to populate a list with all available
>> OGR drivers for which a created layer would then be able to support
>> SequentialWrite, DeleteFeature, RandomWrite and CreateField.
>>
>> What would be the best way to go about this?
> There seems to be growing interests for such topic (see yesterday similar
> thread : https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043782.html
> )
>
> The way to go is to add such capability flags at the driver metadata level.
> This is now possible since GDAL 2.0 since OGR drivers can expose arbitrary
> metadata items.
> What has to be done :
> - define which capabilities must be exposed
> - enhance drivers to advertize them

In this case the question is about existing layer capabilities. One 
obstacle to testing them is that there is usually no way to create 
"blank" or minimal layer objects. For example Shapefile layer 
constructor requires all kinds of information and it represents an 
actual file (which can be in memory, though).

Blank or minimal layer objects could be useful as they can answer 
capability questions - the TestCapability method usually requires no or 
only minimal property information (is the layer read only or not, is 
filtering on).

Hm. Since the property information plays a part, the capability is not 
always a simple on/off issue, but the answer to a question whether a 
layer has a specific capability can also be "it depends" if you only 
know the driver.

Ari

>
>> Nyall
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From ari.jolma at gmail.com  Thu Feb 18 22:48:47 2016
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 19 Feb 2016 08:48:47 +0200
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required]
 GSoC 2016 Ideas page
In-Reply-To: <201602190242.14644.even.rouault@spatialys.com>
References: <201602161128.33644.even.rouault@spatialys.com>
 <201602190242.14644.even.rouault@spatialys.com>
Message-ID: <56C6BACF.3080705@gmail.com>

19.02.2016, 03:42, Even Rouault kirjoitti:
> Le mardi 16 février 2016 11:28:33, Even Rouault a écrit :
>> Hi,
>>
>> Potential mentors and students: time to update
>> https://trac.osgeo.org/gdal/wiki/SummerOfCode
> To help resolving the blank page syndrome, I've drafted, with heterogeneous
> level of details, a few ideas : https://trac.osgeo.org/gdal/wiki/SummerOfCode
> Edit, add your owns, or kill the bad ones.

I've added a few. A wish list.

Ari

>
>> Even
>>
>> ----------  Message transmis  ----------
>>
>> Sujet : [OSGeo-Discuss] [@Mentors: Action required] GSoC 2016 Ideas page
>> Date : mardi 16 février 2016, 11:16:03
>> De : Margherita Di Leo <diregola at gmail.com>
>> À : OSGeo Discussions <discuss at lists.osgeo.org>, "OSGeo-SoC"
>> <soc at lists.osgeo.org>
>>
>> Dear All,
>>
>> we would like to inform you all that we have applied on behalf of OSGeo, as
>> a mentor organization for Google Summer of Code 2016. The application can
>> be found at [1]. We ask your cooperation to set up the ideas page within
>> few days. It is extremely important that the ideas page looks in good shape
>> as it is the key page Google will be looking at when evaluating OSGeo. As
>> usual, each community will set up its ideas page on its own wiki and will
>> send us the link, that will be added by us to the main page [2]. Please
>> forward this email to your communities.
>>
>> As past years, OSGeo welcomes like minded projects that wish to participate
>> under the org’s umbrella, not being official OSGeo projects. Please contact
>> us to discuss it further.
>>
>> Your OSGeo GSoC 2016 Admins
>>
>> Margherita Di Leo (madi)
>>
>> Anne Ghisla (aghisla)
>>
>> [1] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_Application_2016
>>
>> [2] https://wiki.osgeo.org/wiki/Google_Summer_of_Code_2016_Ideas


From even.rouault at spatialys.com  Fri Feb 19 00:48:10 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 09:48:10 +0100
Subject: [gdal-dev] Possible to test for a layer capability before
	creating a layer?
In-Reply-To: <56C6B4EE.7090209@gmail.com>
References: <CAB28AsivPTXDVO_-MCes4wD_UYOwigGHqJ=DcZ_DsRq2o2QBmA@mail.gmail.com>
 <201602190123.54718.even.rouault@spatialys.com> <56C6B4EE.7090209@gmail.com>
Message-ID: <201602190948.10458.even.rouault@spatialys.com>

Le vendredi 19 février 2016 07:23:42, Ari Jolma a écrit :
> 19.02.2016, 02:23, Even Rouault kirjoitti:
> > Le vendredi 19 février 2016 00:55:21, Nyall Dawson a écrit :
> >> Hi all,
> >> 
> >> I'm aware that for drivers I can use OGR_Dr_TestCapability to
> >> determine whether a particular driver as a specific capability. But is
> >> there anyway to test whether a specific driver also has support for a
> >> layer capability?
> >> 
> >> The situation is that I'd like to populate a list with all available
> >> OGR drivers for which a created layer would then be able to support
> >> SequentialWrite, DeleteFeature, RandomWrite and CreateField.
> >> 
> >> What would be the best way to go about this?
> > 
> > There seems to be growing interests for such topic (see yesterday similar
> > thread :
> > https://lists.osgeo.org/pipermail/gdal-dev/2016-February/043782.html )
> > 
> > The way to go is to add such capability flags at the driver metadata
> > level. This is now possible since GDAL 2.0 since OGR drivers can expose
> > arbitrary metadata items.
> > What has to be done :
> > - define which capabilities must be exposed
> > - enhance drivers to advertize them
> 
> In this case the question is about existing layer capabilities. One
> obstacle to testing them is that there is usually no way to create
> "blank" or minimal layer objects. For example Shapefile layer
> constructor requires all kinds of information and it represents an
> actual file (which can be in memory, though).
> 
> Blank or minimal layer objects could be useful as they can answer
> capability questions - the TestCapability method usually requires no or
> only minimal property information (is the layer read only or not, is
> filtering on).
> 
> Hm. Since the property information plays a part, the capability is not
> always a simple on/off issue, but the answer to a question whether a
> layer has a specific capability can also be "it depends" if you only
> know the driver.

I agree that in theory the capabilities depend on a context : read-only vs 
update mode being the most common one, but there are more subtle ones 
depending on drivers ( some drivers only support CreateField if no feature has 
already been written for example, FastSpatialFilter generally depends on the 
actual presence of an index, FastFeatureCount conditionalized by the absence 
of an attribute filter, etc.. ). But I guess there are use cases where you 
would want to know the maximum theoretical capabilities of a driver, and be 
prepared that they are not all available at runtime.

The blank layer approach might be an approach, but I guess it could be non 
trivial in some drivers to instanciate such a layer. At the very least such a 
layer should be only an implementation detail not visible of the external 
user. The issue is also true for datasets since a few dataset capabilities 
require a dataset instance.
That's why my intuition would be to have simple properties attached to the 
driver, the drawback being some code duplication with the runtime mechanism.

> 
> Ari
> 
> >> Nyall
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jamessramm at gmail.com  Fri Feb 19 01:48:50 2016
From: jamessramm at gmail.com (jramm)
Date: Fri, 19 Feb 2016 01:48:50 -0800 (PST)
Subject: [gdal-dev] Read data without reading 'null data'
Message-ID: <1455875330714-5251626.post@n6.nabble.com>

We are storing large raster datasets (~500,000 x 500,000) in geotiff files.
The array data is typically very sparse (density is 0.02% or less) and
compression greatly reduces the geotiff size.

However, when processing data we read the data in chunks, which are
automatically decompressed..this means we are often reading in large areas
of no data and 'skipping' them. 
Is there a way to only read data with values so we may apply the processing
to these cells, and write them back out, skipping the no data? I guess this
would be equivalent to just not decompressing?



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Read-data-without-reading-null-data-tp5251626.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Feb 19 02:13:28 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 11:13:28 +0100
Subject: [gdal-dev] Read data without reading 'null data'
In-Reply-To: <1455875330714-5251626.post@n6.nabble.com>
References: <1455875330714-5251626.post@n6.nabble.com>
Message-ID: <201602191113.28134.even.rouault@spatialys.com>

Le vendredi 19 février 2016 10:48:50, jramm a écrit :
> We are storing large raster datasets (~500,000 x 500,000) in geotiff files.
> The array data is typically very sparse (density is 0.02% or less) and
> compression greatly reduces the geotiff size.
> 
> However, when processing data we read the data in chunks, which are
> automatically decompressed..this means we are often reading in large areas
> of no data and 'skipping' them.
> Is there a way to only read data with values so we may apply the processing
> to these cells, and write them back out, skipping the no data? I guess this
> would be equivalent to just not decompressing?

Hi,

The GTiff driver supports the concept of "sparse" files, which is I think a 
GDAL-specific extension, of how tiles and strips are indexed in TIFF. Basically 
if the byte size of a given block is marked as 0, it is interpreted as not 
physically present in the file and, when the block is read through the GDAL 
API, the pixels are initialized to 0 or the nodata value.

Currently sparse files can only be generated with the Create() API with the 
SPARSE_OK creation option, and by not writting any data (not even 0 or the 
nodata value) in the blocks you don't want to be serialized. Consequently 
using gdal_translate or gdalwarp will not produce the desired effect. Although 
that could be certainly improved.

On the reading side, in recent releases (2.0 I think), you can query the 
BLOCK_SIZE_{blockxoff}_{blockyoff} metadata item in the TIFF metadata domain to 
know if a block is present or not (return will be NULL for absent)

Even

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/Read-data-without-reading-null-data-tp
> 5251626.html Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gane.prog at gmail.com  Fri Feb 19 02:50:04 2016
From: gane.prog at gmail.com (Gane R)
Date: Fri, 19 Feb 2016 16:20:04 +0530
Subject: [gdal-dev] Get EPSG code from WKT
In-Reply-To: <loom.20160218T144721-299@post.gmane.org>
References: <CALMrLdCqZ-_pwcLmO74UsnewbQ1jV-DbfkOHPR69Hg0in4iKFQ@mail.gmail.com>
 <loom.20160218T144721-299@post.gmane.org>
Message-ID: <CALMrLdCwFUfFatDAmPmnXvQMx=G4CNhh8hLmmoWmupvb8eBC6w@mail.gmail.com>

Here is a link to the GeoPDF

https://drive.google.com/file/d/0B4shTM1bPS5TTk00aGIwUkhfd2s/view?usp=sharing

gdalwarp.exe -t_srs EPSG:3857 "Landuse(P)_VNY.pdf" "Landuse(P)_VNY.tif"

Resulting TIF is offset from the actual location, how do I find the correct
EPSG code for this kind of PDF.

but when -s_srs EPSG:26945 is part of the command line it works fine, how
do I know the the correct EPSG code from the WKT as there are more than one
AUTHORITY code with EPSG value ?

gdalinfo Landuse(P)_VNY.pdf

Driver: PDF/Geospatial PDF
Files: Landuse(P)_VNY.pdf
Size is 1275, 1650
Coordinate System is:
PROJCS["NAD83 / California zone 5",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Lambert_Conformal_Conic_2SP"],
    PARAMETER["standard_parallel_1",35.46666666666667],
    PARAMETER["standard_parallel_2",34.03333333333333],
    PARAMETER["latitude_of_origin",33.5],
    PARAMETER["central_meridian",-118],
    PARAMETER["false_easting",609601.2192024384],
    PARAMETER["false_northing",152400.3048006096],
    UNIT["Meter",1],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    AUTHORITY["EPSG","26945"]]
Origin = (1954721.377004246000000,580804.857233627580000)
Pixel Size = (6.774914195278887,-6.774914195278887)
Metadata:
  CREATION_DATE=D:20150428111946Z
  CREATOR=TerraGo Technologies Publisher for ArcGIS GeoPDF Export version:
6.5.1.12
  NEATLINE=POLYGON ((1963054.9640081285
571963.11863109597,1955025.6468122969 571963.11863109597,1955025.6468122969
580500.62045958859,1963054.9640081285 580500.62045958859,1963054.9640081285
571963.11863109597))
Corner Coordinates:
Upper Left  ( 1954721.377,  580804.857) (102d56'40.35"W, 36d27' 6.25"N)
Lower Left  ( 1954721.377,  569626.249) (102d57'47.23"W, 36d21' 7.77"N)
Upper Right ( 1963359.393,  580804.857) (102d50'57.53"W, 36d26'24.32"N)
Lower Right ( 1963359.393,  569626.249) (102d52' 4.82"W, 36d20'25.88"N)
Center      ( 1959040.385,  575215.553) (102d54'22.49"W, 36d23'46.09"N)
Band 1 Block=1275x1 Type=Byte, ColorInterp=Red
Band 2 Block=1275x1 Type=Byte, ColorInterp=Green
Band 3 Block=1275x1 Type=Byte, ColorInterp=Blue

On Thu, Feb 18, 2016 at 7:18 PM, Jukka Rahkonen <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Gane R <gane.prog <at> gmail.com> writes:
>
>
> > When I try to convert to different projection using the gdalwarp without
> specifying the -s_srs option it reprojects to a different location, for
> some
> raster it projects to a correct location.
> >
> > But when try to run gdalinfo and I see a lot of EPSG code, when I use the
> last AUTHORITY EPSG code as -s_srs option the above mention problem is
> solved.
> >
> > Is it that I have use the last AUTHORITY EPSG code or any thing will help
> >
> > Expecting your suggestion
>
> Expecting some sample data that could be used for reproducing the problem.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/9ac55c16/attachment.html>

From frank.broniewski at gmail.com  Fri Feb 19 02:50:29 2016
From: frank.broniewski at gmail.com (Frank Broniewski)
Date: Fri, 19 Feb 2016 11:50:29 +0100
Subject: [gdal-dev] osmconf.ini
Message-ID: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>

Hi,

I am having some trouble understanding, when - or how - multilinestrings
are imported into PostGIS. I am interested in hiking routes from
OpenStreetMap and I try to figure out how I can load them correctly into
PostGIS. The corresponding OSM Wiki page would be this:
http://wiki.openstreetmap.org/wiki/Hiking ,especially the part called
"Tagging walking and hiking Route Networks". There should be more hiking
routes as relations in my test region e.g.
http://www.openstreetmap.org/relation/2827792 is missing. It is not quite
clear to my how ogr2ogr decides what kind of data is put into which table.

So, what do I have to do to import this relation into the multilinestrings
table? Please find my osmconf.ini attached to this email for further
reference.

BTW, this is with GDAL 1.11.3, released 2015/09/16, on Windows 10 provided
by OSGeo4W.

Many thanks,

Frank
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/52fcde9e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: osmconf.ini
Type: application/octet-stream
Size: 3757 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/52fcde9e/attachment.obj>

From robert.coup at koordinates.com  Fri Feb 19 03:07:11 2016
From: robert.coup at koordinates.com (Robert Coup)
Date: Fri, 19 Feb 2016 11:07:11 +0000
Subject: [gdal-dev] Get EPSG code from WKT
In-Reply-To: <CALMrLdCwFUfFatDAmPmnXvQMx=G4CNhh8hLmmoWmupvb8eBC6w@mail.gmail.com>
References: <CALMrLdCqZ-_pwcLmO74UsnewbQ1jV-DbfkOHPR69Hg0in4iKFQ@mail.gmail.com>
 <loom.20160218T144721-299@post.gmane.org>
 <CALMrLdCwFUfFatDAmPmnXvQMx=G4CNhh8hLmmoWmupvb8eBC6w@mail.gmail.com>
Message-ID: <CAFLLRpJeaw-DQUcGEms4CP1p8rgR=ixkfizL+4tRtyfv-5B2uA@mail.gmail.com>

Hi Gane,

On 19 February 2016 at 10:50, Gane R <gane.prog at gmail.com> wrote:

>
> but when -s_srs EPSG:26945 is part of the command line it works fine, how
> do I know the the correct EPSG code from the WKT as there are more than one
> AUTHORITY code with EPSG value ?
>

There's (potentially) an Authority code for each *section* in the WKT. You
want the code for the *outermost* (in this case PROJCS, but will be GEOGCS
if it's a geographic coordinate system).

Different coordinate systems may have additional (or missing) Authority
codes -- eg. Shapefile PRJs from ArcGIS didn't include Authority codes for
a long time.


> PROJCS["NAD83 / California zone 5",   <= the projected coordinate system
>     GEOGCS["NAD83",   <= the geographic coordinate system the projection
> is based on
>         DATUM["North_American_Datum_1983",   <= the datum the geographic
> CS is based on
>             SPHEROID["GRS 1980",6378137,298.257222101,  <= the spheroid
> the datum is based on
>                 AUTHORITY["EPSG","7019"]],   <= code for the GRS1980
> spheroid
>             TOWGS84[0,0,0,0,0,0,0],
>             AUTHORITY["EPSG","6269"]],  <= code for the NAD83 datum
>         PRIMEM["Greenwich",0,   <= prime meridian
>             AUTHORITY["EPSG","8901"]],  <= code for the Greenwich meridian
>         UNIT["degree",0.0174532925199433,  <= units for the NAD83
> geographic CS
>             AUTHORITY["EPSG","9122"]],  <= code for Degree units
>         AUTHORITY["EPSG","4269"]],  <= code for the NAD83 geographic CS
>     PROJECTION["Lambert_Conformal_Conic_2SP"],
>     PARAMETER["standard_parallel_1",35.46666666666667],
>     PARAMETER["standard_parallel_2",34.03333333333333],
>     PARAMETER["latitude_of_origin",33.5],
>     PARAMETER["central_meridian",-118],
>     PARAMETER["false_easting",609601.2192024384],
>     PARAMETER["false_northing",152400.3048006096],
>     UNIT["Meter",1],
>     AXIS["X",EAST],
>     AXIS["Y",NORTH],
>     AUTHORITY["EPSG","26945"]] <= code for the NAD83/California Zone 5
> projected CS
>

HTH,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/30fdae91/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Feb 19 04:20:25 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Fri, 19 Feb 2016 12:20:25 +0000 (UTC)
Subject: [gdal-dev] osmconf.ini
References: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>
Message-ID: <loom.20160219T131643-972@post.gmane.org>

Frank Broniewski <frank.broniewski <at> gmail.com> writes:

> 
> 
> 
> 
> 
> Hi,
> I am having some trouble understanding, when - or how - multilinestrings
are imported into PostGIS. I am interested in hiking routes from
OpenStreetMap and I try to figure out how I can load them correctly into
PostGIS. The corresponding OSM Wiki page would be this:
http://wiki.openstreetmap.org/wiki/Hiking ,especially the part called
"Tagging walking and hiking Route Networks". There should be more hiking
routes as relations in my test region e.g.
http://www.openstreetmap.org/relation/2827792 is missing. It is not quite
clear to my how ogr2ogr decides what kind of data is put into which table.
> So, what do I have to do to import this relation into the multilinestrings
table? Please find my osmconf.ini attached to this email for further reference.
> 
> BTW, this is with GDAL 1.11.3, released 2015/09/16, on Windows 10 provided
by OSGeo4W.
> 
> Many thanks,
> Frank
> 
> Attachment (osmconf.ini): application/octet-stream, 3757 bytes


By quick look your osmconf.ini is OK, there is "route" along the
multilinestring attributes and data contain tag "route=hiking". Could you
put a complete, hopefully small sample of OSM data with hiking routes that
could be used for testing somewhere for downloading?

-Jukka Rahkonen-


From dmorissette at mapgears.com  Fri Feb 19 06:01:05 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri, 19 Feb 2016 09:01:05 -0500
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required]
 GSoC 2016 Ideas page
In-Reply-To: <56C6BACF.3080705@gmail.com>
References: <201602161128.33644.even.rouault@spatialys.com>
 <201602190242.14644.even.rouault@spatialys.com> <56C6BACF.3080705@gmail.com>
Message-ID: <56C72021.5010706@mapgears.com>

On 2016-02-19 1:48 AM, Ari Jolma wrote:
> 19.02.2016, 03:42, Even Rouault kirjoitti:
>> Le mardi 16 février 2016 11:28:33, Even Rouault a écrit :
>>> Hi,
>>>
>>> Potential mentors and students: time to update
>>> https://trac.osgeo.org/gdal/wiki/SummerOfCode
>> To help resolving the blank page syndrome, I've drafted, with
>> heterogeneous
>> level of details, a few ideas :
>> https://trac.osgeo.org/gdal/wiki/SummerOfCode
>> Edit, add your owns, or kill the bad ones.
>
> I've added a few. A wish list.
>

I've added my own wish: M support in GPX driver and other formats which 
support M dimension.

-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From even.rouault at spatialys.com  Fri Feb 19 06:12:20 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 19 Feb 2016 15:12:20 +0100
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required]
	GSoC 2016 Ideas page
In-Reply-To: <56C72021.5010706@mapgears.com>
References: <201602161128.33644.even.rouault@spatialys.com>
 <56C6BACF.3080705@gmail.com> <56C72021.5010706@mapgears.com>
Message-ID: <201602191512.21087.even.rouault@spatialys.com>

Le vendredi 19 février 2016 15:01:05, Daniel Morissette a écrit :
> On 2016-02-19 1:48 AM, Ari Jolma wrote:
> > 19.02.2016, 03:42, Even Rouault kirjoitti:
> >> Le mardi 16 février 2016 11:28:33, Even Rouault a écrit :
> >>> Hi,
> >>> 
> >>> Potential mentors and students: time to update
> >>> https://trac.osgeo.org/gdal/wiki/SummerOfCode
> >> 
> >> To help resolving the blank page syndrome, I've drafted, with
> >> heterogeneous
> >> level of details, a few ideas :
> >> https://trac.osgeo.org/gdal/wiki/SummerOfCode
> >> Edit, add your owns, or kill the bad ones.
> > 
> > I've added a few. A wish list.
> 
> I've added my own wish: M support in GPX driver and other formats which
> support M dimension.

Hi Daniel,

That's actually a topic I wanted to address partly for the code sprint : 
https://wiki.osgeo.org/wiki/Paris_Code_Sprint_2016_:_GDAL_Agenda

For GPX, I guess M would hold the time information ? Presumably as a unix time 
since we are bound to double values.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From JDTilley at aol.com  Fri Feb 19 06:24:14 2016
From: JDTilley at aol.com (JASON TILLEY)
Date: Fri, 19 Feb 2016 08:24:14 -0600
Subject: [gdal-dev] GDAL Fails to import in Python - HDF5 Issues
Message-ID: <BAF36AAC-F87A-40ED-9D83-C5D27D4BB68F@aol.com>

I am trying to build gdal from source and use it with Python. It seems I can build and install HDF5 with out problems. However, when build GDAL using the --with-python flag I do get a few warnings that mostly look like this:

ld: warning: directory not found for option '-L/Users/username/src/gdal-2.0.2/lib'
ld: warning: could not create compact unwind for _MEMCreateRasterBand: dwarf uses DW_CFA_GNU_args_size
ld: warning: could not create compact unwind for __ZN10MEMDataset7AddBandE12GDALDataTypePPc: dwarf uses DW_CFA_GNU_args_size

I get about 13 more warnings regarding DW_CFA_GNU_args_size.

I’m not sure if this is related. I can run gdal-config --formats and it does show hdf5 as an available format. But once I try:

from osgeo import gdal 

in Python, I get the following error:

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/GDAL-2.0.2-py2.7-macosx-10.11-x86_64.egg/osgeo/__init__.py", line 21, in <module>
    _gdal = swig_import_helper()
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/GDAL-2.0.2-py2.7-macosx-10.11-x86_64.egg/osgeo/__init__.py", line 17, in swig_import_helper
    _mod = imp.load_module('_gdal', fp, pathname, description)
ImportError: dlopen(/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/GDAL-2.0.2-py2.7-macosx-10.11-x86_64.egg/osgeo/_gdal.so, 2): Symbol not found: _H5T_NATIVE_DOUBLE_g
  Referenced from: /opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/GDAL-2.0.2-py2.7-macosx-10.11-x86_64.egg/osgeo/_gdal.so
  Expected in: flat namespace
 in /opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/GDAL-2.0.2-py2.7-macosx-10.11-x86_64.egg/osgeo/_gdal.so

Does anybody know what the problem could be? Thanks.

Jason

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/0dcd3968/attachment.html>

From dmorissette at mapgears.com  Fri Feb 19 06:50:55 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Fri, 19 Feb 2016 09:50:55 -0500
Subject: [gdal-dev] Fwd: [OSGeo-Discuss] [@Mentors: Action required]
 GSoC 2016 Ideas page
In-Reply-To: <201602191512.21087.even.rouault@spatialys.com>
References: <201602161128.33644.even.rouault@spatialys.com>
 <56C6BACF.3080705@gmail.com> <56C72021.5010706@mapgears.com>
 <201602191512.21087.even.rouault@spatialys.com>
Message-ID: <56C72BCF.5000002@mapgears.com>

On 2016-02-19 9:12 AM, Even Rouault wrote:
> Le vendredi 19 février 2016 15:01:05, Daniel Morissette a écrit :
>>
>> I've added my own wish: M support in GPX driver and other formats which
>> support M dimension.
>
> Hi Daniel,
>
> That's actually a topic I wanted to address partly for the code sprint :
> https://wiki.osgeo.org/wiki/Paris_Code_Sprint_2016_:_GDAL_Agenda
>

Ha! I wasn't aware of that. That's even better. :-)


> For GPX, I guess M would hold the time information ? Presumably as a unix time
> since we are bound to double values.
>

Um... you're right, good point. I didn't think of the fact that the M 
was stored in a float. I guess using unix time it will have to be. Let's 
talk about that at the code sprint next week.


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From jlaura at asu.edu  Fri Feb 19 12:49:55 2016
From: jlaura at asu.edu (Jay L.)
Date: Fri, 19 Feb 2016 13:49:55 -0700
Subject: [gdal-dev] GDAL 1.11.3 ISIS3 Driver
Message-ID: <CA+bfmPuaBhVckybZbkhSwYVGB7KGpo8jfniLKjkic=3XTVFUKw@mail.gmail.com>

Just built GDAL 1.11.3 using the following:

./configure --prefix=/home/travis/miniconda/envs/_build
--with-geos=/home/travis/miniconda/envs/_build/bin/geos-config
--with-static-proj4=/home/travis/miniconda/envs/_build
--with-hdf5=/home/travis/miniconda/envs/_build
--with-xerces=/home/travis/miniconda/envs/_build
--with-armadillo=/home/travis/miniconda/envs/_build
--with-netcdf=/home/travis/miniconda/envs/_build
--with-openjpeg=/home/travis/miniconda/envs/_build --with-gif=internal
--with-geotiff=internal --with-python --disable-rpath --without-pam
--with-pg=/home/travis/miniconda/envs/_build/bin/pg_config

The full build is available at:
https://travis-ci.org/USGS-Astrogeology/conda-gdal/builds/110469950

The ISIS3 driver is not building (the ISIS2 driver is).  Does the ISIS3
driver have some dependency?

Thanks,
Jay
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160219/1c3ec1d5/attachment.html>

From even.rouault at spatialys.com  Sat Feb 20 07:18:57 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 20 Feb 2016 16:18:57 +0100
Subject: [gdal-dev] osmconf.ini
In-Reply-To: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>
References: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>
Message-ID: <201602201618.57535.even.rouault@spatialys.com>

Frank,

I clicked on the "Export" button on the view centered on 
http://www.openstreetmap.org/relation/2827792 , and ran

$ ogrinfo ~/Téléchargements/map.osm multilinestrings \
 -where "osm_id = '2827792'" -geom=no -al -q \
--config OSM_USE_CUSTOM_INDEXING NO

Layer name: multilinestrings
OGRFeature(multilinestrings):2827792
  osm_id (String) = 2827792
  name (String) = Felsenweg Losheim
  type (String) = route
  other_tags (String) = 
"distance"=>"13.4km","network"=>"lwn","operator"=>"Gemeinde 
Losheim","osmc:symbol"=>"yellow:yellow_frame:F:orange","ref"=>"F","route"=>"hiking","symbol"=>"gelbes 
F vor orangenem Felsen","website"=>"http://www.wanderbares-
saarland.de/wanderwege/felsenweg.html"

(with the default osmconf.ini)

Even

> 
> I am having some trouble understanding, when - or how - multilinestrings
> are imported into PostGIS. I am interested in hiking routes from
> OpenStreetMap and I try to figure out how I can load them correctly into
> PostGIS. The corresponding OSM Wiki page would be this:
> http://wiki.openstreetmap.org/wiki/Hiking ,especially the part called
> "Tagging walking and hiking Route Networks". There should be more hiking
> routes as relations in my test region e.g.
> http://www.openstreetmap.org/relation/2827792 is missing. It is not quite
> clear to my how ogr2ogr decides what kind of data is put into which table.
> 
> So, what do I have to do to import this relation into the multilinestrings
> table? Please find my osmconf.ini attached to this email for further
> reference.
> 
> BTW, this is with GDAL 1.11.3, released 2015/09/16, on Windows 10 provided
> by OSGeo4W.
> 
> Many thanks,
> 
> Frank

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andre+joost at nurfuerspam.de  Sat Feb 20 23:02:34 2016
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Sun, 21 Feb 2016 08:02:34 +0100
Subject: [gdal-dev] osmconf.ini
In-Reply-To: <201602201618.57535.even.rouault@spatialys.com>
References: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>
 <201602201618.57535.even.rouault@spatialys.com>
Message-ID: <nabobb$lgu$2@ger.gmane.org>

Am 20.02.2016 um 16:18 schrieb Even Rouault:
> Frank,
>
> I clicked on the "Export" button on the view centered on
> http://www.openstreetmap.org/relation/2827792 , and ran
>
> $ ogrinfo ~/Téléchargements/map.osm multilinestrings \
>   -where "osm_id = '2827792'" -geom=no -al -q \
> --config OSM_USE_CUSTOM_INDEXING NO


Based on that, I get a shapefile of the route with

ogr2ogr -overwrite route-export.shp map-export.osm  -where "osm_id = 
'2827792'" -progress --config OSM_USE_CUSTOM_INDEXING NO -skipfailures

HTH,
André Joost


From mdsumner at gmail.com  Sun Feb 21 15:09:03 2016
From: mdsumner at gmail.com (Michael Sumner)
Date: Sun, 21 Feb 2016 23:09:03 +0000
Subject: [gdal-dev] vector drivers with mixed topology types in a single
	layer?
In-Reply-To: <CAAcGz9_JwAueQ1NAEiEpKCe_JzM7QAy140FEj6o_J+X2BezvgQ@mail.gmail.com>
References: <CAAcGz9_GKUqy+kDH1m=5Q52j6P9Fo7Sn1Mk90LAXZZaKituLMw@mail.gmail.com>
 <201602171318.18647.even.rouault@spatialys.com>
 <CAAcGz9_JwAueQ1NAEiEpKCe_JzM7QAy140FEj6o_J+X2BezvgQ@mail.gmail.com>
Message-ID: <CAAcGz99pzV1w8GKJyTHf_V7kdHTgVYiRJBX4PF9aN6bVK0ObLQ@mail.gmail.com>

On Wed, 17 Feb 2016 at 23:24 Michael Sumner <mdsumner at gmail.com> wrote:

>
>
> On Wed, 17 Feb 2016 11:18 pm Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Le mercredi 17 février 2016 12:25:24, Michael Sumner a écrit :
>> > Hi there, is there an easy way to discover which formats allow mixing of
>> > vector types in a single layer?
>>
>> No, there is no such driver metadata currently. You need to open the
>> dataset
>> and query the layer geometry type. If it is unknown, then it allows mix of
>> geometry types.
>>
>> >
>> > I.e. a single layer MapInfo file with points, lines, and polygons - I
>> know
>> > there is MapInfo (tab) and MapInfo (mif) and GeoJSON,
>> >
>> > I'd also like to know what drivers can present as a single data set but
>> > with these types separated into different layers, like SDTS.
>> >
>> > I consider the multiple shapefiles in one folder feature to be a
>> somewhat
>> > different, third case.
>> From the point of view of the OGR API, a directory of shapefile = a
>> dataset
>> with several layers
>> >
>> > Is there a clear way to categorize these three kinds, and classify all
>> > existing drivers this way?
>>
>> I think there are 2 orthogonal isssues :
>> - which drivers support mixed of geometry type in a single layer
>> - which drivers support multiple layers in a dataset (in general, datasets
>> that support multiple layers do not set a constraint on the unicity of the
>> geometry type among layers)
>>
>> And perhaps to address your shapefile case :
>> - which drivers support only opening a file
>> - which drivers support only opening a directory
>> - which drivers support both
>> - which drivers are not file related (already addressed by checking if the
>> GDAL_DMD_CONNECTION_PREFIX / "DMD_CONNECTION_PREFIX" metadata item is
>> present.
>> Was added in GDAL 2.0)
>>
>>
>>
>>
>> >
>> > Am I on the right track, or is it more complicated?
>> >
>> > Cheers, Mike.
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>
>
> Thank you Even, very helpful.
>
> Cheers, Mike
>
>
>

Is there much discussion recorded about this issue in general? I find it
odd that QGIS does not allow mixing - at all - given that OGR supports it.
I found this:

http://gis.stackexchange.com/questions/89423/combining-different-geometry-types-into-same-feature-class

I'm interested in GDAL-specific discussions, or any packages that use GDAL
that allow this.

The now defunct  Eonfusion project supported this mixing with a
spatial-primitives-based data model (I worked on the project it for a
time).

FWIW I'm a long-term Manifold user so I take this capability for granted:

 http://www.georeference.org/doc/drawings.htm

I'm exploring geometry models in R that allow both traditional "features"
alongside triangulated meshes and other primitves-based structures.  This
is a much better fit for database-aligned data sets, and obviously mixed
geometry is an obvious need for query-based GIS.

Keen to see any links to discussions that folks might remember, or that are
active currently.

Cheers, Mike.




>
>> --
> Dr. Michael Sumner
> Software and Database Engineer
> Australian Antarctic Division
> 203 Channel Highway
> Kingston Tasmania 7050 Australia
>
> --
Dr. Michael Sumner
Software and Database Engineer
Australian Antarctic Division
203 Channel Highway
Kingston Tasmania 7050 Australia
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160221/88a6a6cd/attachment.html>

From even.rouault at spatialys.com  Mon Feb 22 03:15:31 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Feb 2016 12:15:31 +0100
Subject: [gdal-dev] GDAL packaging in OSGeo4W
Message-ID: <201602221215.31399.even.rouault@spatialys.com>

Hi,

Following recent exchanges on the discuss mailing list, it appears that the 
whole set of packages in OSGeo4W relies on very few shoulders. I was wondering 
if someone would be willing to take the stick for GDAL.
Could be cool to have -dev versions packaged from time to time (or potentially 
nightly builds), as well as a few drivers available as plugins (PDF driver, 
MongoDB one)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jef at norbit.de  Mon Feb 22 05:38:06 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Mon, 22 Feb 2016 14:38:06 +0100
Subject: [gdal-dev] GDAL packaging in OSGeo4W
In-Reply-To: <201602221215.31399.even.rouault@spatialys.com>
References: <201602221215.31399.even.rouault@spatialys.com>
Message-ID: <20160222133806.GA10627@norbit.de>

Hi Even,

On Mon, 22. Feb 2016 at 12:15:31 +0100, Even Rouault wrote:
> Following recent exchanges on the discuss mailing list, it appears that the
> whole set of packages in OSGeo4W relies on very few shoulders. I was
> wondering if someone would be willing to take the stick for GDAL.

> Could be cool to have -dev versions packaged from time to time (or
> potentially nightly builds), as well as a few drivers available as plugins
> (PDF driver, MongoDB one)

PDF is included (but not as plugin).  mongo db however is missing, yes.

Well, and the discussion might be a bit misled.  My point was that OSGeo4W is
not stalled - eventhough I'm not keen on building all the stuff with an (even
bigger) zoo of compilers.  Because I don't really see a point in that - for me
OSGeo4W is about shipping applications and not development libraries.

Doing a build once in a while (and maybe even adding a nightly - I run the qgis
nightlies anyway) shouldn't be a big problem.   But this came only up once in a
while - IIRC more like a nice idea, but not like real request.  Maybe also
because it would be of limited use, if "upper level" package like QGIS would
not use the gdal nightly.

But would probably not be what you intended ;)


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode                         
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160222/b0fda9fa/attachment.sig>

From even.rouault at spatialys.com  Mon Feb 22 06:04:14 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 22 Feb 2016 15:04:14 +0100
Subject: [gdal-dev] GDAL packaging in OSGeo4W
In-Reply-To: <20160222133806.GA10627@norbit.de>
References: <201602221215.31399.even.rouault@spatialys.com>
 <20160222133806.GA10627@norbit.de>
Message-ID: <201602221504.14316.even.rouault@spatialys.com>

Le lundi 22 février 2016 14:38:06, Jürgen E. Fischer a écrit :
> Hi Even,
> 
> On Mon, 22. Feb 2016 at 12:15:31 +0100, Even Rouault wrote:
> > Following recent exchanges on the discuss mailing list, it appears that
> > the whole set of packages in OSGeo4W relies on very few shoulders. I was
> > wondering if someone would be willing to take the stick for GDAL.
> > 
> > Could be cool to have -dev versions packaged from time to time (or
> > potentially nightly builds), as well as a few drivers available as
> > plugins (PDF driver, MongoDB one)
> 
> PDF is included (but not as plugin).

Ah honestly I didn't try recently. Just looked at 
http://download.osgeo.org/osgeo4w/x86_64/release/gdal/setup.hint . If the 
build dependencies are just those ones, then it must be only the write support 
of the PDF driver which requires no dependency. For read-support, you need  
poppler for raster&vector read support, or podofo for vector read support only 
(or pdfium - new to trunk - for raster&vector read support, PDFium being 
licensed under non-copyleft terms).

> mongo db however is missing, yes.

Yes, trunk only anyway

> 
> Well, and the discussion might be a bit misled.  My point was that OSGeo4W
> is not stalled - eventhough I'm not keen on building all the stuff with an
> (even bigger) zoo of compilers.

Sure, building the whole stack with different compilers would require an 
automated process, and as automation doesn't work alone, people behind it.

> Because I don't really see a point in
> that - for me OSGeo4W is about shipping applications and not development
> libraries.

Perhaps you meant "shipping development libraries.... for a number of compiler 
version, with/without debug symbol, etc..." ? Because at least the .h and .lib 
corresponding to the used compiler must be provided, so as to be able to build 
upper level packages.

> 
> Doing a build once in a while (and maybe even adding a nightly - I run the
> qgis nightlies anyway) shouldn't be a big problem.   But this came only up
> once in a while - IIRC more like a nice idea, but not like real request. 

My email was more about to try to find if the load can be shared. It shouldn't 
fall on QGIS to build the whole stack since most packages have their 
usefulness individually.

> Maybe also because it would be of limited use, if "upper level" package
> like QGIS would not use the gdal nightly.
> 
> But would probably not be what you intended ;)

That may be a chicken&egg problem. If there are no GDAL dev builds, nobody is 
going to try them.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jef at norbit.de  Mon Feb 22 06:29:05 2016
From: jef at norbit.de (=?iso-8859-1?B?SvxyZ2VuIEUu?= Fischer)
Date: Mon, 22 Feb 2016 15:29:05 +0100
Subject: [gdal-dev] GDAL packaging in OSGeo4W
In-Reply-To: <201602221504.14316.even.rouault@spatialys.com>
References: <201602221215.31399.even.rouault@spatialys.com>
 <20160222133806.GA10627@norbit.de>
 <201602221504.14316.even.rouault@spatialys.com>
Message-ID: <20160222142905.GA7303@norbit.de>

Hi Even,

On Mon, 22. Feb 2016 at 15:04:14 +0100, Even Rouault wrote:
> Ah honestly I didn't try recently. Just looked at 
> http://download.osgeo.org/osgeo4w/x86_64/release/gdal/setup.hint.

> If the build dependencies are just those ones, then it must be only the write support 
> of the PDF driver which requires no dependency. For read-support, you need  
> poppler for raster&vector read support, or podofo for vector read support only 
> (or pdfium - new to trunk - for raster&vector read support, PDFium being 
> licensed under non-copyleft terms).

Yes.  Not all build dependencies are there (partly because of licensing; ECW,
MrSID, FileGDB...) and as poppler is only used by GDAL, I didn't package it.
It's just linked into GDAL.


> > mongo db however is missing, yes.
 
> Yes, trunk only anyway

Ah, ok.  I didn't check.

 
> > Well, and the discussion might be a bit misled.  My point was that OSGeo4W
> > is not stalled - eventhough I'm not keen on building all the stuff with an
> > (even bigger) zoo of compilers.

> Sure, building the whole stack with different compilers would require an
> automated process, and as automation doesn't work alone, people behind it.

That, and it also doesn't make a lot of send to me - unless the aim is to
provide libraries to third parties.


> > Because I don't really see a point in that - for me OSGeo4W is about
> > shipping applications and not development libraries.
 
> Perhaps you meant "shipping development libraries.... for a number of
> compiler version, with/without debug symbol, etc..." ? Because at least the
> .h and .lib corresponding to the used compiler must be provided, so as to be
> able to build upper level packages.

Sure.  We also ship the libraries needed to build packages for OSGeo4W on top
of dependencies in OSGeo4W.  Just not libraries, that aren't used in OSGeo4W
otherwise.  But that's no strict rule either.  E.g. we also ship QGIS libraries
and headers - although we currently don't have any packaged C++ plugins for
QGIS in OSGeo4W.


> > Doing a build once in a while (and maybe even adding a nightly - I run the
> > qgis nightlies anyway) shouldn't be a big problem.   But this came only up
> > once in a while - IIRC more like a nice idea, but not like real request. 
 
> My email was more about to try to find if the load can be shared. It
> shouldn't fall on QGIS to build the whole stack since most packages have
> their usefulness individually.

Yes, of course.  That's how I understood it.

> > But would probably not be what you intended ;)

That was more about me volunteering. ;)


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden             http://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode                         
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: Digital signature
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160222/d6ce3565/attachment.sig>

From gane.prog at gmail.com  Mon Feb 22 09:32:16 2016
From: gane.prog at gmail.com (Gane R)
Date: Mon, 22 Feb 2016 23:02:16 +0530
Subject: [gdal-dev] GeoTIF has not text while gdalwarp (GeoPDF to GeoTIF)
Message-ID: <CALMrLdAHK8aWbtaH3wmNDLa9T7DjT1At=ZkiuX2w_hcaaVdveQ@mail.gmail.com>

I am trying to do a gdalwarp on linux with poppler, fontconfig and
freetype2 built in gdal

I get the following error

ERROR 1: Couldn't find a font

when converting from GeoPDF to GeoTIF

Resulting GeoTIF doesn't have some text labels in the PDF.

Any suggestion while building gdal


Regards,
Gane
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160222/6c16c846/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Mon Feb 22 09:43:54 2016
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 22 Feb 2016 13:43:54 -0400
Subject: [gdal-dev] GeoTIF has not text while gdalwarp (GeoPDF to GeoTIF)
In-Reply-To: <CALMrLdAHK8aWbtaH3wmNDLa9T7DjT1At=ZkiuX2w_hcaaVdveQ@mail.gmail.com>
References: <CALMrLdAHK8aWbtaH3wmNDLa9T7DjT1At=ZkiuX2w_hcaaVdveQ@mail.gmail.com>
Message-ID: <56CB48DA.1090103@gatewaygeomatics.com>

On 2016-02-22 1:32 PM, Gane R wrote:
> I am trying to do a gdalwarp on linux with poppler, fontconfig and
> freetype2 built in gdal
>
> I get the following error
>
> ERROR 1: Couldn't find a font
>
> when converting from GeoPDF to GeoTIF
>
> Resulting GeoTIF doesn't have some text labels in the PDF.
>
> Any suggestion while building gdal
>
>
> Regards,
> Gane
>
>

I haven't tried your exact gdalwarp steps, but I can tell you that for 
MS4W (http://ms4w.com) on Windows we build poppler with the following 
dependencies: freetype, jpeg, zlib, libpng, libiconv, and cairo.

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
http://www.gatewaygeomatics.com/





From navlani.bharti20 at gmail.com  Tue Feb 23 03:13:34 2016
From: navlani.bharti20 at gmail.com (bharti navlani)
Date: Tue, 23 Feb 2016 16:43:34 +0530
Subject: [gdal-dev] gdaltransform
Message-ID: <CAMzzNVwtKqtemrmvU_YbMwCtP-UnhKv_aN5jsMbmO_dQK9T7VQ@mail.gmail.com>

I am new user of gdal.
I am having a image (.tif) and its corresponding RPC file (.txt)
How to convert lat/long to image pixel coordinate and vise versa using
gdaltransform with the image and its RPC file ?
Unable to do the example given the website
http://www.gdal.org/gdaltransform.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160223/b6e753a1/attachment.html>

From jvail at gmx.de  Tue Feb 23 05:50:35 2016
From: jvail at gmx.de (jan vaillant)
Date: Tue, 23 Feb 2016 14:50:35 +0100
Subject: [gdal-dev] libkml driver get document name
Message-ID: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>

Hi list,

I am reading a zipped kml with gdal's libkml driver. I am trying to access the name tag of the document:

<kml>
  <Document>
    <name>a_name</name>
...

If I look at the source code I can see a way to set those options here for writing kml

void OGRLIBKMLDataSource::SetCommonOptions(ContainerPtr poKmlContainer,
                                           char** papszOptions)
{
    const char* pszName = CSLFetchNameValue(papszOptions, "NAME");
    if( pszName != NULL )
        poKmlContainer->set_name(pszName);
...

but I cant find a way to read the options. ogrLayer->GetName() returns the file name not the <name>a_name</name> element. Any ideas?

Thank you
Jan

From even.rouault at spatialys.com  Tue Feb 23 15:53:59 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Feb 2016 00:53:59 +0100
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
Message-ID: <201602240054.00200.even.rouault@spatialys.com>

Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
> Hi list,
> 
> I am reading a zipped kml with gdal's libkml driver. I am trying to access
> the name tag of the document:
> 
> <kml>
>   <Document>
>     <name>a_name</name>

I did a quick testing It appears that the driver will report a <name> as the 
layer name only if it inside a <Folder> tag, but not as a direct child of 
<Document>

> ...
> 
> If I look at the source code I can see a way to set those options here for
> writing kml
> 
> void OGRLIBKMLDataSource::SetCommonOptions(ContainerPtr poKmlContainer,
>                                            char** papszOptions)
> {
>     const char* pszName = CSLFetchNameValue(papszOptions, "NAME");
>     if( pszName != NULL )
>         poKmlContainer->set_name(pszName);
> ...
> 
> but I cant find a way to read the options. ogrLayer->GetName() returns the
> file name not the <name>a_name</name> element. Any ideas?
> 
> Thank you
> Jan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Feb 23 16:10:31 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 24 Feb 2016 01:10:31 +0100
Subject: [gdal-dev] Motion: Committer Status for  Lucian Plesea
Message-ID: <201602240110.32078.even.rouault@spatialys.com>

Motion: Committer Status for Lucian Plesea
---

Dear PSC,

Lucian is the maintainer of the MRF (Meta Raster Format) driver who has 
existed as an out-of-tree driver and whose main repository is at 
https://github.com/nasa-gibs/mrf . Recently I've worked with him to get the 
driver also integrated in the GDAL tree itself, and he merged back the changes 
in the above mentionned repository, so that both code base are now in sync. 
For the future, it would be convenient if Lucian could directly maintain the 
GDAL copy directly and keep in sync both repositories, so I motion to grant 
him commit rights. Lucian scope of interest also includes the WMS driver.

I'll start the voting with:

+1 Even

Lucian,
Please, could you answer to this message and state that you have
read and agreed to the committer guidelines as outlined in the RFC3 ( 
http://trac.osgeo.org/gdal/wiki/rfc3_commiters )

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Tue Feb 23 16:42:50 2016
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 23 Feb 2016 16:42:50 -0800
Subject: [gdal-dev] Motion: Committer Status for Lucian Plesea
In-Reply-To: <201602240110.32078.even.rouault@spatialys.com>
References: <201602240110.32078.even.rouault@spatialys.com>
Message-ID: <CACmBxytdq8OEBQh4ouCKkgU+qHGTfdS0cUSJQ8qiSUKR59_HJQ@mail.gmail.com>

+1 Kurt

On Tue, Feb 23, 2016 at 4:10 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Motion: Committer Status for Lucian Plesea
> ---
>
> Dear PSC,
>
> Lucian is the maintainer of the MRF (Meta Raster Format) driver who has
> existed as an out-of-tree driver and whose main repository is at
> https://github.com/nasa-gibs/mrf . Recently I've worked with him to get
> the
> driver also integrated in the GDAL tree itself, and he merged back the
> changes
> in the above mentionned repository, so that both code base are now in sync.
> For the future, it would be convenient if Lucian could directly maintain
> the
> GDAL copy directly and keep in sync both repositories, so I motion to grant
> him commit rights. Lucian scope of interest also includes the WMS driver.
>
> I'll start the voting with:
>
> +1 Even
>
> Lucian,
> Please, could you answer to this message and state that you have
> read and agreed to the committer guidelines as outlined in the RFC3 (
> http://trac.osgeo.org/gdal/wiki/rfc3_commiters )
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev




-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160223/2bd516ad/attachment.html>

From warmerdam at pobox.com  Tue Feb 23 20:03:46 2016
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 23 Feb 2016 20:03:46 -0800
Subject: [gdal-dev] Motion: Committer Status for Lucian Plesea
In-Reply-To: <CACmBxytdq8OEBQh4ouCKkgU+qHGTfdS0cUSJQ8qiSUKR59_HJQ@mail.gmail.com>
References: <201602240110.32078.even.rouault@spatialys.com>
 <CACmBxytdq8OEBQh4ouCKkgU+qHGTfdS0cUSJQ8qiSUKR59_HJQ@mail.gmail.com>
Message-ID: <CA+YzLBdaYWWDPXYs5T3MvdJ8dd_FR9=vpvVeOcwMdjTTLPsb_Q@mail.gmail.com>

+1 Frank

Welcome aboard Lucien!


On Tue, Feb 23, 2016 at 4:42 PM, Kurt Schwehr <schwehr at gmail.com> wrote:
> +1 Kurt
>
> On Tue, Feb 23, 2016 at 4:10 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>>
>> Motion: Committer Status for Lucian Plesea
>> ---
>>
>> Dear PSC,
>>
>> Lucian is the maintainer of the MRF (Meta Raster Format) driver who has
>> existed as an out-of-tree driver and whose main repository is at
>> https://github.com/nasa-gibs/mrf . Recently I've worked with him to get
>> the
>> driver also integrated in the GDAL tree itself, and he merged back the
>> changes
>> in the above mentionned repository, so that both code base are now in
>> sync.
>> For the future, it would be convenient if Lucian could directly maintain
>> the
>> GDAL copy directly and keep in sync both repositories, so I motion to
>> grant
>> him commit rights. Lucian scope of interest also includes the WMS driver.
>>
>> I'll start the voting with:
>>
>> +1 Even
>>
>> Lucian,
>> Please, could you answer to this message and state that you have
>> read and agreed to the committer guidelines as outlined in the RFC3 (
>> http://trac.osgeo.org/gdal/wiki/rfc3_commiters )
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> --
> --
> http://schwehr.org
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam, warmerdam at pobox.com
light and sound - activate the windows | http://pobox.com/~warmerdam
and watch the world go round - Rush    | Geospatial Software Developer

From jukka.rahkonen at maanmittauslaitos.fi  Wed Feb 24 00:56:36 2016
From: jukka.rahkonen at maanmittauslaitos.fi (Jukka Rahkonen)
Date: Wed, 24 Feb 2016 08:56:36 +0000 (UTC)
Subject: [gdal-dev] Motion: Committer Status for Lucian Plesea
References: <201602240110.32078.even.rouault@spatialys.com>
 <CACmBxytdq8OEBQh4ouCKkgU+qHGTfdS0cUSJQ8qiSUKR59_HJQ@mail.gmail.com>
 <CA+YzLBdaYWWDPXYs5T3MvdJ8dd_FR9=vpvVeOcwMdjTTLPsb_Q@mail.gmail.com>
Message-ID: <loom.20160224T095604-365@post.gmane.org>

Frank Warmerdam <warmerdam <at> pobox.com> writes:

> 
> +1 Frank
> 
> Welcome aboard Lucien!

+1

-Jukka Rahkonen-


From dmorissette at mapgears.com  Wed Feb 24 00:59:48 2016
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 24 Feb 2016 03:59:48 -0500
Subject: [gdal-dev] Motion: Committer Status for Lucian Plesea
In-Reply-To: <201602240110.32078.even.rouault@spatialys.com>
References: <201602240110.32078.even.rouault@spatialys.com>
Message-ID: <56CD7104.4040806@mapgears.com>

+1

Daniel


On 2016-02-23 7:10 PM, Even Rouault wrote:
> Motion: Committer Status for Lucian Plesea
> ---
>
> Dear PSC,
>
> Lucian is the maintainer of the MRF (Meta Raster Format) driver who has
> existed as an out-of-tree driver and whose main repository is at
> https://github.com/nasa-gibs/mrf . Recently I've worked with him to get the
> driver also integrated in the GDAL tree itself, and he merged back the changes
> in the above mentionned repository, so that both code base are now in sync.
> For the future, it would be convenient if Lucian could directly maintain the
> GDAL copy directly and keep in sync both repositories, so I motion to grant
> him commit rights. Lucian scope of interest also includes the WMS driver.
>
> I'll start the voting with:
>
> +1 Even
>
> Lucian,
> Please, could you answer to this message and state that you have
> read and agreed to the committer guidelines as outlined in the RFC3 (
> http://trac.osgeo.org/gdal/wiki/rfc3_commiters )
>


-- 
Daniel Morissette
http://www.mapgears.com/
T: +1 418-696-5056 #201

http://evouala.com/ - Location Intelligence Made Easy

From kmrtnjscnc at gmail.com  Wed Feb 24 02:18:42 2016
From: kmrtnjscnc at gmail.com (Tanuj Kumar)
Date: Wed, 24 Feb 2016 15:48:42 +0530
Subject: [gdal-dev] New contributor
In-Reply-To: <CA+uDmDaKXBdy-d1gJ4_hJDHvPimNngMVGwE3or6BrJHBQg_tgg@mail.gmail.com>
References: <CA+uDmDYrv8z1D4W1e6p1BtPSk+fwNnJ9=SSz=DTAES6qDtJ-BQ@mail.gmail.com>
 <CA+uDmDaKXBdy-d1gJ4_hJDHvPimNngMVGwE3or6BrJHBQg_tgg@mail.gmail.com>
Message-ID: <CA+uDmDbPP8ZqESWUuNCUcez221vB5Sp5k-=yYQudpjD_CM0fmg@mail.gmail.com>

Hello, I'm Tanuj. I'd like to contribute to open source. I have absolutely
no prior experience to working for open source, and I'd like to start with
an easy bug. I know C++. Could someone please guide me on this?

Thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160224/883fa558/attachment.html>

From frank.broniewski at gmail.com  Wed Feb 24 04:28:05 2016
From: frank.broniewski at gmail.com (Frank Broniewski)
Date: Wed, 24 Feb 2016 13:28:05 +0100
Subject: [gdal-dev] osmconf.ini
In-Reply-To: <CAAHQ7wm9S-n07Szm--+kNQaDgPRzoXjMdyc8Akjw_VTeY4QdLA@mail.gmail.com>
References: <CAAHQ7wmm06-rSLQMKoJS2z1h+s+tLDmx8FpSmvWW9QioeCputQ@mail.gmail.com>
 <201602201618.57535.even.rouault@spatialys.com>
 <nabobb$lgu$2@ger.gmane.org>
 <CAAHQ7wm9S-n07Szm--+kNQaDgPRzoXjMdyc8Akjw_VTeY4QdLA@mail.gmail.com>
Message-ID: <CAAHQ7wkQR9Q7dAgF7r57iD7GQowa+RPvumCo+8o39z-z7Yw3gQ@mail.gmail.com>

Ok, I tested the ogrinfo example given by Even with my created excerpt, and
there seems to be no object with the ID 2827792. Now I wanted to try the
europe extract, which is the source of my own extracts, but ogrinfo gives
me lots of results where the -where clause does not fit. Any ideas? Here's
my command:

ogrinfo europe-2016-02-12T20-14-02Z.osm.pbf -where "osm_id = '2827792'"
-geom=no -al -q --config OSM_USE_CUSTOM_INDEXING NO --config
OGR_INTERLEAVED_READING YES

Some output snips:
[...]
  tunnel (String) = (null)
  maxspeed (String) = (null)
  ref (String) = (null)
  railway (String) = (null)
  width (String) = (null)
  other_tags (String) = (null)

OGRFeature(lines):4000402
  osm_id (String) = 4000402
  name (String) = (null)
  highway (String) = unclassified
  waterway (String) = (null)
  aerialway (String) = (null)
  barrier (String) = (null)
  man_made (String) = (null)
  oneway (String) = (null)
  bridge (String) = (null)
  tunnel (String) = (null)
  maxspeed (String) = (null)
  ref (String) = (null)
  railway (String) = (null)
  width (String) = (null)
  other_tags (String) = (null)

OGRFeature(lines):4000405
  osm_id (String) = 4000405
  name (String) = Post Mill Close
  highway (String) = residential
  waterway (String) = (null)
  aerialway (String) = (null)
  barrier (String) = (null)
  man_made (String) = (null)
  oneway (String) = (null)
  bridge (String) = (null)
  tunnel (String) = (null)
  maxspeed (String) = (null)
  ref (String) = (null)
  railway (String) = (null)
  width (String) = (null)
  other_tags (String) = (null)

OGRFeature(lines):4000406
  osm_id (String) = 4000406
  name (String) = Ashmere Grove
  highway (String) = residential
  waterway (String) = (null)
  aerialway (String) = (null)
  barrier (String) = (null)
  man_made (String) = (null)
  oneway (String) = (null)
[...]

I had to add the last config option because ogrinfo told me so ;)


2016-02-22 8:14 GMT+01:00 Frank Broniewski <frank.broniewski at gmail.com>:

> Mh, maybe I should have a look at my data. I downloaded a europe extract
> from geofabrik and used osmconvert and osmupdate to cut out a piece from
> europe and to update it. I am still sick, influenza caught me, but maybe in
> the afternoon I find some time to check wether there is something missing
> from my selfmade extract.
>
> 2016-02-21 8:02 GMT+01:00 Andre Joost <andre+joost at nurfuerspam.de>:
>
>> Am 20.02.2016 um 16:18 schrieb Even Rouault:
>>
>>> Frank,
>>>
>>> I clicked on the "Export" button on the view centered on
>>> http://www.openstreetmap.org/relation/2827792 , and ran
>>>
>>> $ ogrinfo ~/Téléchargements/map.osm multilinestrings \
>>>   -where "osm_id = '2827792'" -geom=no -al -q \
>>> --config OSM_USE_CUSTOM_INDEXING NO
>>>
>>
>>
>> Based on that, I get a shapefile of the route with
>>
>> ogr2ogr -overwrite route-export.shp map-export.osm  -where "osm_id =
>> '2827792'" -progress --config OSM_USE_CUSTOM_INDEXING NO -skipfailures
>>
>> HTH,
>> André Joost
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Waldhölzbacher Str.  51
> 66679  Losheim am See
> 06872 922 1051
> 0177 30 21 791
>
> [Ich bin auch bei XING und LinkedIn zu finden]
>



-- 
Waldhölzbacher Str.  51
66679  Losheim am See
06872 922 1051
0177 30 21 791

[Ich bin auch bei XING und LinkedIn zu finden]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160224/355ed474/attachment-0001.html>

From jvail at gmx.de  Wed Feb 24 09:00:41 2016
From: jvail at gmx.de (Jan Vaillant)
Date: Wed, 24 Feb 2016 18:00:41 +0100
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <201602240054.00200.even.rouault@spatialys.com>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com>
Message-ID: <56CDE1B9.1070407@gmx.de>

On 02/24/2016 12:53 AM, Even Rouault wrote:
> Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
>> Hi list,
>>
>> I am reading a zipped kml with gdal's libkml driver. I am trying to access
>> the name tag of the document:
>>
>> <kml>
>>    <Document>
>>      <name>a_name</name>
>
> I did a quick testing It appears that the driver will report a <name> as the
> layer name only if it inside a <Folder> tag, but not as a direct child of
> <Document>

Yes, thank you. I tried the kml driver as well and it stores the 
Document/name and makes it available with layer.getName().

Bye
Jan

From damian.dixon at gmail.com  Wed Feb 24 09:30:30 2016
From: damian.dixon at gmail.com (Damian Dixon)
Date: Wed, 24 Feb 2016 17:30:30 +0000
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <56CDE1B9.1070407@gmx.de>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com> <56CDE1B9.1070407@gmx.de>
Message-ID: <CAJjdW1xGvRTrXHon0Nmn-8YSqoFn_PFFEX48uasFpouO=gjd4w@mail.gmail.com>

Hi,

I've been meaning to submit a patch for awhile to libkml driver but have
not had time to do so.

The fix is a one line change highlighted below:


int OGRLIBKMLDataSource::OpenKml (
    const char *pszFilename,
    int bUpdate )
{
    std::string oKmlKml;
    char szBuffer[1024+1];

    VSILFILE* fp = VSIFOpenL(pszFilename, "rb");
    if (fp == NULL)
    {
        CPLError ( CE_Failure, CPLE_OpenFailed,
                   "Cannot open %s", pszFilename );
        return FALSE;
    }
    int nRead;
    while ((nRead = VSIFReadL(szBuffer, 1, 1024, fp)) != 0)
    {
        try
        {
            oKmlKml.append(szBuffer, nRead);
        }
        catch(std::bad_alloc& e)
        {
            VSIFCloseL(fp);
            return FALSE;
        }
    }
    OGRLIBKMLPreProcessInput(oKmlKml);
    VSIFCloseL(fp);

    CPLLocaleC  oLocaleForcer;

    /***** create a SRS *****/

    OGRSpatialReference *poOgrSRS =
        new OGRSpatialReference ( OGRLIBKMLSRSWKT );

    /***** parse the kml into the DOM *****/

    std::string oKmlErrors;

    ElementPtr poKmlRoot = kmldom::Parse ( oKmlKml, &oKmlErrors );

    if ( !poKmlRoot ) {
        CPLError ( CE_Failure, CPLE_OpenFailed,
                   "ERROR Parseing kml %s :%s",
                   pszFilename, oKmlErrors.c_str (  ) );
        delete poOgrSRS;

        return FALSE;
    }

    /***** get the container from root  *****/

    if ( !( m_poKmlDSContainer = GetContainerFromRoot ( m_poKmlFactory,
poKmlRoot ) ) ) {
        CPLError ( CE_Failure, CPLE_OpenFailed,
                   "ERROR Parseing kml %s :%s %s",
                   pszFilename, "This file does not fit the OGR model,",
                   "there is no container element at the root." );
        delete poOgrSRS;

        return FALSE;
    }

    m_isKml = TRUE;

    /***** get the styles *****/

    ParseStyles ( AsDocument ( m_poKmlDSContainer ), &m_poStyleTable );

    /***** parse for layers *****/

    int nPlacemarks = ParseLayers ( m_poKmlDSContainer, poOgrSRS );

    /***** if there is placemarks in the root its a layer *****/

*    if ( nPlacemarks ) {*   //
<------------------------------------------------------------------------------------------This
line
        AddLayer ( CPLGetBasename ( pszFilename ),
                   poOgrSRS, wkbUnknown,
                   this, poKmlRoot, m_poKmlDSContainer, pszFilename, FALSE,
bUpdate, 1 );
    }

    delete poOgrSRS;

    return TRUE;
}

Regards
Damian

On 24 February 2016 at 17:00, Jan Vaillant <jvail at gmx.de> wrote:

> On 02/24/2016 12:53 AM, Even Rouault wrote:
>
>> Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
>>
>>> Hi list,
>>>
>>> I am reading a zipped kml with gdal's libkml driver. I am trying to
>>> access
>>> the name tag of the document:
>>>
>>> <kml>
>>>    <Document>
>>>      <name>a_name</name>
>>>
>>
>> I did a quick testing It appears that the driver will report a <name> as
>> the
>> layer name only if it inside a <Folder> tag, but not as a direct child of
>> <Document>
>>
>
> Yes, thank you. I tried the kml driver as well and it stores the
> Document/name and makes it available with layer.getName().
>
> Bye
>
> Jan
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160224/91c97d00/attachment.html>

From jvail at gmx.de  Wed Feb 24 10:34:42 2016
From: jvail at gmx.de (Jan Vaillant)
Date: Wed, 24 Feb 2016 19:34:42 +0100
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <CAJjdW1xGvRTrXHon0Nmn-8YSqoFn_PFFEX48uasFpouO=gjd4w@mail.gmail.com>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com> <56CDE1B9.1070407@gmx.de>
 <CAJjdW1xGvRTrXHon0Nmn-8YSqoFn_PFFEX48uasFpouO=gjd4w@mail.gmail.com>
Message-ID: <56CDF7C2.3020201@gmx.de>

On 02/24/2016 06:30 PM, Damian Dixon wrote:
> Hi,
>
> I've been meaning to submit a patch for awhile to libkml driver but have
> not had time to do so.
>
> The fix is a one line change highlighted below:
>

Great! Thank you. I'll give it a try.

Jan

> int OGRLIBKMLDataSource::OpenKml (
>      const char *pszFilename,
>      int bUpdate )
> {
>      std::string oKmlKml;
>      char szBuffer[1024+1];
>
>      VSILFILE* fp = VSIFOpenL(pszFilename, "rb");
>      if (fp == NULL)
>      {
>          CPLError ( CE_Failure, CPLE_OpenFailed,
>                     "Cannot open %s", pszFilename );
>          return FALSE;
>      }
>      int nRead;
>      while ((nRead = VSIFReadL(szBuffer, 1, 1024, fp)) != 0)
>      {
>          try
>          {
>              oKmlKml.append(szBuffer, nRead);
>          }
>          catch(std::bad_alloc& e)
>          {
>              VSIFCloseL(fp);
>              return FALSE;
>          }
>      }
>      OGRLIBKMLPreProcessInput(oKmlKml);
>      VSIFCloseL(fp);
>
>      CPLLocaleC  oLocaleForcer;
>
>      /***** create a SRS *****/
>
>      OGRSpatialReference *poOgrSRS =
>          new OGRSpatialReference ( OGRLIBKMLSRSWKT );
>
>      /***** parse the kml into the DOM *****/
>
>      std::string oKmlErrors;
>
>      ElementPtr poKmlRoot = kmldom::Parse ( oKmlKml, &oKmlErrors );
>
>      if ( !poKmlRoot ) {
>          CPLError ( CE_Failure, CPLE_OpenFailed,
>                     "ERROR Parseing kml %s :%s",
>                     pszFilename, oKmlErrors.c_str (  ) );
>          delete poOgrSRS;
>
>          return FALSE;
>      }
>
>      /***** get the container from root  *****/
>
>      if ( !( m_poKmlDSContainer = GetContainerFromRoot ( m_poKmlFactory,
> poKmlRoot ) ) ) {
>          CPLError ( CE_Failure, CPLE_OpenFailed,
>                     "ERROR Parseing kml %s :%s %s",
>                     pszFilename, "This file does not fit the OGR model,",
>                     "there is no container element at the root." );
>          delete poOgrSRS;
>
>          return FALSE;
>      }
>
>      m_isKml = TRUE;
>
>      /***** get the styles *****/
>
>      ParseStyles ( AsDocument ( m_poKmlDSContainer ), &m_poStyleTable );
>
>      /***** parse for layers *****/
>
>      int nPlacemarks = ParseLayers ( m_poKmlDSContainer, poOgrSRS );
>
>      /***** if there is placemarks in the root its a layer *****/
>
> *    if ( nPlacemarks ) {*   //
> <------------------------------------------------------------------------------------------This
> line
>          AddLayer ( CPLGetBasename ( pszFilename ),
>                     poOgrSRS, wkbUnknown,
>                     this, poKmlRoot, m_poKmlDSContainer, pszFilename, FALSE,
> bUpdate, 1 );
>      }
>
>      delete poOgrSRS;
>
>      return TRUE;
> }
>
> Regards
> Damian
>
> On 24 February 2016 at 17:00, Jan Vaillant <jvail at gmx.de> wrote:
>
>> On 02/24/2016 12:53 AM, Even Rouault wrote:
>>
>>> Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
>>>
>>>> Hi list,
>>>>
>>>> I am reading a zipped kml with gdal's libkml driver. I am trying to
>>>> access
>>>> the name tag of the document:
>>>>
>>>> <kml>
>>>>     <Document>
>>>>       <name>a_name</name>
>>>>
>>>
>>> I did a quick testing It appears that the driver will report a <name> as
>>> the
>>> layer name only if it inside a <Folder> tag, but not as a direct child of
>>> <Document>
>>>
>>
>> Yes, thank you. I tried the kml driver as well and it stores the
>> Document/name and makes it available with layer.getName().
>>
>> Bye
>>
>> Jan
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>

From mohammedrashadkm at gmail.com  Thu Feb 25 00:47:01 2016
From: mohammedrashadkm at gmail.com (Rashad Kanavath)
Date: Thu, 25 Feb 2016 14:17:01 +0530
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <201602240054.00200.even.rouault@spatialys.com>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com>
Message-ID: <CANNqv9d_sRyKuf13j+85Mvn4eL6x7bkKKtBXBb++ET2EJRLvng@mail.gmail.com>

Hello Even,

On Wed, Feb 24, 2016 at 5:23 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
> > Hi list,
> >
> > I am reading a zipped kml with gdal's libkml driver. I am trying to
> access
> > the name tag of the document:
> >
> > <kml>
> >   <Document>
> >     <name>a_name</name>
>
> I did a quick testing It appears that the driver will report a <name> as
> the
> layer name only if it inside a <Folder> tag, but not as a direct child of
> <Document>
>

I am wondering if this could this be fixed in the upstream?

>
> > ...
> >
> > If I look at the source code I can see a way to set those options here
> for
> > writing kml
> >
> > void OGRLIBKMLDataSource::SetCommonOptions(ContainerPtr poKmlContainer,
> >                                            char** papszOptions)
> > {
> >     const char* pszName = CSLFetchNameValue(papszOptions, "NAME");
> >     if( pszName != NULL )
> >         poKmlContainer->set_name(pszName);
> > ...
> >
> > but I cant find a way to read the options. ogrLayer->GetName() returns
> the
> > file name not the <name>a_name</name> element. Any ideas?
> >
> > Thank you
> > Jan
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Regards,
   Rashad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160225/b2f635b9/attachment.html>

From even.rouault at spatialys.com  Thu Feb 25 01:14:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 25 Feb 2016 10:14:26 +0100
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <CANNqv9d_sRyKuf13j+85Mvn4eL6x7bkKKtBXBb++ET2EJRLvng@mail.gmail.com>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com>
 <CANNqv9d_sRyKuf13j+85Mvn4eL6x7bkKKtBXBb++ET2EJRLvng@mail.gmail.com>
Message-ID: <4967092.xcGg2Rk07T@even-n550jk>

On Thursday 25 February 2016 14:17:01 Rashad Kanavath wrote:
> Hello Even,
> 
> On Wed, Feb 24, 2016 at 5:23 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
> > > Hi list,
> > > 
> > > I am reading a zipped kml with gdal's libkml driver. I am trying to
> > 
> > access
> > 
> > > the name tag of the document:
> > > 
> > > <kml>
> > > 
> > >   <Document>
> > >   
> > >     <name>a_name</name>
> > 
> > I did a quick testing It appears that the driver will report a <name> as
> > the
> > layer name only if it inside a <Folder> tag, but not as a direct child of
> > <Document>
> 
> I am wondering if this could this be fixed in the upstream?

Sure that would be desirable. Anyone wants to create a ticket with a patch to 
fix that ? Preferably with a new test in autotest/ogr/ogr_libkml.py


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Thu Feb 25 05:26:03 2016
From: a.neumann at carto.net (Neumann, Andreas)
Date: Thu, 25 Feb 2016 14:26:03 +0100
Subject: [gdal-dev] gdalwarp and gdaladdo in multi-threaded mode
Message-ID: <093772f0d2470d0920d9b120a14a5d96@carto.net>

Hi, 

I noticed that in GDAL >2.0 some utilities and operations support
multi-threaded calculations, such as the gdalwarp utility. I tested it
and it seems to work well. I can see that multiple CPU cores are busy. 

Question 1: in gdalwarp there are at least two ways to tell that it
should use more than one CPU: 

-multi 

and 

-wo NUM_THREADS=ALL_CPUS or a nr of cores 

Are these two flags redudant? Is either one enough or should I specify
both? 

Question 2: can I also speed up the gdaladdo utility? 

Thank you for your replies! 

Andreas

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160225/0ea113dc/attachment.html>

From mohammedrashadkm at gmail.com  Thu Feb 25 05:42:14 2016
From: mohammedrashadkm at gmail.com (Rashad Kanavath)
Date: Thu, 25 Feb 2016 19:12:14 +0530
Subject: [gdal-dev] libkml driver get document name
In-Reply-To: <4967092.xcGg2Rk07T@even-n550jk>
References: <trinity-e4ac9160-3ac6-4e18-8c2a-3efd3f5c2c96-1456235434991@3capp-gmx-bs59>
 <201602240054.00200.even.rouault@spatialys.com>
 <CANNqv9d_sRyKuf13j+85Mvn4eL6x7bkKKtBXBb++ET2EJRLvng@mail.gmail.com>
 <4967092.xcGg2Rk07T@even-n550jk>
Message-ID: <CANNqv9eeu5Rgu_9UQpFV7j9HSkioLMYZC9qx==iu4bkMe8RGEg@mail.gmail.com>

On Thu, Feb 25, 2016 at 2:44 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On Thursday 25 February 2016 14:17:01 Rashad Kanavath wrote:
> > Hello Even,
> >
> > On Wed, Feb 24, 2016 at 5:23 AM, Even Rouault <
> even.rouault at spatialys.com>
> >
> > wrote:
> > > Le mardi 23 février 2016 14:50:35, jan vaillant a écrit :
> > > > Hi list,
> > > >
> > > > I am reading a zipped kml with gdal's libkml driver. I am trying to
> > >
> > > access
> > >
> > > > the name tag of the document:
> > > >
> > > > <kml>
> > > >
> > > >   <Document>
> > > >
> > > >     <name>a_name</name>
> > >
> > > I did a quick testing It appears that the driver will report a <name>
> as
> > > the
> > > layer name only if it inside a <Folder> tag, but not as a direct child
> of
> > > <Document>
> >
> > I am wondering if this could this be fixed in the upstream?
>
> Sure that would be desirable. Anyone wants to create a ticket with a patch
> to
> fix that ? Preferably with a new test in autotest/ogr/ogr_libkml.py
>

I am interested to provide a patch. I will fix this in upstream and then
attach a patch on gdal's trac.

>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>



-- 
Regards,
   Rashad
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160225/0430d9c9/attachment.html>

From a.neumann at carto.net  Thu Feb 25 05:46:15 2016
From: a.neumann at carto.net (Neumann, Andreas)
Date: Thu, 25 Feb 2016 14:46:15 +0100
Subject: [gdal-dev] Reprojecting orthoimages and transparent borders
Message-ID: <8f664e701ef9aa0d9a036a0525f5e06c@carto.net>

Hi, 

When reprojecting RGB orthoimages with gdalwarp from one projection
system into another, there is often rotation involved and thus there
will be black pixels around the borders. My target format is TIFF with
JPEG compression. 

Is there a way to tell gdalwarp to set these nodata pixels transparent? 

I tried using -dstalpha but gdalwarp tells me this is incompatible with
"-co PHOTOMETRIC=YCBCR", becauses this only supports 3 bands. 

Thank you if you have any idea if there is some setting for RGB Geotiff
files to set nodata pixels to transparent. 

Andreas

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160225/6ca50844/attachment.html>

From a.neumann at carto.net  Thu Feb 25 05:53:08 2016
From: a.neumann at carto.net (Neumann, Andreas)
Date: Thu, 25 Feb 2016 14:53:08 +0100
Subject: [gdal-dev] gdalwarp and the -wm switch
Message-ID: <b798e6b1f61d225a50101070602da868@carto.net>

Hi, 

I wonder if there are any recommendations regarding the 

-wm _memory_in_mb setting._ 

Should I use this setting or just ignore it? My machines usually have
plenty of RAM. Do I have to increase this value if I want to utilize the
available RAM or is this done automatically and this settings exists to
restrict the used amoung of RAM? 

I am just trying to understand what this setting means. What is the
default value for this setting if not set? 

Thanks, 

Andreas

  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160225/9bbe575a/attachment.html>

From mateusz at loskot.net  Fri Feb 26 03:37:35 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 26 Feb 2016 12:37:35 +0100
Subject: [gdal-dev] GSoC: JSON Text Sequences for GeoJSO
Message-ID: <CABUeae8T3-iZRMLmVSp660Wq1FPaymmqNayH9Z0T2pMGAWLSdw@mail.gmail.com>

Hi,

For students interested in GDAL GSoC, I have added
an idea to the wiki [1] about implementing
JSON Text Sequences support for GeoJSON driver

[1] http://trac.osgeo.org/gdal/wiki/SummerOfCode

Best regards,
-- 
Mateusz Łoskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Fri Feb 26 10:39:47 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 26 Feb 2016 19:39:47 +0100
Subject: [gdal-dev] Reprojecting orthoimages and transparent borders
In-Reply-To: <8f664e701ef9aa0d9a036a0525f5e06c@carto.net>
References: <8f664e701ef9aa0d9a036a0525f5e06c@carto.net>
Message-ID: <201602261939.48193.even.rouault@spatialys.com>

Le jeudi 25 février 2016 14:46:15, Neumann, Andreas a écrit :
> Hi,
> 
> When reprojecting RGB orthoimages with gdalwarp from one projection
> system into another, there is often rotation involved and thus there
> will be black pixels around the borders. My target format is TIFF with
> JPEG compression.
> 
> Is there a way to tell gdalwarp to set these nodata pixels transparent?
> 
> I tried using -dstalpha but gdalwarp tells me this is incompatible with
> "-co PHOTOMETRIC=YCBCR", becauses this only supports 3 bands.
> 
> Thank you if you have any idea if there is some setting for RGB Geotiff
> files to set nodata pixels to transparent.

1) To get the smaller file size / best quality, you should consider doing a
gdal_translate after gdalwarp (and the gdalwarp using no compression or a lossless compression). See 
https://trac.osgeo.org/gdal/wiki/UserDocs/GdalWarp#GeoTIFFoutput-coCOMPRESSisbroken

2) There's no real convenient well supported way to have proper transparency and
JPEG compression. You could try setting nodata, but due to JPEG compression, you'll
have artifacts at the border between the area with valid pixels and the padding.
Another option would be to convert from RGBA to RGB+mask with
gdal_translate in_rgba.tif out_rgb_with_mask.tif -co compress=jpeg -co photometric=ycbcr -b 1 -b 2 -b 3 -mask 4 --config GDAL_TIFF_INTERNAL_MASK YES
so as to have JPEG compression for RGB and a DEFLATE compressed mask. But
masks such like that that are not alpha bands are not widely supported outside of
GDAL itself (MapServer supports that). This may be workarounded by using a VRT though.
See 
http://download.osgeo.org/gdal/workshop/foss4ge2015/workshop_gdal.html#__RefHeading__5975_1333016408


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From thebengrimm at gmail.com  Fri Feb 26 10:39:26 2016
From: thebengrimm at gmail.com (Christopher Schierkolk)
Date: Fri, 26 Feb 2016 13:39:26 -0500
Subject: [gdal-dev] HFA Attribute Table Class Names
Message-ID: <CAOhMuNAC1fyOJqNEirqo1Pm0poeBAWeHp=oAiQN3YK==D6WLbQ@mail.gmail.com>

Does GDAL interpret HFA attributes beyond COLOR,RED,GREEN,BLUE,OPACITY and
HISTOGRAM ? I have some thematic files with a CLASS_NAMES attribute. I am
using GDAL_TRANSLATE to subset files.  Every attribute will copy over
except the CLASS_NAMES attribute. I read some previous threads but did not
find a concrete answer.


Chris Schierkolk
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160226/184fb03a/attachment.html>

From even.rouault at spatialys.com  Fri Feb 26 10:43:08 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 26 Feb 2016 19:43:08 +0100
Subject: [gdal-dev] gdalwarp and gdaladdo in multi-threaded mode
In-Reply-To: <093772f0d2470d0920d9b120a14a5d96@carto.net>
References: <093772f0d2470d0920d9b120a14a5d96@carto.net>
Message-ID: <201602261943.08908.even.rouault@spatialys.com>

Le jeudi 25 février 2016 14:26:03, Neumann, Andreas a écrit :
> Hi,
> 
> I noticed that in GDAL >2.0 some utilities and operations support
> multi-threaded calculations, such as the gdalwarp utility. I tested it
> and it seems to work well. I can see that multiple CPU cores are busy.
> 
> Question 1: in gdalwarp there are at least two ways to tell that it
> should use more than one CPU:
> 
> -multi

This parallelizes I/O and CPU operations. 

> 
> and
> 
> -wo NUM_THREADS=ALL_CPUS or a nr of cores

This parallelizes CPU operations over several cores.

> 
> Are these two flags redudant? Is either one enough or should I specify
> both?

Both are independant and can be combined.

> 
> Question 2: can I also speed up the gdaladdo utility?

Not as directly as above, but increasing GDAL_CACHEMAX may help for big 
rasters.

> 
> Thank you for your replies!
> 
> Andreas

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From SGONG at mdacorporation.com  Fri Feb 26 10:56:54 2016
From: SGONG at mdacorporation.com (Shawn Gong)
Date: Fri, 26 Feb 2016 18:56:54 +0000
Subject: [gdal-dev] COSMO-Skymed RPCs
Message-ID: <7DCBC135929FF74E8A5488B1814AC6BC36B90496@exbermd02.ds.mda.ca>

Hi list,



I am looking for ways to access/extract COSMO-Skymed rational polynomial coefficients (RPCs). The objective is to georeference a small chip within CSK.


ds=gdal.Open("CSKS1_SCS_B_S2_24_HH_RA_FF_20150813071015_20150813071023.h5")
ds.GetMetadata().keys() = ['S01_Reference_Dechirping_Time', 'S01_SBI_Equivalent_Number_of_Looks', 'Doppler
_Rate_vs_Range_Time_Polynomial', ...]
The above list doesn't seem to contain any RPCs



Would some one please tell me how?


Thanks,
Shawn
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160226/0055de99/attachment.html>

From LPlesea at esri.com  Fri Feb 26 11:28:10 2016
From: LPlesea at esri.com (Lucian Plesea)
Date: Fri, 26 Feb 2016 19:28:10 +0000
Subject: [gdal-dev] Motion: Committer Status for  Lucian Plesea
References: <201602240110.32078.even.rouault@spatialys.com> 
Message-ID: <60991DFA70F91B4DB33EE67602D50FB0DEF674F6@RED-INF-EXMB-P1.esri.com>

I have read and agree with the GDAL Commiter Guidelines as described in RFC 3.

Lucian Plesea

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Tuesday, February 23, 2016 4:11 PM
To: gdal-dev at lists.osgeo.org
Cc: Lucian Plesea
Subject: Motion: Committer Status for Lucian Plesea

Motion: Committer Status for Lucian Plesea
---

Dear PSC,

Lucian is the maintainer of the MRF (Meta Raster Format) driver who has existed as an out-of-tree driver and whose main repository is at https://urldefense.proofpoint.com/v2/url?u=https-3A__github.com_nasa-2Dgibs_mrf&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZCPdMt_gpID_yQ&m=Il0EnkNWOsCVmmqN8Fu6XlYbBMm947VVVWFcjnyAysQ&s=Gb8COwoQ9vzf0CUXc7T6tvkhwE7KDHSYa08YLmjrnn4&e=  . Recently I've worked with him to get the driver also integrated in the GDAL tree itself, and he merged back the changes in the above mentionned repository, so that both code base are now in sync. 
For the future, it would be convenient if Lucian could directly maintain the GDAL copy directly and keep in sync both repositories, so I motion to grant him commit rights. Lucian scope of interest also includes the WMS driver.

I'll start the voting with:

+1 Even

Lucian,
Please, could you answer to this message and state that you have read and agreed to the committer guidelines as outlined in the RFC3 ( https://urldefense.proofpoint.com/v2/url?u=http-3A__trac.osgeo.org_gdal_wiki_rfc3-5Fcommiters&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZCPdMt_gpID_yQ&m=Il0EnkNWOsCVmmqN8Fu6XlYbBMm947VVVWFcjnyAysQ&s=KPHsixO7AGmSKOdRg4c2dT1cDaEESLLkBsL6tafcgNk&e=  )

--
Spatialys - Geospatial professional services https://urldefense.proofpoint.com/v2/url?u=http-3A__www.spatialys.com&d=CwICAg&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZCPdMt_gpID_yQ&m=Il0EnkNWOsCVmmqN8Fu6XlYbBMm947VVVWFcjnyAysQ&s=vFx-m46fnobNf3moe3KNVQJf6Y1_oxtjH51GhbqgCXM&e= 

From even.rouault at spatialys.com  Fri Feb 26 11:41:32 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 26 Feb 2016 20:41:32 +0100
Subject: [gdal-dev] Motion: Committer Status for  Lucian Plesea
In-Reply-To: <201602240110.32078.even.rouault@spatialys.com>
References: <201602240110.32078.even.rouault@spatialys.com>
Message-ID: <201602262041.32673.even.rouault@spatialys.com>

Le mercredi 24 février 2016 01:10:31, Even Rouault a écrit :
> Motion: Committer Status for Lucian Plesea

I declare this motion passed with +1 from KurtS, FrankW, JukkaR, DanielM and 
myself.

Lucian, I've just granted you commit rights. To check that it works, could you 
add yourself to the COMMITERS file at the root of gdal/ ?

> ---
> 
> Dear PSC,
> 
> Lucian is the maintainer of the MRF (Meta Raster Format) driver who has
> existed as an out-of-tree driver and whose main repository is at
> https://github.com/nasa-gibs/mrf . Recently I've worked with him to get the
> driver also integrated in the GDAL tree itself, and he merged back the
> changes in the above mentionned repository, so that both code base are now
> in sync. For the future, it would be convenient if Lucian could directly
> maintain the GDAL copy directly and keep in sync both repositories, so I
> motion to grant him commit rights. Lucian scope of interest also includes
> the WMS driver.
> 
> I'll start the voting with:
> 
> +1 Even
> 
> Lucian,
> Please, could you answer to this message and state that you have
> read and agreed to the committer guidelines as outlined in the RFC3 (
> http://trac.osgeo.org/gdal/wiki/rfc3_commiters )

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From LPlesea at esri.com  Fri Feb 26 12:30:42 2016
From: LPlesea at esri.com (Lucian Plesea)
Date: Fri, 26 Feb 2016 20:30:42 +0000
Subject: [gdal-dev] Motion: Committer Status for  Lucian Plesea
In-Reply-To: <201602262041.32673.even.rouault@spatialys.com>
References: <201602240110.32078.even.rouault@spatialys.com>
 <201602262041.32673.even.rouault@spatialys.com>
Message-ID: <60991DFA70F91B4DB33EE67602D50FB0DEF67542@RED-INF-EXMB-P1.esri.com>

Thanks, it worked!

Lucian

-----Original Message-----
From: Even Rouault [mailto:even.rouault at spatialys.com] 
Sent: Friday, February 26, 2016 11:42 AM
To: gdal-dev at lists.osgeo.org
Cc: Lucian Plesea
Subject: Re: [gdal-dev] Motion: Committer Status for Lucian Plesea

Le mercredi 24 février 2016 01:10:31, Even Rouault a écrit :
> Motion: Committer Status for Lucian Plesea

I declare this motion passed with +1 from KurtS, FrankW, JukkaR, DanielM and myself.

Lucian, I've just granted you commit rights. To check that it works, could you add yourself to the COMMITERS file at the root of gdal/ ?

> ---
> 
> Dear PSC,
> 
> Lucian is the maintainer of the MRF (Meta Raster Format) driver who 
> has existed as an out-of-tree driver and whose main repository is at 
> https://urldefense.proofpoint.com/v2/url?u=https-3A__github.com_nasa-2
> Dgibs_mrf&d=CwIFaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZCPdMt_gpID_yQ&m
> =U35-EL9da2D88Q1ivdtgy41dmOuKjNtOfujc4BzIhQs&s=YzUEOY-QH-dTiTVIhrKFONY
> dAH8DR3pK0QU24FQFEZQ&e=  . Recently I've worked with him to get the 
> driver also integrated in the GDAL tree itself, and he merged back the 
> changes in the above mentionned repository, so that both code base are 
> now in sync. For the future, it would be convenient if Lucian could directly maintain the GDAL copy directly and keep in sync both repositories, so I motion to grant him commit rights. Lucian scope of interest also includes the WMS driver.
> 
> I'll start the voting with:
> 
> +1 Even
> 
> Lucian,
> Please, could you answer to this message and state that you have read 
> and agreed to the committer guidelines as outlined in the RFC3 ( 
> https://urldefense.proofpoint.com/v2/url?u=http-3A__trac.osgeo.org_gda
> l_wiki_rfc3-5Fcommiters&d=CwIFaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZC
> PdMt_gpID_yQ&m=U35-EL9da2D88Q1ivdtgy41dmOuKjNtOfujc4BzIhQs&s=WAhc98qI0
> 6a7hMEvJm_DuvgxZR-JNHfqW4JT4awnWwc&e=  )

--
Spatialys - Geospatial professional services https://urldefense.proofpoint.com/v2/url?u=http-3A__www.spatialys.com&d=CwIFaQ&c=n6-cguzQvX_tUIrZOS_4Og&r=ZN_tL2S6ZCPdMt_gpID_yQ&m=U35-EL9da2D88Q1ivdtgy41dmOuKjNtOfujc4BzIhQs&s=7C0UEua9fFJk8x_ktluIxZ3TtMq16TNVHrYUYnMC8Jo&e= 

From sean at mapbox.com  Fri Feb 26 13:14:30 2016
From: sean at mapbox.com (Sean Gillies)
Date: Fri, 26 Feb 2016 14:14:30 -0700
Subject: [gdal-dev] GSoC: JSON Text Sequences for GeoJSO
In-Reply-To: <CABUeae8T3-iZRMLmVSp660Wq1FPaymmqNayH9Z0T2pMGAWLSdw@mail.gmail.com>
References: <CABUeae8T3-iZRMLmVSp660Wq1FPaymmqNayH9Z0T2pMGAWLSdw@mail.gmail.com>
Message-ID: <CADPhZXwQ31rOtpFqFBOgiOuGOdQ=GypujfTTz3tGb6JLJvzbuA@mail.gmail.com>

On Fri, Feb 26, 2016 at 4:37 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> Hi,
>
> For students interested in GDAL GSoC, I have added
> an idea to the wiki [1] about implementing
> JSON Text Sequences support for GeoJSON driver
>
> [1] http://trac.osgeo.org/gdal/wiki/SummerOfCode
>
> Best regards,
>

Hi Mateusz,

Make sure to get involved with the IETF GeoJSON WG, we're taking up GeoJSON
feature sequences soon.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160226/20814fc5/attachment.html>

From mateusz at loskot.net  Sun Feb 28 07:07:59 2016
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 28 Feb 2016 16:07:59 +0100
Subject: [gdal-dev] GSoC: JSON Text Sequences for GeoJSO
In-Reply-To: <CADPhZXwQ31rOtpFqFBOgiOuGOdQ=GypujfTTz3tGb6JLJvzbuA@mail.gmail.com>
References: <CABUeae8T3-iZRMLmVSp660Wq1FPaymmqNayH9Z0T2pMGAWLSdw@mail.gmail.com>
 <CADPhZXwQ31rOtpFqFBOgiOuGOdQ=GypujfTTz3tGb6JLJvzbuA@mail.gmail.com>
Message-ID: <CABUeae8U8gGGZBwsfpOEkUNY+=e+GVYGBFbyw20Zxf87G8XP4w@mail.gmail.com>

On 26 Feb 2016 22:15, "Sean Gillies" <sean at mapbox.com> wrote:
>
> On Fri, Feb 26, 2016 at 4:37 AM, Mateusz Loskot <mateusz at loskot.net>
wrote:
>>
>> Hi,
>>
>> For students interested in GDAL GSoC, I have added
>> an idea to the wiki [1] about implementing
>> JSON Text Sequences support for GeoJSON driver
>>
>> [1] http://trac.osgeo.org/gdal/wiki/SummerOfCode
>>
>> Best regards,
>
>
> Hi Mateusz,
>
> Make sure to get involved with the IETF GeoJSON WG, we're taking up
GeoJSON feature sequences soon.

I'm sure there's enough more competent contributors already involved.

Mateusz Łoskot
(Sent from mobile)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160228/9ff3e289/attachment.html>

From jamessramm at gmail.com  Mon Feb 29 03:19:35 2016
From: jamessramm at gmail.com (jramm)
Date: Mon, 29 Feb 2016 03:19:35 -0800 (PST)
Subject: [gdal-dev] Standard GDAL format for HDF5?
Message-ID: <1456744775510-5253334.post@n6.nabble.com>

I was wondering if there would be any interest in a standard GDAL format for
HDF5 files?

The major problem I have with current formats supported by the HDF5 driver
is that they are very application-specific, with requirements on the
structure of groups and group names. 

What I propose would make no assumptions about the file grouping structure,
but require that some attributes are set on the dataset itself:

- Geotransform
- Projection
- NoDataValue

To read a certain dataset, you would pass the driver the 'posix style' path
to the dataset (as per HDF5 docs). I'm not sure how this would fit with the
driver, but perhaps something similar that is done for postgres  (i.e. all
in one string then the elements parsed out):

"/My/Path/To/file.hdf5/path/to/dataset"

This would allow any file structure and for multiple datasets within a file
to support different projections, geotransforms etc etc

Any thoughts?




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Standard-GDAL-format-for-HDF5-tp5253334.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From andre.vautour at caris.com  Mon Feb 29 05:33:28 2016
From: andre.vautour at caris.com (Andre Vautour)
Date: Mon, 29 Feb 2016 09:33:28 -0400
Subject: [gdal-dev] Feature ID propagation in SQLite data source
Message-ID: <56D448A8.5080505@caris.com>

Hi all,

When I execute an SQL query on a SQLite source, I am observing that the 
feature identifiers are changing. This was observed using 1.11.1.

ogrinfo -geom=NO -fid 1227 test2.sqlite
OGRFeature(roads):1227
   gml_id (String) = Roads.371c00000011070000000046
   arc_flag (String) = T
   line_compilation_status (String) = BACKGROUND
   contour_height (Real) = (null)
   line_description (String) = (null)
   line_feature_code (String) = RRARDUR
   line_key (String) = RD6091
   length (Real) = 253.400783404
   num_points (Real) = 42
   line_source_id (String) = USL
   line_theme_number (Real) = 20100
   line_user_number (Real) = 20100

ogrinfo -geom=NO -sql "select * from roads where length = 253.400783404" 
-dialect sqlite test2.sqlite
OGRFeature(SELECT):0
   gml_id (String) = Roads.371c00000011070000000046
   arc_flag (String) = T
   line_compilation_status (String) = BACKGROUND
   contour_height (Real) = (null)
   line_description (String) = (null)
   line_feature_code (String) = RRARDUR
   line_key (String) = RD6091
   length (Real) = 253.400783404
   num_points (Real) = 42
   line_source_id (String) = USL
   line_theme_number (Real) = 20100
   line_user_number (Real) = 20100

Shouldn't the ID of the feature remain unchanged instead of going from 
the original 1227 to 0?

Thanks,
André

From even.rouault at spatialys.com  Mon Feb 29 05:54:26 2016
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 29 Feb 2016 14:54:26 +0100
Subject: [gdal-dev] Feature ID propagation in SQLite data source
In-Reply-To: <56D448A8.5080505@caris.com>
References: <56D448A8.5080505@caris.com>
Message-ID: <201602291454.27243.even.rouault@spatialys.com>

Le lundi 29 février 2016 14:33:28, Andre Vautour a écrit :
> Hi all,
> 
> When I execute an SQL query on a SQLite source, I am observing that the
> feature identifiers are changing. This was observed using 1.11.1.

See https://trac.osgeo.org/gdal/ticket/5781

> 
> ogrinfo -geom=NO -fid 1227 test2.sqlite
> OGRFeature(roads):1227
>    gml_id (String) = Roads.371c00000011070000000046
>    arc_flag (String) = T
>    line_compilation_status (String) = BACKGROUND
>    contour_height (Real) = (null)
>    line_description (String) = (null)
>    line_feature_code (String) = RRARDUR
>    line_key (String) = RD6091
>    length (Real) = 253.400783404
>    num_points (Real) = 42
>    line_source_id (String) = USL
>    line_theme_number (Real) = 20100
>    line_user_number (Real) = 20100
> 
> ogrinfo -geom=NO -sql "select * from roads where length = 253.400783404"
> -dialect sqlite test2.sqlite
> OGRFeature(SELECT):0
>    gml_id (String) = Roads.371c00000011070000000046
>    arc_flag (String) = T
>    line_compilation_status (String) = BACKGROUND
>    contour_height (Real) = (null)
>    line_description (String) = (null)
>    line_feature_code (String) = RRARDUR
>    line_key (String) = RD6091
>    length (Real) = 253.400783404
>    num_points (Real) = 42
>    line_source_id (String) = USL
>    line_theme_number (Real) = 20100
>    line_user_number (Real) = 20100
> 
> Shouldn't the ID of the feature remain unchanged instead of going from
> the original 1227 to 0?
> 
> Thanks,
> André
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Mon Feb 29 13:19:03 2016
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 29 Feb 2016 14:19:03 -0700
Subject: [gdal-dev] GDAL 2.1 release plans
In-Reply-To: <201601151511.48676.even.rouault@spatialys.com>
References: <201601151511.48676.even.rouault@spatialys.com>
Message-ID: <CADPhZXyo0U6CNU5-iPYP1bODrzSW_SwKzj_EkXthX059-qPbEw@mail.gmail.com>

On Fri, Jan 15, 2016 at 7:11 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> As I've received lately a few emails asking me about GDAL 2.1, it's time to
> discuss that publicly.
>
> To keep roughly with our yearly cycle, I think we could probably target a
> beta
> 1 for the beginning of April, with possibly the release happening end
> April/beginning May if things go well (optimistic scenario : 3 weeks for
> betas
> + 1 week RCs).
>
> Opinions ? Any candidate for being release manager ?
>
> Cheers,
>
> Even
>

I wish I could raise my hand for the release manager job, but I'm pretty
tied up with the GeoJSON WG.

I like the time frame you've proposed. There's some work in progress I'd
like to see in 2.1 (https://github.com/OSGeo/gdal/pull/98) and 4 weeks
should be enough to finish it.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20160229/3cc79b27/attachment.html>

