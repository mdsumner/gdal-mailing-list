From mateusz at loskot.net  Fri Nov  1 00:33:25 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Fri, 1 Nov 2019 08:33:25 +0100
Subject: [gdal-dev] flipped
In-Reply-To: <CAOOxsY7_gkBB_HXX6n5iGEX8EuPCh8BOnmFQvUO4txB1Q8H5zA@mail.gmail.com>
References: <CAOOxsY7_gkBB_HXX6n5iGEX8EuPCh8BOnmFQvUO4txB1Q8H5zA@mail.gmail.com>
Message-ID: <CABUeae_EACP=rd+eaZcu5yC2ukH1u+oa0X5rvwwdpzYTQRLwAQ@mail.gmail.com>

On Fri, 1 Nov 2019, 07:10 Dshah, <divxtamana at gmail.com> wrote:

> Greetings,
>
> When I GDALOpen a .tif image and write a new one, the new image is flipped
> upside down? could someone please help?
>
>     const char *pszFilename = "im.tif";
>     poDataset = (GDALDataset *)GDALOpen(pszFilename, GA_ReadOnly);
>


Write it down siden up, perhaps.

Mateusz Loskot, mateusz at loskot.net
(Sent from mobile, may suffer from top-posting)

p.s. Crystal sphere temporarily broken
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/023582ea/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov  1 01:10:57 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 1 Nov 2019 01:10:57 -0700 (MST)
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
 reporting EPSG codes
In-Reply-To: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>
References: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>
Message-ID: <1572595857809-0.post@n6.nabble.com>

Hi,

Please make is easier for us to help you and provide a link to such raster
file. It does not need to be your real, perhaps confidential data, a small
extract is actually much better. Just take care that if shows all the issues
that you wrote about. Meanwhile you can read
https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn and think if this
change could explain some of your observations.

-Jukka Rahkonen-



David Cakalic wrote
> Hi,
> 
> I've been having a problem using gdal to simply read/report EPSG headers
> on rasters.  I am trying to use it to verify header projection information
> is correct.
> First, I am using Windows 10.
> Rasters are Imagine .IMG format.
> Command being used is   gdalsrsinfo -e {filename}
> 
> I've tried gdal from various sources/vintages... the problem is I can only
> get it to report the proper (expected) EPSG on 2 of 6 computers... even if
> I take special care to follow same steps each time.  I am also using the
> SAME EXACT image file each time.
> 
> The projection is NAD83(2011) / UTM zone 14N.
> So I expect to see EPSG:6343
> 
> I'm often getting EPSG:26914
> This is NAD83 / UTM zone 14N   (NOT 2011)
> 
> Or I get EPSG:  -1
> 
> The gdal install that works as expected on 2 of 6 computers is the version
> that installs on Windows along with  OSgeo4w.  (GDAL 2.4.1 as reported by
> "gdalsrsinfo --version" command)
> 
> It only works if I run the gdalsrsinfo command from the C:\OSgeo4w\bin
> folder.... If I run from anywhere else I get the other results mentioned.
> Also, I've installed the same OSgeo4w on all 6 machines... and it only
> works on two.
> 
> Other GDAL binaries for Windows I got from the gisinternals website...
> I've tried multiple versions (2.4.1, 2.4.2, 3.0....) and I'm running
> through the command shell provided with that distribution....  All getting
> different results (sometimes -1   sometimes  26914)   but I simply can't
> find any consistency of WHY it is working sometimes and not others.
> 
> One concern I have is that perhaps since GDAL is packaged with SO MANY
> programs (ESRI, Qgis, Global Mapper, etc.) that perhaps the command is
> calling incorrect libraries?
> 
> Please... if anyone has ideas on WHY this is happening, or how to force
> the command to run from a a CLEAN environment only using the libraries I
> desire, I welcome input.
> Sincerely,
> David C.
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From rdmailings at duif.net  Fri Nov  1 01:45:20 2019
From: rdmailings at duif.net (Richard Duivenvoorde)
Date: Fri, 1 Nov 2019 09:45:20 +0100
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
Message-ID: <52c0605c-c20e-5d40-357e-5503dd833788@duif.net>

Hi Ivan,

I think I reported an issue like this some time ago in the QGIS issue
tracker:

https://issues.qgis.org/issues/20730

I think(!), but I hope some netcdf guru jumps in, that the crux is how
you define/interpret your data: is the value valid in the center of the
grid (like a raster) or is it on the vertices (more like a mesh).
It is all about interpretation of a datamodel: is it a grid or a raster.

If I understand correctly in a mesh (and netcdf) is much more possible
then in a raster: triangular meshes, non-regular etc etc:

https://docs.qgis.org/3.4/en/docs/user_manual/working_with_mesh/mesh_properties.html

I'm not sure who should be responsible for 'correcting/transforming'
this: a netcdf which is written as if the values are on (for example)
the upper-left corner vertices, while you actually mean the value is in
the center of a (grid)cell... For a simple rectangular mesh, this seems
feasible on the client side (see panoply example in first link), but for
non-regular meshes/netcdf's this seems impossible client side (well
actually that is not a raster/grid anymore)..

In your case I would think that the data is actually mend to be a grid...

Not sure if this is helpfull, as said I hope some netcdf guru jumps in.
Maybe I'm oversimplifying here...

Regards,

Richard Duivenvoorde

On 31/10/2019 22.06, Ivan Lucena wrote:
> 
> Hi Folks,
> 
> I Downloaded NetCDF files
> from http://land.copernicus.eu/global/products/ndvi and I am having
> problems with the GeoTransform that the driver is getting.
> 
> The image extents, as you can see in following gdalinfo report, goes
> beyond the -180 and +180 longitude degrees (half resolution, half pixel)
> but that's OK according to page 27 in the PDF documentation:
> PROBAV-Products_User_Manual_v1.3.pdf
> <https://earth.esa.int/documents/700255/1929094/PROBAV-Products_User_Manual_v1.3.pdf/fd5e30f4-5305-4d41-86aa-fab7b9568251> 
> 
> But if I open that image on QGIS and overlay a vector (GADM from
> gadm.org) or any other global layer it is clear that -180x80 should be
> in the upper left corner of the image, not In the center. There is a
> half pixel missing on the left and bottom of the image. This in in Fiji:
> 
> 
> 
> The gdalinfo report shows that the crs:GeoTransform is -180.0000000000
> 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905 but it seems like the
> driver decided to take that to as center of the pixel based. Looking at
> the NetCDF source I can see that there this possibility exists.
> 
> Of course, I am not waiting for a solution. I just used gdal_translate
> "- a_ullr" and fix that into the target format. It takes centuries to
> converted that image to geotiff. But I am concerned that others might
> get in trouble because of that.
> 
> I tried to contact the data provider but did not received an answer yet.
> 
> Does anybody has experience with that dataset and/or NetCDF that can
> help figure out what is going on. It is a bug in the driver or an issue
> with the data.
> 
> Thanks,
> 
> -
> Ivan
> 
> Here is the gdalinfo report:
> 
> Don't worry about the warnings in regards to the pixel values. It is fine.
> 
> $ gdalinfo netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc
> --debug on
> GDAL_netCDF: driver detected file type=5, libnetcdf detected type=3​
> Warning 1: NetCDF driver detected file type=5, but libnetcdf detected
> type=3​
> GDAL_netCDF: setting file type to 3, was 5​
> GDAL_netCDF: dim_count = 2​
> GDAL_netCDF: var_count = 4​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
> GDAL_netCDF:​
> =====​
> SetProjectionFromVar( 3)​
> *GDAL_netCDF: got grid_mapping crs​*
> GDAL_netCDF: bIsGdalFile=1 bIsGdalCfFile=0 bBottomUp=0​
> GDAL_netCDF: got spheroid from CF: (6378137.000000 , 298.257224)​
> GDAL_netCDF: set bBottomUp = 0 from Y axis​
> GDAL_netCDF: setting WKT from CF​
> GDAL_netCDF: SetProjection, WKT =
> GEOGCS["unknown",DATUM["unknown",SPHEROID["Spheroid",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]]
> ​
> GDAL_netCDF: xdim: 120960 nSpacingBegin: 3 nSpacingMiddle: 3
> nSpacingLast: 3​
> GDAL_netCDF: ydim: 47040 nSpacingBegin: -3 nSpacingMiddle: -3
> nSpacingLast: -3​
> GDAL_netCDF: setting WKT from GDAL​
> GDAL_netCDF: SetProjection, WKT = GEOGCS["WGS
> 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
> ​
> *GDAL_netCDF:
> SetGeoTransform(-180.001488,0.002976,0.000000,80.001488,0.000000,-0.002976)
> ​*
> GDAL_netCDF: bGotGeogCS=1 bGotCfSRS=1 bGotCfGT=1 bGotGdalSRS=1 bGotGdalGT=0​
> Warning 1: Unsupported netCDF datatype (7), treat as Float32.​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
> GDAL_netCDF: netcdf type=5 gdal type=6 signedByte=1​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
> GDAL_netCDF: got add_offset=-0.07999999821186066, status=0​
> GDAL_netCDF: got scale_factor=0.004000000189989805, status=0​
> GDAL: GDALOpen(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
> this=00000219E2D291F0) succeeds as netCDF.​
> Driver: netCDF/Network Common Data Format​
> GDAL: GDALDefaultOverviews::OverviewScan()​
> Files: none associated​
> Size is 120960, 47040​
> Coordinate System is:​
> GEOGCS["WGS 84",​
>     DATUM["WGS_1984",​
>         SPHEROID["WGS 84",6378137,298.257223563,​
>             AUTHORITY["EPSG","7030"]],​
>         TOWGS84[0,0,0,0,0,0,0],​
>         AUTHORITY["EPSG","6326"]],​
>     PRIMEM["Greenwich",0,​
>         AUTHORITY["EPSG","8901"]],​
>     UNIT["degree",0.0174532925199433,​
>         AUTHORITY["EPSG","9108"]],​
>     AUTHORITY["EPSG","4326"]]​
> *Origin = (-180.001488095238102,80.001488095238088)​*
> Pixel Size = (0.002976190476204,-0.002976190476190)​
> Metadata:​
> *  crs#GeoTransform=-180.0000000000 0.0029761905 0.0 80.0000000000 0.0
> -0.0029761905​*
>   crs#grid_mapping_name=latitude_longitude​
>   crs#inverse_flattening=298.257223563​
>   crs#longitude_of_prime_meridian=0​
>   crs#long_name=coordinate reference system​
>   crs#semi_major_axis=6378137​
>   crs#spatial_ref=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
> ​
>   crs#_CoordinateAxisTypes=GeoX GeoY​
>   crs#_CoordinateTransformType=Projection​
>   lat#axis=Y​
>   lat#DIMENSION_LABELS=lat​
>   lat#long_name=latitude​
>   lat#standard_name=latitude​
>   lat#units=degrees_north​
>   lat#_CoordinateAxisType=Lat​
>   lon#axis=X​
>   lon#DIMENSION_LABELS=lon​
>   lon#long_name=longitude​
>   lon#standard_name=longitude​
>   lon#units=degrees_east​
>   lon#_CoordinateAxisType=Lon​
>   NC_GLOBAL#archive_facility=VITO​
>   NC_GLOBAL#Conventions=CF-1.6​
>   NC_GLOBAL#copyright=Copernicus Service information 2019​
>   NC_GLOBAL#history=Processing line NDVI: 2019-10-22​
>  
> NC_GLOBAL#identifier=urn:cgls:global:ndvi300_v1_333m:NDVI300_201910110000_GLOBE_PROBAV_V1.0.1
> ​
>   NC_GLOBAL#institution=VITO NV​
>   NC_GLOBAL#long_name=Normalized Difference Vegetation Index​
>   NC_GLOBAL#orbit_type=LEO​
>   NC_GLOBAL#parent_identifier=urn:cgls:global:ndvi300_v1_333m​
>   NC_GLOBAL#platform=Proba-V​
>   NC_GLOBAL#processing_level=L3​
>   NC_GLOBAL#processing_mode=Near Real Time​
>   NC_GLOBAL#product_version=V1.0.1​
>   NC_GLOBAL#references=http://land.copernicus.eu/global/products/ndvi​
>   NC_GLOBAL#sensor=VEGETATION​
>   NC_GLOBAL#source=Derived from EO satellite imagery​
>   NC_GLOBAL#time_coverage_end=2019-10-20T23:59:59Z​
>   NC_GLOBAL#time_coverage_start=2019-10-11T00:00:00Z​
>   NC_GLOBAL#title=10-daily Normalized Difference Vegetation Index 333M:
> GLOBE 2019-10-11T00:00:00Z​
>   NDVI#add_offset=-0.079999998​
>   NDVI#flag_meanings=Missing cloud snow sea background​
>   NDVI#flag_values={}​
>   NDVI#grid_mapping=crs​
>   NDVI#long_name=Normalized Difference Vegetation Index 333M​
>   NDVI#missing_value=​
>   NDVI#scale_factor=0.0040000002​
>   NDVI#standard_name=normalized_difference_vegetation_index​
>   NDVI#units=​
>   NDVI#valid_range={}​
>   NDVI#_FillValue=​
> OGRCT: PROJ >= 4.8.0 features enabled​
> OGRCT: Using locale-safe proj version​
> OGRCT: Source: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
> OGRCT: Target: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
> Corner Coordinates:​
> *Upper Left  (-180.0014881,  80.0014881) (180d 0' 5.36"W, 80d 0' 5.36"N)​*
> *Lower Left  (-180.0014881, -59.9985119) (180d 0' 5.36"W, 59d59'54.64"S)​*
> *Upper Right ( 179.9985119,  80.0014881) (179d59'54.64"E, 80d 0' 5.36"N)​*
> *Lower Right ( 179.9985119, -59.9985119) (179d59'54.64"E, 59d59'54.64"S)​*
> Center      (  -0.0014881,  10.0014881) (  0d 0' 5.36"W, 10d 0' 5.36"N)​
> Band 1 Block=120960x1 Type=Float32, ColorInterp=Undefined​
>   NoData Value=0​
>   Offset: -0.0799999982118607,   Scale:0.00400000018998981​
>   Metadata:​
>     add_offset=-0.079999998​
>     flag_meanings=Missing cloud snow sea background​
>     flag_values={}​
>     grid_mapping=crs​
>     long_name=Normalized Difference Vegetation Index 333M​
>     missing_value=​
>     NETCDF_VARNAME=NDVI​
>     scale_factor=0.0040000002​
>     standard_name=normalized_difference_vegetation_index​
>     units=​
>     valid_range={}​
>     _FillValue=​
> GDAL:
> GDALClose(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
> this=00000219E2D291F0)​
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


From divxtamana at gmail.com  Fri Nov  1 02:24:26 2019
From: divxtamana at gmail.com (Dshah)
Date: Fri, 1 Nov 2019 11:24:26 +0200
Subject: [gdal-dev] flipped
In-Reply-To: <CABUeae_EACP=rd+eaZcu5yC2ukH1u+oa0X5rvwwdpzYTQRLwAQ@mail.gmail.com>
References: <CAOOxsY7_gkBB_HXX6n5iGEX8EuPCh8BOnmFQvUO4txB1Q8H5zA@mail.gmail.com>
 <CABUeae_EACP=rd+eaZcu5yC2ukH1u+oa0X5rvwwdpzYTQRLwAQ@mail.gmail.com>
Message-ID: <CAOOxsY4-5O008gv+OuwGuN8Dcnpx6fBzi5idS2akaAWaMthLEg@mail.gmail.com>

@Mateusz thanks for the answer, so it is set by GDAL to open data flipped?

On Fri, Nov 1, 2019 at 9:33 AM Mateusz Loskot <mateusz at loskot.net> wrote:

> On Fri, 1 Nov 2019, 07:10 Dshah, <divxtamana at gmail.com> wrote:
>
>> Greetings,
>>
>> When I GDALOpen a .tif image and write a new one, the new image is
>> flipped upside down? could someone please help?
>>
>>     const char *pszFilename = "im.tif";
>>     poDataset = (GDALDataset *)GDALOpen(pszFilename, GA_ReadOnly);
>>
>
>
> Write it down siden up, perhaps.
>
> Mateusz Loskot, mateusz at loskot.net
> (Sent from mobile, may suffer from top-posting)
>
> p.s. Crystal sphere temporarily broken
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/df7ea6a0/attachment-0001.html>

From divxtamana at gmail.com  Fri Nov  1 02:35:15 2019
From: divxtamana at gmail.com (Dshah)
Date: Fri, 1 Nov 2019 11:35:15 +0200
Subject: [gdal-dev] flipped
In-Reply-To: <CAOOxsY4-5O008gv+OuwGuN8Dcnpx6fBzi5idS2akaAWaMthLEg@mail.gmail.com>
References: <CAOOxsY7_gkBB_HXX6n5iGEX8EuPCh8BOnmFQvUO4txB1Q8H5zA@mail.gmail.com>
 <CABUeae_EACP=rd+eaZcu5yC2ukH1u+oa0X5rvwwdpzYTQRLwAQ@mail.gmail.com>
 <CAOOxsY4-5O008gv+OuwGuN8Dcnpx6fBzi5idS2akaAWaMthLEg@mail.gmail.com>
Message-ID: <CAOOxsY5L0YmP0JqBv5pB=A_2_70coqPyfJRsH8+ZDuqBqYW35A@mail.gmail.com>

I found there is an option WRITE_BOTTOMUP  available for gdal_translate ,
Looking for alternative in C++

On Fri, Nov 1, 2019 at 11:24 AM Dshah <divxtamana at gmail.com> wrote:

> @Mateusz thanks for the answer, so it is set by GDAL to open data flipped?
>
> On Fri, Nov 1, 2019 at 9:33 AM Mateusz Loskot <mateusz at loskot.net> wrote:
>
>> On Fri, 1 Nov 2019, 07:10 Dshah, <divxtamana at gmail.com> wrote:
>>
>>> Greetings,
>>>
>>> When I GDALOpen a .tif image and write a new one, the new image is
>>> flipped upside down? could someone please help?
>>>
>>>     const char *pszFilename = "im.tif";
>>>     poDataset = (GDALDataset *)GDALOpen(pszFilename, GA_ReadOnly);
>>>
>>
>>
>> Write it down siden up, perhaps.
>>
>> Mateusz Loskot, mateusz at loskot.net
>> (Sent from mobile, may suffer from top-posting)
>>
>> p.s. Crystal sphere temporarily broken
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/65b01512/attachment.html>

From landa.martin at gmail.com  Fri Nov  1 02:44:12 2019
From: landa.martin at gmail.com (Martin Landa)
Date: Fri, 1 Nov 2019 10:44:12 +0100
Subject: [gdal-dev] set GDAL ColorTable from QGIS QML file
Message-ID: <CA+Ei1OfrEGtuW=Tp8qauJC+A-vgr50imzAHUYr9_X-tGoBdwzQ@mail.gmail.com>

Dear all,

is there any option how to define GDAL color table from existing QGIS
QML file directly via GDAL Python API (at least with limited
functionality)? Thanks in advance for feedback, best regards, Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From andrew at aitchison.me.uk  Fri Nov  1 04:24:27 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Fri, 1 Nov 2019 11:24:27 +0000 (GMT)
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <52c0605c-c20e-5d40-357e-5503dd833788@duif.net>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
 <52c0605c-c20e-5d40-357e-5503dd833788@duif.net>
Message-ID: <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>


Does
   https://gis.stackexchange.com/questions/122670/is-there-a-standard-for-the-coordinates-of-pixels-in-georeferenced-rasters#122687
help you to understand the issue ?

On Fri, 1 Nov 2019, Richard Duivenvoorde wrote:

> Hi Ivan,
>
> I think I reported an issue like this some time ago in the QGIS issue
> tracker:
>
> https://issues.qgis.org/issues/20730
>
> I think(!), but I hope some netcdf guru jumps in, that the crux is how
> you define/interpret your data: is the value valid in the center of the
> grid (like a raster) or is it on the vertices (more like a mesh).
> It is all about interpretation of a datamodel: is it a grid or a raster.
>
> If I understand correctly in a mesh (and netcdf) is much more possible
> then in a raster: triangular meshes, non-regular etc etc:
>
> https://docs.qgis.org/3.4/en/docs/user_manual/working_with_mesh/mesh_properties.html
>
> I'm not sure who should be responsible for 'correcting/transforming'
> this: a netcdf which is written as if the values are on (for example)
> the upper-left corner vertices, while you actually mean the value is in
> the center of a (grid)cell... For a simple rectangular mesh, this seems
> feasible on the client side (see panoply example in first link), but for
> non-regular meshes/netcdf's this seems impossible client side (well
> actually that is not a raster/grid anymore)..
>
> In your case I would think that the data is actually mend to be a grid...
>
> Not sure if this is helpfull, as said I hope some netcdf guru jumps in.
> Maybe I'm oversimplifying here...
>
> Regards,
>
> Richard Duivenvoorde
>
> On 31/10/2019 22.06, Ivan Lucena wrote:
>>
>> Hi Folks,
>>
>> I Downloaded NetCDF files
>> from?http://land.copernicus.eu/global/products/ndvi and I am having
>> problems with the GeoTransform that the driver is getting.
>>
>> The image extents, as you can see in following gdalinfo report, goes
>> beyond the -180 and +180 longitude degrees (half resolution, half pixel)
>> but that's OK according to page 27 in the PDF documentation:
>> PROBAV-Products_User_Manual_v1.3.pdf
>> <https://earth.esa.int/documents/700255/1929094/PROBAV-Products_User_Manual_v1.3.pdf/fd5e30f4-5305-4d41-86aa-fab7b9568251>?
>>
>> But if I open that image on QGIS and overlay a vector (GADM from
>> gadm.org) or any other global layer it is clear that -180x80 should be
>> in the upper left corner of the image, not In the center. There is a
>> half pixel missing on the left and bottom of the image. This in in Fiji:
>>
>>
>>
>> The gdalinfo report shows that the crs:GeoTransform is?-180.0000000000
>> 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905 but it seems like the
>> driver decided to take that to as center of the pixel based. Looking at
>> the NetCDF source I can see that there this possibility exists.
>>
>> Of course, I am not waiting for a solution. I just used gdal_translate
>> "- a_ullr" and fix that into the target format. It takes centuries to
>> converted that image to geotiff. But I am concerned that others might
>> get in trouble because of that.
>>
>> I tried to contact the data provider but did not received an answer yet.
>>
>> Does anybody has experience with that dataset and/or NetCDF that can
>> help figure out what is going on. It is a bug in the driver or an issue
>> with the data.
>>
>> Thanks,
>>
>> -
>> Ivan
>>
>> Here is the gdalinfo report:
>>
>> Don't worry about the warnings in regards to the pixel values. It is fine.
>>
>> $ gdalinfo netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc
>> --debug on
>> GDAL_netCDF: driver detected file type=5, libnetcdf detected type=3​
>> Warning 1: NetCDF driver detected file type=5, but libnetcdf detected
>> type=3​
>> GDAL_netCDF: setting file type to 3, was 5​
>> GDAL_netCDF: dim_count = 2​
>> GDAL_netCDF: var_count = 4​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF:​
>> =====​
>> SetProjectionFromVar( 3)​
>> *GDAL_netCDF: got grid_mapping crs​*
>> GDAL_netCDF: bIsGdalFile=1 bIsGdalCfFile=0 bBottomUp=0​
>> GDAL_netCDF: got spheroid from CF: (6378137.000000 , 298.257224)​
>> GDAL_netCDF: set bBottomUp = 0 from Y axis​
>> GDAL_netCDF: setting WKT from CF​
>> GDAL_netCDF: SetProjection, WKT =
>> GEOGCS["unknown",DATUM["unknown",SPHEROID["Spheroid",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]]
>> ​
>> GDAL_netCDF: xdim: 120960 nSpacingBegin: 3 nSpacingMiddle: 3
>> nSpacingLast: 3​
>> GDAL_netCDF: ydim: 47040 nSpacingBegin: -3 nSpacingMiddle: -3
>> nSpacingLast: -3​
>> GDAL_netCDF: setting WKT from GDAL​
>> GDAL_netCDF: SetProjection, WKT = GEOGCS["WGS
>> 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> *GDAL_netCDF:
>> SetGeoTransform(-180.001488,0.002976,0.000000,80.001488,0.000000,-0.002976)
>> ​*
>> GDAL_netCDF: bGotGeogCS=1 bGotCfSRS=1 bGotCfGT=1 bGotGdalSRS=1 bGotGdalGT=0​
>> Warning 1: Unsupported netCDF datatype (7), treat as Float32.​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: netcdf type=5 gdal type=6 signedByte=1​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF: got add_offset=-0.07999999821186066, status=0​
>> GDAL_netCDF: got scale_factor=0.004000000189989805, status=0​
>> GDAL: GDALOpen(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0) succeeds as netCDF.​
>> Driver: netCDF/Network Common Data Format​
>> GDAL: GDALDefaultOverviews::OverviewScan()​
>> Files: none associated​
>> Size is 120960, 47040​
>> Coordinate System is:​
>> GEOGCS["WGS 84",​
>> ? ? DATUM["WGS_1984",​
>> ? ? ? ? SPHEROID["WGS 84",6378137,298.257223563,​
>> ? ? ? ? ? ? AUTHORITY["EPSG","7030"]],​
>> ? ? ? ? TOWGS84[0,0,0,0,0,0,0],​
>> ? ? ? ? AUTHORITY["EPSG","6326"]],​
>> ? ? PRIMEM["Greenwich",0,​
>> ? ? ? ? AUTHORITY["EPSG","8901"]],​
>> ? ? UNIT["degree",0.0174532925199433,​
>> ? ? ? ? AUTHORITY["EPSG","9108"]],​
>> ? ? AUTHORITY["EPSG","4326"]]​
>> *Origin = (-180.001488095238102,80.001488095238088)​*
>> Pixel Size = (0.002976190476204,-0.002976190476190)​
>> Metadata:​
>> *? crs#GeoTransform=-180.0000000000 0.0029761905 0.0 80.0000000000 0.0
>> -0.0029761905​*
>> ? crs#grid_mapping_name=latitude_longitude​
>> ? crs#inverse_flattening=298.257223563​
>> ? crs#longitude_of_prime_meridian=0​
>> ? crs#long_name=coordinate reference system​
>> ? crs#semi_major_axis=6378137​
>> ? crs#spatial_ref=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> ? crs#_CoordinateAxisTypes=GeoX GeoY​
>> ? crs#_CoordinateTransformType=Projection​
>> ? lat#axis=Y​
>> ? lat#DIMENSION_LABELS=lat​
>> ? lat#long_name=latitude​
>> ? lat#standard_name=latitude​
>> ? lat#units=degrees_north​
>> ? lat#_CoordinateAxisType=Lat​
>> ? lon#axis=X​
>> ? lon#DIMENSION_LABELS=lon​
>> ? lon#long_name=longitude​
>> ? lon#standard_name=longitude​
>> ? lon#units=degrees_east​
>> ? lon#_CoordinateAxisType=Lon​
>> ? NC_GLOBAL#archive_facility=VITO​
>> ? NC_GLOBAL#Conventions=CF-1.6​
>> ? NC_GLOBAL#copyright=Copernicus Service information 2019​
>> ? NC_GLOBAL#history=Processing line NDVI: 2019-10-22​
>> ?
>> NC_GLOBAL#identifier=urn:cgls:global:ndvi300_v1_333m:NDVI300_201910110000_GLOBE_PROBAV_V1.0.1
>> ​
>> ? NC_GLOBAL#institution=VITO NV​
>> ? NC_GLOBAL#long_name=Normalized Difference Vegetation Index​
>> ? NC_GLOBAL#orbit_type=LEO​
>> ? NC_GLOBAL#parent_identifier=urn:cgls:global:ndvi300_v1_333m​
>> ? NC_GLOBAL#platform=Proba-V​
>> ? NC_GLOBAL#processing_level=L3​
>> ? NC_GLOBAL#processing_mode=Near Real Time​
>> ? NC_GLOBAL#product_version=V1.0.1​
>> ? NC_GLOBAL#references=http://land.copernicus.eu/global/products/ndvi​
>> ? NC_GLOBAL#sensor=VEGETATION​
>> ? NC_GLOBAL#source=Derived from EO satellite imagery​
>> ? NC_GLOBAL#time_coverage_end=2019-10-20T23:59:59Z​
>> ? NC_GLOBAL#time_coverage_start=2019-10-11T00:00:00Z​
>> ? NC_GLOBAL#title=10-daily Normalized Difference Vegetation Index 333M:
>> GLOBE 2019-10-11T00:00:00Z​
>> ? NDVI#add_offset=-0.079999998​
>> ? NDVI#flag_meanings=Missing cloud snow sea background​
>> ? NDVI#flag_values={}​
>> ? NDVI#grid_mapping=crs​
>> ? NDVI#long_name=Normalized Difference Vegetation Index 333M​
>> ? NDVI#missing_value=​
>> ? NDVI#scale_factor=0.0040000002​
>> ? NDVI#standard_name=normalized_difference_vegetation_index​
>> ? NDVI#units=​
>> ? NDVI#valid_range={}​
>> ? NDVI#_FillValue=​
>> OGRCT: PROJ >= 4.8.0 features enabled​
>> OGRCT: Using locale-safe proj version​
>> OGRCT: Source: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> OGRCT: Target: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> Corner Coordinates:​
>> *Upper Left ?(-180.0014881, ?80.0014881) (180d 0' 5.36"W, 80d 0' 5.36"N)​*
>> *Lower Left ?(-180.0014881, -59.9985119) (180d 0' 5.36"W, 59d59'54.64"S)​*
>> *Upper Right ( 179.9985119, ?80.0014881) (179d59'54.64"E, 80d 0' 5.36"N)​*
>> *Lower Right ( 179.9985119, -59.9985119) (179d59'54.64"E, 59d59'54.64"S)​*
>> Center ? ? ?( ?-0.0014881, ?10.0014881) ( ?0d 0' 5.36"W, 10d 0' 5.36"N)​
>> Band 1 Block=120960x1 Type=Float32, ColorInterp=Undefined​
>> ? NoData Value=0​
>> ? Offset: -0.0799999982118607, ? Scale:0.00400000018998981​
>> ? Metadata:​
>> ? ? add_offset=-0.079999998​
>> ? ? flag_meanings=Missing cloud snow sea background​
>> ? ? flag_values={}​
>> ? ? grid_mapping=crs​
>> ? ? long_name=Normalized Difference Vegetation Index 333M​
>> ? ? missing_value=​
>> ? ? NETCDF_VARNAME=NDVI​
>> ? ? scale_factor=0.0040000002​
>> ? ? standard_name=normalized_difference_vegetation_index​
>> ? ? units=​
>> ? ? valid_range={}​
>> ? ? _FillValue=​
>> GDAL:
>> GDALClose(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0)​
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From ivan.lucena at outlook.com  Fri Nov  1 06:17:39 2019
From: ivan.lucena at outlook.com (Ivan Lucena)
Date: Fri, 1 Nov 2019 13:17:39 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
 <52c0605c-c20e-5d40-357e-5503dd833788@duif.net>,
 <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>
Message-ID: <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>

Thanks Andrew and Richard,

Very good examples.

I have struggled with that so many times when developing GDAL drivers or when dealing with data in formats like HDF4, HDF5, NetCDF.

Some formats have a pretty good easy way of telling which way to go about upperleft or center pixel coordinate. But that is not the case with "flexible" formats like the ones above. In some cases developer have to identify the data product in a hardcode way and apply what the documentation says about the data, not only in regards to pixel coordinate but other issues.

What is interesting in that case is that one can say that according to the documentation the driver is correct. The -180,80 coordinate is in the center of the pixel. But when putting that date to real use, that seems to be incorrect.

And that could be dangerous or at least inconvenient. In my case I have a Python code that does zonal statistic and when a geometry is converted to a little raster binary mask, it does not match the same area in the ProbaV data and the results is a crash in Fiji because ReadRaster goes overboard or lost of NDVI data in other regions. The half pixel shift grows as you go east.

In other case, a GIS user might find impossible to run a raster tool, because it will complain that all the raster sources that they are trying to combine does not match the same area. There are still some tool like that in the marked, unfortunately.

If I have some time, I will try to run the NetCDF driver in step-by-step debugging mode to see exactly how the crs:GeoTransform is (mis)handled.

The goal is to see if the data is wrong or if the driver is wrong (or if I am wrong) and to decided how to go from here. We might need to add some hardcoded decision into the NetCDF driver, which I would prefer not to do.

Best regards,

Ivan

________________________________
From: Andrew C Aitchison <andrew at aitchison.me.uk>
Sent: Friday, November 1, 2019 7:24 AM
To: Richard Duivenvoorde <rdmailings at duif.net>
Cc: Ivan Lucena <ivan.lucena at outlook.com>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates


Does
   https://gis.stackexchange.com/questions/122670/is-there-a-standard-for-the-coordinates-of-pixels-in-georeferenced-rasters#122687
help you to understand the issue ?

On Fri, 1 Nov 2019, Richard Duivenvoorde wrote:

> Hi Ivan,
>
> I think I reported an issue like this some time ago in the QGIS issue
> tracker:
>
> https://issues.qgis.org/issues/20730
>
> I think(!), but I hope some netcdf guru jumps in, that the crux is how
> you define/interpret your data: is the value valid in the center of the
> grid (like a raster) or is it on the vertices (more like a mesh).
> It is all about interpretation of a datamodel: is it a grid or a raster.
>
> If I understand correctly in a mesh (and netcdf) is much more possible
> then in a raster: triangular meshes, non-regular etc etc:
>
> https://docs.qgis.org/3.4/en/docs/user_manual/working_with_mesh/mesh_properties.html
>
> I'm not sure who should be responsible for 'correcting/transforming'
> this: a netcdf which is written as if the values are on (for example)
> the upper-left corner vertices, while you actually mean the value is in
> the center of a (grid)cell... For a simple rectangular mesh, this seems
> feasible on the client side (see panoply example in first link), but for
> non-regular meshes/netcdf's this seems impossible client side (well
> actually that is not a raster/grid anymore)..
>
> In your case I would think that the data is actually mend to be a grid...
>
> Not sure if this is helpfull, as said I hope some netcdf guru jumps in.
> Maybe I'm oversimplifying here...
>
> Regards,
>
> Richard Duivenvoorde
>
> On 31/10/2019 22.06, Ivan Lucena wrote:
>>
>> Hi Folks,
>>
>> I Downloaded NetCDF files
>> from?http://land.copernicus.eu/global/products/ndvi and I am having
>> problems with the GeoTransform that the driver is getting.
>>
>> The image extents, as you can see in following gdalinfo report, goes
>> beyond the -180 and +180 longitude degrees (half resolution, half pixel)
>> but that's OK according to page 27 in the PDF documentation:
>> PROBAV-Products_User_Manual_v1.3.pdf
>> <https://earth.esa.int/documents/700255/1929094/PROBAV-Products_User_Manual_v1.3.pdf/fd5e30f4-5305-4d41-86aa-fab7b9568251>?
>>
>> But if I open that image on QGIS and overlay a vector (GADM from
>> gadm.org) or any other global layer it is clear that -180x80 should be
>> in the upper left corner of the image, not In the center. There is a
>> half pixel missing on the left and bottom of the image. This in in Fiji:
>>
>>
>>
>> The gdalinfo report shows that the crs:GeoTransform is?-180.0000000000
>> 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905 but it seems like the
>> driver decided to take that to as center of the pixel based. Looking at
>> the NetCDF source I can see that there this possibility exists.
>>
>> Of course, I am not waiting for a solution. I just used gdal_translate
>> "- a_ullr" and fix that into the target format. It takes centuries to
>> converted that image to geotiff. But I am concerned that others might
>> get in trouble because of that.
>>
>> I tried to contact the data provider but did not received an answer yet.
>>
>> Does anybody has experience with that dataset and/or NetCDF that can
>> help figure out what is going on. It is a bug in the driver or an issue
>> with the data.
>>
>> Thanks,
>>
>> -
>> Ivan
>>
>> Here is the gdalinfo report:
>>
>> Don't worry about the warnings in regards to the pixel values. It is fine.
>>
>> $ gdalinfo netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc
>> --debug on
>> GDAL_netCDF: driver detected file type=5, libnetcdf detected type=3​
>> Warning 1: NetCDF driver detected file type=5, but libnetcdf detected
>> type=3​
>> GDAL_netCDF: setting file type to 3, was 5​
>> GDAL_netCDF: dim_count = 2​
>> GDAL_netCDF: var_count = 4​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF:​
>> =====​
>> SetProjectionFromVar( 3)​
>> *GDAL_netCDF: got grid_mapping crs​*
>> GDAL_netCDF: bIsGdalFile=1 bIsGdalCfFile=0 bBottomUp=0​
>> GDAL_netCDF: got spheroid from CF: (6378137.000000 , 298.257224)​
>> GDAL_netCDF: set bBottomUp = 0 from Y axis​
>> GDAL_netCDF: setting WKT from CF​
>> GDAL_netCDF: SetProjection, WKT =
>> GEOGCS["unknown",DATUM["unknown",SPHEROID["Spheroid",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]]
>> ​
>> GDAL_netCDF: xdim: 120960 nSpacingBegin: 3 nSpacingMiddle: 3
>> nSpacingLast: 3​
>> GDAL_netCDF: ydim: 47040 nSpacingBegin: -3 nSpacingMiddle: -3
>> nSpacingLast: -3​
>> GDAL_netCDF: setting WKT from GDAL​
>> GDAL_netCDF: SetProjection, WKT = GEOGCS["WGS
>> 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> *GDAL_netCDF:
>> SetGeoTransform(-180.001488,0.002976,0.000000,80.001488,0.000000,-0.002976)
>> ​*
>> GDAL_netCDF: bGotGeogCS=1 bGotCfSRS=1 bGotCfGT=1 bGotGdalSRS=1 bGotGdalGT=0​
>> Warning 1: Unsupported netCDF datatype (7), treat as Float32.​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: netcdf type=5 gdal type=6 signedByte=1​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF: got add_offset=-0.07999999821186066, status=0​
>> GDAL_netCDF: got scale_factor=0.004000000189989805, status=0​
>> GDAL: GDALOpen(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0) succeeds as netCDF.​
>> Driver: netCDF/Network Common Data Format​
>> GDAL: GDALDefaultOverviews::OverviewScan()​
>> Files: none associated​
>> Size is 120960, 47040​
>> Coordinate System is:​
>> GEOGCS["WGS 84",​
>> ? ? DATUM["WGS_1984",​
>> ? ? ? ? SPHEROID["WGS 84",6378137,298.257223563,​
>> ? ? ? ? ? ? AUTHORITY["EPSG","7030"]],​
>> ? ? ? ? TOWGS84[0,0,0,0,0,0,0],​
>> ? ? ? ? AUTHORITY["EPSG","6326"]],​
>> ? ? PRIMEM["Greenwich",0,​
>> ? ? ? ? AUTHORITY["EPSG","8901"]],​
>> ? ? UNIT["degree",0.0174532925199433,​
>> ? ? ? ? AUTHORITY["EPSG","9108"]],​
>> ? ? AUTHORITY["EPSG","4326"]]​
>> *Origin = (-180.001488095238102,80.001488095238088)​*
>> Pixel Size = (0.002976190476204,-0.002976190476190)​
>> Metadata:​
>> *? crs#GeoTransform=-180.0000000000 0.0029761905 0.0 80.0000000000 0.0
>> -0.0029761905​*
>> ? crs#grid_mapping_name=latitude_longitude​
>> ? crs#inverse_flattening=298.257223563​
>> ? crs#longitude_of_prime_meridian=0​
>> ? crs#long_name=coordinate reference system​
>> ? crs#semi_major_axis=6378137​
>> ? crs#spatial_ref=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> ? crs#_CoordinateAxisTypes=GeoX GeoY​
>> ? crs#_CoordinateTransformType=Projection​
>> ? lat#axis=Y​
>> ? lat#DIMENSION_LABELS=lat​
>> ? lat#long_name=latitude​
>> ? lat#standard_name=latitude​
>> ? lat#units=degrees_north​
>> ? lat#_CoordinateAxisType=Lat​
>> ? lon#axis=X​
>> ? lon#DIMENSION_LABELS=lon​
>> ? lon#long_name=longitude​
>> ? lon#standard_name=longitude​
>> ? lon#units=degrees_east​
>> ? lon#_CoordinateAxisType=Lon​
>> ? NC_GLOBAL#archive_facility=VITO​
>> ? NC_GLOBAL#Conventions=CF-1.6​
>> ? NC_GLOBAL#copyright=Copernicus Service information 2019​
>> ? NC_GLOBAL#history=Processing line NDVI: 2019-10-22​
>> ?
>> NC_GLOBAL#identifier=urn:cgls:global:ndvi300_v1_333m:NDVI300_201910110000_GLOBE_PROBAV_V1.0.1
>> ​
>> ? NC_GLOBAL#institution=VITO NV​
>> ? NC_GLOBAL#long_name=Normalized Difference Vegetation Index​
>> ? NC_GLOBAL#orbit_type=LEO​
>> ? NC_GLOBAL#parent_identifier=urn:cgls:global:ndvi300_v1_333m​
>> ? NC_GLOBAL#platform=Proba-V​
>> ? NC_GLOBAL#processing_level=L3​
>> ? NC_GLOBAL#processing_mode=Near Real Time​
>> ? NC_GLOBAL#product_version=V1.0.1​
>> ? NC_GLOBAL#references=http://land.copernicus.eu/global/products/ndvi​
>> ? NC_GLOBAL#sensor=VEGETATION​
>> ? NC_GLOBAL#source=Derived from EO satellite imagery​
>> ? NC_GLOBAL#time_coverage_end=2019-10-20T23:59:59Z​
>> ? NC_GLOBAL#time_coverage_start=2019-10-11T00:00:00Z​
>> ? NC_GLOBAL#title=10-daily Normalized Difference Vegetation Index 333M:
>> GLOBE 2019-10-11T00:00:00Z​
>> ? NDVI#add_offset=-0.079999998​
>> ? NDVI#flag_meanings=Missing cloud snow sea background​
>> ? NDVI#flag_values={}​
>> ? NDVI#grid_mapping=crs​
>> ? NDVI#long_name=Normalized Difference Vegetation Index 333M​
>> ? NDVI#missing_value=​
>> ? NDVI#scale_factor=0.0040000002​
>> ? NDVI#standard_name=normalized_difference_vegetation_index​
>> ? NDVI#units=​
>> ? NDVI#valid_range={}​
>> ? NDVI#_FillValue=​
>> OGRCT: PROJ >= 4.8.0 features enabled​
>> OGRCT: Using locale-safe proj version​
>> OGRCT: Source: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> OGRCT: Target: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> Corner Coordinates:​
>> *Upper Left ?(-180.0014881, ?80.0014881) (180d 0' 5.36"W, 80d 0' 5.36"N)​*
>> *Lower Left ?(-180.0014881, -59.9985119) (180d 0' 5.36"W, 59d59'54.64"S)​*
>> *Upper Right ( 179.9985119, ?80.0014881) (179d59'54.64"E, 80d 0' 5.36"N)​*
>> *Lower Right ( 179.9985119, -59.9985119) (179d59'54.64"E, 59d59'54.64"S)​*
>> Center ? ? ?( ?-0.0014881, ?10.0014881) ( ?0d 0' 5.36"W, 10d 0' 5.36"N)​
>> Band 1 Block=120960x1 Type=Float32, ColorInterp=Undefined​
>> ? NoData Value=0​
>> ? Offset: -0.0799999982118607, ? Scale:0.00400000018998981​
>> ? Metadata:​
>> ? ? add_offset=-0.079999998​
>> ? ? flag_meanings=Missing cloud snow sea background​
>> ? ? flag_values={}​
>> ? ? grid_mapping=crs​
>> ? ? long_name=Normalized Difference Vegetation Index 333M​
>> ? ? missing_value=​
>> ? ? NETCDF_VARNAME=NDVI​
>> ? ? scale_factor=0.0040000002​
>> ? ? standard_name=normalized_difference_vegetation_index​
>> ? ? units=​
>> ? ? valid_range={}​
>> ? ? _FillValue=​
>> GDAL:
>> GDALClose(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0)​
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/659a6c47/attachment-0001.html>

From even.rouault at spatialys.com  Fri Nov  1 06:42:09 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 01 Nov 2019 14:42:09 +0100
Subject: [gdal-dev] Python Bindings and Closed Datasets
In-Reply-To: <CADXYQQ5Ezi2-dm4ZeqPT7tB9eg4JQ1wRCPoY0OWO8nzLAbmZpw@mail.gmail.com>
References: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>
 <2583050.INz1hFUIFx@even-i700>
 <CADXYQQ5Ezi2-dm4ZeqPT7tB9eg4JQ1wRCPoY0OWO8nzLAbmZpw@mail.gmail.com>
Message-ID: <1636591.CHYrRNfQay@even-i700>

Patrick,

with your updated script, the good & bad news is that I can reproduce it quite 
reliably, including with GDAL master on a debug build. I strongly suspect a 
subtle race issue in the global GDAL block cache or in the way the GTiff 
driver interacts with it, rather than something Python specific.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Fri Nov  1 07:38:50 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 1 Nov 2019 11:38:50 -0300
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <3867881.MbL6gJQLIP@even-i700>
References: <3867881.MbL6gJQLIP@even-i700>
Message-ID: <17ef10c8-cab5-bced-17d9-7a9e07e80379@gatewaygeomatics.com>

+1


-jeff



On 2019-10-31 8:08 AM, Even Rouault wrote:
> Hi,
> 
> A few issues [1] have been fixed since in those branches since the RCs, but
> they predated 2.4.0, so those new releases are not worse than their previous
> x.y.0, so I move to
> 
> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
> 
> 

From jgomezdans at gmail.com  Fri Nov  1 10:21:24 2019
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Fri, 1 Nov 2019 17:21:24 +0000
Subject: [gdal-dev] Limit on the number of files for gdalbuildvrt
In-Reply-To: <1621489.h3OLbH8oeh@even-i700>
References: <CAMWde5pG3iqF1CvatG10r2afj+7SfYOgNy-xFt8_xk17dt9mqw@mail.gmail.com>
 <1621489.h3OLbH8oeh@even-i700>
Message-ID: <CAMWde5oePkpLode4A84PnhLx2==E3NSkYeWZqt8DN7cjEh=Obg@mail.gmail.com>

Dear Even,

Thanks for your help. After a bit more dredging, I am only able to repeat
my problem on a particularly mounted filesystem in an HPC facility I use.
On other systems (and even other mountpoints on that same HPC system)
things work as expected. I've taken this up with our administrators, but
just as a warning to others that it can happen and I didn't dream it!

Thanks for your very prompt reply
Jose

On Wed, 30 Oct 2019 at 16:16, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 30 octobre 2019 15:52:54 CET Jose Gomez-Dans wrote:
> > Hi,
> >
> > I'm mosaicking a large number of small tiles using the GDAL python
> bindings
> > (python 3.7, gdal 3.0.1, but also tested on 2.4.2). Code is something
> like
> >
> > ```
> >
> > *output_fname = "/something/or/other.vrt"*
> > *fnames = ["file1.tif", ..., "fileN.tif"]*
> >
> >
> >
> >
> > *dst_ds = gdal.BuildVRT(            output_fname,            fnames,
> >     options=gdal.BuildVRTOptions(separate=True),        )*
> > *dst_ds = None*
> > ```
> >
> > This fails with lots of errors like
> > ERROR 4: fileXXX.tif: No such file or directory
> > Warning 1: Can't open fileXXX.tif. Skipping it
>
> gdalbuildvrt is normally cautious about non opening too many files at the
> same
> time. I can't replicate your issue with the following script
>
> ```
> from osgeo import gdal
> import shutil
>
> fnames = []
> for i in range(1024):
>     dstname = 'testbuildvrt/byte%d.tif' % i
>     shutil.copy('byte.tif', dstname)
>     fnames.append(dstname)
>
> dst_ds = gdal.BuildVRT(
>             "/tmp/out.vrt",
>             fnames,
>             options=gdal.BuildVRTOptions(separate=True),
>         )
> dst_ds = None
> ```
>
> > The aim of this is to create a VRT mosaic that can then be converted to
> > GeoTIFF.
>
> If you want a mosaic, you likely want separate=False.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/15bd20f4/attachment.html>

From piyush.agram at jpl.nasa.gov  Fri Nov  1 10:23:36 2019
From: piyush.agram at jpl.nasa.gov (Agram, Piyush S (US 334K))
Date: Fri, 1 Nov 2019 17:23:36 +0000
Subject: [gdal-dev] Access control over MEM driver datasets
Message-ID: <E92F6972-D6E4-4A54-BCF4-E1A2577C6DA2@jpl.nasa.gov>

Hi everyone,
     I wanted to bring attention to an issue raised on the github page regarding ReadOnly access to datasets created using the MEM driver.
https://github.com/OSGeo/gdal/issues/1971

Is this a known issue? Do you foresee any problems with taking out the hardcoded GA_Update mode access for MEM datasets?
Any suggestions / pointers would be helpful.

Piyush
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/d59d91a7/attachment.html>

From info at jakobmiksch.eu  Fri Nov  1 11:07:50 2019
From: info at jakobmiksch.eu (Jakob Miksch)
Date: Fri, 1 Nov 2019 19:07:50 +0100
Subject: [gdal-dev] TLDR manpages
Message-ID: <429f608c-e03d-b83a-376e-db22aea71ab3@jakobmiksch.eu>

Dear list,

a short notification:
I added ogr2ogr 
<https://github.com/tldr-pages/tldr/blob/ca086129584524895a97f21ac8664030db1fb710/pages/common/ogr2ogr.md#> 
and ogrinfo 
<https://github.com/tldr-pages/tldr/blob/ca086129584524895a97f21ac8664030db1fb710/pages/common/ogrinfo.md> 
to TLDR: https://tldr.sh/
These are small manpages with focus on practical examples. I find this 
quite helpful.

Maybe someone of you also wants to add examples for other commands or 
critically check what I did.

Best wishes,
Jakob
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/28234b54/attachment.html>

From even.rouault at spatialys.com  Fri Nov  1 11:24:50 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 01 Nov 2019 19:24:50 +0100
Subject: [gdal-dev] Access control over MEM driver datasets
In-Reply-To: <E92F6972-D6E4-4A54-BCF4-E1A2577C6DA2@jpl.nasa.gov>
References: <E92F6972-D6E4-4A54-BCF4-E1A2577C6DA2@jpl.nasa.gov>
Message-ID: <1999312.8snlXkl9TY@even-i700>

On vendredi 1 novembre 2019 17:23:36 CET Agram, Piyush S (US 334K) wrote:
> Hi everyone,
>      I wanted to bring attention to an issue raised on the github page
> regarding ReadOnly access to datasets created using the MEM driver.
> https://github.com/OSGeo/gdal/issues/1971
> 
> Is this a known issue?

Now that it has been raised, yes :-)
The severity doesn't seem very high to me. The impact is only if attempting to 
write to a MEM dataset that wasn't intended to be written (so a programming 
misuse), or am I missing something ?

> Do you foresee any problems with taking out the
> hardcoded GA_Update mode access for MEM datasets?

No, I'd suggest you to submit a PR fixing that and see if that breaks 
something in the continuous integration tests (if so, offending call sites 
should be fixed).

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From davidc.photo at outlook.com  Fri Nov  1 12:34:48 2019
From: davidc.photo at outlook.com (David Cakalic)
Date: Fri, 1 Nov 2019 19:34:48 +0000
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
 reporting EPSG codes
In-Reply-To: <1572595857809-0.post@n6.nabble.com>
References: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>,
 <1572595857809-0.post@n6.nabble.com>
Message-ID: <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>

Link below is to a sample IMG file on WeTransfer:
https://we.tl/t-KtV9xCLaDF

Depending on the computer, this is showing as:
EPSG: -1
EPSG: 26914
EPSG: 6343
when using gdalsrsinfo -e {image}
or
gdalsrsinfo -o epsg {image}


Thank you,
David C.




jratike80 wrote:
Subject: Re: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results reporting EPSG codes

Hi,

Please make is easier for us to help you and provide a link to such raster
file. It does not need to be your real, perhaps confidential data, a small
extract is actually much better. Just take care that if shows all the issues
that you wrote about. Meanwhile you can read
https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn and think if this
change could explain some of your observations.

-Jukka Rahkonen-



David C. wrote
> Hi,
>
> I've been having a problem using gdal to simply read/report EPSG headers
> on rasters.  I am trying to use it to verify header projection information
> is correct.
> First, I am using Windows 10.
> Rasters are Imagine .IMG format.
> Command being used is   gdalsrsinfo -e {filename}
>
> I've tried gdal from various sources/vintages... the problem is I can only
> get it to report the proper (expected) EPSG on 2 of 6 computers... even if
> I take special care to follow same steps each time.  I am also using the
> SAME EXACT image file each time.
>
> The projection is NAD83(2011) / UTM zone 14N.
> So I expect to see EPSG:6343
>
> I'm often getting EPSG:26914
> This is NAD83 / UTM zone 14N   (NOT 2011)
>
> Or I get EPSG:  -1
>
> The gdal install that works as expected on 2 of 6 computers is the version
> that installs on Windows along with  OSgeo4w.  (GDAL 2.4.1 as reported by
> "gdalsrsinfo --version" command)
>
> It only works if I run the gdalsrsinfo command from the C:\OSgeo4w\bin
> folder.... If I run from anywhere else I get the other results mentioned.
> Also, I've installed the same OSgeo4w on all 6 machines... and it only
> works on two.
>
> Other GDAL binaries for Windows I got from the gisinternals website...
> I've tried multiple versions (2.4.1, 2.4.2, 3.0....) and I'm running
> through the command shell provided with that distribution....  All getting
> different results (sometimes -1   sometimes  26914)   but I simply can't
> find any consistency of WHY it is working sometimes and not others.
>
> One concern I have is that perhaps since GDAL is packaged with SO MANY
> programs (ESRI, Qgis, Global Mapper, etc.) that perhaps the command is
> calling incorrect libraries?
>
> Please... if anyone has ideas on WHY this is happening, or how to force
> the command to run from a a CLEAN environment only using the libraries I
> desire, I welcome input.
> Sincerely,
> David C.
>
>
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/a334b58a/attachment.html>

From belyakov-i at spsinf.ru  Fri Nov  1 12:37:07 2019
From: belyakov-i at spsinf.ru (Igor Belyakov)
Date: Fri, 01 Nov 2019 22:37:07 +0300
Subject: [gdal-dev] How do I set PROJ_LIB env variable inside my program?
Message-ID: <59758311572637027@vla1-a1bfe7298e26.qloud-c.yandex.net>

I have a little code snippet that checks if the PROJ data is accessible to GDAL:
        OGRSpatialReference r;
        r.importFromEPSG(4979);
        char * wkt;
        r.exportToWkt(&wkt);
        auto s = qgetenv("PROJ_LIB");
        if (wkt[0] == '\0') throw std::runtime_error("PROJ_LIB error");

This code resides in a dll linked with GDAL. The dll is loaded by QLibrary::load in a lightweight executable after I set PROJ_LIB and GDAL_DATA env variables like so:
        auto appDir = QCoreApplication::applicationDirPath();

        const QByteArray projlib( QDir::toNativeSeparators(
                          appDir + "/libs/GDAL/PROJ_DATA" ).toStdString()
                                                           .c_str()
                                );
        qputenv("PROJ_LIB", projlib);

        const QByteArray gdaldata( QDir::toNativeSeparators(
                           appDir + "/libs/GDAL/GDAL_DATA" ).toStdString()
                                                            .c_str()
                                 );
        qputenv("GDAL_DATA", gdaldata);

The executable is not linked with GDAL, so I figure that GDAL and PROJ are launched after environment variables are set.

I know that the variable "s" after "auto s = qgetenv("PROJ_LIB");" (see the first code snippet) contains a valid path to a folder where all proj data resides. If I set that path to PROJ_LIB env variable in Windows (not in my code), everything works fine and "PROJ_LIB error" exception doesn't appear. But I want my program to operate without making the user to do any global environment changes and without launching .bat scripts that make the user see a console window.

I just tried it in release build and it works without rising the exception. It just doesn't work in debug. So we can use environment variables on developer machines and distribute without any .bat files or intervening in global system settings. But it doesn't seem to be very reliable decision. I don't understand why a "putenv" approach doesn't work in debug build.

From even.rouault at spatialys.com  Fri Nov  1 12:53:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 01 Nov 2019 20:53:59 +0100
Subject: [gdal-dev] How do I set PROJ_LIB env variable inside my program?
In-Reply-To: <59758311572637027@vla1-a1bfe7298e26.qloud-c.yandex.net>
References: <59758311572637027@vla1-a1bfe7298e26.qloud-c.yandex.net>
Message-ID: <3345525.9VPijhfRdA@even-i700>

Igor,

with GDAL 3, use instead OSRSetPROJSearchPaths()

See
https://github.com/OSGeo/gdal/issues/1905#issuecomment-538421434

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew at aitchison.me.uk  Sat Nov  2 02:34:25 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 2 Nov 2019 09:34:25 +0000 (GMT)
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
 reporting EPSG codes
In-Reply-To: <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>
References: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>,
 <1572595857809-0.post@n6.nabble.com>
 <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>
Message-ID: <alpine.DEB.2.21.1911020927200.31246@warden.aitchison.me.uk>

On Fri, 1 Nov 2019, David Cakalic wrote:

> Link below is to a sample IMG file on WeTransfer:
> https://we.tl/t-KtV9xCLaDF
>
> Depending on the computer, this is showing as:
> EPSG: -1
> EPSG: 26914
> EPSG: 6343
> when using gdalsrsinfo -e {image}
> or
> gdalsrsinfo -o epsg {image}

Hmm.
For that file, with gdal 2.4.2 or 2.4.3rc1 I get
 	EPSG:-1
but if I remove $HOME/.gdal/2.4/srs_cache/pcs.wkt.gz the next run gives
 	EPSG:6343
but the next run gives EPSG:-1 again as the cache file has been recreated.

With gdal 3.0.3rc1 I get
 	Confidence in this match: 25 %

 	EPSG:26914


From jukka.rahkonen at maanmittauslaitos.fi  Sat Nov  2 11:51:16 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 2 Nov 2019 11:51:16 -0700 (MST)
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
 reporting EPSG codes
In-Reply-To: <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>
References: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>
 <1572595857809-0.post@n6.nabble.com>
 <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>
Message-ID: <1572720676521-0.post@n6.nabble.com>

Hi,

I guess that the Erdas .img format https://gdal.org/drivers/raster/hfa.html
has somewhat limited support for projections
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/hfa/hfadataset.cpp.

At least there is a difference in behavior with GeoTIFF and img:

gdal_translate -of Gtiff -a_srs epsg:6343 DEM_14T_MK_4636.img DEM_14T_MK.tif
gdalsrsinfo DEM_14T_MK.tif -o epsg
EPSG:6343

gdal_translate -of HFA -a_srs epsg:6343 DEM_14T_MK_4636.img DEM_14T_MK.img
gdalsrsinfo DEM_14T_MK.img -o epsg
EPSG:26914

Perhaps using GeoTIFF format instead of img could be a workaround? 

-Jukka Rahkonen-





David Cakalic wrote
> Link below is to a sample IMG file on WeTransfer:
> https://we.tl/t-KtV9xCLaDF
> 
> Depending on the computer, this is showing as:
> EPSG: -1
> EPSG: 26914
> EPSG: 6343
> when using gdalsrsinfo -e {image}
> or
> gdalsrsinfo -o epsg {image}
> 
> 
> Thank you,
> David C.
> 
> 
> 
> 
> jratike80 wrote:
> Subject: Re: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
> reporting EPSG codes
> 
> Hi,
> 
> Please make is easier for us to help you and provide a link to such raster
> file. It does not need to be your real, perhaps confidential data, a small
> extract is actually much better. Just take care that if shows all the
> issues
> that you wrote about. Meanwhile you can read
> https://trac.osgeo.org/gdal/wiki/rfc73_proj6_wkt2_srsbarn and think if
> this
> change could explain some of your observations.
> 
> -Jukka Rahkonen-
> 
> 
> 
> David C. wrote
>> Hi,
>>
>> I've been having a problem using gdal to simply read/report EPSG headers
>> on rasters.  I am trying to use it to verify header projection
>> information
>> is correct.
>> First, I am using Windows 10.
>> Rasters are Imagine .IMG format.
>> Command being used is   gdalsrsinfo -e {filename}
>>
>> I've tried gdal from various sources/vintages... the problem is I can
>> only
>> get it to report the proper (expected) EPSG on 2 of 6 computers... even
>> if
>> I take special care to follow same steps each time.  I am also using the
>> SAME EXACT image file each time.
>>
>> The projection is NAD83(2011) / UTM zone 14N.
>> So I expect to see EPSG:6343
>>
>> I'm often getting EPSG:26914
>> This is NAD83 / UTM zone 14N   (NOT 2011)
>>
>> Or I get EPSG:  -1
>>
>> The gdal install that works as expected on 2 of 6 computers is the
>> version
>> that installs on Windows along with  OSgeo4w.  (GDAL 2.4.1 as reported by
>> "gdalsrsinfo --version" command)
>>
>> It only works if I run the gdalsrsinfo command from the C:\OSgeo4w\bin
>> folder.... If I run from anywhere else I get the other results mentioned.
>> Also, I've installed the same OSgeo4w on all 6 machines... and it only
>> works on two.
>>
>> Other GDAL binaries for Windows I got from the gisinternals website...
>> I've tried multiple versions (2.4.1, 2.4.2, 3.0....) and I'm running
>> through the command shell provided with that distribution....  All
>> getting
>> different results (sometimes -1   sometimes  26914)   but I simply can't
>> find any consistency of WHY it is working sometimes and not others.
>>
>> One concern I have is that perhaps since GDAL is packaged with SO MANY
>> programs (ESRI, Qgis, Global Mapper, etc.) that perhaps the command is
>> calling incorrect libraries?
>>
>> Please... if anyone has ideas on WHY this is happening, or how to force
>> the command to run from a a CLEAN environment only using the libraries I
>> desire, I welcome input.
>> Sincerely,
>> David C.
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
> 
>> gdal-dev at .osgeo
> 
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> 
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From brandon.biggs at ski.org  Sat Nov  2 21:27:36 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Sun, 3 Nov 2019 04:27:36 +0000
Subject: [gdal-dev] How to Set DXF_FEATURE_LIMIT_PER_BLOCK in ogr2ogr?
Message-ID: <MW2PR16MB2409C1A20CF6D2512B195489F37C0@MW2PR16MB2409.namprd16.prod.outlook.com>

Hello,

I'm running ogr2ogr from a dxf to a geojson, and am getting the following error:



Warning 1: Limit of 10000 features for block A$C6CCD2E37 reached. If you need more, set the DXF_FEATURE_LIMIT_PER_BLOCK

configuration option to the maximum value (or -1 for no limit)



How do I do this? When I type: DXF_FEATURE_LIMIT_PER_BLOCK=-1, DXF_FEATURE_LIMIT_PER_BLOCK -1, - DXF_FEATURE_LIMIT_PER_BLOCK=-1, -- DXF_FEATURE_LIMIT_PER_BLOCK -1, and all the variations of the = and - before DXF_FEATURE_LIMIT_PER_BLOCK, I get an "Unknown option name DXF_FEATURE_LIMIT_PER_BLOCK".

Does anyone know how to configure the system to allow more than 10000 features?

Thanks,


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191103/0754232d/attachment.html>

From even.rouault at spatialys.com  Sun Nov  3 01:24:18 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 Nov 2019 10:24:18 +0100
Subject: [gdal-dev] How to Set DXF_FEATURE_LIMIT_PER_BLOCK in ogr2ogr?
In-Reply-To: <MW2PR16MB2409C1A20CF6D2512B195489F37C0@MW2PR16MB2409.namprd16.prod.outlook.com>
References: <MW2PR16MB2409C1A20CF6D2512B195489F37C0@MW2PR16MB2409.namprd16.prod.outlook.com>
Message-ID: <6677957.hTJQIDU2Om@even-i700>

> How do I do this? When I type: DXF_FEATURE_LIMIT_PER_BLOCK=-1,
> DXF_FEATURE_LIMIT_PER_BLOCK -1, - DXF_FEATURE_LIMIT_PER_BLOCK=-1, --
> DXF_FEATURE_LIMIT_PER_BLOCK -1, and all the variations of the = and -
> before DXF_FEATURE_LIMIT_PER_BLOCK, I get an "Unknown option name
> DXF_FEATURE_LIMIT_PER_BLOCK".
> 

--> https://gdal.org/programs/vector_common_options.html#cmdoption-config

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew at aitchison.me.uk  Sun Nov  3 01:29:28 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sun, 3 Nov 2019 09:29:28 +0000 (GMT)
Subject: [gdal-dev] How to Set DXF_FEATURE_LIMIT_PER_BLOCK in ogr2ogr?
In-Reply-To: <MW2PR16MB2409C1A20CF6D2512B195489F37C0@MW2PR16MB2409.namprd16.prod.outlook.com>
References: <MW2PR16MB2409C1A20CF6D2512B195489F37C0@MW2PR16MB2409.namprd16.prod.outlook.com>
Message-ID: <alpine.DEB.2.21.1911030919010.26271@warden.aitchison.me.uk>

On Sun, 3 Nov 2019, Brandon Biggs wrote:

> Hello,
>
> I'm running ogr2ogr from a dxf to a geojson, and am getting the following error:
> Warning 1: Limit of 10000 features for block A$C6CCD2E37 reached. If you need more, set the DXF_FEATURE_LIMIT_PER_BLOCK
> configuration option to the maximum value (or -1 for no limit)
>
> How do I do this? When I type: DXF_FEATURE_LIMIT_PER_BLOCK=-1, DXF_FEATURE_LIMIT_PER_BLOCK -1, - DXF_FEATURE_LIMIT_PER_BLOCK=-1, -- DXF_FEATURE_LIMIT_PER_BLOCK -1, and all the variations of the = and - before DXF_FEATURE_LIMIT_PER_BLOCK, I get an "Unknown option name DXF_FEATURE_LIMIT_PER_BLOCK".
>
> Does anyone know how to configure the system to allow more than 10000 features?

What sort of system are you running ?

If it is unix/linux with bash shell try:
     export DXF_FEATURE_LIMIT_PER_BLOCK=-1
for csh and tcsh try:
     setenv DXF_FEATURE_LIMIT_PER_BLOCK -1
- other unix shells may be one of these too
(that includes the new windows bash shell and MacOS).

I'm not good with Windows but it might be:
     set DXF_FEATURE_LIMIT_PER_BLOCK=-1
from a command shell. If you are running via a GUI
you may need to set it via the Environment Variables
button deep within the Power User Task Menu.

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From landa.martin at gmail.com  Sun Nov  3 05:28:46 2019
From: landa.martin at gmail.com (Martin Landa)
Date: Sun, 3 Nov 2019 14:28:46 +0100
Subject: [gdal-dev] set GDAL ColorTable from QGIS QML file
In-Reply-To: <CA+Ei1OfrEGtuW=Tp8qauJC+A-vgr50imzAHUYr9_X-tGoBdwzQ@mail.gmail.com>
References: <CA+Ei1OfrEGtuW=Tp8qauJC+A-vgr50imzAHUYr9_X-tGoBdwzQ@mail.gmail.com>
Message-ID: <CA+Ei1OcL7JqBodcbwCUXDp4x1fZGaCFALD2m=sa6=w6EbvgvuA@mail.gmail.com>

Hi,

pá 1. 11. 2019 v 10:44 odesílatel Martin Landa <landa.martin at gmail.com> napsal:
> is there any option how to define GDAL color table from existing QGIS
> QML file directly via GDAL Python API (at least with limited
> functionality)? Thanks in advance for feedback, best regards, Martin

the most easier way will be probably to write own parser, sorry for
the noise. Martin

-- 
Martin Landa
http://geo.fsv.cvut.cz/gwiki/Landa
http://gismentors.cz/mentors/landa

From jluis at ualg.pt  Sun Nov  3 10:00:56 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Sun, 3 Nov 2019 18:00:56 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
 <52c0605c-c20e-5d40-357e-5503dd833788@duif.net>,
 <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>
 <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>
Message-ID: <DB8PR04MB6697224E6EA43E98E0B8A13EA67C0@DB8PR04MB6697.eurprd04.prod.outlook.com>

GMT pays particular attention to this matter and detects grid vs pixel registration by checking the X,Y vector coordinates versus array sizes (for netCDF). It normally has no problem detecting the two cases.

Joaquim

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Ivan Lucena
Sent: Friday, November 1, 2019 1:18 PM
To: Andrew C Aitchison <andrew at aitchison.me.uk>; Richard Duivenvoorde <rdmailings at duif.net>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates

Thanks Andrew and Richard,

Very good examples.

I have struggled with that so many times when developing GDAL drivers or when dealing with data in formats like HDF4, HDF5, NetCDF.

Some formats have a pretty good easy way of telling which way to go about upperleft or center pixel coordinate. But that is not the case with "flexible" formats like the ones above. In some cases developer have to identify the data product in a hardcode way and apply what the documentation says about the data, not only in regards to pixel coordinate but other issues.

What is interesting in that case is that one can say that according to the documentation the driver is correct. The -180,80 coordinate is in the center of the pixel. But when putting that date to real use, that seems to be incorrect.

And that could be dangerous or at least inconvenient. In my case I have a Python code that does zonal statistic and when a geometry is converted to a little raster binary mask, it does not match the same area in the ProbaV data and the results is a crash in Fiji because ReadRaster goes overboard or lost of NDVI data in other regions. The half pixel shift grows as you go east.

In other case, a GIS user might find impossible to run a raster tool, because it will complain that all the raster sources that they are trying to combine does not match the same area. There are still some tool like that in the marked, unfortunately.

If I have some time, I will try to run the NetCDF driver in step-by-step debugging mode to see exactly how the crs:GeoTransform is (mis)handled.

The goal is to see if the data is wrong or if the driver is wrong (or if I am wrong) and to decided how to go from here. We might need to add some hardcoded decision into the NetCDF driver, which I would prefer not to do.

Best regards,

Ivan

________________________________
From: Andrew C Aitchison <andrew at aitchison.me.uk<mailto:andrew at aitchison.me.uk>>
Sent: Friday, November 1, 2019 7:24 AM
To: Richard Duivenvoorde <rdmailings at duif.net<mailto:rdmailings at duif.net>>
Cc: Ivan Lucena <ivan.lucena at outlook.com<mailto:ivan.lucena at outlook.com>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates


Does
   https://gis.stackexchange.com/questions/122670/is-there-a-standard-for-the-coordinates-of-pixels-in-georeferenced-rasters#122687
help you to understand the issue ?

On Fri, 1 Nov 2019, Richard Duivenvoorde wrote:

> Hi Ivan,
>
> I think I reported an issue like this some time ago in the QGIS issue
> tracker:
>
> https://issues.qgis.org/issues/20730
>
> I think(!), but I hope some netcdf guru jumps in, that the crux is how
> you define/interpret your data: is the value valid in the center of the
> grid (like a raster) or is it on the vertices (more like a mesh).
> It is all about interpretation of a datamodel: is it a grid or a raster.
>
> If I understand correctly in a mesh (and netcdf) is much more possible
> then in a raster: triangular meshes, non-regular etc etc:
>
> https://docs.qgis.org/3.4/en/docs/user_manual/working_with_mesh/mesh_properties.html
>
> I'm not sure who should be responsible for 'correcting/transforming'
> this: a netcdf which is written as if the values are on (for example)
> the upper-left corner vertices, while you actually mean the value is in
> the center of a (grid)cell... For a simple rectangular mesh, this seems
> feasible on the client side (see panoply example in first link), but for
> non-regular meshes/netcdf's this seems impossible client side (well
> actually that is not a raster/grid anymore)..
>
> In your case I would think that the data is actually mend to be a grid...
>
> Not sure if this is helpfull, as said I hope some netcdf guru jumps in.
> Maybe I'm oversimplifying here...
>
> Regards,
>
> Richard Duivenvoorde
>
> On 31/10/2019 22.06, Ivan Lucena wrote:
>>
>> Hi Folks,
>>
>> I Downloaded NetCDF files
>> from?http://land.copernicus.eu/global/products/ndvi and I am having
>> problems with the GeoTransform that the driver is getting.
>>
>> The image extents, as you can see in following gdalinfo report, goes
>> beyond the -180 and +180 longitude degrees (half resolution, half pixel)
>> but that's OK according to page 27 in the PDF documentation:
>> PROBAV-Products_User_Manual_v1.3.pdf
>> <https://earth.esa.int/documents/700255/1929094/PROBAV-Products_User_Manual_v1.3.pdf/fd5e30f4-5305-4d41-86aa-fab7b9568251>?
>>
>> But if I open that image on QGIS and overlay a vector (GADM from
>> gadm.org) or any other global layer it is clear that -180x80 should be
>> in the upper left corner of the image, not In the center. There is a
>> half pixel missing on the left and bottom of the image. This in in Fiji:
>>
>>
>>
>> The gdalinfo report shows that the crs:GeoTransform is?-180.0000000000
>> 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905 but it seems like the
>> driver decided to take that to as center of the pixel based. Looking at
>> the NetCDF source I can see that there this possibility exists.
>>
>> Of course, I am not waiting for a solution. I just used gdal_translate
>> "- a_ullr" and fix that into the target format. It takes centuries to
>> converted that image to geotiff. But I am concerned that others might
>> get in trouble because of that.
>>
>> I tried to contact the data provider but did not received an answer yet.
>>
>> Does anybody has experience with that dataset and/or NetCDF that can
>> help figure out what is going on. It is a bug in the driver or an issue
>> with the data.
>>
>> Thanks,
>>
>> -
>> Ivan
>>
>> Here is the gdalinfo report:
>>
>> Don't worry about the warnings in regards to the pixel values. It is fine.
>>
>> $ gdalinfo netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc
>> --debug on
>> GDAL_netCDF: driver detected file type=5, libnetcdf detected type=3​
>> Warning 1: NetCDF driver detected file type=5, but libnetcdf detected
>> type=3​
>> GDAL_netCDF: setting file type to 3, was 5​
>> GDAL_netCDF: dim_count = 2​
>> GDAL_netCDF: var_count = 4​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF:​
>> =====​
>> SetProjectionFromVar( 3)​
>> *GDAL_netCDF: got grid_mapping crs​*
>> GDAL_netCDF: bIsGdalFile=1 bIsGdalCfFile=0 bBottomUp=0​
>> GDAL_netCDF: got spheroid from CF: (6378137.000000 , 298.257224)​
>> GDAL_netCDF: set bBottomUp = 0 from Y axis​
>> GDAL_netCDF: setting WKT from CF​
>> GDAL_netCDF: SetProjection, WKT =
>> GEOGCS["unknown",DATUM["unknown",SPHEROID["Spheroid",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]]
>> ​
>> GDAL_netCDF: xdim: 120960 nSpacingBegin: 3 nSpacingMiddle: 3
>> nSpacingLast: 3​
>> GDAL_netCDF: ydim: 47040 nSpacingBegin: -3 nSpacingMiddle: -3
>> nSpacingLast: -3​
>> GDAL_netCDF: setting WKT from GDAL​
>> GDAL_netCDF: SetProjection, WKT = GEOGCS["WGS
>> 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> *GDAL_netCDF:
>> SetGeoTransform(-180.001488,0.002976,0.000000,80.001488,0.000000,-0.002976)
>> ​*
>> GDAL_netCDF: bGotGeogCS=1 bGotCfSRS=1 bGotCfGT=1 bGotGdalSRS=1 bGotGdalGT=0​
>> Warning 1: Unsupported netCDF datatype (7), treat as Float32.​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: netcdf type=5 gdal type=6 signedByte=1​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
>> GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
>> GDAL_netCDF: got add_offset=-0.07999999821186066, status=0​
>> GDAL_netCDF: got scale_factor=0.004000000189989805, status=0​
>> GDAL: GDALOpen(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0) succeeds as netCDF.​
>> Driver: netCDF/Network Common Data Format​
>> GDAL: GDALDefaultOverviews::OverviewScan()​
>> Files: none associated​
>> Size is 120960, 47040​
>> Coordinate System is:​
>> GEOGCS["WGS 84",​
>> ? ? DATUM["WGS_1984",​
>> ? ? ? ? SPHEROID["WGS 84",6378137,298.257223563,​
>> ? ? ? ? ? ? AUTHORITY["EPSG","7030"]],​
>> ? ? ? ? TOWGS84[0,0,0,0,0,0,0],​
>> ? ? ? ? AUTHORITY["EPSG","6326"]],​
>> ? ? PRIMEM["Greenwich",0,​
>> ? ? ? ? AUTHORITY["EPSG","8901"]],​
>> ? ? UNIT["degree",0.0174532925199433,​
>> ? ? ? ? AUTHORITY["EPSG","9108"]],​
>> ? ? AUTHORITY["EPSG","4326"]]​
>> *Origin = (-180.001488095238102,80.001488095238088)​*
>> Pixel Size = (0.002976190476204,-0.002976190476190)​
>> Metadata:​
>> *? crs#GeoTransform=-180.0000000000 0.0029761905 0.0 80.0000000000 0.0
>> -0.0029761905​*
>> ? crs#grid_mapping_name=latitude_longitude​
>> ? crs#inverse_flattening=298.257223563​
>> ? crs#longitude_of_prime_meridian=0​
>> ? crs#long_name=coordinate reference system​
>> ? crs#semi_major_axis=6378137​
>> ? crs#spatial_ref=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS
>> 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]
>> ​
>> ? crs#_CoordinateAxisTypes=GeoX GeoY​
>> ? crs#_CoordinateTransformType=Projection​
>> ? lat#axis=Y​
>> ? lat#DIMENSION_LABELS=lat​
>> ? lat#long_name=latitude​
>> ? lat#standard_name=latitude​
>> ? lat#units=degrees_north​
>> ? lat#_CoordinateAxisType=Lat​
>> ? lon#axis=X​
>> ? lon#DIMENSION_LABELS=lon​
>> ? lon#long_name=longitude​
>> ? lon#standard_name=longitude​
>> ? lon#units=degrees_east​
>> ? lon#_CoordinateAxisType=Lon​
>> ? NC_GLOBAL#archive_facility=VITO​
>> ? NC_GLOBAL#Conventions=CF-1.6​
>> ? NC_GLOBAL#copyright=Copernicus Service information 2019​
>> ? NC_GLOBAL#history=Processing line NDVI: 2019-10-22​
>> ?
>> NC_GLOBAL#identifier=urn:cgls:global:ndvi300_v1_333m:NDVI300_201910110000_GLOBE_PROBAV_V1.0.1
>> ​
>> ? NC_GLOBAL#institution=VITO NV​
>> ? NC_GLOBAL#long_name=Normalized Difference Vegetation Index​
>> ? NC_GLOBAL#orbit_type=LEO​
>> ? NC_GLOBAL#parent_identifier=urn:cgls:global:ndvi300_v1_333m​
>> ? NC_GLOBAL#platform=Proba-V​
>> ? NC_GLOBAL#processing_level=L3​
>> ? NC_GLOBAL#processing_mode=Near Real Time​
>> ? NC_GLOBAL#product_version=V1.0.1​
>> ? NC_GLOBAL#references=http://land.copernicus.eu/global/products/ndvi​
>> ? NC_GLOBAL#sensor=VEGETATION​
>> ? NC_GLOBAL#source=Derived from EO satellite imagery​
>> ? NC_GLOBAL#time_coverage_end=2019-10-20T23:59:59Z​
>> ? NC_GLOBAL#time_coverage_start=2019-10-11T00:00:00Z​
>> ? NC_GLOBAL#title=10-daily Normalized Difference Vegetation Index 333M:
>> GLOBE 2019-10-11T00:00:00Z​
>> ? NDVI#add_offset=-0.079999998​
>> ? NDVI#flag_meanings=Missing cloud snow sea background​
>> ? NDVI#flag_values={}​
>> ? NDVI#grid_mapping=crs​
>> ? NDVI#long_name=Normalized Difference Vegetation Index 333M​
>> ? NDVI#missing_value=​
>> ? NDVI#scale_factor=0.0040000002​
>> ? NDVI#standard_name=normalized_difference_vegetation_index​
>> ? NDVI#units=​
>> ? NDVI#valid_range={}​
>> ? NDVI#_FillValue=​
>> OGRCT: PROJ >= 4.8.0 features enabled​
>> OGRCT: Using locale-safe proj version​
>> OGRCT: Source: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> OGRCT: Target: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
>> Corner Coordinates:​
>> *Upper Left ?(-180.0014881, ?80.0014881) (180d 0' 5.36"W, 80d 0' 5.36"N)​*
>> *Lower Left ?(-180.0014881, -59.9985119) (180d 0' 5.36"W, 59d59'54.64"S)​*
>> *Upper Right ( 179.9985119, ?80.0014881) (179d59'54.64"E, 80d 0' 5.36"N)​*
>> *Lower Right ( 179.9985119, -59.9985119) (179d59'54.64"E, 59d59'54.64"S)​*
>> Center ? ? ?( ?-0.0014881, ?10.0014881) ( ?0d 0' 5.36"W, 10d 0' 5.36"N)​
>> Band 1 Block=120960x1 Type=Float32, ColorInterp=Undefined​
>> ? NoData Value=0​
>> ? Offset: -0.0799999982118607, ? Scale:0.00400000018998981​
>> ? Metadata:​
>> ? ? add_offset=-0.079999998​
>> ? ? flag_meanings=Missing cloud snow sea background​
>> ? ? flag_values={}​
>> ? ? grid_mapping=crs​
>> ? ? long_name=Normalized Difference Vegetation Index 333M​
>> ? ? missing_value=​
>> ? ? NETCDF_VARNAME=NDVI​
>> ? ? scale_factor=0.0040000002​
>> ? ? standard_name=normalized_difference_vegetation_index​
>> ? ? units=​
>> ? ? valid_range={}​
>> ? ? _FillValue=​
>> GDAL:
>> GDALClose(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc,
>> this=00000219E2D291F0)​
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191103/c1b6b0e4/attachment-0001.html>

From markus.metz.giswork at gmail.com  Sun Nov  3 12:20:56 2019
From: markus.metz.giswork at gmail.com (Markus Metz)
Date: Sun, 3 Nov 2019 21:20:56 +0100
Subject: [gdal-dev] GDAL 2 + PROJ 6 does not work
Message-ID: <CAG+h=FGLAwuhpT_hq_NDMuZ4HeQH3LAvTcuk-LBFJx0uy6dyOg@mail.gmail.com>

Hopefully some package maintainers are listening.

A CRS constructed from a proj string (deprecated in GDAL 3 + PROJ 6, I
know), works either in PROJ 6 or in GDAL 2, but not in both. The reason is
that for PROJ 6, "+type=crs" is needed, but unfortunately GDAL 2 does not
recognize this parameter and subsequently can not create a CRS from a proj
string containing "+type=crs".

Therefore I recommend to not package GDAL 2 with PROJ 6.

Markus M
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191103/8d225fee/attachment.html>

From even.rouault at spatialys.com  Sun Nov  3 13:42:54 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 Nov 2019 22:42:54 +0100
Subject: [gdal-dev] GDAL 2 + PROJ 6 does not work
In-Reply-To: <CAG+h=FGLAwuhpT_hq_NDMuZ4HeQH3LAvTcuk-LBFJx0uy6dyOg@mail.gmail.com>
References: <CAG+h=FGLAwuhpT_hq_NDMuZ4HeQH3LAvTcuk-LBFJx0uy6dyOg@mail.gmail.com>
Message-ID: <6459637.nHUpXZE4MP@even-i700>

On dimanche 3 novembre 2019 21:20:56 CET Markus Metz wrote:
> Hopefully some package maintainers are listening.
> 
> A CRS constructed from a proj string (deprecated in GDAL 3 + PROJ 6, I
> know), works either in PROJ 6 or in GDAL 2, but not in both. The reason is
> that for PROJ 6, "+type=crs" is needed, but unfortunately GDAL 2 does not
> recognize this parameter and subsequently can not create a CRS from a proj
> string containing "+type=crs".

For the sake of my curiousity, can you explain exactly how you go into 
problems ?
The only quirk I found on quick tests with GDAL 2.4 + PROJ 6 is when using the 
now deprecated "+init=epsg:XXXX" syntax

$ gdalsrsinfo "+init=epsg:4326"

proj_create: init=epsg:/init=IGNF: syntax not supported in non-PROJ4 emulation 
mode

And autotest/osr pass, except one corner test.

> Therefore I recommend to not package GDAL 2 with PROJ 6.

Indeed, GDAL 2 is best used with PROJ 5.2.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Nov  3 13:45:33 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 Nov 2019 22:45:33 +0100
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
 <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>
 <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>
Message-ID: <2538251.CmBU5Sys7W@even-i700>

> Some formats have a pretty good easy way of telling which way to go about
> upperleft or center pixel coordinate. But that is not the case with
> "flexible" formats like the ones above. 

The CF conventions apply here. Also that
http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html
says is
"If bounds are not provided, an application might reasonably assume the gridpoints
to be at the centers of the cells, but we do not require that in this standard."
And that's what GDAL does. It assumes that the values of the lat, lon variables
are center of cells coordinates, hence the half pixel shift to go back to GDAL
topleft corner convention
 
> What is interesting in that case is that one can say that according to the
> documentation the driver is correct. The -180,80 coordinate is in the
> center of the pixel. But when putting that date to real use, that seems to
> be incorrect.

The products are not self consistent if you consider the crs:GeoTransform property,
the documentation of the product and the actual values of the lon, lat arrays

ncdump shows:
        lon = 120960 ;

                crs:GeoTransform = "-180.0000000000 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905" ;

		 lon = -180, -179.997023809524, ... , 179.994047620685, 179.997023811161

Normally in GDAL, the GeoTransform origin is the topleft corner, not the pixel center.

I think clarificiation should be sought after the data producer to find:
- what is the intended registration of their product ?
- and that they fix either their GeoTransform or their lon, lat arrays to be consistent.

> The half pixel shift grows as you go
> east.

I don't get this. The spacing of values in the lon array seems constant, so the shift
if any should also be constant.
 
> If I have some time, I will try to run the NetCDF driver in step-by-step
> debugging mode to see exactly how the crs:GeoTransform is (mis)handled.

The logic of the driver is to use the GeoTransform if it can derive one from the lon, lat
variables. See
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/netcdf/netcdfdataset.cpp#L3776

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Nov  3 14:58:38 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 Nov 2019 23:58:38 +0100
Subject: [gdal-dev] Fwd: [Tiff] Libtiff 4.1.0 is released
Message-ID: <33476847.SdoYlZBmBe@even-i700>

FYI

This version will be especialy useful with GDAL 3.1.0 since it exposes in 
libtiff public API functions that are needed to better deal with large remote 
TIFF files (optimizations that were only available with a GDAL build using 
internal libtiff), and for the latest improvements regarding COG generation.

Even

----------  Forwarded Message  ----------

Subject: [Tiff] Libtiff 4.1.0 is released
Date: dimanche 3 novembre 2019, 16:52:34 CET
From: Bob Friesenhahn <bfriesen at simple.dallas.tx.us>
To: Tiff List <tiff at lists.osgeo.org>

libtiff 4.1.0 is now available.  Read about this release at
http://www.simplesystems.org/libtiff/v4.1.0.html or 
http://libtiff.maptools.org/v4.1.0.html.

This release is a product of Even Rouault, Thomas Bernard, and 
several others.

These two files are available with the associated sha1sum:

7a882f8d55fd0620cbf89c47994d2d1d3b975452  tiff-4.1.0.tar.gz
e0f81cbb79760e81b4e6fe276cc530e41d7aeaf6  tiff-4.1.0.zip

The release files are also signed with my private PGP key, and the 
associated signature files have ".sig" extensions.

As usual, a great many security issues have been fixed in the 
software.  The large number of issues fixed are due to participating 
in Google's oss-fuzz project (as well as Coverity) and are not due to 
the software being abnormally insecure.  Libtiff has become quite 
robust.

The library should be upward compatable (drop in replacement without 
re-compiling dependent programs) with any 4.0.X release since it only 
adds a few extra functions and preserves the existing ABI.

Bob
-- 
Bob Friesenhahn
bfriesen at simple.dallas.tx.us, http://www.simplesystems.org/users/bfriesen/
GraphicsMagick Maintainer,    http://www.GraphicsMagick.org/
Public Key,     http://www.simplesystems.org/users/bfriesen/public-key.txt
_______________________________________________
Tiff mailing list
Tiff at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/tiff

-----------------------------------------
-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Sun Nov  3 23:55:30 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 4 Nov 2019 00:55:30 -0700 (MST)
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results
 reporting EPSG codes
In-Reply-To: <1572720676521-0.post@n6.nabble.com>
References: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>
 <1572595857809-0.post@n6.nabble.com>
 <DM6PR18MB3355C04FDE4C040EBE83D7F583620@DM6PR18MB3355.namprd18.prod.outlook.com>
 <1572720676521-0.post@n6.nabble.com>
Message-ID: <1572854130824-0.post@n6.nabble.com>

If it happens to help, by opening the .img file with a text editor I found
this ESRI style WKT from it:

COMPD_CS["unknown",PROJCS["NAD_1983_2011_UTM_Zone_14N",GEOGCS["GCS_NAD_1983_2011",DATUM["D_NAD_1983_2011",SPHEROID["GRS_1980",6378137.0,298.257222101]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Transverse_Mercator"],PARAMETER["False_Easting",500000.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",-99.0],PARAMETER["Scale_Factor",0.9996],PARAMETER["Latitude_Of_Origin",0.0],UNIT["Meter",1.0]],VERTCS["NAVD_1988",VDATUM["North_American_Vertical_Datum_1988",AUTHORITY["EPSG","5103"]],PARAMETER["Vertical_Shift",0.0,AUTHORITY["Esri","100006"]],PARAMETER["Direction",1.0,AUTHORITY["Esri","100007"]],UNIT["Meter",1.0,AUTHORITY["EPSG","9001"]],AUTHORITY["EPSG","5703"]]]

WKT does not include code for the projected coordinate system so I think
that GDAL and the HFA driver must find it by studying the parameters.
Perhaps they fail now with these two:

GEOGCS["GCS_NAD_1983_2011",DATUM["D_NAD_1983_2011"

-Jukka-


jratike80 wrote
> Hi,
> 
> I guess that the Erdas .img format
> https://gdal.org/drivers/raster/hfa.html
> has somewhat limited support for projections
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/hfa/hfadataset.cpp.
> 
> At least there is a difference in behavior with GeoTIFF and img:
> 
> gdal_translate -of Gtiff -a_srs epsg:6343 DEM_14T_MK_4636.img
> DEM_14T_MK.tif
> gdalsrsinfo DEM_14T_MK.tif -o epsg
> EPSG:6343
> 
> gdal_translate -of HFA -a_srs epsg:6343 DEM_14T_MK_4636.img DEM_14T_MK.img
> gdalsrsinfo DEM_14T_MK.img -o epsg
> EPSG:26914
> 
> Perhaps using GeoTIFF format instead of img could be a workaround? 
> 
> -Jukka Rahkonen-





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From tim.jacobs at vito.be  Mon Nov  4 00:26:27 2019
From: tim.jacobs at vito.be (Jacobs Tim)
Date: Mon, 4 Nov 2019 08:26:27 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
Message-ID: <1c25190b5df5448399c4e914e2ab570a@VITOMAIL5.vito.local>

Dear GDAL experts,

Working for the provider of the PROBA-V data, I can confirm that
the intention is to have a grid with integer degrees at pixel centre.
So the -180.00xxx (half pixel west of -180) reported by gdalinfo for upperleft corner of upperleft pixel is fine,
though we realize that this gridding can cause trouble when using it in practice (e.g. GRASS GIS warns about it).

We typically provide data in both generic container (HDF5 and more recently netCDF4)
as well as GeoTIFF format (for GIS).

@Ivan - to contact our support service, please email helpdeskticket at vgt.vito.be<mailto:helpdeskticket at vgt.vito.be>.

Best regards,
Tim Jacobs

Indien u VITO Mol bezoekt, hou aub er dan rekening mee dat de hoofdingang voortaan enkel bereikbaar is vanuit de richting Dessel-Retie, niet vanuit richting Mol, zie vito.be/route.<http://www.vito.be/route>
If you plan to visit VITO at Mol, then please note that the main entrance can only be reached coming from Dessel-Retie and no longer coming from Mol, see vito.be/en/contact/locations.<http://www.vito.be/en/contact/locations>
VITO Disclaimer: http://www.vito.be/e-maildisclaimer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191104/696ab17c/attachment.html>

From even.rouault at spatialys.com  Mon Nov  4 03:25:33 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 12:25:33 +0100
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <1572526173735-0.post@n6.nabble.com>
References: <3867881.MbL6gJQLIP@even-i700> <1572526173735-0.post@n6.nabble.com>
Message-ID: <2342723.UMx1L4pW7i@even-i700>

> Even Rouault-2 wrote
> 
> > Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
> 

I declare this motion passed with +1 from PSC members JukkaR, SeanG, DanielM, 
HowardB, MateuszL and myself

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  4 03:50:39 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 12:50:39 +0100
Subject: [gdal-dev] GDAL/OGR 2.4.3 is released
Message-ID: <1889482.dik1M7u9Hu@even-i700>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the 
release of the GDAL/OGR 2.4.3 bug fix version. This adds 45 bug fixes on top 
of 2.4.2.

Consult the release notes for the list of issues addressed :
  https://trac.osgeo.org/gdal/wiki/Release/2.4.3-News

The sources are available at:

    http://download.osgeo.org/gdal/2.4.3/gdal-2.4.3.tar.xz
    http://download.osgeo.org/gdal/2.4.3/gdal-2.4.3.tar.gz
    http://download.osgeo.org/gdal/2.4.3/gdal243.zip
    http://download.osgeo.org/gdal/2.4.3/gdal-grass-2.4.3.tar.gz

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  4 03:50:43 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 12:50:43 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
Message-ID: <2771968.1AohNxJvWG@even-i700>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the 
release of the GDAL/OGR 3.0.2 bug fix version. This adds 63 bug fixes on top 
of 3.0.1

Consult the release notes for the list of issues addressed :
  https://trac.osgeo.org/gdal/wiki/Release/3.0.2-News

The sources are available at:

    http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2.tar.xz
    http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2.tar.gz
    http://download.osgeo.org/gdal/3.0.2/gdal302.zip
    http://download.osgeo.org/gdal/3.0.2/gdal-grass-3.0.2.tar.gz

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov  4 04:33:21 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 4 Nov 2019 05:33:21 -0700 (MST)
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <2771968.1AohNxJvWG@even-i700>
References: <2771968.1AohNxJvWG@even-i700>
Message-ID: <1572870801181-0.post@n6.nabble.com>

Hi,

Release notes are in trac and therefore the ticket numbers are now pointing
to the old trac issues as well and not to GitHub. Example:
https://trac.osgeo.org/gdal/ticket/1710

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> On behalf of the GDAL/OGR development team, I am pleased to announce the 
> release of the GDAL/OGR 3.0.2 bug fix version. This adds 63 bug fixes on
> top 
> of 3.0.1
> 
> Consult the release notes for the list of issues addressed :
>   https://trac.osgeo.org/gdal/wiki/Release/3.0.2-News
> 
> The sources are available at:
> 
>     http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2.tar.xz
>     http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2.tar.gz
>     http://download.osgeo.org/gdal/3.0.2/gdal302.zip
>     http://download.osgeo.org/gdal/3.0.2/gdal-grass-3.0.2.tar.gz
> 
> Best regards,
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Nov  4 05:55:46 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 14:55:46 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <1572870801181-0.post@n6.nabble.com>
References: <2771968.1AohNxJvWG@even-i700> <1572870801181-0.post@n6.nabble.com>
Message-ID: <19193962.Vcep3Ccg0M@even-i700>

On lundi 4 novembre 2019 05:33:21 CET jratike80 wrote:
> Hi,
> 
> Release notes are in trac and therefore the ticket numbers are now pointing
> to the old trac issues as well and not to GitHub. Example:
> https://trac.osgeo.org/gdal/ticket/1710
> 

I've fixed the links of the Trac News pages. Ultimately for next releases, we 
might want to create such pages to GitHub wiki or .rst documentation itself.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Mon Nov  4 05:56:04 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 4 Nov 2019 14:56:04 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <1572870801181-0.post@n6.nabble.com>
References: <2771968.1AohNxJvWG@even-i700> <1572870801181-0.post@n6.nabble.com>
Message-ID: <CABUeae99miZdtFm3JxjS-r0feH3EwWAbptH4dnnxyreKfLYV4g@mail.gmail.com>

On Mon, 4 Nov 2019 at 13:33, jratike80
<jukka.rahkonen at maanmittauslaitos.fi> wrote:
>
> Release notes are in trac and therefore the ticket numbers are now pointing
> to the old trac issues as well and not to GitHub. Example:
> https://trac.osgeo.org/gdal/ticket/1710

I'm also wondering Trac is still being used.
Aren't the in-repo notes sufficient?
https://github.com/OSGeo/gdal/blob/release/3.0/gdal/NEWS

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Mon Nov  4 05:57:20 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 4 Nov 2019 14:57:20 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <19193962.Vcep3Ccg0M@even-i700>
References: <2771968.1AohNxJvWG@even-i700> <1572870801181-0.post@n6.nabble.com>
 <19193962.Vcep3Ccg0M@even-i700>
Message-ID: <CABUeae8zYruPoyCFprA4Cun47NiaFTYQ-hVL83UFz+tHWFK4aQ@mail.gmail.com>

On Mon, 4 Nov 2019 at 14:55, Even Rouault <even.rouault at spatialys.com> wrote:
> On lundi 4 novembre 2019 05:33:21 CET jratike80 wrote:
> >
> > Release notes are in trac and therefore the ticket numbers are now pointing
> > to the old trac issues as well and not to GitHub. Example:
> > https://trac.osgeo.org/gdal/ticket/1710
> >
>
> I've fixed the links of the Trac News pages. Ultimately for next releases, we
> might want to create such pages to GitHub wiki or .rst documentation itself.

IMHO, ideally if notes could be maintained in NEWS.rst which
is included in Sphinx toctree or download pages.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Mon Nov  4 06:17:41 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 15:17:41 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <CABUeae99miZdtFm3JxjS-r0feH3EwWAbptH4dnnxyreKfLYV4g@mail.gmail.com>
References: <2771968.1AohNxJvWG@even-i700> <1572870801181-0.post@n6.nabble.com>
 <CABUeae99miZdtFm3JxjS-r0feH3EwWAbptH4dnnxyreKfLYV4g@mail.gmail.com>
Message-ID: <7034323.17DmhbOnXt@even-i700>

On lundi 4 novembre 2019 14:56:04 CET Mateusz Loskot wrote:
> On Mon, 4 Nov 2019 at 13:33, jratike80
> 
> <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> > Release notes are in trac and therefore the ticket numbers are now
> > pointing
> > to the old trac issues as well and not to GitHub. Example:
> > https://trac.osgeo.org/gdal/ticket/1710
> 
> I'm also wondering Trac is still being used.
> Aren't the in-repo notes sufficient?
> https://github.com/OSGeo/gdal/blob/release/3.0/gdal/NEWS

That might be sufficient indeed. What we loose currently is the clickability 
to the ticket. Unfortunaltely just switching it to markdown doesn't make #XXX 
to point automatically to the issues #XXX

So we'd have to use syntax like

fix bla [#1][i1]

[i1]: https://github.com/OSGeo/gdal/issues/1

or

fix bla [#1](https://github.com/OSGeo/gdal/issues/1)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Mon Nov  4 06:43:55 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 4 Nov 2019 15:43:55 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <7034323.17DmhbOnXt@even-i700>
References: <2771968.1AohNxJvWG@even-i700> <1572870801181-0.post@n6.nabble.com>
 <CABUeae99miZdtFm3JxjS-r0feH3EwWAbptH4dnnxyreKfLYV4g@mail.gmail.com>
 <7034323.17DmhbOnXt@even-i700>
Message-ID: <CABUeae_hY0QV6bELpZ=NkML8zQpSurhRVHys9Xqz9Cbjw=q67Q@mail.gmail.com>

On Mon, 4 Nov 2019 at 15:17, Even Rouault <even.rouault at spatialys.com> wrote:
> On lundi 4 novembre 2019 14:56:04 CET Mateusz Loskot wrote:
> > On Mon, 4 Nov 2019 at 13:33, jratike80
> >
> > <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> > > Release notes are in trac and therefore the ticket numbers are now
> > > pointing
> > > to the old trac issues as well and not to GitHub. Example:
> > > https://trac.osgeo.org/gdal/ticket/1710
> >
> > I'm also wondering Trac is still being used.
> > Aren't the in-repo notes sufficient?
> > https://github.com/OSGeo/gdal/blob/release/3.0/gdal/NEWS
>
> That might be sufficient indeed. What we loose currently is the clickability
> to the ticket. Unfortunaltely just switching it to markdown doesn't make #XXX
> to point automatically to the issues #XXX

What about integrating the notes within the documentation?

1. Add doc/source/release_notes.rst

------------------
Release Notes
------------------

.. include:: ../../NEWS.rst

2. Convert top-level NEWS into NEWS.rst


I'm investigating similar approach for another project I maintain,
and technically level this seems reasonable approach.

Similar can be possible with NEWS.md in Markdown,
but using directive is different, I think,
https://stackoverflow.com/a/46286751/151641

Just an idea for simplification, perhaps.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From even.rouault at spatialys.com  Mon Nov  4 07:04:16 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 16:04:16 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <CABUeae_hY0QV6bELpZ=NkML8zQpSurhRVHys9Xqz9Cbjw=q67Q@mail.gmail.com>
References: <2771968.1AohNxJvWG@even-i700> <7034323.17DmhbOnXt@even-i700>
 <CABUeae_hY0QV6bELpZ=NkML8zQpSurhRVHys9Xqz9Cbjw=q67Q@mail.gmail.com>
Message-ID: <1856489.ueGiesysmK@even-i700>

> What about integrating the notes within the documentation?
> 
> 1. Add doc/source/release_notes.rst
> 
> ------------------
> Release Notes
> ------------------
> 
> .. include:: ../../NEWS.rst
> 
> 2. Convert top-level NEWS into NEWS.rst
> 
> 
> I'm investigating similar approach for another project I maintain,
> and technically level this seems reasonable approach.
> 
> Similar can be possible with NEWS.md in Markdown,
> but using directive is different, I think,
> https://stackoverflow.com/a/46286751/151641
> 
> Just an idea for simplification, perhaps.

I'm happy if a potential future release manager innovates a bit in that area 
:-)
Having to manually create all links from #XXXX of the commit messages would be 
a bit painful, but some ad-hoc script to create them automagically from a 
initial raw doc would be OK. That's what I've done actually to fix the broken 
links raised by Jukka

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  4 09:14:20 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 18:14:20 +0100
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
Message-ID: <4852205.qzvfGj1lgt@even-i700>

Hi,

It has been raised to my attention that the netCDF driver systematically 
reports a nodata value when opening a dataset, even if no explicit _FillValue 
metadata item is set in the product. This seems to be a behaviour that has 
existed forever, but I'm not clear why. For byte/ubyte data types, the nodata 
value is set to 0 by default.

But for some products, like Sentinel 3 S3A_SL_2_LST products, in the 
LST_ancillary_ds.nc file, 0 is a valid value.

See following extract of ncdump on such a product:

        ubyte biome(rows, columns) ;
                biome:flag_meanings = "open_ocean irrigated_cropland 
rainfed_cropland mosaic_cropland mosaic_vegetation 
broadleaved_evergreen_forest closed_broadleaved_deciduous_forrest 
open_broadleaved_deciduous
_forest closed_needleleaved_forest open_needleleaved_forest mixed_forest 
mosaic_forest mosaic_grassland shrubland grassland sparse_vegetation 
freshwater_flooded_forest saltwater_flooded_forest flooded_vegetation 
artificial_surface bare_area_unknown bare_area_orthents bare_area_sand 
bare_area_calcids bare_area_cambids bare_area_orthels water snow_and_ice 
unfilled" ;
                biome:flag_values = 0UB, 1UB, 2UB, 3UB, 4UB, 5UB, 6UB, 7UB, 
8UB, 9UB, 10UB, 11UB, 12UB, 13UB, 14UB, 15UB, 16UB, 17UB, 18UB, 19UB, 20UB, 
21UB, 22UB, 23UB, 24UB, 25UB, 26UB, 27UB, 28UB ;
                biome:long_name = "Gridded GlobCover surface classification 
code" ;

So per https://github.com/OSGeo/gdal/pull/1979, I'm proposing to remove this 
default nodata value. Anybody seeing a side effect to this ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Mon Nov  4 10:48:04 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 4 Nov 2019 19:48:04 +0100
Subject: [gdal-dev] GDAL/OGR 3.0.2 is released
In-Reply-To: <1856489.ueGiesysmK@even-i700>
References: <2771968.1AohNxJvWG@even-i700> <7034323.17DmhbOnXt@even-i700>
 <CABUeae_hY0QV6bELpZ=NkML8zQpSurhRVHys9Xqz9Cbjw=q67Q@mail.gmail.com>
 <1856489.ueGiesysmK@even-i700>
Message-ID: <CABUeae_W4GCOHnGVfSX5jzOjUc94VD_FgLKyABXNpVjpg40LqA@mail.gmail.com>

On Mon, 4 Nov 2019 at 16:04, Even Rouault <even.rouault at spatialys.com> wrote:
> > What about integrating the notes within the documentation?
> >
> > 1. Add doc/source/release_notes.rst
> >
> > ------------------
> > Release Notes
> > ------------------
> >
> > .. include:: ../../NEWS.rst
> >
> > 2. Convert top-level NEWS into NEWS.rst
> >
> >
> > I'm investigating similar approach for another project I maintain,
> > and technically level this seems reasonable approach.
> >
> > Similar can be possible with NEWS.md in Markdown,
> > but using directive is different, I think,
> > https://stackoverflow.com/a/46286751/151641
> >
> > Just an idea for simplification, perhaps.
>
> I'm happy if a potential future release manager innovates a bit in that area
> :-)
> Having to manually create all links from #XXXX of the commit messages would be
> a bit painful, but some ad-hoc script to create them automagically from a
> initial raw doc would be OK. That's what I've done actually to fix the broken
> links raised by Jukka

Some may prefer NEWS.md some may prefer NEWS.rst.
The two needs different handling in Sphinx.

The important part is to put notes into single file, even with a bit
of manual formatting
during notes collection, and then let the magic happens :)

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From markus.metz.giswork at gmail.com  Mon Nov  4 12:21:28 2019
From: markus.metz.giswork at gmail.com (Markus Metz)
Date: Mon, 4 Nov 2019 21:21:28 +0100
Subject: [gdal-dev] GDAL 2 + PROJ 6 does not work
In-Reply-To: <6459637.nHUpXZE4MP@even-i700>
References: <CAG+h=FGLAwuhpT_hq_NDMuZ4HeQH3LAvTcuk-LBFJx0uy6dyOg@mail.gmail.com>
 <6459637.nHUpXZE4MP@even-i700>
Message-ID: <CAG+h=FHg_TuYQh9mQhgLGNkhVPQTPEgovjwW4X_QBS7e=4ROCg@mail.gmail.com>

On Sun, Nov 3, 2019 at 10:42 PM Even Rouault <even.rouault at spatialys.com>
wrote:
>
> On dimanche 3 novembre 2019 21:20:56 CET Markus Metz wrote:
> > Hopefully some package maintainers are listening.
> >
> > A CRS constructed from a proj string (deprecated in GDAL 3 + PROJ 6, I
> > know), works either in PROJ 6 or in GDAL 2, but not in both. The reason
is
> > that for PROJ 6, "+type=crs" is needed, but unfortunately GDAL 2 does
not
> > recognize this parameter and subsequently can not create a CRS from a
proj
> > string containing "+type=crs".
>
> For the sake of my curiousity, can you explain exactly how you go into
> problems ?
> The only quirk I found on quick tests with GDAL 2.4 + PROJ 6 is when
using the
> now deprecated "+init=epsg:XXXX" syntax

I tried gdalinfo (GDAL 2.4.2 + PROJ 6.2.1) on a raster with a CRS that does
not contain an authority code, and it failed to find any CRS. Recompiling
with configure --with-proj5-api=no solved the problem for me. That makes
sense to me because the new PROJ API produces quite different results when
used on PROJ5 or PROJ6.

I have seen the combination of GDAL 2 + PROJ 6 on Debian and it might occur
also on EPEL for RHEL 8.

> Indeed, GDAL 2 is best used with PROJ 5.2.

And if I want to use PROJ 6 + GDAL, I should use GDAL 3, right?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191104/23514b25/attachment.html>

From even.rouault at spatialys.com  Mon Nov  4 12:44:02 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 Nov 2019 21:44:02 +0100
Subject: [gdal-dev] GDAL 2 + PROJ 6 does not work
In-Reply-To: <CAG+h=FHg_TuYQh9mQhgLGNkhVPQTPEgovjwW4X_QBS7e=4ROCg@mail.gmail.com>
References: <CAG+h=FGLAwuhpT_hq_NDMuZ4HeQH3LAvTcuk-LBFJx0uy6dyOg@mail.gmail.com>
 <6459637.nHUpXZE4MP@even-i700>
 <CAG+h=FHg_TuYQh9mQhgLGNkhVPQTPEgovjwW4X_QBS7e=4ROCg@mail.gmail.com>
Message-ID: <2143852.YdCvKdnHoM@even-i700>

> I tried gdalinfo (GDAL 2.4.2 + PROJ 6.2.1) on a raster with a CRS that does
> not contain an authority code, and it failed to find any CRS. Recompiling
> with configure --with-proj5-api=no solved the problem for me. That makes
> sense to me because the new PROJ API produces quite different results when
> used on PROJ5 or PROJ6.

ok, a bit weird still but I trust you. GDAL 2 hardly uses PROJ for CRS 
building as it has self-contained logic to deal with EPSG, WKT and import/
export PROJ strings.

> I have seen the combination of GDAL 2 + PROJ 6 on Debian and it might occur
> also on EPEL for RHEL 8.

For Debian, I believe this combination is just a transitional state to deploy 
first PROJ 6 and then GDAL 3.

> 
> > Indeed, GDAL 2 is best used with PROJ 5.2.
> 
> And if I want to use PROJ 6 + GDAL, I should use GDAL 3, right?

yes, the recommended combinations are :
- GDAL 2.x with PROJ 5.2
- GDAL 3.x requires PROJ >= 6


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.demaria at acri-st.fr  Mon Nov  4 17:18:35 2019
From: julien.demaria at acri-st.fr (Julien Demaria)
Date: Tue, 5 Nov 2019 01:18:35 +0000
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <4852205.qzvfGj1lgt@even-i700>
References: <4852205.qzvfGj1lgt@even-i700>
Message-ID: <3B970FB76033264EB34479EC8A365E1104386727A3@vwiexc030.acri.local>

Hi Even,

Are you sure that the driver uses a default fill value if the attribute is not present? because bGotNoData seems set to false in this case and so SetNoDataValue() never called and GetNoDataValue() should return pbSuccess=false but maybe I'm wrong.

I already falled several years ago on the same behaviour with the NetCDF Python module, and after discussing with the author it seems that the NetCDF specs say that by default every NetCDF variable has a fill value even if the _FillValue attribute is not present (in this case the library uses its default fill value for the corresponding type). But you can disable this behavior of default fill value using nc_def_var_fill(NC_NOFILL). So it seems that generic applications should use nc_inq_var_fill() to know if the default fill value should be used.
You can found this discussion here: https://github.com/Unidata/netcdf4-python/issues/209
So I think we should keep the existing behavior (but add uses use nc_inq_var_fill()) to stick to the NetCDF specs.
On the other hand I think that this behavior is not very intuitive, not well known and there should be a lot of existing NetCDF files (wrongly) supposing that there is no fill value if the attribute is absent...

For byte/ubyte types (your case) the NetCDF specs recommends to not use default fill value:
https://www.unidata.ucar.edu/software/netcdf/docs/attribute_conventions.html
"It is not necessary to define your own _FillValue attribute for a variable if the default fill value for the type of the variable is adequate. However, use of the default fill value for data type byte is not recommended."
https://www.unidata.ucar.edu/software/netcdf/docs/known_problems.html#ncdump_ubyte_fill
"There should be no default fill values when reading any byte type, signed or unsigned, because the byte ranges are too small to assume one of the values should appear as a missing value unless a _FillValue attribute is set explicitly."
and after our discussion the NetCDF Python changed to ignore default fill value for byte/ubyte types, so maybe it's also the best choice for GDAL to stick to the NetCDF specs (but still not fully clear for me ;-) ). The current behavior of the GDAL driver is to force zero for byte/ubyte which is very dangerous and there is this comment "Don't do default fill-values for bytes, too risky" so maybe it's a bug and the developer wanted to ignore like the specs?

Best,
Julien

________________________________________
De : gdal-dev [gdal-dev-bounces at lists.osgeo.org] de la part de Even Rouault [even.rouault at spatialys.com]
Envoyé : lundi 4 novembre 2019 18:14
À : gdal-dev at lists.osgeo.org
Objet : [gdal-dev] Removing default nodata value from netCDF driver ?

Hi,

It has been raised to my attention that the netCDF driver systematically
reports a nodata value when opening a dataset, even if no explicit _FillValue
metadata item is set in the product. This seems to be a behaviour that has
existed forever, but I'm not clear why. For byte/ubyte data types, the nodata
value is set to 0 by default.

But for some products, like Sentinel 3 S3A_SL_2_LST products, in the
LST_ancillary_ds.nc file, 0 is a valid value.

See following extract of ncdump on such a product:

        ubyte biome(rows, columns) ;
                biome:flag_meanings = "open_ocean irrigated_cropland
rainfed_cropland mosaic_cropland mosaic_vegetation
broadleaved_evergreen_forest closed_broadleaved_deciduous_forrest
open_broadleaved_deciduous
_forest closed_needleleaved_forest open_needleleaved_forest mixed_forest
mosaic_forest mosaic_grassland shrubland grassland sparse_vegetation
freshwater_flooded_forest saltwater_flooded_forest flooded_vegetation
artificial_surface bare_area_unknown bare_area_orthents bare_area_sand
bare_area_calcids bare_area_cambids bare_area_orthels water snow_and_ice
unfilled" ;
                biome:flag_values = 0UB, 1UB, 2UB, 3UB, 4UB, 5UB, 6UB, 7UB,
8UB, 9UB, 10UB, 11UB, 12UB, 13UB, 14UB, 15UB, 16UB, 17UB, 18UB, 19UB, 20UB,
21UB, 22UB, 23UB, 24UB, 25UB, 26UB, 27UB, 28UB ;
                biome:long_name = "Gridded GlobCover surface classification
code" ;

So per https://github.com/OSGeo/gdal/pull/1979, I'm proposing to remove this
default nodata value. Anybody seeing a side effect to this ?

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue Nov  5 02:18:57 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 11:18:57 +0100
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <3B970FB76033264EB34479EC8A365E1104386727A3@vwiexc030.acri.local>
References: <4852205.qzvfGj1lgt@even-i700>
 <3B970FB76033264EB34479EC8A365E1104386727A3@vwiexc030.acri.local>
Message-ID: <3757667.7vGAzqfzA9@even-i700>

On mardi 5 novembre 2019 01:18:35 CET Julien Demaria wrote:
> Hi Even,
> 
> Are you sure that the driver uses a default fill value if the attribute is
> not present?

Yes, the raster band constructor systematically called SetNoDataValue() even 
if the bGotNoData flag was not set before.

Thanks a lot for your very valuable feedback on this! I've issued in
https://github.com/OSGeo/gdal/pull/1983 a less radical change which follows 
your suggestions (and solves the issue that triggered this discussion), that 
is:
- for char/byte/ubyte data types, do not set a NoData value if there's no 
explicit _FillValue or missing_value attribute
- for other data types, use nc_inq_var_fill() to get the default value, and 
fallback to the hard-coded NC_FILL_xxx constants

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov  5 03:06:23 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 12:06:23 +0100
Subject: [gdal-dev] Call for discussion on RFC76 OGR Python drivers
Message-ID: <2095931.f4rNuYMrQC@even-i700>

Hi,

This is a topic we already discussed a couple years ago. Please find a RFC 
about it in:

https://github.com/OSGeo/gdal/pull/1984/files

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From traviskirstine at gmail.com  Tue Nov  5 05:25:53 2019
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Tue, 5 Nov 2019 08:25:53 -0500
Subject: [gdal-dev] Update MVT
Message-ID: <CALtm4h3QUGLtqx+FbV8ROF1yCkqP8_POgtmsOJEap=i2K0ukDA@mail.gmail.com>

Does the MVT driver support updates and the creation of multiple layers
using the -append -update methods

Something like:

ogr2ogr -f MVT -dsco NAME=MyTiles -dsco DESCRIPTION="My Tileset Description
" -dsco FORMAT=MBTILES -lco NAME=Layer1 -lco DESCRIPTION="My Layer
Description" results.mbtiles layer1.shp

ogr2ogr -f MVT -lco NAME=Layer2 -lco DESCRIPTION="My Layer Description"
results.mbtiles layer2.shp -update -append

ERROR 1: Unable to open existing output datasource `results.mbtiles'.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/68433ec1/attachment.html>

From even.rouault at spatialys.com  Tue Nov  5 05:43:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 14:43:00 +0100
Subject: [gdal-dev] Update MVT
In-Reply-To: <CALtm4h3QUGLtqx+FbV8ROF1yCkqP8_POgtmsOJEap=i2K0ukDA@mail.gmail.com>
References: <CALtm4h3QUGLtqx+FbV8ROF1yCkqP8_POgtmsOJEap=i2K0ukDA@mail.gmail.com>
Message-ID: <2200258.Q6zbK6UDB5@even-i700>

On mardi 5 novembre 2019 08:25:53 CET Travis Kirstine wrote:
> Does the MVT driver support updates and the creation of multiple layers
> using the -append -update methods

No, it is one time creation only. To achieve what you want to do, you can 
typically create a input VRT file that has multiple layer from your input 
files (or for shapefiles, just create a subdirectory, put your shapefiles 
there, and use the directory name as the input dataset) and provide a 
configuration file to the driver with the CONF dataset creation option.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.demaria at acri-st.fr  Tue Nov  5 06:08:33 2019
From: julien.demaria at acri-st.fr (Julien Demaria)
Date: Tue, 5 Nov 2019 14:08:33 +0000
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <3757667.7vGAzqfzA9@even-i700>
References: <4852205.qzvfGj1lgt@even-i700>
 <3B970FB76033264EB34479EC8A365E1104386727A3@vwiexc030.acri.local>
 <3757667.7vGAzqfzA9@even-i700>
Message-ID: <3B970FB76033264EB34479EC8A365E11043867290E@vwiexc030.acri.local>

Hi Even,

Thanks for all the work.
I looked at the new pull request, it seems good but what do you think about adding support for case where nc_inq_var_fill() returns no_fill=1? In this case the current code uses fillvalue=zero by default (if I'm not wrong) which is not ideal, I think it is better to set bGotNoData to false.
And in creation mode do you confirm that it is not possible to create a variable without nodata value? What do you think about call nc_def_var_fill(NC_NOFILL) when creating the band and add a nc_def_var_fill(NC_FILL) call in SetNoDataValue()?

Julien


-----Message d'origine-----
De : Even Rouault <even.rouault at spatialys.com> 
Envoyé : mardi 5 novembre 2019 11:19
À : Julien Demaria <julien.demaria at acri-st.fr>
Cc : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] Removing default nodata value from netCDF driver ?

On mardi 5 novembre 2019 01:18:35 CET Julien Demaria wrote:
> Hi Even,
> 
> Are you sure that the driver uses a default fill value if the 
> attribute is not present?

Yes, the raster band constructor systematically called SetNoDataValue() even if the bGotNoData flag was not set before.

Thanks a lot for your very valuable feedback on this! I've issued in
https://github.com/OSGeo/gdal/pull/1983 a less radical change which follows your suggestions (and solves the issue that triggered this discussion), that
is:
- for char/byte/ubyte data types, do not set a NoData value if there's no explicit _FillValue or missing_value attribute
- for other data types, use nc_inq_var_fill() to get the default value, and fallback to the hard-coded NC_FILL_xxx constants

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From ivan.lucena at outlook.com  Tue Nov  5 06:08:49 2019
From: ivan.lucena at outlook.com (Ivan Lucena)
Date: Tue, 5 Nov 2019 14:08:49 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
In-Reply-To: <2538251.CmBU5Sys7W@even-i700>
References: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>
 <alpine.DEB.2.21.1911011123580.7642@warden.aitchison.me.uk>
 <BN6PR22MB0948FBDAE6036AE2193C5A7BF2620@BN6PR22MB0948.namprd22.prod.outlook.com>,
 <2538251.CmBU5Sys7W@even-i700>
Message-ID: <DM6PR22MB1882CABF9BE90D85D1FFEF7DF27E0@DM6PR22MB1882.namprd22.prod.outlook.com>

Even,

That confirms my suspicious. The NetCDF driver is fine and there is nothing to be added or changed.

> The products are not self consistent if you consider the crs:GeoTransform property,
> the documentation of the product and the actual values of the lon, lat arrays
> ...
> I think clarification should be sought after the data producer to find:
> - what is the intended registration of their product ?
> - and that they fix either their GeoTransform or their lon, lat arrays to be consistent.

I completely agree with you. I will pass that information to the data provider costumer services.

Thanks,

Ivan

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Sunday, November 3, 2019 4:45 PM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Cc: Ivan Lucena <ivan.lucena at outlook.com>; Andrew C Aitchison <andrew at aitchison.me.uk>; Richard Duivenvoorde <rdmailings at duif.net>
Subject: Re: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates

> Some formats have a pretty good easy way of telling which way to go about
> upperleft or center pixel coordinate. But that is not the case with
> "flexible" formats like the ones above.

The CF conventions apply here. Also that
http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html
says is
"If bounds are not provided, an application might reasonably assume the gridpoints
to be at the centers of the cells, but we do not require that in this standard."
And that's what GDAL does. It assumes that the values of the lat, lon variables
are center of cells coordinates, hence the half pixel shift to go back to GDAL
topleft corner convention

> What is interesting in that case is that one can say that according to the
> documentation the driver is correct. The -180,80 coordinate is in the
> center of the pixel. But when putting that date to real use, that seems to
> be incorrect.

The products are not self consistent if you consider the crs:GeoTransform property,
the documentation of the product and the actual values of the lon, lat arrays

ncdump shows:
        lon = 120960 ;

                crs:GeoTransform = "-180.0000000000 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905" ;

                 lon = -180, -179.997023809524, ... , 179.994047620685, 179.997023811161

Normally in GDAL, the GeoTransform origin is the topleft corner, not the pixel center.

I think clarificiation should be sought after the data producer to find:
- what is the intended registration of their product ?
- and that they fix either their GeoTransform or their lon, lat arrays to be consistent.

> The half pixel shift grows as you go
> east.

I don't get this. The spacing of values in the lon array seems constant, so the shift
if any should also be constant.

> If I have some time, I will try to run the NetCDF driver in step-by-step
> debugging mode to see exactly how the crs:GeoTransform is (mis)handled.

The logic of the driver is to use the GeoTransform if it can derive one from the lon, lat
variables. See
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/netcdf/netcdfdataset.cpp#L3776

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/ea40adb9/attachment.html>

From are131 at psu.edu  Tue Nov  5 06:36:18 2019
From: are131 at psu.edu (Edson, Adam Robert)
Date: Tue, 5 Nov 2019 14:36:18 +0000
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
 <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>
Message-ID: <DM6PR02MB43629295455B9D9804518399937E0@DM6PR02MB4362.namprd02.prod.outlook.com>

Brad,

Sorry it took so long to get back to you.
I am interested in collaborating on this with you.
Any help would be appreciated!

Thanks!
Adam



________________________________
From: Brad Hards <bradh at frogmouth.net>
Sent: Monday, October 14, 2019 6:16 PM
To: Edson, Adam Robert <are131 at psu.edu>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: RE: [gdal-dev] python GDAL issue


I think the problem is that there isn’t any real way to handle the IEEE-754 (or raw int/uint bitmask) in GDAL at the moment.



Working through the part you’ve posted:

S is the unit quantity



The part that looks like:

B\\0\\0\\0

is therefore the SCALE FACTOR, which is really IEEE 754-2008 binary encoded, and the existing TRE XML definition and parsing code doesn’t handle that case AFAICT.



This part is the ROW_GSD and COL_GSD + units:

0030.00

M

0030.00

M



In that case, I think there is a missing value in the TRE (because there has to be four bytes, and there are only three shown in your sample, which I assume is the test data that NGA derived from LANDSAT 8).



I’ve also been looking at handling “weird” TREs better (on and off for a while). I have a Java implementation that shares the XML definition, and the plan is to add two new types to the field definition:

        <xs:attribute name="type" use="optional">

            <xs:simpleType>

                <xs:restriction base="xs:string">

                    <xs:enumeration value="string"/>

                    <xs:enumeration value="integer"/>

                    <xs:enumeration value="real"/>

                    <xs:enumeration value="UINT"/>

                    <xs:enumeration value="IEEE754"/>

                </xs:restriction>

            </xs:simpleType>

        </xs:attribute>



(where UINT and IEEE754 values are new, and are binary encoded instead of string encoded).



Happy to collaborate on this if you’re interested.



Brad





From: Edson, Adam Robert <are131 at psu.edu>
Sent: Monday, 14 October 2019 10:02 PM
To: Brad Hards <bradh at frogmouth.net>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] python GDAL issue



I am working on adding BANDSB and the other TREs listed in the SNIP document.



I am not sure what you are asking for.

However, here is the output from gdal.getMetadata('TRE') for the relevant portion of the BANDSB TRE

SPECTRAL RADIANCE       SB\\0\\0\\0\\0\\0\\00030.00M0030.00M-------M-------M
                                               \\0\\0DETECTOR<file://0//0DETECTOR>                \x7fU

This is the section from the radiometric_quantity field to wave_length_unit field.



Thanks!

Adam



________________________________

From: Brad Hards <bradh at frogmouth.net<mailto:bradh at frogmouth.net>>
Sent: Saturday, October 12, 2019 1:51 AM
To: Edson, Adam Robert <are131 at psu.edu<mailto:are131 at psu.edu>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: RE: [gdal-dev] python GDAL issue



GDAL’s NITF encoding doesn’t appear to have BANDSB yet: https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml<https://nam01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fblob%2Fmaster%2Fgdal%2Fdata%2Fnitf_spec.xml&data=02%7C01%7Care131%40psu.edu%7C7a494cbbe65340b8c30508d750f4334f%7C7cf48d453ddb4389a9c1c115526eb52e%7C0%7C0%7C637066882092744733&sdata=JMlKqzsaCIGCNrJR9ktNo%2BHur9wOxUF%2FFKOgXZNzRIw%3D&reserved=0>



It would definitely help to see how that file encodes it. Can you open the NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some length value), and copy out the following 0nnnn characters?



Brad


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/48f82283/attachment-0001.html>

From tim.jacobs at vito.be  Tue Nov  5 06:42:03 2019
From: tim.jacobs at vito.be (Jacobs Tim)
Date: Tue, 5 Nov 2019 14:42:03 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
Message-ID: <910386dd30484a5f808dfc8ebe77e95f@VITOMAIL5.vito.local>

Dear Even, Ivan,

Point taken on the self-consistency of the products.

GeoTransform indeed appears incorrect, at least for NDVI.
We'll cross-check for other products and either correct or remove GeoTransform.
I noted in earlier reply that it doesn't impact GDAL's netCDF driver, as it looks at lon/lat coordinate variables anyhow.

Thanks for the feedback.

Best regards,
Tim Jacobs
Indien u VITO Mol bezoekt, hou aub er dan rekening mee dat de hoofdingang voortaan enkel bereikbaar is vanuit de richting Dessel-Retie, niet vanuit richting Mol, zie vito.be/route.<http://www.vito.be/route>
If you plan to visit VITO at Mol, then please note that the main entrance can only be reached coming from Dessel-Retie and no longer coming from Mol, see vito.be/en/contact/locations.<http://www.vito.be/en/contact/locations>
VITO Disclaimer: http://www.vito.be/e-maildisclaimer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/6101489d/attachment.html>

From even.rouault at spatialys.com  Tue Nov  5 06:48:11 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 15:48:11 +0100
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <3B970FB76033264EB34479EC8A365E11043867290E@vwiexc030.acri.local>
References: <4852205.qzvfGj1lgt@even-i700> <3757667.7vGAzqfzA9@even-i700>
 <3B970FB76033264EB34479EC8A365E11043867290E@vwiexc030.acri.local>
Message-ID: <1593420.Xt7KrimV7E@even-i700>

On mardi 5 novembre 2019 14:08:33 CET Julien Demaria wrote:
> Hi Even,
> 
> Thanks for all the work.
> I looked at the new pull request, it seems good but what do you think about
> adding support for case where nc_inq_var_fill() returns no_fill=1? In this
> case the current code uses fillvalue=zero by default (if I'm not wrong)
> which is not ideal, I think it is better to set bGotNoData to false.

I'm not sure to understand well this no_fill concept. My understanding is that 
it is a kind of optimization for the write side. That shouldn't probably 
affect whether we report a nodata value or not ?

> And in
> creation mode do you confirm that it is not possible to create a variable
> without nodata value? 

Yes, except for byte-like datatypes with the change of my pull request

> What do you think about call
> nc_def_var_fill(NC_NOFILL) when creating the band and add a
> nc_def_var_fill(NC_FILL) call in SetNoDataValue()?

Not sure to understand the impact of this. I'd let that to you for another 
pull request.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.demaria at acri-st.fr  Tue Nov  5 07:41:47 2019
From: julien.demaria at acri-st.fr (Julien Demaria)
Date: Tue, 5 Nov 2019 15:41:47 +0000
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <1593420.Xt7KrimV7E@even-i700>
References: <4852205.qzvfGj1lgt@even-i700> <3757667.7vGAzqfzA9@even-i700>
 <3B970FB76033264EB34479EC8A365E11043867290E@vwiexc030.acri.local>
 <1593420.Xt7KrimV7E@even-i700>
Message-ID: <3B970FB76033264EB34479EC8A365E110438672974@vwiexc030.acri.local>

Ok let's keep this for another PR.

no_fill is not only a write side optimization because nc_inq_var_fill() can be called when reading a file (the no_fill value is stored in the hidden NetCDF attribute _NoFill, you can print it with ncdump -s but it is only set when nofill=true).
My understanding is that the only way to define a NetCDF variable without a nodata value is to set no_fill=1 by calling nc_def_var_fill(NC_NOFILL) because no_fill=0 means you have to use the default fillvalue even if the _FillValue attribute is not set so you will always have a nodata value.
Note that nc_inq_var_fill() does not fill the void *fill_valuep if no_fill=1

Julien


-----Message d'origine-----
De : Even Rouault <even.rouault at spatialys.com> 
Envoyé : mardi 5 novembre 2019 15:48
À : Julien Demaria <julien.demaria at acri-st.fr>
Cc : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] Removing default nodata value from netCDF driver ?

On mardi 5 novembre 2019 14:08:33 CET Julien Demaria wrote:
> Hi Even,
> 
> Thanks for all the work.
> I looked at the new pull request, it seems good but what do you think 
> about adding support for case where nc_inq_var_fill() returns 
> no_fill=1? In this case the current code uses fillvalue=zero by 
> default (if I'm not wrong) which is not ideal, I think it is better to set bGotNoData to false.

I'm not sure to understand well this no_fill concept. My understanding is that it is a kind of optimization for the write side. That shouldn't probably affect whether we report a nodata value or not ?

> And in
> creation mode do you confirm that it is not possible to create a 
> variable without nodata value?

Yes, except for byte-like datatypes with the change of my pull request

> What do you think about call
> nc_def_var_fill(NC_NOFILL) when creating the band and add a
> nc_def_var_fill(NC_FILL) call in SetNoDataValue()?

Not sure to understand the impact of this. I'd let that to you for another pull request.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Tue Nov  5 09:07:01 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 18:07:01 +0100
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <3B970FB76033264EB34479EC8A365E110438672974@vwiexc030.acri.local>
References: <4852205.qzvfGj1lgt@even-i700> <1593420.Xt7KrimV7E@even-i700>
 <3B970FB76033264EB34479EC8A365E110438672974@vwiexc030.acri.local>
Message-ID: <4240974.VBjBo3g9f3@even-i700>

On mardi 5 novembre 2019 15:41:47 CET Julien Demaria wrote:
> Ok let's keep this for another PR.
> 
> no_fill is not only a write side optimization because nc_inq_var_fill() can
> be called when reading a file (the no_fill value is stored in the hidden
> NetCDF attribute _NoFill, you can print it with ncdump -s but it is only
> set when nofill=true). My understanding is that the only way to define a
> NetCDF variable without a nodata value is to set no_fill=1 by calling
> nc_def_var_fill(NC_NOFILL) because no_fill=0 means you have to use the
> default fillvalue even if the _FillValue attribute is not set so you will
> always have a nodata value. Note that nc_inq_var_fill() does not fill the
> void *fill_valuep if no_fill=1

OK, I've added an extra commit to not report nodata when nc_inq_var_fill() 
reports NoFill.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdisk.mike at gmail.com  Tue Nov  5 11:26:18 2019
From: gdisk.mike at gmail.com (mike Null)
Date: Tue, 5 Nov 2019 12:26:18 -0700
Subject: [gdal-dev] FileGDB & FID
Message-ID: <CAKTgSod3fdNgvzBH-YPermAdaQP3dR8HAGNS5agK4pcnx8nqyA@mail.gmail.com>

I'm trying to create some features in a File GDB, and have that driver
loaded.

I've been doing something along the lines just fine to gpkg, but I hit a
FileGDB issue and wondering how to get around it.

This line in python
lyr = fgdbds.CopyLayer(inmemorylayer,somename,['OVERWRITE=YES'])

I get the issue

ERROR 6: Only 32 bit positive integers FID supported by FileGDB

How can I get around this?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/59a5a532/attachment.html>

From mswope at gmail.com  Tue Nov  5 12:16:36 2019
From: mswope at gmail.com (Mike)
Date: Tue, 5 Nov 2019 13:16:36 -0700
Subject: [gdal-dev] FileGDB & FID
In-Reply-To: <CAKTgSod3fdNgvzBH-YPermAdaQP3dR8HAGNS5agK4pcnx8nqyA@mail.gmail.com>
References: <CAKTgSod3fdNgvzBH-YPermAdaQP3dR8HAGNS5agK4pcnx8nqyA@mail.gmail.com>
Message-ID: <CAKTSvBg2U-81iuxWz0CJ1SH2uggHKMcxD43FCrazrhjdzF7PqQ@mail.gmail.com>

I did end up just defining the layers and just adding all the data to it.

However this does occur with ogr2ogr, and it says to use skip failures.
When I use that, I get one less feature (fails on the first I assume).

Is there a way to ignore FID with fgdb output & ogr2ogr?
Same for the CopyLayer in python.




On Tue, Nov 5, 2019, 12:29 mike Null <gdisk.mike at gmail.com> wrote:

>
> I'm trying to create some features in a File GDB, and have that driver
> loaded.
>
> I've been doing something along the lines just fine to gpkg, but I hit a
> FileGDB issue and wondering how to get around it.
>
> This line in python
> lyr = fgdbds.CopyLayer(inmemorylayer,somename,['OVERWRITE=YES'])
>
> I get the issue
>
> ERROR 6: Only 32 bit positive integers FID supported by FileGDB
>
> How can I get around this?
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/06c4ca9d/attachment.html>

From even.rouault at spatialys.com  Tue Nov  5 12:27:46 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 21:27:46 +0100
Subject: [gdal-dev] FileGDB & FID
In-Reply-To: <CAKTSvBg2U-81iuxWz0CJ1SH2uggHKMcxD43FCrazrhjdzF7PqQ@mail.gmail.com>
References: <CAKTgSod3fdNgvzBH-YPermAdaQP3dR8HAGNS5agK4pcnx8nqyA@mail.gmail.com>
 <CAKTSvBg2U-81iuxWz0CJ1SH2uggHKMcxD43FCrazrhjdzF7PqQ@mail.gmail.com>
Message-ID: <8162735.SqVkx6YKdL@even-i700>

On mardi 5 novembre 2019 13:16:36 CET Mike wrote:
> I did end up just defining the layers and just adding all the data to it.
> 
> However this does occur with ogr2ogr, and it says to use skip failures.
> When I use that, I get one less feature (fails on the first I assume).

You get that message because one of your ids doesn't fit on 32 bit
CopyLayer() is quite limited regarding is options.
You could use the gdal.VectorTranslate() which is the function behind ogr2ogr. 
Then you can use the -unsetFid and/or -skip options

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From bjorn.harrtell at gmail.com  Tue Nov  5 12:28:15 2019
From: bjorn.harrtell at gmail.com (=?UTF-8?Q?Bj=C3=B6rn_Harrtell?=)
Date: Tue, 5 Nov 2019 21:28:15 +0100
Subject: [gdal-dev] Open option for vectors in the cloud
In-Reply-To: <CANhDX=bA+VMot_MZUTy7RNOfvTG=xTtMXx+WwNGQHwE=cwpybg@mail.gmail.com>
References: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
 <2524372.SVzQUXFDd3@even-i700>
 <CANhDX=bA+VMot_MZUTy7RNOfvTG=xTtMXx+WwNGQHwE=cwpybg@mail.gmail.com>
Message-ID: <CANhDX=bB7f0r8FeQ+QmV2AbVBbdBtvcwPT2_++a9k2Wu8TBpHA@mail.gmail.com>

Improvements have hit master. I suspect there are some remaining
bottlenecks though, but I currently lack the tests/means to investigate
further in short term and will appreciate feedback.

Den tors 31 okt. 2019 02:17Björn Harrtell <bjorn.harrtell at gmail.com> skrev:

> Thanks for trying out accessing FlatGeobuf via http.
>
> For the record I've been slightly aware of this particular efficiency
> problem and I aim to improve it when I can get to it, because this is a use
> case I definitely want FlatGeobuf to grab the first place. :)
>
> /Björn
>
> Den tors 24 okt. 2019 kl 20:05 skrev Even Rouault <
> even.rouault at spatialys.com>:
>
>> On jeudi 24 octobre 2019 17:42:23 CEST Rahkonen Jukka (MML) wrote:
>> > Hi,
>> >
>> > I was experimenting with accessing some vector files through http (same
>> data
>> > as FlatGeoBuffers, GeoPackage, and shapefile). The file size in each
>> format
>> > was about 850 MB and the amount of data was about 240000 linestrings. I
>> > made ogrinfo request with spatial filter that selects one feature and
>> > cheched the number of http requests and amount of requested data.
>> >
>> > FlatGeoBuffers
>> > 19 http requests
>> > 33046509 bytes read
>>
>> Looking at the debug log, FlatGeoBuf currently loads the whole index-of-
>> features array( "Reading feature offsets index" ), which accounts for
>> 32.7 MB
>> of the above 33 MB. This could probably be avoided by only loading the
>> offsets
>> of the selected features. The shapefile driver a few years ago had the
>> same
>> issue and this was fixed by initializing the offset array to zeroes, and
>> load
>> on demand the offsets when needed.
>>
>> > If somebody
>> > really finds a use case for reading vector data from the web it seems
>> > obvious that having a possibility to cache and re-use the spatial index
>> > would be very beneficial. I can imagine that with shapefile it would
>> mean
>> > downloading the .qix file, with GeoPackage reading the contents of the
>> > rtree index table, and with FlatGeoBuffers probably extracting the
>> Static
>> > packed Hilbert R-tree index.
>>
>> A general caching logic in /vsicurl/ would be preferable (although the
>> download of the 'data' part of files might potentially evict the indexes,
>> but
>> having a dedicated logic in each driver to tell which files / region of
>> the
>> files should be cached would be a bit annoying). Basically doing a HEAD
>> request on the file to get its last update date, and have a local cache
>> of
>> downloaded pieces would be a more general solution.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/54505ddc/attachment.html>

From norman.barker at gmail.com  Tue Nov  5 12:48:19 2019
From: norman.barker at gmail.com (Norman Barker)
Date: Tue, 5 Nov 2019 14:48:19 -0600
Subject: [gdal-dev] process for adding commits to minor release
Message-ID: <CAN_Dn-F++pqhSqCp62_A3SwquhGXgMtZoXDozN+RMXussG6=3w@mail.gmail.com>

Hi,

I was looking at the recent 3.0.2 release and it was missing a few of my
commits for the TileDB driver dating back to June. How do I get these added
to the 3.0.x series, I understood the backport function to be for bug fixes?

Norman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191105/db5e32db/attachment.html>

From even.rouault at spatialys.com  Tue Nov  5 12:54:11 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 Nov 2019 21:54:11 +0100
Subject: [gdal-dev] process for adding commits to minor release
In-Reply-To: <CAN_Dn-F++pqhSqCp62_A3SwquhGXgMtZoXDozN+RMXussG6=3w@mail.gmail.com>
References: <CAN_Dn-F++pqhSqCp62_A3SwquhGXgMtZoXDozN+RMXussG6=3w@mail.gmail.com>
Message-ID: <3324103.qCXD5dUxpM@even-i700>

On mardi 5 novembre 2019 14:48:19 CET Norman Barker wrote:
> Hi,
> 
> I was looking at the recent 3.0.2 release and it was missing a few of my
> commits for the TileDB driver dating back to June. How do I get these added
> to the 3.0.x series, I understood the backport function to be for bug fixes?

When you create a pull request, you can add the "backport 3.0" label if you 
want a backport pull request to be created after the initial pull request has 
been merged to master.

If the changes are already in master, git cherry-pick them manually in 
release/3.0 (possibly creating in a branch to create a pull request against 
release/3.0 so that it gets CI tested)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From julien.demaria at acri-st.fr  Tue Nov  5 13:20:25 2019
From: julien.demaria at acri-st.fr (Julien Demaria)
Date: Tue, 5 Nov 2019 21:20:25 +0000
Subject: [gdal-dev] Removing default nodata value from netCDF driver ?
In-Reply-To: <4240974.VBjBo3g9f3@even-i700>
References: <4852205.qzvfGj1lgt@even-i700> <1593420.Xt7KrimV7E@even-i700>
 <3B970FB76033264EB34479EC8A365E110438672974@vwiexc030.acri.local>,
 <4240974.VBjBo3g9f3@even-i700>
Message-ID: <3B970FB76033264EB34479EC8A365E110438672A14@vwiexc030.acri.local>

Thanks Even!

________________________________________
De : Even Rouault [even.rouault at spatialys.com]
Envoyé : mardi 5 novembre 2019 18:07
À : Julien Demaria
Cc : gdal-dev at lists.osgeo.org
Objet : Re: [gdal-dev] Removing default nodata value from netCDF driver ?

On mardi 5 novembre 2019 15:41:47 CET Julien Demaria wrote:
> Ok let's keep this for another PR.
>
> no_fill is not only a write side optimization because nc_inq_var_fill() can
> be called when reading a file (the no_fill value is stored in the hidden
> NetCDF attribute _NoFill, you can print it with ncdump -s but it is only
> set when nofill=true). My understanding is that the only way to define a
> NetCDF variable without a nodata value is to set no_fill=1 by calling
> nc_def_var_fill(NC_NOFILL) because no_fill=0 means you have to use the
> default fillvalue even if the _FillValue attribute is not set so you will
> always have a nodata value. Note that nc_inq_var_fill() does not fill the
> void *fill_valuep if no_fill=1

OK, I've added an extra commit to not report nodata when nc_inq_var_fill()
reports NoFill.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Tue Nov  5 15:02:52 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 6 Nov 2019 00:02:52 +0100
Subject: [gdal-dev] Call for discussion on RFC76 OGR Python drivers
In-Reply-To: <2095931.f4rNuYMrQC@even-i700>
References: <2095931.f4rNuYMrQC@even-i700>
Message-ID: <CABUeae-v3BhpDz73gfeD5xFcoBOW6-VKwhdnhDKuPu9nt3-yKQ@mail.gmail.com>

On Tue, 5 Nov 2019 at 12:06, Even Rouault <even.rouault at spatialys.com> wrote:
>
> This is a topic we already discussed a couple years ago. Please find a RFC
> about it in:
>
> https://github.com/OSGeo/gdal/pull/1984/files

I dropped some comments there, not a review though.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From matthias at opengis.ch  Tue Nov  5 15:09:38 2019
From: matthias at opengis.ch (Matthias Kuhn)
Date: Wed, 6 Nov 2019 00:09:38 +0100
Subject: [gdal-dev] process for adding commits to minor release
In-Reply-To: <3324103.qCXD5dUxpM@even-i700>
References: <CAN_Dn-F++pqhSqCp62_A3SwquhGXgMtZoXDozN+RMXussG6=3w@mail.gmail.com>
 <3324103.qCXD5dUxpM@even-i700>
Message-ID: <243f9c19-2f18-9412-989b-b3c6c7bf2313@opengis.ch>

Hi

On 11/5/19 9:54 PM, Even Rouault wrote:
> On mardi 5 novembre 2019 14:48:19 CET Norman Barker wrote:
>> Hi,
>>
>> I was looking at the recent 3.0.2 release and it was missing a few of my
>> commits for the TileDB driver dating back to June. How do I get these added
>> to the 3.0.x series, I understood the backport function to be for bug fixes?
> When you create a pull request, you can add the "backport 3.0" label if you
> want a backport pull request to be created after the initial pull request has
> been merged to master.
>
> If the changes are already in master, git cherry-pick them manually in
> release/3.0 (possibly creating in a branch to create a pull request against
> release/3.0 so that it gets CI tested)

You can also add the label if it has been merged already, this will 
trigger the backport as well.

Matthias

>
> Even
>

From bradh at frogmouth.net  Tue Nov  5 23:54:24 2019
From: bradh at frogmouth.net (Brad Hards)
Date: Wed, 6 Nov 2019 18:54:24 +1100
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <DM6PR02MB43629295455B9D9804518399937E0@DM6PR02MB4362.namprd02.prod.outlook.com>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
 <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>
 <DM6PR02MB43629295455B9D9804518399937E0@DM6PR02MB4362.namprd02.prod.outlook.com>
Message-ID: <00de01d59477$68681b90$393852b0$@frogmouth.net>

Hi Adam,

 

https://github.com/codice/imaging-nitf/pull/196 is the work I did for my
java implementation.

 

The spec definition I came up should be directly applicable.

 

However for it to work in GDAL, we need at least:

*	Support for parsing / using the IEEE 754 encoding (which I called
type="IEEE754")
*	Support for parsing / using the 32bit integer encoding (which I
called type="UINT")
*	Support for the "&" condition operator (for bitmask tests)
*	Unit tests

 

I think I can hack my unit test code to output some test files.

 

Brad

 

 

From: Edson, Adam Robert <are131 at psu.edu> 
Sent: Wednesday, 6 November 2019 1:36 AM
To: Brad Hards <bradh at frogmouth.net>; gdal-dev at lists.osgeo.org
Cc: Bradley, Eliza S <esb165 at psu.edu>
Subject: Re: [gdal-dev] python GDAL issue

 

Brad,

 

Sorry it took so long to get back to you.

I am interested in collaborating on this with you.

Any help would be appreciated!

 

Thanks!

Adam

 

 

 

  _____  

From: Brad Hards <bradh at frogmouth.net <mailto:bradh at frogmouth.net> >
Sent: Monday, October 14, 2019 6:16 PM
To: Edson, Adam Robert <are131 at psu.edu <mailto:are131 at psu.edu> >;
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
<gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> >
Subject: RE: [gdal-dev] python GDAL issue 

 

I think the problem is that there isn't any real way to handle the IEEE-754
(or raw int/uint bitmask) in GDAL at the moment. 

 

Working through the part you've posted:

S is the unit quantity

 

The part that looks like:

B\\0\\0\\0

is therefore the SCALE FACTOR, which is really IEEE 754-2008 binary encoded,
and the existing TRE XML definition and parsing code doesn't handle that
case AFAICT.

 

This part is the ROW_GSD and COL_GSD + units:

0030.00

M

0030.00

M

 

In that case, I think there is a missing value in the TRE (because there has
to be four bytes, and there are only three shown in your sample, which I
assume is the test data that NGA derived from LANDSAT 8).

 

I've also been looking at handling "weird" TREs better (on and off for a
while). I have a Java implementation that shares the XML definition, and the
plan is to add two new types to the field definition:

        <xs:attribute name="type" use="optional">

            <xs:simpleType>

                <xs:restriction base="xs:string">

                    <xs:enumeration value="string"/>

                    <xs:enumeration value="integer"/>

                    <xs:enumeration value="real"/>

                    <xs:enumeration value="UINT"/>

                    <xs:enumeration value="IEEE754"/>

                </xs:restriction>

            </xs:simpleType>

        </xs:attribute>

 

(where UINT and IEEE754 values are new, and are binary encoded instead of
string encoded).

 

Happy to collaborate on this if you're interested.

 

Brad

 

 

From: Edson, Adam Robert <are131 at psu.edu <mailto:are131 at psu.edu> > 
Sent: Monday, 14 October 2019 10:02 PM
To: Brad Hards <bradh at frogmouth.net <mailto:bradh at frogmouth.net> >;
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> 
Subject: Re: [gdal-dev] python GDAL issue

 

I am working on adding BANDSB and the other TREs listed in the SNIP
document.

 

I am not sure what you are asking for.

However, here is the output from gdal.getMetadata('TRE') for the relevant
portion of the BANDSB TRE

SPECTRAL RADIANCE       SB\\0\\0\\0\\0\\0\\00030.00M0030.00M-------M-------M

                                               \\0\\0DETECTOR
<file://0/0DETECTOR>                 \x7fU

This is the section from the radiometric_quantity field to wave_length_unit
field.

 

Thanks!

Adam

 

  _____  

From: Brad Hards <bradh at frogmouth.net <mailto:bradh at frogmouth.net> >
Sent: Saturday, October 12, 2019 1:51 AM
To: Edson, Adam Robert <are131 at psu.edu <mailto:are131 at psu.edu> >;
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
<gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> >
Subject: RE: [gdal-dev] python GDAL issue 

 

GDAL's NITF encoding doesn't appear to have BANDSB yet:
https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml
<https://nam01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.co
m%2FOSGeo%2Fgdal%2Fblob%2Fmaster%2Fgdal%2Fdata%2Fnitf_spec.xml&data=02%7C01%
7Care131%40psu.edu%7C7a494cbbe65340b8c30508d750f4334f%7C7cf48d453ddb4389a9c1
c115526eb52e%7C0%7C0%7C637066882092744733&sdata=JMlKqzsaCIGCNrJR9ktNo%2BHur9
wOxUF%2FFKOgXZNzRIw%3D&reserved=0> 

 

It would definitely help to see how that file encodes it. Can you open the
NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some
length value), and copy out the following 0nnnn characters?

 

Brad

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191106/8a3ff57d/attachment-0001.html>

From are131 at psu.edu  Wed Nov  6 11:33:49 2019
From: are131 at psu.edu (Edson, Adam Robert)
Date: Wed, 6 Nov 2019 19:33:49 +0000
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <00de01d59477$68681b90$393852b0$@frogmouth.net>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
 <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>
 <DM6PR02MB43629295455B9D9804518399937E0@DM6PR02MB4362.namprd02.prod.outlook.com>,
 <00de01d59477$68681b90$393852b0$@frogmouth.net>
Message-ID: <DM6PR02MB4362B345CEF48FC3A9FBA18993790@DM6PR02MB4362.namprd02.prod.outlook.com>

Looking at the code, it appears that GDAL actually hard codes any TRE that takes anything that cannot be parsed as a string (e.g. nitfimage.c NITFReadICHIPB). So, for BANDSB with its EXISTENCE_MASK and SCALE_FACTOR would need to be hard coded as opposed to being defined just within the nitf_spec.xml. Is this the correct interpretation?

Thanks!
Adam
________________________________
From: Brad Hards <bradh at frogmouth.net>
Sent: Wednesday, November 6, 2019 2:54 AM
To: Edson, Adam Robert <are131 at psu.edu>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Cc: Bradley, Eliza S <esb165 at psu.edu>
Subject: RE: [gdal-dev] python GDAL issue


Hi Adam,



https://github.com/codice/imaging-nitf/pull/196<https://nam01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2Fcodice%2Fimaging-nitf%2Fpull%2F196&data=02%7C01%7Care131%40psu.edu%7C1f5f02d357214ab1cac808d7628e8df2%7C7cf48d453ddb4389a9c1c115526eb52e%7C0%7C0%7C637086236748108876&sdata=r%2BZS3nYRN2M%2B7VFqmSJt%2F3lHXduFeMMIBfNALX9S43A%3D&reserved=0> is the work I did for my java implementation.



The spec definition I came up should be directly applicable.



However for it to work in GDAL, we need at least:

  *   Support for parsing / using the IEEE 754 encoding (which I called type=”IEEE754”)
  *   Support for parsing / using the 32bit integer encoding (which I called type=”UINT”)
  *   Support for the “&” condition operator (for bitmask tests)
  *   Unit tests



I think I can hack my unit test code to output some test files.



Brad





From: Edson, Adam Robert <are131 at psu.edu>
Sent: Wednesday, 6 November 2019 1:36 AM
To: Brad Hards <bradh at frogmouth.net>; gdal-dev at lists.osgeo.org
Cc: Bradley, Eliza S <esb165 at psu.edu>
Subject: Re: [gdal-dev] python GDAL issue



Brad,



Sorry it took so long to get back to you.

I am interested in collaborating on this with you.

Any help would be appreciated!



Thanks!

Adam







________________________________

From: Brad Hards <bradh at frogmouth.net<mailto:bradh at frogmouth.net>>
Sent: Monday, October 14, 2019 6:16 PM
To: Edson, Adam Robert <are131 at psu.edu<mailto:are131 at psu.edu>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: RE: [gdal-dev] python GDAL issue



I think the problem is that there isn’t any real way to handle the IEEE-754 (or raw int/uint bitmask) in GDAL at the moment.



Working through the part you’ve posted:

S is the unit quantity



The part that looks like:

B\\0\\0\\0

is therefore the SCALE FACTOR, which is really IEEE 754-2008 binary encoded, and the existing TRE XML definition and parsing code doesn’t handle that case AFAICT.



This part is the ROW_GSD and COL_GSD + units:

0030.00

M

0030.00

M



In that case, I think there is a missing value in the TRE (because there has to be four bytes, and there are only three shown in your sample, which I assume is the test data that NGA derived from LANDSAT 8).



I’ve also been looking at handling “weird” TREs better (on and off for a while). I have a Java implementation that shares the XML definition, and the plan is to add two new types to the field definition:

        <xs:attribute name="type" use="optional">

            <xs:simpleType>

                <xs:restriction base="xs:string">

                    <xs:enumeration value="string"/>

                    <xs:enumeration value="integer"/>

                    <xs:enumeration value="real"/>

                    <xs:enumeration value="UINT"/>

                    <xs:enumeration value="IEEE754"/>

                </xs:restriction>

            </xs:simpleType>

        </xs:attribute>



(where UINT and IEEE754 values are new, and are binary encoded instead of string encoded).



Happy to collaborate on this if you’re interested.



Brad





From: Edson, Adam Robert <are131 at psu.edu<mailto:are131 at psu.edu>>
Sent: Monday, 14 October 2019 10:02 PM
To: Brad Hards <bradh at frogmouth.net<mailto:bradh at frogmouth.net>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] python GDAL issue



I am working on adding BANDSB and the other TREs listed in the SNIP document.



I am not sure what you are asking for.

However, here is the output from gdal.getMetadata('TRE') for the relevant portion of the BANDSB TRE

SPECTRAL RADIANCE       SB\\0\\0\\0\\0\\0\\00030.00M0030.00M-------M-------M
                                               \\0\\0DETECTOR<file://0/0DETECTOR>                \x7fU

This is the section from the radiometric_quantity field to wave_length_unit field.



Thanks!

Adam



________________________________

From: Brad Hards <bradh at frogmouth.net<mailto:bradh at frogmouth.net>>
Sent: Saturday, October 12, 2019 1:51 AM
To: Edson, Adam Robert <are131 at psu.edu<mailto:are131 at psu.edu>>; gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org> <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: RE: [gdal-dev] python GDAL issue



GDAL’s NITF encoding doesn’t appear to have BANDSB yet: https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml<https://nam01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fgithub.com%2FOSGeo%2Fgdal%2Fblob%2Fmaster%2Fgdal%2Fdata%2Fnitf_spec.xml&data=02%7C01%7Care131%40psu.edu%7C1f5f02d357214ab1cac808d7628e8df2%7C7cf48d453ddb4389a9c1c115526eb52e%7C0%7C0%7C637086236748118873&sdata=xuRz7pAyFvAKu69gUu9Rn%2BYVZvA%2FC2NWkhuC%2FCfbkgI%3D&reserved=0>



It would definitely help to see how that file encodes it. Can you open the NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some length value), and copy out the following 0nnnn characters?



Brad


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191106/6ccdff75/attachment-0001.html>

From bryantcurto at gmail.com  Wed Nov  6 13:45:52 2019
From: bryantcurto at gmail.com (Bryant)
Date: Wed, 6 Nov 2019 14:45:52 -0700 (MST)
Subject: [gdal-dev] OGRCoordinateTransformation Thread Safety
Message-ID: <1573076752519-0.post@n6.nabble.com>

Hello All!

I know that this question has been asked before, but not recently, and I
haven't found a satisfactory explanation.

Is OGRCoordinateTransformation threadsafe such that multiple threads can
call Transform on the same instance in parallel?

If not, why not? If so, where is this documented?

Thanks!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From bryantcurto at gmail.com  Wed Nov  6 13:51:28 2019
From: bryantcurto at gmail.com (Bryant)
Date: Wed, 6 Nov 2019 14:51:28 -0700 (MST)
Subject: [gdal-dev] OGRCoordinateTransformation Thread Safety
In-Reply-To: <1573076752519-0.post@n6.nabble.com>
References: <1573076752519-0.post@n6.nabble.com>
Message-ID: <1573077088763-0.post@n6.nabble.com>

Further, manual tests suggest that it is in GDAL 2.4.3 -- 20 threads
performing transformations on the same OGRCoordinateTransformation instance
and ensuring that the result is within 1e-4 of the correct result.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From bradh at frogmouth.net  Wed Nov  6 20:02:08 2019
From: bradh at frogmouth.net (Brad Hards)
Date: Thu, 7 Nov 2019 15:02:08 +1100
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <DM6PR02MB4362B345CEF48FC3A9FBA18993790@DM6PR02MB4362.namprd02.prod.outlook.com>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
 <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>
 <DM6PR02MB43629295455B9D9804518399937E0@DM6PR02MB4362.namprd02.prod.outlook.com>,
 <00de01d59477$68681b90$393852b0$@frogmouth.net>
 <DM6PR02MB4362B345CEF48FC3A9FBA18993790@DM6PR02MB4362.namprd02.prod.outlook.com>
Message-ID: <003601d59520$2019ee00$604dca00$@frogmouth.net>

I think it should check the "type" value. My "maybe this could work" concept
was something like:

 

--- a/gdal/frmts/nitf/nitffile.c

+++ b/gdal/frmts/nitf/nitffile.c

@@ -2150,6 +2150,8 @@ static char** NITFGenericMetadataReadTREInternal(char
**papszMD,

             const char* pszName = CPLGetXMLValue(psIter, "name", NULL);

             const char* pszLongName = CPLGetXMLValue(psIter, "longname",
NULL);

             const char* pszLength = CPLGetXMLValue(psIter, "length", NULL);

+            const char* pszType = CPLGetXMLValue(psIter, "type", "string");

+

             int nLength = -1;

             if (pszLength != NULL)

                 nLength = atoi(pszLength);

@@ -2219,7 +2221,17 @@ static char** NITFGenericMetadataReadTREInternal(char
**papszMD,

                 if (psOutXMLNode != NULL)

                 {

-                    const char* pszVal = strchr(papszMD[(*pnMDSize) - 1],
'=') + 1;

+                    

+                    char* pszVal = strchr(papszMD[(*pnMDSize) - 1], '=') +
1;

+                    if (strcmp(pszType, "IEEE754") == 0) 

+                    {

+                        // TODO: fix

+                        printf("IEEE754: 0x%02x 0x%02x 0x%02x 0x%02x\n",
pszVal[0], pszVal[1], pszVal[2], pszVal[3]);

+                        pszVal = "FIXME1";

+                    } else if (strcmp(pszType, "UINT") == 0) {

+                        printf("UINT: 0x%02x 0x%02x 0x%02x 0x%02x\n",
pszVal[0], pszVal[1], pszVal[2], pszVal[3]);

+                        pszVal = "FIXME2";

+                    }

                     CPLXMLNode* psFieldNode;

                     CPLXMLNode* psNameNode;

                     CPLXMLNode* psValueNode;

 

(I think the pzVal might need to be changed to a union / class that has
char*, a double or an unsigned int; I haven't dug further than this yet).

 

Brad

From: Edson, Adam Robert <are131 at psu.edu> 
Sent: Thursday, 7 November 2019 6:34 AM
To: Brad Hards <bradh at frogmouth.net>; gdal-dev at lists.osgeo.org
Cc: Bradley, Eliza S <esb165 at psu.edu>
Subject: Re: [gdal-dev] python GDAL issue

 

Looking at the code, it appears that GDAL actually hard codes any TRE that
takes anything that cannot be parsed as a string (e.g. nitfimage.c
NITFReadICHIPB). So, for BANDSB with its EXISTENCE_MASK and SCALE_FACTOR
would need to be hard coded as opposed to being defined just within the
nitf_spec.xml. Is this the correct interpretation?

 

Thanks!

Adam

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191107/20e6aa58/attachment.html>

From nyall.dawson at gmail.com  Wed Nov  6 21:24:44 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Thu, 7 Nov 2019 15:24:44 +1000
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <2121413.VCeqEJs6lA@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
 <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
Message-ID: <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>

On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com> wrote:
>
> > I realise this too, but to permit legacy results to be replicated,
>
> Some legacy behaviour was just plain wrong/inaccurate. Trying to replicate it
> in PROJ would be heartbreaking, an extra maintaince burden, and a confusion
> for PROJ users because depending on the path they take, they would get
> different results.
>
> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
>
> You get a ~1.5 metre shift to the north east as expected.

This thread has been bouncing around in my mind for the last week.
Forgive me if I'm misinterpreting the situation, but wouldn't you
explicitly want legacy results NOT to be reproducible in cases where
proj 6's more accurate transformation capabilities have affected these
results?

If a particular study isn't affected by relatively small shifts such
as the 1.5m shift in the GDA2020 situation, then the results should
remain reproducible even if this shift is corrected. But if a
particular study IS affected by distances of this magnitude then I'd
argue that it would be vital that the older proj behavior can't be
reproduced exactly, and accordingly the previous study/results are
invalidated as a direct result..!

Nyall


>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Thu Nov  7 01:48:09 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Nov 2019 10:48:09 +0100
Subject: [gdal-dev] OGRCoordinateTransformation Thread Safety
In-Reply-To: <1573077088763-0.post@n6.nabble.com>
References: <1573076752519-0.post@n6.nabble.com>
 <1573077088763-0.post@n6.nabble.com>
Message-ID: <1630987.AlzYC4WLRs@even-i700>

On mercredi 6 novembre 2019 14:51:28 CET Bryant wrote:
> Further, manual tests suggest that it is in GDAL 2.4.3 -- 20 threads
> performing transformations on the same OGRCoordinateTransformation instance
> and ensuring that the result is within 1e-4 of the correct result.

As most C/C++ libraries, an object is not thread-safe unless it is explicitly 
mentioned it is. This holds for OGRCoordinateTransformation. In GDAL 2.4 with 
PROJ 5.x, you might not notice severe issues in practice (beyond the PROJ 
error state being accessed concurrently). With PROJ 6, you'd likely get 
crashes.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Nov  7 01:54:57 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Nov 2019 10:54:57 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
Message-ID: <1778118.8iZkyXdO3u@even-i700>

On jeudi 7 novembre 2019 15:24:44 CET Nyall Dawson wrote:
> On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > > I realise this too, but to permit legacy results to be replicated,
> > 
> > Some legacy behaviour was just plain wrong/inaccurate. Trying to replicate
> > it in PROJ would be heartbreaking, an extra maintaince burden, and a
> > confusion for PROJ users because depending on the path they take, they
> > would get different results.
> > 
> > Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
> > 
> > You get a ~1.5 metre shift to the north east as expected.
> 
> This thread has been bouncing around in my mind for the last week.
> Forgive me if I'm misinterpreting the situation, but wouldn't you
> explicitly want legacy results NOT to be reproducible in cases where
> proj 6's more accurate transformation capabilities have affected these
> results?
> 
> If a particular study isn't affected by relatively small shifts such
> as the 1.5m shift in the GDA2020 situation, then the results should
> remain reproducible even if this shift is corrected. But if a
> particular study IS affected by distances of this magnitude then I'd
> argue that it would be vital that the older proj behavior can't be
> reproduced exactly, and accordingly the previous study/results are
> invalidated as a direct result..!

Are you saying that the new behaviour of ExportToProj4() shouldn't cause 
issues ? Well, that's more subtle than that. As +towgs84 terms might be 
omitted more often now, you can get differences of ~ 100 metres when dealing 
with datums dating before the GPS era. So when using GDAL 3 ExportToProj4() 
you can effectively get "wrong" results in some cases.

The action I took for now is to document the issue with ExportToProj4():
https://gdal.org/doxygen/
classOGRSpatialReference.html#a271b3de4caf844135b0c61e634860f2b


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Roger.Bivand at nhh.no  Thu Nov  7 02:05:29 2019
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Nov 2019 11:05:29 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
 <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
Message-ID: <alpine.LFD.2.21.1911071015100.18987@reclus.nhh.no>

On Thu, 7 Nov 2019, Nyall Dawson wrote:

> On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com> wrote:
>>
>>> I realise this too, but to permit legacy results to be replicated,
>>
>> Some legacy behaviour was just plain wrong/inaccurate. Trying to 
>> replicate it in PROJ would be heartbreaking, an extra maintaince 
>> burden, and a confusion for PROJ users because depending on the path 
>> they take, they would get different results.
>>
>> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
>>
>> You get a ~1.5 metre shift to the north east as expected.
>
> This thread has been bouncing around in my mind for the last week. 
> Forgive me if I'm misinterpreting the situation, but wouldn't you 
> explicitly want legacy results NOT to be reproducible in cases where 
> proj 6's more accurate transformation capabilities have affected these 
> results?

Thanks for contributing! In research reproducibility, being able now to 
get the same results as when the research was conducted using the same 
software is basic. However, when the "same software" - including calls to 
metadata like EPSG descriptions - is no longer the "same", we need to be 
careful. I agree that wanting to flag and accept situations in which 
subsequent versions of apparently the same software yield different and 
more "precise" outcomes is reasonable.

A specific issue with GDAL 3 using PROJ 6 is that exportToProj4() drops 
keys like +datum=. In R packages, Proj4 strings have been used since the 
beginning (early 2000s) to attach CRS information to spatial objects. When 
(justifiably) +datum= is deprecated, users suddenly and without warning go 
from legacy precision to ballpark only, so worse by two orders of 
magnitude on transformation (because the source object CRS description is 
degraded).

We are now scrambling to add WKT2_2018 as a string representation on read 
and for write, because unlike exportToProj4(), exportToWkt() does preserve 
datum specifications. For those interested, the rgdal package on R-Forge 
(development, unstable) now piggy-backs WKT2 as a comment on sp CRS 
objects for reading or writing vector and raster files, using WKT2 rather 
than Proj4 strings if available. Next steps are to adapt coordinate 
operations to use WKT2 CRS descriptions rather than Proj4 strings for 
coordinate operations, including adding choices of pipelines and 
on-the-fly downloading of grids further ahead.

>
> If a particular study isn't affected by relatively small shifts such as 
> the 1.5m shift in the GDA2020 situation, then the results should remain 
> reproducible even if this shift is corrected. But if a particular study 
> IS affected by distances of this magnitude then I'd argue that it would 
> be vital that the older proj behavior can't be reproduced exactly, and 
> accordingly the previous study/results are invalidated as a direct 
> result..!

The negative outcomes are rather because say +datum= did a reasonable job 
before GDAL 3, but with GDAL 3 and the deletion of tags (+datum= is gone, 
+towgs84= and +init= are vulnerable and should be avoided), outcomes in 
GDAL3/PROJ6 are much worse (justifiably so) than GDAL2/PROJ5.

I think adaptation of R packages to modern PROJ/GDAL is feasible, and 
enough progress has been made to make me a bit more comfortable. See also 
coments by Markus Metz for GRASS and Mike Sumner (R, special interest in 
the Antarctic); I've benefitted also from reading the Cython code in 
pyproj (Alan Snow has posted here too - thanks!).

Roger

>
> Nyall
>
>
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From Roger.Bivand at nhh.no  Thu Nov  7 02:10:26 2019
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Nov 2019 11:10:26 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <1778118.8iZkyXdO3u@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
 <1778118.8iZkyXdO3u@even-i700>
Message-ID: <alpine.LFD.2.21.1911071108030.18987@reclus.nhh.no>

On Thu, 7 Nov 2019, Even Rouault wrote:

> On jeudi 7 novembre 2019 15:24:44 CET Nyall Dawson wrote:
>> On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com>
> wrote:
>>>> I realise this too, but to permit legacy results to be replicated,
>>>
>>> Some legacy behaviour was just plain wrong/inaccurate. Trying to replicate
>>> it in PROJ would be heartbreaking, an extra maintaince burden, and a
>>> confusion for PROJ users because depending on the path they take, they
>>> would get different results.
>>>
>>> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
>>>
>>> You get a ~1.5 metre shift to the north east as expected.
>>
>> This thread has been bouncing around in my mind for the last week.
>> Forgive me if I'm misinterpreting the situation, but wouldn't you
>> explicitly want legacy results NOT to be reproducible in cases where
>> proj 6's more accurate transformation capabilities have affected these
>> results?
>>
>> If a particular study isn't affected by relatively small shifts such
>> as the 1.5m shift in the GDA2020 situation, then the results should
>> remain reproducible even if this shift is corrected. But if a
>> particular study IS affected by distances of this magnitude then I'd
>> argue that it would be vital that the older proj behavior can't be
>> reproduced exactly, and accordingly the previous study/results are
>> invalidated as a direct result..!
>
> Are you saying that the new behaviour of ExportToProj4() shouldn't cause
> issues ? Well, that's more subtle than that. As +towgs84 terms might be
> omitted more often now, you can get differences of ~ 100 metres when dealing
> with datums dating before the GPS era. So when using GDAL 3 ExportToProj4()
> you can effectively get "wrong" results in some cases.
>
> The action I took for now is to document the issue with ExportToProj4():
> https://gdal.org/doxygen/
> classOGRSpatialReference.html#a271b3de4caf844135b0c61e634860f2b
>

The red-lined Warning is very explicit:

"Use of this function is discouraged. Its behaviour in GDAL >= 3 / PROJ >= 
6 is significantly different from earlier versions. In particular +datum 
will only encode WGS84, NAD27 and NAD83, and +towgs84/+nadgrids terms will 
be missing most of the time. PROJ strings to encode CRS should be 
considered as a a legacy solution. Using a AUTHORITY:CODE or WKT 
representation is the recommended way."

I think importFromProj4() is more forgiving - is this likely to continue, 
or should we move away from Proj4 anyway?

Thanks!!

Roger

>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From clemens.rudert at posteo.de  Thu Nov  7 02:44:14 2019
From: clemens.rudert at posteo.de (Clemens Rudert)
Date: Thu, 7 Nov 2019 11:44:14 +0100
Subject: [gdal-dev] GDAL/OGR curve stroking dfMaxAngleStepSizeDegrees
Message-ID: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>

Hi folks


Iam interested in the default value for parameter 
dfMaxAngleStepSizeDegrees for stroking curved polygons. The OGR docs 
https://gdal.org/doxygen/classOGRPolygon.html#a7e5a3f9a67e18e045167832c5b8ff850 
say only that there is some default value used if parameter 0 is passed. 
Does anybody has an idea where to find this default value?


Regards

Clemens


From even.rouault at spatialys.com  Thu Nov  7 03:30:44 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Nov 2019 12:30:44 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <alpine.LFD.2.21.1911071108030.18987@reclus.nhh.no>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <1778118.8iZkyXdO3u@even-i700>
 <alpine.LFD.2.21.1911071108030.18987@reclus.nhh.no>
Message-ID: <1654645.86fTB332Y3@even-i700>

On jeudi 7 novembre 2019 11:10:26 CET Roger Bivand wrote:
> On Thu, 7 Nov 2019, Even Rouault wrote:
> > On jeudi 7 novembre 2019 15:24:44 CET Nyall Dawson wrote:
> >> On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> >>>> I realise this too, but to permit legacy results to be replicated,
> >>> 
> >>> Some legacy behaviour was just plain wrong/inaccurate. Trying to
> >>> replicate
> >>> it in PROJ would be heartbreaking, an extra maintaince burden, and a
> >>> confusion for PROJ users because depending on the path they take, they
> >>> would get different results.
> >>> 
> >>> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
> >>> 
> >>> You get a ~1.5 metre shift to the north east as expected.
> >> 
> >> This thread has been bouncing around in my mind for the last week.
> >> Forgive me if I'm misinterpreting the situation, but wouldn't you
> >> explicitly want legacy results NOT to be reproducible in cases where
> >> proj 6's more accurate transformation capabilities have affected these
> >> results?
> >> 
> >> If a particular study isn't affected by relatively small shifts such
> >> as the 1.5m shift in the GDA2020 situation, then the results should
> >> remain reproducible even if this shift is corrected. But if a
> >> particular study IS affected by distances of this magnitude then I'd
> >> argue that it would be vital that the older proj behavior can't be
> >> reproduced exactly, and accordingly the previous study/results are
> >> invalidated as a direct result..!
> > 
> > Are you saying that the new behaviour of ExportToProj4() shouldn't cause
> > issues ? Well, that's more subtle than that. As +towgs84 terms might be
> > omitted more often now, you can get differences of ~ 100 metres when
> > dealing with datums dating before the GPS era. So when using GDAL 3
> > ExportToProj4() you can effectively get "wrong" results in some cases.
> > 
> > The action I took for now is to document the issue with ExportToProj4():
> > https://gdal.org/doxygen/
> > classOGRSpatialReference.html#a271b3de4caf844135b0c61e634860f2b
> 
> The red-lined Warning is very explicit:
> 
> "Use of this function is discouraged. Its behaviour in GDAL >= 3 / PROJ >=
> 6 is significantly different from earlier versions. In particular +datum
> will only encode WGS84, NAD27 and NAD83, and +towgs84/+nadgrids terms will
> be missing most of the time. PROJ strings to encode CRS should be
> considered as a a legacy solution. Using a AUTHORITY:CODE or WKT
> representation is the recommended way."
> 
> I think importFromProj4() is more forgiving - is this likely to continue,
> or should we move away from Proj4 anyway?

importFromProj4() is likely to continue to exist in the foreseable future. 
There are various raster/vector formats that use PROJ.4 strings to encode the 
CRS, so we want to still be able to decode them.
What is discouraged is the generation of new PROJ.4 CRS strings from now.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Roger.Bivand at nhh.no  Thu Nov  7 04:09:47 2019
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Thu, 7 Nov 2019 13:09:47 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <1654645.86fTB332Y3@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <1778118.8iZkyXdO3u@even-i700>
 <alpine.LFD.2.21.1911071108030.18987@reclus.nhh.no>
 <1654645.86fTB332Y3@even-i700>
Message-ID: <alpine.LFD.2.21.1911071301420.26049@reclus.nhh.no>

On Thu, 7 Nov 2019, Even Rouault wrote:

> On jeudi 7 novembre 2019 11:10:26 CET Roger Bivand wrote:
>> On Thu, 7 Nov 2019, Even Rouault wrote:
>>> On jeudi 7 novembre 2019 15:24:44 CET Nyall Dawson wrote:
>>>> On Wed, 30 Oct 2019 at 06:16, Even Rouault <even.rouault at spatialys.com>
>>>
>>> wrote:
>>>>>> I realise this too, but to permit legacy results to be replicated,
>>>>>
>>>>> Some legacy behaviour was just plain wrong/inaccurate. Trying to
>>>>> replicate
>>>>> it in PROJ would be heartbreaking, an extra maintaince burden, and a
>>>>> confusion for PROJ users because depending on the path they take, they
>>>>> would get different results.
>>>>>
>>>>> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
>>>>>
>>>>> You get a ~1.5 metre shift to the north east as expected.
>>>>
>>>> This thread has been bouncing around in my mind for the last week.
>>>> Forgive me if I'm misinterpreting the situation, but wouldn't you
>>>> explicitly want legacy results NOT to be reproducible in cases where
>>>> proj 6's more accurate transformation capabilities have affected these
>>>> results?
>>>>
>>>> If a particular study isn't affected by relatively small shifts such
>>>> as the 1.5m shift in the GDA2020 situation, then the results should
>>>> remain reproducible even if this shift is corrected. But if a
>>>> particular study IS affected by distances of this magnitude then I'd
>>>> argue that it would be vital that the older proj behavior can't be
>>>> reproduced exactly, and accordingly the previous study/results are
>>>> invalidated as a direct result..!
>>>
>>> Are you saying that the new behaviour of ExportToProj4() shouldn't cause
>>> issues ? Well, that's more subtle than that. As +towgs84 terms might be
>>> omitted more often now, you can get differences of ~ 100 metres when
>>> dealing with datums dating before the GPS era. So when using GDAL 3
>>> ExportToProj4() you can effectively get "wrong" results in some cases.
>>>
>>> The action I took for now is to document the issue with ExportToProj4():
>>> https://gdal.org/doxygen/
>>> classOGRSpatialReference.html#a271b3de4caf844135b0c61e634860f2b
>>
>> The red-lined Warning is very explicit:
>>
>> "Use of this function is discouraged. Its behaviour in GDAL >= 3 / PROJ >=
>> 6 is significantly different from earlier versions. In particular +datum
>> will only encode WGS84, NAD27 and NAD83, and +towgs84/+nadgrids terms will
>> be missing most of the time. PROJ strings to encode CRS should be
>> considered as a a legacy solution. Using a AUTHORITY:CODE or WKT
>> representation is the recommended way."
>>
>> I think importFromProj4() is more forgiving - is this likely to continue,
>> or should we move away from Proj4 anyway?
>
> importFromProj4() is likely to continue to exist in the foreseable future.
> There are various raster/vector formats that use PROJ.4 strings to encode the
> CRS, so we want to still be able to decode them.
> What is discouraged is the generation of new PROJ.4 CRS strings from now.

Thanks for the clarification. So, as per:

https://proj.org/usage/quickstart.html

and in the development version of R's rgdal package, I can populate a WKT2 
from, for example:

> cat(showSRID("+proj=merc +lat_ts=56.5 +ellps=GRS80", format="WKT2", 
+ multiline="YES"), "\n")
PROJCRS["unknown",
     BASEGEOGCRS["unknown",
         DATUM["Unknown based on GRS80 ellipsoid",
             ELLIPSOID["GRS 1980",6378137,298.257222101,
                 LENGTHUNIT["metre",1],
                 ID["EPSG",7019]]],
         PRIMEM["Greenwich",0,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8901]]],
     CONVERSION["unknown",
         METHOD["Mercator (variant B)",
             ID["EPSG",9805]],
         PARAMETER["Latitude of 1st standard parallel",56.5,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8823]],
         PARAMETER["Longitude of natural origin",0,
             ANGLEUNIT["degree",0.0174532925199433],
             ID["EPSG",8802]],
         PARAMETER["False easting",0,
             LENGTHUNIT["metre",1],
             ID["EPSG",8806]],
         PARAMETER["False northing",0,
             LENGTHUNIT["metre",1],
             ID["EPSG",8807]]],
     CS[Cartesian,2],
         AXIS["(E)",east,
             ORDER[1],
             LENGTHUNIT["metre",1,
                 ID["EPSG",9001]]],
         AXIS["(N)",north,
             ORDER[2],
             LENGTHUNIT["metre",1,
                 ID["EPSG",9001]]]]

So for example, Mike Sumner should be able to continue to use proj4 
strings to instantiate SRS in a shorthand way provided they can be handled 
by importFromProj4(), and we can expect this usage to continue to work 
because, as you say, data sets themselves use Proj4 strings, and this path 
must remain open.

Roger


>
> Even
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From bryantcurto at gmail.com  Thu Nov  7 07:49:06 2019
From: bryantcurto at gmail.com (Bryant)
Date: Thu, 7 Nov 2019 08:49:06 -0700 (MST)
Subject: [gdal-dev] OGRCoordinateTransformation Thread Safety
In-Reply-To: <1630987.AlzYC4WLRs@even-i700>
References: <1573076752519-0.post@n6.nabble.com>
 <1573077088763-0.post@n6.nabble.com> <1630987.AlzYC4WLRs@even-i700>
Message-ID: <1573141746090-0.post@n6.nabble.com>

Thank you for the response Even!

>As most C/C++ libraries, an object is not thread-safe unless it is
explicitly mentioned it is.

This makes sense.
However, I inferred from one of your  previous responses
<http://osgeo-org.1560.x6.nabble.com/gdal-dev-Possible-concurrency-issue-in-OGRCoordinateTransformation-tp5285641.html>  
that OGRCoordinateTransformation is reentrant:
>You need to have one coordinate transform object per thread.

where reentrant means
<https://gdal.org/development/rfc/rfc16_ogr_reentrancy.html>  
>Reentrant: A reentrant function can be called simultaneously by multiple
threads provided that each invocation of the function references unique
data.
- from the  docs
<https://gdal.org/development/rfc/rfc16_ogr_reentrancy.html>  

Is this inference correct and, if so, where is this stated in the docs for
OGRCoordinateTransformation?





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Nov  7 08:47:46 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 Nov 2019 17:47:46 +0100
Subject: [gdal-dev] OGRCoordinateTransformation Thread Safety
In-Reply-To: <1573141746090-0.post@n6.nabble.com>
References: <1573076752519-0.post@n6.nabble.com>
 <1630987.AlzYC4WLRs@even-i700> <1573141746090-0.post@n6.nabble.com>
Message-ID: <1698665.rf1aBOAZ5u@even-i700>

On jeudi 7 novembre 2019 08:49:06 CET Bryant wrote:
> Thank you for the response Even!
> 
> >As most C/C++ libraries, an object is not thread-safe unless it is
> 
> explicitly mentioned it is.
> 
> This makes sense.
> However, I inferred from one of your  previous responses
> <http://osgeo-org.1560.x6.nabble.com/gdal-dev-Possible-concurrency-issue-in-> OGRCoordinateTransformation-tp5285641.html>
> that OGRCoordinateTransformation is reentrant:
> >You need to have one coordinate transform object per thread.
> 
> where reentrant means
> <https://gdal.org/development/rfc/rfc16_ogr_reentrancy.html>
> 
> >Reentrant: A reentrant function can be called simultaneously by multiple
> 
> threads provided that each invocation of the function references unique
> data.
> - from the  docs
> <https://gdal.org/development/rfc/rfc16_ogr_reentrancy.html>
> 
> Is this inference correct 

I'm always confused by the thread-safe vs reentrant terminology, but my 
today's statement was to be interpreted in the meaning of RFC16 you quote: you 
can use several OGRCoordinateTransformation instances from different threads, 
provided that you don't use the same OGRCoordinateTransformation instance in 
several threads simultaneously

> and, if so, where is this stated in the docs for
> OGRCoordinateTransformation?

Nowhere. We can't possibly document that on all objects. This is mostly the 
default behaviour of all C/C++ libs I know. Feel free to submit a pull request 
if you feel like it should be documented for that case however.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jgomezdans at gmail.com  Thu Nov  7 09:21:04 2019
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Thu, 7 Nov 2019 17:21:04 +0000
Subject: [gdal-dev] Limit on the number of files for gdalbuildvrt
In-Reply-To: <CAMWde5oePkpLode4A84PnhLx2==E3NSkYeWZqt8DN7cjEh=Obg@mail.gmail.com>
References: <CAMWde5pG3iqF1CvatG10r2afj+7SfYOgNy-xFt8_xk17dt9mqw@mail.gmail.com>
 <1621489.h3OLbH8oeh@even-i700>
 <CAMWde5oePkpLode4A84PnhLx2==E3NSkYeWZqt8DN7cjEh=Obg@mail.gmail.com>
Message-ID: <CAMWde5p3JDcRFFpsReC_HkGrWyXsjGnarL6KOQ9b6PLEZarPLg@mail.gmail.com>

Getting through a bit further... It appears that I can get this fixed if I
set GDAL_DISABLE_READDIR_ON_OPEN to YES:
GDAL_DISABLE_READDIR_ON_OPEN=YES gdalbuildvrt -input_file_list flist.txt
outputfile.vrt

In order to use the file, GDAL_DISABLE_READDIR_ON_OPEN needs to be selected
too.

Mystery solved, it would seem.

Thanks!

On Fri, 1 Nov 2019 at 17:21, Jose Gomez-Dans <jgomezdans at gmail.com> wrote:

> Dear Even,
>
> Thanks for your help. After a bit more dredging, I am only able to repeat
> my problem on a particularly mounted filesystem in an HPC facility I use.
> On other systems (and even other mountpoints on that same HPC system)
> things work as expected. I've taken this up with our administrators, but
> just as a warning to others that it can happen and I didn't dream it!
>
> Thanks for your very prompt reply
> Jose
>
> On Wed, 30 Oct 2019 at 16:16, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On mercredi 30 octobre 2019 15:52:54 CET Jose Gomez-Dans wrote:
>> > Hi,
>> >
>> > I'm mosaicking a large number of small tiles using the GDAL python
>> bindings
>> > (python 3.7, gdal 3.0.1, but also tested on 2.4.2). Code is something
>> like
>> >
>> > ```
>> >
>> > *output_fname = "/something/or/other.vrt"*
>> > *fnames = ["file1.tif", ..., "fileN.tif"]*
>> >
>> >
>> >
>> >
>> > *dst_ds = gdal.BuildVRT(            output_fname,            fnames,
>> >     options=gdal.BuildVRTOptions(separate=True),        )*
>> > *dst_ds = None*
>> > ```
>> >
>> > This fails with lots of errors like
>> > ERROR 4: fileXXX.tif: No such file or directory
>> > Warning 1: Can't open fileXXX.tif. Skipping it
>>
>> gdalbuildvrt is normally cautious about non opening too many files at the
>> same
>> time. I can't replicate your issue with the following script
>>
>> ```
>> from osgeo import gdal
>> import shutil
>>
>> fnames = []
>> for i in range(1024):
>>     dstname = 'testbuildvrt/byte%d.tif' % i
>>     shutil.copy('byte.tif', dstname)
>>     fnames.append(dstname)
>>
>> dst_ds = gdal.BuildVRT(
>>             "/tmp/out.vrt",
>>             fnames,
>>             options=gdal.BuildVRTOptions(separate=True),
>>         )
>> dst_ds = None
>> ```
>>
>> > The aim of this is to create a VRT mosaic that can then be converted to
>> > GeoTIFF.
>>
>> If you want a mosaic, you likely want separate=False.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191107/e24ff532/attachment.html>

From nyall.dawson at gmail.com  Thu Nov  7 16:00:06 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Fri, 8 Nov 2019 10:00:06 +1000
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <alpine.LFD.2.21.1911071015100.18987@reclus.nhh.no>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
 <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAB28AsgbbhOjAhQQzV_B_o8Dq8z8dOmRXecuEcKs_kWE32qEaw@mail.gmail.com>
 <alpine.LFD.2.21.1911071015100.18987@reclus.nhh.no>
Message-ID: <CAB28AsjyzsBeWEdcC7VgPp+UPES2kSimxVSj0sXeLTH_Hw3PGA@mail.gmail.com>

On Thu, 7 Nov 2019 at 20:05, Roger Bivand <Roger.Bivand at nhh.no> wrote:

> Thanks for contributing! In research reproducibility, being able now to
> get the same results as when the research was conducted using the same
> software is basic.

(again, apologies if I'm ignorant here -- I'm coming from a totally
different discipline and background).

If studies were made using a software version with a bug that was
later fixed, in that case you definitely wouldn't want to reproduce
earlier results, right? E.g. the recent Willoughby-Hoye script bug
which potentially invalidated ~150 studies
(https://arstechnica.com/information-technology/2019/10/chemists-discover-cross-platform-python-scripts-not-so-cross-platform/).
Admittedly the situation with proj is much more complex than just a
"bug in the software"!

My gut instinct is that if I was relying on any results generated
using proj 4's logic, I'd much rather have someone re-run the data
using proj 6's refined handling (including requirin any requisite
modifications to the scripts to shift from proj strings to auth/id
codes or wkt definitions), and compare these new results with the
earlier results in order to **justifiably** verify that different
handling of datum shifts and reprojection did NOT have any significant
impact on the results.

Nyall


 However, when the "same software" - including calls to
> metadata like EPSG descriptions - is no longer the "same", we need to be
> careful. I agree that wanting to flag and accept situations in which
> subsequent versions of apparently the same software yield different and
> more "precise" outcomes is reasonable.
>
> A specific issue with GDAL 3 using PROJ 6 is that exportToProj4() drops
> keys like +datum=. In R packages, Proj4 strings have been used since the
> beginning (early 2000s) to attach CRS information to spatial objects. When
> (justifiably) +datum= is deprecated, users suddenly and without warning go
> from legacy precision to ballpark only, so worse by two orders of
> magnitude on transformation (because the source object CRS description is
> degraded).
>
> We are now scrambling to add WKT2_2018 as a string representation on read
> and for write, because unlike exportToProj4(), exportToWkt() does preserve
> datum specifications. For those interested, the rgdal package on R-Forge
> (development, unstable) now piggy-backs WKT2 as a comment on sp CRS
> objects for reading or writing vector and raster files, using WKT2 rather
> than Proj4 strings if available. Next steps are to adapt coordinate
> operations to use WKT2 CRS descriptions rather than Proj4 strings for
> coordinate operations, including adding choices of pipelines and
> on-the-fly downloading of grids further ahead.
>
> >
> > If a particular study isn't affected by relatively small shifts such as
> > the 1.5m shift in the GDA2020 situation, then the results should remain
> > reproducible even if this shift is corrected. But if a particular study
> > IS affected by distances of this magnitude then I'd argue that it would
> > be vital that the older proj behavior can't be reproduced exactly, and
> > accordingly the previous study/results are invalidated as a direct
> > result..!
>
> The negative outcomes are rather because say +datum= did a reasonable job
> before GDAL 3, but with GDAL 3 and the deletion of tags (+datum= is gone,
> +towgs84= and +init= are vulnerable and should be avoided), outcomes in
> GDAL3/PROJ6 are much worse (justifiably so) than GDAL2/PROJ5.
>
> I think adaptation of R packages to modern PROJ/GDAL is feasible, and
> enough progress has been made to make me a bit more comfortable. See also
> coments by Markus Metz for GRASS and Mike Sumner (R, special interest in
> the Antarctic); I've benefitted also from reading the Cython code in
> pyproj (Alan Snow has posted here too - thanks!).
>
> Roger
>
> >
> > Nyall
> >
> >
> >>
> >> --
> >> Spatialys - Geospatial professional services
> >> http://www.spatialys.com
> >> _______________________________________________
> >> gdal-dev mailing list
> >> gdal-dev at lists.osgeo.org
> >> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
>
> --
> Roger Bivand
> Department of Economics, Norwegian School of Economics,
> Helleveien 30, N-5045 Bergen, Norway.
> voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
> https://orcid.org/0000-0003-2392-6140
> https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From palmerjnz at gmail.com  Thu Nov  7 23:14:00 2019
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Fri, 8 Nov 2019 18:14:00 +1100
Subject: [gdal-dev] Add padding to an image
Message-ID: <CAA5WJYnODMW5U-SZYJLi=EbJ92bCAPXrKnqOXkhCmL9wRz4UjQ@mail.gmail.com>

Hi All,

What the best way to pad an output RGBA image with gdal tools?

Thanks in advance.

Cheers
Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191108/1b249d0d/attachment.html>

From gregory.bataille at gmail.com  Thu Nov  7 23:18:11 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 8 Nov 2019 08:18:11 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
Message-ID: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>

Hey all,

So I have a strange issue that I somewhat isolated, but I don't know how to
move further.
I have dataset in EPSG 31468-15949

My goal is to tile it, render it with openlayers, and add a marker on the
GCP location.
Trouble is that the GCP location was falling a bit away from the marker
image.

I had a hard time investigating that, and I still do but I realized that
tiling in other conditions did work perfectly.

So in Production
- I have a docker image which is basically osgeo/gdal:alpine-normal-3.0.2
  - this means GDAL 3.0.2
  - PROJ 6.2.1

If I use this docker to do the tiling, then I get the "badly aligned" tile.

On my local MAC
- I have gdal 3.0.1 installed from the brew
repository osgeo/osgeo4mac/osgeo-gdal
- I have proj 6.2.0
- I have the GDAL 3.0.1 pip package installed

If I use my MAC to tile, I get the "aligned" tile

And that's it, I'm stuck.
I tried in a python shell to do coordinates transform of the GCP from the
source WKT to EPSG 3857 and I get the same value whether in the docker or
on my MAC

Any idea how I can move further?

I have put a zip with some data here
https://prod-pix4d-public-assets.s3.amazonaws.com/issue_investigation/Investigation_tile_alignment.zip

Thanks

---
Gregory Bataille
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191108/1f5658d9/attachment.html>

From ahmettemiz88 at gmail.com  Fri Nov  8 00:01:36 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Fri, 8 Nov 2019 11:01:36 +0300
Subject: [gdal-dev] problem in creating a ogrlinestring.
Message-ID: <CAJKO1Yv4CP7L=p0xjuHOkKAHBkW=6j7ZbKyoho4+r7bFVSniMQ@mail.gmail.com>

I encountered a problem in creating a ogrlinestring.
What am I doing wrong here?


for ( std::vector < std::pair < OGRPolygon *,OGRPolygon *  > >::iterator
it_box_pol=this->get_vbox().begin();
it_box_pol != std::prev(this->get_vbox().end()) ;it_box_pol++){

               for (std::map <  OGRLineString * , std::string >::iterator
it_yol_oto=this->getMapYol_oto().begin();
    it_yol_oto!= this->getMapYol_oto().end()  ;++it_yol_oto ){

    if ( it_yol_oto->first->Intersects(it_box_pol->first) ){
                                //OGRLineString * poLine= (OGRLineString *
)it_yol_oto->first->Intersection(it_box_pol->second);
    OGRLineString * poLine= (OGRLineString *
)it_yol_oto->first->Intersection(it_box_pol->second);
std::cout << "\n NumberOfPoints 0 **  " << poLine->getNumPoints <<
std::endl ;   // *** this says :  ***   error: invalid use of non-static
member function ‘virtual int OGRSimpleCurve::getNumPoints() const’
         std::cout << "\n NumberOfPoints 0 **  " << poLine->getNumPoints <<
std::endl ;
***

    vyol_oto_in_buffer.push_back( poLine );
                            }
    }
  }

regards

-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191108/a77a0e9f/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov  8 00:23:26 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 8 Nov 2019 01:23:26 -0700 (MST)
Subject: [gdal-dev] Add padding to an image
In-Reply-To: <CAA5WJYnODMW5U-SZYJLi=EbJ92bCAPXrKnqOXkhCmL9wRz4UjQ@mail.gmail.com>
References: <CAA5WJYnODMW5U-SZYJLi=EbJ92bCAPXrKnqOXkhCmL9wRz4UjQ@mail.gmail.com>
Message-ID: <1573201406102-0.post@n6.nabble.com>

Hi,

Have you considered to ask this question from gis.stackexcange? As a
platform it suits better for a question like this that has many alternative
and perhaps opinion based answers. It allows also an easier way for you to
improve your question that in its current state would probably be closed in
gis.stackexchange as "too broad" or "unclear what you're asking", or perhaps
"primarily opinion-based".

Could you explain what you mean with padding, and if you would rather use
some GDAL program or for example Python?

-Jukka Rahkonen-



Jeremy Palmer-3 wrote
> Hi All,
> 
> What the best way to pad an output RGBA image with gdal tools?
> 
> Thanks in advance.
> 
> Cheers
> Jeremy
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From palmerjnz at gmail.com  Fri Nov  8 01:09:31 2019
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Fri, 8 Nov 2019 20:09:31 +1100
Subject: [gdal-dev] Add padding to an image
In-Reply-To: <1573201406102-0.post@n6.nabble.com>
References: <CAA5WJYnODMW5U-SZYJLi=EbJ92bCAPXrKnqOXkhCmL9wRz4UjQ@mail.gmail.com>
 <1573201406102-0.post@n6.nabble.com>
Message-ID: <CAA5WJY=e=heAoh3JkBLAu8O9ak_Nay-g_nPv0aDDEvYOtyC1SA@mail.gmail.com>

Sure. no problem. I posted the question here
https://gis.stackexchange.com/questions/341188/add-padding-when-resizing-an-image

Thanks
Jeremy

On Fri, Nov 8, 2019 at 7:23 PM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> Have you considered to ask this question from gis.stackexcange? As a
> platform it suits better for a question like this that has many alternative
> and perhaps opinion based answers. It allows also an easier way for you to
> improve your question that in its current state would probably be closed in
> gis.stackexchange as "too broad" or "unclear what you're asking", or
> perhaps
> "primarily opinion-based".
>
> Could you explain what you mean with padding, and if you would rather use
> some GDAL program or for example Python?
>
> -Jukka Rahkonen-
>
>
>
> Jeremy Palmer-3 wrote
> > Hi All,
> >
> > What the best way to pad an output RGBA image with gdal tools?
> >
> > Thanks in advance.
> >
> > Cheers
> > Jeremy
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191108/5f2534ed/attachment-0001.html>

From even.rouault at spatialys.com  Fri Nov  8 03:30:14 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 Nov 2019 12:30:14 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
Message-ID: <4469243.TJ2OctFfXH@even-i700>

On vendredi 8 novembre 2019 08:18:11 CET Grégory Bataille wrote:
> Hey all,
> 
> So I have a strange issue that I somewhat isolated, but I don't know how to
> move further.
> I have dataset in EPSG 31468-15949

I would check if that wouldn't be related to availability of the BETA2007.gsb 
grid. osgeo/gdal:alpine-normal-3.0.2 has it. Does your MAC install have it ?

That said, your TIFF file has a hardcoded TOWGS84=598.1,73.7,418.2,0.202           
,0.045,-2.455,6.7 . When using

gdalwarp Investigation_tile_alignment/ClippedProject.tif out.tif -overwrite -
t_srs EPSG:4326 --debug on

I see locally that BETA2007.gsb is used. This is not so bad, but a bit 
unexpected since I'd thought that forced TOWGS84 would have take the 
precedence.

Checking further in ogrct.cpp, I see that as the GeoTIFF has also the EPSG:
31468 code, and when instanciating the PROJ coordinate transformation, this is 
the preferred initializer, and thus the hardcoded TOWGS84 is ignored. So this 
explains what I observe. I'm not completely clear of what would be the desired 
behaviour here. In some use cases, one might prefer to honour the possibly 
suboptimal TOWGS84 from the geotiff info (the simple fact of doing 
gdal_translate -a_srs EPSG:31468 hardcodes it. Even with GDAL 3, which is 
probably no longer a good idea...). In other cases, just trust PROJ to use the 
best transformation method.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gregory.bataille at gmail.com  Fri Nov  8 03:36:50 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Fri, 8 Nov 2019 12:36:50 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <4469243.TJ2OctFfXH@even-i700>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <4469243.TJ2OctFfXH@even-i700>
Message-ID: <CACVcCzqU5quwMhHKdhZjYUk=L_2CFd5Y-QGBXug1vE_sBkgGhg@mail.gmail.com>

That’s a problem for us. With gdal 3 we started to force values for the
towgs84 so that proj would not decide.
This is wanted because our front end will place markers and it does
coordinates transform. Without access to proj 6. Meaning it needs to have
the transform Value.

I’ll check what you mentioned (on Monday though I think)

Thanks for having a look

Greg

On Fri, 8 Nov 2019 at 12:30, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 8 novembre 2019 08:18:11 CET Grégory Bataille wrote:
> > Hey all,
> >
> > So I have a strange issue that I somewhat isolated, but I don't know how
> to
> > move further.
> > I have dataset in EPSG 31468-15949
>
> I would check if that wouldn't be related to availability of the
> BETA2007.gsb
> grid. osgeo/gdal:alpine-normal-3.0.2 has it. Does your MAC install have it
> ?
>
> That said, your TIFF file has a hardcoded TOWGS84=598.1,73.7,418.2,0.202
>
> ,0.045,-2.455,6.7 . When using
>
> gdalwarp Investigation_tile_alignment/ClippedProject.tif out.tif
> -overwrite -
> t_srs EPSG:4326 --debug on
>
> I see locally that BETA2007.gsb is used. This is not so bad, but a bit
> unexpected since I'd thought that forced TOWGS84 would have take the
> precedence.
>
> Checking further in ogrct.cpp, I see that as the GeoTIFF has also the EPSG:
> 31468 code, and when instanciating the PROJ coordinate transformation,
> this is
> the preferred initializer, and thus the hardcoded TOWGS84 is ignored. So
> this
> explains what I observe. I'm not completely clear of what would be the
> desired
> behaviour here. In some use cases, one might prefer to honour the possibly
> suboptimal TOWGS84 from the geotiff info (the simple fact of doing
> gdal_translate -a_srs EPSG:31468 hardcodes it. Even with GDAL 3, which is
> probably no longer a good idea...). In other cases, just trust PROJ to use
> the
> best transformation method.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-- 
Greg
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191108/c1c03603/attachment.html>

From ahmettemiz88 at gmail.com  Sat Nov  9 08:57:03 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Sat, 9 Nov 2019 19:57:03 +0300
Subject: [gdal-dev] extracting a raster data within a polygon?
Message-ID: <CAJKO1YuP8B8tMFzpD14JyB7b7HM4hefXeu7_MzGWz0LzVOGgGQ@mail.gmail.com>

Hi,
how I can extract a raster data within a polygon (not a rectangle) using
C++?
i.e. dem within provincial boundary
Regards
-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191109/5c85dd89/attachment.html>

From avrahami.ben at gmail.com  Sun Nov 10 03:55:55 2019
From: avrahami.ben at gmail.com (Ben Avrahami)
Date: Sun, 10 Nov 2019 13:55:55 +0200
Subject: [gdal-dev] using gdal_viewshed
Message-ID: <CALFWR8FEvuGPjGPF=hNLOXFFHjX8pdUEysNUsQmqExjAU9QhSg@mail.gmail.com>

Hello all, I've been trying trying to use the newest gdal_viewshed in
gdal-dev release, and I've run into an error I can't quite understand.

The input I've been using is:

    gdal_viewshed -md 1000 -ox "691868.511" -oy "3492031.487" <input tiff>
<output tiff>

And I get the response:

    ERROR 5: C:\temp\files\out.tif, band 1: Access window out of range in
RasterIO().  Requested
    (0,-1) of size 67x1 on raster of 67x67.
    ERROR 1: RasterIO error when writing target raster

I get a similar error if I try to use the GDALViewshedGenerate C-API
function. The input us a valid WGS84-UTM tiff file, and the output is a
valid path, but the file does not actually exist until I run the command.
After I run the command, the output file is created but only filled
halfway. Any help at wall would be appreciated.

regards, Ben
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191110/98cea031/attachment.html>

From paul.malm at lfv.se  Sun Nov 10 23:28:46 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Mon, 11 Nov 2019 07:28:46 +0000
Subject: [gdal-dev] ogr2ogr PDF
Message-ID: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>

Hi list,
I have a question on how to export a PDF file from PostGIS with a color on the lines instead of the default black lines. I have searched on the internet but have not reached all the way...
I have 2 tables that I would like to export into test.pdf (rivers and roads)
ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy dbname=testdb password=pwd" rivers roads

I would, for instance set like to set line width to 1 px and color to 4040FF on rivers,
Width 3 px and color FF4040 on roads.

Thanks,
Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/37da4aa3/attachment.html>

From a.neumann at carto.net  Sun Nov 10 23:34:52 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Nov 2019 08:34:52 +0100
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
Message-ID: <4fd18be65df5fd125e2931980b6df398@carto.net>

Hi Paul, 

ogr2ogr usually doesn't care much about styling, unless you use ogr
feature styles: 

https://svn.osgeo.org/gdal/trunk/gdal/ogr/ogr_feature_style.html 

Or you use QGIS 3.10* which has a nice GeoPDF export built in. But if
you want to automate things, I understand that the automated solution
might be better for your workflow. 

*Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6,
which as far as I know is currently not the case for QGIS Windows
standalone builds. See also
https://gis.stackexchange.com/questions/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10


Greetings, 

Andreas 

On 2019-11-11 08:28, paul.malm at lfv.se wrote:

>> 

> Hi list, 
> 
> I have a question on how to export a PDF file from PostGIS with a color on the lines instead of the default black lines. I have searched on the internet but have not reached all the way… 
> 
> I have 2 tables that I would like to export into test.pdf (rivers and roads) 
> 
> ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy dbname=testdb password=pwd" rivers roads 
> 
> I would, for instance set like to set line width to 1 px and color to 4040FF on rivers, 
> 
> Width 3 px and color FF4040 on roads. 
> 
> Thanks, 
> 
> Paul 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/7fcead42/attachment.html>

From paul.malm at lfv.se  Sun Nov 10 23:45:31 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Mon, 11 Nov 2019 07:45:31 +0000
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <4fd18be65df5fd125e2931980b6df398@carto.net>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE67C62@xw-exch03.lfv.se>

Thanks Andreas,
Yes, I would like to automate it. I have read the page you suggested but I don’t understand how to implement it with ogr2ogr.
Kind regards,
Paul

Från: Andreas Neumann [mailto:a.neumann at carto.net]
Skickat: den 11 november 2019 08:35
Till: Malm, Paul (Operations AIM)
Kopia: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr PDF


Hi Paul,

ogr2ogr usually doesn't care much about styling, unless you use ogr feature styles:

https://svn.osgeo.org/gdal/trunk/gdal/ogr/ogr_feature_style.html

Or you use QGIS 3.10* which has a nice GeoPDF export built in. But if you want to automate things, I understand that the automated solution might be better for your workflow.

*Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6, which as far as I know is currently not the case for QGIS Windows standalone builds. See also https://gis.stackexchange.com/questions/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10

Greetings,

Andreas

On 2019-11-11 08:28, paul.malm at lfv.se wrote:


Hi list,

I have a question on how to export a PDF file from PostGIS with a color on the lines instead of the default black lines. I have searched on the internet but have not reached all the way…

I have 2 tables that I would like to export into test.pdf (rivers and roads)

ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy dbname=testdb password=pwd" rivers roads



I would, for instance set like to set line width to 1 px and color to 4040FF on rivers,

Width 3 px and color FF4040 on roads.



Thanks,

Paul

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/209e3c04/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 11 00:12:34 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 11 Nov 2019 01:12:34 -0700 (MST)
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
Message-ID: <1573459954797-0.post@n6.nabble.com>

Hi,

You must add a field named "ogr_style" into your PostGIS table and fill it
with the style definition strings. You can see some examples in
http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf.

In simple cases as you may have it can be easier to add the styles
on-the-fly with a SQL query instead of saving them into the database

SELECT geometry, attribute, 'PEN(c:#FF0000,w:5px)' AS OGR_STYLE from roads;



-Jukka Rahkonen-



paul.malm wrote
> Hi list,
> I have a question on how to export a PDF file from PostGIS with a color on
> the lines instead of the default black lines. I have searched on the
> internet but have not reached all the way...
> I have 2 tables that I would like to export into test.pdf (rivers and
> roads)
> ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy
> dbname=testdb password=pwd" rivers roads
> 
> I would, for instance set like to set line width to 1 px and color to
> 4040FF on rivers,
> Width 3 px and color FF4040 on roads.
> 
> Thanks,
> Paul
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From a.neumann at carto.net  Mon Nov 11 00:13:23 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Mon, 11 Nov 2019 09:13:23 +0100
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE67C62@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <785199B14156764C8EB14EF96CEDC44EE67C62@xw-exch03.lfv.se>
Message-ID: <19b2ca3603d099e1a6694f8109901dc8@carto.net>

Hi Paul, 

As usual, there are several ways: 

1. You can either create a new attribute called "OGR_STYLE" (see section
2.8 in the spec) that contains the style definition (see chapter 2 in
the spec) 

2. or you create an external .ofs (OGR feature style side-file) as
described in section 2.7 of the spec 

3. or you use the OGR support Classes as described in chapter 3 of the
spec. 

All information is in the spec, incl. some examples. 

I would probably use options 1 or 2 in your case. Option one can be done
in an SQL-Select query, where you create the OGR_STYLE attribute on the
fly with your query. 

Greetings, 

Andreas 

On 2019-11-11 08:45, paul.malm at lfv.se wrote:

>> 

> Thanks Andreas, 
> 
> Yes, I would like to automate it. I have read the page you suggested but I don't understand how to implement it with ogr2ogr. 
> 
> Kind regards, 
> 
> Paul 
> 
> Från: Andreas Neumann [mailto:a.neumann at carto.net] 
> Skickat: den 11 november 2019 08:35
> Till: Malm, Paul (Operations AIM)
> Kopia: gdal-dev at lists.osgeo.org
> Ämne: Re: [gdal-dev] ogr2ogr PDF 
> 
> Hi Paul, 
> 
> ogr2ogr usually doesn't care much about styling, unless you use ogr feature styles: 
> 
> https://svn.osgeo.org/gdal/trunk/gdal/ogr/ogr_feature_style.html 
> 
> Or you use QGIS 3.10* which has a nice GeoPDF export built in. But if you want to automate things, I understand that the automated solution might be better for your workflow. 
> 
> *Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6, which as far as I know is currently not the case for QGIS Windows standalone builds. See also https://gis.stackexchange.com/questions/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10 
> 
> Greetings, 
> 
> Andreas 
> 
> On 2019-11-11 08:28, paul.malm at lfv.se wrote:

> Hi list, 
> 
> I have a question on how to export a PDF file from PostGIS with a color on the lines instead of the default black lines. I have searched on the internet but have not reached all the way... 
> 
> I have 2 tables that I would like to export into test.pdf (rivers and roads) 
> 
> ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy dbname=testdb password=pwd" rivers roads 
> 
> I would, for instance set like to set line width to 1 px and color to 4040FF on rivers, 
> 
> Width 3 px and color FF4040 on roads. 
> 
> Thanks, 
> 
> Paul 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/1cc357a4/attachment.html>

From paul.malm at lfv.se  Mon Nov 11 00:33:54 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Mon, 11 Nov 2019 08:33:54 +0000
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <1573459954797-0.post@n6.nabble.com>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <1573459954797-0.post@n6.nabble.com>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE67D3D@xw-exch03.lfv.se>

Thanks Andreas and Jukka!! 
-Gurus!
/Paul

-----Ursprungligt meddelande-----
Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För jratike80
Skickat: den 11 november 2019 09:13
Till: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr PDF

Hi,

You must add a field named "ogr_style" into your PostGIS table and fill it
with the style definition strings. You can see some examples in
http://latuviitta.org/documents/Geospatial_PDF_maps_from_OSM_with_GDAL.pdf.

In simple cases as you may have it can be easier to add the styles
on-the-fly with a SQL query instead of saving them into the database

SELECT geometry, attribute, 'PEN(c:#FF0000,w:5px)' AS OGR_STYLE from roads;



-Jukka Rahkonen-



paul.malm wrote
> Hi list,
> I have a question on how to export a PDF file from PostGIS with a color on
> the lines instead of the default black lines. I have searched on the
> internet but have not reached all the way...
> I have 2 tables that I would like to export into test.pdf (rivers and
> roads)
> ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy
> dbname=testdb password=pwd" rivers roads
> 
> I would, for instance set like to set line width to 1 px and color to
> 4040FF on rivers,
> Width 3 px and color FF4040 on roads.
> 
> Thanks,
> Paul
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 11 03:49:49 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 11 Nov 2019 04:49:49 -0700 (MST)
Subject: [gdal-dev] Open option for vectors in the cloud
In-Reply-To: <CANhDX=bB7f0r8FeQ+QmV2AbVBbdBtvcwPT2_++a9k2Wu8TBpHA@mail.gmail.com>
References: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
 <2524372.SVzQUXFDd3@even-i700>
 <CANhDX=bA+VMot_MZUTy7RNOfvTG=xTtMXx+WwNGQHwE=cwpybg@mail.gmail.com>
 <CANhDX=bB7f0r8FeQ+QmV2AbVBbdBtvcwPT2_++a9k2Wu8TBpHA@mail.gmail.com>
Message-ID: <1573472989754-0.post@n6.nabble.com>

Hi Björn,

Much faster now. The version that I used for testing includes
https://github.com/OSGeo/gdal/pull/1993.
The amount of http range requests is already rather low even when quory
returns lots of features but perhaps you could do even better by combining
ranges when possible. These three requests could be just one
855965696-856080383

VSICURL: Downloading 855965696-855982079
(http://localhost:8060/flatroad.fgb)...
VSICURL: Got response_code=206
VSICURL: Downloading 855982080-856014847
(http://localhost:8060/flatroad.fgb)...
VSICURL: Got response_code=206
VSICURL: Downloading 856014848-856080383
(http://localhost:8060/flatroad.fgb)...
VSICURL: Got response_code=206

-Jukka Rahkonen-



Björn Harrtell wrote
> Improvements have hit master. I suspect there are some remaining
> bottlenecks though, but I currently lack the tests/means to investigate
> further in short term and will appreciate feedback.





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Nov 11 05:02:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Nov 2019 14:02:17 +0100
Subject: [gdal-dev] Open option for vectors in the cloud
In-Reply-To: <1573472989754-0.post@n6.nabble.com>
References: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
 <CANhDX=bB7f0r8FeQ+QmV2AbVBbdBtvcwPT2_++a9k2Wu8TBpHA@mail.gmail.com>
 <1573472989754-0.post@n6.nabble.com>
Message-ID: <1989281.eDo3UNZF15@even-i700>

On lundi 11 novembre 2019 04:49:49 CET jratike80 wrote:
> rns lots of features but perhaps you could do even better by combining
> ranges when possible. 

I suspect those requests come from sequential reading of features. /vsicurl/ 
reads by chunks of 16 KB, and when it detects a sequential reading pattern it 
multiplies the chunk size by 2 until a limit of 1.6 MB.
The 3 ranges you mention are respectively 16, 32 and 64 KB and show that x2 
pattern. There is probably not much more that can be done because the driver 
cannot know how many features are going to be read in advance. Or that would 
imply a more aggressive exponential strategy in /vsicurl/, but that could have 
undesirable effects in other scenarios.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ahmettemiz88 at gmail.com  Mon Nov 11 06:07:28 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Mon, 11 Nov 2019 17:07:28 +0300
Subject: [gdal-dev] angle of crossing two lines
Message-ID: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>

Hi,
I need to know angle of crossing two lines.
which function can I use?

regards

-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/01e530e0/attachment-0001.html>

From even.rouault at spatialys.com  Mon Nov 11 06:21:40 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Nov 2019 15:21:40 +0100
Subject: [gdal-dev] Call for discussion on RFC76 OGR Python drivers
In-Reply-To: <CABUeae-v3BhpDz73gfeD5xFcoBOW6-VKwhdnhDKuPu9nt3-yKQ@mail.gmail.com>
References: <2095931.f4rNuYMrQC@even-i700>
 <CABUeae-v3BhpDz73gfeD5xFcoBOW6-VKwhdnhDKuPu9nt3-yKQ@mail.gmail.com>
Message-ID: <7725698.LI7Ja4uRFH@even-i700>

On mercredi 6 novembre 2019 00:02:52 CET Mateusz Loskot wrote:
> On Tue, 5 Nov 2019 at 12:06, Even Rouault <even.rouault at spatialys.com> wrote:
> > This is a topic we already discussed a couple years ago. Please find a RFC
> > about it in:
> > 
> > https://github.com/OSGeo/gdal/pull/1984/files
> 
> I dropped some comments there, not a review though.

I've updated both the RFC and the implementation (number of changes since the
preliminary one) to what I believe should be close to their final states.

In addition to the rather dummy example of a Python driver that is in the RFC,
there are 2 more interesting examples:

* a PASSTHROUGH driver that forwards calls to the GDAL SWIG Python API:
  https://github.com/rouault/gdal/blob/pythondrivers/gdal/examples/pydrivers/ogr_PASSTHROUGH.py

* a driver implemented a simple parsing of CityJSON (https://www.cityjson.org/)
  https://github.com/rouault/gdal/blob/pythondrivers/gdal/examples/pydrivers/ogr_CityJSON.py

The tutorialshould also help:
https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials/vector_python_driver.rst

I'll submit the RFC to vote soon if there are no other remarks.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew.bell.ia at gmail.com  Mon Nov 11 06:35:27 2019
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Mon, 11 Nov 2019 09:35:27 -0500
Subject: [gdal-dev] angle of crossing two lines
In-Reply-To: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>
References: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>
Message-ID: <CACJ51z2sJKfjWOgbS0Ha09a1hTpGEAxfsJmr0QkgR75TSySWhQ@mail.gmail.com>

Dot product

On Mon, Nov 11, 2019, 09:07 Ahmet Temiz <ahmettemiz88 at gmail.com> wrote:

> Hi,
> I need to know angle of crossing two lines.
> which function can I use?
>
> regards
>
> --
> Ahmet Temiz
> Jeoloji Müh.
> Afet ve Acil Durum Yönetimi Başkanlığı
> Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/ff774688/attachment.html>

From jluis at ualg.pt  Mon Nov 11 08:14:34 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 11 Nov 2019 16:14:34 +0000
Subject: [gdal-dev] gdalbuildvrt issues
Message-ID: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>

Hi,

I'm facing strange things when using gdalbuildvrt. First, with my own build (GDAL master) I can't use wild cards (Windows here)

$ gdalbuildvrt --version
GDAL 3.1.0dev, released 2019/99/99

j at MARILU C:\SIG_AnaliseDadosSatelite\SIG_ADS\DadosEx2\LC82040332015145LGN00
$ gdalbuildvrt lixo.vrt *.TIF
0...10...20...30...40...50...60...70...80...90...100 - done.
ERROR 4: `*.TIF' does not exist in the file system, and is not recognized as a supported dataset name.
Warning 1: Can't open *.TIF. Skipping it

But with an OSGeo4W build the command works fine

C:\SIG_AnaliseDadosSatelite\SIG_ADS\DadosEx2\LC82040332015145LGN00>gdalbuildvrt --version
GDAL 2.4.1, released 2019/03/15

C:\SIG_AnaliseDadosSatelite\SIG_ADS\DadosEx2\LC82040332015145LGN00>gdalbuildvrt lixo.vrt *.TIF
0...10...20...30...40...50...60...70...80...90...100 - done.

But is not the worst. The worst is that when I look into the VRT file I see this. Notice how the SrcRect and DstRect differ. Why is that?

    <SimpleSource>
      <SourceFilename relativeToVRT="1">LC82040332015145LGN00_B1.TIF</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="7731" RasterYSize="7871" DataType="UInt16" BlockXSize="7731" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="7731" ySize="7871" />
      <DstRect xOff="0" yOff="0" xSize="8067.13043478261" ySize="8213.21739130435" />
    </SimpleSource>

However, if I build the vrt by explicitly listing the files, then all seems fine. Also with the master branch build

$ gdalbuildvrt lixo.vrt LC82040332015145LGN00_B1.TIF LC82040332015145LGN00_B2.TIF
0...10...20...30...40...50...60...70...80...90...100 - done.

    <SimpleSource>
      <SourceFilename relativeToVRT="1">LC82040332015145LGN00_B1.TIF</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="7731" RasterYSize="7871" DataType="UInt16" BlockXSize="7731" BlockYSize="1" />
      <SrcRect xOff="0" yOff="0" xSize="7731" ySize="7871" />
      <DstRect xOff="0" yOff="0" xSize="7731" ySize="7871" />
    </SimpleSource>


Joaquim
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/d42cbb97/attachment.html>

From even.rouault at spatialys.com  Mon Nov 11 08:27:31 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Nov 2019 17:27:31 +0100
Subject: [gdal-dev] gdalbuildvrt issues
In-Reply-To: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <4780701.UKgYiWQv6H@even-i700>

On lundi 11 novembre 2019 16:14:34 CET Joaquim Manuel Freire Luís wrote:
> Hi,
> 
> I'm facing strange things when using gdalbuildvrt. First, with my own build
> (GDAL master) I can't use wild cards (Windows here)

You probably need to define the following in your nmake.local:

# To be enabled defined to point to wsetargv.obj from the Visual C++ 
directory,
# when you want the utility programs to be able to expand wildcards. 
#SETARGV =      "D:\Software\VStudio\VC98\lib\wsetargv.obj"

Note: regular setargv.obj might also work.

> But is not the worst. The worst is that when I look into the VRT file I see
> this. Notice how the SrcRect and DstRect differ. Why is that?

I suspect you're mosaicing files of different resolutions.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Nov 11 08:36:44 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 11 Nov 2019 16:36:44 +0000
Subject: [gdal-dev] gdalbuildvrt issues
In-Reply-To: <4780701.UKgYiWQv6H@even-i700>
References: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <4780701.UKgYiWQv6H@even-i700>
Message-ID: <DB8PR04MB669716B66E903E12CC1CCEE3A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>


You probably need to define the following in your nmake.local:

># To be enabled defined to point to wsetargv.obj from the Visual C++ directory, # when you want >the utility programs to be able to expand wildcards. 
>#SETARGV =      "D:\Software\VStudio\VC98\lib\wsetargv.obj"

>Note: regular setargv.obj might also work.

Thanks. After writing the mail I remembered that we also used to have something like that in the old GMT building (pre CMake)


>> But is not the worst. The worst is that when I look into the VRT file 
>> I see this. Notice how the SrcRect and DstRect differ. Why is that?

> I suspect you're mosaicing files of different resolutions.

Yes, also found that (after). It's the panchromatic band 8 of the LandSat8 set, which has double resolution. But in this case, shouldn't the -separate option make a difference? But it doesn't. The result is the same either if I use it or not (confess that I don't understand the meaning of this option)

From even.rouault at spatialys.com  Mon Nov 11 08:43:43 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 11 Nov 2019 17:43:43 +0100
Subject: [gdal-dev] gdalbuildvrt issues
In-Reply-To: <DB8PR04MB669716B66E903E12CC1CCEE3A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <4780701.UKgYiWQv6H@even-i700>
 <DB8PR04MB669716B66E903E12CC1CCEE3A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <4599987.gPEdFakmEA@even-i700>

> Yes, also found that (after). It's the panchromatic band 8 of the LandSat8
> set, which has double resolution. But in this case, shouldn't the -separate
> option make a difference? But it doesn't. The result is the same either if
> I use it or not (confess that I don't understand the meaning of this
> option)

https://gdal.org/programs/gdalbuildvrt.html

"""
With -separate, each files goes into a separate band in the VRT dataset. 
Otherwise, the files are considered as tiles of a larger mosaic and the VRT 
file has as many bands as one of the input files.
"""

The -resolution flag might also help:
https://gdal.org/programs/gdalbuildvrt.html#cmdoption-gdalbuildvrt-resolution


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jluis at ualg.pt  Mon Nov 11 08:51:49 2019
From: jluis at ualg.pt (=?iso-8859-1?Q?Joaquim_Manuel_Freire_Lu=EDs?=)
Date: Mon, 11 Nov 2019 16:51:49 +0000
Subject: [gdal-dev] gdalbuildvrt issues
In-Reply-To: <4599987.gPEdFakmEA@even-i700>
References: <DB8PR04MB669742A293A4F0E001DE7507A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <4780701.UKgYiWQv6H@even-i700>
 <DB8PR04MB669716B66E903E12CC1CCEE3A6740@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <4599987.gPEdFakmEA@even-i700>
Message-ID: <DB8PR04MB66973B69BA583287735BFBDEA6740@DB8PR04MB6697.eurprd04.prod.outlook.com>

"""
With -separate, each files goes into a separate band in the VRT dataset. 
Otherwise, the files are considered as tiles of a larger mosaic and the VRT file has as many bands as one of the input files.
"""

I guess it's this bit " Otherwise, the files are considered as tiles of a larger mosaic..." that confuses me. I see it as "if they are not a mosaic, then each one would keep its own resolution"

The -resolution flag might also help:
https://gdal.org/programs/gdalbuildvrt.html#cmdoption-gdalbuildvrt-resolution

Indeed, "-resolution lowest" is what I want here.

Thanks

From hellik at web.de  Mon Nov 11 09:18:47 2019
From: hellik at web.de (Helmut Kudrnovsky)
Date: Mon, 11 Nov 2019 10:18:47 -0700 (MST)
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <4fd18be65df5fd125e2931980b6df398@carto.net>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
Message-ID: <1573492727131-0.post@n6.nabble.com>

>*Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6, which as
far as I know is currently >not the case for QGIS Windows standalone builds.
See also https://gis.stackexchange.com/questions
>/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10

OSGeoW switched today to GDAL >= 3.0 as default



-----
best regards
Helmut
--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jef at norbit.de  Mon Nov 11 09:30:55 2019
From: jef at norbit.de (=?utf-8?Q?J=C3=BCrgen_E=2E?= Fischer)
Date: Mon, 11 Nov 2019 18:30:55 +0100
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <1573492727131-0.post@n6.nabble.com>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <1573492727131-0.post@n6.nabble.com>
Message-ID: <20191111173055.mum7cgqpway3bdt2@norbit.de>

On Mon, 11. Nov 2019 at 10:18:47 -0700, Helmut Kudrnovsky wrote:
> >*Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6, which as
> far as I know is currently >not the case for QGIS Windows standalone builds.
> See also https://gis.stackexchange.com/questions
> >/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10
> 
> OSGeoW switched today to GDAL >= 3.0 as default

And new QGIS standalones are out.


Jürgen

-- 
Jürgen E. Fischer           norBIT GmbH             Tel. +49-4931-918175-31
Dipl.-Inf. (FH)             Rheinstraße 13          Fax. +49-4931-918175-50
Software Engineer           D-26506 Norden            https://www.norbit.de
QGIS release manager (PSC)  Germany                    IRC: jef on FreeNode
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 827 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/9c5c8d22/attachment.sig>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Pflichtangaben
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/9c5c8d22/attachment.ksh>

From mchapman at hyperacktive.com  Mon Nov 11 14:08:58 2019
From: mchapman at hyperacktive.com (Martin Chapman)
Date: Mon, 11 Nov 2019 15:08:58 -0700
Subject: [gdal-dev] angle of crossing two lines
In-Reply-To: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>
References: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>
Message-ID: <04eb01d598dc$9e3fdc30$dabf9490$@hyperacktive.com>

Ahmet,

 

The following function will return the angle in decimal degrees given 3 points on a flat plane.  The three points create the angle.  If you have two intersecting lines then the angle of any given corner is the center point where the lines intersect and two end points of the lines that complete an angle.

 

// NOTE: the points must be fed to the function in clockwise order.  

// NOTE: the angle returned is an azimuth angle and not a trigonometric angle.  Azimuth angles start with zero at north and increase clockwise whereas trigonometric angles zero starts to the right (east) on the x axis and increase going counter clockwise.

 

const double PI = 3.1415926535897932384626433;

const double RAD2DEG = 180.0 / PI;

 

double GetAngle(const double& x1, const double& y1, const double& x2, const double& y2, const double& x3, const double& y3)

{

       double theta1 = atan2(y2 - y1, x2 - x1);

       double theta2 = atan2(y2 - y3, x2 - x3);

       double theta = (theta2 - theta1) * RAD2DEG;

       if (theta < 0) theta += 360.0;

       return theta;

}

 

// To get the intersection of two lines use:

// NOTE: returns FALSE if the lines don’t intersect

 

struct Point

{

       double x;

       double y;

};

 

struct Line

{

       Point point1;

       Point point2;

};

 

BOOL GetLineIntersection(const Line& line1, const Line& line2, double& x, double& y)

{

    double a1 = line1.point2.y - line1.point1.y;

    double b1 = line1.point1.x - line1.point2.x;

    double c1 = a1 * line1.point1.x + b1 * line1.point1.y;

    double a2 = line2.point2.y - line2.point1.y;

    double b2 = line2.point1.x - line2.point2.x;

    double c2 = a2 * line2.point1.x + b2 * line2.point1.y;

    double determinant = a1 * b2 - a2 * b1;

    if (determinant == 0) return FALSE;

 

    x = (b2 * c1 - b1 * c2) / determinant;

    y = (a1 * c2 - a2 * c1) / determinant;

 

       return TRUE;

}

 

Best regards,

Martin Chapman

 

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Ahmet Temiz
Sent: Monday, November 11, 2019 7:07 AM
To: gdal-dev
Subject: [gdal-dev] angle of crossing two lines

 

Hi,

I need to know angle of crossing two lines.

which function can I use?

 

regards

 

-- 

Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/9866fd39/attachment.html>

From sean at mapbox.com  Mon Nov 11 15:11:00 2019
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 11 Nov 2019 16:11:00 -0700
Subject: [gdal-dev] Call for discussion on RFC76 OGR Python drivers
In-Reply-To: <7725698.LI7Ja4uRFH@even-i700>
References: <2095931.f4rNuYMrQC@even-i700>
 <CABUeae-v3BhpDz73gfeD5xFcoBOW6-VKwhdnhDKuPu9nt3-yKQ@mail.gmail.com>
 <7725698.LI7Ja4uRFH@even-i700>
Message-ID: <CADPhZXyfW1vFszrvDdAgU6VB3CNY-fb7HuJj6TC5D5urjFNdhA@mail.gmail.com>

Hi Even,

On Mon, Nov 11, 2019 at 7:21 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 6 novembre 2019 00:02:52 CET Mateusz Loskot wrote:
> > On Tue, 5 Nov 2019 at 12:06, Even Rouault <even.rouault at spatialys.com>
> wrote:
> > > This is a topic we already discussed a couple years ago. Please find a
> RFC
> > > about it in:
> > >
> > > https://github.com/OSGeo/gdal/pull/1984/files
> >
> > I dropped some comments there, not a review though.
>
> I've updated both the RFC and the implementation (number of changes since
> the
> preliminary one) to what I believe should be close to their final states.
>
> In addition to the rather dummy example of a Python driver that is in the
> RFC,
> there are 2 more interesting examples:
>
> * a PASSTHROUGH driver that forwards calls to the GDAL SWIG Python API:
>
> https://github.com/rouault/gdal/blob/pythondrivers/gdal/examples/pydrivers/ogr_PASSTHROUGH.py
>
> * a driver implemented a simple parsing of CityJSON (
> https://www.cityjson.org/)
>
> https://github.com/rouault/gdal/blob/pythondrivers/gdal/examples/pydrivers/ogr_CityJSON.py
>
> The tutorialshould also help:
>
> https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials/vector_python_driver.rst
>
> I'll submit the RFC to vote soon if there are no other remarks.
>
> Even
>

On the one hand, If I were a MapServer site administrator and it was my job
to render features from some special non-standard or proprietary format or
API as a layer on my maps and all it took was one Python file copied into a
directory on my server, I think I might like this feature. I feel like
there are already too many format drivers in GDAL/OGR and anything that
keeps a driver that only a handful of people will ever use out of the core
of the library is a good thing. On the other hand, I feel like these
plugins are a complicated solution to a problem that is pretty well solved
by running a format-specific python (or other language) program that writes
a stream of GeoJSON texts.

That said I have some comments that I hope will help refine the RFC.

About
https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials/vector_python_driver.rst#driver-location,
can you expand on the distribution/installation story for these plugins?
Will there be any guidance about plugin dependencies? Will GDAL resolve and
fetch them? Should they be vendored into the plugin?

About
https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials/vector_python_driver.rst#metadata-section,
since the metadata are not likely to be used in the Python code, might they
be defined at the top of the file in a commented line?  Cython directives
are a good example:
https://cython.readthedocs.io/en/latest/src/userguide/source_files_and_compilation.html#globally
.

About the Driver interface, relying on drivers to register themselves as
the handlers for filenames (with "identify") seems to me to open the door
to conflicts and tricky bugs. Have you considered an XML (or whatever) file
in the plugin directory as a registry?

About the first bytes of the "file", what cases are you thinking of where a
developer wouldn't be able to get them in the code they write? And how many
bytes are we talking about?

About the Layer interface, I feel like instead of offering two flavors: one
based on GeoJSON and one based on the GDAL bindings, offer only one. Best
practices will emerge faster, I think.

>From what I see in the passthrough example, it looks like much of the
"magic" of these plugins is going to be undone by requirements to prefix
the connection strings with the name of the plugin driver. Is `ogrinfo
PASSTHROUGH:myfile` any improvement over `python passthrough.py myfile`?

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/2e15198f/attachment-0001.html>

From even.rouault at spatialys.com  Mon Nov 11 15:50:50 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Nov 2019 00:50:50 +0100
Subject: [gdal-dev] Call for discussion on RFC76 OGR Python drivers
In-Reply-To: <CADPhZXyfW1vFszrvDdAgU6VB3CNY-fb7HuJj6TC5D5urjFNdhA@mail.gmail.com>
References: <2095931.f4rNuYMrQC@even-i700> <7725698.LI7Ja4uRFH@even-i700>
 <CADPhZXyfW1vFszrvDdAgU6VB3CNY-fb7HuJj6TC5D5urjFNdhA@mail.gmail.com>
Message-ID: <2856611.IHEN1UA5Kp@even-i700>

Sean,

> About
> https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials
> /vector_python_driver.rst#driver-location, can you expand on the
> distribution/installation story for these plugins? Will there be any
> guidance about plugin dependencies? Will GDAL resolve and fetch them?
> Should they be vendored into the plugin?

I don't know what we could suggest. The RFC mentions " This RFC does not try 
to cover the management of Python dependencies. It is
up to the user to do the needed "pip install" or whatever Python package
management solution it uses."
GDAL will not do anything more than importing the module and running it, so 
the rules of the current environment will apply for any import directives in 
the .py file loaded by GDAL.
I can add that to the tutorial, or some better formulation that you may 
propose, if that helps ?

> 
> About
> https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials
> /vector_python_driver.rst#metadata-section, since the metadata are not
> likely to be used in the Python code, might they be defined at the top of
> the file in a commented line?  Cython directives are a good example:
> https://cython.readthedocs.io/en/latest/src/userguide/source_files_and_compi
> lation.html#globally .

Something like ?

# gdal: DRIVER_NAME = "BLA"

Why not

> 
> About the Driver interface, relying on drivers to register themselves as
> the handlers for filenames (with "identify") seems to me to open the door
> to conflicts and tricky bugs. Have you considered an XML (or whatever) file
> in the plugin directory as a registry?

I just replicate how a native driver works. The identify method can do 
whatever it wants to tell if a file is recognized by it or not (or if it 
cannot tell). It can look only at the extension, at the filename, at the 
content of the first bytes, or a combination of the above. This seems 
difficult to express in a non-programatic way. Although that's an idea I've 
had for a long time if we wanted to have less native drivers in the core lib 
and more .so that we would only load when they are needed. But that's out of 
scope for this work.

> 
> About the first bytes of the "file", what cases are you thinking of where a
> developer wouldn't be able to get them in the code they write? And how many
> bytes are we talking about?

This is just a matter of efficiency given the big number of drivers that GDAL 
has. If each driver had to open & close the file (particularly if they are on 
a network or some other slow /vsi) to be able to tell how if they recognize 
the file, that could be quite lengthy for the driver in the bottom of the 
list. So the GDALOpenInfo class opens the file and ingest the first 1024 
bytes. Some drivers might request more if that's not sufficient (but that API 
is not exposed to Python drivers). I'll had a note about 1024 being the 
minimum (but some drivers which might have run before might have increased it)

> 
> About the Layer interface, I feel like instead of offering two flavors: one
> based on GeoJSON and one based on the GDAL bindings, offer only one. Best
> practices will emerge faster, I think.

The one based on the GDAL bindings map on the capabilities of the GDAL data 
model, that have in addition to GeoJSON: style string, multiple geometry 
fields and geometry types not supported by GeoJSON. I thought that offering 
GeoJSON could make life simpler for some use cases. If I keep just one, then I 
should likely remove GeoJSON as it is less capable ?

> From what I see in the passthrough example, it looks like much of the
> "magic" of these plugins is going to be undone by requirements to prefix
> the connection strings with the name of the plugin driver. Is `ogrinfo
> PASSTHROUGH:myfile` any improvement over `python passthrough.py myfile`?

Ah, it is just an artificial example to demonstrate the full use of the API. 
The CityJSON one is more real world and doesn't require a connection string

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From shanasta.daisy at gmail.com  Mon Nov 11 17:30:52 2019
From: shanasta.daisy at gmail.com (Shanasta Daisy)
Date: Mon, 11 Nov 2019 20:30:52 -0500
Subject: [gdal-dev] Calculating elevation angles from RPCs in NITF files
Message-ID: <CAMy2KtFfFP45qA59-e-9Oft5XYj7LgYG5X6JgYjvCa7x5HYB6w@mail.gmail.com>

Hello!

Given a NITF, the RPCs in the NITF, and the center pixel coordinates of the
image, I am trying to determine the elevation angle (center ground point to
satellite). From what I understand, this can be achieved by calculating the
ground point of the image center and another point on the vector looking
towards the satellite by adding a height to the ellipsoid (hae in ECEF
coordinates). So I thought I could use gdal for that:

To get the ground centerpoint in ECEF coordinates (Point B):
gdaltransform -t_srs EPSG:4978 -rpc -to rpc_height=0 test.nitf
1024 1024  (center pixel, Point S)

To get another point on vector looking towards the satellite in ECEF
coordinates (Point A):
gdaltransform -t_srs EPSG:4978 -rpc -to rpc_height=10 test.nitf
1024 1024  (center pixel, Point S)

[image: image.png]

The two points determine the vector, then convert to ENU coordinates and
the angle is calculated (using some test data, these things appear to
work). While the values I'm getting from gdal are different for the
additional height, it is giving results I neither expected nor understand
and always result in extremely low angles - so either my logic is incorrect
or I am misunderstanding how the RPC stuff in gdal works.

Does anyone have any insights?

I appreciate any help!

Thanks and have a nice day!

Charity
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/59b3d38c/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 40404 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191111/59b3d38c/attachment-0001.png>

From clemens.rudert at posteo.de  Mon Nov 11 23:01:58 2019
From: clemens.rudert at posteo.de (Clemens Rudert)
Date: Tue, 12 Nov 2019 08:01:58 +0100
Subject: [gdal-dev] GDAL/OGR curve stroking dfMaxAngleStepSizeDegrees
In-Reply-To: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>
References: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>
Message-ID: <ADFCEDE7-ADFB-4032-BC36-E8CF85A9A262@posteo.de>

Hello

Still I look for this default value. I was not able to find it. Since Iam not a pro C programmer I would be really happy if someone could help out here.

Cheers
Clemens

> Am 07.11.2019 um 11:50 schrieb Clemens Rudert <clemens.rudert at posteo.de>:
> 
> ﻿Hi folks
> 
> 
> Iam interested in the default value for parameter dfMaxAngleStepSizeDegrees for stroking curved polygons. The OGR docs https://gdal.org/doxygen/classOGRPolygon.html#a7e5a3f9a67e18e045167832c5b8ff850 say only that there is some default value used if parameter 0 is passed. Does anybody has an idea where to find this default value?
> 
> 
> Regards
> 
> Clemens
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Tue Nov 12 03:37:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Nov 2019 12:37:00 +0100
Subject: [gdal-dev] GDAL/OGR curve stroking dfMaxAngleStepSizeDegrees
In-Reply-To: <ADFCEDE7-ADFB-4032-BC36-E8CF85A9A262@posteo.de>
References: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>
 <ADFCEDE7-ADFB-4032-BC36-E8CF85A9A262@posteo.de>
Message-ID: <1786678.Xd82m4vSAZ@even-i700>

On mardi 12 novembre 2019 08:01:58 CET Clemens Rudert wrote:
> Hello
> 
> Still I look for this default value. I was not able to find it. Since Iam
> not a pro C programmer I would be really happy if someone could help out
> here.

The answer was actually in the doc of OGR_G_ApproximateArcAngles():
https://gdal.org/doxygen/ogr__api_8h.html#a87f8bce40c82b3513e36109ea051dff2
"""
If the dfMaxAngleStepSizeDegrees is zero, then a default value will be used. 
This is currently 4 degrees unless the user has overridden the value with the 
OGR_ARC_STEPSIZE configuration variable.
"""


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ahmettemiz88 at gmail.com  Tue Nov 12 03:57:36 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Tue, 12 Nov 2019 14:57:36 +0300
Subject: [gdal-dev] angle of crossing two lines
In-Reply-To: <04eb01d598dc$9e3fdc30$dabf9490$@hyperacktive.com>
References: <CAJKO1YviBD_D8iY1kZoX0ODmkxu4KewfPXaN+WwOL1AWjRYRSg@mail.gmail.com>
 <04eb01d598dc$9e3fdc30$dabf9490$@hyperacktive.com>
Message-ID: <CAJKO1Ys6y_3i-6zyDbUCEyjtyHAhRwgFPdc=GVsmH94HZanRcQ@mail.gmail.com>

Thanks a lot. It is greatly appreciated

On Tue, Nov 12, 2019 at 1:09 AM Martin Chapman <mchapman at hyperacktive.com>
wrote:

> Ahmet,
>
>
>
> The following function will return the angle in decimal degrees given 3
> points on a flat plane.  The three points create the angle.  If you have
> two intersecting lines then the angle of any given corner is the center
> point where the lines intersect and two end points of the lines that
> complete an angle.
>
>
>
> *// NOTE: the points must be fed to the function in clockwise order.  *
>
> *// NOTE: the angle returned is an azimuth angle and not a trigonometric
> angle.  Azimuth angles start with zero at north and increase clockwise
> whereas trigonometric angles zero starts to the right (east) on the x axis
> and increase going counter clockwise.*
>
>
>
> const double PI = 3.1415926535897932384626433;
>
> const double RAD2DEG = 180.0 / PI;
>
>
>
> double GetAngle(const double& x1, const double& y1, const double& x2,
> const double& y2, const double& x3, const double& y3)
>
> {
>
>        double theta1 = atan2(y2 - y1, x2 - x1);
>
>        double theta2 = atan2(y2 - y3, x2 - x3);
>
>        double theta = (theta2 - theta1) * RAD2DEG;
>
>        if (theta < 0) theta += 360.0;
>
>        return theta;
>
> }
>
>
>
> *// To get the intersection of two lines use:*
>
> *// NOTE: returns FALSE if the lines don’t intersect*
>
>
>
> struct Point
>
> {
>
>        double x;
>
>        double y;
>
> };
>
>
>
> struct Line
>
> {
>
>        Point point1;
>
>        Point point2;
>
> };
>
>
>
> BOOL GetLineIntersection(const Line& line1, const Line& line2, double& x,
> double& y)
>
> {
>
>     double a1 = line1.point2.y - line1.point1.y;
>
>     double b1 = line1.point1.x - line1.point2.x;
>
>     double c1 = a1 * line1.point1.x + b1 * line1.point1.y;
>
>     double a2 = line2.point2.y - line2.point1.y;
>
>     double b2 = line2.point1.x - line2.point2.x;
>
>     double c2 = a2 * line2.point1.x + b2 * line2.point1.y;
>
>     double determinant = a1 * b2 - a2 * b1;
>
>     if (determinant == 0) return FALSE;
>
>
>
>     x = (b2 * c1 - b1 * c2) / determinant;
>
>     y = (a1 * c2 - a2 * c1) / determinant;
>
>
>
>        return TRUE;
>
> }
>
>
>
> Best regards,
>
> Martin Chapman
>
>
>
> *From:* gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] *On Behalf Of *Ahmet
> Temiz
> *Sent:* Monday, November 11, 2019 7:07 AM
> *To:* gdal-dev
> *Subject:* [gdal-dev] angle of crossing two lines
>
>
>
> Hi,
>
> I need to know angle of crossing two lines.
>
> which function can I use?
>
>
>
> regards
>
>
>
> --
>
> Ahmet Temiz
> Jeoloji Müh.
> Afet ve Acil Durum Yönetimi Başkanlığı
> Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
>


-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191112/9e069419/attachment.html>

From scott at agi.com  Tue Nov 12 04:49:44 2019
From: scott at agi.com (agisar)
Date: Tue, 12 Nov 2019 05:49:44 -0700 (MST)
Subject: [gdal-dev] GDAL/OGR curve stroking dfMaxAngleStepSizeDegrees
In-Reply-To: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>
References: <c9ee8899-2bbc-8baf-c27b-03ff79214969@posteo.de>
Message-ID: <1573562984710-0.post@n6.nabble.com>

It looks like the answer is "4 degrees unless the user has overridden the
value with the OGR_ARC_STEPSIZE configuration variable", as found in
gdal-3.0.2/ogr/ogrgeometryfactory.cpp:3884.

Hope that helps.
Scott



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gerardg at gmail.com  Tue Nov 12 11:04:53 2019
From: gerardg at gmail.com (Gerard)
Date: Tue, 12 Nov 2019 12:04:53 -0700
Subject: [gdal-dev] GPX metadata records?
Message-ID: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>

Hello,

Is there a way to list records from the <metadata> block in GPX files (such
as "author")? I've tried various combinations of options to ogrinfo, with
no success. I can only seem to list various layers (tracks, track_points,
etc.)

https://www.topografix.com/GPX/1/1/

<gpx>
  <metadata>
    <name> xsd:string </name>
    <desc> xsd:string </desc>
    <author> personType </author>
    <copyright> copyrightType </copyright>
    <link> linkType </link>
    <time> xsd:dateTime </time>
    <keywords> xsd:string </keywords>
    <bounds> boundsType </bounds>
    <extensions> extensionsType </extensions>
  </metadata>

  <trk>
      ...
  </trk>
</gpx>

Thanks,
Gerard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191112/04ec889c/attachment-0001.html>

From even.rouault at spatialys.com  Tue Nov 12 11:24:02 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 Nov 2019 20:24:02 +0100
Subject: [gdal-dev] GPX metadata records?
In-Reply-To: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
References: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
Message-ID: <3224892.EWMLNp5Bio@even-i700>

On mardi 12 novembre 2019 12:04:53 CET Gerard wrote:
> Hello,
> 
> Is there a way to list records from the <metadata> block in GPX files (such
> as "author")? I've tried various combinations of options to ogrinfo, with
> no success. I can only seem to list various layers (tracks, track_points,
> etc.)

No, this is not handled currently by the driver. I imagine that could be 
reported as dataset metadata if that were to be implemented.

That said, you can get it if you request the 'gpx' layer with the GMLAS driver 
(which as not indicated by its name can deal with any XML data that comes with 
a XML schema)

$ ogrinfo GMLAS:out.gpx gpx

INFO: Open of `GMLAS:out.gpx'
      using driver `GMLAS' successful.

Layer name: gpx
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
ogr_pkid: String (0.0) NOT NULL
version: String (0.0) NOT NULL DEFAULT '1.1'
creator: String (0.0) NOT NULL
metadata_name: String (0.0)
metadata_desc: String (0.0)
metadata_author_name: String (0.0)
metadata_author_email_id: String (0.0)
metadata_author_email_domain: String (0.0)
metadata_author_link_href: String (0.0)
metadata_author_link_text: String (0.0)
metadata_author_link_type: String (0.0)
metadata_copyright_author: String (0.0)
metadata_copyright_year: Integer (0.0)
metadata_copyright_license: String (0.0)
metadata_time: DateTime (0.0)
metadata_keywords: String (0.0)
metadata_bounds_minlat: Real (0.0)
metadata_bounds_minlon: Real (0.0)
metadata_bounds_maxlat: Real (0.0)
metadata_bounds_maxlon: Real (0.0)
metadata_extensions: String (0.0)
extensions: String (0.0)
OGRFeature(gpx):1
  ogr_pkid (String) = B92FB579C2748DDC57A1F15E41EBDBC3_gpx_1
  version (String) = 1.1
  creator (String) = GDAL 3.1.0dev-dacda90-dirty
  metadata_author_name (String) = x


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gerardg at gmail.com  Tue Nov 12 12:50:17 2019
From: gerardg at gmail.com (Gerard)
Date: Tue, 12 Nov 2019 13:50:17 -0700
Subject: [gdal-dev] GPX metadata records?
In-Reply-To: <3224892.EWMLNp5Bio@even-i700>
References: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
 <3224892.EWMLNp5Bio@even-i700>
Message-ID: <CAKw=BhNj9S9NmG180u0wWVLjL5pho=nBBnY81L=DS0H_=Zunqw@mail.gmail.com>

Thanks! I don't think I knew that I could preface the source with DRIVER:.
Perhaps a suggestion for the documentation:

<[DRIVER:]datasource_name>

https://gdal.org/programs/ogrinfo.html

Gerard


On Tue, Nov 12, 2019 at 12:24 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 12 novembre 2019 12:04:53 CET Gerard wrote:
> > Hello,
> >
> > Is there a way to list records from the <metadata> block in GPX files
> (such
> > as "author")? I've tried various combinations of options to ogrinfo, with
> > no success. I can only seem to list various layers (tracks, track_points,
> > etc.)
>
> No, this is not handled currently by the driver. I imagine that could be
> reported as dataset metadata if that were to be implemented.
>
> That said, you can get it if you request the 'gpx' layer with the GMLAS
> driver
> (which as not indicated by its name can deal with any XML data that comes
> with
> a XML schema)
>
> $ ogrinfo GMLAS:out.gpx gpx
>
> INFO: Open of `GMLAS:out.gpx'
>       using driver `GMLAS' successful.
>
> Layer name: gpx
> Geometry: None
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> ogr_pkid: String (0.0) NOT NULL
> version: String (0.0) NOT NULL DEFAULT '1.1'
> creator: String (0.0) NOT NULL
> metadata_name: String (0.0)
> metadata_desc: String (0.0)
> metadata_author_name: String (0.0)
> metadata_author_email_id: String (0.0)
> metadata_author_email_domain: String (0.0)
> metadata_author_link_href: String (0.0)
> metadata_author_link_text: String (0.0)
> metadata_author_link_type: String (0.0)
> metadata_copyright_author: String (0.0)
> metadata_copyright_year: Integer (0.0)
> metadata_copyright_license: String (0.0)
> metadata_time: DateTime (0.0)
> metadata_keywords: String (0.0)
> metadata_bounds_minlat: Real (0.0)
> metadata_bounds_minlon: Real (0.0)
> metadata_bounds_maxlat: Real (0.0)
> metadata_bounds_maxlon: Real (0.0)
> metadata_extensions: String (0.0)
> extensions: String (0.0)
> OGRFeature(gpx):1
>   ogr_pkid (String) = B92FB579C2748DDC57A1F15E41EBDBC3_gpx_1
>   version (String) = 1.1
>   creator (String) = GDAL 3.1.0dev-dacda90-dirty
>   metadata_author_name (String) = x
>
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191112/359e2e66/attachment.html>

From eadam at co.lincoln.or.us  Tue Nov 12 13:26:20 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Tue, 12 Nov 2019 13:26:20 -0800
Subject: [gdal-dev] using gdal_viewshed
In-Reply-To: <CALFWR8FEvuGPjGPF=hNLOXFFHjX8pdUEysNUsQmqExjAU9QhSg@mail.gmail.com>
References: <CALFWR8FEvuGPjGPF=hNLOXFFHjX8pdUEysNUsQmqExjAU9QhSg@mail.gmail.com>
Message-ID: <CACqBkM8LqS29O0D5FbMzPfM7eH0S=bqkAD0iT_keGcoPQJajvg@mail.gmail.com>

Hi Ben,

On Sun, Nov 10, 2019 at 3:57 AM Ben Avrahami <avrahami.ben at gmail.com> wrote:
>
> Hello all, I've been trying trying to use the newest gdal_viewshed in gdal-dev release, and I've run into an error I can't quite understand.
>
> The input I've been using is:
>
>     gdal_viewshed -md 1000 -ox "691868.511" -oy "3492031.487" <input tiff> <output tiff>

It might be helpful to copy and paste your command so if there are
typos or otherwise, they can be spotted.

A gdalinfo report on your input file could also be helpful.  That
would show coordinates of the image and allow looking at things like
are those coordinates within the image?  Is it in the coordinate
system of the image?  A gdalinfo report details that nicely.

>
> And I get the response:
>
>     ERROR 5: C:\temp\files\out.tif, band 1: Access window out of range in RasterIO().  Requested
>     (0,-1) of size 67x1 on raster of 67x67.
>     ERROR 1: RasterIO error when writing target raster

This makes it seem like something isn't lining up correctly.  With the
absence of information some random guess include: that the coordinate
is not within the image, or perhaps the coordinate is less than -md
1000 units from the edge (although testing that on other data here
worked fine), that there are pixel alignment/resolution issues and
using coordinates not to three decimal places would work better.

I see that gdal_viewshed -md 900 -ox 985710 -oy 658590
http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
output2.tif works

and

gdal_viewshed -md 800 -ox 985710 -oy 658590
http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
output3.tif fails with the error:

0ERROR 5: output3.tif, band 1: Access window out of range in
RasterIO().  Requested
(0,-1) of size 19x1 on raster of 19x19.
ERROR 1: RasterIO error when writing target raster

it seems that -md must be a multiple of the resolution.

Best regards, Eli

>
> I get a similar error if I try to use the GDALViewshedGenerate C-API function. The input us a valid WGS84-UTM tiff file, and the output is a valid path, but the file does not actually exist until I run the command. After I run the command, the output file is created but only filled halfway. Any help at wall would be appreciated.
>
> regards, Ben
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From szekerest at gmail.com  Tue Nov 12 13:37:15 2019
From: szekerest at gmail.com (Tamas Szekeres)
Date: Tue, 12 Nov 2019 22:37:15 +0100
Subject: [gdal-dev] using gdal_viewshed
In-Reply-To: <CACqBkM8LqS29O0D5FbMzPfM7eH0S=bqkAD0iT_keGcoPQJajvg@mail.gmail.com>
References: <CALFWR8FEvuGPjGPF=hNLOXFFHjX8pdUEysNUsQmqExjAU9QhSg@mail.gmail.com>
 <CACqBkM8LqS29O0D5FbMzPfM7eH0S=bqkAD0iT_keGcoPQJajvg@mail.gmail.com>
Message-ID: <CACALY+RuA2v-KUiYk_1iQwq5DFbSoKDCPrs_J_mJ1Bg9spn_KQ@mail.gmail.com>

I've recently fixed the implementation in my local version causing a
similar issue (RasterIO error when writing target raster), where the given
maxdistance setting would produce an empty row at the top or the bottom of
the result image.
I'll prepare a fix in gdal in the next few days and let us see if that
fixes this issue as well.

Best regards,

Tamas


Eli Adam <eadam at co.lincoln.or.us> ezt írta (időpont: 2019. nov. 12., K,
22:26):

> Hi Ben,
>
> On Sun, Nov 10, 2019 at 3:57 AM Ben Avrahami <avrahami.ben at gmail.com>
> wrote:
> >
> > Hello all, I've been trying trying to use the newest gdal_viewshed in
> gdal-dev release, and I've run into an error I can't quite understand.
> >
> > The input I've been using is:
> >
> >     gdal_viewshed -md 1000 -ox "691868.511" -oy "3492031.487" <input
> tiff> <output tiff>
>
> It might be helpful to copy and paste your command so if there are
> typos or otherwise, they can be spotted.
>
> A gdalinfo report on your input file could also be helpful.  That
> would show coordinates of the image and allow looking at things like
> are those coordinates within the image?  Is it in the coordinate
> system of the image?  A gdalinfo report details that nicely.
>
> >
> > And I get the response:
> >
> >     ERROR 5: C:\temp\files\out.tif, band 1: Access window out of range
> in RasterIO().  Requested
> >     (0,-1) of size 67x1 on raster of 67x67.
> >     ERROR 1: RasterIO error when writing target raster
>
> This makes it seem like something isn't lining up correctly.  With the
> absence of information some random guess include: that the coordinate
> is not within the image, or perhaps the coordinate is less than -md
> 1000 units from the edge (although testing that on other data here
> worked fine), that there are pixel alignment/resolution issues and
> using coordinates not to three decimal places would work better.
>
> I see that gdal_viewshed -md 900 -ox 985710 -oy 658590
> http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
> output2.tif works
>
> and
>
> gdal_viewshed -md 800 -ox 985710 -oy 658590
> http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
> output3.tif fails with the error:
>
> 0ERROR 5: output3.tif, band 1: Access window out of range in
> RasterIO().  Requested
> (0,-1) of size 19x1 on raster of 19x19.
> ERROR 1: RasterIO error when writing target raster
>
> it seems that -md must be a multiple of the resolution.
>
> Best regards, Eli
>
> >
> > I get a similar error if I try to use the GDALViewshedGenerate C-API
> function. The input us a valid WGS84-UTM tiff file, and the output is a
> valid path, but the file does not actually exist until I run the command.
> After I run the command, the output file is created but only filled
> halfway. Any help at wall would be appreciated.
> >
> > regards, Ben
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191112/2915ce2a/attachment.html>

From even.rouault at spatialys.com  Tue Nov 12 15:01:57 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Nov 2019 00:01:57 +0100
Subject: [gdal-dev] GPX metadata records?
In-Reply-To: <CAKw=BhNj9S9NmG180u0wWVLjL5pho=nBBnY81L=DS0H_=Zunqw@mail.gmail.com>
References: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
 <3224892.EWMLNp5Bio@even-i700>
 <CAKw=BhNj9S9NmG180u0wWVLjL5pho=nBBnY81L=DS0H_=Zunqw@mail.gmail.com>
Message-ID: <9018544.TaiECr6ZyB@even-i700>

On mardi 12 novembre 2019 13:50:17 CET Gerard wrote:
> Thanks! I don't think I knew that I could preface the source with DRIVER:.
> Perhaps a suggestion for the documentation:
> 
> <[DRIVER:]datasource_name>

That's not supported by all drivers. Actually most drivers don't need (and 
won't support) that syntax. But there ae circumstances where things must be 
disambiguated. For examples files opened by the more recent GMLAS driver are 
generally opened by the venerable GML driver, hence the GMLAS: prefix

Drivers that support that syntax have it documened in their respective 
documentation pages.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gregory.bataille at gmail.com  Wed Nov 13 04:18:52 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Wed, 13 Nov 2019 13:18:52 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <CACVcCzqU5quwMhHKdhZjYUk=L_2CFd5Y-QGBXug1vE_sBkgGhg@mail.gmail.com>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <4469243.TJ2OctFfXH@even-i700>
 <CACVcCzqU5quwMhHKdhZjYUk=L_2CFd5Y-QGBXug1vE_sBkgGhg@mail.gmail.com>
Message-ID: <CACVcCzqdMH-da7BxS1YZo0rAnyGgUyc-nJSZpb-q5=Wdjq4wAA@mail.gmail.com>

Hey Even,

So I can confirm that this is the issue
On Mac
OGRCT: Selecting transformation +proj=pipeline +step +proj=axisswap
+order=2,1 +step +inv +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000
+y_0=0 +ellps=bessel +step +proj=unitconvert +xy_in=rad +xy_out=deg +step
+proj=axisswap +order=2,1 (Inverse of 3-degree Gauss-Kruger zone 4 + DHDN
to WGS 84 (2) + Inverse of Transformation to WGS84)

On my linux docker
OGRCT: Selecting transformation +proj=pipeline +step +proj=axisswap
+order=2,1 +step +inv +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000
+y_0=0 +ellps=bessel +step +proj=hgridshift +grids=BETA2007.gsb +step
+proj=push +v_3 +step +proj=cart +ellps=WGS84 +step +inv +proj=helmert
+x=598.1 +y=73.7 +z=418.2 +rx=0.202 +ry=0.045 +rz=-2.455 +s=6.7
+convention=position_vector +step +inv +proj=cart +ellps=bessel +step
+proj=pop +v_3 +step +proj=unitconvert +xy_in=rad +xy_out=deg +step
+proj=axisswap +order=2,1 (Inverse of 3-degree Gauss-Kruger zone 4 + DHDN
to WGS 84 (4) + Inverse of Transformation to WGS84)

Now this is a problem to me and I don't quite know what to do with it.

So I have a fully specified dataset, that gives a TOWGS84, that my user has
chosen (properly or not)
Once the dataset is using this representation, I can't have auto projection
because those will/might depend on the application using the dataset.
Currently (most of) my backend processes are in Gdal3 / Proj6 and therefore
(per my understanding), the TOWGS84 might be overriden
However my front end processes only have some proj4 equivalence and will
trust exactly the dataset.

I'm a bit at a loss to know what I should do.
Should I do a gdalwarp step for gdal to "chose" the best projection and get
a new dataset (with another TOWGS84) that I use internally for alignment,
while giving the client the one he has asked for when he wants to get the
raw dataset?

Do you have any ideas/recommandations? Is there a way to disable the PROJ6
auto-selection feature?

Thanks

---
Gregory Bataille


On Fri, Nov 8, 2019 at 12:36 PM Grégory Bataille <gregory.bataille at gmail.com>
wrote:

> That’s a problem for us. With gdal 3 we started to force values for the
> towgs84 so that proj would not decide.
> This is wanted because our front end will place markers and it does
> coordinates transform. Without access to proj 6. Meaning it needs to have
> the transform Value.
>
> I’ll check what you mentioned (on Monday though I think)
>
> Thanks for having a look
>
> Greg
>
> On Fri, 8 Nov 2019 at 12:30, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On vendredi 8 novembre 2019 08:18:11 CET Grégory Bataille wrote:
>> > Hey all,
>> >
>> > So I have a strange issue that I somewhat isolated, but I don't know
>> how to
>> > move further.
>> > I have dataset in EPSG 31468-15949
>>
>> I would check if that wouldn't be related to availability of the
>> BETA2007.gsb
>> grid. osgeo/gdal:alpine-normal-3.0.2 has it. Does your MAC install have
>> it ?
>>
>> That said, your TIFF file has a hardcoded TOWGS84=598.1,73.7,418.2,0.202
>>
>> ,0.045,-2.455,6.7 . When using
>>
>> gdalwarp Investigation_tile_alignment/ClippedProject.tif out.tif
>> -overwrite -
>> t_srs EPSG:4326 --debug on
>>
>> I see locally that BETA2007.gsb is used. This is not so bad, but a bit
>> unexpected since I'd thought that forced TOWGS84 would have take the
>> precedence.
>>
>> Checking further in ogrct.cpp, I see that as the GeoTIFF has also the
>> EPSG:
>> 31468 code, and when instanciating the PROJ coordinate transformation,
>> this is
>> the preferred initializer, and thus the hardcoded TOWGS84 is ignored. So
>> this
>> explains what I observe. I'm not completely clear of what would be the
>> desired
>> behaviour here. In some use cases, one might prefer to honour the
>> possibly
>> suboptimal TOWGS84 from the geotiff info (the simple fact of doing
>> gdal_translate -a_srs EPSG:31468 hardcodes it. Even with GDAL 3, which is
>> probably no longer a good idea...). In other cases, just trust PROJ to
>> use the
>> best transformation method.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
> --
> Greg
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191113/84a22337/attachment-0001.html>

From paul.malm at lfv.se  Wed Nov 13 04:19:50 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Wed, 13 Nov 2019 12:19:50 +0000
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <4fd18be65df5fd125e2931980b6df398@carto.net>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>

Hi,
I’m now setting attribute OGR_STYLE in my postGis db for a testlayer (line)
I’m now setting attribute OGR_STYLE in my postgis db for a test layer (LineString):
… SET \"OGR_STYLE\"= 'PEN(c:#FF3333,id:ogr-pen-4,w:1px)'
Does anyone know why the pen symbol (id) is ignored when exporting the PDF, it’s always a solid line?
Color and width is ok.
I’ve tried to draw a ogr-symbol together with a point layer and it worked like a charm.
Kind regards,
Paul

Från: Andreas Neumann [mailto:a.neumann at carto.net]
Skickat: den 11 november 2019 08:35
Till: Malm, Paul (Operations AIM)
Kopia: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr PDF


Hi Paul,

ogr2ogr usually doesn't care much about styling, unless you use ogr feature styles:

https://svn.osgeo.org/gdal/trunk/gdal/ogr/ogr_feature_style.html

Or you use QGIS 3.10* which has a nice GeoPDF export built in. But if you want to automate things, I understand that the automated solution might be better for your workflow.

*Disclaimer: QGIS 3.10 must be compiled with GDAL >= 3.0 and proj6, which as far as I know is currently not the case for QGIS Windows standalone builds. See also https://gis.stackexchange.com/questions/340030/create-geospatial-pdf-geopdf-is-greyed-out-in-pdf-export-options-in-qgis-3-10

Greetings,

Andreas

On 2019-11-11 08:28, paul.malm at lfv.se wrote:


Hi list,

I have a question on how to export a PDF file from PostGIS with a color on the lines instead of the default black lines. I have searched on the internet but have not reached all the way…

I have 2 tables that I would like to export into test.pdf (rivers and roads)

ogr2ogr -f "PDF" c:\Temp\test.pdf PG:"host=xxx.xxx.xxx.x user=yyyy dbname=testdb password=pwd" rivers roads



I would, for instance set like to set line width to 1 px and color to 4040FF on rivers,

Width 3 px and color FF4040 on roads.



Thanks,

Paul

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191113/72830825/attachment.html>

From even.rouault at spatialys.com  Wed Nov 13 04:47:51 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Nov 2019 13:47:51 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <CACVcCzqdMH-da7BxS1YZo0rAnyGgUyc-nJSZpb-q5=Wdjq4wAA@mail.gmail.com>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <CACVcCzqU5quwMhHKdhZjYUk=L_2CFd5Y-QGBXug1vE_sBkgGhg@mail.gmail.com>
 <CACVcCzqdMH-da7BxS1YZo0rAnyGgUyc-nJSZpb-q5=Wdjq4wAA@mail.gmail.com>
Message-ID: <2083603.0mx8FG2HdA@even-i700>

On mercredi 13 novembre 2019 13:18:52 CET Grégory Bataille wrote:
> Hey Even,
> 
> So I can confirm that this is the issue
> On Mac
> OGRCT: Selecting transformation +proj=pipeline +step +proj=axisswap
> +order=2,1 +step +inv +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000
> +y_0=0 +ellps=bessel +step +proj=unitconvert +xy_in=rad +xy_out=deg +step
> +proj=axisswap +order=2,1 (Inverse of 3-degree Gauss-Kruger zone 4 + DHDN
> to WGS 84 (2) + Inverse of Transformation to WGS84)
> 
> On my linux docker
> OGRCT: Selecting transformation +proj=pipeline +step +proj=axisswap
> +order=2,1 +step +inv +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000
> +y_0=0 +ellps=bessel +step +proj=hgridshift +grids=BETA2007.gsb +step
> +proj=push +v_3 +step +proj=cart +ellps=WGS84 +step +inv +proj=helmert
> +x=598.1 +y=73.7 +z=418.2 +rx=0.202 +ry=0.045 +rz=-2.455 +s=6.7
> +convention=position_vector +step +inv +proj=cart +ellps=bessel +step
> +proj=pop +v_3 +step +proj=unitconvert +xy_in=rad +xy_out=deg +step
> +proj=axisswap +order=2,1 (Inverse of 3-degree Gauss-Kruger zone 4 + DHDN
> to WGS 84 (4) + Inverse of Transformation to WGS84)
> 
> Now this is a problem to me and I don't quite know what to do with it.
> 
> So I have a fully specified dataset, that gives a TOWGS84, that my user has
> chosen (properly or not)
> Once the dataset is using this representation, I can't have auto projection
> because those will/might depend on the application using the dataset.
> Currently (most of) my backend processes are in Gdal3 / Proj6 and therefore
> (per my understanding), the TOWGS84 might be overriden
> However my front end processes only have some proj4 equivalence and will
> trust exactly the dataset.
> 
> I'm a bit at a loss to know what I should do.
> Should I do a gdalwarp step for gdal to "chose" the best projection and get
> a new dataset (with another TOWGS84) that I use internally for alignment,
> while giving the client the one he has asked for when he wants to get the
> raw dataset?
> 
> Do you have any ideas/recommandations? Is there a way to disable the PROJ6
> auto-selection feature?

This is not a PROJ6 issue, but a GDAL one related to the logic starting at
https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrct.cpp#L843

You could try to add a test that if OGRSpatialReference::GetTOWGS84() returns 
OGRERR_NONE then the resolution to the WKT of the EPSG code is skipped

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 13 06:22:29 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Nov 2019 15:22:29 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
Message-ID: <4509893.ddkccIuGDM@even-i700>

Hi,

I've updated both the RFC text and candidate implementation with the
provided comments, so I think we are now good to vote on it.

~~~~~~

Motion: adopt RFC 76 OGR Python drivers:
https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst

~~~~~~

Starting with my +1,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From deduikertjes at xs4all.nl  Wed Nov 13 06:24:07 2019
From: deduikertjes at xs4all.nl (Marco)
Date: Wed, 13 Nov 2019 15:24:07 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <6265eec1-7ae8-a36e-4f36-ba9f104d56e7@xs4all.nl>

Even,

Great!
Of course my +1

MArco

On 13-11-19 15:22, Even Rouault wrote:
> Hi,
>
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
>
> ~~~~~~
>
> Motion: adopt RFC 76 OGR Python drivers:
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
>
> ~~~~~~
>
> Starting with my +1,
>
> Even
>


From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 13 07:35:18 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 13 Nov 2019 08:35:18 -0700 (MST)
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>
Message-ID: <1573659318482-0.post@n6.nabble.com>

Hi,

What is supported is documented in a table in
https://gdal.org/drivers/raster/pdf.html. For PEN only these options are
supported: color (c); width (w); dash pattern (p).

So why, you know, nobody has implemented it yet. Meanwhile you can do
something with dash pattern, or edit the PDF with some PDF editor.

-Jukka Rahkonen-


paul.malm wrote
> Hi,
> I’m now setting attribute OGR_STYLE in my postGis db for a testlayer
> (line)
> I’m now setting attribute OGR_STYLE in my postgis db for a test layer
> (LineString):
> … SET \"OGR_STYLE\"= 'PEN(c:#FF3333,id:ogr-pen-4,w:1px)'
> Does anyone know why the pen symbol (id) is ignored when exporting the
> PDF, it’s always a solid line?
> Color and width is ok.
> I’ve tried to draw a ogr-symbol together with a point layer and it worked
> like a charm.
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 13 07:36:58 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 13 Nov 2019 08:36:58 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <1573659418195-0.post@n6.nabble.com>

+1

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
> 
> ~~~~~~
> 
> Motion: adopt RFC 76 OGR Python drivers:
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> 
> ~~~~~~
> 
> Starting with my +1,





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From sean at mapbox.com  Wed Nov 13 07:50:29 2019
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 13 Nov 2019 08:50:29 -0700
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <CADPhZXy6f7Ct5gp+NshNKqs5a=f1urbFUfPRf=9jjZTL+-h_UQ@mail.gmail.com>

The implementation is fine. Thanks for listening to my comments, Even. I
think that plugins are really the business of apps like QGIS and MapServer
and that plugins in GDAL complicate the situation for developers, but one
might use these with caution in some special cases. -0 from me.

On Wed, Nov 13, 2019 at 7:22 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
>
> ~~~~~~
>
> Motion: adopt RFC 76 OGR Python drivers:
>
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
>
> ~~~~~~
>
> Starting with my +1,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191113/01dd7878/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 13 08:18:32 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 13 Nov 2019 16:18:32 +0000
Subject: [gdal-dev] Schema support in OAPIF and GeoJSON
Message-ID: <37c8cb3b2145481696ad979fd57a791a@C119S212VM042.msvyvi.vaha.local>

Hi,

GeoJSON from OGC API Features service may contain schema or reference to schema and OAPIF driver resolves it. Does the plain GeoJSON driver have the same support? If not, how about to add the support, possibly with an open option to read the schema from a local file? Otherwise it can happen that reading GeoJSON from a server would give different schema than reading the same GeoJSON from a disk if data does not contain all the attributes from the schema.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191113/aacf065b/attachment.html>

From even.rouault at spatialys.com  Wed Nov 13 08:38:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 Nov 2019 17:38:28 +0100
Subject: [gdal-dev] Schema support in OAPIF and GeoJSON
In-Reply-To: <37c8cb3b2145481696ad979fd57a791a@C119S212VM042.msvyvi.vaha.local>
References: <37c8cb3b2145481696ad979fd57a791a@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1677818.CkO0QJHtLJ@even-i700>

On mercredi 13 novembre 2019 16:18:32 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> GeoJSON from OGC API Features service may contain schema or reference to
> schema and OAPIF driver resolves it. Does the plain GeoJSON driver have the
> same support? If not, how about to add the support, possibly with an open
> option to read the schema from a local file? Otherwise it can happen that
> reading GeoJSON from a server would give different schema than reading the
> same GeoJSON from a disk if data does not contain all the attributes from
> the schema.

Jukka,

The likelihood of issues araising with a GeoJSON file from disk is lesser than 
in the OAPIF context, since the GeoJSON driver makes a full pass on the file 
to build the layer schema, wheras the OAPIF driver only analyzes the first 
page (when there's no schema). And GeoJSON files are very rarely accompanied 
with schemas. So while I think an enhancement ticket about that makes sense, 
this is not currently in the top of my own priority list.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 13 16:24:32 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Nov 2019 01:24:32 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <2083603.0mx8FG2HdA@even-i700>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <CACVcCzqdMH-da7BxS1YZo0rAnyGgUyc-nJSZpb-q5=Wdjq4wAA@mail.gmail.com>
 <2083603.0mx8FG2HdA@even-i700>
Message-ID: <8904649.nEcZpk4ZHj@even-i700>

> This is not a PROJ6 issue, but a GDAL one related to the logic starting at
> https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrct.cpp#L843
> 
> You could try to add a test that if OGRSpatialReference::GetTOWGS84()
> returns OGRERR_NONE then the resolution to the WKT of the EPSG code is
> skipped

I've implemented this in https://github.com/OSGeo/gdal/pull/2016

The last commit is the one that is of interest for you. I've kept the current 
behaviour as default, as I think it is what most people would want. For your 
use case, you'd define OSR_CT_USE_DEFAULT_EPSG_TOWGS84=YES

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gregory.bataille at gmail.com  Wed Nov 13 20:54:09 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 14 Nov 2019 05:54:09 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <8904649.nEcZpk4ZHj@even-i700>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <CACVcCzqdMH-da7BxS1YZo0rAnyGgUyc-nJSZpb-q5=Wdjq4wAA@mail.gmail.com>
 <2083603.0mx8FG2HdA@even-i700> <8904649.nEcZpk4ZHj@even-i700>
Message-ID: <CACVcCzoLpaOJ9DoyNCkAaZnxa888SCpQdb1uocrWd1p3eJN+_g@mail.gmail.com>

wow, thanks.

I'm not quite sure I'm following it all though. I'm reaching a bit my
knowledge limit here with those transforms. I'll need to spend a bit more
time on it to get more understanding and see what I can do, how I might use
your update.
But thanks for the quick turnaround

Cheers

---
Gregory Bataille


On Thu, Nov 14, 2019 at 1:24 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> > This is not a PROJ6 issue, but a GDAL one related to the logic starting
> at
> > https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrct.cpp#L843
> >
> > You could try to add a test that if OGRSpatialReference::GetTOWGS84()
> > returns OGRERR_NONE then the resolution to the WKT of the EPSG code is
> > skipped
>
> I've implemented this in https://github.com/OSGeo/gdal/pull/2016
>
> The last commit is the one that is of interest for you. I've kept the
> current
> behaviour as default, as I think it is what most people would want. For
> your
> use case, you'd define OSR_CT_USE_DEFAULT_EPSG_TOWGS84=YES
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191114/dcd8dc79/attachment.html>

From mchapman at hyperacktive.com  Wed Nov 13 22:39:42 2019
From: mchapman at hyperacktive.com (Martin Chapman)
Date: Wed, 13 Nov 2019 23:39:42 -0700
Subject: [gdal-dev] extracting a raster data within a polygon?
In-Reply-To: <CAJKO1YuP8B8tMFzpD14JyB7b7HM4hefXeu7_MzGWz0LzVOGgGQ@mail.gmail.com>
References: <CAJKO1YuP8B8tMFzpD14JyB7b7HM4hefXeu7_MzGWz0LzVOGgGQ@mail.gmail.com>
Message-ID: <002001d59ab6$4c2cafa0$e4860ee0$@hyperacktive.com>

Ahmet,

 

You can use either the gdalwarp.exe or the underlying gdal warper C++ API to create a new image using the polygon geometry as a cutline.  See the gdalwarp.exe or gdal warper C++ API documentation on how to do that.  

 

Basically, the cutline geometry will NULL out any pixels in the output image that are not within the polygon geometry.  If you use the gdalwarp.exe utility it will output a new image to disk.  If you use the gdal warper C++ API then you can write the output image to disk or memory.  For more information on how this is done programmatically see the source code for the gdalwarp.exe that is included with the gdal source code.

 

NOTE:  Your cutline geometry needs to be topologically correct in order to produce good output.  Topologically correct geometries do not contain self-intersections, slivers, etc.  An example of a self-intersecting geometry is a bow-tie where two lines in the geometry cross each other.  Slivers are where two adjacent geometries share an edge but there is a gap between the edges.  Lots of shape files contain geometries that are not topologically correct because ArcMap and other tools don’t enforce that.  The warp API can handle polygons and multi-polygons.  If your output comes out looking screwed up it is most likely because your cutline geometry is not topologically correct OR you didn’t convert the cutline geometry from coordinate space to pixel space before feeding it to the warper C++ API (in the case you do it programmatically).  The gdalwarp.exe can handle geometries in coordinate space.  If by chance your cutline geometry is not topologically correct you may be able to fix it by doing a Buffer() operation on it using the OGR API with a buffer distance of 0.  GEOS (the underlying engine for the OGR buffer operation) will create a new geometry that is exactly the same as the input because the buffer distance is zero but the GEOS API will attempt to correct the topology of the new geometry.

 

Best regards,

Martin Chapman

 

  

 

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Ahmet Temiz
Sent: Saturday, November 9, 2019 9:57 AM
To: gdal-dev
Subject: [gdal-dev] extracting a raster data within a polygon?

 

Hi,

how I can extract a raster data within a polygon (not a rectangle) using C++?

i.e. dem within provincial boundary

Regards

-- 

Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191113/7fbb5aa3/attachment.html>

From paul.malm at lfv.se  Wed Nov 13 23:18:11 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Thu, 14 Nov 2019 07:18:11 +0000
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <1573659318482-0.post@n6.nabble.com>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>
 <1573659318482-0.post@n6.nabble.com>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE69F5D@xw-exch03.lfv.se>

Thanks for responding Jukka!
I'm getting real irritated of myself for not getting such a simple thing to work with such grate tools.
I have now tried with: 
PEN(c:#FF00FF,w:3px,p:"3px 3px")
PEN(c:#FF00FF,w:3px,p:3px 3px)
PEN(p:"3px 3px",c:#FF00FF,w:3px)
PEN(p:3px 3px,c:#FF00FF,w:3px)
PEN(c:#FF00FF, p:"3px 3px",w:3px)
PEN(c:#FF00FF, p:3px 3px,w:3px)
But I'm getting the same solid line. Width and color are ok.
/Paul

-----Ursprungligt meddelande-----
Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För jratike80
Skickat: den 13 november 2019 16:35
Till: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr PDF

Hi,

What is supported is documented in a table in
https://gdal.org/drivers/raster/pdf.html. For PEN only these options are
supported: color (c); width (w); dash pattern (p).

So why, you know, nobody has implemented it yet. Meanwhile you can do
something with dash pattern, or edit the PDF with some PDF editor.

-Jukka Rahkonen-


paul.malm wrote
> Hi,
> I’m now setting attribute OGR_STYLE in my postGis db for a testlayer
> (line)
> I’m now setting attribute OGR_STYLE in my postgis db for a test layer
> (LineString):
> … SET \"OGR_STYLE\"= 'PEN(c:#FF3333,id:ogr-pen-4,w:1px)'
> Does anyone know why the pen symbol (id) is ignored when exporting the
> PDF, it’s always a solid line?
> Color and width is ok.
> I’ve tried to draw a ogr-symbol together with a point layer and it worked
> like a charm.
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From r.nijssen at terglobo.nl  Thu Nov 14 00:32:13 2019
From: r.nijssen at terglobo.nl (Raymond Nijssen)
Date: Thu, 14 Nov 2019 09:32:13 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <4c4feb71-77a9-f5cf-0f28-345f2e95920f@terglobo.nl>

Even,

Great work, thank you so much!

+1

Raymond



On 13-11-19 15:22, Even Rouault wrote:
> Hi,
> 
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
> 
> ~~~~~~
> 
> Motion: adopt RFC 76 OGR Python drivers:
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> 
> ~~~~~~
> 
> Starting with my +1,
> 
> Even
> 

From mateusz at loskot.net  Thu Nov 14 02:38:46 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 14 Nov 2019 03:38:46 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <1573727926938-0.post@n6.nabble.com>

+1 

Mateusz


Even Rouault-2 wrote
> Hi,
> 
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
> 
> ~~~~~~
> 
> Motion: adopt RFC 76 OGR Python drivers:
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> 
> ~~~~~~






--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Nov 14 03:46:56 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Nov 2019 12:46:56 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <CACVcCzoLpaOJ9DoyNCkAaZnxa888SCpQdb1uocrWd1p3eJN+_g@mail.gmail.com>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <8904649.nEcZpk4ZHj@even-i700>
 <CACVcCzoLpaOJ9DoyNCkAaZnxa888SCpQdb1uocrWd1p3eJN+_g@mail.gmail.com>
Message-ID: <1661625.ccDmhUiBnx@even-i700>

On jeudi 14 novembre 2019 05:54:09 CET Grégory Bataille wrote:
> wow, thanks.
> 
> I'm not quite sure I'm following it all though. I'm reaching a bit my
> knowledge limit here with those transforms. I'll need to spend a bit more
> time on it to get more understanding and see what I can do, how I might use
> your update.
> But thanks for the quick turnaround

Another option if you want full control on the transformation would be to 
provide the PROJ pipeline directly. gdalwarp has the -ct switch for that, 
which ultimately uses OGRCoordinateTransformation::SetCoordinateOperation()

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gregory.bataille at gmail.com  Thu Nov 14 04:03:34 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 14 Nov 2019 13:03:34 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <1661625.ccDmhUiBnx@even-i700>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <8904649.nEcZpk4ZHj@even-i700>
 <CACVcCzoLpaOJ9DoyNCkAaZnxa888SCpQdb1uocrWd1p3eJN+_g@mail.gmail.com>
 <1661625.ccDmhUiBnx@even-i700>
Message-ID: <CACVcCzq8M4OL_ZcQj4Lw0Or+wSbQUMqwPU7SuTkocR+2fa50Kg@mail.gmail.com>

Oh, I could gdalwarp the dataset myself to WGS84 and then tile it, so as to
consistently "ignore" grids.
That's an idea indeed.

Thanks for the pointer, I'll take it into consideration

---
Gregory Bataille


On Thu, Nov 14, 2019 at 12:46 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 14 novembre 2019 05:54:09 CET Grégory Bataille wrote:
> > wow, thanks.
> >
> > I'm not quite sure I'm following it all though. I'm reaching a bit my
> > knowledge limit here with those transforms. I'll need to spend a bit more
> > time on it to get more understanding and see what I can do, how I might
> use
> > your update.
> > But thanks for the quick turnaround
>
> Another option if you want full control on the transformation would be to
> provide the PROJ pipeline directly. gdalwarp has the -ct switch for that,
> which ultimately uses OGRCoordinateTransformation::SetCoordinateOperation()
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191114/a223eb51/attachment.html>

From gregory.bataille at gmail.com  Thu Nov 14 05:57:51 2019
From: gregory.bataille at gmail.com (=?UTF-8?Q?Gr=C3=A9gory_Bataille?=)
Date: Thu, 14 Nov 2019 14:57:51 +0100
Subject: [gdal-dev] Discrepancy when tiling on MAC and Linux
In-Reply-To: <CACVcCzq8M4OL_ZcQj4Lw0Or+wSbQUMqwPU7SuTkocR+2fa50Kg@mail.gmail.com>
References: <CACVcCzo=DZ+ojD4k2qb05oHBMZeKmsSTKFJV_81FmvSyZNLXOA@mail.gmail.com>
 <8904649.nEcZpk4ZHj@even-i700>
 <CACVcCzoLpaOJ9DoyNCkAaZnxa888SCpQdb1uocrWd1p3eJN+_g@mail.gmail.com>
 <1661625.ccDmhUiBnx@even-i700>
 <CACVcCzq8M4OL_ZcQj4Lw0Or+wSbQUMqwPU7SuTkocR+2fa50Kg@mail.gmail.com>
Message-ID: <CACVcCzpzPnkKkBLq5zjfqx0w2Au==siK+C7M4k-k4nYZ9iZBKw@mail.gmail.com>

Hey Even,

Actually a "simpler" solution for now for us is to remove the grid from the
docker image we use to run dataset tiling. This way, the projection follows
TOWGS84.
It's suboptimal in term of absolute accuracy of the tiles, but it gives us
consistency in our data which is more important to us.

Thanks for the support. I don't think I would have found this grid thing on
my own.

---
Gregory Bataille


On Thu, Nov 14, 2019 at 1:03 PM Grégory Bataille <gregory.bataille at gmail.com>
wrote:

> Oh, I could gdalwarp the dataset myself to WGS84 and then tile it, so as
> to consistently "ignore" grids.
> That's an idea indeed.
>
> Thanks for the pointer, I'll take it into consideration
>
> ---
> Gregory Bataille
>
>
> On Thu, Nov 14, 2019 at 12:46 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On jeudi 14 novembre 2019 05:54:09 CET Grégory Bataille wrote:
>> > wow, thanks.
>> >
>> > I'm not quite sure I'm following it all though. I'm reaching a bit my
>> > knowledge limit here with those transforms. I'll need to spend a bit
>> more
>> > time on it to get more understanding and see what I can do, how I might
>> use
>> > your update.
>> > But thanks for the quick turnaround
>>
>> Another option if you want full control on the transformation would be to
>> provide the PROJ pipeline directly. gdalwarp has the -ct switch for that,
>> which ultimately uses
>> OGRCoordinateTransformation::SetCoordinateOperation()
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191114/a63aa780/attachment.html>

From howard at hobu.co  Thu Nov 14 06:11:19 2019
From: howard at hobu.co (Howard Butler)
Date: Thu, 14 Nov 2019 08:11:19 -0600
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <1573727926938-0.post@n6.nabble.com>
References: <4509893.ddkccIuGDM@even-i700> <1573727926938-0.post@n6.nabble.com>
Message-ID: <CAKyBbG7mMqsOkNjZN_r2yRMu7b2UzSPX42hkovdqU9KUqp1-Aw@mail.gmail.com>

+0.

I worry this will rot, and I worry people will start distributing drivers
based on it and adding a lot of complexity for users. A note stating that
the project is not going to distribute Python-based drivers as part of its
baseline would make our intentions clear, but that isn't going to prevent
anyone else from doing it.

On Thu, Nov 14, 2019 at 4:39 AM Mateusz Loskot <mateusz at loskot.net> wrote:

> +1
>
> Mateusz
>
>
> Even Rouault-2 wrote
> > Hi,
> >
> > I've updated both the RFC text and candidate implementation with the
> > provided comments, so I think we are now good to vote on it.
> >
> > ~~~~~~
> >
> > Motion: adopt RFC 76 OGR Python drivers:
> >
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> >
> > ~~~~~~
>
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191114/95e7a7a0/attachment.html>

From even.rouault at spatialys.com  Thu Nov 14 06:22:12 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Nov 2019 15:22:12 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <CAKyBbG7mMqsOkNjZN_r2yRMu7b2UzSPX42hkovdqU9KUqp1-Aw@mail.gmail.com>
References: <4509893.ddkccIuGDM@even-i700> <1573727926938-0.post@n6.nabble.com>
 <CAKyBbG7mMqsOkNjZN_r2yRMu7b2UzSPX42hkovdqU9KUqp1-Aw@mail.gmail.com>
Message-ID: <2727086.aFIZoJXYrg@even-i700>

On jeudi 14 novembre 2019 08:11:19 CET Howard Butler wrote:
> +0.
> 
> I worry this will rot, and I worry people will start distributing drivers
> based on it and adding a lot of complexity for users. A note stating that
> the project is not going to distribute Python-based drivers as part of its
> baseline would make our intentions clear,

That note has been added in the intro of the tutorial:
https://github.com/rouault/gdal/blob/pythondrivers/gdal/doc/source/tutorials/vector_python_driver.rst

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 14 06:54:41 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 14 Nov 2019 07:54:41 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <CAKyBbG7mMqsOkNjZN_r2yRMu7b2UzSPX42hkovdqU9KUqp1-Aw@mail.gmail.com>
References: <4509893.ddkccIuGDM@even-i700> <1573727926938-0.post@n6.nabble.com>
 <CAKyBbG7mMqsOkNjZN_r2yRMu7b2UzSPX42hkovdqU9KUqp1-Aw@mail.gmail.com>
Message-ID: <1573743281421-0.post@n6.nabble.com>

Hi,

I am not so worried. The alternative for people possibly interested in
building experimental Python drivers is not to make a new thoroughly tested
C++ plugin into GDAL core. Rather they will make experimental processes by
some other means. I am just discussing with someone who has made Mapserver
to send a requst to php service that asks gdal_polygonize to do some
processing and sends the result back to Mapserver via WFS. The use case and
result is quite unique. The process made into a GDAL Python driver would
probably be more easy to share with the community for re-use than as it
stands now. If the plugins are not delivered by GDAL project, are they so
much different than python scripts that can be found from the web? We must
not forget the possibility that even good things may happen and someone
writes some day a good GDAL Python driver.

-Jukka Rahkonen- 


Howard Butler-3 wrote
> +0.
> 
> I worry this will rot, and I worry people will start distributing drivers
> based on it and adding a lot of complexity for users. A note stating that
> the project is not going to distribute Python-based drivers as part of its
> baseline would make our intentions clear, but that isn't going to prevent
> anyone else from doing it.
> 
> On Thu, Nov 14, 2019 at 4:39 AM Mateusz Loskot &lt;

> mateusz@

> &gt; wrote:
> 
>> +1
>>
>> Mateusz
>>
>>
>> Even Rouault-2 wrote
>> > Hi,
>> >
>> > I've updated both the RFC text and candidate implementation with the
>> > provided comments, so I think we are now good to vote on it.
>> >
>> > ~~~~~~
>> >
>> > Motion: adopt RFC 76 OGR Python drivers:
>> >
>> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
>> >
>> > ~~~~~~
>>
>>
>>
>>
>>
>>
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From dmorissette at mapgears.com  Thu Nov 14 06:58:49 2019
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Thu, 14 Nov 2019 09:58:49 -0500
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4509893.ddkccIuGDM@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
Message-ID: <a7754af0-5516-5a16-bbf1-ac117b2d626b@mapgears.com>

+1

Daniel


On 2019-11-13 09:22, Even Rouault wrote:
> Hi,
> 
> I've updated both the RFC text and candidate implementation with the
> provided comments, so I think we are now good to vote on it.
> 
> ~~~~~~
> 
> Motion: adopt RFC 76 OGR Python drivers:
> https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> 
> ~~~~~~
> 
> Starting with my +1,
> 
> Even
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From stephenwoodbridge37 at gmail.com  Thu Nov 14 07:43:33 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 14 Nov 2019 10:43:33 -0500
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE69F5D@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>
 <1573659318482-0.post@n6.nabble.com>
 <785199B14156764C8EB14EF96CEDC44EE69F5D@xw-exch03.lfv.se>
Message-ID: <ef29aaa5-4895-f83c-3bfc-9740a9e05f98@gmail.com>

Paul,

Your issue might be one of scale. You have specified units in px try 
changing it to pt. (units (g, px, pt, mm, cm, in))

See: https://gdal.org/user/ogr_feature_style.html#ogr-feature-style

You can also try named pens like:

Here is the current list of OGR pen ids (this could grow over time):

  *

    ogr-pen-0: solid (the default when no id is provided)

  *

    ogr-pen-1: null pen (invisible)

  *

    ogr-pen-2: dash

  *

    ogr-pen-3: short-dash

  *

    ogr-pen-4: long-dash

  *

    ogr-pen-5: dot line

  *

    ogr-pen-6: dash-dot line

  *

    ogr-pen-7: dash-dot-dot line

  *

    ogr-pen-8: alternate-line (sets every other pixel)

System-specific ids are very likely to be meaningful only to that 
specific system that created them. The ids should start with the 
system’s name, followed by a dash (-), followed by whatever information 
is meaningful to that system (a number, a name, a filename, etc.).
e.g. “mapinfo-5”, or “mysoft-lines.sym-123”, or “othersystems-funnyline”

System-specific ids are allowed in order to prevent loss of information 
when dealing with data from systems that store line patterns in external 
files or that have their own pre-defined set of line styles (for 
instance, to do a MapInfo MIF to TAB translation without any loss.)

Examples:
PEN(c:#00FF00,id:”ogr-pen-0”) - simple solid line
PEN(c:#00FF00,id:”mapinfo-5,ogr -pen-7”) - corresponds to MapInfo’s Pen 
#5, and a system that can’t understand MapInfo pens falls back on the 
default “ogr-pen-7” pen (dot-dot line).

-Steve W

On 11/14/2019 2:18 AM, paul.malm at lfv.se wrote:
> Thanks for responding Jukka!
> I'm getting real irritated of myself for not getting such a simple thing to work with such grate tools.
> I have now tried with:
> PEN(c:#FF00FF,w:3px,p:"3px 3px")
> PEN(c:#FF00FF,w:3px,p:3px 3px)
> PEN(p:"3px 3px",c:#FF00FF,w:3px)
> PEN(p:3px 3px,c:#FF00FF,w:3px)
> PEN(c:#FF00FF, p:"3px 3px",w:3px)
> PEN(c:#FF00FF, p:3px 3px,w:3px)
> But I'm getting the same solid line. Width and color are ok.
> /Paul
>
> -----Ursprungligt meddelande-----
> Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För jratike80
> Skickat: den 13 november 2019 16:35
> Till: gdal-dev at lists.osgeo.org
> Ämne: Re: [gdal-dev] ogr2ogr PDF
>
> Hi,
>
> What is supported is documented in a table in
> https://gdal.org/drivers/raster/pdf.html. For PEN only these options are
> supported: color (c); width (w); dash pattern (p).
>
> So why, you know, nobody has implemented it yet. Meanwhile you can do
> something with dash pattern, or edit the PDF with some PDF editor.
>
> -Jukka Rahkonen-
>
>
> paul.malm wrote
>> Hi,
>> I’m now setting attribute OGR_STYLE in my postGis db for a testlayer
>> (line)
>> I’m now setting attribute OGR_STYLE in my postgis db for a test layer
>> (LineString):
>> … SET \"OGR_STYLE\"= 'PEN(c:#FF3333,id:ogr-pen-4,w:1px)'
>> Does anyone know why the pen symbol (id) is ignored when exporting the
>> PDF, it’s always a solid line?
>> Color and width is ok.
>> I’ve tried to draw a ogr-symbol together with a point layer and it worked
>> like a charm.
>> Kind regards,
>> Paul
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Thu Nov 14 07:50:04 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Nov 2019 16:50:04 +0100
Subject: [gdal-dev] Potential VRT bug
In-Reply-To: <F498984B-6BCB-468E-A6EA-205BD5E5BF6F@digitalglobe.com>
References: <F498984B-6BCB-468E-A6EA-205BD5E5BF6F@digitalglobe.com>
Message-ID: <1985852.duvu894jON@even-i700>

> I came across some strange behavior while panning around a VRT in QGIS. The
> VRT consists of several large overlapping TIFs where some TIFs have NODATA
> in areas where other TIFs have data. The behavior is hard to explain, but
> it looks like the data read from the files is corrupted. Panning around,
> zooming in and out, anything that triggers another read seems to change the
> way the data looks. It changes colors, gets skewed, etc. The TIFs
> themselves are fine on their own.
 
> I have reduced it down to a small subset of the data which is available here
> (about 2 MB):
 https://s3.amazonaws.com/pschmitt-test-public/data.tar.bz2
> 
> It consists of two TIFs:
> 1.tif - fully valid
> 2.tif - some valid data and some NODATA
> 
> I also included three VRTs which I created with these commands:
> gdalbuildvrt -r near near.vrt 1.tif 2.tif
> gdalbuildvrt -r bilinear bilinear.vrt 1.tif 2.tif
> gdalbuildvrt -r bilinear bilinear-reversed.vrt 2.tif 1.tif
> 
> If I run this command repeatedly, the min/max of the 4 bands always come out
> the same:
 gdal_translate -projwin 488135 4405500 488374 4405348 near.vrt
> /vsistdout/ | gdalinfo -mm /vsistdin/ 
> Run this same command on bilinear.vrt, and the min/max change each time. So
> that's weird.

For the record, the above described issue was found to be fixed per
https://github.com/OSGeo/gdal/pull/1943 (available in 2.4.3)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gerardg at gmail.com  Thu Nov 14 09:16:47 2019
From: gerardg at gmail.com (Gerard)
Date: Thu, 14 Nov 2019 10:16:47 -0700
Subject: [gdal-dev] GPX metadata records?
In-Reply-To: <9018544.TaiECr6ZyB@even-i700>
References: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
 <3224892.EWMLNp5Bio@even-i700>
 <CAKw=BhNj9S9NmG180u0wWVLjL5pho=nBBnY81L=DS0H_=Zunqw@mail.gmail.com>
 <9018544.TaiECr6ZyB@even-i700>
Message-ID: <CAKw=BhNgByyH1kK0FRr+LT+ZGUMUpY7a2xD-2CmpNx=XHHPW4g@mail.gmail.com>

Ah -- thanks for clarifying. GMLAS with some regexp worked to parse the GPX
metadata block. Would be interested in seeing metadata block implemented in
the GPX driver. I imagine it's on some feature request/TODO.

Thanks,
Gerard


On Tue, Nov 12, 2019 at 4:01 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 12 novembre 2019 13:50:17 CET Gerard wrote:
> > Thanks! I don't think I knew that I could preface the source with
> DRIVER:.
> > Perhaps a suggestion for the documentation:
> >
> > <[DRIVER:]datasource_name>
>
> That's not supported by all drivers. Actually most drivers don't need (and
> won't support) that syntax. But there ae circumstances where things must
> be
> disambiguated. For examples files opened by the more recent GMLAS driver
> are
> generally opened by the venerable GML driver, hence the GMLAS: prefix
>
> Drivers that support that syntax have it documened in their respective
> documentation pages.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191114/f6ee3b7e/attachment.html>

From even.rouault at spatialys.com  Thu Nov 14 09:28:58 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 Nov 2019 18:28:58 +0100
Subject: [gdal-dev] GPX metadata records?
In-Reply-To: <CAKw=BhNgByyH1kK0FRr+LT+ZGUMUpY7a2xD-2CmpNx=XHHPW4g@mail.gmail.com>
References: <CAKw=BhOtTyx4EWfquPjz8AoZB5L5tG2kWrWd_s-7NGQ65y-02g@mail.gmail.com>
 <9018544.TaiECr6ZyB@even-i700>
 <CAKw=BhNgByyH1kK0FRr+LT+ZGUMUpY7a2xD-2CmpNx=XHHPW4g@mail.gmail.com>
Message-ID: <1704128.CW6PtqT05B@even-i700>

> I imagine it's on some feature request/TODO.

Or maybe not.

Relevant reads:
https://nyalldawson.net/2016/08/how-to-effectively-get-things-changed-in-qgis/
http://nyalldawson.net/2016/08/how-to-effectively-get-things-changed-in-qgis-a-follow-up/

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From paul.malm at lfv.se  Fri Nov 15 00:31:02 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Fri, 15 Nov 2019 08:31:02 +0000
Subject: [gdal-dev] ogr2ogr PDF
In-Reply-To: <ef29aaa5-4895-f83c-3bfc-9740a9e05f98@gmail.com>
References: <785199B14156764C8EB14EF96CEDC44EE67BF1@xw-exch03.lfv.se>
 <4fd18be65df5fd125e2931980b6df398@carto.net>
 <785199B14156764C8EB14EF96CEDC44EE69842@xw-exch03.lfv.se>
 <1573659318482-0.post@n6.nabble.com>
 <785199B14156764C8EB14EF96CEDC44EE69F5D@xw-exch03.lfv.se>
 <ef29aaa5-4895-f83c-3bfc-9740a9e05f98@gmail.com>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE6ABF6@xw-exch03.lfv.se>

Stephen, 

thanks for responding!

I've tried this:
PEN(c:#FF00FF,w:3pt,p:"3pt 3pt")
PEN(c:#FF00FF,w:3pt,p:3pt 3pt)
PEN(p:"3pt 3pt",c:#FF00FF,w:3pt)
PEN(p:3pt 3pt,c:#FF00FF,w:3pt)
PEN(c:#FF00FF, p:"3pt 3pt",w:3pt)
PEN(c:#FF00FF, p:3pt 3pt,w:3pt)
But I'm getting the same solid line. Width and color are ok.

I have also tried to use: PEN(c:#FF00FF,id:ogr-pen-4,w:3pt) 
And I'm only getting the same solid line....

I'm using GDAL 2.4.1, released 2019/03/15
As I understand the PDF driver should handle line patterns.
/Paul 

-----Ursprungligt meddelande-----
Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För Stephen Woodbridge
Skickat: den 14 november 2019 16:44
Till: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr PDF

Paul,

Your issue might be one of scale. You have specified units in px try 
changing it to pt. (units (g, px, pt, mm, cm, in))

See: https://gdal.org/user/ogr_feature_style.html#ogr-feature-style

You can also try named pens like:

Here is the current list of OGR pen ids (this could grow over time):

  *

    ogr-pen-0: solid (the default when no id is provided)

  *

    ogr-pen-1: null pen (invisible)

  *

    ogr-pen-2: dash

  *

    ogr-pen-3: short-dash

  *

    ogr-pen-4: long-dash

  *

    ogr-pen-5: dot line

  *

    ogr-pen-6: dash-dot line

  *

    ogr-pen-7: dash-dot-dot line

  *

    ogr-pen-8: alternate-line (sets every other pixel)

System-specific ids are very likely to be meaningful only to that 
specific system that created them. The ids should start with the 
system’s name, followed by a dash (-), followed by whatever information 
is meaningful to that system (a number, a name, a filename, etc.).
e.g. “mapinfo-5”, or “mysoft-lines.sym-123”, or “othersystems-funnyline”

System-specific ids are allowed in order to prevent loss of information 
when dealing with data from systems that store line patterns in external 
files or that have their own pre-defined set of line styles (for 
instance, to do a MapInfo MIF to TAB translation without any loss.)

Examples:
PEN(c:#00FF00,id:”ogr-pen-0”) - simple solid line
PEN(c:#00FF00,id:”mapinfo-5,ogr -pen-7”) - corresponds to MapInfo’s Pen 
#5, and a system that can’t understand MapInfo pens falls back on the 
default “ogr-pen-7” pen (dot-dot line).

-Steve W

On 11/14/2019 2:18 AM, paul.malm at lfv.se wrote:
> Thanks for responding Jukka!
> I'm getting real irritated of myself for not getting such a simple thing to work with such grate tools.
> I have now tried with:
> PEN(c:#FF00FF,w:3px,p:"3px 3px")
> PEN(c:#FF00FF,w:3px,p:3px 3px)
> PEN(p:"3px 3px",c:#FF00FF,w:3px)
> PEN(p:3px 3px,c:#FF00FF,w:3px)
> PEN(c:#FF00FF, p:"3px 3px",w:3px)
> PEN(c:#FF00FF, p:3px 3px,w:3px)
> But I'm getting the same solid line. Width and color are ok.
> /Paul
>
> -----Ursprungligt meddelande-----
> Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För jratike80
> Skickat: den 13 november 2019 16:35
> Till: gdal-dev at lists.osgeo.org
> Ämne: Re: [gdal-dev] ogr2ogr PDF
>
> Hi,
>
> What is supported is documented in a table in
> https://gdal.org/drivers/raster/pdf.html. For PEN only these options are
> supported: color (c); width (w); dash pattern (p).
>
> So why, you know, nobody has implemented it yet. Meanwhile you can do
> something with dash pattern, or edit the PDF with some PDF editor.
>
> -Jukka Rahkonen-
>
>
> paul.malm wrote
>> Hi,
>> I’m now setting attribute OGR_STYLE in my postGis db for a testlayer
>> (line)
>> I’m now setting attribute OGR_STYLE in my postgis db for a test layer
>> (LineString):
>> … SET \"OGR_STYLE\"= 'PEN(c:#FF3333,id:ogr-pen-4,w:1px)'
>> Does anyone know why the pen symbol (id) is ignored when exporting the
>> PDF, it’s always a solid line?
>> Color and width is ok.
>> I’ve tried to draw a ogr-symbol together with a point layer and it worked
>> like a charm.
>> Kind regards,
>> Paul
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov 15 00:52:48 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 15 Nov 2019 08:52:48 +0000
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
Message-ID: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>

Hi,

Shapefile can be edited with ogrinfo
ogrinfo -dialect SQLite -sql "update foo set bar='14'" foo.shp

GML opens always as read-only with -sql option
ogrinfo -sql "select * from foo" foo.gml
Had to open data source read-only.
INFO: Open of `foo.gml'
      using driver `GML' successful.

How can I know which formats support editing with -sql and which not? I could not find any obvious metadata by checking the capabilities of a few different drivers.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191115/f2811198/attachment.html>

From even.rouault at spatialys.com  Fri Nov 15 03:58:34 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Nov 2019 12:58:34 +0100
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
In-Reply-To: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2457557.HKn7QLEG7f@even-i700>

On vendredi 15 novembre 2019 08:52:48 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> Shapefile can be edited with ogrinfo
> ogrinfo -dialect SQLite -sql "update foo set bar='14'" foo.shp
> 
> GML opens always as read-only with -sql option
> ogrinfo -sql "select * from foo" foo.gml
> Had to open data source read-only.
> INFO: Open of `foo.gml'
>       using driver `GML' successful.
> 
> How can I know which formats support editing with -sql and which not? I
> could not find any obvious metadata by checking the capabilities of a few
> different drivers.

There's indeed no driver-level metadata indicating support for updates (update 
through SQL is just a particular case). With a dataset opened, on a layer, 
with the API you can query for fine grain capabilities with
TestCapability(OLCRandomWrite/OLCDeleteFeature/etc...)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ahmettemiz88 at gmail.com  Fri Nov 15 04:54:36 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Fri, 15 Nov 2019 15:54:36 +0300
Subject: [gdal-dev] extracting a raster data within a polygon?
In-Reply-To: <002001d59ab6$4c2cafa0$e4860ee0$@hyperacktive.com>
References: <CAJKO1YuP8B8tMFzpD14JyB7b7HM4hefXeu7_MzGWz0LzVOGgGQ@mail.gmail.com>
 <002001d59ab6$4c2cafa0$e4860ee0$@hyperacktive.com>
Message-ID: <CAJKO1Ysgs3Aee8tcg0ZP1siGP-z1jMH2zO_JjdPtiws7H2ACrw@mail.gmail.com>

Awesome, thanks!

On Thu, Nov 14, 2019 at 9:39 AM Martin Chapman <mchapman at hyperacktive.com>
wrote:

> Ahmet,
>
>
>
> You can use either the gdalwarp.exe or the underlying gdal warper C++ API
> to create a new image using the polygon geometry as a cutline.  See the
> gdalwarp.exe or gdal warper C++ API documentation on how to do that.
>
>
>
> Basically, the cutline geometry will NULL out any pixels in the output
> image that are not within the polygon geometry.  If you use the
> gdalwarp.exe utility it will output a new image to disk.  If you use the
> gdal warper C++ API then you can write the output image to disk or memory.
> For more information on how this is done programmatically see the source
> code for the gdalwarp.exe that is included with the gdal source code.
>
>
>
> NOTE:  Your cutline geometry needs to be topologically correct in order to
> produce good output.  Topologically correct geometries do not contain
> self-intersections, slivers, etc.  An example of a self-intersecting
> geometry is a bow-tie where two lines in the geometry cross each other.
> Slivers are where two adjacent geometries share an edge but there is a gap
> between the edges.  Lots of shape files contain geometries that are not
> topologically correct because ArcMap and other tools don’t enforce that.
> The warp API can handle polygons and multi-polygons.  If your output comes
> out looking screwed up it is most likely because your cutline geometry is
> not topologically correct OR you didn’t convert the cutline geometry from
> coordinate space to pixel space before feeding it to the warper C++ API (in
> the case you do it programmatically).  The gdalwarp.exe can handle
> geometries in coordinate space.  If by chance your cutline geometry is not
> topologically correct you may be able to fix it by doing a Buffer()
> operation on it using the OGR API with a buffer distance of 0.  GEOS (the
> underlying engine for the OGR buffer operation) will create a new geometry
> that is exactly the same as the input because the buffer distance is zero
> but the GEOS API will attempt to correct the topology of the new geometry.
>
>
>
> Best regards,
>
> Martin Chapman
>
>
>
>
>
>
>
> *From:* gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] *On Behalf Of *Ahmet
> Temiz
> *Sent:* Saturday, November 9, 2019 9:57 AM
> *To:* gdal-dev
> *Subject:* [gdal-dev] extracting a raster data within a polygon?
>
>
>
> Hi,
>
> how I can extract a raster data within a polygon (not a rectangle) using
> C++?
>
> i.e. dem within provincial boundary
>
> Regards
>
> --
>
> Ahmet Temiz
> Jeoloji Müh.
> Afet ve Acil Durum Yönetimi Başkanlığı
> Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu
>
>
> ________________________
>
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
>


-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191115/d4b6732c/attachment-0001.html>

From eadam at co.lincoln.or.us  Fri Nov 15 08:25:38 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 15 Nov 2019 08:25:38 -0800
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
In-Reply-To: <2457557.HKn7QLEG7f@even-i700>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2457557.HKn7QLEG7f@even-i700>
Message-ID: <CACqBkM_MMCcZ7-FXFsFs8mc+Qts2sBSAQwO-scQ+brdS7gqFjw@mail.gmail.com>

On Fri, Nov 15, 2019 at 3:58 AM Even Rouault <even.rouault at spatialys.com> wrote:
>
> On vendredi 15 novembre 2019 08:52:48 CET Rahkonen Jukka (MML) wrote:
> > Hi,
> >
> > Shapefile can be edited with ogrinfo
> > ogrinfo -dialect SQLite -sql "update foo set bar='14'" foo.shp
> >
> > GML opens always as read-only with -sql option
> > ogrinfo -sql "select * from foo" foo.gml
> > Had to open data source read-only.
> > INFO: Open of `foo.gml'
> >       using driver `GML' successful.
> >
> > How can I know which formats support editing with -sql and which not? I
> > could not find any obvious metadata by checking the capabilities of a few
> > different drivers.
>
> There's indeed no driver-level metadata indicating support for updates (update
> through SQL is just a particular case). With a dataset opened, on a layer,
> with the API you can query for fine grain capabilities with
> TestCapability(OLCRandomWrite/OLCDeleteFeature/etc...)

Can this be partly inferred from driver pages with the presence (or
absence) of items?  For instance,
https://gdal.org/drivers/vector/gml.html#driver-capabilities

The old driver pages
(https://web.archive.org/web/20190211030817/https://www.gdal.org/ogr_formats.html)
were tables that very effectively conveyed the capabilities (or
limitations) of the drivers and allowed for scanning for drivers that
had the capabilities that you wanted.  Would a similar table be
possible or desirable?

This got me thinking about the Sphinx migration a bit,
https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050273.html.  It
looks great and the website is easy to use.  Thanks to everyone who
updated that!

There are a few things that might be missing.  The new page has
https://gdal.org/programs/raster_common_options.html#raster-common-options
and https://gdal.org/programs/vector_common_options.html#vector-common-options
I wonder if a list of uncommon options like this would be helpful,
https://trac.osgeo.org/gdal/wiki/ConfigOptions?  Same with some
overview table of driver capabilities?  If it is just a matter of
recreating a new page copied from the old, I would be up trying to
contribute to that.  I lack the detailed knowledge of the drivers to
be able to create it from scratch.

I was also curious to see if the OSGeo technical writing project would
impact any of the documentation.

Best regards, Eli






>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Nov 15 09:03:07 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Nov 2019 18:03:07 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <6265eec1-7ae8-a36e-4f36-ba9f104d56e7@xs4all.nl>
References: <4509893.ddkccIuGDM@even-i700>
 <6265eec1-7ae8-a36e-4f36-ba9f104d56e7@xs4all.nl>
Message-ID: <4670062.iUf7AHNAqO@even-i700>

I declare the motion passed with the following votes from PSC members:
+1 from EvenR, JukkaR, MateuzL, DanielM
-0 from SeanG
+0 from HowardB

Even

> Even,
> 
> Great!
> Of course my +1
> 
> MArco
> 
> On 13-11-19 15:22, Even Rouault wrote:
> > Hi,
> > 
> > I've updated both the RFC text and candidate implementation with the
> > provided comments, so I think we are now good to vote on it.
> > 
> > ~~~~~~
> > 
> > Motion: adopt RFC 76 OGR Python drivers:
> > https://github.com/OSGeo/gdal/blob/7b7ecbab1e2b10ecab24e5126d94469d2d4efdc
> > 9/gdal/doc/source/development/rfc/rfc76_ogrpythondrivers.rst
> > 
> > ~~~~~~
> > 
> > Starting with my +1,
> > 
> > Even
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 15 09:55:04 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Nov 2019 18:55:04 +0100
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
In-Reply-To: <CACqBkM_MMCcZ7-FXFsFs8mc+Qts2sBSAQwO-scQ+brdS7gqFjw@mail.gmail.com>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2457557.HKn7QLEG7f@even-i700>
 <CACqBkM_MMCcZ7-FXFsFs8mc+Qts2sBSAQwO-scQ+brdS7gqFjw@mail.gmail.com>
Message-ID: <2190558.rXhUX7LAVk@even-i700>

> Can this be partly inferred from driver pages with the presence (or
> absence) of items?  For instance,
> https://gdal.org/drivers/vector/gml.html#driver-capabilities

Not really. They are only high level capabilities. Vector editing capabilities 
are not reported in driver pages

> The old driver pages
> (https://web.archive.org/web/20190211030817/https://www.gdal.org/ogr_formats
> .html) were tables that very effectively conveyed the capabilities (or
> limitations) of the drivers and allowed for scanning for drivers that
> had the capabilities that you wanted.

The information in individual pages is roughly the same as in the global 
table.

> Would a similar table be possible or desirable?

A few people have indeed noted the absence of the table. Not sure if this is 
usual "resistance to change" phenomenon or if there is there really a strong 
use case for "I don't want which format to use: let's look at the summary page 
to select one". 

If so, then yes if someone contributes it, that'd be welcome. However I think 
we'd want it to be generated from a Python script from the individual .rst 
pages, by parsing the directives like ".. supports_create::" that are in those 
.rst files. That way that would make maintainance of the summary easier (and 
initial version less tidious that doing that manually)

> There are a few things that might be missing.  The new page has
> https://gdal.org/programs/raster_common_options.html#raster-common-options
> and
> https://gdal.org/programs/vector_common_options.html#vector-common-options
> I wonder if a list of uncommon options like this would be helpful,
> https://trac.osgeo.org/gdal/wiki/ConfigOptions? 

Migrating the wiki page to the doc could be useful. My own opinion is that 
driver specific configuration options should be documented in the driver 
specific page, rather than in a global config option page. Same with /vsi 
specific options that should go to
https://gdal.org/user/virtual_file_systems.html if not already there. 

Or if a global list is needed, I'd say a bit the same as for driver summaries, 
have a way to compile the list of options from .rst files where they would be 
mention and link from the summary to the actual page. But we don't have 
currently any explicit directive for configuration options.

> I was also curious to see if the OSGeo technical writing project would
> impact any of the documentation.

There was initial discussion but no follow-up as far as GDAL is concerned.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matt.gregory at oregonstate.edu  Fri Nov 15 10:00:16 2019
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Fri, 15 Nov 2019 18:00:16 +0000
Subject: [gdal-dev] Source pixels used when warping using cubic
	resampling
In-Reply-To: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>
References: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>
Message-ID: <7C48E40C135D314BA03D6471A6E389780157564474@ex5.oregonstate.edu>

Hi again,

My apologies for bumping this thread, but this issue is still impacting my workflow.  I'd be happy to post rasters demonstrating this if it would be useful.

thanks, matt

-----------------------

Hi all,

I am warping and upsampling an image from 4km to 30m using cubic resampling.  I've been warping different sized windows from the source image like this:

# Larger window
gdalwarp
  -t_srs EPSG:5070
  -te -2303985 2406015 -2033985 2649015
  -tr 30 30
  -of GTiff
  -r cubic
  in.vrt
  out.tif

# Single line of above window
gdalwarp
  -t_srs EPSG:5070
  -te -2303985 2648985 -2033985 2649015
  -tr 30 30
  -of GTiff
  -r cubic
  in.vrt
  line.tif

Naively, my expectation was that the overlap region would have identical values, but they don't.  I assume this means that the source (4km) pixels are being subset down to a smaller window before warping in the latter case that don't necessarily include the same 16 nearest pixels as in the first case?  I had a brief look through the Warp API tutorial and it looks like it may have something to do with the GDALSuggestedWarpOutput, but I didn't dig too deeply there.  

Is there a recommended workflow if you want to warp and resample destination rasters by blocks rather than the full extent at once?

Thanks for advice,
matt
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov 15 10:06:03 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 15 Nov 2019 18:06:03 +0000
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
Message-ID: <83540930566d43269d820e4fb337555c@C119S212VM042.msvyvi.vaha.local>

Hi,

Two most often needed items from the old format list for me as a community helper were "Creation" to answer "Why gdalwarp to format x fails" and "Compiled by default" to answer "Why everything with my GDAL to format x fails". The list was useful.

-Jukka- 

-----Alkuperäinen viesti-----
Lähettäjä: Even Rouault <even.rouault at spatialys.com> 
Lähetetty: perjantai 15. marraskuuta 2019 19.55
Vastaanottaja: eadam at co.lincoln.or.us
Kopio: gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] How to know which formats allow editing with ogrinfo?

> Can this be partly inferred from driver pages with the presence (or
> absence) of items?  For instance,
> https://gdal.org/drivers/vector/gml.html#driver-capabilities

Not really. They are only high level capabilities. Vector editing capabilities are not reported in driver pages

> The old driver pages
> (https://web.archive.org/web/20190211030817/https://www.gdal.org/ogr_f
> ormats
> .html) were tables that very effectively conveyed the capabilities (or
> limitations) of the drivers and allowed for scanning for drivers that 
> had the capabilities that you wanted.

The information in individual pages is roughly the same as in the global table.

> Would a similar table be possible or desirable?

A few people have indeed noted the absence of the table. Not sure if this is usual "resistance to change" phenomenon or if there is there really a strong use case for "I don't want which format to use: let's look at the summary page to select one". 

If so, then yes if someone contributes it, that'd be welcome. However I think we'd want it to be generated from a Python script from the individual .rst pages, by parsing the directives like ".. supports_create::" that are in those .rst files. That way that would make maintainance of the summary easier (and initial version less tidious that doing that manually)

> There are a few things that might be missing.  The new page has 
> https://gdal.org/programs/raster_common_options.html#raster-common-opt
> ions
> and
> https://gdal.org/programs/vector_common_options.html#vector-common-opt
> ions I wonder if a list of uncommon options like this would be 
> helpful, https://trac.osgeo.org/gdal/wiki/ConfigOptions?

Migrating the wiki page to the doc could be useful. My own opinion is that driver specific configuration options should be documented in the driver specific page, rather than in a global config option page. Same with /vsi specific options that should go to https://gdal.org/user/virtual_file_systems.html if not already there. 

Or if a global list is needed, I'd say a bit the same as for driver summaries, have a way to compile the list of options from .rst files where they would be mention and link from the summary to the actual page. But we don't have currently any explicit directive for configuration options.

> I was also curious to see if the OSGeo technical writing project would 
> impact any of the documentation.

There was initial discussion but no follow-up as far as GDAL is concerned.

Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 15 10:37:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Nov 2019 19:37:53 +0100
Subject: [gdal-dev] Source pixels used when warping using cubic
	resampling
In-Reply-To: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>
References: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>
Message-ID: <15002720.Wa3e1pelJy@even-i700>

On vendredi 25 octobre 2019 16:02:57 CET Gregory, Matthew wrote:
> Hi all,
> 
> I am warping and upsampling an image from 4km to 30m using cubic resampling.
>  I've been warping different sized windows from the source image like this:
> 
> # Larger window
> gdalwarp
>   -t_srs EPSG:5070
>   -te -2303985 2406015 -2033985 2649015
>   -tr 30 30
>   -of GTiff
>   -r cubic
>   in.vrt
>   out.tif
> 
> # Single line of above window
> gdalwarp
>   -t_srs EPSG:5070
>   -te -2303985 2648985 -2033985 2649015
>   -tr 30 30
>   -of GTiff
>   -r cubic
>   in.vrt
>   line.tif
> 
> Naively, my expectation was that the overlap region would have identical
> values, but they don't.  I assume this means that the source (4km) pixels
> are being subset down to a smaller window before warping in the latter case
> that don't necessarily include the same 16 nearest pixels as in the first
> case?  I had a brief look through the Warp API tutorial and it looks like
> it may have something to do with the GDALSuggestedWarpOutput, but I didn't
> dig too deeply there.

maybe try to add

-et 0

and/or

-wo XSCALE=133.33333333333334 -wo YSCALE=133.33333333333334

where 133.3333 = 4000 / 30

XSCALE/YSCALE are "un-documented" there:
https://github.com/OSGeo/gdal/blob/master/gdal/alg/gdalwarpkernel.cpp#L1120


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 15 11:16:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 Nov 2019 20:16:28 +0100
Subject: [gdal-dev] Extracting Subsampled Mask Band from VRT Returning
	1st Band Rather Than Mask Band
In-Reply-To: <CADXYQQ4GspVBdmPKJTvHtWt-G_5CmZEJSYw8sNoPY8t96gBm=g@mail.gmail.com>
References: <CADXYQQ4GspVBdmPKJTvHtWt-G_5CmZEJSYw8sNoPY8t96gBm=g@mail.gmail.com>
Message-ID: <2755629.ZYzQjT27L4@even-i700>

On mercredi 15 mai 2019 11:17:57 CET Patrick Young wrote:
> Hi all,
> 
> I'm experiencing some strange behavior when extracting a mask band using
> gdal_translate from a VRT vs the source GTiff at a reduced resolution.  I
> have a 3 band, 8 bit JPEG compressed (YCbCR) RGB geotiff with an internal
> no data mask and with internal overviews.  Making a VRT of this and running
> 
> gdal_translate -b mask in.vrt mask.tif
> 
> 
> Returns the expected no data mask.
> 
> However, if I add in "-outsize 10% 0", I instead get the first band back as
> the mask tif rather than the mask band.  Any -outsize setting has the same
> effect.
> 
> Repeating this with the source geotiff rather than the vrt works as
> expected.

For the record, the above issue has been fixed per
https://github.com/OSGeo/gdal/pull/2018

> Interestingly, running
> 
> gdalinfo -oo OVERVIEW_LEVEL=1 in.vrt
> 
> reports no mask flags set at all (they are reported without the -oo
> option), but running on the original geotiff rather than the vrt does
> report the mask flags.
> 

And this point about -oo OVERVIEW_LEVEL is addressed per
https://github.com/OSGeo/gdal/pull/2021

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From eadam at co.lincoln.or.us  Fri Nov 15 13:34:38 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Fri, 15 Nov 2019 13:34:38 -0800
Subject: [gdal-dev] How to know which formats allow editing with ogrinfo?
In-Reply-To: <2190558.rXhUX7LAVk@even-i700>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2457557.HKn7QLEG7f@even-i700>
 <CACqBkM_MMCcZ7-FXFsFs8mc+Qts2sBSAQwO-scQ+brdS7gqFjw@mail.gmail.com>
 <2190558.rXhUX7LAVk@even-i700>
Message-ID: <CACqBkM_y7VEvL5a79vrCbxTCMg0ZqVuiGLKMNbf2YXjhqN5OvQ@mail.gmail.com>

On Fri, Nov 15, 2019 at 9:55 AM Even Rouault <even.rouault at spatialys.com> wrote:
>
> > The old driver pages
> > (https://web.archive.org/web/20190211030817/https://www.gdal.org/ogr_formats
> > .html) were tables that very effectively conveyed the capabilities (or
> > limitations) of the drivers and allowed for scanning for drivers that
> > had the capabilities that you wanted.
>
> The information in individual pages is roughly the same as in the global
> table.
>
> > Would a similar table be possible or desirable?
>
> A few people have indeed noted the absence of the table. Not sure if this is
> usual "resistance to change" phenomenon or if there is there really a strong
> use case for "I don't want which format to use: let's look at the summary page
> to select one".

I've certainly found myself shopping for a format with that table.
Usually some middle format in an ETL toolchain, sometimes complicated
by cross platform considerations for driver availability.

>
> If so, then yes if someone contributes it, that'd be welcome. However I think
> we'd want it to be generated from a Python script from the individual .rst
> pages, by parsing the directives like ".. supports_create::" that are in those
> .rst files. That way that would make maintainance of the summary easier (and
> initial version less tidious that doing that manually)

Contributing it as a python script is an opportunity for someone other
than me.
>
> > There are a few things that might be missing.  The new page has
> > https://gdal.org/programs/raster_common_options.html#raster-common-options
> > and
> > https://gdal.org/programs/vector_common_options.html#vector-common-options
> > I wonder if a list of uncommon options like this would be helpful,
> > https://trac.osgeo.org/gdal/wiki/ConfigOptions?
>
> Migrating the wiki page to the doc could be useful. My own opinion is that
> driver specific configuration options should be documented in the driver
> specific page, rather than in a global config option page. Same with /vsi

I'll try moving some of these over and see how it goes.

> specific options that should go to
> https://gdal.org/user/virtual_file_systems.html if not already there.
>
> Or if a global list is needed, I'd say a bit the same as for driver summaries,
> have a way to compile the list of options from .rst files where they would be
> mention and link from the summary to the actual page. But we don't have
> currently any explicit directive for configuration options.

I'll start with driver specific.

Thanks, Eli

>
> > I was also curious to see if the OSGeo technical writing project would
> > impact any of the documentation.
>
> There was initial discussion but no follow-up as far as GDAL is concerned.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From matt.gregory at oregonstate.edu  Fri Nov 15 17:01:36 2019
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Sat, 16 Nov 2019 01:01:36 +0000
Subject: [gdal-dev] Source pixels used when warping using cubic
 resampling
In-Reply-To: <15002720.Wa3e1pelJy@even-i700>
References: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>
 <15002720.Wa3e1pelJy@even-i700>
Message-ID: <7C48E40C135D314BA03D6471A6E389780157565310@ex5.oregonstate.edu>

Hi Even,

Even Rouault wrote:
> > Hi all,
> > 
> > I am warping and upsampling an image from 4km to 30m using cubic resampling.
> >  I've been warping different sized windows from the source image like this:
> > 
> > [snip]
>
> maybe try to add
> 
> -et 0
> 
> and/or
> 
> -wo XSCALE=133.33333333333334 -wo YSCALE=133.33333333333334
> 
> where 133.3333 = 4000 / 30
> 
> XSCALE/YSCALE are "un-documented" there:
> https://github.com/OSGeo/gdal/blob/master/gdal/alg/gdalwarpkernel.cpp#L1120

Wow, thanks for this - would have never figured this out on my own.  For me, both -et and the two -wo flags were necessary to make the reprojections from the full window and the row be equivalent. 

Using the -wo flags on their own gets pretty close (~0.5% percent difference in pixel values in my test), but -et on its own was still substantially different (~7% percent differences in pixel values).

thanks, matt

From even.rouault at spatialys.com  Sat Nov 16 09:12:38 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 Nov 2019 18:12:38 +0100
Subject: [gdal-dev] Doc: driver + config options summary pages [was Re: How
	to know which formats allow editing with ogrinfo?]
In-Reply-To: <CACqBkM_y7VEvL5a79vrCbxTCMg0ZqVuiGLKMNbf2YXjhqN5OvQ@mail.gmail.com>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2190558.rXhUX7LAVk@even-i700>
 <CACqBkM_y7VEvL5a79vrCbxTCMg0ZqVuiGLKMNbf2YXjhqN5OvQ@mail.gmail.com>
Message-ID: <2278378.5otQQL0sNr@even-i700>

> > If so, then yes if someone contributes it, that'd be welcome. However I
> > think we'd want it to be generated from a Python script from the
> > individual .rst pages, by parsing the directives like "..
> > supports_create::" that are in those .rst files. That way that would make
> > maintainance of the summary easier (and initial version less tidious that
> > doing that manually)

OK, so I've added two new directives

.. built_in_by_default::

or

.. build_dependencies:: put here dependencies name

and just used them on a couple drivers for demo:
https://github.com/OSGeo/gdal/commit/0b3b1ed25bdde6f49a6515e0431d78bc9729ff83

A script that fetches all the information from individual pages
is run automatically at each documentation build and generates a summary table 
at
https://gdal.org/drivers/raster/index.html
https://gdal.org/drivers/vector/index.html

==> What remains to be done is to go through all driver .rst pages and add
.. built_in_by_default:: or .. build_dependencies:: where appropriate so that 
no "???" remains

Volunteers ?

> > Migrating the wiki page to the doc could be useful. My own opinion is that
> > driver specific configuration options should be documented in the driver
> > specific page, rather than in a global config option page. Same with /vsi

I've also added a specific role when you use a configuration option

:decl_configoption:`FOO`

Example of use:

https://github.com/OSGeo/gdal/commit/c8fcb6d941c0251219dbd57f701e5b161ce5085e

Similarly to the driver list, a script is run at each build to generate an 
index of declared configuration options (if several pages declare the same 
config option, several links will be created). The result is there:

https://gdal.org/user/configoptions_index.html

==> What remains to be done is tag appropriately configuration options 
wherever they are already mentionned and add missing ones.

Volunteers ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew at aitchison.me.uk  Sat Nov 16 09:31:15 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Sat, 16 Nov 2019 17:31:15 +0000 (GMT)
Subject: [gdal-dev] Doc: driver + config options summary pages [was Re:
 How to know which formats allow editing with ogrinfo?]
In-Reply-To: <2278378.5otQQL0sNr@even-i700>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2190558.rXhUX7LAVk@even-i700>
 <CACqBkM_y7VEvL5a79vrCbxTCMg0ZqVuiGLKMNbf2YXjhqN5OvQ@mail.gmail.com>
 <2278378.5otQQL0sNr@even-i700>
Message-ID: <alpine.DEB.2.21.1911161723020.1114@warden.aitchison.me.uk>

On Sat, 16 Nov 2019, Even Rouault wrote:

>>> If so, then yes if someone contributes it, that'd be welcome. However I
>>> think we'd want it to be generated from a Python script from the
>>> individual .rst pages, by parsing the directives like "..
>>> supports_create::" that are in those .rst files. That way that would make
>>> maintainance of the summary easier (and initial version less tidious that
>>> doing that manually)
>
> OK, so I've added two new directives
>
> .. built_in_by_default::
>
> or
>
> .. build_dependencies:: put here dependencies name
>
> and just used them on a couple drivers for demo:
> https://github.com/OSGeo/gdal/commit/0b3b1ed25bdde6f49a6515e0431d78bc9729ff83
>
> A script that fetches all the information from individual pages
> is run automatically at each documentation build and generates a summary table
> at
> https://gdal.org/drivers/raster/index.html
> https://gdal.org/drivers/vector/index.html

Thanks.

The summary table will need some styling.
At the moment I only see the short and and long name columns.
*If* I scroll down to the bottom, then I get a horizontal scroll bar
and can scroll to see that there are more columns.

I get this with Firefox and Opera on Linux and Firefox and IE11 on Win7
(yes I need to get a newer windows virtual machine).

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From even.rouault at spatialys.com  Sat Nov 16 09:50:47 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 Nov 2019 18:50:47 +0100
Subject: [gdal-dev] Doc: driver + config options summary pages [was Re:
	How to know which formats allow editing with ogrinfo?]
In-Reply-To: <alpine.DEB.2.21.1911161723020.1114@warden.aitchison.me.uk>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2278378.5otQQL0sNr@even-i700>
 <alpine.DEB.2.21.1911161723020.1114@warden.aitchison.me.uk>
Message-ID: <2175726.Fl7q2tEQCN@even-i700>

> The summary table will need some styling.
> At the moment I only see the short and and long name columns.
> *If* I scroll down to the bottom, then I get a horizontal scroll bar
> and can scroll to see that there are more columns.
> 
> I get this with Firefox and Opera on Linux and Firefox and IE11 on Win7
> (yes I need to get a newer windows virtual machine).

Hum, displays correctly for me on
- Linux, Firefox 70.0.1
- Linux, Chromium 78.0.3904.97
- W10, Edge 44.18362.449.0
with browser in full width.

If I reduce the width, I also have the scroll bar.

The table is created there:
https://github.com/OSGeo/gdal/blob/master/gdal/doc/source/build_driver_summary.py#L67

and that generates the following HTML:
<colgroup>
<col style="width: 10%" />
<col style="width: 35%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 25%" />
</colgroup>

We'd probably need help from a Sphinx and/or CSS expert to improve that...
But if the width is too small, reducing the column width could make things unreadable,
so having at least the short and long name in reduced page width seems a
reasonable fallback behaviour.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From szekerest at gmail.com  Sun Nov 17 12:24:26 2019
From: szekerest at gmail.com (Tamas Szekeres)
Date: Sun, 17 Nov 2019 21:24:26 +0100
Subject: [gdal-dev] using gdal_viewshed
In-Reply-To: <CACALY+RuA2v-KUiYk_1iQwq5DFbSoKDCPrs_J_mJ1Bg9spn_KQ@mail.gmail.com>
References: <CALFWR8FEvuGPjGPF=hNLOXFFHjX8pdUEysNUsQmqExjAU9QhSg@mail.gmail.com>
 <CACqBkM8LqS29O0D5FbMzPfM7eH0S=bqkAD0iT_keGcoPQJajvg@mail.gmail.com>
 <CACALY+RuA2v-KUiYk_1iQwq5DFbSoKDCPrs_J_mJ1Bg9spn_KQ@mail.gmail.com>
Message-ID: <CACALY+RDUv8sXS9K4pN9O5K-5oy02UZUzdNFZnnDNa1qDC36OA@mail.gmail.com>

The fix has now been committed to GDAL/master

Tamas

Tamas Szekeres <szekerest at gmail.com> ezt írta (időpont: 2019. nov. 12., K,
22:37):

> I've recently fixed the implementation in my local version causing a
> similar issue (RasterIO error when writing target raster), where the given
> maxdistance setting would produce an empty row at the top or the bottom of
> the result image.
> I'll prepare a fix in gdal in the next few days and let us see if that
> fixes this issue as well.
>
> Best regards,
>
> Tamas
>
>
> Eli Adam <eadam at co.lincoln.or.us> ezt írta (időpont: 2019. nov. 12., K,
> 22:26):
>
>> Hi Ben,
>>
>> On Sun, Nov 10, 2019 at 3:57 AM Ben Avrahami <avrahami.ben at gmail.com>
>> wrote:
>> >
>> > Hello all, I've been trying trying to use the newest gdal_viewshed in
>> gdal-dev release, and I've run into an error I can't quite understand.
>> >
>> > The input I've been using is:
>> >
>> >     gdal_viewshed -md 1000 -ox "691868.511" -oy "3492031.487" <input
>> tiff> <output tiff>
>>
>> It might be helpful to copy and paste your command so if there are
>> typos or otherwise, they can be spotted.
>>
>> A gdalinfo report on your input file could also be helpful.  That
>> would show coordinates of the image and allow looking at things like
>> are those coordinates within the image?  Is it in the coordinate
>> system of the image?  A gdalinfo report details that nicely.
>>
>> >
>> > And I get the response:
>> >
>> >     ERROR 5: C:\temp\files\out.tif, band 1: Access window out of range
>> in RasterIO().  Requested
>> >     (0,-1) of size 67x1 on raster of 67x67.
>> >     ERROR 1: RasterIO error when writing target raster
>>
>> This makes it seem like something isn't lining up correctly.  With the
>> absence of information some random guess include: that the coordinate
>> is not within the image, or perhaps the coordinate is less than -md
>> 1000 units from the edge (although testing that on other data here
>> worked fine), that there are pixel alignment/resolution issues and
>> using coordinates not to three decimal places would work better.
>>
>> I see that gdal_viewshed -md 900 -ox 985710 -oy 658590
>> http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
>> output2.tif works
>>
>> and
>>
>> gdal_viewshed -md 800 -ox 985710 -oy 658590
>> http://download.osgeo.org/gdal/data/aaigrid/095b_dem_90m.asc
>> output3.tif fails with the error:
>>
>> 0ERROR 5: output3.tif, band 1: Access window out of range in
>> RasterIO().  Requested
>> (0,-1) of size 19x1 on raster of 19x19.
>> ERROR 1: RasterIO error when writing target raster
>>
>> it seems that -md must be a multiple of the resolution.
>>
>> Best regards, Eli
>>
>> >
>> > I get a similar error if I try to use the GDALViewshedGenerate C-API
>> function. The input us a valid WGS84-UTM tiff file, and the output is a
>> valid path, but the file does not actually exist until I run the command.
>> After I run the command, the output file is created but only filled
>> halfway. Any help at wall would be appreciated.
>> >
>> > regards, Ben
>> > _______________________________________________
>> > gdal-dev mailing list
>> > gdal-dev at lists.osgeo.org
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191117/fe33c04e/attachment.html>

From eadam at co.lincoln.or.us  Sun Nov 17 17:42:10 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Sun, 17 Nov 2019 17:42:10 -0800
Subject: [gdal-dev] Doc: driver + config options summary pages [was Re:
 How to know which formats allow editing with ogrinfo?]
In-Reply-To: <2278378.5otQQL0sNr@even-i700>
References: <e30ffdea7e69410dbd530717d7bea7d3@C119S212VM042.msvyvi.vaha.local>
 <2190558.rXhUX7LAVk@even-i700>
 <CACqBkM_y7VEvL5a79vrCbxTCMg0ZqVuiGLKMNbf2YXjhqN5OvQ@mail.gmail.com>
 <2278378.5otQQL0sNr@even-i700>
Message-ID: <CACqBkM_Qjuq6YSrR4S=WsHytC1irvANX+KU713Z5KUGRwm3A-g@mail.gmail.com>

On Sat, Nov 16, 2019 at 9:12 AM Even Rouault <even.rouault at spatialys.com> wrote:
>
> > > If so, then yes if someone contributes it, that'd be welcome. However I
> > > think we'd want it to be generated from a Python script from the
> > > individual .rst pages, by parsing the directives like "..
> > > supports_create::" that are in those .rst files. That way that would make
> > > maintainance of the summary easier (and initial version less tidious that
> > > doing that manually)
>
> OK, so I've added two new directives
>
> .. built_in_by_default::
>
> or
>
> .. build_dependencies:: put here dependencies name
>
> and just used them on a couple drivers for demo:
> https://github.com/OSGeo/gdal/commit/0b3b1ed25bdde6f49a6515e0431d78bc9729ff83
>
> A script that fetches all the information from individual pages
> is run automatically at each documentation build and generates a summary table
> at
> https://gdal.org/drivers/raster/index.html
> https://gdal.org/drivers/vector/index.html
>
> ==> What remains to be done is to go through all driver .rst pages and add
> .. built_in_by_default:: or .. build_dependencies:: where appropriate so that
> no "???" remains
>
> Volunteers ?

If the old table is a reliable source, I can do a good portion of them.

>
> > > Migrating the wiki page to the doc could be useful. My own opinion is that
> > > driver specific configuration options should be documented in the driver
> > > specific page, rather than in a global config option page. Same with /vsi
>
> I've also added a specific role when you use a configuration option
>
> :decl_configoption:`FOO`
>
> Example of use:
>
> https://github.com/OSGeo/gdal/commit/c8fcb6d941c0251219dbd57f701e5b161ce5085e
>
> Similarly to the driver list, a script is run at each build to generate an
> index of declared configuration options (if several pages declare the same
> config option, several links will be created). The result is there:
>
> https://gdal.org/user/configoptions_index.html
>
> ==> What remains to be done is tag appropriately configuration options
> wherever they are already mentionned and add missing ones.
>
> Volunteers ?

I can work on some already mentioned ones.

Thanks for adding this.

Best regards, Eli

>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov 18 15:14:36 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Nov 2019 00:14:36 +0100
Subject: [gdal-dev] Motion: adopt RFC 76 OGR Python drivers
In-Reply-To: <4670062.iUf7AHNAqO@even-i700>
References: <4509893.ddkccIuGDM@even-i700>
 <6265eec1-7ae8-a36e-4f36-ba9f104d56e7@xs4all.nl>
 <4670062.iUf7AHNAqO@even-i700>
Message-ID: <8957596.pYBE0I3rnp@even-i700>

On vendredi 15 novembre 2019 18:03:07 CET Even Rouault wrote:
> I declare the motion passed with the following votes from PSC members:
> +1 from EvenR, JukkaR, MateuzL, DanielM
> -0 from SeanG
> +0 from HowardB

RFC76 implementation is now available in master

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From careyshan at gmail.com  Tue Nov 19 01:30:24 2019
From: careyshan at gmail.com (Shane Carey)
Date: Tue, 19 Nov 2019 09:30:24 +0000
Subject: [gdal-dev] gdal setup c++
Message-ID: <CA+jRDxDiOEzpCMQcTPEvJAo-b+LkH2W+duB32yPGzeeGFZgDCw@mail.gmail.com>

Hi,

I'm trying to get started with c++ dev and gdal with codelite.
I downloaded the zip:
http://download.osgeo.org/gdal/3.0.2/gdal302.zip
and then extracted it and setup my links as follows:
compiler: /home/shane/cPlus/gdal3.0.2
Linker: /home/shane/cPlus/gdal3.0.2

However when I go to build a very simple program:

#include <iostream>
#include <alg/gdal_alg.h>

int main(){
int favourite_number;
    std::cout << "Enter a number between 1 and 100:";
    std::cin >> favourite_number;
    std::cout << "Amazing, mine too " << std::endl;
return 0;
}

I get an error:
No such file or directory: alg/gdal_alg.h
How do I link it properly?
Thanks
Le gach dea ghui,
*Shane Carey*
*GIS and Data Solutions Consultant*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/c85a7303/attachment.html>

From mateusz at loskot.net  Tue Nov 19 01:36:34 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 19 Nov 2019 10:36:34 +0100
Subject: [gdal-dev] gdal setup c++
In-Reply-To: <CA+jRDxDiOEzpCMQcTPEvJAo-b+LkH2W+duB32yPGzeeGFZgDCw@mail.gmail.com>
References: <CA+jRDxDiOEzpCMQcTPEvJAo-b+LkH2W+duB32yPGzeeGFZgDCw@mail.gmail.com>
Message-ID: <CABUeae9z86j3nDa=qf2BKmnocmZzv5MtOV9xyJBZU32SprK=7A@mail.gmail.com>

On Tue, 19 Nov 2019 at 10:30, Shane Carey <careyshan at gmail.com> wrote:
>
> Hi,
>
> I'm trying to get started with c++ dev and gdal with codelite.
> I downloaded the zip:
> http://download.osgeo.org/gdal/3.0.2/gdal302.zip
> and then extracted it and setup my links as follows:
> compiler: /home/shane/cPlus/gdal3.0.2
> Linker: /home/shane/cPlus/gdal3.0.2
>
> However when I go to build a very simple program:
>
> #include <iostream>
> #include <alg/gdal_alg.h>
>
> int main(){
> int favourite_number;
>     std::cout << "Enter a number between 1 and 100:";
>     std::cin >> favourite_number;
>     std::cout << "Amazing, mine too " << std::endl;
> return 0;
> }
>
> I get an error:
> No such file or directory: alg/gdal_alg.h
> How do I link it properly?

By reading documentation of the IDE of your choice
and learning how to add include directories,
and others to set up buildable project for it.

This mailing list does not offer support on how to use IDEs.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From a.neumann at carto.net  Tue Nov 19 04:41:20 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Tue, 19 Nov 2019 13:41:20 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
Message-ID: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>

Hi, 

I am trying to compile gdal3.0.2 against proj6 - but have problems. 

Proj6 compile worked fine and I installed in /usr/local 

The configure command for gdal is: 

./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes
--with-spatialite=yes

The last part of the compile output is: 

------------------------ 

/bin/bash /home/bjsvwneu/dev/gdal-3.0.2/libtool --mode=compile --silent
--tag=CXX g++ -I/home/bjsvwneu/dev/gdal-3.0.2/port
-I/home/bjsvwneu/dev/gdal-3.0.2/gcore
-I/home/bjsvwneu/dev/gdal-3.0.2/alg -I/home/bjsvwneu/dev/gdal-3.0.2/ogr
-I/home/bjsvwneu/dev/gdal-3.0.2/ogr/og
rsf_frmts -I/home/bjsvwneu/dev/gdal-3.0.2/gnm
-I/home/bjsvwneu/dev/gdal-3.0.2/apps -DHAVE_AVX_AT_COMPILE_TIME
-DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall
-Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security
-Wno-format-nonlite
ral -Wlogical-op -Wshadow -Werror=vla -Wdate-time -Wnull-dereference
-Wduplicated-cond -Wfloat-conversion -Wmissing-declarations
-Wnon-virtual-dtor -Woverloaded-virtual -fno-operator-names
-Wzero-as-null-pointer-constant -Wsuggest-override
-Wimplicit-fallthrough  -I/home
/bjsvwneu/dev/gdal-3.0.2/frmts/vrt -DGNM_ENABLED
-I/home/bjsvwneu/dev/gdal-3.0.2/port -I/usr/include/openjpeg-2.3
-I/usr/include  -DGDAL_COMPILATION -DHAVE_XERCES -I/usr/include
-I/usr/include/xercesc -I/home/bjsvwneu/dev/gdal-3.0.2/port
-I/usr/include/openjpeg-2.3 -I/us
r/include  -DGDAL_COMPILATION -I/usr/include/json-c
-I/home/bjsvwneu/dev/gdal-3.0.2/ogr/ogrsf_frmts/geojson
-I/home/bjsvwneu/dev/gdal-3.0.2/ogr/ogrsf_frmts/generic
-I/home/bjsvwneu/dev/gdal-3.0.2/gnm -DHAVE_GEOS=1 -I/usr/include -c -o
gdalinfo_bin.lo gdalinfo_bin.cpp 
/home/bjsvwneu/dev/gdal-3.0.2/libtool: line 1765: warning: setlocale:
LC_COLLATE: cannot change locale (de_CH.UTF-8) 
/home/bjsvwneu/dev/gdal-3.0.2/libtool: line 1765: warning: setlocale:
LC_COLLATE: cannot change locale (de_CH.UTF-8) 
/bin/bash /home/bjsvwneu/dev/gdal-3.0.2/libtool --mode=link --silent g++
 gdalinfo_bin.lo  /home/bjsvwneu/dev/gdal-3.0.2/libgdal.la  -o gdalinfo 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_alter_name' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_i' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_miller_cylindrical' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_trans_generic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_oblique_stereographic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_i' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_get_geodetic_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_as_wkt' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_projected_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_area_of_use' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_compound_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_hotine_oblique_mercator_two_point_natural_origin'

/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_grid_info' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_transverse_mercator' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_cs_get_type' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_errno_string' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_utm' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_info' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_iii' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_equidistant_conic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_coordoperation_get_method_info' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_mercator_variant_a' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_non_deprecated' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_international_map_world_polyconic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_azimuthal_equidistant' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_create_bound_crs_to_WGS84' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_geostationary_satellite_sweep_y' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_vi' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_geographic_crs_from_datum' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_two_point_equidistant' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_iii' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_ellipsoidal_2D_cs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_context_use_proj4_init_rules' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_sinusoidal' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_goode_homolosine' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_v' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_identify' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_quadrilateralized_spherical_cube' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_trans' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_cartesian_2D_cs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_transverse_mercator_south_oriented' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_engineering_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_hotine_oblique_mercator_variant_a' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_operations' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_operation_factory_context_set_area_of_interest' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_orthographic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_iv' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_list_get_count' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_context_set_search_paths' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_from_name' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_ellipsoid_get_parameters' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_ii' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_albers_equal_area' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_polar_stereographic_variant_a' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_vii' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_alter_cs_linear_unit' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_lambert_conic_conformal_2sp_belgium' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_stereographic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_mercator_variant_b' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_context_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_crs_info_list_from_database' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_source_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_van_der_grinten' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_robinson' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_context_errno' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_new_zealand_mapping_grid' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_ellipsoid' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_is_deprecated' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_prime_meridian_get_parameters' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_gnomonic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_mollweide' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_coordoperation_get_towgs84_values' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_alter_parameters_linear_unit' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_gauss_schreiber_transverse_mercator' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_transformation' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_codes_from_database' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_laborde_oblique_mercator' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_get_datum' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_iv' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_lambert_cylindrical_equal_area' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_type' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_geocentric_crs_from_datum' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_int_list_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_eckert_ii' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_list_get' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_assign_context' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_query_geodetic_crs_from_datum' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_alter_cs_angular_unit' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_convert_conversion_to_other_method' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_geographic_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_clone' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_is_equivalent_to' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_id_code' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_lambert_azimuthal_equal_area' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_log_func' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_create_bound_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_cs_get_axis_count' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_authorities_from_database' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_name' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_gall' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_krovak_north_oriented' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_cassini_soldner' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_info_list_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_spherical_cross_track_height' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_get_coordoperation' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_lambert_conic_conformal_1sp' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_as_proj_string' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_geocentric_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_from_wkt' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_coordoperation_get_param' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_cs_get_axis_info' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_target_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_uom_get_info_from_database' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_operation_factory_context_set_grid_availability_use' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_operation_factory_context' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_list_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_interrupted_goode_homolosine' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_hotine_oblique_mercator_variant_b' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_prime_meridian' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_polar_stereographic_variant_b' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_american_polyconic' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_string_list_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_operation_factory_context_set_spatial_criterion' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_v' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_operation_factory_context_destroy' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_vertical_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_bonne' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_crs_to_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_lambert_conic_conformal_2sp' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_alter_geodetic_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_get_id_auth_name' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_alter_id' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_tunisia_mapping_grid' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_equidistant_cylindrical' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_from_database' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_context_create' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_get_sub_crs' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_crs_get_coordinate_system' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_create_conversion_wagner_vi' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_coordoperation_get_param_index' 
/home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to
`proj_coordoperation_get_param_count' 
collect2: error: ld returned 1 exit status 
GNUmakefile:82: recipe for target 'gdalinfo' failed 
make[1]: *** [gdalinfo] Error 1 
make[1]: Leaving directory '/home/bjsvwneu/dev/gdal-3.0.2/apps' 
GNUmakefile:112: recipe for target 'apps-target' failed 
make: *** [apps-target] Error 2

----------------- 

Do you have any idea on what would help me fix this compile problem? 

Note that two versions of proj are on my system: the old version in /usr
and the new version in /usr/local - with the configure_param I am
pointing it to the new version. 

Thanks for your help! 

Andreas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/6876d8f0/attachment-0001.html>

From mateusz at loskot.net  Tue Nov 19 05:01:57 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 19 Nov 2019 14:01:57 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
Message-ID: <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>

On Tue, 19 Nov 2019 at 13:41, Andreas Neumann <a.neumann at carto.net> wrote:
> I am trying to compile gdal3.0.2 against proj6 - but have problems.
>
> Proj6 compile worked fine and I installed in /usr/local
>
> The configure command for gdal is:
>
> ./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes --with-spatialite=yes
> [...]
> /bin/bash /home/bjsvwneu/dev/gdal-3.0.2/libtool --mode=link --silent g++  gdalinfo_bin.lo  /home/bjsvwneu/dev/gdal-3.0.2/libgdal.la  -o gdalinfo
> /home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to `proj_alter_name'

Try

https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050184.html
https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050189.html

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From mateusz at loskot.net  Tue Nov 19 05:03:17 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 19 Nov 2019 14:03:17 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
Message-ID: <CABUeae_QinvyGrZucWw9isKSq6=JAF7ZMweiw=MvMW3hd5ecfQ@mail.gmail.com>

On Tue, 19 Nov 2019 at 13:41, Andreas Neumann <a.neumann at carto.net> wrote:
> Note that two versions of proj are on my system: the old version in /usr and the new version in /usr/local - with the configure_param I am pointing it to the new version.

Then, check also what ./configure reports as PROJ version found.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From a.neumann at carto.net  Tue Nov 19 05:15:16 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Tue, 19 Nov 2019 14:15:16 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
 <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
Message-ID: <567f9ef88c6e31a488e52131fd2f62ac@carto.net>

Hi, 

Thanks for your reply. 

Here is the output of configure: 

-------------- 

user at machine:~/dev/gdal-3.0.2$ ./configure --with-python=python3
--with-proj=/usr/local --with-pg=yes --with-spatialite=yes | grep proj 
/bin/bash: ./config.rpath: No such file or directory 
checking for PROJ >= 6 library... checking for proj_create_from_wkt in
-lproj... yes 
configure: proj.h found 
config.status: WARNING:  'GDALmake.opt.in' seems to ignore the
--datarootdir setting

---------- 

And here the output of ldd: 

---------- 

user at machine:~/dev/gdal-3.0.2$ ldd .libs/libgdal.so | grep proj 
       libproj.so.12 => /usr/lib/x86_64-linux-gnu/libproj.so.12
(0x00007f72525a5000)

------------- 

So this seems like it links to the old version of proj. Why is using
this one if I specified "--with-proj=/usr/local" ? 

The env var LD_LIBRARY_PATH is not set on my machine. 

Maybe setting one and set /usr/local as the preferred path would solve
my problem. I'll try ... 

Thanks, 

Andreas 

On 2019-11-19 14:01, Mateusz Loskot wrote:

> On Tue, 19 Nov 2019 at 13:41, Andreas Neumann <a.neumann at carto.net> wrote: 
> 
>> I am trying to compile gdal3.0.2 against proj6 - but have problems.
>> 
>> Proj6 compile worked fine and I installed in /usr/local
>> 
>> The configure command for gdal is:
>> 
>> ./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes --with-spatialite=yes
>> [...]
>> /bin/bash /home/bjsvwneu/dev/gdal-3.0.2/libtool --mode=link --silent g++  gdalinfo_bin.lo  /home/bjsvwneu/dev/gdal-3.0.2/libgdal.la  -o gdalinfo
>> /home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to `proj_alter_name'
> 
> Try
> 
> https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050184.html
> https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050189.html
> 
> Best regards,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/64ce5061/attachment.html>

From a.neumann at carto.net  Tue Nov 19 05:26:40 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Tue, 19 Nov 2019 14:26:40 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <567f9ef88c6e31a488e52131fd2f62ac@carto.net>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
 <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
 <567f9ef88c6e31a488e52131fd2f62ac@carto.net>
Message-ID: <2c1be2a9e75e81c6ddab7896cc82a2c0@carto.net>

Hi, 

Hm - setting the LD_LIBRARY_PATH variable also didn't help. ldd still
says that it links to the old proj. 

Still the same error message. 

I did a "make clean" to make sure no old stuff is around from previous
attempts. Do I really have to purge the old proj version? Then several
other of the packages on my machine would fail to work ... 

Andreas 

On 2019-11-19 14:15, Andreas Neumann wrote:

> Hi, 
> 
> Thanks for your reply. 
> 
> Here is the output of configure: 
> 
> -------------- 
> 
> user at machine:~/dev/gdal-3.0.2$ ./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes --with-spatialite=yes | grep proj 
> /bin/bash: ./config.rpath: No such file or directory 
> checking for PROJ >= 6 library... checking for proj_create_from_wkt in -lproj... yes 
> configure: proj.h found 
> config.status: WARNING:  'GDALmake.opt.in' seems to ignore the --datarootdir setting
> 
> ---------- 
> 
> And here the output of ldd: 
> 
> ---------- 
> 
> user at machine:~/dev/gdal-3.0.2$ ldd .libs/libgdal.so | grep proj 
> libproj.so.12 => /usr/lib/x86_64-linux-gnu/libproj.so.12 (0x00007f72525a5000)
> 
> ------------- 
> 
> So this seems like it links to the old version of proj. Why is using this one if I specified "--with-proj=/usr/local" ? 
> 
> The env var LD_LIBRARY_PATH is not set on my machine. 
> 
> Maybe setting one and set /usr/local as the preferred path would solve my problem. I'll try ... 
> 
> Thanks, 
> 
> Andreas 
> 
> On 2019-11-19 14:01, Mateusz Loskot wrote: 
> On Tue, 19 Nov 2019 at 13:41, Andreas Neumann <a.neumann at carto.net> wrote: I am trying to compile gdal3.0.2 against proj6 - but have problems.
> 
> Proj6 compile worked fine and I installed in /usr/local
> 
> The configure command for gdal is:
> 
> ./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes --with-spatialite=yes
> [...]
> /bin/bash /home/bjsvwneu/dev/gdal-3.0.2/libtool --mode=link --silent g++  gdalinfo_bin.lo  /home/bjsvwneu/dev/gdal-3.0.2/libgdal.la  -o gdalinfo
> /home/bjsvwneu/dev/gdal-3.0.2/.libs/libgdal.so: undefined reference to `proj_alter_name' 
> Try
> 
> https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050184.html
> https://lists.osgeo.org/pipermail/gdal-dev/2019-May/050189.html
> 
> Best regards,

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/378d9ceb/attachment.html>

From even.rouault at spatialys.com  Tue Nov 19 05:28:09 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Nov 2019 14:28:09 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <567f9ef88c6e31a488e52131fd2f62ac@carto.net>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
 <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
 <567f9ef88c6e31a488e52131fd2f62ac@carto.net>
Message-ID: <1782469.H62k4TEbth@even-i700>

Andreas,

> So this seems like it links to the old version of proj. Why is using
> this one if I specified "--with-proj=/usr/local" ?

GDAL build system doesn't use rpath mechanism for linking, so if there are 
several libproj.so in the path used for linking it will use the first or last 
one, I never remember :-).
Anyway, even if you manage to build, you're bound to run into runtime problems 
if you intend to link GDAL against PROJ 6 and spatialite built against an 
older PROJ.

So 2 ways:
- uninstall the proj development package, and build spatialite against proj6 
too
- or use the trick at https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Tue Nov 19 05:49:14 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Tue, 19 Nov 2019 14:49:14 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <1782469.H62k4TEbth@even-i700>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
 <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
 <567f9ef88c6e31a488e52131fd2f62ac@carto.net> <1782469.H62k4TEbth@even-i700>
Message-ID: <bdadee4ed8dd21fffb9431ef691fc0ae@carto.net>

Hi Even, 

Yes - you are right. Other gdal library dependencies still link to the
old version. 

I will the trick at
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev first, before I
try the harder way to recompile all other packages. 

Thanks, 

Andreas 

On 2019-11-19 14:28, Even Rouault wrote:

> Andreas,
> 
>> So this seems like it links to the old version of proj. Why is using
>> this one if I specified "--with-proj=/usr/local" ?
> 
> GDAL build system doesn't use rpath mechanism for linking, so if there are 
> several libproj.so in the path used for linking it will use the first or last 
> one, I never remember :-).
> Anyway, even if you manage to build, you're bound to run into runtime problems 
> if you intend to link GDAL against PROJ 6 and spatialite built against an 
> older PROJ.
> 
> So 2 ways:
> - uninstall the proj development package, and build spatialite against proj6 
> too
> - or use the trick at https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev
> 
> Even
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/4656d472/attachment-0001.html>

From a.neumann at carto.net  Tue Nov 19 06:55:57 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Tue, 19 Nov 2019 15:55:57 +0100
Subject: [gdal-dev] Compile problems gdal3.0.2 against proj6
In-Reply-To: <1782469.H62k4TEbth@even-i700>
References: <bc9ffa48e40bcfa76f4a18f2e70ab2cf@carto.net>
 <CABUeae_iqRJ9jcCPMsZ8WgbNrgg7Demt1Uan2RvjOR6RzFxNhA@mail.gmail.com>
 <567f9ef88c6e31a488e52131fd2f62ac@carto.net> <1782469.H62k4TEbth@even-i700>
Message-ID: <ffdb088f2bee286e7d3c1c9e0bfcbd92@carto.net>

Hi all, 

The trick explained at
https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev 

seems to have solved my issue. 

Thanks a lot for the hint, 

Andreas 

On 2019-11-19 14:28, Even Rouault wrote:

> Andreas,
> 
>> So this seems like it links to the old version of proj. Why is using
>> this one if I specified "--with-proj=/usr/local" ?
> 
> GDAL build system doesn't use rpath mechanism for linking, so if there are 
> several libproj.so in the path used for linking it will use the first or last 
> one, I never remember :-).
> Anyway, even if you manage to build, you're bound to run into runtime problems 
> if you intend to link GDAL against PROJ 6 and spatialite built against an 
> older PROJ.
> 
> So 2 ways:
> - uninstall the proj development package, and build spatialite against proj6 
> too
> - or use the trick at https://trac.osgeo.org/gdal/wiki/BuildingOnUnixGDAL25dev
> 
> Even
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/6ee0bec8/attachment.html>

From alex at vautier.biz  Tue Nov 19 08:35:42 2019
From: alex at vautier.biz (alex at vautier.biz)
Date: Tue, 19 Nov 2019 17:35:42 +0100
Subject: [gdal-dev] gdalwarp overhead on linux but not on windows
Message-ID: <30a4d3719f6d81d43379cc77da32d20f@vautier.biz>

Hi guys,

I've been playing quite a lot with "wrapper_GDALWarpDestName" and a .net 
core wrapper (https://github.com/MaxRev-Dev/gdal.netcore/).
Everything is running fine, I'm quite happy to see the same behavior on 
windows and linux. Sometimes linux is faster for reading and writing 
raster, this is great ! .NET Core is (now) a very good option for cross 
platform dev. Anyway...

When calling wrapper_GDALWarpDestName,  I'm experiencing an overhead of 
350 to 500 ms on linux that I don't see at all on Windows.
To narrow down the issue, I tried many warp options (-multi; -wo 
NUM_THREADS=4; -wm 2000), output drivers (MEM, VRT, NWT_GRD), input file 
format (MEM, VRT, NWT_GRD), input and output projections. I also checked 
Gdal.GetCacheUsed(), Gdal.HasThreadSupport() and Gdal.GetCacheMax(), 
same values between linux and windows. Nothing helps.

Even with VRT format output, this overhead is present which proves this 
is not related to processing. I bet for some sort of initialization of 
the warp algorithm with file reading... because 400 ms is far from 
nothing. But I'm wondering why this is occurring for every single call 
on linux and not on windows... Any option I could try ? My next step is 
to profile the linux process but I'm not good at that so any help there 
would be great too.


     OS (version): Windows 10 (1903)
     Docker:
     Server: Docker Engine - Community
     Engine:
     Version: 19.03.2
     API version: 1.40 (minimum version 1.12)
     Go version: go1.12.8
     Git commit: 6a30dfc
     Built: Thu Aug 29 05:32:21 2019
     OS/Arch: linux/amd64
     Experimental: false

     Linux in docker file: debian 9 
(mcr.microsoft.com/dotnet/core/runtime:2.2-stretch-slim)
     Package version (core): [e.g. 3.0.1.25]
     Package version (runtime windows): [e.g. 3.0.1.25]
     Package version (runtime linux): [e.g. 3.0.1.2]

This is the kind of code I'm running:

namespace GdalCoreTest
{
  class Program
  {
   static void Main(string[] args)
   {
	GdalBase.ConfigureAll();
	Console.WriteLine("GDAL configured");
	Console.WriteLine(string.Join('\n',
		"GDAL Version: " + Gdal.VersionInfo("RELEASE_NAME"),
		"GDAL INFO: " + Gdal.VersionInfo("")));
	WarpFile();
	WarpFile();
	WarpFile();
   }

   public static void WarpFile()
   {
	Stopwatch sw = new Stopwatch();

	int sizeX = 1024, sizeY = 1024;
	var driver = Gdal.GetDriverByName("MEM");
	string path = $"/vsimem/test.mem";
	string vrtFilePath = null;
	using(Dataset ds = driver.Create(path, sizeX, sizeY, 1, 
DataType.GDT_UInt32, new string[0]))
	{
	  try
	  {
	  //**************
	  //create a grid
		ds.SetGeoTransform(new double[]{0, 30, 0, 0, 0, -30});

		var ttt = new SpatialReference(null);
		ttt.ImportFromProj4("+proj=longlat +datum=WGS84");
		ttt.ExportToWkt(out string latLongWkt, new string[0]);
		ds.SetProjection(latLongWkt);

		//write data in the buffer
		int[] buffer = new int[sizeX * sizeY];
		for (int x = 0; x < sizeX; x++)
		{
		  for (int y = 0; y < sizeY; y++)
		  {
			buffer[y * sizeX + x] = x + y;
		  }
		}

		ds.GetRasterBand(1).WriteRaster(0, 0, sizeX, sizeY, buffer, sizeX, 
sizeY, 0, 0);


		//**************
		//Prepare for warping
		IntPtr[] ptr = {Dataset.getCPtr(ds).Handle};
		GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
		var dss = new 
SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false, 
null);
		vrtFilePath = $"/vsimem/tile.vrt";

	  //Warp
		sw.Start();
		using (Dataset dst = Gdal.wrapper_GDALWarpDestName(vrtFilePath, 1, 
dss, new GDALWarpAppOptions(new[]{"-of", "VRT" }), null,null))
		{
		  sw.Stop();
		}
	  }
	  finally
	  {
		Gdal.Unlink(path);
		Gdal.Unlink(vrtFilePath);
	  }
	}
     Console.Out.WriteLine($"Warp duration = {sw.ElapsedTicks} ticks 
({sw.ElapsedMilliseconds} ms).");
   }
  }
}


This is the output I'm getting on windows:

GDAL configured
GDAL Version: 3.0.1
GDAL INFO: GDAL 3.0.1, released 2019/06/28
Warp duration = 221267 ticks (22 ms).
Warp duration = 133395 ticks (13 ms).
Warp duration = 155402 ticks (15 ms).

This is the output I'm getting on docker/linux:

GDAL configured
GDAL Version: 3.0.1
GDAL INFO: GDAL 3.0.1, released 2019/06/28
Warp duration = 395911725 ticks (395 ms).
Warp duration = 368923383 ticks (368 ms).
Warp duration = 373055090 ticks (373 ms).

Thanks,
Alex.

From jukka.rahkonen at maanmittauslaitos.fi  Tue Nov 19 14:03:29 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 19 Nov 2019 22:03:29 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
Message-ID: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>

Hi,

I would like to get some hints about using gdal_grid or some other utility for lake bathymetry. What I have is typically rather sparse point data of depths and the shoreline that includes the islands as in the attached image. The shoreline and all the area that is not lake basin should have the altitude of zero in the resulting DEM. It means that interpolation should not overshoot across the shoreline over the dry land.

Gdal_grid seems to miss an option for handling the shoreline so I made a test by converting the vertices of the polygon rings into depth points. I also filled area around the lake with a gridded points of zero altitude but the method feels stupid and tedious and the result was not so fine when it comes to keep the shoreline and land area near it totally flat.

If there are any specialists on bathymetry reading I am eager to learn how to handle my data.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/a938548c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: depth_points_and_shoreline.png
Type: image/png
Size: 6911 bytes
Desc: depth_points_and_shoreline.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/a938548c/attachment.png>

From even.rouault at spatialys.com  Tue Nov 19 14:12:51 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 Nov 2019 23:12:51 +0100
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
Message-ID: <4741071.g17mCcZVbc@even-i700>

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other utility
> for lake bathymetry. What I have is typically rather sparse point data of
> depths and the shoreline that includes the islands as in the attached
> image. The shoreline and all the area that is not lake basin should have
> the altitude of zero in the resulting DEM. It means that interpolation
> should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made a
> test by converting the vertices of the polygon rings into depth points. I
> also filled area around the lake with a gridded points of zero altitude but
> the method feels stupid and tedious and the result was not so fine when it
> comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Tue Nov 19 14:20:34 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 19 Nov 2019 15:20:34 -0700 (MST)
Subject: [gdal-dev] gdalwarp overhead on linux but not on windows
In-Reply-To: <30a4d3719f6d81d43379cc77da32d20f@vautier.biz>
References: <30a4d3719f6d81d43379cc77da32d20f@vautier.biz>
Message-ID: <1574202034596-0.post@n6.nabble.com>

Hi,

I have been told that Docker has overhead with everything, with these
numbers as evidence:

ubuntu at t:/etc$ time gdalinfo --version
GDAL 2.2.3, released 2017/11/20

real 0m0.030s
user 0m0.017s
sys 0m0.013s

ubuntu at t:/etc$ time docker exec -it 742a044b8ef1 gdalinfo --version
GDAL 3.1.0dev-19f34295c8c310b6ecb27d2d7aa7ac0a2a2a3d9f, released 2019/11/05

real 0m0.386s
user 0m0.023s
sys 0m0.030s

-Jukka Rahkonen-


alex-6 wrote
> Hi guys,
> 
> I've been playing quite a lot with "wrapper_GDALWarpDestName" and a .net 
> core wrapper (https://github.com/MaxRev-Dev/gdal.netcore/).
> Everything is running fine, I'm quite happy to see the same behavior on 
> windows and linux. Sometimes linux is faster for reading and writing 
> raster, this is great ! .NET Core is (now) a very good option for cross 
> platform dev. Anyway...
> 
> When calling wrapper_GDALWarpDestName,  I'm experiencing an overhead of 
> 350 to 500 ms on linux that I don't see at all on Windows.
> To narrow down the issue, I tried many warp options (-multi; -wo 
> NUM_THREADS=4; -wm 2000), output drivers (MEM, VRT, NWT_GRD), input file 
> format (MEM, VRT, NWT_GRD), input and output projections. I also checked 
> Gdal.GetCacheUsed(), Gdal.HasThreadSupport() and Gdal.GetCacheMax(), 
> same values between linux and windows. Nothing helps.
> 
> Even with VRT format output, this overhead is present which proves this 
> is not related to processing. I bet for some sort of initialization of 
> the warp algorithm with file reading... because 400 ms is far from 
> nothing. But I'm wondering why this is occurring for every single call 
> on linux and not on windows... Any option I could try ? My next step is 
> to profile the linux process but I'm not good at that so any help there 
> would be great too.
> 
> 
>      OS (version): Windows 10 (1903)
>      Docker:
>      Server: Docker Engine - Community
>      Engine:
>      Version: 19.03.2
>      API version: 1.40 (minimum version 1.12)
>      Go version: go1.12.8
>      Git commit: 6a30dfc
>      Built: Thu Aug 29 05:32:21 2019
>      OS/Arch: linux/amd64
>      Experimental: false
> 
>      Linux in docker file: debian 9 
> (mcr.microsoft.com/dotnet/core/runtime:2.2-stretch-slim)
>      Package version (core): [e.g. 3.0.1.25]
>      Package version (runtime windows): [e.g. 3.0.1.25]
>      Package version (runtime linux): [e.g. 3.0.1.2]
> 
> This is the kind of code I'm running:
> 
> namespace GdalCoreTest
> {
>   class Program
>   {
>    static void Main(string[] args)
>    {
> 	GdalBase.ConfigureAll();
> 	Console.WriteLine("GDAL configured");
> 	Console.WriteLine(string.Join('\n',
> 		"GDAL Version: " + Gdal.VersionInfo("RELEASE_NAME"),
> 		"GDAL INFO: " + Gdal.VersionInfo("")));
> 	WarpFile();
> 	WarpFile();
> 	WarpFile();
>    }
> 
>    public static void WarpFile()
>    {
> 	Stopwatch sw = new Stopwatch();
> 
> 	int sizeX = 1024, sizeY = 1024;
> 	var driver = Gdal.GetDriverByName("MEM");
> 	string path = $"/vsimem/test.mem";
> 	string vrtFilePath = null;
> 	using(Dataset ds = driver.Create(path, sizeX, sizeY, 1, 
> DataType.GDT_UInt32, new string[0]))
> 	{
> 	  try
> 	  {
> 	  //**************
> 	  //create a grid
> 		ds.SetGeoTransform(new double[]{0, 30, 0, 0, 0, -30});
> 
> 		var ttt = new SpatialReference(null);
> 		ttt.ImportFromProj4("+proj=longlat +datum=WGS84");
> 		ttt.ExportToWkt(out string latLongWkt, new string[0]);
> 		ds.SetProjection(latLongWkt);
> 
> 		//write data in the buffer
> 		int[] buffer = new int[sizeX * sizeY];
> 		for (int x = 0; x < sizeX; x++)
> 		{
> 		  for (int y = 0; y < sizeY; y++)
> 		  {
> 			buffer[y * sizeX + x] = x + y;
> 		  }
> 		}
> 
> 		ds.GetRasterBand(1).WriteRaster(0, 0, sizeX, sizeY, buffer, sizeX, 
> sizeY, 0, 0);
> 
> 
> 		//**************
> 		//Prepare for warping
> 		IntPtr[] ptr = {Dataset.getCPtr(ds).Handle};
> 		GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
> 		var dss = new 
> SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false, 
> null);
> 		vrtFilePath = $"/vsimem/tile.vrt";
> 
> 	  //Warp
> 		sw.Start();
> 		using (Dataset dst = Gdal.wrapper_GDALWarpDestName(vrtFilePath, 1, 
> dss, new GDALWarpAppOptions(new[]{"-of", "VRT" }), null,null))
> 		{
> 		  sw.Stop();
> 		}
> 	  }
> 	  finally
> 	  {
> 		Gdal.Unlink(path);
> 		Gdal.Unlink(vrtFilePath);
> 	  }
> 	}
>      Console.Out.WriteLine($"Warp duration = {sw.ElapsedTicks} ticks 
> ({sw.ElapsedMilliseconds} ms).");
>    }
>   }
> }
> 
> 
> This is the output I'm getting on windows:
> 
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 221267 ticks (22 ms).
> Warp duration = 133395 ticks (13 ms).
> Warp duration = 155402 ticks (15 ms).
> 
> This is the output I'm getting on docker/linux:
> 
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 395911725 ticks (395 ms).
> Warp duration = 368923383 ticks (368 ms).
> Warp duration = 373055090 ticks (373 ms).
> 
> Thanks,
> Alex.
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jluis at ualg.pt  Tue Nov 19 14:30:05 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Tue, 19 Nov 2019 22:30:05 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <4741071.g17mCcZVbc@even-i700>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
 <4741071.g17mCcZVbc@even-i700>
Message-ID: <DB8PR04MB669746DD5A720750A8C7BFC5A64C0@DB8PR04MB6697.eurprd04.prod.outlook.com>

The GMT surface program has two (well 3) options that are of interest to this. 

-One, the -Lu<upper> that serves to limit the upper value in the interpolated grid

-The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.

-Finally, option -M lets you mask the outside lakes region

https://docs.generic-mapping-tools.org/latest/surface.html

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Tuesday, November 19, 2019 10:13 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other 
> utility for lake bathymetry. What I have is typically rather sparse 
> point data of depths and the shoreline that includes the islands as in 
> the attached image. The shoreline and all the area that is not lake 
> basin should have the altitude of zero in the resulting DEM. It means 
> that interpolation should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made 
> a test by converting the vertices of the polygon rings into depth 
> points. I also filled area around the lake with a gridded points of 
> zero altitude but the method feels stupid and tedious and the result 
> was not so fine when it comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From pcreso at yahoo.com  Tue Nov 19 15:11:48 2019
From: pcreso at yahoo.com (Brent Wood)
Date: Tue, 19 Nov 2019 23:11:48 +0000 (UTC)
Subject: [gdal-dev] gdalwarp overhead on linux but not on windows
In-Reply-To: <1574202034596-0.post@n6.nabble.com>
References: <30a4d3719f6d81d43379cc77da32d20f@vautier.biz>
 <1574202034596-0.post@n6.nabble.com>
Message-ID: <1098453716.2621125.1574205108552@mail.yahoo.com>

 Ummm...
How much is due to the very different version of GDAL vs docker overhead? 

Any chance of using the same GDAL version for both tests?


Brent Wood

    On Wednesday, November 20, 2019, 11:20:50 AM GMT+13, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:  
 
 Hi,

I have been told that Docker has overhead with everything, with these
numbers as evidence:

ubuntu at t:/etc$ time gdalinfo --version
GDAL 2.2.3, released 2017/11/20

real 0m0.030s
user 0m0.017s
sys 0m0.013s

ubuntu at t:/etc$ time docker exec -it 742a044b8ef1 gdalinfo --version
GDAL 3.1.0dev-19f34295c8c310b6ecb27d2d7aa7ac0a2a2a3d9f, released 2019/11/05

real 0m0.386s
user 0m0.023s
sys 0m0.030s

-Jukka Rahkonen-


alex-6 wrote
> Hi guys,
> 
> I've been playing quite a lot with "wrapper_GDALWarpDestName" and a .net 
> core wrapper (https://github.com/MaxRev-Dev/gdal.netcore/).
> Everything is running fine, I'm quite happy to see the same behavior on 
> windows and linux. Sometimes linux is faster for reading and writing 
> raster, this is great ! .NET Core is (now) a very good option for cross 
> platform dev. Anyway...
> 
> When calling wrapper_GDALWarpDestName,  I'm experiencing an overhead of 
> 350 to 500 ms on linux that I don't see at all on Windows.
> To narrow down the issue, I tried many warp options (-multi; -wo 
> NUM_THREADS=4; -wm 2000), output drivers (MEM, VRT, NWT_GRD), input file 
> format (MEM, VRT, NWT_GRD), input and output projections. I also checked 
> Gdal.GetCacheUsed(), Gdal.HasThreadSupport() and Gdal.GetCacheMax(), 
> same values between linux and windows. Nothing helps.
> 
> Even with VRT format output, this overhead is present which proves this 
> is not related to processing. I bet for some sort of initialization of 
> the warp algorithm with file reading... because 400 ms is far from 
> nothing. But I'm wondering why this is occurring for every single call 
> on linux and not on windows... Any option I could try ? My next step is 
> to profile the linux process but I'm not good at that so any help there 
> would be great too.
> 
> 
>      OS (version): Windows 10 (1903)
>      Docker:
>      Server: Docker Engine - Community
>      Engine:
>      Version: 19.03.2
>      API version: 1.40 (minimum version 1.12)
>      Go version: go1.12.8
>      Git commit: 6a30dfc
>      Built: Thu Aug 29 05:32:21 2019
>      OS/Arch: linux/amd64
>      Experimental: false
> 
>      Linux in docker file: debian 9 
> (mcr.microsoft.com/dotnet/core/runtime:2.2-stretch-slim)
>      Package version (core): [e.g. 3.0.1.25]
>      Package version (runtime windows): [e.g. 3.0.1.25]
>      Package version (runtime linux): [e.g. 3.0.1.2]
> 
> This is the kind of code I'm running:
> 
> namespace GdalCoreTest
> {
>  class Program
>  {
>    static void Main(string[] args)
>    {
>     GdalBase.ConfigureAll();
>     Console.WriteLine("GDAL configured");
>     Console.WriteLine(string.Join('\n',
>         "GDAL Version: " + Gdal.VersionInfo("RELEASE_NAME"),
>         "GDAL INFO: " + Gdal.VersionInfo("")));
>     WarpFile();
>     WarpFile();
>     WarpFile();
>    }
> 
>    public static void WarpFile()
>    {
>     Stopwatch sw = new Stopwatch();
> 
>     int sizeX = 1024, sizeY = 1024;
>     var driver = Gdal.GetDriverByName("MEM");
>     string path = $"/vsimem/test.mem";
>     string vrtFilePath = null;
>     using(Dataset ds = driver.Create(path, sizeX, sizeY, 1, 
> DataType.GDT_UInt32, new string[0]))
>     {
>       try
>       {
>       //**************
>       //create a grid
>         ds.SetGeoTransform(new double[]{0, 30, 0, 0, 0, -30});
> 
>         var ttt = new SpatialReference(null);
>         ttt.ImportFromProj4("+proj=longlat +datum=WGS84");
>         ttt.ExportToWkt(out string latLongWkt, new string[0]);
>         ds.SetProjection(latLongWkt);
> 
>         //write data in the buffer
>         int[] buffer = new int[sizeX * sizeY];
>         for (int x = 0; x < sizeX; x++)
>         {
>           for (int y = 0; y < sizeY; y++)
>           {
>             buffer[y * sizeX + x] = x + y;
>           }
>         }
> 
>         ds.GetRasterBand(1).WriteRaster(0, 0, sizeX, sizeY, buffer, sizeX, 
> sizeY, 0, 0);
> 
> 
>         //**************
>         //Prepare for warping
>         IntPtr[] ptr = {Dataset.getCPtr(ds).Handle};
>         GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
>         var dss = new 
> SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false, 
> null);
>         vrtFilePath = $"/vsimem/tile.vrt";
> 
>       //Warp
>         sw.Start();
>         using (Dataset dst = Gdal.wrapper_GDALWarpDestName(vrtFilePath, 1, 
> dss, new GDALWarpAppOptions(new[]{"-of", "VRT" }), null,null))
>         {
>           sw.Stop();
>         }
>       }
>       finally
>       {
>         Gdal.Unlink(path);
>         Gdal.Unlink(vrtFilePath);
>       }
>     }
>      Console.Out.WriteLine($"Warp duration = {sw.ElapsedTicks} ticks 
> ({sw.ElapsedMilliseconds} ms).");
>    }
>  }
> }
> 
> 
> This is the output I'm getting on windows:
> 
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 221267 ticks (22 ms).
> Warp duration = 133395 ticks (13 ms).
> Warp duration = 155402 ticks (15 ms).
> 
> This is the output I'm getting on docker/linux:
> 
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 395911725 ticks (395 ms).
> Warp duration = 368923383 ticks (368 ms).
> Warp duration = 373055090 ticks (373 ms).
> 
> Thanks,
> Alex.
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191119/3cd84718/attachment-0001.html>

From a.neumann at carto.net  Wed Nov 20 00:34:08 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 09:34:08 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of vector
	drivers?
Message-ID: <da6fc06d1eacfdfa985d62558e002249@carto.net>

Hi, 

I wonder why in the list of available vector drivers at
https://gdal.org/drivers/vector/index.html there is no mention of PDF /
GeoPDF / GeospatialPDF. Didn't we have an entry for these formats in the
past? 

Thanks, 

Andreas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/d779efca/attachment.html>

From a.neumann at carto.net  Wed Nov 20 00:35:48 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 09:35:48 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of
 vector drivers?
In-Reply-To: <da6fc06d1eacfdfa985d62558e002249@carto.net>
References: <da6fc06d1eacfdfa985d62558e002249@carto.net>
Message-ID: <170d4b30b6c603d1c1be1ef45203c9c1@carto.net>

Hi, 

Ah - found it under the raster formats: 

https://gdal.org/drivers/raster/pdf.html?highlight=pdf 

Shouldn't it also be listed under the vector formats? It is more useful
as a vector format - isn't it? 

Andreas 

On 2019-11-20 09:34, Andreas Neumann wrote:

> Hi, 
> 
> I wonder why in the list of available vector drivers at https://gdal.org/drivers/vector/index.html there is no mention of PDF / GeoPDF / GeospatialPDF. Didn't we have an entry for these formats in the past? 
> 
> Thanks, 
> 
> Andreas 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/789efb43/attachment.html>

From a.neumann at carto.net  Wed Nov 20 00:42:22 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 09:42:22 +0100
Subject: [gdal-dev] PDF: configure option --enable-pdf-plugin
Message-ID: <3db82977b638bcc3b730fd91b8838d7a@carto.net>

Hi, 

I wonder what exactly the build option "--enable-pdf-plugin enable PDF
driver as a plugin (included in libgdal by default)" means?

How does this relate to the other options of building against
poppler/podofo/pdfium ? 

Thank you very much if you have more information, 

Andreas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/ae3aec7f/attachment.html>

From even.rouault at spatialys.com  Wed Nov 20 02:04:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Nov 2019 11:04:00 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of
	vector drivers?
In-Reply-To: <170d4b30b6c603d1c1be1ef45203c9c1@carto.net>
References: <da6fc06d1eacfdfa985d62558e002249@carto.net>
 <170d4b30b6c603d1c1be1ef45203c9c1@carto.net>
Message-ID: <1636671.87VZBdGJfC@even-i700>

On mercredi 20 novembre 2019 09:35:48 CET Andreas Neumann wrote:
> Hi,
> 
> Ah - found it under the raster formats:
> 
> https://gdal.org/drivers/raster/pdf.html?highlight=pdf
> 
> Shouldn't it also be listed under the vector formats? It is more useful
> as a vector format - isn't it?

Well PDF is mostly a presentation format. Very much about rendering. Mixes 
raster, text, vector content, and many other things. So the more reliable way 
of exposing it from GDAL point of view is a raster. The vector side of the PDF 
can extract *some* things, but it is lossy.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 20 02:08:58 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Nov 2019 11:08:58 +0100
Subject: [gdal-dev] PDF: configure option --enable-pdf-plugin
In-Reply-To: <3db82977b638bcc3b730fd91b8838d7a@carto.net>
References: <3db82977b638bcc3b730fd91b8838d7a@carto.net>
Message-ID: <5423514.U7Ux2Ulr8Z@even-i700>

Andreas,

> I wonder what exactly the build option "--enable-pdf-plugin enable PDF
> driver as a plugin (included in libgdal by default)" means?

Plugin here means as a separate .so/.dll : gdal_PDF.so/dll
Mostly for licensing concerns if using the Poppler backend since Poppler is 
subject to the GPL. So you can make a libgdal build mostly subject to X/MIT or 
similar licenses, and in case you need it, use a gdal_PDF plugin subject to 
GPL

> How does this relate to the other options of building against
> poppler/podofo/pdfium ?

It is orthogonal to the poppler/podofo/pdfium backend(s) used.
For the pdfium backend, which is a bit involved to build (pdfium actually), 
there were also issues with symbol clashes between embedded libraries in 
pdfium and others used by GDAL, and making a plugin instead of linking in core 
GDAL library seemed to "solve" (workaround) issues. Was at least true on Linux 
with pdfium of a few years ago. I don't remember having had such issues with 
the recent upgrade I did in GDAL master.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Wed Nov 20 02:50:40 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 11:50:40 +0100
Subject: [gdal-dev] PDF: configure option --enable-pdf-plugin
In-Reply-To: <5423514.U7Ux2Ulr8Z@even-i700>
References: <3db82977b638bcc3b730fd91b8838d7a@carto.net>
 <5423514.U7Ux2Ulr8Z@even-i700>
Message-ID: <edad66b26d589e3887392a1443da7a72@carto.net>

Hi Even, 

Thanks for the clarification. In that case I don't need to build it as a
plugin, since this build will only end up on my own local machine. 

Andreas 

On 2019-11-20 11:08, Even Rouault wrote:

> Andreas,
> 
>> I wonder what exactly the build option "--enable-pdf-plugin enable PDF
>> driver as a plugin (included in libgdal by default)" means?
> 
> Plugin here means as a separate .so/.dll : gdal_PDF.so/dll
> Mostly for licensing concerns if using the Poppler backend since Poppler is 
> subject to the GPL. So you can make a libgdal build mostly subject to X/MIT or 
> similar licenses, and in case you need it, use a gdal_PDF plugin subject to 
> GPL
> 
>> How does this relate to the other options of building against
>> poppler/podofo/pdfium ?
> 
> It is orthogonal to the poppler/podofo/pdfium backend(s) used.
> For the pdfium backend, which is a bit involved to build (pdfium actually), 
> there were also issues with symbol clashes between embedded libraries in 
> pdfium and others used by GDAL, and making a plugin instead of linking in core 
> GDAL library seemed to "solve" (workaround) issues. Was at least true on Linux 
> with pdfium of a few years ago. I don't remember having had such issues with 
> the recent upgrade I did in GDAL master.
> 
> Even
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/f6837934/attachment.html>

From a.neumann at carto.net  Wed Nov 20 02:53:01 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 11:53:01 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of
 vector drivers?
In-Reply-To: <1636671.87VZBdGJfC@even-i700>
References: <da6fc06d1eacfdfa985d62558e002249@carto.net>
 <170d4b30b6c603d1c1be1ef45203c9c1@carto.net> <1636671.87VZBdGJfC@even-i700>
Message-ID: <bd2d780690f0e996a44fcbfaee7e20e6@carto.net>

Hi Even, 

Yes, PDF is mainly a presentation format. But it is also very much a
vector format. 

Are there technical issues or other complications that keep us from
listing it as both vector and raster driver? Geopackage is also a hybrid
format and is listed in both. 

Thanks, 

Andreas 

On 2019-11-20 11:04, Even Rouault wrote:

> On mercredi 20 novembre 2019 09:35:48 CET Andreas Neumann wrote: 
> 
>> Hi,
>> 
>> Ah - found it under the raster formats:
>> 
>> https://gdal.org/drivers/raster/pdf.html?highlight=pdf
>> 
>> Shouldn't it also be listed under the vector formats? It is more useful
>> as a vector format - isn't it?
> 
> Well PDF is mostly a presentation format. Very much about rendering. Mixes 
> raster, text, vector content, and many other things. So the more reliable way 
> of exposing it from GDAL point of view is a raster. The vector side of the PDF 
> can extract *some* things, but it is lossy.
> 
> Even
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/42a5c093/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 20 03:00:45 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 20 Nov 2019 11:00:45 +0000
Subject: [gdal-dev] gdalwarp overhead on linux but not on windows
In-Reply-To: <1098453716.2621125.1574205108552@mail.yahoo.com>
References: <30a4d3719f6d81d43379cc77da32d20f@vautier.biz>
 <1574202034596-0.post@n6.nabble.com>
 <1098453716.2621125.1574205108552@mail.yahoo.com>
Message-ID: <733826eb841f4827a51ca2cd02d867d0@C119S212VM042.msvyvi.vaha.local>

Hi,

My colleague did make a test about the general  overhead of the GDAL docker when GDAL is not involved at all. Overhead in this test seems to be close to 0.4 sec

ubuntu at t:/etc$ time docker exec -it 742a044b8ef1 uname -a
Linux 742a044b8ef1 4.15.0-66-generic #75-Ubuntu SMP Tue Oct 1 05:24:09 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux

real 0m0.399s
user 0m0.032s
sys 0m0.023s

-Jukka Rahkonen-

Lähettäjä: Brent Wood <pcreso at yahoo.com>
Lähetetty: keskiviikko 20. marraskuuta 2019 1.12
Vastaanottaja: gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] gdalwarp overhead on linux but not on windows

Ummm...

How much is due to the very different version of GDAL vs docker overhead?

Any chance of using the same GDAL version for both tests?


Brent Wood

On Wednesday, November 20, 2019, 11:20:50 AM GMT+13, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:


Hi,

I have been told that Docker has overhead with everything, with these
numbers as evidence:

ubuntu at t<mailto:ubuntu at t>:/etc$ time gdalinfo --version
GDAL 2.2.3, released 2017/11/20

real 0m0.030s
user 0m0.017s
sys 0m0.013s

ubuntu at t<mailto:ubuntu at t>:/etc$ time docker exec -it 742a044b8ef1 gdalinfo --version
GDAL 3.1.0dev-19f34295c8c310b6ecb27d2d7aa7ac0a2a2a3d9f, released 2019/11/05

real 0m0.386s
user 0m0.023s
sys 0m0.030s

-Jukka Rahkonen-


alex-6 wrote
> Hi guys,
>
> I've been playing quite a lot with "wrapper_GDALWarpDestName" and a .net
> core wrapper (https://github.com/MaxRev-Dev/gdal.netcore/).
> Everything is running fine, I'm quite happy to see the same behavior on
> windows and linux. Sometimes linux is faster for reading and writing
> raster, this is great ! .NET Core is (now) a very good option for cross
> platform dev. Anyway...
>
> When calling wrapper_GDALWarpDestName,  I'm experiencing an overhead of
> 350 to 500 ms on linux that I don't see at all on Windows.
> To narrow down the issue, I tried many warp options (-multi; -wo
> NUM_THREADS=4; -wm 2000), output drivers (MEM, VRT, NWT_GRD), input file
> format (MEM, VRT, NWT_GRD), input and output projections. I also checked
> Gdal.GetCacheUsed(), Gdal.HasThreadSupport() and Gdal.GetCacheMax(),
> same values between linux and windows. Nothing helps.
>
> Even with VRT format output, this overhead is present which proves this
> is not related to processing. I bet for some sort of initialization of
> the warp algorithm with file reading... because 400 ms is far from
> nothing. But I'm wondering why this is occurring for every single call
> on linux and not on windows... Any option I could try ? My next step is
> to profile the linux process but I'm not good at that so any help there
> would be great too.
>
>
>      OS (version): Windows 10 (1903)
>      Docker:
>      Server: Docker Engine - Community
>      Engine:
>      Version: 19.03.2
>      API version: 1.40 (minimum version 1.12)
>      Go version: go1.12.8
>      Git commit: 6a30dfc
>      Built: Thu Aug 29 05:32:21 2019
>      OS/Arch: linux/amd64
>      Experimental: false
>
>      Linux in docker file: debian 9
> (mcr.microsoft.com/dotnet/core/runtime:2.2-stretch-slim)
>      Package version (core): [e.g. 3.0.1.25]
>      Package version (runtime windows): [e.g. 3.0.1.25]
>      Package version (runtime linux): [e.g. 3.0.1.2]
>
> This is the kind of code I'm running:
>
> namespace GdalCoreTest
> {
>  class Program
>  {
>    static void Main(string[] args)
>    {
>     GdalBase.ConfigureAll();
>     Console.WriteLine("GDAL configured");
>     Console.WriteLine(string.Join('\n',
>         "GDAL Version: " + Gdal.VersionInfo("RELEASE_NAME"),
>         "GDAL INFO: " + Gdal.VersionInfo("")));
>     WarpFile();
>     WarpFile();
>     WarpFile();
>    }
>
>    public static void WarpFile()
>    {
>     Stopwatch sw = new Stopwatch();
>
>     int sizeX = 1024, sizeY = 1024;
>     var driver = Gdal.GetDriverByName("MEM");
>     string path = $"/vsimem/test.mem";
>     string vrtFilePath = null;
>     using(Dataset ds = driver.Create(path, sizeX, sizeY, 1,
> DataType.GDT_UInt32, new string[0]))
>     {
>       try
>       {
>       //**************
>       //create a grid
>         ds.SetGeoTransform(new double[]{0, 30, 0, 0, 0, -30});
>
>         var ttt = new SpatialReference(null);
>         ttt.ImportFromProj4("+proj=longlat +datum=WGS84");
>         ttt.ExportToWkt(out string latLongWkt, new string[0]);
>         ds.SetProjection(latLongWkt);
>
>         //write data in the buffer
>         int[] buffer = new int[sizeX * sizeY];
>         for (int x = 0; x < sizeX; x++)
>         {
>           for (int y = 0; y < sizeY; y++)
>           {
>             buffer[y * sizeX + x] = x + y;
>           }
>         }
>
>         ds.GetRasterBand(1).WriteRaster(0, 0, sizeX, sizeY, buffer, sizeX,
> sizeY, 0, 0);
>
>
>         //**************
>         //Prepare for warping
>         IntPtr[] ptr = {Dataset.getCPtr(ds).Handle};
>         GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
>         var dss = new
> SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false,
> null);
>         vrtFilePath = $"/vsimem/tile.vrt";
>
>       //Warp
>         sw.Start();
>         using (Dataset dst = Gdal.wrapper_GDALWarpDestName(vrtFilePath, 1,
> dss, new GDALWarpAppOptions(new[]{"-of", "VRT" }), null,null))
>         {
>           sw.Stop();
>         }
>       }
>       finally
>       {
>         Gdal.Unlink(path);
>         Gdal.Unlink(vrtFilePath);
>       }
>     }
>      Console.Out.WriteLine($"Warp duration = {sw.ElapsedTicks} ticks
> ({sw.ElapsedMilliseconds} ms).");
>    }
>  }
> }
>
>
> This is the output I'm getting on windows:
>
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 221267 ticks (22 ms).
> Warp duration = 133395 ticks (13 ms).
> Warp duration = 155402 ticks (15 ms).
>
> This is the output I'm getting on docker/linux:
>
> GDAL configured
> GDAL Version: 3.0.1
> GDAL INFO: GDAL 3.0.1, released 2019/06/28
> Warp duration = 395911725 ticks (395 ms).
> Warp duration = 368923383 ticks (368 ms).
> Warp duration = 373055090 ticks (373 ms).
>
> Thanks,
> Alex.
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/bc92a06f/attachment-0001.html>

From pedrongvenancio at gmail.com  Wed Nov 20 04:40:49 2019
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Wed, 20 Nov 2019 12:40:49 +0000
Subject: [gdal-dev] GDAL tools that are Python scripts still need Python2 in
	OSGeo4W
Message-ID: <CAMCJChthOjkuoo0naib4RYzJixNq4XKiZY4xKBaVvFOTe8axag@mail.gmail.com>

Hi all,

I've a clean OSGeo4W install and I was trying to use some GDAL tools like
gdal2xyz or rgb2pct, but I was getting an error of missing module in
Python3:

python3 -m rgb2pct -n 2 -of GTiff D:\orto_teste.tif D:/orto_teste_pct.tif
GDAL command output:
C:\OSGEO4~1\bin\python3.exe: No module named rgb2pct

To overcome this issue, I had to install gdal-python, that still has
Python2 as dependency.

Where should this issue be solved? In GDAL or in OSGeo4W?

Thank you very much!

Best regards,
Pedro Venâncio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/60720938/attachment.html>

From even.rouault at spatialys.com  Wed Nov 20 05:47:12 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 Nov 2019 14:47:12 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of
	vector drivers?
In-Reply-To: <bd2d780690f0e996a44fcbfaee7e20e6@carto.net>
References: <da6fc06d1eacfdfa985d62558e002249@carto.net>
 <1636671.87VZBdGJfC@even-i700> <bd2d780690f0e996a44fcbfaee7e20e6@carto.net>
Message-ID: <9384320.Fz0Lc1SHC5@even-i700>

> Are there technical issues or other complications that keep us from
> listing it as both vector and raster driver?

Just did it: https://gdal.org/drivers/vector/pdf.html

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From a.neumann at carto.net  Wed Nov 20 05:51:28 2019
From: a.neumann at carto.net (Andreas Neumann)
Date: Wed, 20 Nov 2019 14:51:28 +0100
Subject: [gdal-dev] (Geo)PDF information missing from online list of
 vector drivers?
In-Reply-To: <9384320.Fz0Lc1SHC5@even-i700>
References: <da6fc06d1eacfdfa985d62558e002249@carto.net>
 <1636671.87VZBdGJfC@even-i700> <bd2d780690f0e996a44fcbfaee7e20e6@carto.net>
 <9384320.Fz0Lc1SHC5@even-i700>
Message-ID: <876f452ee16c4636117b303ce1ad7b35@carto.net>

Hi Even, 

Thank you! And sorry for being annoying  ... 

Andreas 

On 2019-11-20 14:47, Even Rouault wrote:

>> Are there technical issues or other complications that keep us from
>> listing it as both vector and raster driver?
> 
> Just did it: https://gdal.org/drivers/vector/pdf.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191120/71520965/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 21 08:21:47 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 21 Nov 2019 16:21:47 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <DB8PR04MB669746DD5A720750A8C7BFC5A64C0@DB8PR04MB6697.eurprd04.prod.outlook.com>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
 <4741071.g17mCcZVbc@even-i700>
 <DB8PR04MB669746DD5A720750A8C7BFC5A64C0@DB8PR04MB6697.eurprd04.prod.outlook.com>
Message-ID: <974ecb773a61460eba680545ae1e7330@C119S212VM042.msvyvi.vaha.local>

Hi Joaquim,

GMT surface probably has all the features that I need. I followed the tutorial and managed to run surface demos, now I just need to learn how to use my own data as input.

-Jukka- 

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt> 
Lähetetty: keskiviikko 20. marraskuuta 2019 0.30
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

The GMT surface program has two (well 3) options that are of interest to this. 

-One, the -Lu<upper> that serves to limit the upper value in the interpolated grid

-The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.

-Finally, option -M lets you mask the outside lakes region

https://docs.generic-mapping-tools.org/latest/surface.html

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Tuesday, November 19, 2019 10:13 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other 
> utility for lake bathymetry. What I have is typically rather sparse 
> point data of depths and the shoreline that includes the islands as in 
> the attached image. The shoreline and all the area that is not lake 
> basin should have the altitude of zero in the resulting DEM. It means 
> that interpolation should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made 
> a test by converting the vertices of the polygon rings into depth 
> points. I also filled area around the lake with a gridded points of 
> zero altitude but the method feels stupid and tedious and the result 
> was not so fine when it comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From j.l.h.hartmann at uva.nl  Thu Nov 21 08:31:44 2019
From: j.l.h.hartmann at uva.nl (Jan Hartmann)
Date: Thu, 21 Nov 2019 17:31:44 +0100
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <974ecb773a61460eba680545ae1e7330@C119S212VM042.msvyvi.vaha.local>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
 <4741071.g17mCcZVbc@even-i700>
 <DB8PR04MB669746DD5A720750A8C7BFC5A64C0@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <974ecb773a61460eba680545ae1e7330@C119S212VM042.msvyvi.vaha.local>
Message-ID: <ac508177-86a9-4979-19a8-1386f1c95282@uva.nl>

These are important options. It would be nice if they could be 
implemented in gdal_grid itself. Not sure how difficult that would be, 
though.

Jan

On 11/21/2019 5:21 PM, Rahkonen Jukka (MML) wrote:
> Hi Joaquim,
>
> GMT surface probably has all the features that I need. I followed the tutorial and managed to run surface demos, now I just need to learn how to use my own data as input.
>
> -Jukka-
>
> -----Alkuperäinen viesti-----
> Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt>
> Lähetetty: keskiviikko 20. marraskuuta 2019 0.30
> Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
> Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
> Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry
>
> The GMT surface program has two (well 3) options that are of interest to this.
>
> -One, the -Lu<upper> that serves to limit the upper value in the interpolated grid
>
> -The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.
>
> -Finally, option -M lets you mask the outside lakes region
>
> https://docs.generic-mapping-tools.org/latest/surface.html
>
> Joaquim
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
> Sent: Tuesday, November 19, 2019 10:13 PM
> To: gdal-dev at lists.osgeo.org
> Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
> Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry
>
> On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
>> Hi,
>>
>> I would like to get some hints about using gdal_grid or some other
>> utility for lake bathymetry. What I have is typically rather sparse
>> point data of depths and the shoreline that includes the islands as in
>> the attached image. The shoreline and all the area that is not lake
>> basin should have the altitude of zero in the resulting DEM. It means
>> that interpolation should not overshoot across the shoreline over the dry land.
>>
>> Gdal_grid seems to miss an option for handling the shoreline so I made
>> a test by converting the vertices of the polygon rings into depth
>> points. I also filled area around the lake with a gridded points of
>> zero altitude but the method feels stupid and tedious and the result
>> was not so fine when it comes to keep the shoreline and land area near it totally flat.
>>
> Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?
>
> --
> Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From jluis at ualg.pt  Thu Nov 21 11:41:34 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 21 Nov 2019 19:41:34 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <974ecb773a61460eba680545ae1e7330@C119S212VM042.msvyvi.vaha.local>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
 <4741071.g17mCcZVbc@even-i700>
 <DB8PR04MB669746DD5A720750A8C7BFC5A64C0@DB8PR04MB6697.eurprd04.prod.outlook.com>
 <974ecb773a61460eba680545ae1e7330@C119S212VM042.msvyvi.vaha.local>
Message-ID: <DB8PR04MB6697D3C2727C4C17FB377BFCA64E0@DB8PR04MB6697.eurprd04.prod.outlook.com>

Jukka,

GMT will have the ability to read ogr formats (code for that is already in base but need to convert to GMT internal data representation and that is far from trivial). Meanwhile, if needed, just use ogr2ogr to convert your data to plain ascii x y z files (binary data is good as well) and feed it surface.

Joaquim

-----Original Message-----
From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi> 
Sent: Thursday, November 21, 2019 4:22 PM
To: Joaquim Manuel Freire Luís <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: VS: [gdal-dev] Gdal_grid and lake bathymetry

Hi Joaquim,

GMT surface probably has all the features that I need. I followed the tutorial and managed to run surface demos, now I just need to learn how to use my own data as input.

-Jukka- 

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt>
Lähetetty: keskiviikko 20. marraskuuta 2019 0.30
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

The GMT surface program has two (well 3) options that are of interest to this. 

-One, the -Lu<upper> that serves to limit the upper value in the interpolated grid

-The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.

-Finally, option -M lets you mask the outside lakes region

https://docs.generic-mapping-tools.org/latest/surface.html

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Tuesday, November 19, 2019 10:13 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other 
> utility for lake bathymetry. What I have is typically rather sparse 
> point data of depths and the shoreline that includes the islands as in 
> the attached image. The shoreline and all the area that is not lake 
> basin should have the altitude of zero in the resulting DEM. It means 
> that interpolation should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made 
> a test by converting the vertices of the polygon rings into depth 
> points. I also filled area around the lake with a gridded points of 
> zero altitude but the method feels stupid and tedious and the result 
> was not so fine when it comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 21 13:01:47 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 21 Nov 2019 21:01:47 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
Message-ID: <18d81af7bf0e47cfbb2d5b4269101de1@C119S212VM042.msvyvi.vaha.local>

Hi,

I have converted depth points of a small lake into tab separated CSV and I have generated surface, created contours and now I have an amusing plot of something 😊. I am somewhat lost with projections and actually everything but I think it is better to continue the discussion in the GMT Q&A forum. I will be there next week.

-Jukka-

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt> 
Lähetetty: torstai 21. marraskuuta 2019 21.42
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; gdal-dev at lists.osgeo.org
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

Jukka,

GMT will have the ability to read ogr formats (code for that is already in base but need to convert to GMT internal data representation and that is far from trivial). Meanwhile, if needed, just use ogr2ogr to convert your data to plain ascii x y z files (binary data is good as well) and feed it surface.

Joaquim

-----Original Message-----
From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Sent: Thursday, November 21, 2019 4:22 PM
To: Joaquim Manuel Freire Luís <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: VS: [gdal-dev] Gdal_grid and lake bathymetry

Hi Joaquim,

GMT surface probably has all the features that I need. I followed the tutorial and managed to run surface demos, now I just need to learn how to use my own data as input.

-Jukka- 

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt>
Lähetetty: keskiviikko 20. marraskuuta 2019 0.30
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

The GMT surface program has two (well 3) options that are of interest to this. 

-One, the -Lu<upper> that serves to limit the upper value in the interpolated grid

-The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.

-Finally, option -M lets you mask the outside lakes region

https://docs.generic-mapping-tools.org/latest/surface.html

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Tuesday, November 19, 2019 10:13 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other 
> utility for lake bathymetry. What I have is typically rather sparse 
> point data of depths and the shoreline that includes the islands as in 
> the attached image. The shoreline and all the area that is not lake 
> basin should have the altitude of zero in the resulting DEM. It means 
> that interpolation should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made 
> a test by converting the vertices of the polygon rings into depth 
> points. I also filled area around the lake with a gridded points of 
> zero altitude but the method feels stupid and tedious and the result 
> was not so fine when it comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jluis at ualg.pt  Thu Nov 21 13:10:04 2019
From: jluis at ualg.pt (=?utf-8?B?Sm9hcXVpbSBNYW51ZWwgRnJlaXJlIEx1w61z?=)
Date: Thu, 21 Nov 2019 21:10:04 +0000
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <18d81af7bf0e47cfbb2d5b4269101de1@C119S212VM042.msvyvi.vaha.local>
References: <18d81af7bf0e47cfbb2d5b4269101de1@C119S212VM042.msvyvi.vaha.local>
Message-ID: <DB8PR04MB6697155F9D7CDDB036B13D48A64E0@DB8PR04MB6697.eurprd04.prod.outlook.com>

OK, we'll meet there but meanwhile have a look at

https://docs.generic-mapping-tools.org/latest/gmt.html#j-full

and search for the section 

-J<proj4>|EPSG:n

Unfortunately if your GMT is linked against GDAL 3.xx the EPSG form will not work well because of the axis order (lon, lat swapped). This is fixed in GMT master though.

-----Original Message-----
From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi> 
Sent: Thursday, November 21, 2019 9:02 PM
To: Joaquim Manuel Freire Luís <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

Hi,

I have converted depth points of a small lake into tab separated CSV and I have generated surface, created contours and now I have an amusing plot of something 😊. I am somewhat lost with projections and actually everything but I think it is better to continue the discussion in the GMT Q&A forum. I will be there next week.

-Jukka-

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt>
Lähetetty: torstai 21. marraskuuta 2019 21.42
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; gdal-dev at lists.osgeo.org
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

Jukka,

GMT will have the ability to read ogr formats (code for that is already in base but need to convert to GMT internal data representation and that is far from trivial). Meanwhile, if needed, just use ogr2ogr to convert your data to plain ascii x y z files (binary data is good as well) and feed it surface.

Joaquim

-----Original Message-----
From: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Sent: Thursday, November 21, 2019 4:22 PM
To: Joaquim Manuel Freire Luís <jluis at ualg.pt>; gdal-dev at lists.osgeo.org
Subject: VS: [gdal-dev] Gdal_grid and lake bathymetry

Hi Joaquim,

GMT surface probably has all the features that I need. I followed the tutorial and managed to run surface demos, now I just need to learn how to use my own data as input.

-Jukka- 

-----Alkuperäinen viesti-----
Lähettäjä: Joaquim Manuel Freire Luís <jluis at ualg.pt>
Lähetetty: keskiviikko 20. marraskuuta 2019 0.30
Vastaanottaja: Even Rouault <even.rouault at spatialys.com>; gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: RE: [gdal-dev] Gdal_grid and lake bathymetry

The GMT surface program has two (well 3) options that are of interest to this. 

-One, the -Lu<upper> that serves to limit the upper value in the interpolated grid

-The other is the option -D that lets you set a soft-breakline (your shorelines). Soft-breaklines are lines whose vertex end up in the grid nodes closest to them. They are called "soft" in contraposition to the hard-breaklines that do not let the interpolation algorithm go across them. Imagine interpolation a terrain with vertical cliffs. Unfortunately that -D option is missing on the html man page but is described on the surface on line help.

-Finally, option -M lets you mask the outside lakes region

https://docs.generic-mapping-tools.org/latest/surface.html

Joaquim

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Even Rouault
Sent: Tuesday, November 19, 2019 10:13 PM
To: gdal-dev at lists.osgeo.org
Cc: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Subject: Re: [gdal-dev] Gdal_grid and lake bathymetry

On mardi 19 novembre 2019 22:03:29 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I would like to get some hints about using gdal_grid or some other 
> utility for lake bathymetry. What I have is typically rather sparse 
> point data of depths and the shoreline that includes the islands as in 
> the attached image. The shoreline and all the area that is not lake 
> basin should have the altitude of zero in the resulting DEM. It means 
> that interpolation should not overshoot across the shoreline over the dry land.
> 
> Gdal_grid seems to miss an option for handling the shoreline so I made 
> a test by converting the vertices of the polygon rings into depth 
> points. I also filled area around the lake with a gridded points of 
> zero altitude but the method feels stupid and tedious and the result 
> was not so fine when it comes to keep the shoreline and land area near it totally flat.
> 

Postprocessing with gdalwarp -cutline to set to zero non-lake areas ?

--
Spatialys - Geospatial professional services http://www.spatialys.com _______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From neteler at osgeo.org  Thu Nov 21 14:06:33 2019
From: neteler at osgeo.org (Markus Neteler)
Date: Thu, 21 Nov 2019 23:06:33 +0100
Subject: [gdal-dev] Gdal_grid and lake bathymetry
In-Reply-To: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
References: <dee9cd4ab66443749081efadadbaf489@C119S212VM042.msvyvi.vaha.local>
Message-ID: <CALFmHhswtuf9kF2kZyx-RFmAFyNk9cM1Ub-MgoX6JRCA3zucNA@mail.gmail.com>

On Tue, Nov 19, 2019 at 11:03 PM Rahkonen Jukka (MML)
<jukka.rahkonen at maanmittauslaitos.fi> wrote:
>
> Hi,
>
> I would like to get some hints about using gdal_grid or some other utility for lake bathymetry. What I have is typically rather sparse point data of depths and the shoreline that includes the islands as in the attached image. The shoreline and all the area that is not lake basin should have the altitude of zero in the resulting DEM. It means that interpolation should not overshoot across the shoreline over the dry land.
>
> Gdal_grid seems to miss an option for handling the shoreline so I made a test by converting the vertices of the polygon rings into depth points. I also filled area around the lake with a gridded points of zero altitude but the method feels stupid and tedious and the result was not so fine when it comes to keep the shoreline and land area near it totally flat.
>
> If there are any specialists on bathymetry reading I am eager to learn how to handle my data.

Just FYI, GRASS GIS offers several methods as well:
- https://grasswiki.osgeo.org/wiki/Interpolation#Reinterpolation_of_.22sparse.22_.28scattered_points_or_lines.29_maps
- https://grasswiki.osgeo.org/wiki/Contour_lines_to_DEM

Markus

From tony_lst3 at yahoo.com  Fri Nov 22 09:24:58 2019
From: tony_lst3 at yahoo.com (Tony L.)
Date: Fri, 22 Nov 2019 17:24:58 +0000 (UTC)
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
Message-ID: <297701659.4096243.1574443498709@mail.yahoo.com>

HelloI'm quite new with gdal and would like to use is to rewrite a geotiff of NSIDC sea ice concentration from geotiff in polar stereographic projection into a netcdf in Lon Lat coordinates
The file is located here: N_197901_concentration_v3.0.tif

| 
| 
| 
|  |  |

 |

 |
| 
|  | 
N_197901_concentration_v3.0.tif

Shared with Dropbox
 |

 |

 |


I was able to transform the file into a netcdf file using gdal_translate:
gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
But I'm still trying to figure out how to translate this into Lon Lat coordinates (probably using gdalwarp)
Any help would be really appreciated!
Tony
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191122/2f664544/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Fri Nov 22 10:19:26 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 22 Nov 2019 14:19:26 -0400
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <297701659.4096243.1574443498709@mail.yahoo.com>
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
 <297701659.4096243.1574443498709@mail.yahoo.com>
Message-ID: <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>

Hi Tony,

Here are my steps.

Have a nice weekend.


***********

#use gdalinfo to get summary (see https://gdal.org/programs/gdalinfo.html)
gdalinfo -noct N_197901_concentration_v3.0.tif

#review source EPSG projection (found from gdalinfo command above)
in web browser goto: http://epsg.io/3411

#review desired output projection (lat/long)
in web browser goto: http://epsg.io/4326

#transform to NetCDF
gdal_translate -f netCDF N_197901_concentration_v3.0.tif 
N_197901_concentration_v3.0.nc

#reproject to lat/long, which is EPSG:4326 
(https://gdal.org/programs/gdalwarp.html)
gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326 
N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc

#examine reprojected file (verify "corner coordinates" look proper)
gdalinfo -noct N_197901_concentration_v3.0_4326.nc

   * for all commands I used MS4W 4.0.1, on Windows, from https://ms4w.com

******


-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/



On 2019-11-22 1:24 PM, Tony L. wrote:
> Hello
> I'm quite new with gdal and would like to use is to rewrite a geotiff of 
> NSIDC sea ice concentration from geotiff in polar stereographic 
> projection into a netcdf in Lon Lat coordinates
> 
> The file is located here: N_197901_concentration_v3.0.tif 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
> 	
> 
> 	
> 
> 
>     N_197901_concentration_v3.0.tif
> 
> Shared with Dropbox
> 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
> I was able to transform the file into a netcdf file using gdal_translate:
> 
> gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
> 
> But I'm still trying to figure out how to translate this into Lon Lat 
> coordinates (probably using gdalwarp)
> 
> Any help would be really appreciated!
> 
> Tony
> 

From phigginsca at yahoo.com  Fri Nov 22 10:51:28 2019
From: phigginsca at yahoo.com (Paul Higgins)
Date: Fri, 22 Nov 2019 18:51:28 +0000 (UTC)
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <mailman.66469.1574444102.17185.gdal-dev@lists.osgeo.org>
References: <mailman.66469.1574444102.17185.gdal-dev@lists.osgeo.org>
Message-ID: <226975860.4140444.1574448688652@mail.yahoo.com>

 Try this:
gdal_translate -of netCDF -a_srs +proj=longlat N_197901_concentration_v3.0.tif out.nc

   Paul  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191122/5cd9b132/attachment.html>

From jachym.cepicky at gmail.com  Fri Nov 22 12:11:45 2019
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Fri, 22 Nov 2019 21:11:45 +0100
Subject: [gdal-dev] arcsde
Message-ID: <CAAZUH4FtyBA0wLEyFdgS8aFvOySykwNJCy_8PEDoiGP0R_r4tg@mail.gmail.com>

Hi all,

I would expect, this topic would be covered in [1], or that google
would help - unluckily, it did not, therefore I'm asking here:

Is there step-by-step approach for how to get GDAL compiled with
support for ArcSDE data sources on Linux? What libraries are needed
and where to get them?

Some manual simple and similar to description about how to get
Geodatabase up and running would be nice.

Thank you

Jachym

[1] https://gdal.org/drivers/vector/sde.html
-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/pgp/JachymCepicky.pgp

From even.rouault at spatialys.com  Fri Nov 22 12:42:33 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 22 Nov 2019 21:42:33 +0100
Subject: [gdal-dev] arcsde
In-Reply-To: <CAAZUH4FtyBA0wLEyFdgS8aFvOySykwNJCy_8PEDoiGP0R_r4tg@mail.gmail.com>
References: <CAAZUH4FtyBA0wLEyFdgS8aFvOySykwNJCy_8PEDoiGP0R_r4tg@mail.gmail.com>
Message-ID: <1838136.0GVePi4Vmj@even-i700>

Jachym,

Some more info at https://trac.osgeo.org/gdal/wiki/ArcSDE

from what I remember from noise captured here and there during last years:
- ESRI has stopped distributing the ArcSDE SDK in "recent" versions. So you have to
be one the "happy few" that have still a copy of it to be able to - try to - compile the driver
- looking at the commit history, the person who has last pushed a fix in this
driver, and presumably compiled it while doing so, was Tamas in 2012. Since
then all commits into it have likely been done in a blind way (grep-style replacement, etc)
Perhaps it still builds, by chance... ?

Not GDAL, but you might find it interesting to read:
https://knowledge.safe.com/articles/73399/esri-legacy-arcsde-sde30-deprecation.html

Probably this driver and its raster counterpart should just be removed.
Unless someone says "eh I still use it, it compiles and runs fine"

Good luck !

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdal-dev at coulmann.de  Sat Nov 23 08:05:21 2019
From: gdal-dev at coulmann.de (wulf)
Date: Sat, 23 Nov 2019 17:05:21 +0100
Subject: [gdal-dev] no OBJNAM/NOBJNM after extract distance marks from IENC
Message-ID: <20191123160519.GR29961@coulmann.de>



Hallo,

I like to extract distance marks from S57 IENC

if I run:
  ogr2ogr -skipfailures -f CSV x.csv 1W7ML310.000 -lco GEOMETRY=AS_XY

I get:
  X,Y,RCID,PRIM,GRUP,OBJL,RVER,AGEN,FIDN,FIDS,LNAM,LNAM_REFS,FFPT_RIND,catdis,DATEND,DATSTA,NOBJNM,OBJNAM,INFORM,NINFOM,NTXTDS,PICREP,SCAMIN,TXTDSC,updmsg,SORDAT,SORIND
  11.5270611,52.2419757,"291","1","2","17004","1","7984","1526304445","36",1F305AF98EBD0024,,,"1",,,, , ,,,,"8000",,,,

I miss the value of the distanc mark (maybe OBJNAM or NOBJNM). If I open the data source with an editor I
find something like
  ¨B310.1^_µBDENQB031010000003101^_ÏB3^_"
 
  where 310.1 refers to "km 310.1" and 031010000003101 is a combination
  of an waterwaynumber "031010000" and the distanz as intager "3101"
so information is present.

How to get it extracted with every row?


you find the S57 data here:
  http://gpl.coulmann.de/tmp/1W7ML310.000
  which is original extracted from
  (provided by german inland waterway administration)
  https://www.elwis.de/DE/dynamisch/IENC/download_commit.php?file=WW41_2018-06-22_0_318

Thanks for the effort
Wulf



From even.rouault at spatialys.com  Sat Nov 23 11:07:35 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 23 Nov 2019 20:07:35 +0100
Subject: [gdal-dev] Deprecation and removal ideas
Message-ID: <2559279.yUjSag4U9h@even-i700>

Hi,

We keep adding features, but there are certainly a few good candidates for 
future removal

I've initiated with my ideas:
https://github.com/OSGeo/gdal/wiki/Deprecation-&-removal-ideas

Others ?

(I didn't include in it the imminent removal of the GFT driver per
https://github.com/OSGeo/gdal/issues/2050 which logically follows server-side 
policy. We had a similar occurence with the GME driver)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Sun Nov 24 05:51:07 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 24 Nov 2019 14:51:07 +0100
Subject: [gdal-dev] Backport bot no longer working
Message-ID: <1602242.eBPBc1Fh4R@even-i700>

Hi,

just wanted to share this info. Affects other friend projects as well
See https://github.com/OSGeo/PROJ/issues/1741 for a few details

Pending a potential future resolution, the old-school backporting method with 
"git cherry-pick" should be applied

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From hn.jiang at whu.edu.cn  Sun Nov 24 19:33:53 2019
From: hn.jiang at whu.edu.cn (Jiang)
Date: Mon, 25 Nov 2019 11:33:53 +0800
Subject: [gdal-dev] GDAL for sentinal-1 data
Message-ID: <5DDB4B99.107F96.19304@whu.edu.cn>

How to input sentinal-1 data？As you know this data format is .safe. I want to do the geocoding for sentinal-1. Seems I have to input data first, my data have three swaths so I think I should input .safe first.
发送自 Windows 10 版邮件应用

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/de745e60/attachment.html>

From jachym.cepicky at gmail.com  Mon Nov 25 00:47:52 2019
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Mon, 25 Nov 2019 09:47:52 +0100
Subject: [gdal-dev] arcsde
In-Reply-To: <1838136.0GVePi4Vmj@even-i700>
References: <CAAZUH4FtyBA0wLEyFdgS8aFvOySykwNJCy_8PEDoiGP0R_r4tg@mail.gmail.com>
 <1838136.0GVePi4Vmj@even-i700>
Message-ID: <CAAZUH4Eut+B4Et1_Ug=ubiYMj3TS+WkhgW5Ya4Bu2qb_+9higg@mail.gmail.com>

Thank you Even, will look into it

Removing SDE from list of supported formats makes sense

J

pá 22. 11. 2019 v 21:42 odesílatel Even Rouault
<even.rouault at spatialys.com> napsal:
>
> Jachym,
>
> Some more info at https://trac.osgeo.org/gdal/wiki/ArcSDE
>
> from what I remember from noise captured here and there during last years:
> - ESRI has stopped distributing the ArcSDE SDK in "recent" versions. So you have to
> be one the "happy few" that have still a copy of it to be able to - try to - compile the driver
> - looking at the commit history, the person who has last pushed a fix in this
> driver, and presumably compiled it while doing so, was Tamas in 2012. Since
> then all commits into it have likely been done in a blind way (grep-style replacement, etc)
> Perhaps it still builds, by chance... ?
>
> Not GDAL, but you might find it interesting to read:
> https://knowledge.safe.com/articles/73399/esri-legacy-arcsde-sde30-deprecation.html
>
> Probably this driver and its raster counterpart should just be removed.
> Unless someone says "eh I still use it, it compiles and runs fine"
>
> Good luck !
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com



-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/pgp/JachymCepicky.pgp

From gerardg at gmail.com  Mon Nov 25 08:57:45 2019
From: gerardg at gmail.com (Gerard)
Date: Mon, 25 Nov 2019 09:57:45 -0700
Subject: [gdal-dev] Adding Features to Existing PostIGIS Table with Python
	OGR/GDAL?
Message-ID: <CAKw=BhPSZS0mggyG0dLDtk7YMOtUO0fsY9Od0Z5WCEA-WXLB-Q@mail.gmail.com>

Is it possible to add features to an existing PostGIS table using Python
OGR/GDAL? I've tried these two approaches:

# Approach 1. Results in:
# ERROR 1: Layer tracks already exists, CreateLayer failed.
# Use the layer creation option OVERWRITE=YES to replace it.
ds = ogr.Open("PG:dbname='db' user='user'")
srs = osr.SpatialReference()
srs.ImportFromEPSG(4326)
layer = ds.CreateLayer('tracks', srs, ogr.wkbMultiLineString,
['OVERWRITE=NO'] )

# Approach 2. Results in:
# ERROR 1: Invalid index : -1
# ERROR 6: CreateFeature : unsupported operation on a read-only datasource.
ds = ogr.Open("PG:dbname='db' user='user'")
layer = ds.GetLayerByName('tracks')
# set fields, etc.
layer.CreateFeature(outFeature)

Think I could accomplish it via SQL statements and ds.ExecuteSQL(), and
I've found examples using psycopg2 (or SQLAlchemy) instead. Just wondering
if it's directly possible using Python OGR/GDAL.

Thanks,
Gerard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/6cadecd4/attachment.html>

From junt0015 at umn.edu  Mon Nov 25 10:23:56 2019
From: junt0015 at umn.edu (Thomas Juntunen)
Date: Mon, 25 Nov 2019 12:23:56 -0600
Subject: [gdal-dev] Adding Features to Existing PostIGIS Table with
	Python OGR/GDAL?
In-Reply-To: <CAKw=BhPSZS0mggyG0dLDtk7YMOtUO0fsY9Od0Z5WCEA-WXLB-Q@mail.gmail.com>
References: <CAKw=BhPSZS0mggyG0dLDtk7YMOtUO0fsY9Od0Z5WCEA-WXLB-Q@mail.gmail.com>
Message-ID: <CAF028HV-=7xxR1+mTxUE14vNR+JOQwZGE0r=EZnzaEz2G-fZcw@mail.gmail.com>

Gerard,
You need to open your data source in update mode.
ds = ogr.Open("PG:dbname='db' user='user'", update=1)

On Mon, Nov 25, 2019 at 10:58 AM Gerard <gerardg at gmail.com> wrote:

> Is it possible to add features to an existing PostGIS table using Python
> OGR/GDAL? I've tried these two approaches:
>
> # Approach 1. Results in:
> # ERROR 1: Layer tracks already exists, CreateLayer failed.
> # Use the layer creation option OVERWRITE=YES to replace it.
> ds = ogr.Open("PG:dbname='db' user='user'")
> srs = osr.SpatialReference()
> srs.ImportFromEPSG(4326)
> layer = ds.CreateLayer('tracks', srs, ogr.wkbMultiLineString,
> ['OVERWRITE=NO'] )
>
> # Approach 2. Results in:
> # ERROR 1: Invalid index : -1
> # ERROR 6: CreateFeature : unsupported operation on a read-only datasource.
> ds = ogr.Open("PG:dbname='db' user='user'")
> layer = ds.GetLayerByName('tracks')
> # set fields, etc.
> layer.CreateFeature(outFeature)
>
> Think I could accomplish it via SQL statements and ds.ExecuteSQL(), and
> I've found examples using psycopg2 (or SQLAlchemy) instead. Just wondering
> if it's directly possible using Python OGR/GDAL.
>
> Thanks,
> Gerard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
*The right coordinate system can turn an impossible problem into two really
hard problems. -- Charlie Pellerin*

Thomas Juntunen
GIS Specialist
Polar Geospatial Center
R280 Learning and Environmental Science
1954 Buford Ave
University of Minnesota
St. Paul, MN 55108
612-626-0505
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/8303aa39/attachment.html>

From tony_lst3 at yahoo.com  Mon Nov 25 12:11:48 2019
From: tony_lst3 at yahoo.com (Tony L.)
Date: Mon, 25 Nov 2019 20:11:48 +0000 (UTC)
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
 <297701659.4096243.1574443498709@mail.yahoo.com>
 <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
Message-ID: <1306573276.5210350.1574712708922@mail.yahoo.com>

 Hello Jeff!Thank you so much for your help!!I tried to follow your steps and works well for the transformation from tif to netcdf. I can use ncdump to check info on the file and I can plot it normally.
Now, when I reproject the file to lat/lon coord using your command:
gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326 N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc
and when I try to get info on the file using ncdump -h I get:ncdump: N_197901_concentration_v3.0_4326.nc: NetCDF: Unknown file format

Any idea as to why that would happen?
Tony
    On Friday, November 22, 2019, 01:19:50 PM EST, Jeff McKenna <jmckenna at gatewaygeomatics.com> wrote:  
 
 Hi Tony,

Here are my steps.

Have a nice weekend.


***********

#use gdalinfo to get summary (see https://gdal.org/programs/gdalinfo.html)
gdalinfo -noct N_197901_concentration_v3.0.tif

#review source EPSG projection (found from gdalinfo command above)
in web browser goto: http://epsg.io/3411

#review desired output projection (lat/long)
in web browser goto: http://epsg.io/4326

#transform to NetCDF
gdal_translate -f netCDF N_197901_concentration_v3.0.tif 
N_197901_concentration_v3.0.nc

#reproject to lat/long, which is EPSG:4326 
(https://gdal.org/programs/gdalwarp.html)
gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326 
N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc

#examine reprojected file (verify "corner coordinates" look proper)
gdalinfo -noct N_197901_concentration_v3.0_4326.nc

  * for all commands I used MS4W 4.0.1, on Windows, from https://ms4w.com

******


-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/



On 2019-11-22 1:24 PM, Tony L. wrote:
> Hello
> I'm quite new with gdal and would like to use is to rewrite a geotiff of 
> NSIDC sea ice concentration from geotiff in polar stereographic 
> projection into a netcdf in Lon Lat coordinates
> 
> The file is located here: N_197901_concentration_v3.0.tif 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
>     
> 
>     
> 
> 
>    N_197901_concentration_v3.0.tif
> 
> Shared with Dropbox
> 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
> I was able to transform the file into a netcdf file using gdal_translate:
> 
> gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
> 
> But I'm still trying to figure out how to translate this into Lon Lat 
> coordinates (probably using gdalwarp)
> 
> Any help would be really appreciated!
> 
> Tony
> 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/8d02dc4b/attachment.html>

From tony_lst3 at yahoo.com  Mon Nov 25 12:20:29 2019
From: tony_lst3 at yahoo.com (Tony L.)
Date: Mon, 25 Nov 2019 20:20:29 +0000 (UTC)
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
 <297701659.4096243.1574443498709@mail.yahoo.com>
 <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
Message-ID: <2054338190.5231505.1574713229164@mail.yahoo.com>

 Hello Paul,Thanks for your reply, I tried the command you suggested but the resulting file doesn't seem to plot correctly. Any suggestion?
Tony
 Try this:
gdal_translate -of netCDF -a_srs +proj=longlat N_197901_concentration_v3.0.tif out.nc

   Paul 


On 2019-11-22 1:24 PM, Tony L. wrote:
> Hello
> I'm quite new with gdal and would like to use is to rewrite a geotiff of 
> NSIDC sea ice concentration from geotiff in polar stereographic 
> projection into a netcdf in Lon Lat coordinates
> 
> The file is located here: N_197901_concentration_v3.0.tif 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
>     
> 
>     
> 
> 
>    N_197901_concentration_v3.0.tif
> 
> Shared with Dropbox
> 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
> I was able to transform the file into a netcdf file using gdal_translate:
> 
> gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
> 
> But I'm still trying to figure out how to translate this into Lon Lat 
> coordinates (probably using gdalwarp)
> 
> Any help would be really appreciated!
> 
> Tony
> 
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/463ece7b/attachment.html>

From gerardg at gmail.com  Mon Nov 25 12:59:54 2019
From: gerardg at gmail.com (Gerard)
Date: Mon, 25 Nov 2019 13:59:54 -0700
Subject: [gdal-dev] Adding Features to Existing PostIGIS Table with
	Python OGR/GDAL?
In-Reply-To: <CAF028HV-=7xxR1+mTxUE14vNR+JOQwZGE0r=EZnzaEz2G-fZcw@mail.gmail.com>
References: <CAKw=BhPSZS0mggyG0dLDtk7YMOtUO0fsY9Od0Z5WCEA-WXLB-Q@mail.gmail.com>
 <CAF028HV-=7xxR1+mTxUE14vNR+JOQwZGE0r=EZnzaEz2G-fZcw@mail.gmail.com>
Message-ID: <CAKw=BhNv=aLi6heSBGKzGz-Gz+BnYoRd-pwSFOPO0SB_-5wZ-w@mail.gmail.com>

Thanks!

def Open(*args, **kwargs):
      """Open(char const * utf8_path, int update=0) -> DataSource"""
      return _ogr.Open(*args, **kwargs)

This still causes an error, even though OVERWRITE is set to NO.
ds = ogr.Open("PG:dbname='db' user='user'", update=1)
# .....
trackslayer = ds.CreateLayer(table, srs, ogr.wkbMultiLineString,
['OVERWRITE=NO'] )

However, this seems to work fine:
trackslayer = ds.GetLayerByName('tracks')
tracksdef = trackslayer.GetLayerDefn()
outFeature = ogr.Feature(tracksdef)
outFeature.SetField("name", name)
# .....
trackslayer.CreateFeature(outFeature)

Gerard


On Mon, Nov 25, 2019 at 11:24 AM Thomas Juntunen <junt0015 at umn.edu> wrote:

> Gerard,
> You need to open your data source in update mode.
> ds = ogr.Open("PG:dbname='db' user='user'", update=1)
>
> On Mon, Nov 25, 2019 at 10:58 AM Gerard <gerardg at gmail.com> wrote:
>
>> Is it possible to add features to an existing PostGIS table using Python
>> OGR/GDAL? I've tried these two approaches:
>>
>> # Approach 1. Results in:
>> # ERROR 1: Layer tracks already exists, CreateLayer failed.
>> # Use the layer creation option OVERWRITE=YES to replace it.
>> ds = ogr.Open("PG:dbname='db' user='user'")
>> srs = osr.SpatialReference()
>> srs.ImportFromEPSG(4326)
>> layer = ds.CreateLayer('tracks', srs, ogr.wkbMultiLineString,
>> ['OVERWRITE=NO'] )
>>
>> # Approach 2. Results in:
>> # ERROR 1: Invalid index : -1
>> # ERROR 6: CreateFeature : unsupported operation on a read-only
>> datasource.
>> ds = ogr.Open("PG:dbname='db' user='user'")
>> layer = ds.GetLayerByName('tracks')
>> # set fields, etc.
>> layer.CreateFeature(outFeature)
>>
>> Think I could accomplish it via SQL statements and ds.ExecuteSQL(), and
>> I've found examples using psycopg2 (or SQLAlchemy) instead. Just wondering
>> if it's directly possible using Python OGR/GDAL.
>>
>> Thanks,
>> Gerard
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
> *The right coordinate system can turn an impossible problem into two
> really hard problems. -- Charlie Pellerin*
>
> Thomas Juntunen
> GIS Specialist
> Polar Geospatial Center
> R280 Learning and Environmental Science
> 1954 Buford Ave
> University of Minnesota
> St. Paul, MN 55108
> 612-626-0505
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/389aa9f2/attachment-0001.html>

From junt0015 at umn.edu  Mon Nov 25 13:29:28 2019
From: junt0015 at umn.edu (Thomas Juntunen)
Date: Mon, 25 Nov 2019 15:29:28 -0600
Subject: [gdal-dev] Adding Features to Existing PostIGIS Table with
	Python OGR/GDAL?
In-Reply-To: <CAKw=BhNv=aLi6heSBGKzGz-Gz+BnYoRd-pwSFOPO0SB_-5wZ-w@mail.gmail.com>
References: <CAKw=BhPSZS0mggyG0dLDtk7YMOtUO0fsY9Od0Z5WCEA-WXLB-Q@mail.gmail.com>
 <CAF028HV-=7xxR1+mTxUE14vNR+JOQwZGE0r=EZnzaEz2G-fZcw@mail.gmail.com>
 <CAKw=BhNv=aLi6heSBGKzGz-Gz+BnYoRd-pwSFOPO0SB_-5wZ-w@mail.gmail.com>
Message-ID: <CAF028HV9hVN9NbVOjA6Vhjc4hXyJdjv2ioh_PkuY=c-bOgMK3w@mail.gmail.com>

Hi Gerard,
Your first example is trying to make a new layer (table), and since
trackslayer exists, and you selected overwrite is NO, it raises an error
because you're trying to replace the table. If you are adding features to
an existing table, your second method is the way to do it. You only need
CreateLayer for new tables.


On Mon, Nov 25, 2019 at 3:00 PM Gerard <gerardg at gmail.com> wrote:

> Thanks!
>
> def Open(*args, **kwargs):
>       """Open(char const * utf8_path, int update=0) -> DataSource"""
>       return _ogr.Open(*args, **kwargs)
>
> This still causes an error, even though OVERWRITE is set to NO.
> ds = ogr.Open("PG:dbname='db' user='user'", update=1)
> # .....
> trackslayer = ds.CreateLayer(table, srs, ogr.wkbMultiLineString,
> ['OVERWRITE=NO'] )
>
> However, this seems to work fine:
> trackslayer = ds.GetLayerByName('tracks')
> tracksdef = trackslayer.GetLayerDefn()
> outFeature = ogr.Feature(tracksdef)
> outFeature.SetField("name", name)
> # .....
> trackslayer.CreateFeature(outFeature)
>
> Gerard
>
>
> On Mon, Nov 25, 2019 at 11:24 AM Thomas Juntunen <junt0015 at umn.edu> wrote:
>
>> Gerard,
>> You need to open your data source in update mode.
>> ds = ogr.Open("PG:dbname='db' user='user'", update=1)
>>
>> On Mon, Nov 25, 2019 at 10:58 AM Gerard <gerardg at gmail.com> wrote:
>>
>>> Is it possible to add features to an existing PostGIS table using Python
>>> OGR/GDAL? I've tried these two approaches:
>>>
>>> # Approach 1. Results in:
>>> # ERROR 1: Layer tracks already exists, CreateLayer failed.
>>> # Use the layer creation option OVERWRITE=YES to replace it.
>>> ds = ogr.Open("PG:dbname='db' user='user'")
>>> srs = osr.SpatialReference()
>>> srs.ImportFromEPSG(4326)
>>> layer = ds.CreateLayer('tracks', srs, ogr.wkbMultiLineString,
>>> ['OVERWRITE=NO'] )
>>>
>>> # Approach 2. Results in:
>>> # ERROR 1: Invalid index : -1
>>> # ERROR 6: CreateFeature : unsupported operation on a read-only
>>> datasource.
>>> ds = ogr.Open("PG:dbname='db' user='user'")
>>> layer = ds.GetLayerByName('tracks')
>>> # set fields, etc.
>>> layer.CreateFeature(outFeature)
>>>
>>> Think I could accomplish it via SQL statements and ds.ExecuteSQL(), and
>>> I've found examples using psycopg2 (or SQLAlchemy) instead. Just wondering
>>> if it's directly possible using Python OGR/GDAL.
>>>
>>> Thanks,
>>> Gerard
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>> --
>> *The right coordinate system can turn an impossible problem into two
>> really hard problems. -- Charlie Pellerin*
>>
>> Thomas Juntunen
>> GIS Specialist
>> Polar Geospatial Center
>> R280 Learning and Environmental Science
>> 1954 Buford Ave
>> University of Minnesota
>> St. Paul, MN 55108
>> 612-626-0505
>>
>

-- 
*The right coordinate system can turn an impossible problem into two really
hard problems. -- Charlie Pellerin*

Thomas Juntunen
GIS Specialist
Polar Geospatial Center
R280 Learning and Environmental Science
1954 Buford Ave
University of Minnesota
St. Paul, MN 55108
612-626-0505
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191125/2171ef41/attachment.html>

From jmckenna at gatewaygeomatics.com  Mon Nov 25 14:44:22 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 25 Nov 2019 18:44:22 -0400
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <1306573276.5210350.1574712708922@mail.yahoo.com>
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
 <297701659.4096243.1574443498709@mail.yahoo.com>
 <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
 <1306573276.5210350.1574712708922@mail.yahoo.com>
Message-ID: <f41e235f-6a0c-f9ac-e9b1-97502cd56bcf@gatewaygeomatics.com>

Hi Tony,

When I execute 'ncdump -h' locally on your generated file I get a proper 
response (see https://pastebin.com/Ki4BTTNS).  Note that MS4W is 
currently built against netCDF-4.7.0 (maybe you have an older netCDF 
library version?)

PS. I'll shortly be upgrading netCDF support to the recent 4.7.3 release 
for Windows users (follow along if you wish at 
https://ms4w.com/trac/ticket/238)

Hope that helps.

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/


On 2019-11-25 4:11 PM, Tony L. wrote:
> Hello Jeff!
> Thank you so much for your help!!
> I tried to follow your steps and works well for the transformation from 
> tif to netcdf. I can use ncdump to check info on the file and I can plot 
> it normally.
> 
> Now, when I reproject the file to lat/lon coord using your command:
> 
> gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326 
> N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc
> 
> and when I try to get info on the file using ncdump -h I get:
> ncdump: N_197901_concentration_v3.0_4326.nc: NetCDF: Unknown file format
> 
> Any idea as to why that would happen?
> 
> Tony
> 
> On Friday, November 22, 2019, 01:19:50 PM EST, Jeff McKenna 
> <jmckenna at gatewaygeomatics.com> wrote:
> 
> 
> Hi Tony,
> 
> Here are my steps.
> 
> Have a nice weekend.
> 
> 
> ***********
> 
> #use gdalinfo to get summary (see https://gdal.org/programs/gdalinfo.html)
> gdalinfo -noct N_197901_concentration_v3.0.tif
> 
> #review source EPSG projection (found from gdalinfo command above)
> in web browser goto: http://epsg.io/3411
> 
> #review desired output projection (lat/long)
> in web browser goto: http://epsg.io/4326
> 
> #transform to NetCDF
> gdal_translate -f netCDF N_197901_concentration_v3.0.tif
> N_197901_concentration_v3.0.nc
> 
> #reproject to lat/long, which is EPSG:4326
> (https://gdal.org/programs/gdalwarp.html)
> gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326
> N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc
> 
> #examine reprojected file (verify "corner coordinates" look proper)
> gdalinfo -noct N_197901_concentration_v3.0_4326.nc
> 
>    * for all commands I used MS4W 4.0.1, on Windows, from https://ms4w.com
> 
> ******
> 
> 
> -- 
> Jeff McKenna
> MapServer Consulting and Training Services
> https://gatewaygeomatics.com/
> 
> 
> 
> On 2019-11-22 1:24 PM, Tony L. wrote:
>  > Hello
>  > I'm quite new with gdal and would like to use is to rewrite a geotiff of
>  > NSIDC sea ice concentration from geotiff in polar stereographic
>  > projection into a netcdf in Lon Lat coordinates
>  >
>  > The file is located here: N_197901_concentration_v3.0.tif
>  > 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
>  >
>  >
>  >
>  >
>  >
>  >
>  >    N_197901_concentration_v3.0.tif
>  >
>  > Shared with Dropbox
>  >
>  > 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
>  >
>  > I was able to transform the file into a netcdf file using gdal_translate:
>  >
>  > gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
>  >
>  > But I'm still trying to figure out how to translate this into Lon Lat
>  > coordinates (probably using gdalwarp)
>  >
>  > Any help would be really appreciated!
>  >
>  > Tony
> 
>  >


From jmckenna at gatewaygeomatics.com  Mon Nov 25 14:58:00 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 25 Nov 2019 18:58:00 -0400
Subject: [gdal-dev] Export a geotiff to netcdf in lat lon coordinates
In-Reply-To: <1306573276.5210350.1574712708922@mail.yahoo.com>
References: <297701659.4096243.1574443498709.ref@mail.yahoo.com>
 <297701659.4096243.1574443498709@mail.yahoo.com>
 <766f23b6-ec8f-4eae-68e4-4f6f1688d8b7@gatewaygeomatics.com>
 <1306573276.5210350.1574712708922@mail.yahoo.com>
Message-ID: <59498e01-ecf5-b581-bf2a-368e2f7913a8@gatewaygeomatics.com>

Hi Tony,

Also, if I execute 'ncdump -k N_197901_concentration_v3.0_4326.nc' the 
response is "classic".  (apparently the -k switch shows the 'kind' of 
netCDF file)

Hope that also helps,

-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/



On 2019-11-25 4:11 PM, Tony L. wrote:
> Hello Jeff!
> Thank you so much for your help!!
> I tried to follow your steps and works well for the transformation from 
> tif to netcdf. I can use ncdump to check info on the file and I can plot 
> it normally.
> 
> Now, when I reproject the file to lat/lon coord using your command:
> 
> gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326 
> N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc
> 
> and when I try to get info on the file using ncdump -h I get:
> ncdump: N_197901_concentration_v3.0_4326.nc: NetCDF: Unknown file format
> 
> Any idea as to why that would happen?
> 
> Tony
> 
> On Friday, November 22, 2019, 01:19:50 PM EST, Jeff McKenna 
> <jmckenna at gatewaygeomatics.com> wrote:
> 
> 
> Hi Tony,
> 
> Here are my steps.
> 
> Have a nice weekend.
> 
> 
> ***********
> 
> #use gdalinfo to get summary (see https://gdal.org/programs/gdalinfo.html)
> gdalinfo -noct N_197901_concentration_v3.0.tif
> 
> #review source EPSG projection (found from gdalinfo command above)
> in web browser goto: http://epsg.io/3411
> 
> #review desired output projection (lat/long)
> in web browser goto: http://epsg.io/4326
> 
> #transform to NetCDF
> gdal_translate -f netCDF N_197901_concentration_v3.0.tif
> N_197901_concentration_v3.0.nc
> 
> #reproject to lat/long, which is EPSG:4326
> (https://gdal.org/programs/gdalwarp.html)
> gdalwarp -s_srs EPSG:3411 -t_srs EPSG:4326
> N_197901_concentration_v3.0.nc N_197901_concentration_v3.0_4326.nc
> 
> #examine reprojected file (verify "corner coordinates" look proper)
> gdalinfo -noct N_197901_concentration_v3.0_4326.nc
> 
>    * for all commands I used MS4W 4.0.1, on Windows, from https://ms4w.com
> 
> ******
> 
> 
> -- 
> Jeff McKenna
> MapServer Consulting and Training Services
> https://gatewaygeomatics.com/
> 
> 
> 
> On 2019-11-22 1:24 PM, Tony L. wrote:
>  > Hello
>  > I'm quite new with gdal and would like to use is to rewrite a geotiff of
>  > NSIDC sea ice concentration from geotiff in polar stereographic
>  > projection into a netcdf in Lon Lat coordinates
>  >
>  > The file is located here: N_197901_concentration_v3.0.tif
>  > 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
>  >
>  >
>  >
>  >
>  >
>  >
>  >    N_197901_concentration_v3.0.tif
>  >
>  > Shared with Dropbox
>  >
>  > 
> <https://www.dropbox.com/s/bkqt6qgyhpr7vjk/N_197901_concentration_v3.0.tif?dl=0>
> 
>  >
>  > I was able to transform the file into a netcdf file using gdal_translate:
>  >
>  > gdal_translate -of netCDF N_197901_concentration_v3.0.tif out.nc
>  >
>  > But I'm still trying to figure out how to translate this into Lon Lat
>  > coordinates (probably using gdalwarp)
>  >
>  > Any help would be really appreciated!
>  >
>  > Tony
> 
>  >


From even.rouault at spatialys.com  Tue Nov 26 04:57:48 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 Nov 2019 13:57:48 +0100
Subject: [gdal-dev] Fwd: Call for review on RFC 4 text: Remote access to
	grids and GeoTIFF grids
Message-ID: <6418055.GlC2NCuTSC@even-i700>

Hi,

Please find below a PROJ RFC.

This is of interest for GDAL as a "consumer". GDAL will also be a marginal 
actor of this effort, as the COG driver will be tuned a bit to be able to 
generate the GeoTIFF based grids, and there will be a few conversion scripts 
between existing grid formats and this new one.

Even

----------  Forwarded Message  ----------

Subject: Call for review on RFC 4 text: Remote access to grids and GeoTIFF 
grids
Date: lundi 25 novembre 2019, 13:46:37 CET
From: Even Rouault <even.rouault at spatialys.com>
To: proj at lists.osgeo.org

Hi,

As announced last week, you'll find a RFC describing two new capabilities,
remote access to grids and a GeoTIFF-based format for grids, in
https://github.com/OSGeo/PROJ/pull/1747

You can get an (almost correct) preview of it by going through
https://github.com/rouault/PROJ/blob/rfc4_remote_and_geotiff_grid/docs/source/
community/rfc/rfc-4.rst
(some links will not work in this preview: expected given that this rendering 
doesn't go through Sphinx)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From ravitejakrishna.w at zohocorp.com  Wed Nov 27 04:45:06 2019
From: ravitejakrishna.w at zohocorp.com (Wuyyuru Ravi Teja Krishna)
Date: Wed, 27 Nov 2019 18:15:06 +0530
Subject: [gdal-dev] .kml to .xlsx or .xls ( with Geometry Column Included)
Message-ID: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>

Hello GDAL team,



         We are trying to use ogr2ogr util for conversion of .kml to .xlsx. But the converted .xlsx file is missing geometry column. In documentation it says of using ogr vrt capabilities for this purpose but its not clear on procedure need to be followed. Can someone please direct us with solution to our problem?



Thanks in advance
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191127/bf02fe87/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 27 05:24:05 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 27 Nov 2019 06:24:05 -0700 (MST)
Subject: [gdal-dev] .kml to .xlsx or .xls ( with Geometry Column
 Included)
In-Reply-To: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>
References: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>
Message-ID: <1574861045089-0.post@n6.nabble.com>

Hi,

The documentation is probably mostly copied from the read-only XLS driver
documentation https://gdal.org/drivers/vector/xls.html and the VRT
capabilities refer to the possibility to build geometries from X and Y
fields, or from a field that contains Well Known Text as documented in
https://gdal.org/drivers/vector/vrt.html#vector-vrt.

The best that you can do with converting a simple KML with one vector layer
into XLSX is to write the geometry as WKT into a new text field. Check the
layer name with ogrinfo

ogrinfo jump_kml.kml
INFO: Open of `jump_kml.kml'
      using driver `LIBKML' successful.
1: Layer0

Now use ogrinfo with SQLite dialect

ogr2ogr -f xlsx -dialect sqlite -sql "select *, ST_AsText(geometry) as WKT
from layer0" jump_kml.xlsx jump_kml.kml

Check the result:

ogrinfo jump_kml.xlsx -al
.....
 tessellate (Integer) = -1
  extrude (Integer) = 0
  visibility (Integer) = -1
  WKT (String) = POLYGON Z((21.269511 47.7979 0, 21.345139 47.778019 0,
21.282376 47.733188 0, 21.269511 47.7979 0))

-Jukka Rahkonen-




Ravi Teja Krishna Wuyyuru wrote
> Hello GDAL team,
> 
>          We are trying to use ogr2ogr util for conversion of .kml to
> .xlsx. But the converted .xlsx file is missing geometry column. In
> documentation it says of using ogr vrt capabilities for this purpose but
> its not clear on procedure need to be followed. Can someone please direct
> us with solution to our problem?
> 
> Thanks in advance
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jmckenna at gatewaygeomatics.com  Wed Nov 27 06:00:34 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 27 Nov 2019 10:00:34 -0400
Subject: [gdal-dev] .kml to .xlsx or .xls ( with Geometry Column
	Included)
In-Reply-To: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>
References: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>
Message-ID: <00743cc1-bfde-a3ad-5969-f79b74fd3b4e@gatewaygeomatics.com>

Another option is to convert from KML to CSV, which can be opened by 
LibreOffice/Word etc. using the "GEOMETRY=AS_XY" switch, which generates 
your X and Y columns magically:

   ogr2ogr -f CSV -lco GEOMETRY=AS_XY output.csv input.kml


-jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeomatics.com/


On 2019-11-27 8:45 AM, Wuyyuru Ravi Teja Krishna wrote:
> Hello GDAL team,
> 
>           We are trying to use ogr2ogr util for conversion of .kml to 
> .xlsx. But the converted .xlsx file is missing geometry column. In 
> documentation it says of using ogr vrt capabilities for this purpose but 
> its not clear on procedure need to be followed. Can someone please 
> direct us with solution to our problem?
> 
> Thanks in advance
> 




From gdal at stripfamily.net  Wed Nov 27 07:06:57 2019
From: gdal at stripfamily.net (David Strip)
Date: Wed, 27 Nov 2019 08:06:57 -0700
Subject: [gdal-dev] .kml to .xlsx or .xls ( with Geometry Column
	Included)
In-Reply-To: <00743cc1-bfde-a3ad-5969-f79b74fd3b4e@gatewaygeomatics.com>
References: <16eace4d027.f3e1bac125036.7377911194454841017@zohocorp.com>
 <00743cc1-bfde-a3ad-5969-f79b74fd3b4e@gatewaygeomatics.com>
Message-ID: <e625139e-4e8f-b151-a160-30c653a8275d@stripfamily.net>

my reading of the docs suggests this will only work for point
geometries. However, there is a more general GEOMETRY=AS_WKT that should
work for other geometries.

On 11/27/2019 7:00 AM, Jeff McKenna wrote:
> Another option is to convert from KML to CSV, which can be opened by
> LibreOffice/Word etc. using the "GEOMETRY=AS_XY" switch, which
> generates your X and Y columns magically:
>
>   ogr2ogr -f CSV -lco GEOMETRY=AS_XY output.csv input.kml
>
>
> -jeff
>
>
>


From olivier.dalang at gmail.com  Wed Nov 27 09:51:03 2019
From: olivier.dalang at gmail.com (Olivier Dalang)
Date: Wed, 27 Nov 2019 18:51:03 +0100
Subject: [gdal-dev] gdalwarp into an existing destination from python
In-Reply-To: <CAExk7p1Jq8hy57bZoKSrxw51Zh+tV-L6qi-LYSJEJevLgbgU=g@mail.gmail.com>
References: <CAExk7p1Jq8hy57bZoKSrxw51Zh+tV-L6qi-LYSJEJevLgbgU=g@mail.gmail.com>
Message-ID: <CAExk7p3T2k1y8zeKj+MUt6PGb5AcHKkePYWW4fMXD=j0N_PmGw@mail.gmail.com>

Dear list,

When I use gdalwarp from command line and set output to an existing file,
the contents get mosaic-ed in the existing file (as expected and
documented).

$> gdalwarp -cutline cutline.shp source.tif dest.tif

But when doing the from python, the existing destination file get
overwritten.

gdal.Warp("dest.tif", "source.tif", cutlineDSName="cutline.shp")

Is there a flag or something to achieve same behaviour as command line ? I
looked carefully in the python api doc, but couldn't find it...

Cheers !!

Olivier
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191127/448c4f7e/attachment.html>

From even.rouault at spatialys.com  Wed Nov 27 11:28:56 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 27 Nov 2019 20:28:56 +0100
Subject: [gdal-dev] gdalwarp into an existing destination from python
In-Reply-To: <CAExk7p3T2k1y8zeKj+MUt6PGb5AcHKkePYWW4fMXD=j0N_PmGw@mail.gmail.com>
References: <CAExk7p1Jq8hy57bZoKSrxw51Zh+tV-L6qi-LYSJEJevLgbgU=g@mail.gmail.com>
 <CAExk7p3T2k1y8zeKj+MUt6PGb5AcHKkePYWW4fMXD=j0N_PmGw@mail.gmail.com>
Message-ID: <10243051.zRvs2q8BcN@even-i700>

Olivier,

> Is there a flag or something to achieve same behaviour as command line ? I
> looked carefully in the python api doc, but couldn't find it...

Not exacly a flag, but:

destDS = gdal.Open("dest.tif", gdal.GA_Update)
gdal.Warp(destDS, "source.tif", cutlineDSName="cutline.shp")

Cheers,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From olivier.dalang at gmail.com  Wed Nov 27 14:30:22 2019
From: olivier.dalang at gmail.com (Olivier Dalang)
Date: Wed, 27 Nov 2019 23:30:22 +0100
Subject: [gdal-dev] gdalwarp into an existing destination from python
In-Reply-To: <10243051.zRvs2q8BcN@even-i700>
References: <CAExk7p1Jq8hy57bZoKSrxw51Zh+tV-L6qi-LYSJEJevLgbgU=g@mail.gmail.com>
 <CAExk7p3T2k1y8zeKj+MUt6PGb5AcHKkePYWW4fMXD=j0N_PmGw@mail.gmail.com>
 <10243051.zRvs2q8BcN@even-i700>
Message-ID: <CAExk7p3TaWTO02PiCkr6CUR7iLGykn-4RO5M6Xq8Mw962M4BKg@mail.gmail.com>

Awesome, that's what I was looking for :-)

Thanks !!!

Olivier

On Wed, 27 Nov 2019 at 20:28, Even Rouault <even.rouault at spatialys.com>
wrote:

> Olivier,
>
> > Is there a flag or something to achieve same behaviour as command line ?
> I
> > looked carefully in the python api doc, but couldn't find it...
>
> Not exacly a flag, but:
>
> destDS = gdal.Open("dest.tif", gdal.GA_Update)
> gdal.Warp(destDS, "source.tif", cutlineDSName="cutline.shp")
>
> Cheers,
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191127/4f6583d3/attachment.html>

From jan.heckman at gmail.com  Thu Nov 28 07:09:28 2019
From: jan.heckman at gmail.com (Jan Heckman)
Date: Thu, 28 Nov 2019 16:09:28 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
Message-ID: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>

Hi everybody,
According to docs <https://gdal.org/user/ogr_sql_dialect.html>, LIKE and
ILIKE should be caseinsensitive.
However, they are not.
ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000 140000
485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
Bestemmingsplangebied -lco ENCODING=UTF-8 -where
"BeleidsmatigVerantwoordelijkeOverheid LIKE 'Geme%'" produces empty output.
The clue is that LIKE 'geme%'  (as in the DB 'gemeente'). does produce
output.
Replacing LIKE with ILIKE makes no difference.
ogr2ogr --version: GDAL 2.3.0dev, released 2017/99/99
Is there a way to use a LIKE like caseinsensitively in an ogr2ogr query?
Thanks,
Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/f7224d6c/attachment.html>

From even.rouault at spatialys.com  Thu Nov 28 07:24:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Nov 2019 16:24:59 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
Message-ID: <1932542.jbAo1YeLi3@even-i700>

On jeudi 28 novembre 2019 16:09:28 CET Jan Heckman wrote:
> Hi everybody,
> According to docs <https://gdal.org/user/ogr_sql_dialect.html>, LIKE and
> ILIKE should be caseinsensitive.
> However, they are not.
> ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000 140000
> 485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
> Bestemmingsplangebied -lco ENCODING=UTF-8 -where
> "BeleidsmatigVerantwoordelijkeOverheid LIKE 'Geme%'" produces empty output.
> The clue is that LIKE 'geme%'  (as in the DB 'gemeente'). does produce
> output.
> Replacing LIKE with ILIKE makes no difference.

Jan,

That's an interesting case.

OGR SQL indeeds consider LIKE and ILIKE are identical and case insensitive.

But... when issuing a -where to a WFS source, OGR turns the SQL into OGC 
Filter Encoding so that the filter is evaluated by the server for performance 
reasons. When doing so it uses the PropertyIsLike predicate, which is case 
sensitive by default. There's a matchCase attribute that could be set to 
false.

So I can see 2 options:

1) change the WFS translation code to set matchCase=false. Quite easy to 
implement. Some backward compatibility consequence for users of WFS sources 
that would have dependended on the current behaviour (case sensitivity)

2) more work. for WFS, have LIKE and ILIKE having two different translations. 
But if we do so, as we would need to add a new SWQ_ILIKE operator, and we 
should also probably make LIKE and ILIKE be distinct operations on a pure OGR 
SQL evaluation (client side). Which has some backward compatibility 
implication.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jan.heckman at gmail.com  Thu Nov 28 07:42:19 2019
From: jan.heckman at gmail.com (Jan Heckman)
Date: Thu, 28 Nov 2019 16:42:19 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <1932542.jbAo1YeLi3@even-i700>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
 <1932542.jbAo1YeLi3@even-i700>
Message-ID: <CAKMUAtDky3Aaqi_JKSqcMUD9sPsosOs-VCywZv39fdMp_A-yew@mail.gmail.com>

Hi Even, all,
Thanks for the fast and helpful response!
So, if I need this shortly, I should compile a slightly modified version?
I can't see myself giving a true solution to the backward compatibility
issue ;)
My problem here is not large.
The main advantage of caseinsensitive is a compact and accurate query, I
was used to seeing if I could just omit the first (capital or not)
character.
But I ran into a case where this produced unwanted results and cmdline
gave ERROR 1: Destination buffer too small.
So I'll put the less compact SQL in a file and use -sql @file.sql for now.
Thanks,
Jan

On Thu, Nov 28, 2019 at 4:25 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 28 novembre 2019 16:09:28 CET Jan Heckman wrote:
> > Hi everybody,
> > According to docs <https://gdal.org/user/ogr_sql_dialect.html>, LIKE and
> > ILIKE should be caseinsensitive.
> > However, they are not.
> > ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000
> 140000
> > 485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
> > Bestemmingsplangebied -lco ENCODING=UTF-8 -where
> > "BeleidsmatigVerantwoordelijkeOverheid LIKE 'Geme%'" produces empty
> output.
> > The clue is that LIKE 'geme%'  (as in the DB 'gemeente'). does produce
> > output.
> > Replacing LIKE with ILIKE makes no difference.
>
> Jan,
>
> That's an interesting case.
>
> OGR SQL indeeds consider LIKE and ILIKE are identical and case insensitive.
>
> But... when issuing a -where to a WFS source, OGR turns the SQL into OGC
> Filter Encoding so that the filter is evaluated by the server for
> performance
> reasons. When doing so it uses the PropertyIsLike predicate, which is case
> sensitive by default. There's a matchCase attribute that could be set to
> false.
>
> So I can see 2 options:
>
> 1) change the WFS translation code to set matchCase=false. Quite easy to
> implement. Some backward compatibility consequence for users of WFS
> sources
> that would have dependended on the current behaviour (case sensitivity)
>
> 2) more work. for WFS, have LIKE and ILIKE having two different
> translations.
> But if we do so, as we would need to add a new SWQ_ILIKE operator, and we
> should also probably make LIKE and ILIKE be distinct operations on a pure
> OGR
> SQL evaluation (client side). Which has some backward compatibility
> implication.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/4c1068e1/attachment.html>

From even.rouault at spatialys.com  Thu Nov 28 07:58:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Nov 2019 16:58:17 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <CAKMUAtDky3Aaqi_JKSqcMUD9sPsosOs-VCywZv39fdMp_A-yew@mail.gmail.com>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
 <1932542.jbAo1YeLi3@even-i700>
 <CAKMUAtDky3Aaqi_JKSqcMUD9sPsosOs-VCywZv39fdMp_A-yew@mail.gmail.com>
Message-ID: <4355262.oznFUZJNO2@even-i700>

On jeudi 28 novembre 2019 16:42:19 CET Jan Heckman wrote:
> Hi Even, all,
> Thanks for the fast and helpful response!
> So, if I need this shortly, I should compile a slightly modified version?
> I can't see myself giving a true solution to the backward compatibility
> issue ;)
> My problem here is not large.
> The main advantage of caseinsensitive is a compact and accurate query, I
> was used to seeing if I could just omit the first (capital or not)
> character.

Try the changeset at https://github.com/OSGeo/gdal/pull/2065

> But I ran into a case where this produced unwanted results and cmdline
> gave ERROR 1: Destination buffer too small.

Can you share how to reproduce that? That should be fixed

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jan.heckman at gmail.com  Thu Nov 28 08:40:34 2019
From: jan.heckman at gmail.com (Jan Heckman)
Date: Thu, 28 Nov 2019 17:40:34 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <4355262.oznFUZJNO2@even-i700>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
 <1932542.jbAo1YeLi3@even-i700>
 <CAKMUAtDky3Aaqi_JKSqcMUD9sPsosOs-VCywZv39fdMp_A-yew@mail.gmail.com>
 <4355262.oznFUZJNO2@even-i700>
Message-ID: <CAKMUAtDid4JFz=0KVTrM=r0acCANu5MGyF-+tmGi0wEn2rL16w@mail.gmail.com>

That's
ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000 140000
485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
Bestemmingsplangebied -lco ENCODING=UTF-8 -where
"BeleidsmatigVerantwoordelijkeOverheid LIKE '_eme%' AND planstatus NOT LIKE
'voor%' AND planstatus NOT LIKE 'wijzig%' AND planstatus NOT LIKE
'concept%' AND planstatus NOT LIKE 'geconso%' AND planstatus NOT LIKE
'ontwerp%' AND datum > '2006' AND historisch=0 AND digitaalgewaarmerkt LIKE
'ja%' AND dossierstatus <> 'vervallen' AND Naam NOT LIKE '%parke%' AND Naam
NOT LIKE '%paraplu%' AND Naam NOT LIKE '%Parke%' AND Naam NOT LIKE
'%Paraplu%'"

On Thu, Nov 28, 2019 at 4:58 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 28 novembre 2019 16:42:19 CET Jan Heckman wrote:
> > Hi Even, all,
> > Thanks for the fast and helpful response!
> > So, if I need this shortly, I should compile a slightly modified version?
> > I can't see myself giving a true solution to the backward compatibility
> > issue ;)
> > My problem here is not large.
> > The main advantage of caseinsensitive is a compact and accurate query, I
> > was used to seeing if I could just omit the first (capital or not)
> > character.
>
> Try the changeset at https://github.com/OSGeo/gdal/pull/2065
>
> > But I ran into a case where this produced unwanted results and cmdline
> > gave ERROR 1: Destination buffer too small.
>
> Can you share how to reproduce that? That should be fixed
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/741a635f/attachment-0001.html>

From even.rouault at spatialys.com  Thu Nov 28 08:49:03 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Nov 2019 17:49:03 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <CAKMUAtDid4JFz=0KVTrM=r0acCANu5MGyF-+tmGi0wEn2rL16w@mail.gmail.com>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
 <4355262.oznFUZJNO2@even-i700>
 <CAKMUAtDid4JFz=0KVTrM=r0acCANu5MGyF-+tmGi0wEn2rL16w@mail.gmail.com>
Message-ID: <1820616.K2MUSET40i@even-i700>

On jeudi 28 novembre 2019 17:40:34 CET Jan Heckman wrote:
> That's
> ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000 140000
> 485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
> Bestemmingsplangebied -lco ENCODING=UTF-8 -where
> "BeleidsmatigVerantwoordelijkeOverheid LIKE '_eme%' AND planstatus NOT LIKE
> 'voor%' AND planstatus NOT LIKE 'wijzig%' AND planstatus NOT LIKE
> 'concept%' AND planstatus NOT LIKE 'geconso%' AND planstatus NOT LIKE
> 'ontwerp%' AND datum > '2006' AND historisch=0 AND digitaalgewaarmerkt LIKE
> 'ja%' AND dossierstatus <> 'vervallen' AND Naam NOT LIKE '%parke%' AND Naam
> NOT LIKE '%paraplu%' AND Naam NOT LIKE '%Parke%' AND Naam NOT LIKE
> '%Paraplu%'"

I cannot reproduce a ERROR 1: Destination buffer too small. with GDAL master. 
I suspect this might have been fixed although I've no particular recollection 
of such a fix having been done.
I did get however a 
ERROR 1: Failed to parse date '2006' evaluating OGR WHERE expression
which can be fixed by using '2006/01/01' instead of '2006'

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jan.heckman at gmail.com  Thu Nov 28 08:58:27 2019
From: jan.heckman at gmail.com (Jan Heckman)
Date: Thu, 28 Nov 2019 17:58:27 +0100
Subject: [gdal-dev] ogr2ogr (I)LIKE not caseINsensitive
In-Reply-To: <1820616.K2MUSET40i@even-i700>
References: <CAKMUAtAi9pLXay7qaqcDBb-Qxtm9CA5rDB+aRY61LQ7=tAj7=w@mail.gmail.com>
 <4355262.oznFUZJNO2@even-i700>
 <CAKMUAtDid4JFz=0KVTrM=r0acCANu5MGyF-+tmGi0wEn2rL16w@mail.gmail.com>
 <1820616.K2MUSET40i@even-i700>
Message-ID: <CAKMUAtDRiVLpkMeBUWWphbVmqXnJHL1h8C0abo-uJzjTeX19cA@mail.gmail.com>

Hi Even,
I'll upgrade to get rid of the error.
Thanks  again.
Jan

On Thu, Nov 28, 2019 at 5:49 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 28 novembre 2019 17:40:34 CET Jan Heckman wrote:
> > That's
> > ogr2ogr plangebieden.shp -t_srs EPSG:28992 -dim 2 -spat 45000 405000
> 140000
> > 485000 WFS:"http://afnemers.ruimtelijkeplannen.nl/afnemers2012/services"
> > Bestemmingsplangebied -lco ENCODING=UTF-8 -where
> > "BeleidsmatigVerantwoordelijkeOverheid LIKE '_eme%' AND planstatus NOT
> LIKE
> > 'voor%' AND planstatus NOT LIKE 'wijzig%' AND planstatus NOT LIKE
> > 'concept%' AND planstatus NOT LIKE 'geconso%' AND planstatus NOT LIKE
> > 'ontwerp%' AND datum > '2006' AND historisch=0 AND digitaalgewaarmerkt
> LIKE
> > 'ja%' AND dossierstatus <> 'vervallen' AND Naam NOT LIKE '%parke%' AND
> Naam
> > NOT LIKE '%paraplu%' AND Naam NOT LIKE '%Parke%' AND Naam NOT LIKE
> > '%Paraplu%'"
>
> I cannot reproduce a ERROR 1: Destination buffer too small. with GDAL
> master.
> I suspect this might have been fixed although I've no particular
> recollection
> of such a fix having been done.
> I did get however a
> ERROR 1: Failed to parse date '2006' evaluating OGR WHERE expression
> which can be fixed by using '2006/01/01' instead of '2006'
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/62982dec/attachment.html>

From careyshan at gmail.com  Thu Nov 28 12:19:10 2019
From: careyshan at gmail.com (Shane Carey)
Date: Thu, 28 Nov 2019 20:19:10 +0000
Subject: [gdal-dev] ERROR: Too many connections: max 64
Message-ID: <CA+jRDxCHAdsruUfH+Wy63qg6Gu9tiZR5yDM6FY6-OWzWpdUSOg@mail.gmail.com>

Hi,

I'm doing some processing with Pyqgis and after processing, the file
remains locked and eventually I get:
ERROR: Too many connections: max 64

How do I handle this?

Thanks
Le gach dea ghui,
*Shane Carey*
*GIS and Data Solutions Consultant*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/1f4ca9cc/attachment.html>

From vincent.sarago at gmail.com  Thu Nov 28 12:26:16 2019
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 28 Nov 2019 15:26:16 -0500
Subject: [gdal-dev] GDAL 3 + PROJ 6 performance issue in CENTOS
Message-ID: <427AB5F5-8733-4CFC-856F-07F13C186340@gmail.com>

Dear community, I hope some of you might be of help here.

For weeks I’ve been trying to build CENTOS docker image (for AWS Lambda) for GDAL 3 + PROJ 6 but I stumbled into a strange behavior making my processes a couple time slower than with gdal 2. I’m using those images for dynamic tiling (warping + cropping) so my guess it there is something involving PROJ 6 here (everything works fine with gdal2.4 + proj 5. The weird things is I cannot reproduce the behavior outside my centos container (works fine with Alpine).

The full discovery can be seen in https://github.com/RemotePixel/amazonlinux/issues/10 <https://github.com/RemotePixel/amazonlinux/issues/10> and https://github.com/RemotePixel/amazonlinux/issues/16 <https://github.com/RemotePixel/amazonlinux/issues/16>. 

The dockerfile can be found here https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Dockerfile <https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Dockerfile>

The logs (PROJ or GDAL) don’t tell anything, they are almost similar. The only notable difference is :
```
# CENTOS
GDAL: GDALDriver::Create(GTiff,out.tif,256,256,1,UInt16,(nil))
# ALPINE 
GDAL: GDALDriver::Create(GTiff,out.tif,256,256,1,UInt16,0)
```

Here is an example showing the logs of a gdalwarp command (keeping only line taking more then 100ms). 

CPL_TIMESTAMP=ONE CPL_DEBUG=ON GDAL_DISABLE_READDIR_ON_OPEN=EMPTY_DIR gdalwarp -q -te -11036283.891926888 10331840.239250703 -10958012.374962866 10410111.756214723-t_srs EPSG:3857 -ts 256 256 -r bilinear -overwrite /vsicurl/https://s3.amazonaws.com/opendata.remotepixel.ca/bench_tiler/LC08_L1TP_040013_20191014_20191029_01_T1_B4.tif out.tif
Note: time delta (column 2) is calculated between line and line+1 (meaning that delta assigned for  `GDAL : computing areas …` correspond to time spent somewhere between the end of GDALComputeAreaOfInterest  and `GDALWarpCreateOutput` https://github.com/OSGeo/gdal/blob/release/3.0/gdal/apps/gdalwarp_lib.cpp#L945-L1040 <https://github.com/OSGeo/gdal/blob/release/3.0/gdal/apps/gdalwarp_lib.cpp#L945-L1040>

GDAL 3.0
17:26:43.314265	264ms	HTTP: libcurl/7.61.1 OpenSSL/1.0.2k zlib/1.2.8 libidn2/0.16 libpsl/0.6.2 (+libicu/50.1.2) libssh2/1.4.2 nghttp2/1.21.1
17:26:43.662722	671ms	GDAL: Computing area of interest: -103.586, 65.7283, -97.4556, 68.0874
17:26:44.460977	625ms	GTiff: Opened 134x135 overview.
17:26:45.088925	588ms	GDAL: Computing area of interest: -103.586, 65.7283, -97.4556, 68.0874
17:26:45.676688	189ms	VSICURL: Downloading 2145148-2175608 (https://s3.amazonaws.com/opendata.remotepixel.ca/bench_tiler/LC08_L1TP_040013_20191014_20191029_01_T1_B4.tif)...
17:26:45.870161	124ms	GDAL: GDALWarpKernel()::GWKRealCase() Src=1544,201,252x252 Dst=0,0,256x256


GDAL 3.0 Alpine
17:42:55.857475	284ms	HTTP: libcurl/7.65.1 OpenSSL/1.1.1c zlib/1.2.11 nghttp2/1.38.0
17:42:56.273597	43ms     GDAL: Computing area of interest: -103.586, 65.7283, -97.4556, 68.0874
17:42:56.421772	15ms	    GTiff: Opened 134x135 overview.
17:42:56.440615	16ms     GDAL: Computing area of interest: -103.586, 65.7283, -97.4556, 68.0874
17:42:56.456941	210ms	VSICURL: Downloading 2145148-2175608 (https://s3.amazonaws.com/opendata.remotepixel.ca/bench_tiler/LC08_L1TP_040013_20191014_20191029_01_T1_B4.tif)...
17:42:56.725692	44ms	    GDAL: GDALWarpKernel()::GWKRealCase() Src=1544,201,252x252 Dst=0,0,256x256
Full logs: https://gist.github.com/vincentsarago/2c55d5154d352f10e85d09fe9008e365

The main time difference are just after `GDALComputeAreaOfInterest` (https://github.com/OSGeo/gdal/blob/release/3.0/gdal/apps/gdalwarp_lib.cpp#L930-L939 and takes about 15 times more time in amazonlinux in comp)
arison to alpine 


I’m looking for advice for deeper debuting or for knowledge about compilation/dependencies of GDA/PROJ for centos. 

Thanks,

Vincent 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/6d3b993f/attachment.html>

From even.rouault at spatialys.com  Thu Nov 28 12:34:49 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Nov 2019 21:34:49 +0100
Subject: [gdal-dev] GDAL 3 + PROJ 6 performance issue in CENTOS
In-Reply-To: <427AB5F5-8733-4CFC-856F-07F13C186340@gmail.com>
References: <427AB5F5-8733-4CFC-856F-07F13C186340@gmail.com>
Message-ID: <1934898.exvmdHqZrl@even-i700>

> The full discovery can be seen in
> https://github.com/RemotePixel/amazonlinux/issues/10
> <https://github.com/RemotePixel/amazonlinux/issues/10> and
> https://github.com/RemotePixel/amazonlinux/issues/16
> <https://github.com/RemotePixel/amazonlinux/issues/16>.

 
> The dockerfile can be found here
> https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Dockerf
> ile
> <https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Docker
> file>
> 
> The logs (PROJ or GDAL) don’t tell anything, they are almost similar. The
> only notable difference is : ```
> # CENTOS
> GDAL: GDALDriver::Create(GTiff,out.tif,256,256,1,UInt16,(nil))

Vincent, now I see CentOS, I'm pretty sure now that you hit:
https://lists.osgeo.org/pipermail/proj/2019-November/008984.html

Basically we discovered that while PROJ 6 compiled and worked against CentOS 7 
system sqlite, the query optimized of this sqlite version did a bad job that 
could result in dramatic performance issues as you found. So the fix is to run 
against a not too old sqlite. We have set the minimum to sqlite 3.11.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Nov 28 12:37:44 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 28 Nov 2019 21:37:44 +0100
Subject: [gdal-dev] ERROR: Too many connections: max 64
In-Reply-To: <CA+jRDxCHAdsruUfH+Wy63qg6Gu9tiZR5yDM6FY6-OWzWpdUSOg@mail.gmail.com>
References: <CA+jRDxCHAdsruUfH+Wy63qg6Gu9tiZR5yDM6FY6-OWzWpdUSOg@mail.gmail.com>
Message-ID: <2030571.gWZYnZqJ9Z@even-i700>

On jeudi 28 novembre 2019 20:19:10 CET Shane Carey wrote:
> Hi,
> 
> I'm doing some processing with Pyqgis and after processing, the file
> remains locked and eventually I get:
> ERROR: Too many connections: max 64

All I can say is that this error messages comes from Spatialite that can only 
handle 64 connections in a process at most. I did a fix (don't remember when, 
but must be included in QGIS 3.4) in the QGIS OGR provider to be able to open 
GeoPackage datasets (since the OGR GeoPackage driver enables Spatialite on 
them) that has many layers (so that they share the same connection). Not sure 
about the specificities of your use case.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From vincent.sarago at gmail.com  Thu Nov 28 12:37:51 2019
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 28 Nov 2019 15:37:51 -0500
Subject: [gdal-dev] GDAL 3 + PROJ 6 performance issue in CENTOS
In-Reply-To: <1934898.exvmdHqZrl@even-i700>
References: <427AB5F5-8733-4CFC-856F-07F13C186340@gmail.com>
 <1934898.exvmdHqZrl@even-i700>
Message-ID: <6937D6AD-718C-4C71-9962-311E878C47AB@gmail.com>

Again Even you are my hero,

```
$ sqlite3 --version
3.7.17 2013-05-20 00:56:22 118a3b35693b134d56ebd780123b7fd6f1497668
```

Will try to update and see how it goes, 

Thanks a lot

> Le 28 nov. 2019 à 15:34, Even Rouault <even.rouault at spatialys.com> a écrit :
> 
>> The full discovery can be seen in
>> https://github.com/RemotePixel/amazonlinux/issues/10
>> <https://github.com/RemotePixel/amazonlinux/issues/10> and
>> https://github.com/RemotePixel/amazonlinux/issues/16
>> <https://github.com/RemotePixel/amazonlinux/issues/16>.
> 
> 
>> The dockerfile can be found here
>> https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Dockerf
>> ile
>> <https://github.com/RemotePixel/amazonlinux/blob/master/base/gdal3.0/Docker
>> file>
>> 
>> The logs (PROJ or GDAL) don’t tell anything, they are almost similar. The
>> only notable difference is : ```
>> # CENTOS
>> GDAL: GDALDriver::Create(GTiff,out.tif,256,256,1,UInt16,(nil))
> 
> Vincent, now I see CentOS, I'm pretty sure now that you hit:
> https://lists.osgeo.org/pipermail/proj/2019-November/008984.html
> 
> Basically we discovered that while PROJ 6 compiled and worked against CentOS 7 
> system sqlite, the query optimized of this sqlite version did a bad job that 
> could result in dramatic performance issues as you found. So the fix is to run 
> against a not too old sqlite. We have set the minimum to sqlite 3.11.
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com


From careyshan at gmail.com  Thu Nov 28 12:40:26 2019
From: careyshan at gmail.com (Shane Carey)
Date: Thu, 28 Nov 2019 20:40:26 +0000
Subject: [gdal-dev] ERROR: Too many connections: max 64
In-Reply-To: <2030571.gWZYnZqJ9Z@even-i700>
References: <CA+jRDxCHAdsruUfH+Wy63qg6Gu9tiZR5yDM6FY6-OWzWpdUSOg@mail.gmail.com>
 <2030571.gWZYnZqJ9Z@even-i700>
Message-ID: <CA+jRDxCcNXZ=X=fpkjK_QEAOBMDkVQQ3jiNxhZiRBiFaOmHgQg@mail.gmail.com>

After processing, is there a way to release the wal and shm files? I'm on
qgis3.4.
Thanks Even
Le gach dea ghui,
*Shane Carey*
*GIS and Data Solutions Consultant*


On Thu, Nov 28, 2019 at 8:37 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 28 novembre 2019 20:19:10 CET Shane Carey wrote:
> > Hi,
> >
> > I'm doing some processing with Pyqgis and after processing, the file
> > remains locked and eventually I get:
> > ERROR: Too many connections: max 64
>
> All I can say is that this error messages comes from Spatialite that can
> only
> handle 64 connections in a process at most. I did a fix (don't remember
> when,
> but must be included in QGIS 3.4) in the QGIS OGR provider to be able to
> open
> GeoPackage datasets (since the OGR GeoPackage driver enables Spatialite on
> them) that has many layers (so that they share the same connection). Not
> sure
> about the specificities of your use case.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/753f9016/attachment.html>

From careyshan at gmail.com  Thu Nov 28 12:44:39 2019
From: careyshan at gmail.com (Shane Carey)
Date: Thu, 28 Nov 2019 20:44:39 +0000
Subject: [gdal-dev] ERROR: Too many connections: max 64
In-Reply-To: <CA+jRDxCcNXZ=X=fpkjK_QEAOBMDkVQQ3jiNxhZiRBiFaOmHgQg@mail.gmail.com>
References: <CA+jRDxCHAdsruUfH+Wy63qg6Gu9tiZR5yDM6FY6-OWzWpdUSOg@mail.gmail.com>
 <2030571.gWZYnZqJ9Z@even-i700>
 <CA+jRDxCcNXZ=X=fpkjK_QEAOBMDkVQQ3jiNxhZiRBiFaOmHgQg@mail.gmail.com>
Message-ID: <CA+jRDxBwg7X6FPN+U+pOF_hSWJjjb3eTSjEkp=TZY-83DgfRGA@mail.gmail.com>

Or is it better to do the processing on shapefiles?
Le gach dea ghui,
*Shane Carey*
*GIS and Data Solutions Consultant*


On Thu, Nov 28, 2019 at 8:40 PM Shane Carey <careyshan at gmail.com> wrote:

> After processing, is there a way to release the wal and shm files? I'm on
> qgis3.4.
> Thanks Even
> Le gach dea ghui,
> *Shane Carey*
> *GIS and Data Solutions Consultant*
>
>
> On Thu, Nov 28, 2019 at 8:37 PM Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On jeudi 28 novembre 2019 20:19:10 CET Shane Carey wrote:
>> > Hi,
>> >
>> > I'm doing some processing with Pyqgis and after processing, the file
>> > remains locked and eventually I get:
>> > ERROR: Too many connections: max 64
>>
>> All I can say is that this error messages comes from Spatialite that can
>> only
>> handle 64 connections in a process at most. I did a fix (don't remember
>> when,
>> but must be included in QGIS 3.4) in the QGIS OGR provider to be able to
>> open
>> GeoPackage datasets (since the OGR GeoPackage driver enables Spatialite
>> on
>> them) that has many layers (so that they share the same connection). Not
>> sure
>> about the specificities of your use case.
>>
>> Even
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191128/6375a8e7/attachment.html>

From kcindric at gmail.com  Thu Nov 28 23:58:11 2019
From: kcindric at gmail.com (=?UTF-8?Q?Kristijan_Cindri=C4=87?=)
Date: Fri, 29 Nov 2019 08:58:11 +0100
Subject: [gdal-dev] geojson to shp and vice versa
Message-ID: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>

 Dear all,

I have a headache inducing problem. Whenever I try to convert a GeoJSON
feature collection which contains multiple different geometry shapes (i.e.
polygon, linestring and point) I get this type of error:

"ERROR 1: Attempt to write non-polygon (LINESTRING) geometry to POLYGON
type shapefile.\nERROR 1: Unable to write feature 1 from layer
OGRGeoJSON.\nERROR 1: Terminating translation prematurely after
failed\ntranslation of layer OGRGeoJSON (use -skipfailures to skip
errors)\n"

This is the sample GeoJSON I'm trying to convert:

{
    "type": "FeatureCollection",
    "features": [{
        "type": "Feature",
        "properties": {},
        "geometry": {
            "type": "Polygon",
            "coordinates": [
                [
                    [31.816406250000004, 55.27911529201564],
                    [34.27734375000001, 51.944264879028765],
                    [43.94531250000001, 51.944264879028765],
                    [46.93359375000001, 58.35563036280967],
                    [40.42968750000001, 60.1524422143808],
                    [34.45312500000001, 59.085738569819505],
                    [31.816406250000004, 55.27911529201564]
                ]
            ]
        }
    }, {
        "type": "Feature",
        "properties": {},
        "geometry": {
            "type": "LineString",
            "coordinates": [
                [0.5273437500000001, 21.289374355860424],
                [30.585937500000004, 20.632784250388028]
            ]
        }
    }, {
        "type": "Feature",
        "properties": {},
        "geometry": {
            "type": "Point",
            "coordinates": [14.062500000000002, 50.064191736659104]
        }
    }]
}


I validated the GeoJSON on geojsonlint <http://geojsonlint.com/> and it's
all good. It happens every time I have a stack of different geometry types.
It happens using ogre.adc4gis.com or ogr2ogr. It happens in the opposite
way also and when I use the skipfailure option I just get the first feature
in my shapefile.

Any ideas what's going on?


Thanks!


Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191129/7e3efd74/attachment.html>

From hugues.francois at irstea.fr  Fri Nov 29 00:20:28 2019
From: hugues.francois at irstea.fr (Hugues =?utf-8?Q?Fran=C3=A7ois?=)
Date: Fri, 29 Nov 2019 09:20:28 +0100 (CET)
Subject: [gdal-dev] geojson to shp and vice versa
In-Reply-To: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
References: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
Message-ID: <1119665696.1137031.1575015628253.JavaMail.zimbra@irstea.fr>

Hi, 

As far as I understood, shapefile is not able to handle several geometry types and you should produce a shapefile for each one. Shape file does not support geometry collections. 

HTH 
Hug 





De: "Kristijan Cindrić" <kcindric at gmail.com> 
À: gdal-dev at lists.osgeo.org 
Envoyé: Vendredi 29 Novembre 2019 08:58:11 
Objet: [gdal-dev] geojson to shp and vice versa 

Dear all, 



I have a headache inducing problem. Whenever I try to convert a GeoJSON feature collection which contains multiple different geometry shapes (i.e. polygon, linestring and point) I get this type of error: 



"ERROR 1: Attempt to write non-polygon (LINESTRING) geometry to POLYGON type shapefile.\nERROR 1: Unable to write feature 1 from layer OGRGeoJSON.\nERROR 1: Terminating translation prematurely after failed\ntranslation of layer OGRGeoJSON (use -skipfailures to skip errors)\n" 



This is the sample GeoJSON I'm trying to convert: 

{ 
"type": "FeatureCollection", 
"features": [{ 
"type": "Feature", 
"properties": {}, 
"geometry": { 
"type": "Polygon", 
"coordinates": [ 
[ 
[31.816406250000004, 55.27911529201564], 
[34.27734375000001, 51.944264879028765], 
[43.94531250000001, 51.944264879028765], 
[46.93359375000001, 58.35563036280967], 
[40.42968750000001, 60.1524422143808], 
[34.45312500000001, 59.085738569819505], 
[31.816406250000004, 55.27911529201564] 
] 
] 
} 
}, { 
"type": "Feature", 
"properties": {}, 
"geometry": { 
"type": "LineString", 
"coordinates": [ 
[0.5273437500000001, 21.289374355860424], 
[30.585937500000004, 20.632784250388028] 
] 
} 
}, { 
"type": "Feature", 
"properties": {}, 
"geometry": { 
"type": "Point", 
"coordinates": [14.062500000000002, 50.064191736659104] 
} 
}] 
} 




I validated the GeoJSON on [ http://geojsonlint.com/ | geojsonlint ] and it's all good. It happens every time I have a stack of different geometry types. It happens using [ http://ogre.adc4gis.com/ | ogre.adc4gis.com ] or ogr2ogr. It happens in the opposite way also and when I use the skipfailure option I just get the first feature in my shapefile. 

Any ideas what's going on? 





Thanks! 




Chris 

_______________________________________________ 
gdal-dev mailing list 
gdal-dev at lists.osgeo.org 
https://lists.osgeo.org/mailman/listinfo/gdal-dev 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191129/4943fd0d/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov 29 00:28:37 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 29 Nov 2019 01:28:37 -0700 (MST)
Subject: [gdal-dev] geojson to shp and vice versa
In-Reply-To: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
References: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
Message-ID: <1575016117710-0.post@n6.nabble.com>

Hi,

You just can't save lines and polygons into same shapefile. Read
https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf "All the
non-Null shapes in a shapefile are required to be of the same shape type."


-Jukka Rahkonen-


Kristijan Cindrić wrote
> Dear all,
> 
> I have a headache inducing problem. Whenever I try to convert a GeoJSON
> feature collection which contains multiple different geometry shapes (i.e.
> polygon, linestring and point) I get this type of error:
> 
> "ERROR 1: Attempt to write non-polygon (LINESTRING) geometry to POLYGON
> type shapefile.\nERROR 1: Unable to write feature 1 from layer
> OGRGeoJSON.\nERROR 1: Terminating translation prematurely after
> failed\ntranslation of layer OGRGeoJSON (use -skipfailures to skip
> errors)\n"
> 
> This is the sample GeoJSON I'm trying to convert:
> 
> {
>     "type": "FeatureCollection",
>     "features": [{
>         "type": "Feature",
>         "properties": {},
>         "geometry": {
>             "type": "Polygon",
>             "coordinates": [
>                 [
>                     [31.816406250000004, 55.27911529201564],
>                     [34.27734375000001, 51.944264879028765],
>                     [43.94531250000001, 51.944264879028765],
>                     [46.93359375000001, 58.35563036280967],
>                     [40.42968750000001, 60.1524422143808],
>                     [34.45312500000001, 59.085738569819505],
>                     [31.816406250000004, 55.27911529201564]
>                 ]
>             ]
>         }
>     }, {
>         "type": "Feature",
>         "properties": {},
>         "geometry": {
>             "type": "LineString",
>             "coordinates": [
>                 [0.5273437500000001, 21.289374355860424],
>                 [30.585937500000004, 20.632784250388028]
>             ]
>         }
>     }, {
>         "type": "Feature",
>         "properties": {},
>         "geometry": {
>             "type": "Point",
>             "coordinates": [14.062500000000002, 50.064191736659104]
>         }
>     }]
> }
> 
> 
> I validated the GeoJSON on geojsonlint &lt;http://geojsonlint.com/&gt; and
> it's
> all good. It happens every time I have a stack of different geometry
> types.
> It happens using ogre.adc4gis.com or ogr2ogr. It happens in the opposite
> way also and when I use the skipfailure option I just get the first
> feature
> in my shapefile.
> 
> Any ideas what's going on?
> 
> 
> Thanks!
> 
> 
> Chris
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From kcindric at gmail.com  Fri Nov 29 00:42:32 2019
From: kcindric at gmail.com (=?UTF-8?Q?Kristijan_Cindri=C4=87?=)
Date: Fri, 29 Nov 2019 09:42:32 +0100
Subject: [gdal-dev] geojson to shp and vice versa
In-Reply-To: <1575016117710-0.post@n6.nabble.com>
References: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
 <1575016117710-0.post@n6.nabble.com>
Message-ID: <CADDbS5zhYN3H+=A5iOXLUXB138tZKV7pnCr3q_g+pHA1Gd3GsQ@mail.gmail.com>

Thanks for the prompt answers! Ok, it's clear now on what's the problem
here.
Is there a way I can iterate through a .zip file containing individual .shp
files, each file with its own geometry type (point, line, polygon), using
ogre.adc4gis.com API? I could then append each feature to a geojson feature
class and show it to the user. If ogre.adc4gis.com doesn't work I can try
to run ogr2ogr in my app so suggestions in that way are helpful also.

Thanks,

Chris

pet, 29. stu 2019. u 09:28 jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
napisao je:

> Hi,
>
> You just can't save lines and polygons into same shapefile. Read
> https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf "All the
> non-Null shapes in a shapefile are required to be of the same shape type."
>
>
> -Jukka Rahkonen-
>
>
> Kristijan Cindrić wrote
> > Dear all,
> >
> > I have a headache inducing problem. Whenever I try to convert a GeoJSON
> > feature collection which contains multiple different geometry shapes
> (i.e.
> > polygon, linestring and point) I get this type of error:
> >
> > "ERROR 1: Attempt to write non-polygon (LINESTRING) geometry to POLYGON
> > type shapefile.\nERROR 1: Unable to write feature 1 from layer
> > OGRGeoJSON.\nERROR 1: Terminating translation prematurely after
> > failed\ntranslation of layer OGRGeoJSON (use -skipfailures to skip
> > errors)\n"
> >
> > This is the sample GeoJSON I'm trying to convert:
> >
> > {
> >     "type": "FeatureCollection",
> >     "features": [{
> >         "type": "Feature",
> >         "properties": {},
> >         "geometry": {
> >             "type": "Polygon",
> >             "coordinates": [
> >                 [
> >                     [31.816406250000004, 55.27911529201564],
> >                     [34.27734375000001, 51.944264879028765],
> >                     [43.94531250000001, 51.944264879028765],
> >                     [46.93359375000001, 58.35563036280967],
> >                     [40.42968750000001, 60.1524422143808],
> >                     [34.45312500000001, 59.085738569819505],
> >                     [31.816406250000004, 55.27911529201564]
> >                 ]
> >             ]
> >         }
> >     }, {
> >         "type": "Feature",
> >         "properties": {},
> >         "geometry": {
> >             "type": "LineString",
> >             "coordinates": [
> >                 [0.5273437500000001, 21.289374355860424],
> >                 [30.585937500000004, 20.632784250388028]
> >             ]
> >         }
> >     }, {
> >         "type": "Feature",
> >         "properties": {},
> >         "geometry": {
> >             "type": "Point",
> >             "coordinates": [14.062500000000002, 50.064191736659104]
> >         }
> >     }]
> > }
> >
> >
> > I validated the GeoJSON on geojsonlint &lt;http://geojsonlint.com/&gt;
> and
> > it's
> > all good. It happens every time I have a stack of different geometry
> > types.
> > It happens using ogre.adc4gis.com or ogr2ogr. It happens in the opposite
> > way also and when I use the skipfailure option I just get the first
> > feature
> > in my shapefile.
> >
> > Any ideas what's going on?
> >
> >
> > Thanks!
> >
> >
> > Chris
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191129/05c272b9/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov 29 04:47:38 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 29 Nov 2019 12:47:38 +0000
Subject: [gdal-dev] ERROR: Too many connections: max 64
Message-ID: <0d00f66d454a4335b20626cd4ab87f1b@C119S212VM042.msvyvi.vaha.local>

Hi,

The changes that are pending in the wal and shm files are written into the database automatically when the last connection to the database is closed https://sqlite.org/wal.html. There are other ways to invoke checkpoint, but if you have for example opened some layer from the database into QGIS map the checkpoint cannot write the changes into the database because QGIS and SQLite must have a common understanding about what was the contents of the layer when QGIS opened it. Closing the connections when you do not need them anymore should help with the max 64 problem as well.

-Jukka Rahkonen-

Shane Carey wrote:

>After processing, is there a way to release the wal and shm files? I'm on
>qgis3.4.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191129/cf750c8e/attachment.html>

From richard.greenwood at gmail.com  Sat Nov 30 18:36:03 2019
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Sat, 30 Nov 2019 19:36:03 -0700
Subject: [gdal-dev] geojson to shp and vice versa
In-Reply-To: <CADDbS5zhYN3H+=A5iOXLUXB138tZKV7pnCr3q_g+pHA1Gd3GsQ@mail.gmail.com>
References: <CADDbS5xKUH8MvYLspOou41as-T16BdZ_kaYBO2Cj4H+2FgUOwg@mail.gmail.com>
 <1575016117710-0.post@n6.nabble.com>
 <CADDbS5zhYN3H+=A5iOXLUXB138tZKV7pnCr3q_g+pHA1Gd3GsQ@mail.gmail.com>
Message-ID: <CAHBySPajpNCDFwB61=6CBQm8ousZXfHWOcOnygdChpzshN0DBg@mail.gmail.com>

I don't know anything about iterating thru a .zip file, but just in case
you aren't already familiar with it, ogr2ogr has -sql and -where options
that can be used to filter geometry types. So if you have different
geometry type in a single source file you can use for example:
   -where "OGR_GEOMETRY='MULTIPOLYGON' OR OGR_GEOMETRY='POLYGON'"
If you have geometry collections with multiple geometry types it gets
harder. Personally, I'd pump it thru PostGIS in that case.

Rich

On Fri, Nov 29, 2019 at 1:42 AM Kristijan Cindrić <kcindric at gmail.com>
wrote:

> Thanks for the prompt answers! Ok, it's clear now on what's the problem
> here.
> Is there a way I can iterate through a .zip file containing individual
> .shp files, each file with its own geometry type (point, line, polygon),
> using ogre.adc4gis.com API? I could then append each feature to a geojson
> feature class and show it to the user. If ogre.adc4gis.com doesn't work I
> can try to run ogr2ogr in my app so suggestions in that way are helpful
> also.
>
> Thanks,
>
> Chris
>
> pet, 29. stu 2019. u 09:28 jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> napisao je:
>
>> Hi,
>>
>> You just can't save lines and polygons into same shapefile. Read
>> https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf "All the
>> non-Null shapes in a shapefile are required to be of the same shape type."
>>
>>
>> -Jukka Rahkonen-
>>
>>
>> Kristijan Cindrić wrote
>> > Dear all,
>> >
>> > I have a headache inducing problem. Whenever I try to convert a GeoJSON
>> > feature collection which contains multiple different geometry shapes
>> (i.e.
>> > polygon, linestring and point) I get this type of error:
>> >
>> > "ERROR 1: Attempt to write non-polygon (LINESTRING) geometry to POLYGON
>> > type shapefile.\nERROR 1: Unable to write feature 1 from layer
>> > OGRGeoJSON.\nERROR 1: Terminating translation prematurely after
>> > failed\ntranslation of layer OGRGeoJSON (use -skipfailures to skip
>> > errors)\n"
>> >
>> > This is the sample GeoJSON I'm trying to convert:
>> >
>> > {
>> >     "type": "FeatureCollection",
>> >     "features": [{
>> >         "type": "Feature",
>> >         "properties": {},
>> >         "geometry": {
>> >             "type": "Polygon",
>> >             "coordinates": [
>> >                 [
>> >                     [31.816406250000004, 55.27911529201564],
>> >                     [34.27734375000001, 51.944264879028765],
>> >                     [43.94531250000001, 51.944264879028765],
>> >                     [46.93359375000001, 58.35563036280967],
>> >                     [40.42968750000001, 60.1524422143808],
>> >                     [34.45312500000001, 59.085738569819505],
>> >                     [31.816406250000004, 55.27911529201564]
>> >                 ]
>> >             ]
>> >         }
>> >     }, {
>> >         "type": "Feature",
>> >         "properties": {},
>> >         "geometry": {
>> >             "type": "LineString",
>> >             "coordinates": [
>> >                 [0.5273437500000001, 21.289374355860424],
>> >                 [30.585937500000004, 20.632784250388028]
>> >             ]
>> >         }
>> >     }, {
>> >         "type": "Feature",
>> >         "properties": {},
>> >         "geometry": {
>> >             "type": "Point",
>> >             "coordinates": [14.062500000000002, 50.064191736659104]
>> >         }
>> >     }]
>> > }
>> >
>> >
>> > I validated the GeoJSON on geojsonlint &lt;http://geojsonlint.com/&gt;
>> and
>> > it's
>> > all good. It happens every time I have a stack of different geometry
>> > types.
>> > It happens using ogre.adc4gis.com or ogr2ogr. It happens in the
>> opposite
>> > way also and when I use the skipfailure option I just get the first
>> > feature
>> > in my shapefile.
>> >
>> > Any ideas what's going on?
>> >
>> >
>> > Thanks!
>> >
>> >
>> > Chris
>> >
>> > _______________________________________________
>> > gdal-dev mailing list
>>
>> > gdal-dev at .osgeo
>>
>> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>>
>>
>>
>> --
>> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191130/3c4e5c0b/attachment.html>

