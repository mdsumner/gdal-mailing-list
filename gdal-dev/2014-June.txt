From even.rouault at mines-paris.org  Sun Jun  1 14:16:06 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 1 Jun 2014 23:16:06 +0200
Subject: [gdal-dev] ogr2ogr: Unable to open datasource [SVG,
	PDF] with the following drivers
In-Reply-To: <CAA-8Ld-zHBMkNDXFjXDFoDy1KtkDAwYv4ahuJ93=i5CZs+oZ1w@mail.gmail.com>
References: <CAA-8Ld8y=o40HzKLwAoKmD4fRpObThXMWpAj1t3CaOtpMUDc7g@mail.gmail.com>
	<CAA-8Ld_oPkDEDgMfXAEvNUp2+iyWcThu6Jf7JeNP_2TZXkkx6A@mail.gmail.com>
	<CAA-8Ld-zHBMkNDXFjXDFoDy1KtkDAwYv4ahuJ93=i5CZs+oZ1w@mail.gmail.com>
Message-ID: <201406012316.06723.even.rouault@mines-paris.org>

Klo,

> 
> it turned out afterall that DXF is not such a great choice in my case.
> `pstoedit` is best tool for rapid conversion, but it does not respect
> polygons present in initial PDF files, but it just samples polygons to very
> small lines which is such bad outcome.
> 
> Evan, or anybody else, can you please link me to SVG DTD that ogr2ogr would
> understand?
> The link provided here: http://www.gdal.org/drv_svg.html is dead, and on
> their (cloudmade) web portal I can find any information about their custom
> SVG format.

No formal DTD, but here's a sample file :
http://svn.osgeo.org/gdal/trunk/autotest/ogr/data/test.svg

> 
> I also assume there is no tool that can make initial PDF valid for ogr2ogr.

No, it just needs a bit of extra coding in the PDF driver.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From rgourrat at ag-carto.fr  Sun Jun  1 14:29:21 2014
From: rgourrat at ag-carto.fr (=?UTF-8?Q?R=C3=A9my_Gourrat?=)
Date: Sun, 1 Jun 2014 14:29:21 -0700 (PDT)
Subject: [gdal-dev] [Gdal 1.11]gdal_merge.py issue for merging tif
In-Reply-To: <5387504C.3030703@free.fr>
References: <238B1E1830D86F46B3F030D491793D6003903A62@EXC2010.aditu.fr>
	<5387504C.3030703@free.fr>
Message-ID: <1401658160992-5143469.post@n6.nabble.com>

I'm sorry.

At the beginning, I made a download stupid fault between Python 32/64

Jean Claude, you have recognized my nationality with my beautiful accent ;-)

R?my



-----
AG-Carto - Bayonne
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Gdal-1-11-gdal-merge-py-issue-for-merging-tif-tp5142975p5143469.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Mon Jun  2 12:49:59 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 2 Jun 2014 21:49:59 +0200
Subject: [gdal-dev] Python bindings in PyPi updated to 1.11
Message-ID: <201406022149.59660.even.rouault@mines-paris.org>

Hi,

I've just updated the Python bindings registered in PyPi to 1.11.0 :

https://pypi.python.org/pypi/GDAL/

The procedure to do the update is now documented in HOWTO-RELEASE.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From klonuo at gmail.com  Mon Jun  2 20:38:35 2014
From: klonuo at gmail.com (klo uo)
Date: Tue, 3 Jun 2014 05:38:35 +0200
Subject: [gdal-dev] Passing Unicode data to MSSQL-server
Message-ID: <CAA-8Ld-1ZKy4Xa3mqzZ0COA-7YDhByHqLWGei-meEUXpaUWeBg@mail.gmail.com>

Hi,

while trying to export UTF-8 encoded geojson to mssql-server, I get columns
with wrongly encoded text. `ogr2ogr` sets these columns to type `varchar`
which represent single byte strings (ANSI), while for "Unicode" strings the
type should be `nvarchar`. That "Unicode" is UTF-16LE  and mssql-server
apparently converts utf-8 to utf-16 on the fly if column type is right.

Imagining I can't make `ogr2ogr` to put Unicode data in mssql-server table,
I thought to convert initial geojson to my local code page and try to
import that - results in wrongly encoded text again. Then tried harder by
passing `-lco ENCODING=my-code-page` with unfortunately same result.

Can someone assist, how to pass data in local character set from `ogr2ogr`
to MSSQL table?

I use GDAL 1.11.0


Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140603/5ab9a891/attachment.html>

From behncke at creativista-solutions.de  Tue Jun  3 02:14:05 2014
From: behncke at creativista-solutions.de (Dr. Kai Behncke)
Date: Tue,  3 Jun 2014 11:14:05 +0200 (CEST)
Subject: [gdal-dev] Question to ogr2ogr
Message-ID: <20140603091405.62CE0EC0CC4@dd19722.kasserver.com>

Dear Developers,

I would like to know if ogr2ogr has also implemented the transformation DHDN_To_ETRS_1989_8_NTv2-Transformation and if so, how it`s possible to use it?

The background: I have a shape in the German Gauss Krueger Zone 4 and I tried to transform it with "ogr2ogr -t_srs epsg:25832" to ETRS UTM 32N, but it lays always 2 meter next to the position where it belongs to (also then, when I first tried to reproject it fist to wgs 84 and then to utm32N).

then I tried it with ArcGIS and the DHDN_To_ETRS_1989_8_NTv2-Transformation and then it fits well....

Thank you very much, Kai

From jukka.rahkonen at mmmtike.fi  Tue Jun  3 04:44:07 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 3 Jun 2014 11:44:07 +0000 (UTC)
Subject: [gdal-dev] Question to ogr2ogr
References: <20140603091405.62CE0EC0CC4@dd19722.kasserver.com>
Message-ID: <loom.20140603T131737-97@post.gmane.org>

Dr. Kai Behncke <behncke <at> creativista-solutions.de> writes:

> 
> Dear Developers,
> 
> I would like to know if ogr2ogr has also implemented the transformation
> DHDN_To_ETRS_1989_8_NTv2-Transformation and if so, how it`s possible to
use it?
> 
> The background: I have a shape in the German Gauss Krueger Zone 4 and I
tried to transform it with "ogr2ogr
> -t_srs epsg:25832" to ETRS UTM 32N, but it lays always 2 meter next to the
position where it belongs to (also
> then, when I first tried to reproject it fist to wgs 84 and then to utm32N).
> 
> then I tried it with ArcGIS and the
DHDN_To_ETRS_1989_8_NTv2-Transformation and then it fits well....
> 
> Thank you very much, Kai

For the accurate transformations you need to have a grid shift file and you
must tell that GDAL must use it by adding +nadgrids to the Proj4 projection
string. I found from my computer this definition 

# DHDN / 3-degree Gauss zone 4 (deprecated)
<31464> +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0
+datum=potsdam +units=m +no_defs  <>

By looking at document
http://support.esri.com/en/knowledgebase/techarticles/detail/18317 it looks
that you will need a file named "BETA2007.gsb". Find and copy it from your
ESRI installation into your GDAL data directory. Your ogr2ogr command should
be then 

ogr2ogr -f "ESRI Shapefile" -s_srs "+proj=tmerc +lat_0=0 +lon_0=12 +k=1
+x_0=4500000 +y_0=0 +datum=potsdam +nadgrids=BETA2007.gsb +units=m +no_defs"
-t_srs epsg:25832 output.shp input.shp

No guarantee that this works but have a try, it will take only couple of
minutes. Run ogr2ogr with --debug ON and I suppose that it will tell you if
it finds the grid shift file.

-Jukka Rahkonen-




From even.rouault at mines-paris.org  Tue Jun  3 05:50:18 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 03 Jun 2014 14:50:18 +0200
Subject: [gdal-dev] Question to ogr2ogr
In-Reply-To: <loom.20140603T131737-97@post.gmane.org>
References: <20140603091405.62CE0EC0CC4@dd19722.kasserver.com>
	<loom.20140603T131737-97@post.gmane.org>
Message-ID: <1401799818.538dc48aa08e1@imp.free.fr>

Jukka is right. You need the DHDN GK3 grid. It is mentionned on PROJ.4 wiki :
http://trac.osgeo.org/proj/wiki

The link is
http://crs.bkg.bund.de/crseu/crs/descrtrans/BeTA/de_dhdn2etrs_beta.php (no need
for ESRI installation)

The .gsb file must be copied next to the other proj.4 data files (epsg file and
other grids) (rather than GDAL data files)

Even

> Dr. Kai Behncke <behncke <at> creativista-solutions.de> writes:
>
> >
> > Dear Developers,
> >
> > I would like to know if ogr2ogr has also implemented the transformation
> > DHDN_To_ETRS_1989_8_NTv2-Transformation and if so, how it`s possible to
> use it?
> >
> > The background: I have a shape in the German Gauss Krueger Zone 4 and I
> tried to transform it with "ogr2ogr
> > -t_srs epsg:25832" to ETRS UTM 32N, but it lays always 2 meter next to the
> position where it belongs to (also
> > then, when I first tried to reproject it fist to wgs 84 and then to
> utm32N).
> >
> > then I tried it with ArcGIS and the
> DHDN_To_ETRS_1989_8_NTv2-Transformation and then it fits well....
> >
> > Thank you very much, Kai
>
> For the accurate transformations you need to have a grid shift file and you
> must tell that GDAL must use it by adding +nadgrids to the Proj4 projection
> string. I found from my computer this definition
>
> # DHDN / 3-degree Gauss zone 4 (deprecated)
> <31464> +proj=tmerc +lat_0=0 +lon_0=12 +k=1 +x_0=4500000 +y_0=0
> +datum=potsdam +units=m +no_defs  <>
>
> By looking at document
> http://support.esri.com/en/knowledgebase/techarticles/detail/18317 it looks
> that you will need a file named "BETA2007.gsb". Find and copy it from your
> ESRI installation into your GDAL data directory. Your ogr2ogr command should
> be then
>
> ogr2ogr -f "ESRI Shapefile" -s_srs "+proj=tmerc +lat_0=0 +lon_0=12 +k=1
> +x_0=4500000 +y_0=0 +datum=potsdam +nadgrids=BETA2007.gsb +units=m +no_defs"
> -t_srs epsg:25832 output.shp input.shp
>
> No guarantee that this works but have a try, it will take only couple of
> minutes. Run ogr2ogr with --debug ON and I suppose that it will tell you if
> it finds the grid shift file.
>
> -Jukka Rahkonen-
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From andre+joost at nurfuerspam.de  Tue Jun  3 07:42:00 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 03 Jun 2014 16:42:00 +0200
Subject: [gdal-dev] Question to ogr2ogr
In-Reply-To: <loom.20140603T131737-97@post.gmane.org>
References: <20140603091405.62CE0EC0CC4@dd19722.kasserver.com>
	<loom.20140603T131737-97@post.gmane.org>
Message-ID: <lmkmug$k0s$1@ger.gmane.org>

Am 03.06.2014 13:44, schrieb Jukka Rahkonen:

>
> ogr2ogr -f "ESRI Shapefile" -s_srs "+proj=tmerc +lat_0=0 +lon_0=12 +k=1
> +x_0=4500000 +y_0=0 +datum=potsdam +nadgrids=BETA2007.gsb +units=m +no_defs"
> -t_srs epsg:25832 output.shp input.shp
>

the +datum=potsdam can be misleading, this includes fixed +towgs84 
parameters.

I used this for cs2cs transformation:

cs2cs +proj=tmerc +lat_0=0 +lon_0=9 +x_0=3500000 +y_0=0 +k=1.000000 
+ellps=bessel +units=m +nadgrids=./BETA2007.gsb +wktext +to 
+init=epsg:4326 31467.txt >>out.txt

lon_0 and x_0 depending on your DHDN zone. The gsb file should be in the 
same folder, or include the full path to it.

HTH,
Andr? Joost



From luc.vanlinden at gmail.com  Tue Jun  3 08:45:58 2014
From: luc.vanlinden at gmail.com (lucvanlinden)
Date: Tue, 3 Jun 2014 08:45:58 -0700 (PDT)
Subject: [gdal-dev] OGR v1.11 CSV GEOM=AS_WKT truncated to 8000 characters
 (works normally in v1.10.1)
Message-ID: <1401810358172-5143804.post@n6.nabble.com>

Hi All


With upgrading to ogr 1.11 it seems that OGR2OGR -lco geom=AS_WKT, when used
in writing to a CSV output format, the WKT notation is truncated to a length
of 8000 characters.

This is/was not the case with ogr 1.10.1.

Can this be confirmed as being a bug?

On Win7 64 bit

tx

Luc





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/OGR-v1-11-CSV-GEOM-AS-WKT-truncated-to-8000-characters-works-normally-in-v1-10-1-tp5143804.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From peifer at gmx.eu  Tue Jun  3 09:15:10 2014
From: peifer at gmx.eu (Hermann Peifer)
Date: Tue, 03 Jun 2014 18:15:10 +0200
Subject: [gdal-dev] OGR v1.11 CSV GEOM=AS_WKT truncated to 8000
 characters (works normally in v1.10.1)
In-Reply-To: <1401810358172-5143804.post@n6.nabble.com>
References: <1401810358172-5143804.post@n6.nabble.com>
Message-ID: <538DF48E.3000503@gmx.eu>

On 2014-06-03 17:45, lucvanlinden wrote:
> Hi All
>
>
> With upgrading to ogr 1.11 it seems that OGR2OGR -lco geom=AS_WKT, when used
> in writing to a CSV output format, the WKT notation is truncated to a length
> of 8000 characters.
>
> This is/was not the case with ogr 1.10.1.
>
> Can this be confirmed as being a bug?
>

Same here with GDAL 1.12dev from trunk, on Mac OS

This works fine and prints lines with 1.5+M characters, with my sample data:

ogr2ogr -f csv out.csv source_data -sql "select *,OGR_GEOM_WKT from layer"

Hermann

From even.rouault at mines-paris.org  Tue Jun  3 09:51:29 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 03 Jun 2014 18:51:29 +0200
Subject: [gdal-dev] RE : OGR v1.11 CSV GEOM=AS_WKT truncated to 8000
 characters (works normally in v1.10.1)
Message-ID: <75f5p4dfjr4dvnr3ffybxgrv.1401814289494@email.android.com>

Luc

Can you open a ticket about this??


---
Geospatial professional services
http://even.rouault.free.fr/services.html

<div>-------- Message d'origine --------</div><div>De : lucvanlinden <luc.vanlinden at gmail.com> </div><div>Date :03/06/2014  17:45  (GMT+01:00) </div><div>A : gdal-dev at lists.osgeo.org </div><div>Objet : [gdal-dev] OGR v1.11 CSV GEOM=AS_WKT truncated to 8000 characters
  (works normally in v1.10.1) </div><div>
</div>Hi All


With upgrading to ogr 1.11 it seems that OGR2OGR -lco geom=AS_WKT, when used
in writing to a CSV output format, the WKT notation is truncated to a length
of 8000 characters.

This is/was not the case with ogr 1.10.1.

Can this be confirmed as being a bug?

On Win7 64 bit

tx

Luc





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/OGR-v1-11-CSV-GEOM-AS-WKT-truncated-to-8000-characters-works-normally-in-v1-10-1-tp5143804.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140603/f85cba87/attachment.html>

From troll1602 at gmail.com  Tue Jun  3 12:43:29 2014
From: troll1602 at gmail.com (Ryan)
Date: Tue, 3 Jun 2014 12:43:29 -0700
Subject: [gdal-dev] Reading contents of Erdas Block File
In-Reply-To: <CACo4qxDDWFBNWMc9ow+3pC3L0JA_75wqA1k2Ng_yKzdRBFAmrQ@mail.gmail.com>
References: <CACo4qxA9WUh3sB=Ltzg6qbE6xbJvKR0A8k8SzTonGadTqxkfGA@mail.gmail.com>
	<2326311.R2eHnoToIa@even-thinkpad-l530>
	<CACo4qxCEHduBHBv3FdW4xUr+GqDro60Swv9aRQRois5jGYFprw@mail.gmail.com>
	<1765073.IFJndEhmdS@even-thinkpad-l530>
	<CACo4qxDDWFBNWMc9ow+3pC3L0JA_75wqA1k2Ng_yKzdRBFAmrQ@mail.gmail.com>
Message-ID: <CACo4qxDef05y8wjDw7QDc2npyEvFOuEeTaBmE0soOGscmTa_YQ@mail.gmail.com>

Looking around the source for the HFA driver I was able to find
hfatest.cpp. I compiled that and got what I needed with the -dt option.
Problem solved!


-Ryan


On Fri, May 30, 2014 at 9:10 AM, Ryan <troll1602 at gmail.com> wrote:

> Erdas has some example data:
>
> http://download.intergraph.com/downloads/imagine-photogrammetry-and-lps-example-data
>
> It's a large zip (~900Mb) so I attached just the important image/block
> file/doc.
>
> -Ryan
>
>
>
>
> On Fri, May 30, 2014 at 12:51 AM, Even Rouault <
> even.rouault at mines-paris.org> wrote:
>
>>  On Thursday 29 May 2014 16:42:35 Ryan wrote:
>>
>> > There is a set of images (a handful of .img) and only one block file. I
>> can
>>
>> > open any of the images but that doesn't seem to access the metadata
>> that's
>>
>> > stored on the block file.
>>
>>
>>
>> Access to the .blk and one of the .img could be useful for investigation.
>>
>>
>>
>> >
>>
>> > -Ryan
>>
>> >
>>
>> >
>>
>> > On Thu, May 29, 2014 at 3:24 PM, Even Rouault <
>> even.rouault at mines-paris.org>
>>
>> > wrote:
>>
>> > > On Thursday 29 May 2014 12:41:17 Ryan wrote:
>>
>> > > > I have some imagery that has metadata stored in Erdas Block Files
>> (.blk)
>>
>> > > >
>>
>> > > > that I am having a hard time reading.
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > It likes the data is stored in an HFA Header, when viewing the file
>> (cat
>>
>> > >
>>
>> > > or
>>
>> > >
>>
>> > > > less) it begins with "EHFA_HEADER_TAG".
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > However, there are no raster bands so using gdalinfo or GDALOpen
>> errors
>>
>> > >
>>
>> > > out
>>
>> > >
>>
>> > > > with:
>>
>> > > >
>>
>> > > > ERROR 1: Unable to open image_name_file.blk, it has zero usable
>> bands.
>>
>> > >
>>
>> > > Did you try opening the main file, the .img ?
>>
>> > >
>>
>> > > > Any ideas on reading this kind of file?
>>
>> > > >
>>
>> > > >
>>
>> > > >
>>
>> > > > -Ryan
>>
>> > >
>>
>> > > --
>>
>> > >
>>
>> > > Geospatial professional services
>>
>> > >
>>
>> > > http://even.rouault.free.fr/services.html
>>
>> --
>>
>> Geospatial professional services
>>
>> http://even.rouault.free.fr/services.html
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140603/6446ef7b/attachment.html>

From jukka.rahkonen at mmmtike.fi  Wed Jun  4 04:00:30 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 4 Jun 2014 11:00:30 +0000 (UTC)
Subject: [gdal-dev] Convert raster into points with GDAL?
Message-ID: <loom.20140604T125459-297@post.gmane.org>

Hi,

Is there a tool for converting rasters into vector grids, either points or
polygons? I know gdal_polygonize but what I am after would just create a
regular grid of points or polygons and write raster values into attributes.
I can do that with SEXTANTE vectorization tools but I would rather use GDAL.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Wed Jun  4 04:54:53 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 04 Jun 2014 13:54:53 +0200
Subject: [gdal-dev] Convert raster into points with GDAL?
In-Reply-To: <loom.20140604T125459-297@post.gmane.org>
References: <loom.20140604T125459-297@post.gmane.org>
Message-ID: <1401882893.538f090dc067a@imp.free.fr>

Hi Jukka,

At least two ways of turning a raster into a grid of poinds :

* gdal2ogr mentionned in http://trac.osgeo.org/gdal/wiki/CodeSnippets. You need
to compile it from source.

* Otherwise http://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal2xyz.py
. With the -csv option, it will create a CSV file.

Even

> Hi,
>
> Is there a tool for converting rasters into vector grids, either points or
> polygons? I know gdal_polygonize but what I am after would just create a
> regular grid of points or polygons and write raster values into attributes.
> I can do that with SEXTANTE vectorization tools but I would rather use GDAL.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From dhdeangelis at gmail.com  Wed Jun  4 05:33:37 2014
From: dhdeangelis at gmail.com (=?UTF-8?Q?Hern=C3=A1n_De_Angelis?=)
Date: Wed, 4 Jun 2014 14:33:37 +0200
Subject: [gdal-dev] Convert raster into points with GDAL?
In-Reply-To: <loom.20140604T125459-297@post.gmane.org>
References: <loom.20140604T125459-297@post.gmane.org>
Message-ID: <CALzmt=RZYwTPP=U908Z96mQtrr-CmED+_xj3ztiKcwpyBR19EA@mail.gmail.com>

One option is exporting to NetCDF format and running GMT's grd2xy (
http://gmt.soest.hawaii.edu/doc/latest/grd2xyz.html). If the raster is big
this will be slow though.

H.


On Wed, Jun 4, 2014 at 1:00 PM, Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>
wrote:

> Hi,
>
> Is there a tool for converting rasters into vector grids, either points or
> polygons? I know gdal_polygonize but what I am after would just create a
> regular grid of points or polygons and write raster values into attributes.
> I can do that with SEXTANTE vectorization tools but I would rather use
> GDAL.
>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Hern?n De Angelis

Glaciers & Remote Sensing                 |   Sustainability &
Environmental Science
http://talesoficeandstone.blogspot.se/   |
http://talesofafiniteplanet.blogspot.se/
<http://talesoficeandstone.blogspot.se/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140604/2cca4e15/attachment.html>

From jluis at ualg.pt  Wed Jun  4 05:46:19 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Wed, 04 Jun 2014 13:46:19 +0100
Subject: [gdal-dev] Convert raster into points with GDAL?
In-Reply-To: <CALzmt=RZYwTPP=U908Z96mQtrr-CmED+_xj3ztiKcwpyBR19EA@mail.gmail.com>
References: <loom.20140604T125459-297@post.gmane.org>
	<CALzmt=RZYwTPP=U908Z96mQtrr-CmED+_xj3ztiKcwpyBR19EA@mail.gmail.com>
Message-ID: <538F151B.2070104@ualg.pt>

On 04-06-2014 13:33, Hern?n De Angelis wrote:
> One option is exporting to NetCDF format and running GMT's grd2xy 
> (http://gmt.soest.hawaii.edu/doc/latest/grd2xyz.html). If the raster 
> is big this will be slow though.

If GMT was built with the GDAL link (nearly all the GMT5's and many of 
the GMT4's) you don't need to convert the grid format, just use it as 
is. And why you say it's slow (apart from the time taken to same a 
potentially big ascii file on disk)?

Joaquim

>
> H.
>
>
> On Wed, Jun 4, 2014 at 1:00 PM, Jukka Rahkonen 
> <jukka.rahkonen at mmmtike.fi <mailto:jukka.rahkonen at mmmtike.fi>> wrote:
>
>     Hi,
>
>     Is there a tool for converting rasters into vector grids, either
>     points or
>     polygons? I know gdal_polygonize but what I am after would just
>     create a
>     regular grid of points or polygons and write raster values into
>     attributes.
>     I can do that with SEXTANTE vectorization tools but I would rather
>     use GDAL.
>
>     -Jukka Rahkonen-
>
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
> -- 
> Hern?n De Angelis
>
> Glaciers & Remote Sensing                 |   Sustainability & 
> Environmental Science
> http://talesoficeandstone.blogspot.se/   | 
> http://talesofafiniteplanet.blogspot.se/ 
> <http://talesoficeandstone.blogspot.se/>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140604/5aebbdb2/attachment-0001.html>

From lucena_ivan at hotmail.com  Wed Jun  4 08:01:33 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Wed, 4 Jun 2014 11:01:33 -0400
Subject: [gdal-dev] AOI, Signature and Fourier Transform files' access?
In-Reply-To: <CAJnZZa+xao=r4T0CgeqbjuHiiw3g6c+h5AgUfArJhVJ_6bVVuw@mail.gmail.com>
References: <CAJnZZa+xao=r4T0CgeqbjuHiiw3g6c+h5AgUfArJhVJ_6bVVuw@mail.gmail.com>
Message-ID: <BLU173-W3641A86398D275CBD95E3F90220@phx.gbl>

Hi Ramesh,

Are those files real raster images or auxiliary information, companion of .img files? Can you point to a website that describe those files?

There is nothing on [http://www.gdal.org/frmt_hfa.html] that says the HFA driver reads it. 

Assuming that those are auxiliary information, would you like GDAL to convert the information on the signature/fourier file to another GDAL format that also supports it (if there one) or would you like to write your own application to deal with that information?

Best regards,

Ivan




Date: Fri, 11 Apr 2014 14:32:49 +0530
From: userofgdal at gmail.com
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] AOI, Signature and Fourier Transform files' access?

Dear all,Good Morning!

Is it possible to read/write ERDAS AOI, Signature (.sig) and Fast Fourier Transform image data from GDAL? If so, can anyone kindly teach me how to.

With many thanks,
Yours sincerely, B. Ramesh 

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140604/e6a02d23/attachment.html>

From matwod at gmail.com  Wed Jun  4 08:35:52 2014
From: matwod at gmail.com (Mateusz Wodzikowski)
Date: Wed, 4 Jun 2014 17:35:52 +0200
Subject: [gdal-dev] Behavior of Polygonize function (JAVA bindings to GDAL)
Message-ID: <CACAf=SAsQzsJO7yZ2-BJ2mc=eU00v_NKcadaaeeAKjRTvdb2TA@mail.gmail.com>

Hello,

I just discovered strange behavior of Polygonize function in JAVA bindings
to GDAL.
The function do not create the attribute in which the value of raster is
stored as it is described in http://www.gdal.org/gdal_polygonize.html .

After performing the function on a raster GeoTIFF file the it seems that
the value of the raster is not passed to the resulting features.
The method GetFieldAsDouble("DN") gives: ERROR 1: No such field: 'DN'.
Additionally the feat.GetFieldCount() gives 0. When I try to print the
field with ID 0 (GetFieldAsDouble(0)) I get consecutive numbers from 0 to
the total number of polygons which were 'discovered'.

I use:
GDAL 1.11.0
jdk 1.7u55
Apache Ant 1.9.4
swig-3.0.1

JAVA bindings compiled using VS 9.0 on Win7 64bit machine

Best regards,
Mateusz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140604/d1bd1d6c/attachment.html>

From jukka.rahkonen at mmmtike.fi  Wed Jun  4 09:30:58 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Wed, 4 Jun 2014 16:30:58 +0000 (UTC)
Subject: [gdal-dev] Convert raster into points with GDAL?
References: <loom.20140604T125459-297@post.gmane.org>
	<1401882893.538f090dc067a@imp.free.fr>
Message-ID: <loom.20140604T182624-587@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Hi Jukka,
> 
> At least two ways of turning a raster into a grid of poinds :
> 
> * gdal2ogr mentionned in http://trac.osgeo.org/gdal/wiki/CodeSnippets. You
need
> to compile it from source.
> 
> * Otherwise
http://svn.osgeo.org/gdal/trunk/gdal/swig/python/scripts/gdal2xyz.py
> . With the -csv option, it will create a CSV file.
> 
> Even

Hi,

Thanks, I will try gdal2xyz then. I wonder if gdal_polygonize.py could have
three options 1) Create minimum amount of polygons by making a union of
connected cells with the same value (the default) 2) Create cells (polygons)
without union 3) Create points.

-Jukka Rahkonen-


From taibc_coltech at yahoo.com  Wed Jun  4 23:45:13 2014
From: taibc_coltech at yahoo.com (taibc)
Date: Wed, 4 Jun 2014 23:45:13 -0700 (PDT)
Subject: [gdal-dev] Asking about feature field types of Shape File (SHP) ?
Message-ID: <1401950713440-5144127.post@n6.nabble.com>

Hi everyone,

I created the shape file by usinge the feature filed type: OFTInteger.

But when I open the file in Arcgis (ArcCatalog) the data type is: Double
(not integer). 

Do you know how to fix this (I want it is Int) ?

Thanks and regards,
Tai



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Asking-about-feature-field-types-of-Shape-File-SHP-tp5144127.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at mines-paris.org  Thu Jun  5 12:18:48 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 5 Jun 2014 21:18:48 +0200
Subject: [gdal-dev] Behavior of Polygonize function (JAVA bindings to
	GDAL)
In-Reply-To: <CACAf=SAsQzsJO7yZ2-BJ2mc=eU00v_NKcadaaeeAKjRTvdb2TA@mail.gmail.com>
References: <CACAf=SAsQzsJO7yZ2-BJ2mc=eU00v_NKcadaaeeAKjRTvdb2TA@mail.gmail.com>
Message-ID: <201406052118.48765.even.rouault@mines-paris.org>

Mateusz,

The Polygonize method assumes that you have created the field in the layer 
definition, before calling it.
See the gdal_polygonize.py script as an example on how it is done in Python.
The related Java API is ogr.Layer.CreateField()

Best regards,

Even

Le mercredi 04 juin 2014 17:35:52, Mateusz Wodzikowski a ?crit :
> Hello,
> 
> I just discovered strange behavior of Polygonize function in JAVA bindings
> to GDAL.
> The function do not create the attribute in which the value of raster is
> stored as it is described in http://www.gdal.org/gdal_polygonize.html .
> 
> After performing the function on a raster GeoTIFF file the it seems that
> the value of the raster is not passed to the resulting features.
> The method GetFieldAsDouble("DN") gives: ERROR 1: No such field: 'DN'.
> Additionally the feat.GetFieldCount() gives 0. When I try to print the
> field with ID 0 (GetFieldAsDouble(0)) I get consecutive numbers from 0 to
> the total number of polygons which were 'discovered'.
> 
> I use:
> GDAL 1.11.0
> jdk 1.7u55
> Apache Ant 1.9.4
> swig-3.0.1
> 
> JAVA bindings compiled using VS 9.0 on Win7 64bit machine
> 
> Best regards,
> Mateusz

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jay at alaska.edu  Thu Jun  5 13:56:49 2014
From: jay at alaska.edu (Jay Cable)
Date: Thu, 5 Jun 2014 12:56:49 -0800
Subject: [gdal-dev] A problem with Alaska State Plane Zone 1 and ogr2ogr
Message-ID: <CAMz32fEfAgMJqg5w9YEmwFS8cWT95EwfY0DNRDQN1Xra6qQnfw@mail.gmail.com>

Hello,

Please forgive me if this is the wrong place for this question, but  I am
trying to use Alaska State Plane Zone 1 with ogr2ogr, and can't seem to get
it to project the data correctly.  I am probably doing something wrong, but
can't seem to figure it out.   I am pretty sure that my projection string
is correct, as the results from proj match what the NGS's online calculator
gives.

When I use ogr2ogr like this:
ogr2ogr -t_srs "+proj=omerc +lat_0=57 +lonc=-133.6666666666667
+alpha=-36.86989764583333 +k=0.9999 +x_0=5000000 +y_0=-5000000 +no_uoff
+datum=NAD83 +units=m +no_defs" akzone1.zhp point.84.shp

On a shapefile with a single point  - POINT (-131.811033901222117
55.409950489560302)

I get:
POINT (4988757.639998742379248 -5210867.590697132050991)

What I get from a shape file reprojected with ESRI products is:
POINT (936203.399999997578561 399658.200000001117587)

I believe the ESRI result is correct, as it matches the the NGA online
converter.

Proj also generates the correct value:
Jays-MacBook-Air-2:zone1 Jay$ proj +proj=omerc +lat_0=57
+lonc=-133.6666666666667 +alpha=-36.86989764583333 +k=0.9999 +x_0=5000000
+y_0=-5000000 +no_uoff +datum=NAD83 +units=m +no_defs
-131.811033901222117 55.409950489560302
936203.40    399658.20


So, my question is what am I missing to make the results from ogr2ogr match
up with proj?

My thanks,
 -Jay Cable

Jays-MacBook-Air-2:zone1 Jay$ proj
Rel. 4.8.0, 6 March 2012
usage: proj [ -beEfiIlormsStTvVwW [args] ] [ +opts[=arg] ] [ files ]

Jays-MacBook-Air-2:zone1 Jay$ ogr2ogr --version
GDAL 1.11.0, released 2014/04/16


Oh,  the online NGS converter I mentioned:
http://www.ngs.noaa.gov/cgi-bin/spc_getpc.prl

 =======================================================
           Latitude           Longitude      Datum Zone
 INPUT =   N552435.8217       W1314839.7220  NAD83 5001
 =======================================================

  NORTH(Y)    EAST(X)     AREA  CONVERGENCE   SCALE
  METERS      METERS            DD MM SS.ss
  ----------- ----------- ----  -----------   ----------
  399658.198  936203.401  AK 1   1 32 38.22   0.99990159














- Jay Cable - jay at alaska.edu - (907)474-1856 -
- Geographic Information Network of Alaska -  University of Alaska  -
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140605/c0445ab0/attachment.html>

From even.rouault at mines-paris.org  Fri Jun  6 12:18:31 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 6 Jun 2014 21:18:31 +0200
Subject: [gdal-dev] A problem with Alaska State Plane Zone 1 and ogr2ogr
In-Reply-To: <CAMz32fEfAgMJqg5w9YEmwFS8cWT95EwfY0DNRDQN1Xra6qQnfw@mail.gmail.com>
References: <CAMz32fEfAgMJqg5w9YEmwFS8cWT95EwfY0DNRDQN1Xra6qQnfw@mail.gmail.com>
Message-ID: <201406062118.31512.even.rouault@mines-paris.org>

Jay,

I've reproduced and fixed your issue. See 
http://trac.osgeo.org/gdal/ticket/5511 for details

An easy workaround is to add " +wktext" at the end of your proj.4 string. This 
will instruct the GDAL SpatialReference engine to keep literaly your proj.4 
string to use it later. Otherwise the original proj.4 is converted into WKT 
and not preserved, so when needed it afterwards, GDAL rebuilds it from WKT.

Best regards,

Even

> Hello,
> 
> Please forgive me if this is the wrong place for this question, but  I am
> trying to use Alaska State Plane Zone 1 with ogr2ogr, and can't seem to get
> it to project the data correctly.  I am probably doing something wrong, but
> can't seem to figure it out.   I am pretty sure that my projection string
> is correct, as the results from proj match what the NGS's online calculator
> gives.
> 
> When I use ogr2ogr like this:
> ogr2ogr -t_srs "+proj=omerc +lat_0=57 +lonc=-133.6666666666667
> +alpha=-36.86989764583333 +k=0.9999 +x_0=5000000 +y_0=-5000000 +no_uoff
> +datum=NAD83 +units=m +no_defs" akzone1.zhp point.84.shp
> 
> On a shapefile with a single point  - POINT (-131.811033901222117
> 55.409950489560302)
> 
> I get:
> POINT (4988757.639998742379248 -5210867.590697132050991)
> 
> What I get from a shape file reprojected with ESRI products is:
> POINT (936203.399999997578561 399658.200000001117587)
> 
> I believe the ESRI result is correct, as it matches the the NGA online
> converter.
> 
> Proj also generates the correct value:
> Jays-MacBook-Air-2:zone1 Jay$ proj +proj=omerc +lat_0=57
> +lonc=-133.6666666666667 +alpha=-36.86989764583333 +k=0.9999 +x_0=5000000
> +y_0=-5000000 +no_uoff +datum=NAD83 +units=m +no_defs
> -131.811033901222117 55.409950489560302
> 936203.40    399658.20
> 
> 
> So, my question is what am I missing to make the results from ogr2ogr match
> up with proj?
> 
> My thanks,
>  -Jay Cable
> 
> Jays-MacBook-Air-2:zone1 Jay$ proj
> Rel. 4.8.0, 6 March 2012
> usage: proj [ -beEfiIlormsStTvVwW [args] ] [ +opts[=arg] ] [ files ]
> 
> Jays-MacBook-Air-2:zone1 Jay$ ogr2ogr --version
> GDAL 1.11.0, released 2014/04/16
> 
> 
> Oh,  the online NGS converter I mentioned:
> http://www.ngs.noaa.gov/cgi-bin/spc_getpc.prl
> 
>  =======================================================
>            Latitude           Longitude      Datum Zone
>  INPUT =   N552435.8217       W1314839.7220  NAD83 5001
>  =======================================================
> 
>   NORTH(Y)    EAST(X)     AREA  CONVERGENCE   SCALE
>   METERS      METERS            DD MM SS.ss
>   ----------- ----------- ----  -----------   ----------
>   399658.198  936203.401  AK 1   1 32 38.22   0.99990159
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> 
> - Jay Cable - jay at alaska.edu - (907)474-1856 -
> - Geographic Information Network of Alaska -  University of Alaska  -

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From gusevmihs at gmail.com  Fri Jun  6 12:38:08 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Fri, 6 Jun 2014 23:38:08 +0400
Subject: [gdal-dev] GSoC weekly report 3. GDAL Networking
Message-ID: <CAJB43Vqh+7ZfGNA1FWkmxxHcnx5GvczpXX2e2VtyhhM2Tf8aDA@mail.gmail.com>

Hello everyone.

This week I have completed the methods of an old (current) API, which I
describe in this post:
http://gsoc2014gnm.blogspot.ru/2014/06/week-3-some-old-methods-completed.html.
My plans about implementing new API and moving all methods to it migrate to
the next week, because at this one I was a bit busy with my Master's thesis
preparations. I also plan to build GDAL from source, as I previously
intended.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140606/7fa2fe15/attachment.html>

From varunsaraf14 at gmail.com  Fri Jun  6 13:14:32 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Sat, 7 Jun 2014 01:44:32 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 3 : Implement write support for
 GDAL PostGIS Raster driver for GDAL
Message-ID: <CAPfr+rtTYy=v4k-gD72Ev_T5=c0fcvWcGEZ6LKmgQNswJa=Qzg@mail.gmail.com>

Hi,

Below is my third weekly report:

*What did I do this week?*

   - Modified the PostGISRasterRasterBand::IRasterIO method, enabling it to
   process the buffer(pData) containing the raster data for write
   mode(GF_Write). After the datatype conversion it is ready to be written to
   the query. In the meanwhile, I realized that while inserting a raster in a
   table it is always broken into evenly sized tiles. So the default
   implementation of GDALRasterBand::IRasterIO can be possibly used to handle
   the write case.
   - Implemented PostGISRasterDataset::InsertRecords method which creates
   the insert query.

*What do I plan on doing next week?*

   - Continue to write methods to create the sql query which will write
   data to the PostgreSQL tables.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-3
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140607/6b882276/attachment.html>

From jay at alaska.edu  Fri Jun  6 18:18:52 2014
From: jay at alaska.edu (Jay Cable)
Date: Fri, 6 Jun 2014 17:18:52 -0800
Subject: [gdal-dev] A problem with Alaska State Plane Zone 1 and ogr2ogr
In-Reply-To: <201406062118.31512.even.rouault@mines-paris.org>
References: <CAMz32fEfAgMJqg5w9YEmwFS8cWT95EwfY0DNRDQN1Xra6qQnfw@mail.gmail.com>
	<201406062118.31512.even.rouault@mines-paris.org>
Message-ID: <CAMz32fEja+C6MXJD5v0LsmSXC_XF=AZ-5wKFdSV1dpz2-f+fmA@mail.gmail.com>

Fantastic!  Adding the the "+wktext" argument makes ogr2ogr generate the
values I was expecting.  I will rebuild my copy of gdal with the fixes in
the ticked mentioned.

Thanks again,
  -Jay


- Jay Cable - jay at alaska.edu - (907)474-1856 -
- Geographic Information Network of Alaska -  University of Alaska  -


On Fri, Jun 6, 2014 at 11:18 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Jay,
>
> I've reproduced and fixed your issue. See
> http://trac.osgeo.org/gdal/ticket/5511 for details
>
> An easy workaround is to add " +wktext" at the end of your proj.4 string.
> This
> will instruct the GDAL SpatialReference engine to keep literaly your proj.4
> string to use it later. Otherwise the original proj.4 is converted into WKT
> and not preserved, so when needed it afterwards, GDAL rebuilds it from WKT.
>
> Best regards,
>
> Even
>
> > Hello,
> >
> > Please forgive me if this is the wrong place for this question, but  I am
> > trying to use Alaska State Plane Zone 1 with ogr2ogr, and can't seem to
> get
> > it to project the data correctly.  I am probably doing something wrong,
> but
> > can't seem to figure it out.   I am pretty sure that my projection string
> > is correct, as the results from proj match what the NGS's online
> calculator
> > gives.
> >
> > When I use ogr2ogr like this:
> > ogr2ogr -t_srs "+proj=omerc +lat_0=57 +lonc=-133.6666666666667
> > +alpha=-36.86989764583333 +k=0.9999 +x_0=5000000 +y_0=-5000000 +no_uoff
> > +datum=NAD83 +units=m +no_defs" akzone1.zhp point.84.shp
> >
> > On a shapefile with a single point  - POINT (-131.811033901222117
> > 55.409950489560302)
> >
> > I get:
> > POINT (4988757.639998742379248 -5210867.590697132050991)
> >
> > What I get from a shape file reprojected with ESRI products is:
> > POINT (936203.399999997578561 399658.200000001117587)
> >
> > I believe the ESRI result is correct, as it matches the the NGA online
> > converter.
> >
> > Proj also generates the correct value:
> > Jays-MacBook-Air-2:zone1 Jay$ proj +proj=omerc +lat_0=57
> > +lonc=-133.6666666666667 +alpha=-36.86989764583333 +k=0.9999 +x_0=5000000
> > +y_0=-5000000 +no_uoff +datum=NAD83 +units=m +no_defs
> > -131.811033901222117 55.409950489560302
> > 936203.40    399658.20
> >
> >
> > So, my question is what am I missing to make the results from ogr2ogr
> match
> > up with proj?
> >
> > My thanks,
> >  -Jay Cable
> >
> > Jays-MacBook-Air-2:zone1 Jay$ proj
> > Rel. 4.8.0, 6 March 2012
> > usage: proj [ -beEfiIlormsStTvVwW [args] ] [ +opts[=arg] ] [ files ]
> >
> > Jays-MacBook-Air-2:zone1 Jay$ ogr2ogr --version
> > GDAL 1.11.0, released 2014/04/16
> >
> >
> > Oh,  the online NGS converter I mentioned:
> > http://www.ngs.noaa.gov/cgi-bin/spc_getpc.prl
> >
> >  =======================================================
> >            Latitude           Longitude      Datum Zone
> >  INPUT =   N552435.8217       W1314839.7220  NAD83 5001
> >  =======================================================
> >
> >   NORTH(Y)    EAST(X)     AREA  CONVERGENCE   SCALE
> >   METERS      METERS            DD MM SS.ss
> >   ----------- ----------- ----  -----------   ----------
> >   399658.198  936203.401  AK 1   1 32 38.22   0.99990159
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> >
> > - Jay Cable - jay at alaska.edu - (907)474-1856 -
> > - Geographic Information Network of Alaska -  University of Alaska  -
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140606/572ebc7c/attachment.html>

From stefan.ziegler.de at gmail.com  Sat Jun  7 11:46:51 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Sat, 7 Jun 2014 20:46:51 +0200
Subject: [gdal-dev] WFS driver and filtering
Message-ID: <CAJvo+1-pVPp2ivkNs3UyqAv+0CXHsxn2bv-acechaaO+=j0tjQ@mail.gmail.com>

Hi

I have a question regarding client/server sided filtering. According to the
wfs driver website [1] the driver is able to forward spatial and attribute
filter to the server. If this is not possible it will client-side only
filtering. When does the driver "decide" wether it filters client or server
sided? I assume it reads the GetCapabilites file, right?

I do have a wfs server which understands ogc filtering (tested with simple
GET requests in browser)  but the ogr wfs driver does only client sided
filtering. Probably a broken GetCapabilities file...

I'm using gdal/ogr 1.11.

[1]: http://www.gdal.org/drv_wfs.html


best regards
Stefan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140607/6fb49879/attachment.html>

From even.rouault at mines-paris.org  Sat Jun  7 11:56:00 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 7 Jun 2014 20:56:00 +0200
Subject: [gdal-dev] WFS driver and filtering
In-Reply-To: <CAJvo+1-pVPp2ivkNs3UyqAv+0CXHsxn2bv-acechaaO+=j0tjQ@mail.gmail.com>
References: <CAJvo+1-pVPp2ivkNs3UyqAv+0CXHsxn2bv-acechaaO+=j0tjQ@mail.gmail.com>
Message-ID: <201406072056.00934.even.rouault@mines-paris.org>

Le samedi 07 juin 2014 20:46:51, Stefan Ziegler a ?crit :
> Hi
> 
> I have a question regarding client/server sided filtering. According to the
> wfs driver website [1] the driver is able to forward spatial and attribute
> filter to the server. If this is not possible it will client-side only
> filtering. When does the driver "decide" wether it filters client or server
> sided? I assume it reads the GetCapabilites file, right?
> 
> I do have a wfs server which understands ogc filtering (tested with simple
> GET requests in browser)  but the ogr wfs driver does only client sided
> filtering. Probably a broken GetCapabilities file...

Stefan,

Well, it should maybe, but generally it assumes that the standard operators 
(>,>=,<,<=,==,NOT,AND,OR) are implement by the server.

The choice between client-side and server-side filtering is based on the 
content of the attribute filter. Some stuff can be turned into OGC Filter 
language, some not (for example if using special OGR field names).
It maybe also due to a limitation of the current implementation that turn the 
SQL into OGC filter

What is your filter ?

> 
> I'm using gdal/ogr 1.11.
> 
> [1]: http://www.gdal.org/drv_wfs.html
> 
> 
> best regards
> Stefan

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From stefan.ziegler.de at gmail.com  Sat Jun  7 12:36:21 2014
From: stefan.ziegler.de at gmail.com (Stefan Ziegler)
Date: Sat, 7 Jun 2014 21:36:21 +0200
Subject: [gdal-dev] WFS driver and filtering
In-Reply-To: <201406072056.00934.even.rouault@mines-paris.org>
References: <CAJvo+1-pVPp2ivkNs3UyqAv+0CXHsxn2bv-acechaaO+=j0tjQ@mail.gmail.com>
	<201406072056.00934.even.rouault@mines-paris.org>
Message-ID: <CAJvo+1_Tp7nMkQNEu9beGz35H-c06pbxLvqN0jNkQd0=G7vFew@mail.gmail.com>

Hi Even

Using python:

from osgeo import ogr

driver = ogr.GetDriverByName('WFS')
wfs = driver.Open("WFS:http://www.catais.org/wfs/mopublic?")

out = "/home/stefan/Projekte/GeoPackage/test5.gpkg"
outDriver = ogr.GetDriverByName("GPKG")
outDataSource = outDriver.CreateDataSource(out)

layer = wfs.GetLayerByName('hoheitsgrenzen__hoheitsgrenzpunkt')
layer.SetAttributeFilter("bfsnr = 2601")
outLayer = outDataSource.CopyLayer(layer,'test5')

I see 4 request in the apache log:

1. GetCapabilities
2. DescribeFeatureType
3. GetFeature
4. GetFeature

(3) and (4) are equal except (3) adds
",xsd=/vsimem/tempwfs_0x1e50ad0/file.xsd". But no filter is added, pure
GetFeature request.

regards
Stefan



On Sat, Jun 7, 2014 at 8:56 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le samedi 07 juin 2014 20:46:51, Stefan Ziegler a ?crit :
> > Hi
> >
> > I have a question regarding client/server sided filtering. According to
> the
> > wfs driver website [1] the driver is able to forward spatial and
> attribute
> > filter to the server. If this is not possible it will client-side only
> > filtering. When does the driver "decide" wether it filters client or
> server
> > sided? I assume it reads the GetCapabilites file, right?
> >
> > I do have a wfs server which understands ogc filtering (tested with
> simple
> > GET requests in browser)  but the ogr wfs driver does only client sided
> > filtering. Probably a broken GetCapabilities file...
>
> Stefan,
>
> Well, it should maybe, but generally it assumes that the standard operators
> (>,>=,<,<=,==,NOT,AND,OR) are implement by the server.
>
> The choice between client-side and server-side filtering is based on the
> content of the attribute filter. Some stuff can be turned into OGC Filter
> language, some not (for example if using special OGR field names).
> It maybe also due to a limitation of the current implementation that turn
> the
> SQL into OGC filter
>
> What is your filter ?
>
> >
> > I'm using gdal/ogr 1.11.
> >
> > [1]: http://www.gdal.org/drv_wfs.html
> >
> >
> > best regards
> > Stefan
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140607/fbb4548c/attachment.html>

From even.rouault at mines-paris.org  Sat Jun  7 12:50:31 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 7 Jun 2014 21:50:31 +0200
Subject: [gdal-dev] WFS driver and filtering
In-Reply-To: <CAJvo+1_Tp7nMkQNEu9beGz35H-c06pbxLvqN0jNkQd0=G7vFew@mail.gmail.com>
References: <CAJvo+1-pVPp2ivkNs3UyqAv+0CXHsxn2bv-acechaaO+=j0tjQ@mail.gmail.com>
	<201406072056.00934.even.rouault@mines-paris.org>
	<CAJvo+1_Tp7nMkQNEu9beGz35H-c06pbxLvqN0jNkQd0=G7vFew@mail.gmail.com>
Message-ID: <201406072150.32438.even.rouault@mines-paris.org>

Le samedi 07 juin 2014 21:36:21, Stefan Ziegler a ?crit :
> Hi Even
> 
> Using python:
> 
> from osgeo import ogr
> 
> driver = ogr.GetDriverByName('WFS')
> wfs = driver.Open("WFS:http://www.catais.org/wfs/mopublic?")
> 
> out = "/home/stefan/Projekte/GeoPackage/test5.gpkg"
> outDriver = ogr.GetDriverByName("GPKG")
> outDataSource = outDriver.CreateDataSource(out)
> 
> layer = wfs.GetLayerByName('hoheitsgrenzen__hoheitsgrenzpunkt')
> layer.SetAttributeFilter("bfsnr = 2601")
> outLayer = outDataSource.CopyLayer(layer,'test5')
> 
> I see 4 request in the apache log:
> 
> 1. GetCapabilities
> 2. DescribeFeatureType
> 3. GetFeature
> 4. GetFeature
> 
> (3) and (4) are equal except (3) adds
> ",xsd=/vsimem/tempwfs_0x1e50ad0/file.xsd". But no filter is added, pure
> GetFeature request.

Actually I was wrong. Cannot even remember my own code from 4 years ago ;-)
It does check that GetCapabilities reports LogicalOperators or 
Logical_Operators, which your server does not.
Strictly speaking your request doesn't require LogicalOperators, so that could 
be improved of course to be less restrictive...
But that must be an antiquitated implementation of WFS: only 1.0.0 and no 
logical operators... ?

> 
> regards
> Stefan
> 
> 
> 
> On Sat, Jun 7, 2014 at 8:56 PM, Even Rouault <even.rouault at mines-paris.org>
> 
> wrote:
> > Le samedi 07 juin 2014 20:46:51, Stefan Ziegler a ?crit :
> > > Hi
> > > 
> > > I have a question regarding client/server sided filtering. According to
> > 
> > the
> > 
> > > wfs driver website [1] the driver is able to forward spatial and
> > 
> > attribute
> > 
> > > filter to the server. If this is not possible it will client-side only
> > > filtering. When does the driver "decide" wether it filters client or
> > 
> > server
> > 
> > > sided? I assume it reads the GetCapabilites file, right?
> > > 
> > > I do have a wfs server which understands ogc filtering (tested with
> > 
> > simple
> > 
> > > GET requests in browser)  but the ogr wfs driver does only client sided
> > > filtering. Probably a broken GetCapabilities file...
> > 
> > Stefan,
> > 
> > Well, it should maybe, but generally it assumes that the standard
> > operators (>,>=,<,<=,==,NOT,AND,OR) are implement by the server.
> > 
> > The choice between client-side and server-side filtering is based on the
> > content of the attribute filter. Some stuff can be turned into OGC Filter
> > language, some not (for example if using special OGR field names).
> > It maybe also due to a limitation of the current implementation that turn
> > the
> > SQL into OGC filter
> > 
> > What is your filter ?
> > 
> > > I'm using gdal/ogr 1.11.
> > > 
> > > [1]: http://www.gdal.org/drv_wfs.html
> > > 
> > > 
> > > best regards
> > > Stefan
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mailinglist.samfranklin at gmail.com  Sat Jun  7 13:31:09 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Sat, 7 Jun 2014 21:31:09 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkiaX+rA5Oe_MUOrCL2q=zFL3HS1F3e9uZC=4nXf2ownow@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201405262218.58381.even.rouault@mines-paris.org>
	<CA+M-UkiMoavpNAPyHCwJB274RO4pth4dgWNvZd2bDE4nL9Q-Kg@mail.gmail.com>
	<201405270231.08722.even.rouault@mines-paris.org>
	<CA+M-UkiaX+rA5Oe_MUOrCL2q=zFL3HS1F3e9uZC=4nXf2ownow@mail.gmail.com>
Message-ID: <CA+M-UkhEyp3A9PGOfU7S3qn0XD1KowNFORESsQHyVMkxmgrrig@mail.gmail.com>

Hey Even - me again on this xyz sorting issue.

I've got a new xyz file that it is not recognised by gdal even after using
the sort command you provided earlier in the thread.

The problem xyz is here |
https://dl.dropboxusercontent.com/u/4086367/001-1.xyz.zip

The error is:
 ERROR 1: Ungridded dataset: At line 363, X is 568509.090000, where as
568514.090000 was expected (1)
 gdalinfo failed - unable to open '001-1.xyz'.

GDAL seems to fail at the start of a new row of data?

I've tried various descend/ascend combinations of the columns = no joy.

I'm running GDAL 1.11.0 on OSX 10.9.3.

Any ideas?  Thanks again in advance for any help! Very much appreciated.

Cheers
Sam


On 27 May 2014 14:09, Sam Franklin <mailinglist.samfranklin at gmail.com>
wrote:

> Hi Even. Great, that worked for me too when sorting on both columns.
> Really appreciate you help.
> Sam
>
>
> On 27 May 2014 01:31, Even Rouault <even.rouault at mines-paris.org> wrote:
>
>> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
>> > Hey Even - great tip.  The sort command you suggested worked well with
>> that
>> > xyz dataset.
>> >
>> > However, I've found a further dataset that does not work with gdal even
>> > after the sort. This is the error:
>> >
>> > mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
>> > data08-02.tif
>> > Input file size is 4371, 11210
>> > 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
>> instead
>> > of 48164.000000 for nBlockYOff = 4951ERROR 1: data08-02-sorted.xyz,
>> band 1:
>> > IReadBlock failed at X offset 0, Y offset 4951
>> >
>> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 4951
>> >
>> > See screenshot below, the data is arranged into three 'strips'. See
>> dropbox
>> > link to the data |
>> > https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
>> >
>> > Any workaround you can think of?
>>
>> Probably an issue with just sorting on column 2. I didn't have the same
>> error
>> as you, but anyway you should try :
>>
>> sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz
>>
>> with that I manage to translate the file.
>>
>> --
>> Geospatial professional services
>> http://even.rouault.free.fr/services.html
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140607/213eafc6/attachment.html>

From even.rouault at mines-paris.org  Sat Jun  7 13:59:04 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 7 Jun 2014 22:59:04 +0200
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-UkhEyp3A9PGOfU7S3qn0XD1KowNFORESsQHyVMkxmgrrig@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<CA+M-UkiaX+rA5Oe_MUOrCL2q=zFL3HS1F3e9uZC=4nXf2ownow@mail.gmail.com>
	<CA+M-UkhEyp3A9PGOfU7S3qn0XD1KowNFORESsQHyVMkxmgrrig@mail.gmail.com>
Message-ID: <201406072259.04888.even.rouault@mines-paris.org>

Le samedi 07 juin 2014 22:31:09, Sam Franklin a ?crit :
> Hey Even - me again on this xyz sorting issue.
> 
> I've got a new xyz file that it is not recognised by gdal even after using
> the sort command you provided earlier in the thread.
> 
> The problem xyz is here |
> https://dl.dropboxusercontent.com/u/4086367/001-1.xyz.zip
> 
> The error is:
>  ERROR 1: Ungridded dataset: At line 363, X is 568509.090000, where as
> 568514.090000 was expected (1)
>  gdalinfo failed - unable to open '001-1.xyz'.
> 
> GDAL seems to fail at the start of a new row of data?
> 
> I've tried various descend/ascend combinations of the columns = no joy.
> 
> I'm running GDAL 1.11.0 on OSX 10.9.3.
> 
> Any ideas?  Thanks again in advance for any help! Very much appreciated.

The development version 2.0dev has improvements over 1.11 that would help a 
bit, but this file would still require additional developments since the 
spacing between horizontal or vertical coordinates isn't constant due to 
rounding to 2 decimal figures. Some tolerance should be added to the driver to 
support it.

> 
> Cheers
> Sam
> 
> 
> On 27 May 2014 14:09, Sam Franklin <mailinglist.samfranklin at gmail.com>
> 
> wrote:
> > Hi Even. Great, that worked for me too when sorting on both columns.
> > Really appreciate you help.
> > Sam
> > 
> > On 27 May 2014 01:31, Even Rouault <even.rouault at mines-paris.org> wrote:
> >> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
> >> > Hey Even - great tip.  The sort command you suggested worked well with
> >> 
> >> that
> >> 
> >> > xyz dataset.
> >> > 
> >> > However, I've found a further dataset that does not work with gdal
> >> > even after the sort. This is the error:
> >> > 
> >> > mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
> >> > data08-02.tif
> >> > Input file size is 4371, 11210
> >> > 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
> >> 
> >> instead
> >> 
> >> > of 48164.000000 for nBlockYOff = 4951ERROR 1: data08-02-sorted.xyz,
> >> 
> >> band 1:
> >> > IReadBlock failed at X offset 0, Y offset 4951
> >> > 
> >> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 4951
> >> > 
> >> > See screenshot below, the data is arranged into three 'strips'. See
> >> 
> >> dropbox
> >> 
> >> > link to the data |
> >> > https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
> >> > 
> >> > Any workaround you can think of?
> >> 
> >> Probably an issue with just sorting on column 2. I didn't have the same
> >> error
> >> as you, but anyway you should try :
> >> 
> >> sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz
> >> 
> >> with that I manage to translate the file.
> >> 
> >> --
> >> Geospatial professional services
> >> http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From mailinglist.samfranklin at gmail.com  Sun Jun  8 06:04:31 2014
From: mailinglist.samfranklin at gmail.com (Sam Franklin)
Date: Sun, 8 Jun 2014 14:04:31 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <201406072259.04888.even.rouault@mines-paris.org>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<CA+M-UkiaX+rA5Oe_MUOrCL2q=zFL3HS1F3e9uZC=4nXf2ownow@mail.gmail.com>
	<CA+M-UkhEyp3A9PGOfU7S3qn0XD1KowNFORESsQHyVMkxmgrrig@mail.gmail.com>
	<201406072259.04888.even.rouault@mines-paris.org>
Message-ID: <CA+M-Ukg00KSvFgH=zzxuTPqrZhY1AtR4HZsiXx9OuZW8X_sqLw@mail.gmail.com>

Even - okay thanks for taking a look, I'll check out the 2.0dev version as
you mentioned.
Cheers
S


On 7 June 2014 21:59, Even Rouault <even.rouault at mines-paris.org> wrote:

> Le samedi 07 juin 2014 22:31:09, Sam Franklin a ?crit :
> > Hey Even - me again on this xyz sorting issue.
> >
> > I've got a new xyz file that it is not recognised by gdal even after
> using
> > the sort command you provided earlier in the thread.
> >
> > The problem xyz is here |
> > https://dl.dropboxusercontent.com/u/4086367/001-1.xyz.zip
> >
> > The error is:
> >  ERROR 1: Ungridded dataset: At line 363, X is 568509.090000, where as
> > 568514.090000 was expected (1)
> >  gdalinfo failed - unable to open '001-1.xyz'.
> >
> > GDAL seems to fail at the start of a new row of data?
> >
> > I've tried various descend/ascend combinations of the columns = no joy.
> >
> > I'm running GDAL 1.11.0 on OSX 10.9.3.
> >
> > Any ideas?  Thanks again in advance for any help! Very much appreciated.
>
> The development version 2.0dev has improvements over 1.11 that would help a
> bit, but this file would still require additional developments since the
> spacing between horizontal or vertical coordinates isn't constant due to
> rounding to 2 decimal figures. Some tolerance should be added to the
> driver to
> support it.
>
> >
> > Cheers
> > Sam
> >
> >
> > On 27 May 2014 14:09, Sam Franklin <mailinglist.samfranklin at gmail.com>
> >
> > wrote:
> > > Hi Even. Great, that worked for me too when sorting on both columns.
> > > Really appreciate you help.
> > > Sam
> > >
> > > On 27 May 2014 01:31, Even Rouault <even.rouault at mines-paris.org>
> wrote:
> > >> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
> > >> > Hey Even - great tip.  The sort command you suggested worked well
> with
> > >>
> > >> that
> > >>
> > >> > xyz dataset.
> > >> >
> > >> > However, I've found a further dataset that does not work with gdal
> > >> > even after the sort. This is the error:
> > >> >
> > >> > mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
> > >> > data08-02.tif
> > >> > Input file size is 4371, 11210
> > >> > 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
> > >>
> > >> instead
> > >>
> > >> > of 48164.000000 for nBlockYOff = 4951ERROR 1: data08-02-sorted.xyz,
> > >>
> > >> band 1:
> > >> > IReadBlock failed at X offset 0, Y offset 4951
> > >> >
> > >> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset 4951
> > >> >
> > >> > See screenshot below, the data is arranged into three 'strips'. See
> > >>
> > >> dropbox
> > >>
> > >> > link to the data |
> > >> > https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
> > >> >
> > >> > Any workaround you can think of?
> > >>
> > >> Probably an issue with just sorting on column 2. I didn't have the
> same
> > >> error
> > >> as you, but anyway you should try :
> > >>
> > >> sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz
> > >>
> > >> with that I manage to translate the file.
> > >>
> > >> --
> > >> Geospatial professional services
> > >> http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140608/33040902/attachment-0001.html>

From even.rouault at mines-paris.org  Sun Jun  8 07:43:34 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 8 Jun 2014 16:43:34 +0200
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <CA+M-Ukg00KSvFgH=zzxuTPqrZhY1AtR4HZsiXx9OuZW8X_sqLw@mail.gmail.com>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201406072259.04888.even.rouault@mines-paris.org>
	<CA+M-Ukg00KSvFgH=zzxuTPqrZhY1AtR4HZsiXx9OuZW8X_sqLw@mail.gmail.com>
Message-ID: <201406081643.34601.even.rouault@mines-paris.org>

Le dimanche 08 juin 2014 15:04:31, Sam Franklin a ?crit :
> Even - okay thanks for taking a look, I'll check out the 2.0dev version as
> you mentioned.

Sam,

I meant that the 2.0dev has some improvements, but they are not sufficient to 
read that file.

Even

> Cheers
> S
> 
> On 7 June 2014 21:59, Even Rouault <even.rouault at mines-paris.org> wrote:
> > Le samedi 07 juin 2014 22:31:09, Sam Franklin a ?crit :
> > > Hey Even - me again on this xyz sorting issue.
> > > 
> > > I've got a new xyz file that it is not recognised by gdal even after
> > 
> > using
> > 
> > > the sort command you provided earlier in the thread.
> > > 
> > > The problem xyz is here |
> > > https://dl.dropboxusercontent.com/u/4086367/001-1.xyz.zip
> > > 
> > > The error is:
> > >  ERROR 1: Ungridded dataset: At line 363, X is 568509.090000, where as
> > > 
> > > 568514.090000 was expected (1)
> > > 
> > >  gdalinfo failed - unable to open '001-1.xyz'.
> > > 
> > > GDAL seems to fail at the start of a new row of data?
> > > 
> > > I've tried various descend/ascend combinations of the columns = no joy.
> > > 
> > > I'm running GDAL 1.11.0 on OSX 10.9.3.
> > > 
> > > Any ideas?  Thanks again in advance for any help! Very much
> > > appreciated.
> > 
> > The development version 2.0dev has improvements over 1.11 that would help
> > a bit, but this file would still require additional developments since
> > the spacing between horizontal or vertical coordinates isn't constant
> > due to rounding to 2 decimal figures. Some tolerance should be added to
> > the driver to
> > support it.
> > 
> > > Cheers
> > > Sam
> > > 
> > > 
> > > On 27 May 2014 14:09, Sam Franklin <mailinglist.samfranklin at gmail.com>
> > > 
> > > wrote:
> > > > Hi Even. Great, that worked for me too when sorting on both columns.
> > > > Really appreciate you help.
> > > > Sam
> > > > 
> > > > On 27 May 2014 01:31, Even Rouault <even.rouault at mines-paris.org>
> > 
> > wrote:
> > > >> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
> > > >> > Hey Even - great tip.  The sort command you suggested worked well
> > 
> > with
> > 
> > > >> that
> > > >> 
> > > >> > xyz dataset.
> > > >> > 
> > > >> > However, I've found a further dataset that does not work with gdal
> > > >> > even after the sort. This is the error:
> > > >> > 
> > > >> > mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
> > > >> > data08-02.tif
> > > >> > Input file size is 4371, 11210
> > > >> > 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
> > > >> 
> > > >> instead
> > > >> 
> > > >> > of 48164.000000 for nBlockYOff = 4951ERROR 1:
> > > >> > data08-02-sorted.xyz,
> > > >> 
> > > >> band 1:
> > > >> > IReadBlock failed at X offset 0, Y offset 4951
> > > >> > 
> > > >> > ERROR 1: GetBlockRef failed at X block offset 0, Y block offset
> > > >> > 4951
> > > >> > 
> > > >> > See screenshot below, the data is arranged into three 'strips'.
> > > >> > See
> > > >> 
> > > >> dropbox
> > > >> 
> > > >> > link to the data |
> > > >> > https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
> > > >> > 
> > > >> > Any workaround you can think of?
> > > >> 
> > > >> Probably an issue with just sorting on column 2. I didn't have the
> > 
> > same
> > 
> > > >> error
> > > >> as you, but anyway you should try :
> > > >> 
> > > >> sort -nk 2 -nk 1 data08-02.xyz > data08-02-sorted.xyz
> > > >> 
> > > >> with that I manage to translate the file.
> > > >> 
> > > >> --
> > > >> Geospatial professional services
> > > >> http://even.rouault.free.fr/services.html
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jluis at ualg.pt  Sun Jun  8 09:07:46 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Sun, 08 Jun 2014 17:07:46 +0100
Subject: [gdal-dev] Using GDAL with gridded XYZ that has no 'nodata'
	values?
In-Reply-To: <201406081643.34601.even.rouault@mines-paris.org>
References: <CA+M-UkgN6vPMuOTRJgA5Wmbe1dDgYjs9ya=a5pvZAtGEsLrn=Q@mail.gmail.com>
	<201406072259.04888.even.rouault@mines-paris.org>
	<CA+M-Ukg00KSvFgH=zzxuTPqrZhY1AtR4HZsiXx9OuZW8X_sqLw@mail.gmail.com>
	<201406081643.34601.even.rouault@mines-paris.org>
Message-ID: <53948A52.2000904@ualg.pt>

As Brent mentioned before, this is a easy task for GMT

# Find the grid limits
minmax 001-1.xyz -I5
-R568350/594035/6624700/6678645

#Convert to netCDF
xyz2grd -R568350/594035/6624700/6678645 -I5 -G001-1.grd 001-1.xyz


It was also mentioned that:

"The convention in the offshore sector is to deliver bathymetric data as 
single 'gridded' .XYZ ASCII file"

well, maybe so but I'm not so aware of it. What we use to use are grids 
directly or otherwise converted to x,y,z but stored in binary file, 
either for file size and to avoid truncations in decimal places (a 5 m 
grid spacing would need >= 6 decimal places when in geographics).

Joaquim

> Le dimanche 08 juin 2014 15:04:31, Sam Franklin a ?crit :
>> Even - okay thanks for taking a look, I'll check out the 2.0dev version as
>> you mentioned.
> Sam,
>
> I meant that the 2.0dev has some improvements, but they are not sufficient to
> read that file.
>
> Even
>
>> Cheers
>> S
>>
>> On 7 June 2014 21:59, Even Rouault<even.rouault at mines-paris.org>  wrote:
>>> Le samedi 07 juin 2014 22:31:09, Sam Franklin a ?crit :
>>>> Hey Even - me again on this xyz sorting issue.
>>>>
>>>> I've got a new xyz file that it is not recognised by gdal even after
>>> using
>>>
>>>> the sort command you provided earlier in the thread.
>>>>
>>>> The problem xyz is here |
>>>> https://dl.dropboxusercontent.com/u/4086367/001-1.xyz.zip
>>>>
>>>> The error is:
>>>>   ERROR 1: Ungridded dataset: At line 363, X is 568509.090000, where as
>>>>
>>>> 568514.090000 was expected (1)
>>>>
>>>>   gdalinfo failed - unable to open '001-1.xyz'.
>>>>
>>>> GDAL seems to fail at the start of a new row of data?
>>>>
>>>> I've tried various descend/ascend combinations of the columns = no joy.
>>>>
>>>> I'm running GDAL 1.11.0 on OSX 10.9.3.
>>>>
>>>> Any ideas?  Thanks again in advance for any help! Very much
>>>> appreciated.
>>> The development version 2.0dev has improvements over 1.11 that would help
>>> a bit, but this file would still require additional developments since
>>> the spacing between horizontal or vertical coordinates isn't constant
>>> due to rounding to 2 decimal figures. Some tolerance should be added to
>>> the driver to
>>> support it.
>>>
>>>> Cheers
>>>> Sam
>>>>
>>>>
>>>> On 27 May 2014 14:09, Sam Franklin<mailinglist.samfranklin at gmail.com>
>>>>
>>>> wrote:
>>>>> Hi Even. Great, that worked for me too when sorting on both columns.
>>>>> Really appreciate you help.
>>>>> Sam
>>>>>
>>>>> On 27 May 2014 01:31, Even Rouault<even.rouault at mines-paris.org>
>>> wrote:
>>>>>> Le mardi 27 mai 2014 00:06:33, Sam Franklin a ?crit :
>>>>>>> Hey Even - great tip.  The sort command you suggested worked well
>>> with
>>>
>>>>>> that
>>>>>>
>>>>>>> xyz dataset.
>>>>>>>
>>>>>>> However, I've found a further dataset that does not work with gdal
>>>>>>> even after the sort. This is the error:
>>>>>>>
>>>>>>> mbp-sf:data08 samfranklin$ gdal_translate data08-02-sorted.xyz
>>>>>>> data08-02.tif
>>>>>>> Input file size is 4371, 11210
>>>>>>> 0...10...20...30...40.ERROR 1: At line 1100207, found 48162.000000
>>>>>> instead
>>>>>>
>>>>>>> of 48164.000000 for nBlockYOff = 4951ERROR 1:
>>>>>>> data08-02-sorted.xyz,
>>>>>> band 1:
>>>>>>> IReadBlock failed at X offset 0, Y offset 4951
>>>>>>>
>>>>>>> ERROR 1: GetBlockRef failed at X block offset 0, Y block offset
>>>>>>> 4951
>>>>>>>
>>>>>>> See screenshot below, the data is arranged into three 'strips'.
>>>>>>> See
>>>>>> dropbox
>>>>>>
>>>>>>> link to the data |
>>>>>>> https://dl.dropboxusercontent.com/u/4086367/data08-02.xyz.zip
>>>>>>>
>>>>>>> Any workaround you can think of?
>>>>>> Probably an issue with just sorting on column 2. I didn't have the
>>> same
>>>
>>>>>> error
>>>>>> as you, but anyway you should try :
>>>>>>
>>>>>> sort -nk 2 -nk 1 data08-02.xyz>  data08-02-sorted.xyz
>>>>>>
>>>>>> with that I manage to translate the file.
>>>>>>
>>>>>> --
>>>>>> Geospatial professional services
>>>>>> http://even.rouault.free.fr/services.html
>>> --
>>> Geospatial professional services
>>> http://even.rouault.free.fr/services.html


From even.rouault at mines-paris.org  Sun Jun  8 10:03:22 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sun, 8 Jun 2014 19:03:22 +0200
Subject: [gdal-dev] Added hstore_get_value(hstore, key) SQL function
Message-ID: <201406081903.22648.even.rouault@mines-paris.org>

Hi,

I've just added the hstore_get_value() to both OGR SQL and SQLite dialects. 
This can be especially useful with the OSM driver to extract values associated 
to a key from the other_tags attribute that has a HSTORE formatting ( 
http://www.postgresql.org/docs/9.0/interactive/hstore.html )

From the doc:
"""
Starting with OGR 2.0, the hstore_get_value() function can be used to extract 
a value associate to a key from a HSTORE string, formatted like 
"key=>value,other_key=>other_value,..."
SELECT hstore_get_value('a => b, "key with space"=> "value with space"', 'key with space') --> 'value with space'
"""

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140608/38d5bd6a/attachment.html>

From jukka.rahkonen at mmmtike.fi  Mon Jun  9 00:31:05 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 9 Jun 2014 07:31:05 +0000 (UTC)
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
Message-ID: <loom.20140609T090530-723@post.gmane.org>

Hi,

I have a table with 1.2 million rows. Attribute 1 has 320 distinct values
(text). Attribute 2 is numeric (area).

My test query is this:

select * from table
where attr_1='009'
or area>1000;

First index makes query a bit faster
ogrinfo test.gpkg -sql "create index test_attr_1_idx on test (attr_1)"

However, after creating a second index the query takes almost 10 times
longer than without the second index
ogrinfo test.gpkg -sql "create index test_area_idx on test (area)"

I can confirm that the slow query time is caused by the indexes by making
the query as

select * from table not indexed
where attr_1='009'
or area>1000;

This time the query runs in the same time than before I started to make indexes.

Then I opened the GPKG database with Spatialite-gui 1.7.1. I dropped both
indexes and created again. This time my test query is very fast both when I
run it with Spatialite-gui or if I fire it from ogrinfo.

Perhaps this has something to do with different SQLite versions included in
GDAL and Spatialite-gui. My GDAL is v.2.0 Win-64 build from gisinternals. 

This kind of behaviour is nasty when planning to build well optimized and
indexed GeoPackage datafiles for the end users.

I have not analyzed if the trouble is in the index created for the area
field on in the way how these two indexed tables behave when they are used
in the same query with OR. However, I managed to create as slow indexes also
from java through the xerial jdbc driver "sqlite-jdbc-3.7.2.jar". 

-Jukka Rahkonen-




From even.rouault at mines-paris.org  Mon Jun  9 00:59:41 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 9 Jun 2014 09:59:41 +0200
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
In-Reply-To: <loom.20140609T090530-723@post.gmane.org>
References: <loom.20140609T090530-723@post.gmane.org>
Message-ID: <201406090959.41142.even.rouault@mines-paris.org>

Hi,

This should hopefully be pretty much independant of GDAL itself, but rather 
tied to the sqlite version used.

I can see that gisinternals builds use sqlite 3.7.9. In the news of version 
3.7.14 I read "And the query planner has been enhanced to better use covering 
indices on queries that use OR terms in the WHERE clause. "

So that might be it.

If you try with 32bit binaries, you could download 
https://www.sqlite.org/2014/sqlite-dll-win32-x86-3080500.zip and likely 
replace the existing bin/sqlite3.dll of gisinternals from the one of 3.8.5 to 
see if things are better.

But from your description, it would seem that what is important is the version 
used to generate the index, and not that much the one that runs the query. 
Which is rather intriguing...

Even

> Hi,
> 
> I have a table with 1.2 million rows. Attribute 1 has 320 distinct values
> (text). Attribute 2 is numeric (area).
> 
> My test query is this:
> 
> select * from table
> where attr_1='009'
> or area>1000;
> 
> First index makes query a bit faster
> ogrinfo test.gpkg -sql "create index test_attr_1_idx on test (attr_1)"
> 
> However, after creating a second index the query takes almost 10 times
> longer than without the second index
> ogrinfo test.gpkg -sql "create index test_area_idx on test (area)"
> 
> I can confirm that the slow query time is caused by the indexes by making
> the query as
> 
> select * from table not indexed
> where attr_1='009'
> or area>1000;
> 
> This time the query runs in the same time than before I started to make
> indexes.
> 
> Then I opened the GPKG database with Spatialite-gui 1.7.1. I dropped both
> indexes and created again. This time my test query is very fast both when I
> run it with Spatialite-gui or if I fire it from ogrinfo.
> 
> Perhaps this has something to do with different SQLite versions included in
> GDAL and Spatialite-gui. My GDAL is v.2.0 Win-64 build from gisinternals.
> 
> This kind of behaviour is nasty when planning to build well optimized and
> indexed GeoPackage datafiles for the end users.
> 
> I have not analyzed if the trouble is in the index created for the area
> field on in the way how these two indexed tables behave when they are used
> in the same query with OR. However, I managed to create as slow indexes
> also from java through the xerial jdbc driver "sqlite-jdbc-3.7.2.jar".
> 
> -Jukka Rahkonen-
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From a.furieri at lqt.it  Mon Jun  9 01:31:35 2014
From: a.furieri at lqt.it (a.furieri at lqt.it)
Date: Mon, 09 Jun 2014 10:31:35 +0200
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
In-Reply-To: <loom.20140609T090530-723@post.gmane.org>
References: <loom.20140609T090530-723@post.gmane.org>
Message-ID: <8f1ffba062e83ad48789f4251af788fa@lqt.it>

On Mon, 9 Jun 2014 07:31:05 +0000 (UTC), Jukka Rahkonen wrote:
> Perhaps this has something to do with different SQLite versions 
> included in
> GDAL and Spatialite-gui. My GDAL is v.2.0 Win-64 build from 
> gisinternals.
>
> This kind of behaviour is nasty when planning to build well optimized 
> and
> indexed GeoPackage datafiles for the end users.
>

Hi Jukka,

there was a major change affecting all recent versions of SQLite
starting since 3.8.0 (2013-08-26) [1]

a brand new NGQP (New Generation Query Planner) was introduced:
in the vast majority of cases NGQP will effectively imply
choosing a more efficient query strategy.
but unhappily there are few exceptions (worst cases) where
NGQP could possibly follow a very inefficient query strategy;
please read sections 4.0, 4.1 and 4.2 of the aforementioned
sqlite's document for more details.

[1] http://www.sqlite.org/queryplanner-ng.html

bye Sandro

From jukka.rahkonen at mmmtike.fi  Mon Jun  9 01:53:42 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 9 Jun 2014 08:53:42 +0000 (UTC)
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
References: <loom.20140609T090530-723@post.gmane.org>
	<8f1ffba062e83ad48789f4251af788fa@lqt.it>
Message-ID: <loom.20140609T104832-720@post.gmane.org>

 <a.furieri <at> lqt.it> writes:

> 
> On Mon, 9 Jun 2014 07:31:05 +0000 (UTC), Jukka Rahkonen wrote:
> > Perhaps this has something to do with different SQLite versions 
> > included in
> > GDAL and Spatialite-gui. My GDAL is v.2.0 Win-64 build from 
> > gisinternals.
> >
> > This kind of behaviour is nasty when planning to build well optimized 
> > and
> > indexed GeoPackage datafiles for the end users.
> >
> 
> Hi Jukka,
> 
> there was a major change affecting all recent versions of SQLite
> starting since 3.8.0 (2013-08-26) [1]
> 
> a brand new NGQP (New Generation Query Planner) was introduced:
> in the vast majority of cases NGQP will effectively imply
> choosing a more efficient query strategy.
> but unhappily there are few exceptions (worst cases) where
> NGQP could possibly follow a very inefficient query strategy;
> please read sections 4.0, 4.1 and 4.2 of the aforementioned
> sqlite's document for more details.
> 
> [1] http://www.sqlite.org/queryplanner-ng.html

Thanks for the link. I wonder what is best thing to do if the aim is to
create fast and interoperable indexed SQLite/Spatialite/GPKG database
deliverables. Is it perhaps to create indexes with SQLite >=3.8.0 and always
run ANALYZE before sending the databases for the users and tell them to use,
if possible, software that is also using SQLite >=3.8.0 for reading the
databases? 

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Mon Jun  9 02:04:05 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 9 Jun 2014 11:04:05 +0200
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
In-Reply-To: <201406090959.41142.even.rouault@mines-paris.org>
References: <loom.20140609T090530-723@post.gmane.org>
	<201406090959.41142.even.rouault@mines-paris.org>
Message-ID: <201406091104.05764.even.rouault@mines-paris.org>

Jukka,

I tried to simulate your scenario but couldn't observe any performance 
difference (on Linux, but I doubt that the OS would make a difference) when 
generating a test DB with 3.7.9 or 3.7.14, and using it with the other 
version.
However it might heavily depend on the number of records that match 
attr_1='009' and area>1000

Could you share your DB ?

Even

> Hi,
> 
> This should hopefully be pretty much independant of GDAL itself, but rather
> tied to the sqlite version used.
> 
> I can see that gisinternals builds use sqlite 3.7.9. In the news of version
> 3.7.14 I read "And the query planner has been enhanced to better use
> covering indices on queries that use OR terms in the WHERE clause. "
> 
> So that might be it.
> 
> If you try with 32bit binaries, you could download
> https://www.sqlite.org/2014/sqlite-dll-win32-x86-3080500.zip and likely
> replace the existing bin/sqlite3.dll of gisinternals from the one of 3.8.5
> to see if things are better.
> 
> But from your description, it would seem that what is important is the
> version used to generate the index, and not that much the one that runs
> the query. Which is rather intriguing...
> 
> Even
> 
> > Hi,
> > 
> > I have a table with 1.2 million rows. Attribute 1 has 320 distinct values
> > (text). Attribute 2 is numeric (area).
> > 
> > My test query is this:
> > 
> > select * from table
> > where attr_1='009'
> > or area>1000;
> > 
> > First index makes query a bit faster
> > ogrinfo test.gpkg -sql "create index test_attr_1_idx on test (attr_1)"
> > 
> > However, after creating a second index the query takes almost 10 times
> > longer than without the second index
> > ogrinfo test.gpkg -sql "create index test_area_idx on test (area)"
> > 
> > I can confirm that the slow query time is caused by the indexes by making
> > the query as
> > 
> > select * from table not indexed
> > where attr_1='009'
> > or area>1000;
> > 
> > This time the query runs in the same time than before I started to make
> > indexes.
> > 
> > Then I opened the GPKG database with Spatialite-gui 1.7.1. I dropped both
> > indexes and created again. This time my test query is very fast both when
> > I run it with Spatialite-gui or if I fire it from ogrinfo.
> > 
> > Perhaps this has something to do with different SQLite versions included
> > in GDAL and Spatialite-gui. My GDAL is v.2.0 Win-64 build from
> > gisinternals.
> > 
> > This kind of behaviour is nasty when planning to build well optimized and
> > indexed GeoPackage datafiles for the end users.
> > 
> > I have not analyzed if the trouble is in the index created for the area
> > field on in the way how these two indexed tables behave when they are
> > used in the same query with OR. However, I managed to create as slow
> > indexes also from java through the xerial jdbc driver
> > "sqlite-jdbc-3.7.2.jar".
> > 
> > -Jukka Rahkonen-
> > 
> > 
> > 
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From boxerab at gmail.com  Mon Jun  9 11:14:37 2014
From: boxerab at gmail.com (Aaron Boxer)
Date: Mon, 9 Jun 2014 14:14:37 -0400
Subject: [gdal-dev] opencl j2k library
Message-ID: <CAK8GPyDVMv_OyTfHyGwXqDzHqQu2pDVJRNh195d9myRr-9+XJQ@mail.gmail.com>

Friends,

 I am now able to decode a lossless RGB image.

https://github.com/OpenCodec/ThousandthChicken


Current limitations:

- single layer
- lossless
- RLCP progression only

The license for this library is a bit of a mess, as I am pulling in source
from three other projects.

Please feel free to fork it if you're interested in contributing.

Cheers,
Aaron
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140609/0324b78c/attachment.html>

From lucena_ivan at hotmail.com  Mon Jun  9 13:58:12 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Mon, 9 Jun 2014 16:58:12 -0400
Subject: [gdal-dev] VRTDataset in Java
Message-ID: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>

Hi there,

What is the best option to create in memory VRT Dataset with the GDAL Java API?

I would like to do thing like gdal_translate does [0], band selection and window cropping for example. 

It seems like the VRTDataset class is not wrapped in Java, so I would need to write the XML myself or use a regular GDAL Dataset clas, ex.:

Dataset ds = dal.getDriverByName("VRT").Create("/vsimem/xxx.vrt", 255, 255);

But there are some methods in VRTDataset that GDALDataset doesn't have, so I think I am going with the raw XML option.

Any better idea?

Best regards,

Ivan

ref. :

[0] http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L1095

 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140609/3768e906/attachment.html>

From jukka.rahkonen at mmmtike.fi  Tue Jun 10 04:04:18 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 10 Jun 2014 11:04:18 +0000 (UTC)
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
Message-ID: <loom.20140610T125854-268@post.gmane.org>

Hi,

I would like to know what happens if I convert an original RGBA tiff image
into jpeg as 

gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg

I know that for getting a good result I can add "-b 1 -b 2 -b 3" but I am
curious to know what happens and how GDAL computes sort of a transparent
sepia coloured mask when run without selecting bands.

-Jukka Rahkonen-


From even.rouault at mines-paris.org  Tue Jun 10 04:46:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 13:46:46 +0200
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
In-Reply-To: <loom.20140610T125854-268@post.gmane.org>
References: <loom.20140610T125854-268@post.gmane.org>
Message-ID: <1402400806.5396f026e8bee@imp.free.fr>

Selon Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>:

> Hi,
>
> I would like to know what happens if I convert an original RGBA tiff image
> into jpeg as
>
> gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg
>
> I know that for getting a good result I can add "-b 1 -b 2 -b 3" but I am
> curious to know what happens and how GDAL computes sort of a transparent
> sepia coloured mask when run without selecting bands.

It will result in a TIFF with separate bands (PLANARCONFIG_SEPARATE :
http://www.awaresystems.be/imaging/tiff/tifftags/planarconfiguration.html), each
of them JPEG compressed. So for a transparency mask with "instantenous" changes
between zones of fully transparence and fully opacity, you'll have JPEG
artifacts.
I'm wondering if the "sepia coloured mask" is not caused by a viewer that will
be confused by this TIFF configuration and would assume a CMYK color space
instead of RGB.

>
> -Jukka Rahkonen-
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From jukka.rahkonen at mmmtike.fi  Tue Jun 10 04:58:59 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 10 Jun 2014 11:58:59 +0000 (UTC)
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
References: <loom.20140610T125854-268@post.gmane.org>
	<1402400806.5396f026e8bee@imp.free.fr>
Message-ID: <loom.20140610T135010-864@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Selon Jukka Rahkonen <jukka.rahkonen <at> mmmtike.fi>:
> 
> > Hi,
> >
> > I would like to know what happens if I convert an original RGBA tiff image
> > into jpeg as
> >
> > gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg
> >
> > I know that for getting a good result I can add "-b 1 -b 2 -b 3" but I am
> > curious to know what happens and how GDAL computes sort of a transparent
> > sepia coloured mask when run without selecting bands.
> 
> It will result in a TIFF with separate bands (PLANARCONFIG_SEPARATE :
>
http://www.awaresystems.be/imaging/tiff/tifftags/planarconfiguration.html), each
> of them JPEG compressed. So for a transparency mask with "instantenous"
changes
> between zones of fully transparence and fully opacity, you'll have JPEG
> artifacts.
> I'm wondering if the "sepia coloured mask" is not caused by a viewer that will
> be confused by this TIFF configuration and would assume a CMYK color space
> instead of RGB.

Hi Even,

Sorry, I must have been unclear. The question was about writing out a real
JPEG file, not JPEG compressed TIFF
The original is of this type:
Band 1 Block=5000x1 Type=Byte, ColorInterp=Red
Band 2 Block=5000x1 Type=Byte, ColorInterp=Green
Band 3 Block=5000x1 Type=Byte, ColorInterp=Blue
Band 4 Block=5000x1 Type=Byte, ColorInterp=Undefined

The command gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg creates a jpeg
file with this gdalinfo

C:\Jukka>gdalinfo jpeg_out.jpg
Driver: JPEG/JPEG JFIF
Files: jpeg_out.jpg
       jpeg_out.jpg.aux.xml
Size is 5000, 5000
Coordinate System is:
PROJCS["NAD83 / Indiana West (ftUS)",
    GEOGCS["NAD83",
        DATUM["North_American_Datum_1983",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6269"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4269"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",37.5],
    PARAMETER["central_meridian",-87.08333333333333],
    PARAMETER["scale_factor",0.999966667],
    PARAMETER["false_easting",2952750],
    PARAMETER["false_northing",820208.333],
    UNIT["US survey foot",0.3048006096012192,
        AUTHORITY["EPSG","9003"]],
    AUTHORITY["EPSG","2966"]]
Origin = (2947500.000000000000000,2265000.000000000000000)
Pixel Size = (0.500000000000000,-0.500000000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_RESOLUTIONUNIT=2 (pixels/inch)
  TIFFTAG_XRESOLUTION=1
  TIFFTAG_YRESOLUTION=1
Image Structure Metadata:
  COMPRESSION=JPEG
  INTERLEAVE=PIXEL
  SOURCE_COLOR_SPACE=CMYK
Corner Coordinates:
Upper Left  ( 2947500.000, 2265000.000) ( 87d 6' 8.96"W, 41d27'59.66"N)
Lower Left  ( 2947500.000, 2262500.000) ( 87d 6' 8.95"W, 41d27'34.96"N)
Upper Right ( 2950000.000, 2265000.000) ( 87d 5'36.12"W, 41d27'59.66"N)
Lower Right ( 2950000.000, 2262500.000) ( 87d 5'36.12"W, 41d27'34.96"N)
Center      ( 2948750.000, 2263750.000) ( 87d 5'52.54"W, 41d27'47.31"N)
Band 1 Block=5000x1 Type=Byte, ColorInterp=Red
  Overviews: 2500x2500, 1250x1250, 625x625
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 2 Block=5000x1 Type=Byte, ColorInterp=Green
  Overviews: 2500x2500, 1250x1250, 625x625
  Image Structure Metadata:
    COMPRESSION=JPEG
Band 3 Block=5000x1 Type=Byte, ColorInterp=Blue
  Overviews: 2500x2500, 1250x1250, 625x625
  Image Structure Metadata:
    COMPRESSION=JPEG

The mask I told can be seen in this stackexchange question on the left side
of the image. I do not believe that a viewer plays any role here.

http://gis.stackexchange.com/questions/101393/gdal-tif-to-jpg-creates-dark-image

-Jukka-


From even.rouault at mines-paris.org  Tue Jun 10 05:31:44 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 14:31:44 +0200
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
In-Reply-To: <loom.20140610T135010-864@post.gmane.org>
References: <loom.20140610T125854-268@post.gmane.org>
	<1402400806.5396f026e8bee@imp.free.fr>
	<loom.20140610T135010-864@post.gmane.org>
Message-ID: <1402403504.5396fab06c1c4@imp.free.fr>

Selon Jukka Rahkonen <jukka.rahkonen at mmmtike.fi>:

> Even Rouault <even.rouault <at> mines-paris.org> writes:
>
> >
> > Selon Jukka Rahkonen <jukka.rahkonen <at> mmmtike.fi>:
> >
> > > Hi,
> > >
> > > I would like to know what happens if I convert an original RGBA tiff
> image
> > > into jpeg as
> > >
> > > gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg
> > >
> > > I know that for getting a good result I can add "-b 1 -b 2 -b 3" but I am
> > > curious to know what happens and how GDAL computes sort of a transparent
> > > sepia coloured mask when run without selecting bands.
> >
> > It will result in a TIFF with separate bands (PLANARCONFIG_SEPARATE :
> >
> http://www.awaresystems.be/imaging/tiff/tifftags/planarconfiguration.html),
> each
> > of them JPEG compressed. So for a transparency mask with "instantenous"
> changes
> > between zones of fully transparence and fully opacity, you'll have JPEG
> > artifacts.
> > I'm wondering if the "sepia coloured mask" is not caused by a viewer that
> will
> > be confused by this TIFF configuration and would assume a CMYK color space
> > instead of RGB.
>
> Hi Even,
>
> Sorry, I must have been unclear. The question was about writing out a real
> JPEG file, not JPEG compressed TIFF

Ah my fault. I read too fast.

> The command gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg creates a jpeg
> file with this gdalinfo
>
> C:\Jukka>gdalinfo jpeg_out.jpg
[...]
>   SOURCE_COLOR_SPACE=CMYK

My guess was right actually. In JPEG there's no way, AFAIK, to define RGBA. 4
bands JPEG are assumed to be in CMYK color space.



From etiennebr at gmail.com  Tue Jun 10 05:38:03 2014
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 10 Jun 2014 08:38:03 -0400
Subject: [gdal-dev] Control overview block size
Message-ID: <CALjAYt5TuYC8Ph426_mur4f02Zd01W-j1NCKE4b1f_F8z+U7aQ@mail.gmail.com>

Hi List,

Is there a way to control the block size of overviews and inspect that
block size from gdalinfo ?
I have a raster with 256x256 block size.
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue

I'm trying to feed the images to a program that seemingly supports Tiffs
with internal overview of the same block size than the image.

I've tried >gdaladdo --config BLOCKXSIZE 256 --config BLOCKYSIZE 256
image.tif 2 4 8 16 32
gdalinfo:
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
  Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354

But I couldn't find a way to inspect the overview block size to confirm
they are 256x256 since I get the same results if I set BLOCKSIZE to 128. I
suspect these options are ignored in gdaladdo.

Any way I can 1) control the overview block size and 2) inspect the block
size ?

Thanks for your help,
Etienne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140610/82838d66/attachment.html>

From even.rouault at mines-paris.org  Tue Jun 10 05:48:20 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 14:48:20 +0200
Subject: [gdal-dev] Control overview block size
In-Reply-To: <CALjAYt5TuYC8Ph426_mur4f02Zd01W-j1NCKE4b1f_F8z+U7aQ@mail.gmail.com>
References: <CALjAYt5TuYC8Ph426_mur4f02Zd01W-j1NCKE4b1f_F8z+U7aQ@mail.gmail.com>
Message-ID: <1402404500.5396fe9452d29@imp.free.fr>

Selon "Etienne B. Racine" <etiennebr at gmail.com>:

> Hi List,
>
> Is there a way to control the block size of overviews and inspect that
> block size from gdalinfo ?
> I have a raster with 256x256 block size.
> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>
> I'm trying to feed the images to a program that seemingly supports Tiffs
> with internal overview of the same block size than the image.
>
> I've tried >gdaladdo --config BLOCKXSIZE 256 --config BLOCKYSIZE 256
> image.tif 2 4 8 16 32
> gdalinfo:
> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
>
> But I couldn't find a way to inspect the overview block size to confirm
> they are 256x256 since I get the same results if I set BLOCKSIZE to 128. I
> suspect these options are ignored in gdaladdo.

The right name is GDAL_TIFF_OVR_BLOCKSIZE. See http://gdal.org/frmt_gtiff.html

>
> Any way I can 1) control the overview block size and 2) inspect the block
> size ?

Not directly with gdalinfo.
With Python :

from osgeo import gdal
ds = gdal.Open('your.tif')
print(ds.GetRasterBand(1).GetOverview(0).GetBlockSize())



>
> Thanks for your help,
> Etienne
>



From jukka.rahkonen at mmmtike.fi  Tue Jun 10 06:03:24 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 10 Jun 2014 13:03:24 +0000 (UTC)
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
References: <loom.20140610T125854-268@post.gmane.org>
	<1402400806.5396f026e8bee@imp.free.fr>
	<loom.20140610T135010-864@post.gmane.org>
	<1402403504.5396fab06c1c4@imp.free.fr>
Message-ID: <loom.20140610T143714-326@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> > Hi Even,
> >
> > Sorry, I must have been unclear. The question was about writing out a real
> > JPEG file, not JPEG compressed TIFF
> 
> Ah my fault. I read too fast.
> 
> > The command gdal_translate -of jpeg rgba_in.tif jpeg_out.jpg creates a jpeg
> > file with this gdalinfo
> >
> > C:\Jukka>gdalinfo jpeg_out.jpg
> [...]
> >   SOURCE_COLOR_SPACE=CMYK
> 
> My guess was right actually. In JPEG there's no way, AFAIK, to define RGBA. 4
> bands JPEG are assumed to be in CMYK color space.
> 

Thanks, that makes sense. However, the result is somehow surprising and I
guess that in most cases unusable for the user. I wonder if it would be good
to print something like "WARNING. Encountered 4 source bands, assuming CMYC
color space". Behaviour is not very easy to understand by reading the driver
page http://www.gdal.org/frmt_jpeg.html

When I try to look at the situation as a QGIS user sees it, it feels like
there is a bug somewhere but I can't say exactly where. However, I do not
believe that any average QGIS user can have success with converting their
RGBA tiffs into jpeg format even it is possible by editing gdal_translate
command manually.

-Jukka-




From lucena_ivan at hotmail.com  Tue Jun 10 06:04:20 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 10 Jun 2014 09:04:20 -0400
Subject: [gdal-dev] VRTDataset in Java
In-Reply-To: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>
References: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>
Message-ID: <BLU173-W15220551E0418810F9924890280@phx.gbl>



Do we have plans to add those entries to the GDAL API (C, Java, etc.)?

---------- \...\GDAL\TRUNK\FRMTS\VRT\GDAL_VRT.H
VRTDatasetH CPL_DLL CPL_STDCALL VRTCreate( int, int );
CPLXMLNode CPL_DLL * CPL_STDCALL VRTSerializeToXML( VRTDatasetH, const char * );
CPLErr CPL_STDCALL VRTAddSource( VRTSourcedRasterBandH, VRTSourceH );
CPLErr CPL_DLL CPL_STDCALL VRTAddSimpleSource( VRTSourcedRasterBandH,
CPLErr CPL_DLL CPL_STDCALL VRTAddComplexSource( VRTSourcedRasterBandH,

From: lucena_ivan at hotmail.com
To: gdal-dev at lists.osgeo.org
Date: Mon, 9 Jun 2014 16:58:12 -0400
Subject: [gdal-dev] VRTDataset in Java




Hi there,

What is the best option to create in memory VRT Dataset with the GDAL Java API?

I would like to do thing like gdal_translate does [0], band selection and window cropping for example. 

It seems like the VRTDataset class is not wrapped in Java, so I would need to write the XML myself or use a regular GDAL Dataset clas, ex.:

Dataset ds = dal.getDriverByName("VRT").Create("/vsimem/xxx.vrt", 255, 255);

But there are some methods in VRTDataset that GDALDataset doesn't have, so I think I am going with the raw XML option.

Any better idea?

Best regards,

Ivan

ref. :

[0] http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L1095

 		 	   		  

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
http://lists.osgeo.org/mailman/listinfo/gdal-dev
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140610/835665c8/attachment-0001.html>

From even.rouault at mines-paris.org  Tue Jun 10 06:28:50 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 15:28:50 +0200
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
In-Reply-To: <loom.20140610T143714-326@post.gmane.org>
References: <loom.20140610T125854-268@post.gmane.org>
	<1402400806.5396f026e8bee@imp.free.fr>
	<loom.20140610T135010-864@post.gmane.org>
	<1402403504.5396fab06c1c4@imp.free.fr>
	<loom.20140610T143714-326@post.gmane.org>
Message-ID: <1402406930.539708127d799@imp.free.fr>


> Thanks, that makes sense. However, the result is somehow surprising and I
> guess that in most cases unusable for the user. I wonder if it would be good
> to print something like "WARNING. Encountered 4 source bands, assuming CMYC
> color space". Behaviour is not very easy to understand by reading the driver
> page http://www.gdal.org/frmt_jpeg.html
>
> When I try to look at the situation as a QGIS user sees it, it feels like
> there is a bug somewhere but I can't say exactly where. However, I do not
> believe that any average QGIS user can have success with converting their
> RGBA tiffs into jpeg format even it is possible by editing gdal_translate
> command manually.

Agreed that the current behaviour is confusing. A check could be done on the
color interpretation of the source bands to check if it is C,M,Y,K when a 4 band
dataset is provided. If not, then output the warning (and possibly error out if
-strict is specified)

From even.rouault at mines-paris.org  Tue Jun 10 08:43:50 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 17:43:50 +0200
Subject: [gdal-dev] VRTDataset in Java
In-Reply-To: <BLU173-W15220551E0418810F9924890280@phx.gbl>
References: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>
	<BLU173-W15220551E0418810F9924890280@phx.gbl>
Message-ID: <1402415030.539727b61bf16@imp.free.fr>

Ivan,

gdal_vrt.h is an already installed header file and the symbols are exported
(CPL_DLL), so this is a public C API (although a bit confidential probably)
As far as SWIG bindings is concerned, some work would be needed. New shadow
types should be introduced to model VRTDataset and VRTSourcedRasterBand (and
some care too since all bands returned by a VRTDataset are not necessarily
VRTSourcedRasterBand ). As far as VRTAddSource(), there's no C API to bind the
corresponding C++ VRTSource classes, but probably that the helpers
VRTAddSimpleSource() and VRTAddComplexSource() are sufficient.

Even

>
>
> Do we have plans to add those entries to the GDAL API (C, Java, etc.)?
>
> ---------- \...\GDAL\TRUNK\FRMTS\VRT\GDAL_VRT.H
> VRTDatasetH CPL_DLL CPL_STDCALL VRTCreate( int, int );
> CPLXMLNode CPL_DLL * CPL_STDCALL VRTSerializeToXML( VRTDatasetH, const char *
> );
> CPLErr CPL_STDCALL VRTAddSource( VRTSourcedRasterBandH, VRTSourceH );
> CPLErr CPL_DLL CPL_STDCALL VRTAddSimpleSource( VRTSourcedRasterBandH,
> CPLErr CPL_DLL CPL_STDCALL VRTAddComplexSource( VRTSourcedRasterBandH,
>
> From: lucena_ivan at hotmail.com
> To: gdal-dev at lists.osgeo.org
> Date: Mon, 9 Jun 2014 16:58:12 -0400
> Subject: [gdal-dev] VRTDataset in Java
>
>
>
>
> Hi there,
>
> What is the best option to create in memory VRT Dataset with the GDAL Java
> API?
>
> I would like to do thing like gdal_translate does [0], band selection and
> window cropping for example.
>
> It seems like the VRTDataset class is not wrapped in Java, so I would need to
> write the XML myself or use a regular GDAL Dataset clas, ex.:
>
> Dataset ds = dal.getDriverByName("VRT").Create("/vsimem/xxx.vrt", 255, 255);
>
> But there are some methods in VRTDataset that GDALDataset doesn't have, so I
> think I am going with the raw XML option.
>
> Any better idea?
>
> Best regards,
>
> Ivan
>
> ref. :
>
> [0]
> http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L1095
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From eadam at co.lincoln.or.us  Tue Jun 10 08:40:01 2014
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Tue, 10 Jun 2014 08:40:01 -0700
Subject: [gdal-dev] What happens by default when writing RGBA into jpeg?
In-Reply-To: <1402406930.539708127d799@imp.free.fr>
References: <loom.20140610T125854-268@post.gmane.org>
	<1402400806.5396f026e8bee@imp.free.fr>
	<loom.20140610T135010-864@post.gmane.org>
	<1402403504.5396fab06c1c4@imp.free.fr>
	<loom.20140610T143714-326@post.gmane.org>
	<1402406930.539708127d799@imp.free.fr>
Message-ID: <CACqBkM-9dxz8tDGSwwnYFB-r=QBNASUV2a_txcvujdcqbuMsTQ@mail.gmail.com>

On Tue, Jun 10, 2014 at 6:28 AM, Even Rouault
<even.rouault at mines-paris.org> wrote:
>
>> Thanks, that makes sense. However, the result is somehow surprising and I
>> guess that in most cases unusable for the user. I wonder if it would be good
>> to print something like "WARNING. Encountered 4 source bands, assuming CMYC
>> color space". Behaviour is not very easy to understand by reading the driver
>> page http://www.gdal.org/frmt_jpeg.html
>>
>> When I try to look at the situation as a QGIS user sees it, it feels like
>> there is a bug somewhere but I can't say exactly where. However, I do not
>> believe that any average QGIS user can have success with converting their
>> RGBA tiffs into jpeg format even it is possible by editing gdal_translate
>> command manually.
>
> Agreed that the current behaviour is confusing. A check could be done on the
> color interpretation of the source bands to check if it is C,M,Y,K when a 4 band
> dataset is provided. If not, then output the warning (and possibly error out if
> -strict is specified)

Some GDAL warning also give helpful hints.  Could this warning suggest
something like, RGBA files can be converted to JPEG by adding "-b 1 -b
2 -b 3"?

Eli

> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

From Faltus at SpaceComputer.Com  Tue Jun 10 08:43:59 2014
From: Faltus at SpaceComputer.Com (Silas Faltus)
Date: Tue, 10 Jun 2014 08:43:59 -0700 (PDT)
Subject: [gdal-dev] Question regarding OGRPolygon intersection
In-Reply-To: <148367043.836039.1402414987444.JavaMail.zimbra@spacecomputer.com>
Message-ID: <1412789876.836045.1402415039310.JavaMail.zimbra@spacecomputer.com>

Hi,

I was hoping to use GDAL for testing when two convex polygons intersect. I was able to do this with something similar to:

polyOne->Intersects(polyTwo);

Both polyOne and polyTwo are OGRPolygon and are defined in geographic coordinates, i.e. latitude and longitude (decimal degrees). I've also set the spatial reference of the polygons to 'SetWellKnownGeogCS("WGS84")'. Also, I've built GDAL with GEOS.

My question is this, what coordinate system is the intersection calculated in?   Looking through the code, it appears that GDAL uses GEOS for the intersection test, and GEOS seems to rely on JTS for the intersection test. However, JTS describes itself as providing '... algorithms for processing linear geometry on the 2-dimensional cartesion plane'.

So, as an example, if my polygons each contain three vertices, are they treated as spherical triangles in a geographic coordinate system (with curved edges) when the intersection test is performed? Or, are then treated as flat triangles with straight edges in some Cartesian / 2D coordinate system.

I appreciate any help answering this question,

Silas

From even.rouault at mines-paris.org  Tue Jun 10 09:17:32 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 10 Jun 2014 18:17:32 +0200
Subject: [gdal-dev] Question regarding OGRPolygon intersection
In-Reply-To: <1412789876.836045.1402415039310.JavaMail.zimbra@spacecomputer.com>
References: <1412789876.836045.1402415039310.JavaMail.zimbra@spacecomputer.com>
Message-ID: <1402417052.53972f9caed3f@imp.free.fr>

Silas,

More exactly, GEOS is a port in C++ of JTS. It does exactly what JTS does for
this, so it considers the coordinates as being located on a 2D cartesian plane.
No spherical/ellipsoidal geometry is involved.

Even

> Hi,
>
> I was hoping to use GDAL for testing when two convex polygons intersect. I
> was able to do this with something similar to:
>
> polyOne->Intersects(polyTwo);
>
> Both polyOne and polyTwo are OGRPolygon and are defined in geographic
> coordinates, i.e. latitude and longitude (decimal degrees). I've also set the
> spatial reference of the polygons to 'SetWellKnownGeogCS("WGS84")'. Also,
> I've built GDAL with GEOS.
>
> My question is this, what coordinate system is the intersection calculated
> in?   Looking through the code, it appears that GDAL uses GEOS for the
> intersection test, and GEOS seems to rely on JTS for the intersection test.
> However, JTS describes itself as providing '... algorithms for processing
> linear geometry on the 2-dimensional cartesion plane'.
>
> So, as an example, if my polygons each contain three vertices, are they
> treated as spherical triangles in a geographic coordinate system (with curved
> edges) when the intersection test is performed? Or, are then treated as flat
> triangles with straight edges in some Cartesian / 2D coordinate system.
>
> I appreciate any help answering this question,
>
> Silas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



From Faltus at SpaceComputer.Com  Tue Jun 10 09:30:43 2014
From: Faltus at SpaceComputer.Com (Silas Faltus)
Date: Tue, 10 Jun 2014 09:30:43 -0700 (PDT)
Subject: [gdal-dev] Question regarding OGRPolygon intersection
In-Reply-To: <1402417052.53972f9caed3f@imp.free.fr>
References: <1412789876.836045.1402415039310.JavaMail.zimbra@spacecomputer.com>
	<1402417052.53972f9caed3f@imp.free.fr>
Message-ID: <275239292.836436.1402417843843.JavaMail.zimbra@spacecomputer.com>

Thanks Even!

Silas

----- Original Message -----
From: "Even Rouault" <even.rouault at mines-paris.org>
To: "Silas Faltus" <Faltus at SpaceComputer.Com>
Cc: gdal-dev at lists.osgeo.org
Sent: Tuesday, June 10, 2014 11:17:32 AM
Subject: Re: [gdal-dev] Question regarding OGRPolygon intersection

Silas,

More exactly, GEOS is a port in C++ of JTS. It does exactly what JTS does for
this, so it considers the coordinates as being located on a 2D cartesian plane.
No spherical/ellipsoidal geometry is involved.

Even

> Hi,
>
> I was hoping to use GDAL for testing when two convex polygons intersect. I
> was able to do this with something similar to:
>
> polyOne->Intersects(polyTwo);
>
> Both polyOne and polyTwo are OGRPolygon and are defined in geographic
> coordinates, i.e. latitude and longitude (decimal degrees). I've also set the
> spatial reference of the polygons to 'SetWellKnownGeogCS("WGS84")'. Also,
> I've built GDAL with GEOS.
>
> My question is this, what coordinate system is the intersection calculated
> in?   Looking through the code, it appears that GDAL uses GEOS for the
> intersection test, and GEOS seems to rely on JTS for the intersection test.
> However, JTS describes itself as providing '... algorithms for processing
> linear geometry on the 2-dimensional cartesion plane'.
>
> So, as an example, if my polygons each contain three vertices, are they
> treated as spherical triangles in a geographic coordinate system (with curved
> edges) when the intersection test is performed? Or, are then treated as flat
> triangles with straight edges in some Cartesian / 2D coordinate system.
>
> I appreciate any help answering this question,
>
> Silas
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From etiennebr at gmail.com  Tue Jun 10 10:28:18 2014
From: etiennebr at gmail.com (Etienne B. Racine)
Date: Tue, 10 Jun 2014 13:28:18 -0400
Subject: [gdal-dev] Control overview block size
In-Reply-To: <1402404500.5396fe9452d29@imp.free.fr>
References: <CALjAYt5TuYC8Ph426_mur4f02Zd01W-j1NCKE4b1f_F8z+U7aQ@mail.gmail.com>
	<1402404500.5396fe9452d29@imp.free.fr>
Message-ID: <CALjAYt5TYJ0ejw1fCRnWnX5vyc9mnEWN4am2g_-jDCXisGC4ug@mail.gmail.com>

Indeed, thanks a lot Even. The OVR in GDAL_TIFF_OVR_BLOCKSIZE made me
believe it was only for external .ovr overviews.

Etienne


2014-06-10 8:48 GMT-04:00 Even Rouault <even.rouault at mines-paris.org>:

> Selon "Etienne B. Racine" <etiennebr at gmail.com>:
>
> > Hi List,
> >
> > Is there a way to control the block size of overviews and inspect that
> > block size from gdalinfo ?
> > I have a raster with 256x256 block size.
> > Band 1 Block=256x256 Type=Byte, ColorInterp=Red
> > Band 2 Block=256x256 Type=Byte, ColorInterp=Green
> > Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
> >
> > I'm trying to feed the images to a program that seemingly supports Tiffs
> > with internal overview of the same block size than the image.
> >
> > I've tried >gdaladdo --config BLOCKXSIZE 256 --config BLOCKYSIZE 256
> > image.tif 2 4 8 16 32
> > gdalinfo:
> > Band 1 Block=256x256 Type=Byte, ColorInterp=Red
> >   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
> > Band 2 Block=256x256 Type=Byte, ColorInterp=Green
> >   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
> > Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
> >   Overviews: 8655x5655, 4328x2828, 2164x1414, 1082x707, 541x354
> >
> > But I couldn't find a way to inspect the overview block size to confirm
> > they are 256x256 since I get the same results if I set BLOCKSIZE to 128.
> I
> > suspect these options are ignored in gdaladdo.
>
> The right name is GDAL_TIFF_OVR_BLOCKSIZE. See
> http://gdal.org/frmt_gtiff.html
>
> >
> > Any way I can 1) control the overview block size and 2) inspect the block
> > size ?
>
> Not directly with gdalinfo.
> With Python :
>
> from osgeo import gdal
> ds = gdal.Open('your.tif')
> print(ds.GetRasterBand(1).GetOverview(0).GetBlockSize())
>
>
>
> >
> > Thanks for your help,
> > Etienne
> >
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140610/e00b03c5/attachment-0001.html>

From lucena_ivan at hotmail.com  Tue Jun 10 10:32:33 2014
From: lucena_ivan at hotmail.com (Ivan Lucena)
Date: Tue, 10 Jun 2014 13:32:33 -0400
Subject: [gdal-dev] VRTDataset in Java
In-Reply-To: <1402415030.539727b61bf16@imp.free.fr>
References: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>
	<BLU173-W15220551E0418810F9924890280@phx.gbl>,
	<1402415030.539727b61bf16@imp.free.fr>
Message-ID: <BLU173-W161EC28CF2FD9C7C32377E90280@phx.gbl>

Hi Even,

> Date: Tue, 10 Jun 2014 17:43:50 +0200
> From: even.rouault at mines-paris.org
> To: lucena_ivan at hotmail.com
> CC: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] VRTDataset in Java
> 
> Ivan,
> 
> gdal_vrt.h is an already installed header file and the symbols are exported
> (CPL_DLL), so this is a public C API (although a bit confidential probably)
> As far as SWIG bindings is concerned, some work would be needed. New shadow

I once added some methods to the GDAL SWIG Java interface but I can't remember how I did it. The only thing I remember is the pain in the neck. 

> types should be introduced to model VRTDataset and VRTSourcedRasterBand (and
> some care too since all bands returned by a VRTDataset are not necessarily
> VRTSourcedRasterBand ). As far as VRTAddSource(), there's no C API to bind the
> corresponding C++ VRTSource classes, but probably that the helpers
> VRTAddSimpleSource() and VRTAddComplexSource() are sufficient.

Yes, it seems like it is possible to create the VRT Dataset using the generic API up to the point where we you cannot enter the band "SimpleSource" or "ComplexSource", so maybe those two functions would be enough. Let me see what I can do with SWIG.

The VRT driver is the usual solution to a lot of problem but we cannot automatize the solution on environment other than C/C++ or command scripts. But unfortunately, even if we add those two function much of the VRT magic is still not on the VRT code but in gdal_translate.cpp [0].

Best regards,

Ivan


ref.: [0] http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-translate-as-a-VRTDataset-factory-td3750410.html

> 
> Even
> 
> >
> >
> > Do we have plans to add those entries to the GDAL API (C, Java, etc.)?
> >
> > ---------- \...\GDAL\TRUNK\FRMTS\VRT\GDAL_VRT.H
> > VRTDatasetH CPL_DLL CPL_STDCALL VRTCreate( int, int );
> > CPLXMLNode CPL_DLL * CPL_STDCALL VRTSerializeToXML( VRTDatasetH, const char *
> > );
> > CPLErr CPL_STDCALL VRTAddSource( VRTSourcedRasterBandH, VRTSourceH );
> > CPLErr CPL_DLL CPL_STDCALL VRTAddSimpleSource( VRTSourcedRasterBandH,
> > CPLErr CPL_DLL CPL_STDCALL VRTAddComplexSource( VRTSourcedRasterBandH,
> >
> > From: lucena_ivan at hotmail.com
> > To: gdal-dev at lists.osgeo.org
> > Date: Mon, 9 Jun 2014 16:58:12 -0400
> > Subject: [gdal-dev] VRTDataset in Java
> >
> >
> >
> >
> > Hi there,
> >
> > What is the best option to create in memory VRT Dataset with the GDAL Java
> > API?
> >
> > I would like to do thing like gdal_translate does [0], band selection and
> > window cropping for example.
> >
> > It seems like the VRTDataset class is not wrapped in Java, so I would need to
> > write the XML myself or use a regular GDAL Dataset clas, ex.:
> >
> > Dataset ds = dal.getDriverByName("VRT").Create("/vsimem/xxx.vrt", 255, 255);
> >
> > But there are some methods in VRTDataset that GDALDataset doesn't have, so I
> > think I am going with the raw XML option.
> >
> > Any better idea?
> >
> > Best regards,
> >
> > Ivan
> >
> > ref. :
> >
> > [0]
> > http://trac.osgeo.org/gdal/browser/trunk/gdal/apps/gdal_translate.cpp#L1095
> >
> >
> >
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> 
> 
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140610/64702d31/attachment.html>

From jukka.rahkonen at mmmtike.fi  Tue Jun 10 11:31:12 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Tue, 10 Jun 2014 18:31:12 +0000 (UTC)
Subject: [gdal-dev] GDAL may create slow GPKG/SQLite indexes
References: <loom.20140609T090530-723@post.gmane.org>
	<201406090959.41142.even.rouault@mines-paris.org>
	<201406091104.05764.even.rouault@mines-paris.org>
Message-ID: <loom.20140610T201837-68@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> 
> Jukka,
> 
> I tried to simulate your scenario but couldn't observe any performance 
> difference (on Linux, but I doubt that the OS would make a difference) when 
> generating a test DB with 3.7.9 or 3.7.14, and using it with the other 
> version.
> However it might heavily depend on the number of records that match 
> attr_1='009' and area>1000
> 
> Could you share your DB ?

Hi,

I created a new one for you. It was a bit irritating job because the speed
test results are not at all stable. I suppose that same cachign may occur
here and there. However, this one in now very slow (for example 500 seconds)
with OpenJUMP which reads data from java through sqlite-jdbc-3.7.2.jar. Same
query from ogrinfo tends to take around 25 s and when I made a copy of the
db, dropped and created indexes again with spatialite-gui the query takes
about 0.2 s. However, this procedure did not make ogrinfo faster. Running
ANALYZE and VACUUM did not make a big difference for me.

select * from indextest
where knro='781'
or pinta_ala>1000;

http://hip.latuviitta.org/tiedostot/indextest.zip


-Jukka Rahkonen-



From even.rouault at mines-paris.org  Tue Jun 10 23:43:48 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 11 Jun 2014 08:43:48 +0200
Subject: [gdal-dev] VRTDataset in Java
In-Reply-To: <BLU173-W161EC28CF2FD9C7C32377E90280@phx.gbl>
References: <BLU173-W2287DCC9607D298F21FA1490290@phx.gbl>
	<1402415030.539727b61bf16@imp.free.fr>
	<BLU173-W161EC28CF2FD9C7C32377E90280@phx.gbl>
Message-ID: <201406110843.48893.even.rouault@mines-paris.org>

> The VRT driver is the usual solution to a lot of problem but we cannot
> automatize the solution on environment other than C/C++ or command
> scripts. But unfortunately, even if we add those two function much of the
> VRT magic is still not on the VRT code but in gdal_translate.cpp [0].

Yes, some added value still is in the utilities. An idea that has floated 
around and could be a potential solution for this would be to put the utility 
code in the library itself and have it mapped as a C API that could also be 
used from SWIG bindings.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From userofgdal at gmail.com  Wed Jun 11 06:23:41 2014
From: userofgdal at gmail.com (user gdal)
Date: Wed, 11 Jun 2014 18:53:41 +0530
Subject: [gdal-dev] OGR writing problem pl. help
Message-ID: <CAJnZZaLX0K6qfONSz9a-0oo_7QUXdqN7SJ7+DTxpSHFYOCfzaQ@mail.gmail.com>

Dear all,
I have a shape file and programmatically I have to write to an attribute
named 'production'. I use Visual; C++ 2005. I proceeded like this:

const char *DriverName = "ESRI Shapefile";
OGRSFDriver *Driver;
OGRRegisterAll();
Driver = OGRSFDriverRegistrar::GetRegistrar( )->GetDriverByName(DriverName);

if(!Driver)
{
 AfxMessageBox(_T("Driver Conf. failed"));
 (CMyApp *) AfxGetMainWnd( )->PostMessage(WM_CLOSE);
}

...

OGRDataSource *outsource;
OGRLayer *outlayer; OGRFeature *outfeature;

outsource=OGRSFDriverRegistrar::Open(chOutShapeFile, TRUE); /* char
*chOutShapeFile */
outlayer=outsource->GetLayer(0);

outfeature=outlayer->GetFeature(0);
...

 /* Create a field names production */

OGRFieldDefn prfield("production", OFTReal);  /* Want to write decimal
quantities */

prfield.SetWidth(32);
if(outlayer->CreateField(&prfield)!=OGRERR_NONE)
{
 AfxMessageBox(_T("Field named production could not be created"));
 (CMyApp *) AfxGetMainWnd( )->PostMessage(WM_CLOSE);
}

outfeature=outlayer->GetFeature(0);
 while(outfeature)  // Get the first feature
 {
  Prod=CalcProduction(...);
  outfeature->SetField("production", FALL->Production);
  outfeature=outlayer->GetNextFeature( );
 }

In the destructor: if(outsource)
OGRDataSource::DestroyDataSource(outsource);

My doubts are these:

1. At the end I find no change in the shape file. What could have gone
wrong?

2. I tried to read attributes (for example, area/shape_area). All incorrect
reads. How to tame the computer?

3. The shape file  contains only a handfull of polygons (which I checked
with ARC GIS/ERDAS) but to my horror the  MFC/Visual C++  program says
there are > 1000 features.

With many thanks,

Yours sincerely,
  B. Ramesh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140611/3efe1582/attachment.html>

From landa.martin at gmail.com  Wed Jun 11 14:41:39 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 11 Jun 2014 23:41:39 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
Message-ID: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>

Hi,

does `ogr2ogr` support RFC41 [1] (Support for multiple geometry fields
in OGR)? I didn't find appropriate option which enables to select
geometry column (`--geomfield` seems to operate only on spatial
filter) to be transfered to destination data source.

Thanks, Martin

[1] http://trac.osgeo.org/gdal/wiki/rfc41_multiple_geometry_fields

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Wed Jun 11 14:45:52 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 11 Jun 2014 23:45:52 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
Message-ID: <201406112345.52734.even.rouault@mines-paris.org>

Le mercredi 11 juin 2014 23:41:39, Martin Landa a ?crit :
> Hi,
> 
> does `ogr2ogr` support RFC41 [1] (Support for multiple geometry fields
> in OGR)? I didn't find appropriate option which enables to select
> geometry column (`--geomfield` seems to operate only on spatial
> filter) to be transfered to destination data source.

Martin,

Yes, by default it will transfer all source geometry fields into the target 
layer, if it supports multiple geometry fields. If you want only a subset of 
source geometry fields, you can write a SQL clause " SELECT geomfield1, 
geomfield2, other_attr FROM your_layer"

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From landa.martin at gmail.com  Wed Jun 11 14:49:55 2014
From: landa.martin at gmail.com (Martin Landa)
Date: Wed, 11 Jun 2014 23:49:55 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <201406112345.52734.even.rouault@mines-paris.org>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
Message-ID: <CA+Ei1OeOHrfgJdQb9JC9UCT5fzf0ob2Qu+C85XjToHVnL6w8LA@mail.gmail.com>

2014-06-11 23:45 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> source geometry fields, you can write a SQL clause " SELECT geomfield1,
> geomfield2, other_attr FROM your_layer"

yes, but it's not really user-friendly (when more attributes are
listed). Probably `--geomfield` could be also used to select geometry
column when destination data source doesn't support RFC-41, what do
you think?

Martin

-- 
Martin Landa * http://geo.fsv.cvut.cz/gwiki/Landa

From even.rouault at mines-paris.org  Wed Jun 11 14:54:33 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 11 Jun 2014 23:54:33 +0200
Subject: [gdal-dev] ogr2ogr and RFC41
In-Reply-To: <CA+Ei1OeOHrfgJdQb9JC9UCT5fzf0ob2Qu+C85XjToHVnL6w8LA@mail.gmail.com>
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
	<CA+Ei1OeOHrfgJdQb9JC9UCT5fzf0ob2Qu+C85XjToHVnL6w8LA@mail.gmail.com>
Message-ID: <201406112354.35131.even.rouault@mines-paris.org>

Le mercredi 11 juin 2014 23:49:55, Martin Landa a ?crit :
> 2014-06-11 23:45 GMT+02:00 Even Rouault <even.rouault at mines-paris.org>:
> > source geometry fields, you can write a SQL clause " SELECT geomfield1,
> > geomfield2, other_attr FROM your_layer"
> 
> yes, but it's not really user-friendly (when more attributes are
> listed). Probably `--geomfield` could be also used to select geometry
> column when destination data source doesn't support RFC-41, what do
> you think?

Actually, I see that I had upgraded the logic of the -select option to be able 
to specify geomtry field(s) also.

> 
> Martin

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From jukka.rahkonen at mmmtike.fi  Thu Jun 12 01:02:51 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Thu, 12 Jun 2014 08:02:51 +0000 (UTC)
Subject: [gdal-dev] ogr2ogr and RFC41
References: <CA+Ei1OfO1RRfU2RnZMrbpm+Gk4ieUQq629PVaWqRpkDzrf4EFQ@mail.gmail.com>
	<201406112345.52734.even.rouault@mines-paris.org>
	<CA+Ei1OeOHrfgJdQb9JC9UCT5fzf0ob2Qu+C85XjToHVnL6w8LA@mail.gmail.com>
Message-ID: <loom.20140612T094533-775@post.gmane.org>

Martin Landa <landa.martin <at> gmail.com> writes:

> 
> 2014-06-11 23:45 GMT+02:00 Even Rouault <even.rouault <at> mines-paris.org>:
> > source geometry fields, you can write a SQL clause " SELECT geomfield1,
> > geomfield2, other_attr FROM your_layer"
> 
> yes, but it's not really user-friendly (when more attributes are
> listed). Probably `--geomfield` could be also used to select geometry
> column when destination data source doesn't support RFC-41, what do
> you think?

As a workaround I would try what happens with 
-sql "SELECT geometry2, * FROM your_layer"

It may lead to desired result (especially selected geometry written into
target, second occasion of the same and other geometries skipped) with
minimal writing but I have not tried it myself.

-Jukka Rahkonen-


From danieltesta at suremptec.com.ar  Fri Jun 13 07:43:59 2014
From: danieltesta at suremptec.com.ar (Daniel Testa)
Date: Fri, 13 Jun 2014 11:43:59 -0300
Subject: [gdal-dev] OGR writing problem pl. help
In-Reply-To: <CAJnZZaLX0K6qfONSz9a-0oo_7QUXdqN7SJ7+DTxpSHFYOCfzaQ@mail.gmail.com>
References: <CAJnZZaLX0K6qfONSz9a-0oo_7QUXdqN7SJ7+DTxpSHFYOCfzaQ@mail.gmail.com>
Message-ID: <CAHy2iFd4PogcanrCenuRGrkvxhNR0hkZkVRyRPGkaY0_m0AcoA@mail.gmail.com>

Hi,

- try adding the following line:
outlayer->SetFeature(outfeature);

after:
outfeature->SetField("production", FALL->Production);

ends up being:
[...]
outfeature->SetField("production", FALL->Production);
outlayer->SetFeature(outfeature);
[...]

make sure OGRDataSource::DestroyDataSource(outsource) is executed
(it "will ensure all data is correctly flushed.")


- You may, also, want to check the following line:
prfield.SetWidth(32);

try with SetPrecision instead (since you are adding a OFTReal field):
prfield.SetPrecision(32);


- you could try with outlayer->GetFeatureCount(TRUE)
(check the doc at http://www.gdal.org/classOGRLayer.html)



Hope it helps.

Regards,
Daniel.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140613/33dd02eb/attachment.html>

From hellik at web.de  Fri Jun 13 09:15:51 2014
From: hellik at web.de (Helmut Kudrnovsky)
Date: Fri, 13 Jun 2014 09:15:51 -0700 (PDT)
Subject: [gdal-dev] gdaltindex with wildcard (*.tif) in a /vsizip/myzip.zip
Message-ID: <1402676151975-5145801.post@n6.nabble.com>

Hi,

in the gdaltindex-manual there is an example using wildcard:

gdaltindex doq_index.shp doq/*.tif

my issue:

given a ~1 GB zip-file on a DVD with a lot of geotiffs, windows 7 box.


gdaltindex C:\data\m31_1.shp /vsizip/myzip.zip/m31_1/3523-5301_201308.tif

works fine, but

gdaltindex C:\data\m31_1.shp /vsizip/myzip.zip/m31_1/*.tif

fails with following message:

ERROR 4: `/vsizip/myzip.zip/m31_1/*.tif' does not exist in the file s
ystem,
and is not recognised as a supported dataset name.

Unable to open /vsizip/myzip.zip/m31_1/*.tif, skipping.

any idea if/how this could work?

thanks
Helmut



-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdaltindex-with-wildcard-tif-in-a-vsizip-myzip-zip-tp5145801.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From varunsaraf14 at gmail.com  Fri Jun 13 09:39:01 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Fri, 13 Jun 2014 22:09:01 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 4 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rsDeAx=ahcaN0s4-Pzz=HnzKTvwsBwSvQfp0DibQSTVAQ@mail.gmail.com>

Hi,

Below is my fourth weekly report:

*What did I do this week?*

   - Implemented the following methods which create the query : DropTable,
   CreateTable, CopyFrom, CreateIndex, AnalyzeTable, VacuumTable,
   AddRasterConstraints.

*What do I plan on doing next week?*

   - Continue to write methods to create the sql query which will write
   data to the PostgreSQL tables.
   - I had estimated 3 weeks of work for this part in my proposal. But I
   will need some more time.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-4
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140613/3c58a001/attachment.html>

From even.rouault at mines-paris.org  Fri Jun 13 10:28:01 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 13 Jun 2014 19:28:01 +0200
Subject: [gdal-dev] gdaltindex with wildcard (*.tif) in a
	/vsizip/myzip.zip
In-Reply-To: <1402676151975-5145801.post@n6.nabble.com>
References: <1402676151975-5145801.post@n6.nabble.com>
Message-ID: <201406131928.01810.even.rouault@mines-paris.org>

Le vendredi 13 juin 2014 18:15:51, Helmut Kudrnovsky a ?crit :
> Hi,
> 
> in the gdaltindex-manual there is an example using wildcard:
> 
> gdaltindex doq_index.shp doq/*.tif

Wildcard is evaluated by the operating system

> 
> my issue:
> 
> given a ~1 GB zip-file on a DVD with a lot of geotiffs, windows 7 box.
> 
> 
> gdaltindex C:\data\m31_1.shp /vsizip/myzip.zip/m31_1/3523-5301_201308.tif
> 
> works fine, but
> 
> gdaltindex C:\data\m31_1.shp /vsizip/myzip.zip/m31_1/*.tif

But the operating system doesn't (logically) recognize the GDAL special 
/vsizip/ file system, so the wildcard is not evaluated.

A modest complementary development would have to be done to evaluate the 
wildcart inside gdaltindex.

An alternative might be to use the gdal_ls.py sample utility 
(http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/gdal_ls.py), 
redirect its output to a file and specify this file with --optfile to the 
gdaltindex command line.

python gdal_ls.py /vsizip/the_zip/the_subdir > filelist.txt
(you may need to filter non tif files. with the Windows equivalent of grep, or 
potentially the port of the unix grep : 
http://gnuwin32.sourceforge.net/packages/grep.htm)
gdaltindex the_index.shp --optfile filelist.txt

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From hellik at web.de  Fri Jun 13 11:18:55 2014
From: hellik at web.de (Helmut Kudrnovsky)
Date: Fri, 13 Jun 2014 11:18:55 -0700 (PDT)
Subject: [gdal-dev] gdaltindex with wildcard (*.tif) in a
	/vsizip/myzip.zip
In-Reply-To: <201406131928.01810.even.rouault@mines-paris.org>
References: <1402676151975-5145801.post@n6.nabble.com>
	<201406131928.01810.even.rouault@mines-paris.org>
Message-ID: <1402683535303-5145822.post@n6.nabble.com>

>> gdaltindex doq_index.shp doq/*.tif

>Wildcard is evaluated by the operating system 

ah yes, your are right.

>An alternative might be to use the gdal_ls.py sample utility
>(http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/gdal_ls.py),
>redirect its output to a file and specify this file with --optfile to the
>gdaltindex command line. 

thanks, gdal_ls.py works nicely.




-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdaltindex-with-wildcard-tif-in-a-vsizip-myzip-zip-tp5145801p5145822.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From gusevmihs at gmail.com  Fri Jun 13 12:54:56 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Fri, 13 Jun 2014 23:54:56 +0400
Subject: [gdal-dev] GSoC weekly report 4. GDAL Networking
Message-ID: <CAJB43VrOy57dvwD9f+AzAXGJ67=cCaPqcnAj8cBhO1=hJh+5Xw@mail.gmail.com>

Hello everyone.
This week, as I planed, I've successfully built GDAL from source and
started to add a new API. I made a temporary repo [
https://github.com/MikhanGusev/gdal-svn]. It is temporary because I plan to
base my work on trunk 2.0dev later, and to build it the same way. I was
also blocked a bit because I had to get familiar with CMake, but now all is
ok.
The next week I plan to continue integrating my old classes and methods
into GDAL, testing it in my local repo. During this I plan to make patchs
which can be used by commiters to test whether my API works in a real
library (current 2.0 trunk). In general I plan to finish moving my old
methods and classes to the new API up to the first midterm evaluation (up
to June 27).
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140613/205fc768/attachment.html>

From tastle at caris.com  Mon Jun 16 05:20:59 2014
From: tastle at caris.com (Timothy Astle)
Date: Mon, 16 Jun 2014 09:20:59 -0300
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
	need to be encoded
Message-ID: <539EE12B.3070800@caris.com>

Hi all,

Does anyone know why CPLEscapeString 
(https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character 
encodes characters that are valid as-is according to 
http://www.ietf.org/rfc/rfc1738.txt?

I just hit a situation where I noticed the WMS driver is converting 
hyphens to %2D for layer names.  The 3rd party server doesn't handle it 
(but it should) and this caught my attention.

Any thoughts?  Is it just a case where a patch would be welcome?

-- 
Tim Astle
Development Manager
Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140616/9332a893/attachment.html>

From ari.jolma at gmail.com  Mon Jun 16 08:05:13 2014
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 16 Jun 2014 08:05:13 -0700
Subject: [gdal-dev] Asking about feature field types of Shape File (SHP)
 ?
In-Reply-To: <1401950713440-5144127.post@n6.nabble.com>
References: <1401950713440-5144127.post@n6.nabble.com>
Message-ID: <539F07A9.9020604@gmail.com>

On 06/04/2014 11:45 PM, taibc wrote:
> Hi everyone,
>
> I created the shape file by usinge the feature filed type: OFTInteger.
>
> But when I open the file in Arcgis (ArcCatalog) the data type is: Double
> (not integer).
>
> Do you know how to fix this (I want it is Int) ?

Dear Tai,

This is a bit old email so I'll answer from my head. I believe you need 
to set the length of the Integer field to be short enough. If I remember 
correctly there is a ticket on the issue, but it is deemed as a feature, 
not a bug.

Ari Jolma

>
> Thanks and regards,
> Tai
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/Asking-about-feature-field-types-of-Shape-File-SHP-tp5144127.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev


From jan.heckman at gmail.com  Mon Jun 16 12:44:36 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Mon, 16 Jun 2014 21:44:36 +0200
Subject: [gdal-dev] Asking about feature field types of Shape File (SHP)
	?
In-Reply-To: <539F07A9.9020604@gmail.com>
References: <1401950713440-5144127.post@n6.nabble.com>
	<539F07A9.9020604@gmail.com>
Message-ID: <CAKMUAtDN1zSUf+9yjWYC3ze_W+nETqmSfvHg8ZAJBu2hSUvEaQ@mail.gmail.com>

Not focusing on ogr, but on shapefile:
Shapefile uses .dbf (dBase III) to store attributes (except geometrical
attributes which are stored in the .shp file).
This format does not know about integers, only about numericals (type N or
F), with a specifiable precision (how many number-positions) and number of
decimals (behind the decimal separator), aka scale.
If this sounds textish, that is because it is: the numbers are stored in
the file as text. N as a fixed point double, F - in principle, but in fact
depending on implementation - uses scientific notation. When specifying
these values (when creating a field), you typically count the non-numerical
parts such as a - sign, the decimal separator and the exponent when using F
to specify precision. Exponent, by default, but hard to change, uses 3
digits, and E and possibly a - (negative exponent).
I hope that explains why there is not an effective type Integer for
shapefiles. There is no way for a (ogr)driver to invent one in the case of
 shapefiles. The type integer is applicable by extension because in  other
formats the distinction between numerical types is maintained more
rigorously. Number of decimals = 0 should do the trick, but ArcGis will
call it a double with some precision and scale 0. Can be used as integer
without side-effects, so far I've noticed.
Jan


On Mon, Jun 16, 2014 at 5:05 PM, Ari Jolma <ari.jolma at gmail.com> wrote:

> On 06/04/2014 11:45 PM, taibc wrote:
>
>> Hi everyone,
>>
>> I created the shape file by usinge the feature filed type: OFTInteger.
>>
>> But when I open the file in Arcgis (ArcCatalog) the data type is: Double
>> (not integer).
>>
>> Do you know how to fix this (I want it is Int) ?
>>
>
> Dear Tai,
>
> This is a bit old email so I'll answer from my head. I believe you need to
> set the length of the Integer field to be short enough. If I remember
> correctly there is a ticket on the issue, but it is deemed as a feature,
> not a bug.
>
> Ari Jolma
>
>
>> Thanks and regards,
>> Tai
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.
>> nabble.com/Asking-about-feature-field-types-of-Shape-
>> File-SHP-tp5144127.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140616/49706df9/attachment.html>

From klonuo at gmail.com  Mon Jun 16 14:56:14 2014
From: klonuo at gmail.com (klo uo)
Date: Mon, 16 Jun 2014 23:56:14 +0200
Subject: [gdal-dev] gdal2tiles from vrt with unexpected result
Message-ID: <CAA-8Ld_0pw99KBue7NtqXzQQ++y5acyotxEqjEEyJrRgBS3LdA@mail.gmail.com>

Hi,

I tried to use gdal2tiles on a VRT generated from JPG images (which a btw
256 x 256 pixel tiles themselves)
I double checked VRT with gdal_translate to crop part of it and got
expected result.

When I use gdal2tiles, i.e.: `gdal2tiles.py -p raster -z 2 mosaic.vrt` I
get as a result 256px tiles, but tiles are empty except for upper left 64 x
64 px region, which contains what I would expect for whole tile, or put it
differently tile is reduced unnecessarily 4 times while preserving 256px
canvas.

So every single tile, looks like this:

    +---+---+---+---+
    | X |   |   |   |
    +---+---+---+---+
    |   |   |   |   |
    +---+---+---+---+
    |   |   |   |   |
    +---+---+---+---+
    |   |   |   |   |
    +---+---+---+---+

where "X" is region containing map sample while rest of the tile is empty,
or more easily comprehensible by looking at the the attachment.

Any ideas, what might be wrong?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140616/acdb2f39/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 1.png
Type: image/png
Size: 12673 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140616/acdb2f39/attachment-0001.png>

From andre+joost at nurfuerspam.de  Mon Jun 16 20:54:36 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Tue, 17 Jun 2014 05:54:36 +0200
Subject: [gdal-dev] gdal2tiles from vrt with unexpected result
In-Reply-To: <CAA-8Ld_0pw99KBue7NtqXzQQ++y5acyotxEqjEEyJrRgBS3LdA@mail.gmail.com>
References: <CAA-8Ld_0pw99KBue7NtqXzQQ++y5acyotxEqjEEyJrRgBS3LdA@mail.gmail.com>
Message-ID: <lnoe8l$idl$1@ger.gmane.org>

Am 16.06.2014 23:56, schrieb klo uo:

>
> When I use gdal2tiles, i.e.: `gdal2tiles.py -p raster -z 2 mosaic.vrt` I
> get as a result 256px tiles, but tiles are empty except for upper left 64 x
> 64 px region, which contains what I would expect for whole tile, or put it
> differently tile is reduced unnecessarily 4 times while preserving 256px
> canvas.
>
>
> Any ideas, what might be wrong?
>

What extent does your source vrt have?

Greetings,
Andre Joost


From klonuo at gmail.com  Tue Jun 17 04:52:40 2014
From: klonuo at gmail.com (klo uo)
Date: Tue, 17 Jun 2014 13:52:40 +0200
Subject: [gdal-dev] gdal2tiles from vrt with unexpected result&amp;
	In-Reply-To=<lnoe8l$idl$1@ger.gmane.org>
Message-ID: <CAA-8Ld_qBbky_MV3U8tbgmzWyZxr=3WtR_a_yuG6kJieRECwgg@mail.gmail.com>

Here is VRT header and one "simplesource" node just in case:

========================================
<VRTDataset rasterXSize="59392" rasterYSize="46592">
  <SRS>
  PROJCS["Bessel_1841_Transverse_Mercator",
    GEOGCS["GCS_Bessel_1841",
        DATUM["D_Bessel_1841",
            SPHEROID["Bessel_1841",6377397.155,299.1528128]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["False_Easting",7500000.0],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",21.0],
    PARAMETER["Scale_Factor",0.9999],
    PARAMETER["Latitude_Of_Origin",0.0],
    UNIT["Meter",1.0]]
  </SRS>
  <GeoTransform>7.4368811642262540e+006, 4.2254386021270500e+000,
0.0000000000000000e+000, 4.7073264160994580e+006,
0.0000000000000000e+000,-4.1943557729515746e+000</GeoTransform>
  <VRTRasterBand dataType="Byte" band="1">
    <ColorInterp>Red</ColorInterp>
    <SimpleSource>
      <SourceFilename relativeToVRT="1">8/0/78.jpg</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties DataType="Byte" RasterXSize="256" BlockXSize="256"
RasterYSize="256" BlockYSize="1"/>
      <SrcRect ySize="256" xOff="0" yOff="0" xSize="256"/>
      <DstRect ySize="256" xOff="0" yOff="26368" xSize="256"/>
    </SimpleSource>
    ...
========================================
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140617/7253ad94/attachment.html>

From bishop.dev at gmail.com  Tue Jun 17 06:58:05 2014
From: bishop.dev at gmail.com (Dmitriy Baryshnikov)
Date: Tue, 17 Jun 2014 17:58:05 +0400
Subject: [gdal-dev] Cmake for building GDAL
Message-ID: <53A0496D.7060709@gmail.com>

Hi All,

I just fix Cmake scripts for current GDAL trunk and make GDAL on my
Ubuntu 14.04. Last code is in cmake4gdal brunch on github
(https://github.com/nextgis/gdal-svn/tree/cmake4gdal).

Now it tested on Windows (32-bit and 64-bit builds) and Linux (Ubuntu 14.04).

There are no all parts of GDAL (some drivers, bindings and so on), but
this is maybe some kind of first look.
The work is going on, so I plan fix all this issues. You can test this.
Maybe there are some error with naming conventions and install paths.
Also I set the drivers which reported as build by default as ON in Cmake
(http://gdal.org/formats_list.html  and
http://gdal.org/ogr_formats.html). The others can be switched on bu
CMake-GUI or command line.
My GDAL build includes:

$ ogrinfo --formats
Supported Formats:
    ESRI Shapefile -vector- (rw+v): ESRI Shapefile
    MapInfo File -vector- (rw+): MapInfo File
    S57 -vector- (rw+v): IHO S-57 (ENC)
    OGR_VRT -vector- (rov): VRT - Virtual Datasource
    Memory -vector- (rw+): Memory
    CSV -vector- (rw+v): Comma Separated Value (.csv)
    GML -vector- (rw+v): Geography Markup Language (GML)
    GPX -vector- (rw+v): GPX
    LIBKML -vector- (rw+v): Keyhole Markup Language (LIBKML)
    KML -vector- (rw+v): Keyhole Markup Language (KML)
    GeoJSON -vector- (rw+v): GeoJSON
    GPKG -vector- (rw+v): GeoPackage
    SQLite -vector- (rw+v): SQLite / Spatialite
    PostgreSQL -vector- (rw+): PostgreSQL/PostGIS
    MySQL -vector- (rw+): MySQL
    OpenFileGDB -vector- (rov): ESRI FileGDB
    DXF -vector- (rw+v): AutoCAD DXF
    WFS -vector- (rov): OGC WFS (Web Feature Service)
    SXF -vector- (ro): Storage and eXchange Format

$ gdalinfo --formats
Supported Formats:
    VRT -raster- (rw+v): Virtual Raster
    GTiff -raster- (rw+vs): GeoTIFF
    HFA -raster- (rw+v): Erdas Imagine Images (.img)
    PNG -raster- (rwv): Portable Network Graphics
    JPEG -raster- (rwv): JPEG JFIF
    MEM -raster- (rw+): In Memory Raster
    GIF -raster- (rwv): Graphics Interchange Format (.gif)
    BIGGIF -raster- (rov): Graphics Interchange Format (.gif)
    BMP -raster- (rw+v): MS Windows Device Independent Bitmap
    DIMAP -raster- (rov): SPOT DIMAP
    TIL -raster- (rov): EarthWatch .TIL
    WMS -raster- (rwvs): OGC Web Map Service
    MAP -raster- (rov): OziExplorer .MAP
    PNM -raster- (rw+v): Portable Pixmap Format (netpbm)
    DOQ1 -raster- (rov): USGS DOQ (Old Style)
    DOQ2 -raster- (rov): USGS DOQ (New Style)
    ENVI -raster- (rw+v): ENVI .hdr Labelled
    EHdr -raster- (rw+v): ESRI .hdr Labelled
    GenBin -raster- (rov): Generic Binary (.hdr Labelled)
    PAux -raster- (rw+): PCI .aux Labelled
    MFF -raster- (rw+): Vexcel MFF Raster
    MFF2 -raster- (rw+): Vexcel MFF2 (HKV) Raster
    FujiBAS -raster- (ro): Fuji BAS Scanner Image
    GSC -raster- (rov): GSC Geogrid
    FAST -raster- (rov): EOSAT FAST Format
    BT -raster- (rw+v): VTP .bt (Binary Terrain) 1.3 Format
    LAN -raster- (rw+v): Erdas .LAN/.GIS
    CPG -raster- (ro): Convair PolGASP
    IDA -raster- (rw+v): Image Data and Analysis
    NDF -raster- (rov): NLAPS Data Format
    EIR -raster- (rov): Erdas Imagine Raw
    DIPEx -raster- (rov): DIPEx
    LCP -raster- (rwv): FARSITE v.4 Landscape File (.lcp)
    GTX -raster- (rw+v): NOAA Vertical Datum .GTX
    LOSLAS -raster- (rov): NADCON .los/.las Datum Grid Shift
    NTv2 -raster- (rw+vs): NTv2 Datum Grid Shift
    CTable2 -raster- (rw+v): CTable2 Datum Grid Shift
    ACE2 -raster- (rov): ACE2
    SNODAS -raster- (rov): Snow Data Assimilation System
    KRO -raster- (rw+v): KOLOR Raw
    PostGISRaster -raster- (rws): PostGIS Raster driver
    SAGA -raster- (rw+v): SAGA GIS Binary Grid (.sdat)
    OZI -raster- (rov): OziExplorer Image File

$ gdalinfo --version
GDAL 2.0.0dev, released 2014/04/16

Feedback is welcome.

-- 
Best regards,
     Dmitry


From klonuo at gmail.com  Tue Jun 17 08:30:34 2014
From: klonuo at gmail.com (klo)
Date: Tue, 17 Jun 2014 08:30:34 -0700 (PDT)
Subject: [gdal-dev] gdal2tiles from vrt with unexpected result
In-Reply-To: <lnoe8l$idl$1@ger.gmane.org>
References: <CAA-8Ld_0pw99KBue7NtqXzQQ++y5acyotxEqjEEyJrRgBS3LdA@mail.gmail.com>
	<lnoe8l$idl$1@ger.gmane.org>
Message-ID: <1403019034877-5146324.post@n6.nabble.com>

VRT extend is approximately this:

ulx, uly = (7436881, 4707326)
lrx, lry = (7687838, 4511902)

Here is also excerpt from VRT file itself:

========================================
<VRTDataset rasterXSize="59392" rasterYSize="46592">
  <SRS>
  PROJCS["Bessel_1841_Transverse_Mercator",
    GEOGCS["GCS_Bessel_1841",
        DATUM["D_Bessel_1841",
            SPHEROID["Bessel_1841",6377397.155,299.1528128]],
        PRIMEM["Greenwich",0.0],
        UNIT["Degree",0.0174532925199433]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["False_Easting",7500000.0],
    PARAMETER["False_Northing",0.0],
    PARAMETER["Central_Meridian",21.0],
    PARAMETER["Scale_Factor",0.9999],
    PARAMETER["Latitude_Of_Origin",0.0],
    UNIT["Meter",1.0]]
  </SRS>
  <GeoTransform>7.4368811642262540e+006, 4.2254386021270500e+000,
0.0000000000000000e+000, 4.7073264160994580e+006,
0.0000000000000000e+000,-4.1943557729515746e+000</GeoTransform>
  <VRTRasterBand dataType="Byte" band="1">
    <ColorInterp>Red</ColorInterp>
    <SimpleSource>
      <SourceFilename relativeToVRT="1">8/0/78.jpg</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties DataType="Byte" RasterXSize="256" BlockXSize="256"
RasterYSize="256" BlockYSize="1"/>
      <SrcRect ySize="256" xOff="0" yOff="0" xSize="256"/>
      <DstRect ySize="256" xOff="0" yOff="26368" xSize="256"/>
    </SimpleSource>
    ...
========================================



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal2tiles-from-vrt-with-unexpected-result-tp5146171p5146324.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From smilingmolecule at web.de  Tue Jun 17 11:56:43 2014
From: smilingmolecule at web.de (Robert Grah)
Date: Tue, 17 Jun 2014 11:56:43 -0700
Subject: [gdal-dev] read whole elevation data from geotif to vector[x][y]
Message-ID: <146ab23ae0e.3395311153498323475.-6109404576517129733@web.de>

Hallo,

i think this question is somehow a bit stupid but I have to ask it anyway because i can not find a good working solution.
I try to read the whole elevation data from a band of a GeoTiff image into a c++ 2d vector so that I can read the values like vector[x][y].
I also like to convert the data to an image and perform other operations. 

I tried it like this, but this gives me the data in a strange order:

poBand->RasterIO( GF_Read, 0, 0, nXSize, nYSize, 
 pafScanline2, nXSize, nYSize, GDT_Float32, 
 0, 0 );
 int totalCount = 0;
 for (int i = 0; i GetXSize(); i++){

 vector yVal;
 for (int j = 0; j GetYSize(); j++){
 yVal.push_back(pafScanline2[totalCount]);
 totalCount++;
 }
 altData.push_back(yVal);
 }


I also tried to read every single value step by step, but this was really slow.
Is there an easy way to get the values ordered like the pixels of an image?
>From left to right and top to bottom? I think i am overlooking something...

Cheers,
Robert


From mateusz at loskot.net  Tue Jun 17 12:45:41 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 17 Jun 2014 21:45:41 +0200
Subject: [gdal-dev] read whole elevation data from geotif to vector[x][y]
In-Reply-To: <146ab23ae0e.3395311153498323475.-6109404576517129733@web.de>
References: <146ab23ae0e.3395311153498323475.-6109404576517129733@web.de>
Message-ID: <CABUeae81z=ZrzWLHh6rtWxjZPMw70rwPd258iBPLJgWK3n6UQg@mail.gmail.com>

On 17 June 2014 20:56, Robert Grah <smilingmolecule at web.de> wrote:
>
> I try to read the whole elevation data from a band of a GeoTiff image into a c++ 2d vector so that I can read the values like vector[x][y].
> [...]
> Is there an easy way to get the values ordered like the pixels of an image?
> From left to right and top to bottom? I think i am overlooking something...

I think, your image is read correctly into vector of vectors,
but you are mismatching x and y indices while accessing individual pixels.

Compare your technique of accessing with this simple example:

// image 3x4
std::vector<std::vector<int>> v =
{
    { 1, 2, 3, 4 },// scanline 0
    { 5, 6, 7, 8 },// scanline 1
    { 9,10,11,12 } // scanline 2
};

std::size_t y(1), x(2);
int pixel = v[y][x]; // value 7

Notice, it is v[y][x]. no v[x][y].

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From even.rouault at mines-paris.org  Tue Jun 17 14:24:20 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Tue, 17 Jun 2014 23:24:20 +0200
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
	need to be encoded
In-Reply-To: <539EE12B.3070800@caris.com>
References: <539EE12B.3070800@caris.com>
Message-ID: <201406172324.20899.even.rouault@mines-paris.org>

Le lundi 16 juin 2014 14:20:59, Timothy Astle a ?crit :
> Hi all,
> 
> Does anyone know why CPLEscapeString
> (https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character
> encodes characters that are valid as-is according to
> http://www.ietf.org/rfc/rfc1738.txt?
> 
> I just hit a situation where I noticed the WMS driver is converting
> hyphens to %2D for layer names.  The 3rd party server doesn't handle it
> (but it should) and this caught my attention.
> 
> Any thoughts?  Is it just a case where a patch would be welcome?

Tim,

What would your patch do ? Implement the following from RFC1738 ? :

"Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
reserved characters used for their reserved purposes may be used
unencoded within a URL."

Well, actually I think it should still encode the reserved characters (";",
 "/", "?", ":", "@", "=" and "&"), since valid use cases of CPLEscapeString(, 
CPLES_URL) might be do make sure that they are encoded.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From peb.aryan at student.tuwien.ac.at  Wed Jun 18 05:20:21 2014
From: peb.aryan at student.tuwien.ac.at (peb aryan)
Date: Wed, 18 Jun 2014 14:20:21 +0200
Subject: [gdal-dev] read whole elevation data from geotif to vector[x][y]
In-Reply-To: <146ab23ae0e.3395311153498323475.-6109404576517129733@web.de>
References: <146ab23ae0e.3395311153498323475.-6109404576517129733@web.de>
Message-ID: <CAOHgSmj0nYCKKRX_y9jED_L+piSNkk2-GVmK3TWF3p2YmLLeSw@mail.gmail.com>

Hi Robert,

if you use opencv there is an easy way to pass buffer from RasterIO to a
cv::Mat

double *padRasterData =
(double*)CPLMalloc(iGridsizeX*iGridsizeY*sizeof(double));

h_dataset->RasterIO(GF_Read, 0, 0, iGridsizeX, iGridsizeY, padRasterData,
iGridsizeX, iGridsizeY, GDT_Float64, 1,NULL,0,0,0);

cv::Mat img = cv::Mat(iGridsizeY, iGridsizeX, CV_64F, &padRasterData[0]);

...

CPLFree( padRasterData );

cheers,

peb


On Tue, Jun 17, 2014 at 8:56 PM, Robert Grah <smilingmolecule at web.de> wrote:

> Hallo,
>
> i think this question is somehow a bit stupid but I have to ask it anyway
> because i can not find a good working solution.
> I try to read the whole elevation data from a band of a GeoTiff image into
> a c++ 2d vector so that I can read the values like vector[x][y].
> I also like to convert the data to an image and perform other operations.
>
> I tried it like this, but this gives me the data in a strange order:
>
> poBand->RasterIO( GF_Read, 0, 0, nXSize, nYSize,
>  pafScanline2, nXSize, nYSize, GDT_Float32,
>  0, 0 );
>  int totalCount = 0;
>  for (int i = 0; i GetXSize(); i++){
>
>  vector yVal;
>  for (int j = 0; j GetYSize(); j++){
>  yVal.push_back(pafScanline2[totalCount]);
>  totalCount++;
>  }
>  altData.push_back(yVal);
>  }
>
>
> I also tried to read every single value step by step, but this was really
> slow.
> Is there an easy way to get the values ordered like the pixels of an image?
> From left to right and top to bottom? I think i am overlooking something...
>
> Cheers,
> Robert
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/79ee39c8/attachment.html>

From tastle at caris.com  Wed Jun 18 05:47:47 2014
From: tastle at caris.com (Timothy Astle)
Date: Wed, 18 Jun 2014 09:47:47 -0300
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
 need to be encoded
In-Reply-To: <201406172324.20899.even.rouault@mines-paris.org>
References: <539EE12B.3070800@caris.com>
	<201406172324.20899.even.rouault@mines-paris.org>
Message-ID: <53A18A73.9030209@caris.com>

I was thinking something like the following:

              if( (pszInput[iIn] >= 'a' && pszInput[iIn] <= 'z')
                  || (pszInput[iIn] >= 'A' && pszInput[iIn] <= 'Z')
                  || (pszInput[iIn] >= '0' && pszInput[iIn] <= '9')
-                || pszInput[iIn] == '_' || pszInput[iIn] == '.' )
+                || pszInput[iIn] == '$' && pszInput[iIn] == '-'
+                || pszInput[iIn] == '_' || pszInput[iIn] == '.'
+                || pszInput[iIn] == '+' && pszInput[iIn] == '!'
+                || pszInput[iIn] == '*' && pszInput[iIn] == '\''
+                || pszInput[iIn] == '(' && pszInput[iIn] == ')'
+                || pszInput[iIn] == '"' && pszInput[iIn] == ',' )

which follows the list of special characters that may be used unencoded 
within a URL.

    Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
    reserved characters used for their reserved purposes may be used
    unencoded within a URL.

That list is mutually exclusive from the list you cited as being a 
concern, which I agree with.


Tim


On 17/06/2014 6:24 PM, Even Rouault wrote:
> Le lundi 16 juin 2014 14:20:59, Timothy Astle a ?crit :
>> Hi all,
>>
>> Does anyone know why CPLEscapeString
>> (https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character
>> encodes characters that are valid as-is according to
>> http://www.ietf.org/rfc/rfc1738.txt?
>>
>> I just hit a situation where I noticed the WMS driver is converting
>> hyphens to %2D for layer names.  The 3rd party server doesn't handle it
>> (but it should) and this caught my attention.
>>
>> Any thoughts?  Is it just a case where a patch would be welcome?
> Tim,
>
> What would your patch do ? Implement the following from RFC1738 ? :
>
> "Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
> reserved characters used for their reserved purposes may be used
> unencoded within a URL."
>
> Well, actually I think it should still encode the reserved characters (";",
>   "/", "?", ":", "@", "=" and "&"), since valid use cases of CPLEscapeString(,
> CPLES_URL) might be do make sure that they are encoded.
>
> Even
>

-- 
Tim Astle
Development Manager
Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/0faffede/attachment.html>

From even.rouault at mines-paris.org  Wed Jun 18 06:18:55 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 18 Jun 2014 15:18:55 +0200
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
	need to be encoded
In-Reply-To: <53A18A73.9030209@caris.com>
References: <539EE12B.3070800@caris.com>
	<201406172324.20899.even.rouault@mines-paris.org>
	<53A18A73.9030209@caris.com>
Message-ID: <201406181518.55614.even.rouault@mines-paris.org>

Le mercredi 18 juin 2014 14:47:47, Timothy Astle a ?crit :
> I was thinking something like the following:
> 
>               if( (pszInput[iIn] >= 'a' && pszInput[iIn] <= 'z')
> 
>                   || (pszInput[iIn] >= 'A' && pszInput[iIn] <= 'Z')
>                   || (pszInput[iIn] >= '0' && pszInput[iIn] <= '9')
> 
> -                || pszInput[iIn] == '_' || pszInput[iIn] == '.' )
> +                || pszInput[iIn] == '$' && pszInput[iIn] == '-'
> +                || pszInput[iIn] == '_' || pszInput[iIn] == '.'
> +                || pszInput[iIn] == '+' && pszInput[iIn] == '!'
> +                || pszInput[iIn] == '*' && pszInput[iIn] == '\''
> +                || pszInput[iIn] == '(' && pszInput[iIn] == ')'
> +                || pszInput[iIn] == '"' && pszInput[iIn] == ',' )
> 
> which follows the list of special characters that may be used unencoded
> within a URL.
> 
>     Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
>     reserved characters used for their reserved purposes may be used
>     unencoded within a URL.
> 
> That list is mutually exclusive from the list you cited as being a
> concern, which I agree with.

Looks reasonable, although I anticipate we might hit server bugs if changing 
that...

> 
> 
> Tim
> 
> On 17/06/2014 6:24 PM, Even Rouault wrote:
> > Le lundi 16 juin 2014 14:20:59, Timothy Astle a ?crit :
> >> Hi all,
> >> 
> >> Does anyone know why CPLEscapeString
> >> (https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character
> >> encodes characters that are valid as-is according to
> >> http://www.ietf.org/rfc/rfc1738.txt?
> >> 
> >> I just hit a situation where I noticed the WMS driver is converting
> >> hyphens to %2D for layer names.  The 3rd party server doesn't handle it
> >> (but it should) and this caught my attention.
> >> 
> >> Any thoughts?  Is it just a case where a patch would be welcome?
> > 
> > Tim,
> > 
> > What would your patch do ? Implement the following from RFC1738 ? :
> > 
> > "Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
> > reserved characters used for their reserved purposes may be used
> > unencoded within a URL."
> > 
> > Well, actually I think it should still encode the reserved characters
> > (";",
> > 
> >   "/", "?", ":", "@", "=" and "&"), since valid use cases of
> >   CPLEscapeString(,
> > 
> > CPLES_URL) might be do make sure that they are encoded.
> > 
> > Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From andrea.aime at geo-solutions.it  Wed Jun 18 09:35:49 2014
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Wed, 18 Jun 2014 18:35:49 +0200
Subject: [gdal-dev] Geotiff nodata handling
Message-ID: <CA+nxMTsJShQHdq7XjOcTbx+2+EBzatLKNmQSTZy3CGxR+DDyYg@mail.gmail.com>

Hi,
I'm trying to wrap my head around how gdal handles nodata values.
In an image with this gdalinfo exceprt:

Band 1 Block=512x512 Type=Byte, ColorInterp=Red
  NoData Value=0
Band 2 Block=512x512 Type=Byte, ColorInterp=Green
  NoData Value=0
Band 3 Block=512x512 Type=Byte, ColorInterp=Blue
  NoData Value=0

and using software based on gdal (e.g. qgis), it seems that a pixel is
considered
nodata if any of the three pixel bands are zero (even just one).

I could swear I saw some gdal specific way to embed metadata
saying "if all three bands are zero, then the pixel is nodata"
(pull pixel as opposed band per band treatment), but I cannot
find it anymore.

Did I imagine it? If existing, do you have a feeling of how well
supported that is in common software?

Cheers
Andrea

-- 
==
GeoServer Professional Services from the experts! Visit
http://goo.gl/NWWaa2 for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via Poggio alle Viti 1187
55054  Massarosa (LU)
Italy
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

-------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/a60ced15/attachment.html>

From jan.heckman at gmail.com  Wed Jun 18 09:44:17 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 18 Jun 2014 18:44:17 +0200
Subject: [gdal-dev] SBN shapefile indexing
Message-ID: <CAKMUAtD=BiurseB0JM0Dryy2UdMK4h8LLU0JFCMD1mPCvB4MnA@mail.gmail.com>

Hi all,

Starting from https://github.com/drwelby/hasbeen I've implemented an SBN
shapefile indexing routine in C++. I'm happy, so far, with the results;
I've used it for a few weeks now.
With some work it could be integrated into OGR.
Question is, how much interest, considering pros and cons of my
implementation?

On the plus side:
- except for occasional differences in the promotion level of lonely
features (see hasbeen), the results are identical to Esri. Differences do
not result in any features/shape being 'lost' or invisible. Achieves
identical results in the 'block_groups' shape example (see also
spatial_Idx_kit.zip
<https://code.google.com/p/pyshp/downloads/detail?name=spatial_idx_kit.zip&can=2&q=>).
though.
- Esri AG can use the indexes, as well as SBNsearch.
- Fast.
- produces .sbx on request.

On the minus side:
- uses a lambda function, so limits compilerchoice
- compiled with VS2013, VS2012 probably is ok, too, no other compilers
tried, but there's no ms or intel specific or exotic stuff, really.
- uses exceptions (at least from constructor).
- uses a simple template (internally).
- very frustrating I cannot achieve complete identity in spite of some
(serious) trying.
- relies now on a tweaked version of SHPReadObject() which avoids reading
the vertices (just extents and ID).
- not a single thought about M and Z features (may or may not be relevant).
- has not been tested exhaustively.
- have not written a function to maintain an index structure during
editing. Doing so will certainly require work.

Please let me know whether being able to (SBN)index shapefiles from OGR,
even though the resulting indexfiles may differ slightly, is an attractive
prospect.

Jan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/37f91fd9/attachment.html>

From tastle at caris.com  Wed Jun 18 10:02:04 2014
From: tastle at caris.com (Timothy Astle)
Date: Wed, 18 Jun 2014 14:02:04 -0300
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
 need to be encoded
In-Reply-To: <201406181518.55614.even.rouault@mines-paris.org>
References: <539EE12B.3070800@caris.com>
	<201406172324.20899.even.rouault@mines-paris.org>
	<53A18A73.9030209@caris.com>
	<201406181518.55614.even.rouault@mines-paris.org>
Message-ID: <53A1C60C.1090408@caris.com>

Yes, that could be possible.

Aweb server should try to URL decode anything that has been encoded, 
that is, any %xx token.

But I have hit one server that doesn't do this, and that's why I'm here. 
It doesn't seem to be doing any decoding. :(


Tim


On 18/06/2014 10:18 AM, Even Rouault wrote:
> Le mercredi 18 juin 2014 14:47:47, Timothy Astle a ?crit :
>> I was thinking something like the following:
>>
>>                if( (pszInput[iIn] >= 'a' && pszInput[iIn] <= 'z')
>>
>>                    || (pszInput[iIn] >= 'A' && pszInput[iIn] <= 'Z')
>>                    || (pszInput[iIn] >= '0' && pszInput[iIn] <= '9')
>>
>> -                || pszInput[iIn] == '_' || pszInput[iIn] == '.' )
>> +                || pszInput[iIn] == '$' && pszInput[iIn] == '-'
>> +                || pszInput[iIn] == '_' || pszInput[iIn] == '.'
>> +                || pszInput[iIn] == '+' && pszInput[iIn] == '!'
>> +                || pszInput[iIn] == '*' && pszInput[iIn] == '\''
>> +                || pszInput[iIn] == '(' && pszInput[iIn] == ')'
>> +                || pszInput[iIn] == '"' && pszInput[iIn] == ',' )
>>
>> which follows the list of special characters that may be used unencoded
>> within a URL.
>>
>>      Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
>>      reserved characters used for their reserved purposes may be used
>>      unencoded within a URL.
>>
>> That list is mutually exclusive from the list you cited as being a
>> concern, which I agree with.
> Looks reasonable, although I anticipate we might hit server bugs if changing
> that...
>
>>
>> Tim
>>
>> On 17/06/2014 6:24 PM, Even Rouault wrote:
>>> Le lundi 16 juin 2014 14:20:59, Timothy Astle a ?crit :
>>>> Hi all,
>>>>
>>>> Does anyone know why CPLEscapeString
>>>> (https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character
>>>> encodes characters that are valid as-is according to
>>>> http://www.ietf.org/rfc/rfc1738.txt?
>>>>
>>>> I just hit a situation where I noticed the WMS driver is converting
>>>> hyphens to %2D for layer names.  The 3rd party server doesn't handle it
>>>> (but it should) and this caught my attention.
>>>>
>>>> Any thoughts?  Is it just a case where a patch would be welcome?
>>> Tim,
>>>
>>> What would your patch do ? Implement the following from RFC1738 ? :
>>>
>>> "Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
>>> reserved characters used for their reserved purposes may be used
>>> unencoded within a URL."
>>>
>>> Well, actually I think it should still encode the reserved characters
>>> (";",
>>>
>>>    "/", "?", ":", "@", "=" and "&"), since valid use cases of
>>>    CPLEscapeString(,
>>>
>>> CPLES_URL) might be do make sure that they are encoded.
>>>
>>> Even

-- 
Tim Astle
Development Manager
Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/dd5c4a01/attachment.html>

From even.rouault at mines-paris.org  Wed Jun 18 10:14:05 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 18 Jun 2014 19:14:05 +0200
Subject: [gdal-dev] Geotiff nodata handling
In-Reply-To: <CA+nxMTsJShQHdq7XjOcTbx+2+EBzatLKNmQSTZy3CGxR+DDyYg@mail.gmail.com>
References: <CA+nxMTsJShQHdq7XjOcTbx+2+EBzatLKNmQSTZy3CGxR+DDyYg@mail.gmail.com>
Message-ID: <201406181914.05787.even.rouault@mines-paris.org>

Le mercredi 18 juin 2014 18:35:49, Andrea Aime a ?crit :
> Hi,
> I'm trying to wrap my head around how gdal handles nodata values.
> In an image with this gdalinfo exceprt:
> 
> Band 1 Block=512x512 Type=Byte, ColorInterp=Red
>   NoData Value=0
> Band 2 Block=512x512 Type=Byte, ColorInterp=Green
>   NoData Value=0
> Band 3 Block=512x512 Type=Byte, ColorInterp=Blue
>   NoData Value=0
> 
> and using software based on gdal (e.g. qgis), it seems that a pixel is
> considered
> nodata if any of the three pixel bands are zero (even just one).
> 
> I could swear I saw some gdal specific way to embed metadata
> saying "if all three bands are zero, then the pixel is nodata"
> (pull pixel as opposed band per band treatment), but I cannot
> find it anymore.
> 
> Did I imagine it? If existing, do you have a feeling of how well
> supported that is in common software?

This is a rather tricky area indeed.

A few facts :
- The concept of nodata value in GDAL is something per band, which leave 
multi-band processing of nodata values subject to interpretation.
- The TIFFTAG_GDAL_NODATA extension tag in TIFF only holds one nodata value 
for all bands.
- In gdalwarp utility, the warping option UNIFIED_SRC_NODATA is set to YES, 
which means that a pixel is considered to be transparent if all bands hit 
their respective nodata value (what you want here).
- In gdaladdo, similar behaviour will be found if the dataset has a 
NODATA_VALUES metadata item set to "0 0 0" for example, which makes an 
implicit mask band of type GDALNoDataValuesMaskBand to be generated and 
honoured. This metadata item is only set by the PNG driver for now. With VRT, 
the metadata item could be also set for other datasets.

I guess QGIS only look band per band. A reliable way of solving this would be 
to generate a RGBA dataset instead.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Wed Jun 18 10:48:56 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Wed, 18 Jun 2014 19:48:56 +0200
Subject: [gdal-dev] SBN shapefile indexing
In-Reply-To: <CAKMUAtD=BiurseB0JM0Dryy2UdMK4h8LLU0JFCMD1mPCvB4MnA@mail.gmail.com>
References: <CAKMUAtD=BiurseB0JM0Dryy2UdMK4h8LLU0JFCMD1mPCvB4MnA@mail.gmail.com>
Message-ID: <201406181948.56753.even.rouault@mines-paris.org>

Le mercredi 18 juin 2014 18:44:17, Jan Heckman a ?crit :
> Hi all,
> 
> Starting from https://github.com/drwelby/hasbeen I've implemented an SBN
> shapefile indexing routine in C++. I'm happy, so far, with the results;
> I've used it for a few weeks now.
> With some work it could be integrated into OGR.
> Question is, how much interest, considering pros and cons of my
> implementation?
> 
> On the plus side:
> - except for occasional differences in the promotion level of lonely
> features (see hasbeen), the results are identical to Esri. Differences do
> not result in any features/shape being 'lost' or invisible. Achieves
> identical results in the 'block_groups' shape example (see also
> spatial_Idx_kit.zip
> <https://code.google.com/p/pyshp/downloads/detail?name=spatial_idx_kit.zip&
> can=2&q=>). though.
> - Esri AG can use the indexes, as well as SBNsearch.
> - Fast.
> - produces .sbx on request.
> 
> On the minus side:
> - uses a lambda function, so limits compilerchoice

It would be best if we can avoid too fancy C++ features like that one (within 
GDAL code, anything more complicated than simple templates is fancy)

> - compiled with VS2013, VS2012 probably is ok, too, no other compilers
> tried, but there's no ms or intel specific or exotic stuff, really.

We currently support compilers at least down to VC 7.1 (2003) and GCC 4.4.

> - uses exceptions (at least from constructor).

If exceptions are thrown, they should be caught somewhere within GDAL since it 
is callable from C. But ideally the code should go to shapelib which is C 
only, although it might be OK to keep C++ and GDAL only

> - uses a simple template (internally).
> - very frustrating I cannot achieve complete identity in spite of some
> (serious) trying.

What do you mean ?

> - relies now on a tweaked version of SHPReadObject() which avoids reading
> the vertices (just extents and ID).

We want to keep the signature and behaviour of SHPReadObject() unchanged. So 
perhaps add a variant function for your behaviour : SHPReadObjectExtent() ? 
(possibly original SHPReadObject() and SHPReadObjectExtent() relying on an 
internal unique function)

> - not a single thought about M and Z features (may or may not be relevant).

SBN indexing is 2D only, or isn't it ?

> - has not been tested exhaustively.
> - have not written a function to maintain an index structure during
> editing. Doing so will certainly require work.

It might be OK to rebuild completely the index when editing a shapefile.

> 
> Please let me know whether being able to (SBN)index shapefiles from OGR,

We might want to have a special SQL syntax to explicitely require .sbn 
building. Something like
"CREATE SPATIAL INDEX ON foo ALGORITHM SBN"

> even though the resulting indexfiles may differ slightly, is an attractive
> prospect.
> 
> Jan

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From andre+joost at nurfuerspam.de  Wed Jun 18 12:25:48 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 18 Jun 2014 21:25:48 +0200
Subject: [gdal-dev] gdal2tiles from vrt with unexpected result
In-Reply-To: <1403019034877-5146324.post@n6.nabble.com>
References: <CAA-8Ld_0pw99KBue7NtqXzQQ++y5acyotxEqjEEyJrRgBS3LdA@mail.gmail.com>
	<lnoe8l$idl$1@ger.gmane.org>
	<1403019034877-5146324.post@n6.nabble.com>
Message-ID: <lnsq8g$r3g$1@ger.gmane.org>

Am 17.06.2014 17:30, schrieb klo:
> VRT extend is approximately this:
>
> ulx, uly = (7436881, 4707326)
> lrx, lry = (7687838, 4511902)
>

Not sure if it helps you, but I just solved a similar issue here:

<http://gis.stackexchange.com/questions/88305/gdal2tiles-generates-small-picture-inside-256x256-tile>

I assume that gdal2tiles does not like -z and -p raster together.

This one has the same problem, with another solution:

<http://gis.stackexchange.com/questions/14761/gdal2tiles-problem>

HTH,
Andr? Joost


From jan.heckman at gmail.com  Wed Jun 18 14:05:05 2014
From: jan.heckman at gmail.com (Jan Heckman)
Date: Wed, 18 Jun 2014 23:05:05 +0200
Subject: [gdal-dev] SBN shapefile indexing
In-Reply-To: <201406181948.56753.even.rouault@mines-paris.org>
References: <CAKMUAtD=BiurseB0JM0Dryy2UdMK4h8LLU0JFCMD1mPCvB4MnA@mail.gmail.com>
	<201406181948.56753.even.rouault@mines-paris.org>
Message-ID: <CAKMUAtCF=YcW7ipcyiEY3FCBu2pCtbbQgwLKrGZyhpuwb8gONQ@mail.gmail.com>

Hi Even,

C/C++:
- lambda can probably be avoided by a (recursive) function and some
additional parameter passing.
- SBNIndex() uses a class internally. Only the function (SBNIndex()) is
exported. So I hope to retain this to avoid reprogramming.
 - exception(s) can be caught internally.
- I use std::vector which should be ok with VS7.1 (
http://msdn.microsoft.com/en-us/library/9xd04bzs(v=vs.71).aspx), gcc 4 (
https://gcc.gnu.org/onlinedocs/gcc-4.6.2/libstdc++/api/a00739.html) and
sort(). Vector can be rewritten to dynamic arrays and qsort(), but I don't
really want to.

- 'What do you mean': I meant the .sbn files created by my implementation
differ occasionally from the .sbn files Esri produces. Esri integrates bins
with few features with bins higher up in the tree, to some degree. The
differences I'm talking about are that in some cases features in my index
are 'pulled up' somewhat higher than Esri does. I cannot quite infer the
rules Esri follows in this. However, since the SBNSearch() routines follow
the tree, the features will be found; the consequences for index-efficiency
are a little hard to predict. Basically, there is a balance between bins
with a few features which may have a larger extent (for the entire bin), vs
bins with many features which should have a narrow extent. I expect the
efficiency difference to be marginal or unnoticeable.
- SBN 2D: As far as I know it's strictly 2D, but I've never found proof of
this, have to check Esri SBN index of an ZM shapefile.
- SHPReadObjectExtent() can be done by some easy copying and pasting from
SHPReadObject. We/you might consider using the new function in
SHPReadObject() for economy, but it would not be a big deal, since this
code is unlikely to change.

So, I can adapt my implementation, retaining C++ internally (class,
template, exceptions, std::vector and sort()) and exporting SBNIndex() as a
__cdecl/SHPAPI_CALL as if pure C; and implement SHPReadObjectExtent(), for
the time being within SBNIndex.cpp.

SBNIndex() would be called with the shapefilename (with or without
extension) and the shapefile would be assumed to be closed; an error when
opening the shape for (non-shared) reading would be returned to the caller.

Maybe I should add a searchroutine which just returns the (fid's of)
features in a specific bin to facilitate testing.

Jan

On Wed, Jun 18, 2014 at 7:48 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le mercredi 18 juin 2014 18:44:17, Jan Heckman a ?crit :
> > Hi all,
> >
> > Starting from https://github.com/drwelby/hasbeen I've implemented an SBN
> > shapefile indexing routine in C++. I'm happy, so far, with the results;
> > I've used it for a few weeks now.
> > With some work it could be integrated into OGR.
> > Question is, how much interest, considering pros and cons of my
> > implementation?
> >
> > On the plus side:
> > - except for occasional differences in the promotion level of lonely
> > features (see hasbeen), the results are identical to Esri. Differences do
> > not result in any features/shape being 'lost' or invisible. Achieves
> > identical results in the 'block_groups' shape example (see also
> > spatial_Idx_kit.zip
> > <
> https://code.google.com/p/pyshp/downloads/detail?name=spatial_idx_kit.zip&
> > can=2&q=>). though.
> > - Esri AG can use the indexes, as well as SBNsearch.
> > - Fast.
> > - produces .sbx on request.
> >
> > On the minus side:
> > - uses a lambda function, so limits compilerchoice
>
> It would be best if we can avoid too fancy C++ features like that one
> (within
> GDAL code, anything more complicated than simple templates is fancy)
>
> > - compiled with VS2013, VS2012 probably is ok, too, no other compilers
> > tried, but there's no ms or intel specific or exotic stuff, really.
>
> We currently support compilers at least down to VC 7.1 (2003) and GCC 4.4.
>
> > - uses exceptions (at least from constructor).
>
> If exceptions are thrown, they should be caught somewhere within GDAL
> since it
> is callable from C. But ideally the code should go to shapelib which is C
> only, although it might be OK to keep C++ and GDAL only
>
> > - uses a simple template (internally).
> > - very frustrating I cannot achieve complete identity in spite of some
> > (serious) trying.
>
> What do you mean ?
>
> > - relies now on a tweaked version of SHPReadObject() which avoids reading
> > the vertices (just extents and ID).
>
> We want to keep the signature and behaviour of SHPReadObject() unchanged.
> So
> perhaps add a variant function for your behaviour : SHPReadObjectExtent() ?
> (possibly original SHPReadObject() and SHPReadObjectExtent() relying on an
> internal unique function)
>
> > - not a single thought about M and Z features (may or may not be
> relevant).
>
> SBN indexing is 2D only, or isn't it ?
>
> > - has not been tested exhaustively.
> > - have not written a function to maintain an index structure during
> > editing. Doing so will certainly require work.
>
> It might be OK to rebuild completely the index when editing a shapefile.
>
> >
> > Please let me know whether being able to (SBN)index shapefiles from OGR,
>
> We might want to have a special SQL syntax to explicitely require .sbn
> building. Something like
> "CREATE SPATIAL INDEX ON foo ALGORITHM SBN"
>
> > even though the resulting indexfiles may differ slightly, is an
> attractive
> > prospect.
> >
> > Jan
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140618/31290791/attachment.html>

From patdevelop at gmail.com  Wed Jun 18 21:45:18 2014
From: patdevelop at gmail.com (Patrick Sunter)
Date: Thu, 19 Jun 2014 14:45:18 +1000
Subject: [gdal-dev] Fwd: gdal_calc.py not saving correct statistics
 (min/max) to new rasters in some cases?
In-Reply-To: <CALOKYXW8N63n06DX2yfVOYUei+NJH7_qrLg1isqZ0NREx4weGg@mail.gmail.com>
References: <CALOKYXW8N63n06DX2yfVOYUei+NJH7_qrLg1isqZ0NREx4weGg@mail.gmail.com>
Message-ID: <CALOKYXXGes5bDnVAqWMgsP=Wuv0sW1b3wAgnKK+_krF=Fbd=8w@mail.gmail.com>

Hi there,

I've been using gdal_calc.py as part of a workflow where I need to compute
the average of several raster files and save as a new output. (Using a
binary build of GDAL, v 1.10.0, on Mac Os X).

It is a fairly standard calc operation (e.g. "(A+B+C)/3") but because the
original data are GeoTiff's storing data in a Byte format, I first create
VRT files referencing these with data type set to be Float32, then perform
the calc operation with these VRT files as input. This is to prevent
'overflow' problems in the midst of the averaging operation given the size
limit of the Byte format (see
http://gis.stackexchange.com/questions/33152/why-do-i-get-different-results-with-gdal-calc-within-the-osgeo4w-shell-and-qgis
)

The output GeoTiff created by gdal_calc.py seems to be have correct values
at every point - but the saved statistics metadata are wrong -
specifically, the minimum value.

An example is doing a gdalinfo -stats on one of these files, I get the
following:
  Min=21.000 Max=128.000
  Minimum=21.000, Maximum=128.000, Mean=81.692, StdDev=29.397

but I know the minimum value should be 0, and this is confirmed by
inspection in QGIS. I also wrote a script to open up the raster in Python
and run the following queries:
print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
print "Hand calc. min: " + str(min(map(min, raster_values)))

I get:
GetStatistics(): [21.0, 128.0, 81.692344139650999, 29.397484687917]
ComputeRasterMinMax(): (0.0, 120.0)
Hand calc. min: 0

So you can see that ComputeRasterMinMax() is returning the right values, as
well as my manual calc using Python's min function.

As a user I presume its reasonable for the output of a   gdal_calc.py to
have latest stats stored correctly on any output it produces? So what is
going wrong?

Maybe its something to do with doing a calc on a set of VRT files using a
different type to the original. This is also a case where the output file
already exists.

Looking at the gdal_calc.py I guess a simple fix is to force an update of
statistic values using ComputeRasterMinMax() before closing the newly
created file, but maybe there is a better solution.

cheers, Patrick.

BTW example gdal_calc.py command:
gdal_calc.py -A
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_45_00-BZEV1.vrt
-B
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_50_00-BZEV1.vrt
-C
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_55_00-BZEV1.vrt
-D
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1.vrt
-E
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_05_00-BZEV1.vrt
-F
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_10_00-BZEV1.vrt
-G
./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_15_00-BZEV1.vrt
--outfile=./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1-avg7.tiff
--calc="(A+B+C+D+E+F+G)/7" --type=Byte --overwrite

And full testing script on output:
#!/usr/bin/env python
from osgeo import ogr
from osgeo import gdal

in_file="./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/CHADSTONE-22_00_00-BZEV1-avg7.tiff"

ds_in = gdal.Open(in_file)
band_in = ds_in.GetRasterBand(1)
xsize_in = band_in.XSize
ysize_in = band_in.YSize
raster_values = band_in.ReadAsArray(0, 0, xsize_in, ysize_in)

print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
print "Hand calc. min: " + str(min(map(min, raster_values)))

I can provide some sample input if needed for testing too.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140619/668e776d/attachment-0001.html>

From lhomme.xavier at gmail.com  Thu Jun 19 05:53:16 2014
From: lhomme.xavier at gmail.com (xavier lhomme)
Date: Thu, 19 Jun 2014 14:53:16 +0200
Subject: [gdal-dev] link not working
Message-ID: <CACqzBMzA2XB+ZLY0oC6obozE1Ezb36GZ+MZ_CHgVscG6FdOeSQ@mail.gmail.com>

The link ASpatial on the Geopackage page  do not work
  http://www.gdal.org/geopackage_aspatial.html

best regards
xav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140619/a27af91b/attachment.html>

From tastle at caris.com  Thu Jun 19 08:17:28 2014
From: tastle at caris.com (Timothy Astle)
Date: Thu, 19 Jun 2014 12:17:28 -0300
Subject: [gdal-dev] CPLEscapeString URL - encoding characters that don't
 need to be encoded
In-Reply-To: <53A1C60C.1090408@caris.com>
References: <539EE12B.3070800@caris.com>
	<201406172324.20899.even.rouault@mines-paris.org>
	<53A18A73.9030209@caris.com>
	<201406181518.55614.even.rouault@mines-paris.org>
	<53A1C60C.1090408@caris.com>
Message-ID: <53A2FF08.7040200@caris.com>

I've provided a patch and some context in this ticket.

http://trac.osgeo.org/gdal/ticket/5526

Thank you for your feedback!


Tim


On 18/06/2014 2:02 PM, Timothy Astle wrote:
> Yes, that could be possible.
>
> Aweb server should try to URL decode anything that has been encoded, 
> that is, any %xx token.
>
> But I have hit one server that doesn't do this, and that's why I'm 
> here. It doesn't seem to be doing any decoding. :(
>
>
> Tim
>
>
> On 18/06/2014 10:18 AM, Even Rouault wrote:
>> Le mercredi 18 juin 2014 14:47:47, Timothy Astle a ?crit :
>>> I was thinking something like the following:
>>>
>>>                if( (pszInput[iIn] >= 'a' && pszInput[iIn] <= 'z')
>>>
>>>                    || (pszInput[iIn] >= 'A' && pszInput[iIn] <= 'Z')
>>>                    || (pszInput[iIn] >= '0' && pszInput[iIn] <= '9')
>>>
>>> -                || pszInput[iIn] == '_' || pszInput[iIn] == '.' )
>>> +                || pszInput[iIn] == '$' && pszInput[iIn] == '-'
>>> +                || pszInput[iIn] == '_' || pszInput[iIn] == '.'
>>> +                || pszInput[iIn] == '+' && pszInput[iIn] == '!'
>>> +                || pszInput[iIn] == '*' && pszInput[iIn] == '\''
>>> +                || pszInput[iIn] == '(' && pszInput[iIn] == ')'
>>> +                || pszInput[iIn] == '"' && pszInput[iIn] == ',' )
>>>
>>> which follows the list of special characters that may be used unencoded
>>> within a URL.
>>>
>>>      Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
>>>      reserved characters used for their reserved purposes may be used
>>>      unencoded within a URL.
>>>
>>> That list is mutually exclusive from the list you cited as being a
>>> concern, which I agree with.
>> Looks reasonable, although I anticipate we might hit server bugs if changing
>> that...
>>
>>> Tim
>>>
>>> On 17/06/2014 6:24 PM, Even Rouault wrote:
>>>> Le lundi 16 juin 2014 14:20:59, Timothy Astle a ?crit :
>>>>> Hi all,
>>>>>
>>>>> Does anyone know why CPLEscapeString
>>>>> (https://svn.osgeo.org/gdal/trunk/gdal/port/cpl_string.cpp) character
>>>>> encodes characters that are valid as-is according to
>>>>> http://www.ietf.org/rfc/rfc1738.txt?
>>>>>
>>>>> I just hit a situation where I noticed the WMS driver is converting
>>>>> hyphens to %2D for layer names.  The 3rd party server doesn't handle it
>>>>> (but it should) and this caught my attention.
>>>>>
>>>>> Any thoughts?  Is it just a case where a patch would be welcome?
>>>> Tim,
>>>>
>>>> What would your patch do ? Implement the following from RFC1738 ? :
>>>>
>>>> "Thus, only alphanumerics, the special characters "$-_.+!*'(),", and
>>>> reserved characters used for their reserved purposes may be used
>>>> unencoded within a URL."
>>>>
>>>> Well, actually I think it should still encode the reserved characters
>>>> (";",
>>>>
>>>>    "/", "?", ":", "@", "=" and "&"), since valid use cases of
>>>>    CPLEscapeString(,
>>>>
>>>> CPLES_URL) might be do make sure that they are encoded.
>>>>
>>>> Even
>
> -- 
> Tim Astle
> Development Manager
> Web Technologies
>
> *CARIS* <http://www.caris.com>
> 115 Waggoners Lane
> Fredericton, New Brunswick
> Canada    E3B 2L4
> Tel: +1.506.458.8533     Fax: +1.506.459.3849
> www.caris.com <http://www.caris.com>
>
> *Connect with CARIS*
> Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
> <http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
> <https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
> | Google+ 
> <https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
> | YouTube <http://www.youtube.com/user/CARISGIS>
>
> Download your free copy of CARIS Easy View today!
> www.caris.com/easyview <http://www.caris.com/easyview>
>
> _________________________________________________________________________
> This email and any files transmitted with it are confidential and 
> intended only for the addressee(s). If you are not the intended 
> recipient(s) please notify us by email reply. You should not use, 
> disclose, distribute or copy this communication if received in error.
>
> Any views or opinions expressed in this email are solely those of the 
> author and do not necessarily represent those of the company. No 
> binding contract will result from this email until such time as a 
> written document is signed on behalf of the company.
>

-- 
Tim Astle
Development Manager
Web Technologies

*CARIS* <http://www.caris.com>
115 Waggoners Lane
Fredericton, New Brunswick
Canada    E3B 2L4
Tel: +1.506.458.8533     Fax: +1.506.459.3849
www.caris.com <http://www.caris.com>

*Connect with CARIS*
Twitter <http://www.twitter.com/CARIS_GIS> | LinkedIn 
<http://www.linkedin.com/groups?mostPopular=&gid=3217878> | Facebook 
<https://www.facebook.com/pages/CARIS-The-Marine-GIS-Experts/123907500987669?v=app_4949752878> 
| Google+ 
<https://plus.google.com/b/114389770462919844434/114389770462919844434/posts> 
| YouTube <http://www.youtube.com/user/CARISGIS>

Download your free copy of CARIS Easy View today!
www.caris.com/easyview <http://www.caris.com/easyview>

_________________________________________________________________________
This email and any files transmitted with it are confidential and 
intended only for the addressee(s). If you are not the intended 
recipient(s) please notify us by email reply. You should not use, 
disclose, distribute or copy this communication if received in error.

Any views or opinions expressed in this email are solely those of the 
author and do not necessarily represent those of the company. No binding 
contract will result from this email until such time as a written 
document is signed on behalf of the company.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140619/aa3edee7/attachment.html>

From aperi2007 at gmail.com  Thu Jun 19 09:10:33 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Thu, 19 Jun 2014 18:10:33 +0200
Subject: [gdal-dev] How open a subset dataset with python
Message-ID: <CABqTJk9BoFQLigeamnUEwJVkzvoF6-B1RWLjAzoQXjB8oEhpWQ@mail.gmail.com>

Hi,

I'm study-ing the option to use the python with gdal:
This are my first step on the python world.

I use this code:

driver = ogr.GetDriverByName('SQLite')
ds = driver.Open(file)
layer = ds.GetLayerByName(dataset)

But I like to open instead of a full "dataset" a subset of it as
usually do in ogr2ogr
using the two parameters:

-sql statement and the parameter "-dialect SQLITE"

is this possible in python ?

Thx to everyone,

-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From matt.gregory at oregonstate.edu  Thu Jun 19 09:01:20 2014
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Thu, 19 Jun 2014 16:01:20 +0000
Subject: [gdal-dev] PAM XSD or DTD
Message-ID: <7C48E40C135D314BA03D6471A6E389782F3D72C0@EX1.oregonstate.edu>

Hi all,

I'm trying to locate an XSD or DTD for the PAM .aux.xml files.  Does such a thing exist?  It seems that there are slight variants of the tags allowed that I'm seeing.

Sorry if this has been answered before.  My searching was futile.

thanks, matt


From aperi2007 at gmail.com  Thu Jun 19 13:05:13 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Thu, 19 Jun 2014 22:05:13 +0200
Subject: [gdal-dev] How open a subset dataset with python
In-Reply-To: <CABqTJk9BoFQLigeamnUEwJVkzvoF6-B1RWLjAzoQXjB8oEhpWQ@mail.gmail.com>
References: <CABqTJk9BoFQLigeamnUEwJVkzvoF6-B1RWLjAzoQXjB8oEhpWQ@mail.gmail.com>
Message-ID: <CABqTJk8VaFoqZsRXVf7+Ce9B2gotxYiy_Q30AYsEw4BHUBX=zg@mail.gmail.com>

Hi, resolved the quest.

the command is
layer = ds.ExecuteSQL(sqlString,None,"SQLITE")

Andrea.


2014-06-19 18:10 GMT+02:00 Andrea Peri <aperi2007 at gmail.com>:
> Hi,
>
> I'm study-ing the option to use the python with gdal:
> This are my first step on the python world.
>
> I use this code:
>
> driver = ogr.GetDriverByName('SQLite')
> ds = driver.Open(file)
> layer = ds.GetLayerByName(dataset)
>
> But I like to open instead of a full "dataset" a subset of it as
> usually do in ogr2ogr
> using the two parameters:
>
> -sql statement and the parameter "-dialect SQLITE"
>
> is this possible in python ?
>
> Thx to everyone,
>
> --
> -----------------
> Andrea Peri
> . . . . . . . . .
> qwerty ?????
> -----------------



-- 
-----------------
Andrea Peri
. . . . . . . . .
qwerty ?????
-----------------

From aileenheal at astuntechnology.com  Fri Jun 20 04:51:11 2014
From: aileenheal at astuntechnology.com (Aileen Heal)
Date: Fri, 20 Jun 2014 12:51:11 +0100
Subject: [gdal-dev] How to use TRUNCATE lco with Oracle Spatial driver
Message-ID: <CAP+1GT_pJr96tGJ8Nr5c+mmm=34AW9mn0WULG8K1sdWd9PEjUQ@mail.gmail.com>

Can any one provide an example of how to use the TRUNCATE lco for the
Oracle Spatial driver.

According to the docs.

TRUNCATE: This may be "YES" to force the existing table to be reused, but
to first truncate all records in the table, preserving indexes or
dependencies.

Which is exactly what I want, but every time I try to use it I get warnings
or errors.

e.g. First create a simple table.

ogr2ogr -overwrite -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI
OCI:xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost
user=yyyy password=yyyy" open_country -lco LAUNDER=yes -lco
GEOMETRY_NAME=GEOLOC -nln open_country3

so I tried using append with TRUNCATE lco.

ogr2ogr -append -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI
OCI::xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost
user=yyyy password=yyyy!" open_country -nln open_country3 -lco TRUNCATE=yes

which resulted in the the following
WARNING: Layer creation options ignored since an existing layer is being
appended to.

The data is appended and the table is not truncated.

So I tried this:

ogr2ogr -overwrite -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI
OCI:xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost
user=yyyy password=yyyy" open_country -lco LAUNDER=yes -lco
GEOMETRY_NAME=GEOLOC -lco TRUNCATE=yes -nln open_country3

and I get the following errors

ERROR 1: ORA-00942: table or view does not exist in TRUNCATE TABLE
"OPEN_COUNTRY3"

ERROR 1: ORA-04043: object OPEN_COUNTRY3 does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "DISPLAYNAM" VARCHAR2(150)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "POLICY_REF" VARCHAR2(100)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "LAYER_NO" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "AREA_HA" NUMBER(24,15)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "TEXT_REF" VARCHAR2(20)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "LAYER_NAME" VARCHAR2(50)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "SETTLEMENT" VARCHAR2(40)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "NO_UNITS" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "MI_STYLE" VARCHAR2(254)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "MI_PRINX" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE
OPEN_COUNTRY3 ADD "DISPLAYNAME" VARCHAR2(150)

So it appears the -overwrite is dropping the table and then trying to
truncate it hence the errors.

So I try this

ogr2ogr -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI::xxxxx/xxxx at XE
PG:"dbname=postgis active_schema=planning host=localhost user=yyyy
password=yyyy" open_country -nln open_country3 -lco TRUNCATE=yes

And I get the following.

FAILED: Layer open_country3 already exists, and -append not specified.

Consider using -append, or -overwrite.

ERROR 1: Terminating translation prematurely after failed

translation of layer open_country (use -skipfailures to skip errors)

Not sure what to try next.

TIA

-- 
 <https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140620/fb0afbea/attachment.html>

From schut at sarvision.nl  Fri Jun 20 05:56:44 2014
From: schut at sarvision.nl (Vincent Schut)
Date: Fri, 20 Jun 2014 14:56:44 +0200
Subject: [gdal-dev] OT: openev(2) alternative?
Message-ID: <53A42F8C.2060506@sarvision.nl>

Hi list,

this is a bit off topic, but I guess I'll have the biggest chance for an 
answer on this ml...

Untill now, I always succeeded in (re)building openev2, but after some 
recent system upgrades, it fails... I've used openev2 (and openev before 
that) long as my preferred raster viewer. It is blazingly fast, and has 
almost all functionality I want from a viewer. Especially an easy 
mechanism to set which bands are r,g and b, and to adjust the stretch, 
are important to me. And displaying multiple rasters on top of each 
other, being able to easily switch them on and off.

Now I'm afraid I need to look for an alternative. There once were 
rumours of an openev3, but afaik that has never really materialized?
I've tried several others (tuiview, monteverdi(2), qgis, thuban, 
otbiceviewer, ...) but none of them has the combination of being fast 
and convenient.

I just need something that is good in displaying (browsing, zooming) 
multi-band raster files. Anybody knows a viable alternative?

Thanks!
Vincent.

From Michael.Smith at erdc.dren.mil  Fri Jun 20 06:19:09 2014
From: Michael.Smith at erdc.dren.mil (Smith, Michael ERDC-RDE-CRREL-NH)
Date: Fri, 20 Jun 2014 13:19:09 +0000
Subject: [gdal-dev] [EXTERNAL] How to use TRUNCATE lco with Oracle
 Spatial driver
In-Reply-To: <CAP+1GT_pJr96tGJ8Nr5c+mmm=34AW9mn0WULG8K1sdWd9PEjUQ@mail.gmail.com>
References: <CAP+1GT_pJr96tGJ8Nr5c+mmm=34AW9mn0WULG8K1sdWd9PEjUQ@mail.gmail.com>
Message-ID: <CFC9ACBE.70117%michael.smith@erdc.dren.mil>

Aileen,

With the TRUNCATE option, do not use ?append since append will disable the use of layer creation options.

Use ogr2ogr  -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI::xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost user=yyyy password=yyyy!" open_country -nln open_country3 -lco TRUNCATE=yes

Mike

--
Michael Smith
Remote Sensing/GIS Center
US Army Corps of Engineers


From: Aileen Heal <aileenheal at astuntechnology.com<mailto:aileenheal at astuntechnology.com>>
Date: Friday, June 20, 2014 at 7:51 AM
To: "gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: [EXTERNAL] [gdal-dev] How to use TRUNCATE lco with Oracle Spatial driver
Resent-From: Michael Smith <michael.smith at usace.army.mil<mailto:michael.smith at usace.army.mil>>


Can any one provide an example of how to use the TRUNCATE lco for the Oracle Spatial driver.

According to the docs.

TRUNCATE: This may be "YES" to force the existing table to be reused, but to first truncate all records in the table, preserving indexes or dependencies.

Which is exactly what I want, but every time I try to use it I get warnings or errors.

e.g. First create a simple table.

ogr2ogr -overwrite -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI:xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost user=yyyy password=yyyy" open_country -lco LAUNDER=yes -lco GEOMETRY_NAME=GEOLOC -nln open_country3

so I tried using append with TRUNCATE lco.

ogr2ogr -append -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI::xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost user=yyyy password=yyyy!" open_country -nln open_country3 -lco TRUNCATE=yes

which resulted in the the following
WARNING: Layer creation options ignored since an existing layer is being appended to.

The data is appended and the table is not truncated.

So I tried this:

ogr2ogr -overwrite -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI:xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost user=yyyy password=yyyy" open_country -lco LAUNDER=yes -lco GEOMETRY_NAME=GEOLOC -lco TRUNCATE=yes -nln open_country3

and I get the following errors

ERROR 1: ORA-00942: table or view does not exist in TRUNCATE TABLE "OPEN_COUNTRY3"

ERROR 1: ORA-04043: object OPEN_COUNTRY3 does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-04043: object "OPEN_COUNTRY3" does not exist in OCIDescribeAny

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "DISPLAYNAM" VARCHAR2(150)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "POLICY_REF" VARCHAR2(100)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "LAYER_NO" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "AREA_HA" NUMBER(24,15)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "TEXT_REF" VARCHAR2(20)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "LAYER_NAME" VARCHAR2(50)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "SETTLEMENT" VARCHAR2(40)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "NO_UNITS" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "MI_STYLE" VARCHAR2(254)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "MI_PRINX" NUMBER(10)

ERROR 1: ORA-00942: table or view does not exist in ALTER TABLE OPEN_COUNTRY3 ADD "DISPLAYNAME" VARCHAR2(150)

So it appears the -overwrite is dropping the table and then trying to truncate it hence the errors.

So I try this

ogr2ogr -s_srs "EPSG:27700" -t_srs "EPSG:27700" -f OCI OCI::xxxxx/xxxx at XE PG:"dbname=postgis active_schema=planning host=localhost user=yyyy password=yyyy" open_country -nln open_country3 -lco TRUNCATE=yes

And I get the following.

FAILED: Layer open_country3 already exists, and -append not specified.

Consider using -append, or -overwrite.

ERROR 1: Terminating translation prematurely after failed

translation of layer open_country (use -skipfailures to skip errors)

Not sure what to try next.

TIA


[https://astuntechnology.com/media/website/images/library/supporting_badge_small.png]<https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140620/801687ca/attachment-0001.html>

From jluis at ualg.pt  Fri Jun 20 06:39:25 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 20 Jun 2014 14:39:25 +0100
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A42F8C.2060506@sarvision.nl>
References: <53A42F8C.2060506@sarvision.nl>
Message-ID: <53A4398D.5080205@ualg.pt>

If you are on Windows and 32 bits is not a (severe) limitation, I think 
Mirone (http://w3.ualg.pt/~jluis/mirone) satisfies those requisites

Joaquim

> Hi list,
>
> this is a bit off topic, but I guess I'll have the biggest chance for 
> an answer on this ml...
>
> Untill now, I always succeeded in (re)building openev2, but after some 
> recent system upgrades, it fails... I've used openev2 (and openev 
> before that) long as my preferred raster viewer. It is blazingly fast, 
> and has almost all functionality I want from a viewer. Especially an 
> easy mechanism to set which bands are r,g and b, and to adjust the 
> stretch, are important to me. And displaying multiple rasters on top 
> of each other, being able to easily switch them on and off.
>
> Now I'm afraid I need to look for an alternative. There once were 
> rumours of an openev3, but afaik that has never really materialized?
> I've tried several others (tuiview, monteverdi(2), qgis, thuban, 
> otbiceviewer, ...) but none of them has the combination of being fast 
> and convenient.
>
> I just need something that is good in displaying (browsing, zooming) 
> multi-band raster files. Anybody knows a viable alternative?
>
> Thanks!
> Vincent.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>


From schut at sarvision.nl  Fri Jun 20 06:45:12 2014
From: schut at sarvision.nl (Vincent Schut)
Date: Fri, 20 Jun 2014 15:45:12 +0200
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A4398D.5080205@ualg.pt>
References: <53A42F8C.2060506@sarvision.nl> <53A4398D.5080205@ualg.pt>
Message-ID: <53A43AE8.4040807@sarvision.nl>

On 06/20/2014 03:39 PM, Joaquim Luis wrote:
> If you are on Windows and 32 bits is not a (severe) limitation, I 
> think Mirone (http://w3.ualg.pt/~jluis/mirone) satisfies those requisites
Ah, sorry, should have mentioned that: I'm on linux (64bit). 32 bit is a 
limitation anyway, I regularly need to view very large images... Btw 
building experimental stuff is no problem.

Vincent.

>
> Joaquim
>
>> Hi list,
>>
>> this is a bit off topic, but I guess I'll have the biggest chance for 
>> an answer on this ml...
>>
>> Untill now, I always succeeded in (re)building openev2, but after 
>> some recent system upgrades, it fails... I've used openev2 (and 
>> openev before that) long as my preferred raster viewer. It is 
>> blazingly fast, and has almost all functionality I want from a 
>> viewer. Especially an easy mechanism to set which bands are r,g and 
>> b, and to adjust the stretch, are important to me. And displaying 
>> multiple rasters on top of each other, being able to easily switch 
>> them on and off.
>>
>> Now I'm afraid I need to look for an alternative. There once were 
>> rumours of an openev3, but afaik that has never really materialized?
>> I've tried several others (tuiview, monteverdi(2), qgis, thuban, 
>> otbiceviewer, ...) but none of them has the combination of being fast 
>> and convenient.
>>
>> I just need something that is good in displaying (browsing, zooming) 
>> multi-band raster files. Anybody knows a viable alternative?
>>
>> Thanks!
>> Vincent.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>


From jluis at ualg.pt  Fri Jun 20 07:03:15 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 20 Jun 2014 15:03:15 +0100
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A43AE8.4040807@sarvision.nl>
References: <53A42F8C.2060506@sarvision.nl> <53A4398D.5080205@ualg.pt>
	<53A43AE8.4040807@sarvision.nl>
Message-ID: <53A43F23.5040303@ualg.pt>

On 20-06-2014 14:45, Vincent Schut wrote:
> On 06/20/2014 03:39 PM, Joaquim Luis wrote:
>> If you are on Windows and 32 bits is not a (severe) limitation, I 
>> think Mirone (http://w3.ualg.pt/~jluis/mirone) satisfies those 
>> requisites
> Ah, sorry, should have mentioned that: I'm on linux (64bit). 32 bit is 
> a limitation anyway, I regularly need to view very large images... Btw 
> building experimental stuff is no problem.

Ah.
It can be made to work on Linux as well but than one needs Matlab (no 32 
bits restriction in that case)

>
> Vincent.
>
>>
>> Joaquim
>>
>>> Hi list,
>>>
>>> this is a bit off topic, but I guess I'll have the biggest chance 
>>> for an answer on this ml...
>>>
>>> Untill now, I always succeeded in (re)building openev2, but after 
>>> some recent system upgrades, it fails... I've used openev2 (and 
>>> openev before that) long as my preferred raster viewer. It is 
>>> blazingly fast, and has almost all functionality I want from a 
>>> viewer. Especially an easy mechanism to set which bands are r,g and 
>>> b, and to adjust the stretch, are important to me. And displaying 
>>> multiple rasters on top of each other, being able to easily switch 
>>> them on and off.
>>>
>>> Now I'm afraid I need to look for an alternative. There once were 
>>> rumours of an openev3, but afaik that has never really materialized?
>>> I've tried several others (tuiview, monteverdi(2), qgis, thuban, 
>>> otbiceviewer, ...) but none of them has the combination of being 
>>> fast and convenient.
>>>
>>> I just need something that is good in displaying (browsing, zooming) 
>>> multi-band raster files. Anybody knows a viable alternative?
>>>
>>> Thanks!
>>> Vincent.
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>
>


From schut at sarvision.nl  Fri Jun 20 07:16:53 2014
From: schut at sarvision.nl (Vincent Schut)
Date: Fri, 20 Jun 2014 16:16:53 +0200
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A43F23.5040303@ualg.pt>
References: <53A42F8C.2060506@sarvision.nl> <53A4398D.5080205@ualg.pt>
	<53A43AE8.4040807@sarvision.nl> <53A43F23.5040303@ualg.pt>
Message-ID: <53A44255.6070101@sarvision.nl>


On 06/20/2014 04:03 PM, Joaquim Luis wrote:
> On 20-06-2014 14:45, Vincent Schut wrote:
>> On 06/20/2014 03:39 PM, Joaquim Luis wrote:
>>> If you are on Windows and 32 bits is not a (severe) limitation, I 
>>> think Mirone (http://w3.ualg.pt/~jluis/mirone) satisfies those 
>>> requisites
>> Ah, sorry, should have mentioned that: I'm on linux (64bit). 32 bit 
>> is a limitation anyway, I regularly need to view very large images... 
>> Btw building experimental stuff is no problem.
>
> Ah.
> It can be made to work on Linux as well but than one needs Matlab (no 
> 32 bits restriction in that case)

Hmm, sorry, that's not going to work either... No Matlab here. Would it 
work with Octave?
I'd prefer a truly open source solution anyway, if possible. However, 
closed-source but free options are also considered.

>
>>
>> Vincent.
>>
>>>
>>> Joaquim
>>>
>>>> Hi list,
>>>>
>>>> this is a bit off topic, but I guess I'll have the biggest chance 
>>>> for an answer on this ml...
>>>>
>>>> Untill now, I always succeeded in (re)building openev2, but after 
>>>> some recent system upgrades, it fails... I've used openev2 (and 
>>>> openev before that) long as my preferred raster viewer. It is 
>>>> blazingly fast, and has almost all functionality I want from a 
>>>> viewer. Especially an easy mechanism to set which bands are r,g and 
>>>> b, and to adjust the stretch, are important to me. And displaying 
>>>> multiple rasters on top of each other, being able to easily switch 
>>>> them on and off.
>>>>
>>>> Now I'm afraid I need to look for an alternative. There once were 
>>>> rumours of an openev3, but afaik that has never really materialized?
>>>> I've tried several others (tuiview, monteverdi(2), qgis, thuban, 
>>>> otbiceviewer, ...) but none of them has the combination of being 
>>>> fast and convenient.
>>>>
>>>> I just need something that is good in displaying (browsing, 
>>>> zooming) multi-band raster files. Anybody knows a viable alternative?
>>>>
>>>> Thanks!
>>>> Vincent.
>>>> _______________________________________________
>>>> gdal-dev mailing list
>>>> gdal-dev at lists.osgeo.org
>>>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>
>>>
>>
>>
>


From jluis at ualg.pt  Fri Jun 20 07:42:18 2014
From: jluis at ualg.pt (Joaquim Luis)
Date: Fri, 20 Jun 2014 15:42:18 +0100
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A44255.6070101@sarvision.nl>
References: <53A42F8C.2060506@sarvision.nl> <53A4398D.5080205@ualg.pt>
	<53A43AE8.4040807@sarvision.nl> <53A43F23.5040303@ualg.pt>
	<53A44255.6070101@sarvision.nl>
Message-ID: <53A4484A.1010303@ualg.pt>

On 20-06-2014 15:16, Vincent Schut wrote:
>
> On 06/20/2014 04:03 PM, Joaquim Luis wrote:
>> On 20-06-2014 14:45, Vincent Schut wrote:
>>> On 06/20/2014 03:39 PM, Joaquim Luis wrote:
>>>> If you are on Windows and 32 bits is not a (severe) limitation, I 
>>>> think Mirone (http://w3.ualg.pt/~jluis/mirone) satisfies those 
>>>> requisites
>>> Ah, sorry, should have mentioned that: I'm on linux (64bit). 32 bit 
>>> is a limitation anyway, I regularly need to view very large 
>>> images... Btw building experimental stuff is no problem.
>>
>> Ah.
>> It can be made to work on Linux as well but than one needs Matlab (no 
>> 32 bits restriction in that case)
>

> Hmm, sorry, that's not going to work either... No Matlab here. Would 
> it work with Octave?
> I'd prefer a truly open source solution anyway, if possible. However, 
> closed-source but free options are also considered.

Nope. Octave is too primitive and end of the line.
I prefer open source too ... when I'm able to make it work with it. Will 
hopefully work one day with Julia (already started playing with the very 
first steps)



From gusevmihs at gmail.com  Fri Jun 20 17:05:08 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 21 Jun 2014 04:05:08 +0400
Subject: [gdal-dev] GSoC weekly report 5. GDAL Networking
Message-ID: <CAJB43VpHvPPbW+fMkWsX+9ifQ8UV7Z2+f+1qF+aBSVLYiyH7TQ@mail.gmail.com>

Hello everyone.
During this week I have successfully built GDAL from source, now 2.0dev,
and already integrate and test several main GNM API methods from an old API
directly into GDAL library (my fork). See my blog post, please:
http://gsoc2014gnm.blogspot.ru/2014/06/week-3-and-4.html. The plans for the
next week stay the same. As I intended I plan to finish moving old methods
to the new API up to first midterm. And finally, I've successfully defended
my Master's thesis on this week, so I will have much more time and fully
concentrate on GSoC now.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140621/a7d52c51/attachment.html>

From varunsaraf14 at gmail.com  Sat Jun 21 07:18:45 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Sat, 21 Jun 2014 19:48:45 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 5 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rtBRunYcEdNUyvyumQ=O8PE2g1P8zxtcNffVzDgwWb=oQ@mail.gmail.com>

Hi,

Below is my fifth weekly report:

*What did I do this week?*

   - Made some modifications to the already written code.
   - Worked on the method for creating overviews and writing them to table.

*What do I plan on doing next week?*

   -
   - Modify IRaterIO method to be able to call different methods depending
   on the query to be executed.
   - Fill out the midterm evaluations questionnaire.

*Am I blocked on anything?*

   - No.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-5
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140621/3d7cc508/attachment.html>

From smilingmolecule at web.de  Sat Jun 21 09:10:38 2014
From: smilingmolecule at web.de (Robert Grah)
Date: Sat, 21 Jun 2014 09:10:38 -0700
Subject: [gdal-dev] gdal contour as transparent png/tif or svg/eps/pdf
Message-ID: <146bf285939.-4577694206278287407.5027848028187452311@web.de>

Hey there,

im trying to get a contour out of an GeoTiff file as transparent PNG or TIFF or even better as PDF/SVG or EPS file in my C++ program.
I found gdal_contour but was not able to get PDF driver running. 
How can I install more drivers to GDAL?

So my approach so far is like following:

gdal_contour -i 50 mygeotiff.tif contour
gdal_rasterize -burn 0 -l contour contour mygeotiff.tif

But with this I am not able to get a transparent contour.
Is there a different approach beside the command line utils to get contours in vectorformat or transparent png/tif out of the geoTiff?
It would be also great to add some anti-aliasing ;)...

Cheers,
Rob




From smilingmolecule at web.de  Sat Jun 21 09:00:04 2014
From: smilingmolecule at web.de (Robert Grah)
Date: Sat, 21 Jun 2014 09:00:04 -0700
Subject: [gdal-dev] read whole elevation data from geotif to vector[x][y]
In-Reply-To: <CAOHgSmj0nYCKKRX_y9jED_L+piSNkk2-GVmK3TWF3p2YmLLeSw@mail.gmail.com>
References: <CAOHgSmj0nYCKKRX_y9jED_L+piSNkk2-GVmK3TWF3p2YmLLeSw@mail.gmail.com>
Message-ID: <146bf27f0d4.-9181177982524324114.-5272607883063379466@web.de>

Hi Peb,

thanks for the hint. Thats really simple. Maybe i need this in the future.

Cheers,
Rob

---- Ein Mi, 18 Jun 2014 05:20:21 -0700 peb aryan <peb.aryan at student.tuwien.ac.at> hat geschrieben ---- 

>Hi Robert,?
>
>if you use opencv there is an easy way to pass buffer from RasterIO to a cv::Mat
>
>double *padRasterData = (double*)CPLMalloc(iGridsizeX*iGridsizeY*sizeof(double));
> 
>
>h_dataset->RasterIO(GF_Read, 0, 0, iGridsizeX, iGridsizeY, padRasterData, iGridsizeX, iGridsizeY, GDT_Float64, 1,NULL,0,0,0);
>
>
>cv::Mat img = cv::Mat(iGridsizeY, iGridsizeX, CV_64F, &padRasterData[0]);
> 
>
>
>...
>
>
>CPLFree( padRasterData );
>
>
>
>cheers,
>
>
>peb
>
>
>
>On Tue, Jun 17, 2014 at 8:56 PM, Robert Grah <smilingmolecule at web.de> wrote:
> Hallo,
> 
> i think this question is somehow a bit stupid but I have to ask it anyway because i can not find a good working solution.
> I try to read the whole elevation data from a band of a GeoTiff image into a c++ 2d vector so that I can read the values like vector[x][y].
> I also like to convert the data to an image and perform other operations.
> 
> I tried it like this, but this gives me the data in a strange order:
> 
> poBand->RasterIO( GF_Read, 0, 0, nXSize, nYSize,
> ?pafScanline2, nXSize, nYSize, GDT_Float32,
> ?0, 0 );
> ?int totalCount = 0;
> ?for (int i = 0; i GetXSize(); i++){
> 
> ?vector yVal;
> ?for (int j = 0; j GetYSize(); j++){
> ?yVal.push_back(pafScanline2[totalCount]);
> ?totalCount++;
> ?}
> ?altData.push_back(yVal);
> ?}
> 
> 
> I also tried to read every single value step by step, but this was really slow.
> Is there an easy way to get the values ordered like the pixels of an image?
> From left to right and top to bottom? I think i am overlooking something...
> 
> Cheers,
> Robert
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
>
>
>


From JPalmer at linz.govt.nz  Sun Jun 22 18:32:32 2014
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Mon, 23 Jun 2014 13:32:32 +1200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
Message-ID: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>

I'm querying an ArcGIS service obtain polygon data, however the service seems to define Island multi-polygons objects as single polygons with multiple exterior rings. This creates invalid OGC geometries and is causing processing problems in my workflow.

He's the service and a validation test showing the polygon is not valid:

ogrinfo -dialect sqlite -sql "SELECT TA2013_V1_00_NAME, ST_IsValid(GEOMETRY) FROM OGRGeoJSON" http://maps.stats.govt.nz/wss/service/arcgis1/guest/Boundaries/2013_Geographies/MapServer/9/query?f=json&objectIds=36&returnGeometry=true&outSR=4167

GEOS warning: Hole lies outside shell at or near point 174.78189611685229 -41.077770200471164

Layer name: SELECT
Geometry: None
Feature Count: 1
Layer SRS WKT:
(unknown)
TA2013_V1_00_NAME: String (0.0)
ST_IsValid(GEOMETRY): Integer (0.0)
OGRFeature(SELECT):0
  TA2013_V1_00_NAME (String) = Porirua City
  ST_IsValid(GEOMETRY) (Integer) = 0

Is this a bug in the data from the service, or just the way the Esri defines geometry objects (and therefor an OGR bug)? I can't see a definition for multi-polygons in Esri API docs:

http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000n1000000

Cheers,

Jeremy Palmer
LINZ Data Service Manager
Landonline & Geospatial Services

E  jpalmer at linz.govt.nz | DDI +64 4 498 3537 | M +64 27 2747 862

Wellington Office, Level 7, Radio New Zealand House, 155 The Terrace
PO Box 5501, Wellington 6145, New Zealand | T 04 460 0110
W  www.linz.govt.nz<http://www.linz.govt.nz/> | www.landonline.govt.nz<http://www.landonline.govt.nz/> | data.linz.govt.nz<http://www.data.linz.govt.nz/>
[cid:image001.png at 01CF8EE6.FCAD45B0]


________________________________
This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140623/74224afa/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 10101 bytes
Desc: image001.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140623/74224afa/attachment-0001.png>

From jukka.rahkonen at mmmtike.fi  Mon Jun 23 01:02:24 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 23 Jun 2014 08:02:24 +0000 (UTC)
Subject: [gdal-dev] Geotiff nodata handling
References: <CA+nxMTsJShQHdq7XjOcTbx+2+EBzatLKNmQSTZy3CGxR+DDyYg@mail.gmail.com>
	<201406181914.05787.even.rouault@mines-paris.org>
Message-ID: <loom.20140623T094357-559@post.gmane.org>

Even Rouault <even.rouault <at> mines-paris.org> writes:

> This is a rather tricky area indeed.
> 
> A few facts :
> - The concept of nodata value in GDAL is something per band, which leave 
> multi-band processing of nodata values subject to interpretation.
> - The TIFFTAG_GDAL_NODATA extension tag in TIFF only holds one nodata value 
> for all bands.
> - In gdalwarp utility, the warping option UNIFIED_SRC_NODATA is set to YES, 
> which means that a pixel is considered to be transparent if all bands hit 
> their respective nodata value (what you want here).
> - In gdaladdo, similar behaviour will be found if the dataset has a 
> NODATA_VALUES metadata item set to "0 0 0" for example, which makes an 
> implicit mask band of type GDALNoDataValuesMaskBand to be generated and 
> honoured. This metadata item is only set by the PNG driver for now. With VRT, 
> the metadata item could be also set for other datasets.
> 
> I guess QGIS only look band per band. A reliable way of solving this would be 
> to generate a RGBA dataset instead.

Just a word from my own experience: typical same-for-all-bands nodata values
 0 0 0 and 255 255 255 tend to burn holes into aerial and satellite images
within water bodies (black, more common) or on dry, light soils or
reflective areas like tin roofs (white, not as common). Something like pure
blue 0 0 255 occurs never in natural images and therefore would suit
perfectly as a nodata value in theory. I had once a whole bunch of such
images before I learned that many programs could not handle the transparency
and I had to reprocess them to 0 0 0. 

-Jukka Rahkonen-


From mateusz at loskot.net  Mon Jun 23 01:17:44 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Mon, 23 Jun 2014 10:17:44 +0200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>

On 23 June 2014 03:32, Jeremy Palmer <JPalmer at linz.govt.nz> wrote:
>
> Is this a bug in the data from the service, or just the way the Esri defines geometry objects (and therefor an OGR bug)?

AFAIU, this is not a bug in OGR, but OGR GeoJSON drivers works with
GeoJSON format
whereas JSON produced by ESRI is a different format, not GeoJSON.


> I can?t see a definition for multi-polygons in Esri API docs:
>
> http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000n1000000

Can you?
There is no geometry of multipolygon specified.
AFAIU, for multipolygon ESRI REST produces a hybrid: a Polygon that
contains detached rings
(or rings not in other rings, so they are not holes) and that is
interpreted as multipolygon.

Fun.

Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From jukka.rahkonen at mmmtike.fi  Mon Jun 23 01:25:48 2014
From: jukka.rahkonen at mmmtike.fi (Jukka Rahkonen)
Date: Mon, 23 Jun 2014 08:25:48 +0000 (UTC)
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>
Message-ID: <loom.20140623T102131-807@post.gmane.org>

Mateusz ?oskot <mateusz <at> loskot.net> writes:

> 
> On 23 June 2014 03:32, Jeremy Palmer <JPalmer <at> linz.govt.nz> wrote:
> >
> > Is this a bug in the data from the service, or just the way the Esri
defines geometry objects (and therefor an
> OGR bug)?
> 
> AFAIU, this is not a bug in OGR, but OGR GeoJSON drivers works with
> GeoJSON format
> whereas JSON produced by ESRI is a different format, not GeoJSON.
> 
> > I can?t see a definition for multi-polygons in Esri API docs:
> >
> >
http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000n1000000
> 
> Can you?
> There is no geometry of multipolygon specified.
> AFAIU, for multipolygon ESRI REST produces a hybrid: a Polygon that
> contains detached rings
> (or rings not in other rings, so they are not holes) and that is
> interpreted as multipolygon.
> 
> Fun.

Based on
http://help.arcgis.com/en/webapi/flex/apiref/com/esri/ags/geometry/Polygon.html
when geometries are built the ring is first added and by doing "Contais"
ESRI decides if the ring is a hole or another outer ring.

-Jukka Rahkonen-










From oliver.eichler at gmx.de  Mon Jun 23 02:49:58 2014
From: oliver.eichler at gmx.de (Oliver Eichler)
Date: Mon, 23 Jun 2014 11:49:58 +0200
Subject: [gdal-dev] Reproject raster map in buffer on-the-fly
Message-ID: <trinity-b705f47c-1089-4198-a466-5699ad929cdb-1403516990901@3capp-gmx-bs03>

Hi 

I would like to read a region of a raster map and re-project the resulting image on-the-fly before it is displayed. I had a look at the GDAL Warp API tutorial. And I stumbled across GDALWarpRegionToBuffer() while reading the header files. I had a look into the setup functions and found quite a variety of GDALCreateGenImgProjTransformer1..3() or GDALCreateReprojectionTransformer(). I have to admit that whole stuff leaves me a bit clueless.

Thus my question: 

Is there a tutorial or an open source project that does the same I want to do (I parsed the code of QGis without success)?

Or can someone tell me the correct API calls needed to do a re-projection on-the-fly. I think knowing what function sequence to use is already a big step forward for me.

Thanks

Oliver

From JPalmer at linz.govt.nz  Mon Jun 23 10:46:40 2014
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Tue, 24 Jun 2014 05:46:40 +1200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <loom.20140623T102131-807@post.gmane.org>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>,
	<loom.20140623T102131-807@post.gmane.org>
Message-ID: <C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>

http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000n1000000
>
> Can you?
> There is no geometry of multipolygon specified.
> AFAIU, for multipolygon ESRI REST produces a hybrid: a Polygon that
> contains detached rings
> (or rings not in other rings, so they are not holes) and that is
> interpreted as multipolygon.
>
> Fun.

The definition says polygons can have any number of rings, either exterior or interior. Exterior rings are oriented clockwise, while holes are oriented counter-clockwise.

Maybe the OGR driver should be improved to check for this. If more than one exterior ring is found then an OGC multi-polygon geometry object should be returned. Could check the orientation via area or the http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From mateusz at loskot.net  Mon Jun 23 14:07:59 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Mon, 23 Jun 2014 23:07:59 +0200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>
	<loom.20140623T102131-807@post.gmane.org>
	<C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <CABUeae8x216-t-nTdQgpCjDJ4xv3YeLadNb_9vsnEUvmNfFeTw@mail.gmail.com>

On 23 June 2014 19:46, Jeremy Palmer <JPalmer at linz.govt.nz> wrote:
> http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000n1000000
>>
>> Can you?
>> There is no geometry of multipolygon specified.
>> AFAIU, for multipolygon ESRI REST produces a hybrid: a Polygon that
>> contains detached rings
>> (or rings not in other rings, so they are not holes) and that is
>> interpreted as multipolygon.
>>
>> Fun.
>
> The definition says polygons can have any number of rings, either exterior or interior. Exterior rings are oriented clockwise, while holes are oriented counter-clockwise.

It does not say anything about interpreting such a multi-exterior ring
as multipolygon, either, OGC or GeoJSON ones.
It is just a description of ESRI-specific JSON-encoded kind of polygon geometry.

> Maybe the OGR driver should be improved to check for this. If more than one exterior ring is found then an OGC multi-polygon geometry object should be returned. Could check the orientation via area or the http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule

Might be. I just pointed out that OGR GeoJSON driver is dedicated to
GeoJSON specifically, not any JSON-encoded format of geometry.


Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From JPalmer at linz.govt.nz  Mon Jun 23 16:01:31 2014
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Tue, 24 Jun 2014 11:01:31 +1200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <CABUeae8x216-t-nTdQgpCjDJ4xv3YeLadNb_9vsnEUvmNfFeTw@mail.gmail.com>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>
	<loom.20140623T102131-807@post.gmane.org>
	<C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8x216-t-nTdQgpCjDJ4xv3YeLadNb_9vsnEUvmNfFeTw@mail.gmail.com>
Message-ID: <C6B695652D5E6B4597E90C5734C0242621F118AE6A@prdlsmmsg01.ad.linz.govt.nz>

> Might be. I just pointed out that OGR GeoJSON driver is dedicated to GeoJSON specifically, not any JSON-encoded format of geometry.

But doesn't the OGR GeoJSON driver have specific Esri JSON code? http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/geojson/ogresrijsonreader.cpp

Also aren't the geometries that OGR constructs supposed to be OGC valid? I don't think they are at the moment when coming from an Esri API Service.

Cheers
Jeremy

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From mateusz at loskot.net  Tue Jun 24 01:01:39 2014
From: mateusz at loskot.net (=?UTF-8?Q?Mateusz_=C5=81oskot?=)
Date: Tue, 24 Jun 2014 10:01:39 +0200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242621F118AE6A@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>
	<loom.20140623T102131-807@post.gmane.org>
	<C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8x216-t-nTdQgpCjDJ4xv3YeLadNb_9vsnEUvmNfFeTw@mail.gmail.com>
	<C6B695652D5E6B4597E90C5734C0242621F118AE6A@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <CABUeae-qDVUhCqBnF6hfER-+qMUL=QWeqj=sLQk2P3GGNehKgw@mail.gmail.com>

On 24 June 2014 01:01, Jeremy Palmer <JPalmer at linz.govt.nz> wrote:
>> Might be. I just pointed out that OGR GeoJSON driver is dedicated to GeoJSON specifically, not any JSON-encoded format of geometry.
>
> But doesn't the OGR GeoJSON driver have specific Esri JSON code? http://trac.osgeo.org/gdal/browser/trunk/gdal/ogr/ogrsf_frmts/geojson/ogresrijsonreader.cpp

Apparently, I have missed that addition
and the fact that GeoJSON driver has become a XXXJSON drvier indeed.

My apology for confusion.
I guess, your request is valid then you may want to open ticket.


Best regards,
-- 
Mateusz  ?oskot, http://mateusz.loskot.net

From geoff at tritonimaginginc.com  Tue Jun 24 13:14:42 2014
From: geoff at tritonimaginginc.com (Geoff Shipton)
Date: Tue, 24 Jun 2014 13:14:42 -0700
Subject: [gdal-dev] Gdal_merge question
Message-ID: <01f401cf8fe8$ef8a32f0$ce9e98d0$@com>

When we use Gdal_merge.py to merge GeoTIFF tiles that have been warped using
gdalwarp, we find that the resulting GeoTIFFs have gaps, although the
positions within the images are correct.

Importing the unmerged GeoTIFF tiles into a GIS application does not show
the problem.

I have samples that show the problem.

 

Geoff Shipton,

Triton Imaging, Inc

Customer Support,

Capitola CA

The information contained in this message may be privileged or confidential
information intended solely for the use of the addressee(s).  Any views or
opinions presented in this communication do not necessarily represent those
of Triton Imaging, Inc.  If the reader of this message is not the intended
recipient, you are hereby notified that any dissemination, distribution or
copying of this communication is strictly prohibited.  If you have received
this communication in error, please immediately notify me and you are hereby
instructed to delete all electronic copies and destroy all printed copies.

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140624/635a1612/attachment.html>

From JPalmer at linz.govt.nz  Tue Jun 24 14:43:28 2014
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Wed, 25 Jun 2014 09:43:28 +1200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <CABUeae-qDVUhCqBnF6hfER-+qMUL=QWeqj=sLQk2P3GGNehKgw@mail.gmail.com>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8Xv-96ZnJvx6CsSQ7nVAEhUhfcQnNeyDugGTSyMizSHA@mail.gmail.com>
	<loom.20140623T102131-807@post.gmane.org>
	<C6B695652D5E6B4597E90C5734C0242621F0945BC4@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae8x216-t-nTdQgpCjDJ4xv3YeLadNb_9vsnEUvmNfFeTw@mail.gmail.com>
	<C6B695652D5E6B4597E90C5734C0242621F118AE6A@prdlsmmsg01.ad.linz.govt.nz>
	<CABUeae-qDVUhCqBnF6hfER-+qMUL=QWeqj=sLQk2P3GGNehKgw@mail.gmail.com>
Message-ID: <C6B695652D5E6B4597E90C5734C0242621F27F9358@prdlsmmsg01.ad.linz.govt.nz>

> My apology for confusion.
> I guess, your request is valid then you may want to open ticket.

No probs. Thanks I've raise a ticket here:

http://trac.osgeo.org/gdal/ticket/5538

Cheers
Jeremy


This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From authmanc at Mathematik.Uni-Marburg.de  Thu Jun 26 02:35:37 2014
From: authmanc at Mathematik.Uni-Marburg.de (Christian Authmann)
Date: Thu, 26 Jun 2014 11:35:37 +0200
Subject: [gdal-dev] gdalinfo: fix metadata output
Message-ID: <53ABE969.9010100@mathematik.uni-marburg.de>

Hello,

I tried getting a driver to return some useful metadata from the files, 
but gdalinfo never displayed any of it. As it turns out, the culprit was 
gdalinfo. It will never report metadata from the bands, even if 
explicitely requested in the command line.

So I set out to rewrite the metadata handling. It will now use the same 
function to display both dataset metadata and band metadata. While I was 
at it, I fixed a violation of the DRY-principle, introducing a small 
helper function to get a metadata list, loop over it and output everything.


Since there's probably someone out there with a script that parses the 
output of gdalinfo, I was careful not to introduce any functional 
changes in the output. The only visible difference should be that band 
metadata is actually printed.


Patch is attached for review and/or committing.


-- 
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg
-------------- next part --------------
--- a/apps/gdalinfo.c	2014-06-26 13:22:16.980934455 +0200
+++ b/apps/gdalinfo.c	2014-06-25 15:38:11.273797119 +0200
@@ -44,6 +44,13 @@
                       const char * corner_name,
                       double x, double y );
 
+static void
+GDALInfoReportMetadata( GDALMajorObjectH hObject,
+                        int bListMDD,
+                        int bShowMetadata,
+                        char **papszExtraMDDomains,
+                        int bIsBand );
+
 /************************************************************************/
 /*                               Usage()                                */
 /************************************************************************/
@@ -78,10 +85,9 @@
     int			i, iBand;
     double		adfGeoTransform[6];
     GDALDriverH		hDriver;
-    char		**papszMetadata;
     int                 bComputeMinMax = FALSE, bSample = FALSE;
     int                 bShowGCPs = TRUE, bShowMetadata = TRUE, bShowRAT=TRUE;
-    int                 bStats = FALSE, bApproxStats = TRUE, iMDD;
+    int                 bStats = FALSE, bApproxStats = TRUE;
     int                 bShowColorTable = TRUE, bComputeChecksum = FALSE;
     int                 bReportHistograms = FALSE;
     int                 bReportProj4 = FALSE;
@@ -397,125 +403,8 @@
 /*      Report metadata.                                                */
 /* -------------------------------------------------------------------- */
 
-    if( bListMDD )
-    {
-        char** papszMDDList = GDALGetMetadataDomainList( hDataset );
-        char** papszIter = papszMDDList;
-
-        if( papszMDDList != NULL )
-            printf( "Metadata domains:\n" );
-        while( papszIter != NULL && *papszIter != NULL )
-        {
-            if( EQUAL(*papszIter, "") )
-                printf( "  (default)\n");
-            else
-                printf( "  %s\n", *papszIter );
-            papszIter ++;
-        }
-        CSLDestroy(papszMDDList);
-    }
-
-    papszMetadata = (bShowMetadata) ? GDALGetMetadata( hDataset, NULL ) : NULL;
-    if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-    {
-        printf( "Metadata:\n" );
-        for( i = 0; papszMetadata[i] != NULL; i++ )
-        {
-            printf( "  %s\n", papszMetadata[i] );
-        }
-    }
-
-    if( papszExtraMDDomains != NULL && EQUAL(papszExtraMDDomains[0], "all") &&
-        papszExtraMDDomains[1] == NULL )
-    {
-        char** papszMDDList = GDALGetMetadataDomainList( hDataset );
-        char** papszIter = papszMDDList;
-
-        CSLDestroy(papszExtraMDDomains);
-        papszExtraMDDomains = NULL;
-
-        while( papszIter != NULL && *papszIter != NULL )
-        {
-            if( !EQUAL(*papszIter, "") &&
-                !EQUAL(*papszIter, "IMAGE_STRUCTURE") &&
-                !EQUAL(*papszIter, "SUBDATASETS") &&
-                !EQUAL(*papszIter, "GEOLOCATION") &&
-                !EQUAL(*papszIter, "RPC") )
-            {
-                papszExtraMDDomains = CSLAddString(papszExtraMDDomains, *papszIter);
-            }
-            papszIter ++;
-        }
-        CSLDestroy(papszMDDList);
-    }
-
-    for( iMDD = 0; bShowMetadata && iMDD < CSLCount(papszExtraMDDomains); iMDD++ )
-    {
-        papszMetadata = GDALGetMetadata( hDataset, papszExtraMDDomains[iMDD] );
-        if( CSLCount(papszMetadata) > 0 )
-        {
-            printf( "Metadata (%s):\n", papszExtraMDDomains[iMDD]);
-            for( i = 0; papszMetadata[i] != NULL; i++ )
-            {
-                if (EQUALN(papszExtraMDDomains[iMDD], "xml:", 4))
-                    printf( "%s\n", papszMetadata[i] );
-                else
-                    printf( "  %s\n", papszMetadata[i] );
-            }
-        }
-    }
-
-/* -------------------------------------------------------------------- */
-/*      Report "IMAGE_STRUCTURE" metadata.                              */
-/* -------------------------------------------------------------------- */
-    papszMetadata = (bShowMetadata) ? GDALGetMetadata( hDataset, "IMAGE_STRUCTURE" ) : NULL;
-    if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-    {
-        printf( "Image Structure Metadata:\n" );
-        for( i = 0; papszMetadata[i] != NULL; i++ )
-        {
-            printf( "  %s\n", papszMetadata[i] );
-        }
-    }
-
-/* -------------------------------------------------------------------- */
-/*      Report subdatasets.                                             */
-/* -------------------------------------------------------------------- */
-    papszMetadata = GDALGetMetadata( hDataset, "SUBDATASETS" );
-    if( CSLCount(papszMetadata) > 0 )
-    {
-        printf( "Subdatasets:\n" );
-        for( i = 0; papszMetadata[i] != NULL; i++ )
-        {
-            printf( "  %s\n", papszMetadata[i] );
-        }
-    }
-
-/* -------------------------------------------------------------------- */
-/*      Report geolocation.                                             */
-/* -------------------------------------------------------------------- */
-    papszMetadata = (bShowMetadata) ? GDALGetMetadata( hDataset, "GEOLOCATION" ) : NULL;
-    if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-    {
-        printf( "Geolocation:\n" );
-        for( i = 0; papszMetadata[i] != NULL; i++ )
-        {
-            printf( "  %s\n", papszMetadata[i] );
-        }
-    }
+    GDALInfoReportMetadata( hDataset, bListMDD, bShowMetadata, papszExtraMDDomains, FALSE);
 
-/* -------------------------------------------------------------------- */
-/*      Report RPCs                                                     */
-/* -------------------------------------------------------------------- */
-    papszMetadata = (bShowMetadata) ? GDALGetMetadata( hDataset, "RPC" ) : NULL;
-    if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-    {
-        printf( "RPC Metadata:\n" );
-        for( i = 0; papszMetadata[i] != NULL; i++ )
-        {
-            printf( "  %s\n", papszMetadata[i] );
-        }
-    }
 
 /* -------------------------------------------------------------------- */
 /*      Setup projected to lat/long transform if appropriate.           */
@@ -796,42 +685,7 @@
                     GDALGetRasterOffset( hBand, &bSuccess ),
                     GDALGetRasterScale( hBand, &bSuccess ) );
 
-        if( bListMDD )
-        {
-            char** papszMDDList = GDALGetMetadataDomainList( hBand );
-            char** papszIter = papszMDDList;
-            if( papszMDDList != NULL )
-                printf( "  Metadata domains:\n" );
-            while( papszIter != NULL && *papszIter != NULL )
-            {
-                if( EQUAL(*papszIter, "") )
-                    printf( "    (default)\n");
-                else
-                    printf( "    %s\n", *papszIter );
-                papszIter ++;
-            }
-            CSLDestroy(papszMDDList);
-        }
-
-        papszMetadata = (bShowMetadata) ? GDALGetMetadata( hBand, NULL ) : NULL;
-        if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-        {
-            printf( "  Metadata:\n" );
-            for( i = 0; papszMetadata[i] != NULL; i++ )
-            {
-                printf( "    %s\n", papszMetadata[i] );
-            }
-        }
-
-        papszMetadata = (bShowMetadata) ? GDALGetMetadata( hBand, "IMAGE_STRUCTURE" ) : NULL;
-        if( bShowMetadata && CSLCount(papszMetadata) > 0 )
-        {
-            printf( "  Image Structure Metadata:\n" );
-            for( i = 0; papszMetadata[i] != NULL; i++ )
-            {
-                printf( "    %s\n", papszMetadata[i] );
-            }
-        }
+        GDALInfoReportMetadata( hBand, bListMDD, bShowMetadata, papszExtraMDDomains, TRUE);
 
         if( GDALGetRasterColorInterpretation(hBand) == GCI_PaletteIndex 
             && (hTable = GDALGetRasterColorTable( hBand )) != NULL )
@@ -944,3 +798,126 @@
 
     return TRUE;
 }
+
+
+/************************************************************************/
+/*                       GDALInfoPrintMetadata()                        */
+/************************************************************************/
+static void GDALInfoPrintMetadata( GDALMajorObjectH hObject,
+                                   const char *pszDomain,
+                                   const char *pszDisplayedname )
+{
+    int i;
+    char **papszMetadata;
+    int bIsxml = FALSE;
+
+    if (pszDomain != NULL && EQUALN(pszDomain, "xml:", 4))
+        bIsxml = TRUE;
+
+    papszMetadata = GDALGetMetadata( hObject, pszDomain );
+    if( CSLCount(papszMetadata) > 0 )
+    {
+        printf( "%s:\n", pszDisplayedname );
+        for( i = 0; papszMetadata[i] != NULL; i++ )
+        {
+            if (bIsxml)
+                printf( "%s\n", papszMetadata[i] );
+            else
+                printf( "  %s\n", papszMetadata[i] );
+        }
+    }
+}
+
+/************************************************************************/
+/*                       GDALInfoReportMetadata()                       */
+/************************************************************************/
+static void GDALInfoReportMetadata( GDALMajorObjectH hObject,
+                                    int bListMDD,
+                                    int bShowMetadata,
+                                    char **papszExtraMDDomains,
+                                    int bIsBand )
+{
+    /* -------------------------------------------------------------------- */
+    /*      Report Metadata domains                                         */
+    /* -------------------------------------------------------------------- */
+    if( bListMDD )
+    {
+        char** papszMDDList = GDALGetMetadataDomainList( hObject );
+        char** papszIter = papszMDDList;
+
+        if( papszMDDList != NULL )
+            printf( "Metadata domains:\n" );
+        while( papszIter != NULL && *papszIter != NULL )
+        {
+            if( EQUAL(*papszIter, "") )
+                printf( "  (default)\n");
+            else
+                printf( "  %s\n", *papszIter );
+            papszIter ++;
+        }
+        CSLDestroy(papszMDDList);
+    }
+
+    if (!bShowMetadata)
+        return;
+
+    /* -------------------------------------------------------------------- */
+    /*      Report default Metadata                                         */
+    /* -------------------------------------------------------------------- */
+    GDALInfoPrintMetadata( hObject, NULL, "Metadata" );
+
+    /* -------------------------------------------------------------------- */
+    /*      Report extra Metadata                                           */
+    /* -------------------------------------------------------------------- */
+    if (papszExtraMDDomains != NULL) {
+        char **papszExtraMDDomainsExpanded = NULL;
+        int iMDD;
+
+        if( EQUAL(papszExtraMDDomains[0], "all") &&
+            papszExtraMDDomains[1] == NULL )
+        {
+            char** papszMDDList = GDALGetMetadataDomainList( hObject );
+            char** papszIter = papszMDDList;
+
+            while( papszIter != NULL && *papszIter != NULL )
+            {
+                if( !EQUAL(*papszIter, "") &&
+                    !EQUAL(*papszIter, "IMAGE_STRUCTURE") &&
+                    !EQUAL(*papszIter, "SUBDATASETS") &&
+                    !EQUAL(*papszIter, "GEOLOCATION") &&
+                    !EQUAL(*papszIter, "RPC") )
+                {
+                    papszExtraMDDomainsExpanded = CSLAddString(papszExtraMDDomainsExpanded, *papszIter);
+                }
+                papszIter ++;
+            }
+            CSLDestroy(papszMDDList);
+        }
+        else
+        {
+            papszExtraMDDomainsExpanded = CSLDuplicate(papszExtraMDDomains);
+        }
+
+        for( iMDD = 0; iMDD < CSLCount(papszExtraMDDomainsExpanded); iMDD++ )
+        {
+            char pszDisplayedname[256];
+            snprintf(pszDisplayedname, 256, "Metadata (%s)", papszExtraMDDomainsExpanded[iMDD]);
+            GDALInfoPrintMetadata( hObject, papszExtraMDDomainsExpanded[iMDD], pszDisplayedname );
+        }
+
+        CSLDestroy(papszExtraMDDomainsExpanded);
+    }
+
+    /* -------------------------------------------------------------------- */
+    /*      Report various named metadata.                                  */
+    /* -------------------------------------------------------------------- */
+    GDALInfoPrintMetadata( hObject, "IMAGE_STRUCTURE", "Image Structure Metadata" );
+
+    if (!bIsBand)
+    {
+    	GDALInfoPrintMetadata( hObject, "SUBDATASETS", "Subdatasets" );
+    	GDALInfoPrintMetadata( hObject, "GEOLOCATION", "Geolocation" );
+    	GDALInfoPrintMetadata( hObject, "RPC", "RPC Metadata" );
+    }
+
+}

From authmanc at Mathematik.Uni-Marburg.de  Thu Jun 26 02:23:02 2014
From: authmanc at Mathematik.Uni-Marburg.de (Christian Authmann)
Date: Thu, 26 Jun 2014 11:23:02 +0200
Subject: [gdal-dev] MSG Driver: two memory leaks
Message-ID: <53ABE676.1030102@mathematik.uni-marburg.de>

Hello,

valgrind'ing my application revealed two memory leaks in msgdataset.cpp.

a) MSGDataset::pszProjection shall always point to a valid string during 
the lifetime of the object; the old string needs to be released before 
getting a new one from exportToWkt().

b) A spatial reference is exported to a temporary string as WKT, but the 
string is never released.


Attached you'll find a patch fixing both; valgrind confirms that both 
memory leaks are gone.


-- 
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg
-------------- next part --------------
--- a/frmts/msg/msgdataset.cpp	2014-04-16 22:04:48.000000000 +0200
+++ b/frmts/msg/msgdataset.cpp	2014-06-26 13:03:19.936803801 +0200
 /************************************************************************/
@@ -248,6 +250,7 @@
 
     poDS->oSRS.SetGEOS(  0, 35785831, 0, 0 );
     poDS->oSRS.SetWellKnownGeogCS( "WGS84" ); // Temporary line to satisfy ERDAS (otherwise the ellips is "unnamed"). Eventually this should become the custom a and b ellips (CGMS).
+    CPLFree( poDS->pszProjection );
     poDS->oSRS.exportToWkt( &(poDS->pszProjection) );
 
     // The following are 3 different try-outs for also setting the ellips a and b parameters.
@@ -276,8 +279,13 @@
 /* -------------------------------------------------------------------- */
 
     char *pszLLTemp;
+    char *pszLLTemp_bak;
+
     (poDS->oSRS.GetAttrNode("GEOGCS"))->exportToWkt(&pszLLTemp);
+    pszLLTemp_bak = pszLLTemp; // importFromWkt() changes the pointer
     poDS->oLL.importFromWkt(&pszLLTemp);
+    CPLFree( pszLLTemp_bak );
+
     poDS->poTransform = OGRCreateCoordinateTransformation( &(poDS->oSRS), &(poDS->oLL) );
 
 /* -------------------------------------------------------------------- */

From even.rouault at mines-paris.org  Thu Jun 26 04:02:55 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 13:02:55 +0200
Subject: [gdal-dev] gdalinfo: fix metadata output
In-Reply-To: <53ABE969.9010100@mathematik.uni-marburg.de>
References: <53ABE969.9010100@mathematik.uni-marburg.de>
Message-ID: <1403780575.53abfddf63390@imp.free.fr>

Christian,

I guess you are talking about metadata in domains other than the default and
IMAGE_STRUCTURE metadata domains ?
With which driver did you experiment that issue ?

Would you mind attaching your patch as an attachment to a ticket in Trac (
http://trac.osgeo.org/gdal/newticket ) ? For that issue, and for your other
email as well.

Best regards,

Even

> Hello,
>
> I tried getting a driver to return some useful metadata from the files,
> but gdalinfo never displayed any of it. As it turns out, the culprit was
> gdalinfo. It will never report metadata from the bands, even if
> explicitely requested in the command line.
>
> So I set out to rewrite the metadata handling. It will now use the same
> function to display both dataset metadata and band metadata. While I was
> at it, I fixed a violation of the DRY-principle, introducing a small
> helper function to get a metadata list, loop over it and output everything.
>
>
> Since there's probably someone out there with a script that parses the
> output of gdalinfo, I was careful not to introduce any functional
> changes in the output. The only visible difference should be that band
> metadata is actually printed.
>
>
> Patch is attached for review and/or committing.
>
>
> --
> Christian Authmann
> Philipps-Universit?t Marburg
> Fachbereich Mathematik und Informatik
> AG Datenbanksysteme
> Hans-Meerwein-Stra?e
> D-35032 Marburg
>



From authmanc at Mathematik.Uni-Marburg.de  Thu Jun 26 04:19:55 2014
From: authmanc at Mathematik.Uni-Marburg.de (Christian Authmann)
Date: Thu, 26 Jun 2014 13:19:55 +0200
Subject: [gdal-dev] gdalinfo: fix metadata output
In-Reply-To: <1403780575.53abfddf63390@imp.free.fr>
References: <53ABE969.9010100@mathematik.uni-marburg.de>
	<1403780575.53abfddf63390@imp.free.fr>
Message-ID: <53AC01DB.30003@mathematik.uni-marburg.de>

Hi,

yes, I'm talking about metadata in a custom domain. I hacked up a driver 
to return additional metadata I want to use; since that metadata is 
driver specific I put it into a custom domain named after the driver.

If you guessed MSG driver you'd be correct; but the SVN version doesn't 
return any metadata as the moment. I'll eventually send another patch 
for adding said metadata, but it'll be a while until I figured out what 
data is available and useful.

I've clarified the description and created two tickets per your request:

http://trac.osgeo.org/gdal/ticket/5541
http://trac.osgeo.org/gdal/ticket/5542

Ciao,
Christian

On 26.06.2014 13:02, Even Rouault wrote:
> Christian,
>
> I guess you are talking about metadata in domains other than the default and
> IMAGE_STRUCTURE metadata domains ?
> With which driver did you experiment that issue ?
>
> Would you mind attaching your patch as an attachment to a ticket in Trac (
> http://trac.osgeo.org/gdal/newticket ) ? For that issue, and for your other
> email as well.
>
> Best regards,
>
> Even
>
>> Hello,
>>
>> I tried getting a driver to return some useful metadata from the files,
>> but gdalinfo never displayed any of it. As it turns out, the culprit was
>> gdalinfo. It will never report metadata from the bands, even if
>> explicitely requested in the command line.
>>
>> So I set out to rewrite the metadata handling. It will now use the same
>> function to display both dataset metadata and band metadata. While I was
>> at it, I fixed a violation of the DRY-principle, introducing a small
>> helper function to get a metadata list, loop over it and output everything.
>>
>>
>> Since there's probably someone out there with a script that parses the
>> output of gdalinfo, I was careful not to introduce any functional
>> changes in the output. The only visible difference should be that band
>> metadata is actually printed.
>>
>>
>> Patch is attached for review and/or committing.
>>
>>
>> --
>> Christian Authmann
>> Philipps-Universit?t Marburg
>> Fachbereich Mathematik und Informatik
>> AG Datenbanksysteme
>> Hans-Meerwein-Stra?e
>> D-35032 Marburg
>>
>

-- 
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg

From srp at geo.ku.dk  Thu Jun 26 07:14:03 2014
From: srp at geo.ku.dk (Simon Richard Proud)
Date: Thu, 26 Jun 2014 14:14:03 +0000
Subject: [gdal-dev] MSG Driver: two memory leaks
In-Reply-To: <53ABE676.1030102@mathematik.uni-marburg.de>
References: <53ABE676.1030102@mathematik.uni-marburg.de>
Message-ID: <6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>

Hi,
Have you noticed any other memory leaks in the MSG driver? We have seen some huge memory uses when working with the visible MSG channels (converting from DN to Reflectance) but have not been able to track down where the memory is being used. Would be good to have a second opinion!

All the best,
Simon

________________________________________
Fra: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org] p&#229; vegne af Christian Authmann [authmanc at Mathematik.Uni-Marburg.de]
Sendt: 26. juni 2014 05:23
Til: gdal-dev at lists.osgeo.org
Emne: [gdal-dev] MSG Driver: two memory leaks

Hello,

valgrind'ing my application revealed two memory leaks in msgdataset.cpp.

a) MSGDataset::pszProjection shall always point to a valid string during
the lifetime of the object; the old string needs to be released before
getting a new one from exportToWkt().

b) A spatial reference is exported to a temporary string as WKT, but the
string is never released.


Attached you'll find a patch fixing both; valgrind confirms that both
memory leaks are gone.


--
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg

From authmanc at Mathematik.Uni-Marburg.de  Thu Jun 26 07:45:39 2014
From: authmanc at Mathematik.Uni-Marburg.de (Christian Authmann)
Date: Thu, 26 Jun 2014 16:45:39 +0200
Subject: [gdal-dev] MSG Driver: two memory leaks
In-Reply-To: <6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>
References: <53ABE676.1030102@mathematik.uni-marburg.de>
	<6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>
Message-ID: <53AC3213.4050505@mathematik.uni-marburg.de>

Hi,

I haven't noticed any other leaks, but I haven't used the Reflectance 
Calculator, either. Should I stumble upon more leaks, I'll either report 
or fix them.

If you want to know if the "memory usage" you noticed is just "usage" or 
an actual leak, valgrind ( http://valgrind.org/ ) is awesome.

greetings,
Christian

On 26.06.2014 16:14, Simon Richard Proud wrote:
> Hi,
> Have you noticed any other memory leaks in the MSG driver? We have seen some huge memory uses when working with the visible MSG channels (converting from DN to Reflectance) but have not been able to track down where the memory is being used. Would be good to have a second opinion!
>
> All the best,
> Simon
>
> ________________________________________
> Fra: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org] p&#229; vegne af Christian Authmann [authmanc at Mathematik.Uni-Marburg.de]
> Sendt: 26. juni 2014 05:23
> Til: gdal-dev at lists.osgeo.org
> Emne: [gdal-dev] MSG Driver: two memory leaks
>
> Hello,
>
> valgrind'ing my application revealed two memory leaks in msgdataset.cpp.
>
> a) MSGDataset::pszProjection shall always point to a valid string during
> the lifetime of the object; the old string needs to be released before
> getting a new one from exportToWkt().
>
> b) A spatial reference is exported to a temporary string as WKT, but the
> string is never released.
>
>
> Attached you'll find a patch fixing both; valgrind confirms that both
> memory leaks are gone.
>
>
> --
> Christian Authmann
> Philipps-Universit?t Marburg
> Fachbereich Mathematik und Informatik
> AG Datenbanksysteme
> Hans-Meerwein-Stra?e
> D-35032 Marburg
>

-- 
Christian Authmann
Philipps-Universit?t Marburg
Fachbereich Mathematik und Informatik
AG Datenbanksysteme
Hans-Meerwein-Stra?e
D-35032 Marburg

From even.rouault at mines-paris.org  Thu Jun 26 13:00:56 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:00:56 +0200
Subject: [gdal-dev] link not working
In-Reply-To: <CACqzBMzA2XB+ZLY0oC6obozE1Ezb36GZ+MZ_CHgVscG6FdOeSQ@mail.gmail.com>
References: <CACqzBMzA2XB+ZLY0oC6obozE1Ezb36GZ+MZ_CHgVscG6FdOeSQ@mail.gmail.com>
Message-ID: <201406262200.56766.even.rouault@mines-paris.org>

Le jeudi 19 juin 2014 14:53:16, xavier lhomme a ?crit :
> The link ASpatial on the Geopackage page  do not work
>   http://www.gdal.org/geopackage_aspatial.html

Fix to install it pushed.

> 
> best regards
> xav

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:05:59 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:05:59 +0200
Subject: [gdal-dev] PAM XSD or DTD
In-Reply-To: <7C48E40C135D314BA03D6471A6E389782F3D72C0@EX1.oregonstate.edu>
References: <7C48E40C135D314BA03D6471A6E389782F3D72C0@EX1.oregonstate.edu>
Message-ID: <201406262205.59481.even.rouault@mines-paris.org>

Le jeudi 19 juin 2014 18:01:20, Gregory, Matthew a ?crit :
> Hi all,
> 
> I'm trying to locate an XSD or DTD for the PAM .aux.xml files.  Does such a
> thing exist?  It seems that there are slight variants of the tags allowed
> that I'm seeing.
> 
> Sorry if this has been answered before.  My searching was futile.

There's no such XSD or DTD. The current reference is the source code 
(gcore/gdalpamdataset.cpp gcore/gdalpamrasterband.cpp)

> 
> thanks, matt
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:11:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:11:46 +0200
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <53A42F8C.2060506@sarvision.nl>
References: <53A42F8C.2060506@sarvision.nl>
Message-ID: <201406262211.46162.even.rouault@mines-paris.org>

Le vendredi 20 juin 2014 14:56:44, Vincent Schut a ?crit :
> Hi list,
> 
> this is a bit off topic, but I guess I'll have the biggest chance for an
> answer on this ml...
> 
> Untill now, I always succeeded in (re)building openev2, but after some
> recent system upgrades, it fails... I've used openev2 (and openev before
> that) long as my preferred raster viewer. It is blazingly fast, and has
> almost all functionality I want from a viewer. Especially an easy
> mechanism to set which bands are r,g and b, and to adjust the stretch,
> are important to me. And displaying multiple rasters on top of each
> other, being able to easily switch them on and off.
> 
> Now I'm afraid I need to look for an alternative. There once were
> rumours of an openev3, but afaik that has never really materialized?
> I've tried several others (tuiview, monteverdi(2), qgis, thuban,
> otbiceviewer, ...) but none of them has the combination of being fast
> and convenient.
> 
> I just need something that is good in displaying (browsing, zooming)
> multi-band raster files. Anybody knows a viable alternative?

And why not trying to fix the build of openev2 ? But I haven't tried since a 
few years admitedly.

> 
> Thanks!
> Vincent.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:21:33 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:21:33 +0200
Subject: [gdal-dev] gdal contour as transparent png/tif or svg/eps/pdf
In-Reply-To: <146bf285939.-4577694206278287407.5027848028187452311@web.de>
References: <146bf285939.-4577694206278287407.5027848028187452311@web.de>
Message-ID: <201406262221.34041.even.rouault@mines-paris.org>

Le samedi 21 juin 2014 18:10:38, Robert Grah a ?crit :
> Hey there,
> 
> im trying to get a contour out of an GeoTiff file as transparent PNG or
> TIFF or even better as PDF/SVG or EPS file in my C++ program. I found
> gdal_contour but was not able to get PDF driver running.
> How can I install more drivers to GDAL?
> 
> So my approach so far is like following:
> 
> gdal_contour -i 50 mygeotiff.tif contour
> gdal_rasterize -burn 0 -l contour contour mygeotiff.tif
> 
> But with this I am not able to get a transparent contour.
> Is there a different approach beside the command line utils to get contours
> in vectorformat or transparent png/tif out of the geoTiff? It would be
> also great to add some anti-aliasing ;)...

Robert,

I'm able to generate a transparent PDF with a command line like :

gdal_contour -i 50 in.tif out.pdf -f pdf

You presumably need at least GDAL 1.10.

Even

> 
> Cheers,
> Rob
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:26:22 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:26:22 +0200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <201406262226.22130.even.rouault@mines-paris.org>

Le lundi 23 juin 2014 03:32:32, Jeremy Palmer a ?crit :
> I'm querying an ArcGIS service obtain polygon data, however the service
> seems to define Island multi-polygons objects as single polygons with
> multiple exterior rings. This creates invalid OGC geometries and is
> causing processing problems in my workflow.
> 
> He's the service and a validation test showing the polygon is not valid:
> 
> ogrinfo -dialect sqlite -sql "SELECT TA2013_V1_00_NAME,
> ST_IsValid(GEOMETRY) FROM OGRGeoJSON"
> http://maps.stats.govt.nz/wss/service/arcgis1/guest/Boundaries/2013_Geogra
> phies/MapServer/9/query?f=json&objectIds=36&returnGeometry=true&outSR=4167
> 
> GEOS warning: Hole lies outside shell at or near point 174.78189611685229
> -41.077770200471164
> 
> Layer name: SELECT
> Geometry: None
> Feature Count: 1
> Layer SRS WKT:
> (unknown)
> TA2013_V1_00_NAME: String (0.0)
> ST_IsValid(GEOMETRY): Integer (0.0)
> OGRFeature(SELECT):0
>   TA2013_V1_00_NAME (String) = Porirua City
>   ST_IsValid(GEOMETRY) (Integer) = 0
> 
> Is this a bug in the data from the service, or just the way the Esri
> defines geometry objects (and therefor an OGR bug)? I can't see a
> definition for multi-polygons in Esri API docs:
> 
> http://resources.arcgis.com/en/help/arcgis-rest-api/index.html#//02r3000000
> n1000000

Looking at the ogresrijsonreader.cpp code I can see I assumed that a 
esriPolygon was just a OGC Polygon, so with outer ring first and then inner 
rings. Fixing the code to support multi polygons should basically be a matter 
of calling OGRGeometryFactory::organizePolygons.

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:29:27 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:29:27 +0200
Subject: [gdal-dev] Reproject raster map in buffer on-the-fly
In-Reply-To: <trinity-b705f47c-1089-4198-a466-5699ad929cdb-1403516990901@3capp-gmx-bs03>
References: <trinity-b705f47c-1089-4198-a466-5699ad929cdb-1403516990901@3capp-gmx-bs03>
Message-ID: <201406262229.27851.even.rouault@mines-paris.org>

Le lundi 23 juin 2014 11:49:58, Oliver Eichler a ?crit :
> Hi
> 
> I would like to read a region of a raster map and re-project the resulting
> image on-the-fly before it is displayed. I had a look at the GDAL Warp API
> tutorial. And I stumbled across GDALWarpRegionToBuffer() while reading the
> header files. I had a look into the setup functions and found quite a
> variety of GDALCreateGenImgProjTransformer1..3() or
> GDALCreateReprojectionTransformer(). I have to admit that whole stuff
> leaves me a bit clueless.
> 
> Thus my question:
> 
> Is there a tutorial or an open source project that does the same I want to
> do (I parsed the code of QGis without success)?

Oliver,

Yes, you can look at the Warp API tutorial : http://www.gdal.org/warptut.html

The source code of the gdalwarp utility can also be a source of study.

You can warp into a memory dataset (MEM driver) if your image is of reasonable 
size (fit into RAM) and don't want it to be serialized on disk.

Another possibility is to warp into a VRT dataset (possibly in /vsimem/ 
special file system to avoid temporary file) if your dataset is of a bigger 
size.

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 13:48:53 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 22:48:53 +0200
Subject: [gdal-dev] MSG Driver: two memory leaks
In-Reply-To: <6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>
References: <53ABE676.1030102@mathematik.uni-marburg.de>
	<6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>
Message-ID: <201406262248.53806.even.rouault@mines-paris.org>

Le jeudi 26 juin 2014 16:14:03, Simon Richard Proud a ?crit :
> Hi,
> Have you noticed any other memory leaks in the MSG driver? We have seen
> some huge memory uses when working with the visible MSG channels
> (converting from DN to Reflectance) but have not been able to track down
> where the memory is being used. Would be good to have a second opinion!

Simon,

I just wanted to mention I can be available for contractual support on GDAL if 
you need.

It might not be to be excluded that the leak might be in the Eumetsat library 
itself.

Best regards,

Even


> 
> All the best,
> Simon
> 
> ________________________________________
> Fra: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org]
> p&#229; vegne af Christian Authmann [authmanc at Mathematik.Uni-Marburg.de]
> Sendt: 26. juni 2014 05:23
> Til: gdal-dev at lists.osgeo.org
> Emne: [gdal-dev] MSG Driver: two memory leaks
> 
> Hello,
> 
> valgrind'ing my application revealed two memory leaks in msgdataset.cpp.
> 
> a) MSGDataset::pszProjection shall always point to a valid string during
> the lifetime of the object; the old string needs to be released before
> getting a new one from exportToWkt().
> 
> b) A spatial reference is exported to a temporary string as WKT, but the
> string is never released.
> 
> 
> Attached you'll find a patch fixing both; valgrind confirms that both
> memory leaks are gone.
> 
> 
> --
> Christian Authmann
> Philipps-Universit?t Marburg
> Fachbereich Mathematik und Informatik
> AG Datenbanksysteme
> Hans-Meerwein-Stra?e
> D-35032 Marburg
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From JPalmer at linz.govt.nz  Thu Jun 26 14:21:58 2014
From: JPalmer at linz.govt.nz (Jeremy Palmer)
Date: Fri, 27 Jun 2014 09:21:58 +1200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <201406262226.22130.even.rouault@mines-paris.org>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>,
	<201406262226.22130.even.rouault@mines-paris.org>
Message-ID: <C6B695652D5E6B4597E90C5734C0242621F2A7AEEC@prdlsmmsg01.ad.linz.govt.nz>



> Looking at the ogresrijsonreader.cpp code I can see I assumed that a
> esriPolygon was just a OGC Polygon, so with outer ring first and then inner
> rings. Fixing the code to support multi polygons should basically be a matter
> of calling OGRGeometryFactory::organizePolygons.

Thanks Even. Anyway to call this organize polygons via the python API as a short term fix?

This message contains information, which may be in confidence and may be subject to legal privilege. If you are not the intended recipient, you must not peruse, use, disseminate, distribute or copy this message. If you have received this message in error, please notify us immediately (Phone 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ accepts no responsibility for changes to this email, or for any attachments, after its transmission from LINZ. Thank You.

From even.rouault at mines-paris.org  Thu Jun 26 14:30:42 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 23:30:42 +0200
Subject: [gdal-dev] How open a subset dataset with python
In-Reply-To: <CABqTJk8VaFoqZsRXVf7+Ce9B2gotxYiy_Q30AYsEw4BHUBX=zg@mail.gmail.com>
References: <CABqTJk9BoFQLigeamnUEwJVkzvoF6-B1RWLjAzoQXjB8oEhpWQ@mail.gmail.com>
	<CABqTJk8VaFoqZsRXVf7+Ce9B2gotxYiy_Q30AYsEw4BHUBX=zg@mail.gmail.com>
Message-ID: <201406262330.42712.even.rouault@mines-paris.org>

Le jeudi 19 juin 2014 22:05:13, Andrea Peri a ?crit :
> Hi, resolved the quest.
> 
> the command is
> layer = ds.ExecuteSQL(sqlString,None,"SQLITE")

Andrea,

You could also directly open with ogr.Open(file) (no need to explicitely 
request the driver).
And if the driver is indeed SQLite, you don't need to precise the "SQLITE" 
dialect since by default for RDBMS based drivers, the SQL is evaluated by the 
RDMBS engine. But that will not hurt specifying it.
To avoid memory leaks (in case you would call it many times in a loop), on a 
layer returned with ExecuteSQL(), remember to call ds.ResultResultSet(layer).

Best regards,

Even

> 
> Andrea.
> 
> 2014-06-19 18:10 GMT+02:00 Andrea Peri <aperi2007 at gmail.com>:
> > Hi,
> > 
> > I'm study-ing the option to use the python with gdal:
> > This are my first step on the python world.
> > 
> > I use this code:
> > 
> > driver = ogr.GetDriverByName('SQLite')
> > ds = driver.Open(file)
> > layer = ds.GetLayerByName(dataset)
> > 
> > But I like to open instead of a full "dataset" a subset of it as
> > usually do in ogr2ogr
> > using the two parameters:
> > 
> > -sql statement and the parameter "-dialect SQLITE"
> > 
> > is this possible in python ?
> > 
> > Thx to everyone,
> > 
> > --
> > -----------------
> > Andrea Peri
> > . . . . . . . . .
> > qwerty ?????
> > -----------------

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Thu Jun 26 14:32:51 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Thu, 26 Jun 2014 23:32:51 +0200
Subject: [gdal-dev] ArcGIS RestAPI JSON Polygons
In-Reply-To: <C6B695652D5E6B4597E90C5734C0242621F2A7AEEC@prdlsmmsg01.ad.linz.govt.nz>
References: <C6B695652D5E6B4597E90C5734C0242621F118A99E@prdlsmmsg01.ad.linz.govt.nz>
	<201406262226.22130.even.rouault@mines-paris.org>
	<C6B695652D5E6B4597E90C5734C0242621F2A7AEEC@prdlsmmsg01.ad.linz.govt.nz>
Message-ID: <201406262332.51277.even.rouault@mines-paris.org>

Le jeudi 26 juin 2014 23:21:58, Jeremy Palmer a ?crit :
> > Looking at the ogresrijsonreader.cpp code I can see I assumed that a
> > esriPolygon was just a OGC Polygon, so with outer ring first and then
> > inner rings. Fixing the code to support multi polygons should basically
> > be a matter of calling OGRGeometryFactory::organizePolygons.
> 
> Thanks Even. Anyway to call this organize polygons via the python API as a
> short term fix?

No, C++ "internal" method only.

> 
> This message contains information, which may be in confidence and may be
> subject to legal privilege. If you are not the intended recipient, you
> must not peruse, use, disseminate, distribute or copy this message. If you
> have received this message in error, please notify us immediately (Phone
> 0800 665 463 or info at linz.govt.nz) and destroy the original message. LINZ
> accepts no responsibility for changes to this email, or for any
> attachments, after its transmission from LINZ. Thank You.

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From patdevelop at gmail.com  Thu Jun 26 21:25:48 2014
From: patdevelop at gmail.com (Patrick Sunter)
Date: Fri, 27 Jun 2014 14:25:48 +1000
Subject: [gdal-dev] gdal_calc.py not saving correct statistics (min/max)
 to new rasters in some cases?
In-Reply-To: <CALOKYXXGes5bDnVAqWMgsP=Wuv0sW1b3wAgnKK+_krF=Fbd=8w@mail.gmail.com>
References: <CALOKYXW8N63n06DX2yfVOYUei+NJH7_qrLg1isqZ0NREx4weGg@mail.gmail.com>
	<CALOKYXXGes5bDnVAqWMgsP=Wuv0sW1b3wAgnKK+_krF=Fbd=8w@mail.gmail.com>
Message-ID: <CALOKYXVHujG9Py8kboN=LBi-y_Cs3XrxSKy4KA7SVABhf-N0Kw@mail.gmail.com>

No comments on the below anyone?

It does seem like a genuine bug that gdal_calc.py can produce output with
statistics not up to date?

Should I create an issue in the issue tracker?

-- Patrick.


On Thu, Jun 19, 2014 at 2:45 PM, Patrick Sunter <patdevelop at gmail.com>
wrote:

> Hi there,
>
> I've been using gdal_calc.py as part of a workflow where I need to compute
> the average of several raster files and save as a new output. (Using a
> binary build of GDAL, v 1.10.0, on Mac Os X).
>
> It is a fairly standard calc operation (e.g. "(A+B+C)/3") but because the
> original data are GeoTiff's storing data in a Byte format, I first create
> VRT files referencing these with data type set to be Float32, then perform
> the calc operation with these VRT files as input. This is to prevent
> 'overflow' problems in the midst of the averaging operation given the size
> limit of the Byte format (see
> http://gis.stackexchange.com/questions/33152/why-do-i-get-different-results-with-gdal-calc-within-the-osgeo4w-shell-and-qgis
> )
>
> The output GeoTiff created by gdal_calc.py seems to be have correct values
> at every point - but the saved statistics metadata are wrong -
> specifically, the minimum value.
>
> An example is doing a gdalinfo -stats on one of these files, I get the
> following:
>   Min=21.000 Max=128.000
>   Minimum=21.000, Maximum=128.000, Mean=81.692, StdDev=29.397
>
> but I know the minimum value should be 0, and this is confirmed by
> inspection in QGIS. I also wrote a script to open up the raster in Python
> and run the following queries:
>
> print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
> print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
> print "Hand calc. min: " + str(min(map(min, raster_values)))
>
> I get:
> GetStatistics(): [21.0, 128.0, 81.692344139650999, 29.397484687917]
> ComputeRasterMinMax(): (0.0, 120.0)
> Hand calc. min: 0
>
> So you can see that ComputeRasterMinMax() is returning the right values,
> as well as my manual calc using Python's min function.
>
> As a user I presume its reasonable for the output of a   gdal_calc.py to
> have latest stats stored correctly on any output it produces? So what is
> going wrong?
>
> Maybe its something to do with doing a calc on a set of VRT files using a
> different type to the original. This is also a case where the output file
> already exists.
>
> Looking at the gdal_calc.py I guess a simple fix is to force an update of
> statistic values using ComputeRasterMinMax() before closing the newly
> created file, but maybe there is a better solution.
>
> cheers, Patrick.
>
> BTW example gdal_calc.py command:
> gdal_calc.py -A
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_45_00-BZEV1.vrt
> -B
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_50_00-BZEV1.vrt
> -C
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_55_00-BZEV1.vrt
> -D
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1.vrt
> -E
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_05_00-BZEV1.vrt
> -F
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_10_00-BZEV1.vrt
> -G
> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_15_00-BZEV1.vrt
> --outfile=./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1-avg7.tiff
> --calc="(A+B+C+D+E+F+G)/7" --type=Byte --overwrite
>
> And full testing script on output:
> #!/usr/bin/env python
> from osgeo import ogr
> from osgeo import gdal
>
>
> in_file="./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/CHADSTONE-22_00_00-BZEV1-avg7.tiff"
>
> ds_in = gdal.Open(in_file)
> band_in = ds_in.GetRasterBand(1)
> xsize_in = band_in.XSize
> ysize_in = band_in.YSize
> raster_values = band_in.ReadAsArray(0, 0, xsize_in, ysize_in)
>
> print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
> print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
> print "Hand calc. min: " + str(min(map(min, raster_values)))
>
> I can provide some sample input if needed for testing too.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/509e725e/attachment-0001.html>

From cavallini at faunalia.it  Thu Jun 26 22:59:06 2014
From: cavallini at faunalia.it (Paolo Cavallini)
Date: Fri, 27 Jun 2014 07:59:06 +0200
Subject: [gdal-dev] OT: openev(2) alternative?
In-Reply-To: <201406262211.46162.even.rouault@mines-paris.org>
References: <53A42F8C.2060506@sarvision.nl>
	<201406262211.46162.even.rouault@mines-paris.org>
Message-ID: <53AD082A.8020105@faunalia.it>

Il 26/06/2014 22:11, Even Rouault ha scritto:
> Le vendredi 20 juin 2014 14:56:44, Vincent Schut a ?crit :

>> I just need something that is good in displaying (browsing, zooming)
>> multi-band raster files. Anybody knows a viable alternative?

Please have a look to QGIS 2.4, to be released today: it has now multithreaded
display, considerably faster.
All the best.

-- 
Paolo Cavallini - www.faunalia.eu
Corsi QGIS e PostGIS: http://www.faunalia.eu/training.html

From mikesaunt at astuntechnology.com  Thu Jun 26 23:09:21 2014
From: mikesaunt at astuntechnology.com (Mike Saunt)
Date: Fri, 27 Jun 2014 07:09:21 +0100
Subject: [gdal-dev] ogr2ogr.py
Message-ID: <CAPzX8H+RUXamHx5utG=Z+emSfQ+2sYzwWFSVr2eBcUi+gF0myA@mail.gmail.com>

Hi
?
I've updated ogr2ogr.py
<http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2ogr.py> with
a really small change which is to accept the -dialect parameter that is now
available.  I'm wondering how / what the process is for submitting back.
?
?If someone could let me know or pointing me to the relevant web page with
details it would be much appreciated

Many thanks
Mike?

-- 
??

--

*Mike Saunt*
Astun Technology Ltd, The Coach House, 17 West Street, Epsom, Surrey, KT18
7RL, UK
t:+44 1372 744 009 m:+44 788 7777 680
*****************************************
iShare - Data integration and publishing platform
<http://www.astuntechnology.com>
 See the new Helpdesk and Customer portal
<http://support.astuntechnology.com>
*****************************************

See our customer commendations and awards
<http://astuntechnology.com/customers/awards-and-commendations/>

 Company registration no. 5410695. Registered in England and Wales.
Registered office: 120 Manor Green Road, Epsom, Surrey, KT19 8LN VAT no.
864201149.

-- 
 <https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/519c1769/attachment.html>

From chaitanya.ch at gmail.com  Thu Jun 26 23:40:33 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri, 27 Jun 2014 12:10:33 +0530
Subject: [gdal-dev] ogr2ogr.py
In-Reply-To: <CAPzX8H+RUXamHx5utG=Z+emSfQ+2sYzwWFSVr2eBcUi+gF0myA@mail.gmail.com>
References: <CAPzX8H+RUXamHx5utG=Z+emSfQ+2sYzwWFSVr2eBcUi+gF0myA@mail.gmail.com>
Message-ID: <CAMKgpOZd67z4OFB0KeC9vNO2Cbxqa8Bp2e29iCyqoGrwYK1KRg@mail.gmail.com>

Mike,

Thanks for the update. But, I have to mention that the python scripts are
primarily to serve as examples.

You can submit a ticket (bug report) on gdal trac and attach a diff patch
along with the description.
http://trac.osgeo.org/gdal/#BugTracking

One of the committers should pick it up.



On Fri, Jun 27, 2014 at 11:39 AM, Mike Saunt <mikesaunt at astuntechnology.com>
wrote:

> Hi
> ?
> I've updated ogr2ogr.py
> <http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2ogr.py>
> with a really small change which is to accept the -dialect parameter that
> is now available.  I'm wondering how / what the process is for submitting
> back.
> ?
> ?If someone could let me know or pointing me to the relevant web page with
> details it would be much appreciated
>
> Many thanks
> Mike?
>
> --
> ??
>
> --
>
> *Mike Saunt*
> Astun Technology Ltd, The Coach House, 17 West Street, Epsom, Surrey, KT18
> 7RL, UK
> t:+44 1372 744 009 m:+44 788 7777 680
> *****************************************
> iShare - Data integration and publishing platform
> <http://www.astuntechnology.com>
>  See the new Helpdesk and Customer portal
> <http://support.astuntechnology.com>
> *****************************************
>
> See our customer commendations and awards
> <http://astuntechnology.com/customers/awards-and-commendations/>
>
>  Company registration no. 5410695. Registered in England and Wales.
> Registered office: 120 Manor Green Road, Epsom, Surrey, KT19 8LN VAT no.
> 864201149.
>
>  <https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Best regards,
Chaitanya kumar CH.

+91-9494447584
17.2416N 80.1426E
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/c4d2d9a5/attachment.html>

From mikesaunt at astuntechnology.com  Fri Jun 27 00:17:50 2014
From: mikesaunt at astuntechnology.com (Mike Saunt)
Date: Fri, 27 Jun 2014 08:17:50 +0100
Subject: [gdal-dev] ogr2ogr.py
In-Reply-To: <CAMKgpOZd67z4OFB0KeC9vNO2Cbxqa8Bp2e29iCyqoGrwYK1KRg@mail.gmail.com>
References: <CAPzX8H+RUXamHx5utG=Z+emSfQ+2sYzwWFSVr2eBcUi+gF0myA@mail.gmail.com>
	<CAMKgpOZd67z4OFB0KeC9vNO2Cbxqa8Bp2e29iCyqoGrwYK1KRg@mail.gmail.com>
Message-ID: <CAPzX8HLkfOY9Pk=wdmaY40=BSOa2Z3VabVycwd8=UaPWmR=pog@mail.gmail.com>

Cool, and understood. It caught me out, that is all and I'd like to make
sure it doesn't for others...

Sent from my phone which isn't an iPhone
On 27 Jun 2014 07:40, "Chaitanya kumar CH" <chaitanya.ch at gmail.com> wrote:

> Mike,
>
> Thanks for the update. But, I have to mention that the python scripts are
> primarily to serve as examples.
>
> You can submit a ticket (bug report) on gdal trac and attach a diff patch
> along with the description.
> http://trac.osgeo.org/gdal/#BugTracking
>
> One of the committers should pick it up.
>
>
>
> On Fri, Jun 27, 2014 at 11:39 AM, Mike Saunt <
> mikesaunt at astuntechnology.com> wrote:
>
>> Hi
>> ?
>> I've updated ogr2ogr.py
>> <http://svn.osgeo.org/gdal/trunk/gdal/swig/python/samples/ogr2ogr.py>
>> with a really small change which is to accept the -dialect parameter that
>> is now available.  I'm wondering how / what the process is for submitting
>> back.
>> ?
>> ?If someone could let me know or pointing me to the relevant web page
>> with details it would be much appreciated
>>
>> Many thanks
>> Mike?
>>
>> --
>> ??
>>
>> --
>>
>> *Mike Saunt*
>> Astun Technology Ltd, The Coach House, 17 West Street, Epsom, Surrey,
>> KT18 7RL, UK
>> t:+44 1372 744 009 m:+44 788 7777 680
>> *****************************************
>> iShare - Data integration and publishing platform
>> <http://www.astuntechnology.com>
>>  See the new Helpdesk and Customer portal
>> <http://support.astuntechnology.com>
>> *****************************************
>>
>> See our customer commendations and awards
>> <http://astuntechnology.com/customers/awards-and-commendations/>
>>
>>  Company registration no. 5410695. Registered in England and Wales.
>> Registered office: 120 Manor Green Road, Epsom, Surrey, KT19 8LN VAT no.
>> 864201149.
>>
>>  <https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
>
> --
> Best regards,
> Chaitanya kumar CH.
>
> +91-9494447584
> 17.2416N 80.1426E
>

-- 
 <https://astuntechnology.com/ishare/2014-enterprise-gis-roadshows/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/5e433010/attachment.html>

From chaitanya.ch at gmail.com  Fri Jun 27 01:12:20 2014
From: chaitanya.ch at gmail.com (Chaitanya kumar CH)
Date: Fri, 27 Jun 2014 13:42:20 +0530
Subject: [gdal-dev] gdal_calc.py not saving correct statistics (min/max)
 to new rasters in some cases?
In-Reply-To: <CALOKYXVHujG9Py8kboN=LBi-y_Cs3XrxSKy4KA7SVABhf-N0Kw@mail.gmail.com>
References: <CALOKYXW8N63n06DX2yfVOYUei+NJH7_qrLg1isqZ0NREx4weGg@mail.gmail.com>
	<CALOKYXXGes5bDnVAqWMgsP=Wuv0sW1b3wAgnKK+_krF=Fbd=8w@mail.gmail.com>
	<CALOKYXVHujG9Py8kboN=LBi-y_Cs3XrxSKy4KA7SVABhf-N0Kw@mail.gmail.com>
Message-ID: <CAMKgpObScDnPYt_d_px3Gug_Y==LwFH2n9RZQXGWygMgG8wnPQ@mail.gmail.com>

Patrick,
Can you send me the sample data?

--
Best regards,
Chaitanya Kumar CH
On 27-Jun-2014 9:56 am, "Patrick Sunter" <patdevelop at gmail.com> wrote:

> No comments on the below anyone?
>
> It does seem like a genuine bug that gdal_calc.py can produce output with
> statistics not up to date?
>
> Should I create an issue in the issue tracker?
>
> -- Patrick.
>
>
> On Thu, Jun 19, 2014 at 2:45 PM, Patrick Sunter <patdevelop at gmail.com>
> wrote:
>
>> Hi there,
>>
>> I've been using gdal_calc.py as part of a workflow where I need to
>> compute the average of several raster files and save as a new output.
>> (Using a binary build of GDAL, v 1.10.0, on Mac Os X).
>>
>> It is a fairly standard calc operation (e.g. "(A+B+C)/3") but because the
>> original data are GeoTiff's storing data in a Byte format, I first create
>> VRT files referencing these with data type set to be Float32, then perform
>> the calc operation with these VRT files as input. This is to prevent
>> 'overflow' problems in the midst of the averaging operation given the size
>> limit of the Byte format (see
>> http://gis.stackexchange.com/questions/33152/why-do-i-get-different-results-with-gdal-calc-within-the-osgeo4w-shell-and-qgis
>> )
>>
>> The output GeoTiff created by gdal_calc.py seems to be have correct
>> values at every point - but the saved statistics metadata are wrong -
>> specifically, the minimum value.
>>
>> An example is doing a gdalinfo -stats on one of these files, I get the
>> following:
>>   Min=21.000 Max=128.000
>>   Minimum=21.000, Maximum=128.000, Mean=81.692, StdDev=29.397
>>
>> but I know the minimum value should be 0, and this is confirmed by
>> inspection in QGIS. I also wrote a script to open up the raster in Python
>> and run the following queries:
>>
>> print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
>> print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
>> print "Hand calc. min: " + str(min(map(min, raster_values)))
>>
>> I get:
>> GetStatistics(): [21.0, 128.0, 81.692344139650999, 29.397484687917]
>> ComputeRasterMinMax(): (0.0, 120.0)
>> Hand calc. min: 0
>>
>> So you can see that ComputeRasterMinMax() is returning the right values,
>> as well as my manual calc using Python's min function.
>>
>> As a user I presume its reasonable for the output of a   gdal_calc.py to
>> have latest stats stored correctly on any output it produces? So what is
>> going wrong?
>>
>> Maybe its something to do with doing a calc on a set of VRT files using a
>> different type to the original. This is also a case where the output file
>> already exists.
>>
>> Looking at the gdal_calc.py I guess a simple fix is to force an update of
>> statistic values using ComputeRasterMinMax() before closing the newly
>> created file, but maybe there is a better solution.
>>
>> cheers, Patrick.
>>
>> BTW example gdal_calc.py command:
>> gdal_calc.py -A
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_45_00-BZEV1.vrt
>> -B
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_50_00-BZEV1.vrt
>> -C
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-21_55_00-BZEV1.vrt
>> -D
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1.vrt
>> -E
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_05_00-BZEV1.vrt
>> -F
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_10_00-BZEV1.vrt
>> -G
>> ./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_15_00-BZEV1.vrt
>> --outfile=./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/SURREY_HILLS-22_00_00-BZEV1-avg7.tiff
>> --calc="(A+B+C+D+E+F+G)/7" --type=Byte --overwrite
>>
>> And full testing script on output:
>> #!/usr/bin/env python
>> from osgeo import ogr
>> from osgeo import gdal
>>
>>
>> in_file="./Comparison-PTV-BZE-V1-201406-ForPres-30minWindows-3eachSide/MelbTrainTramBus-BZE-autostops-withcongestion-WithMotorways-updated-20140514/CHADSTONE-22_00_00-BZEV1-avg7.tiff"
>>
>> ds_in = gdal.Open(in_file)
>> band_in = ds_in.GetRasterBand(1)
>> xsize_in = band_in.XSize
>> ysize_in = band_in.YSize
>> raster_values = band_in.ReadAsArray(0, 0, xsize_in, ysize_in)
>>
>> print "GetStatistics(): " + str(band_in.GetStatistics(True, True))
>> print "ComputeRasterMinMax(): " + str(band_in.ComputeRasterMinMax())
>> print "Hand calc. min: " + str(min(map(min, raster_values)))
>>
>> I can provide some sample input if needed for testing too.
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/ab70854f/attachment-0001.html>

From srp at geo.ku.dk  Fri Jun 27 06:52:49 2014
From: srp at geo.ku.dk (Simon Richard Proud)
Date: Fri, 27 Jun 2014 13:52:49 +0000
Subject: [gdal-dev] MSG Driver: two memory leaks
In-Reply-To: <201406262248.53806.even.rouault@mines-paris.org>
References: <53ABE676.1030102@mathematik.uni-marburg.de>
	<6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>,
	<201406262248.53806.even.rouault@mines-paris.org>
Message-ID: <6C59A8A933C9B6409067456EC20EAB368868883C@P2KITMBX06WC03.unicph.domain>

Hello,
We actually stopped using the GDAL MSG driver some time ago (as it is very slow) and wrote our own one instead. My mail was mainly to find out if others have experienced similar problems.

The problem is not from the EUMETSAT libraries, by the way. We have been using them with very small memory use (they only decompress the data). The memory use is coming from somewhere in the reflectance calculations. They seem well hidden but, as Christian mentioned, a valgrind could well find them.

All the best,
Simon
________________________________________
Fra: Even Rouault [even.rouault at mines-paris.org]
Sendt: 26. juni 2014 16:48
Til: gdal-dev at lists.osgeo.org
Cc: Simon Richard Proud
Emne: Re: [gdal-dev] MSG Driver: two memory leaks

Le jeudi 26 juin 2014 16:14:03, Simon Richard Proud a ?crit :
> Hi,
> Have you noticed any other memory leaks in the MSG driver? We have seen
> some huge memory uses when working with the visible MSG channels
> (converting from DN to Reflectance) but have not been able to track down
> where the memory is being used. Would be good to have a second opinion!

Simon,

I just wanted to mention I can be available for contractual support on GDAL if
you need.

It might not be to be excluded that the leak might be in the Eumetsat library
itself.

Best regards,

Even


>
> All the best,
> Simon
>
> ________________________________________
> Fra: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org]
> p&#229; vegne af Christian Authmann [authmanc at Mathematik.Uni-Marburg.de]
> Sendt: 26. juni 2014 05:23
> Til: gdal-dev at lists.osgeo.org
> Emne: [gdal-dev] MSG Driver: two memory leaks
>
> Hello,
>
> valgrind'ing my application revealed two memory leaks in msgdataset.cpp.
>
> a) MSGDataset::pszProjection shall always point to a valid string during
> the lifetime of the object; the old string needs to be released before
> getting a new one from exportToWkt().
>
> b) A spatial reference is exported to a temporary string as WKT, but the
> string is never released.
>
>
> Attached you'll find a patch fixing both; valgrind confirms that both
> memory leaks are gone.
>
>
> --
> Christian Authmann
> Philipps-Universit?t Marburg
> Fachbereich Mathematik und Informatik
> AG Datenbanksysteme
> Hans-Meerwein-Stra?e
> D-35032 Marburg
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev

--
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Fri Jun 27 06:56:30 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Fri, 27 Jun 2014 15:56:30 +0200
Subject: [gdal-dev] MSG Driver: two memory leaks
In-Reply-To: <6C59A8A933C9B6409067456EC20EAB368868883C@P2KITMBX06WC03.unicph.domain>
References: <53ABE676.1030102@mathematik.uni-marburg.de>
	<6C59A8A933C9B6409067456EC20EAB368868778E@P2KITMBX06WC03.unicph.domain>,
	<201406262248.53806.even.rouault@mines-paris.org>
	<6C59A8A933C9B6409067456EC20EAB368868883C@P2KITMBX06WC03.unicph.domain>
Message-ID: <1403877390.53ad780e01f74@imp.free.fr>

Selon Simon Richard Proud <srp at geo.ku.dk>:

> Hello,
> We actually stopped using the GDAL MSG driver some time ago (as it is very
> slow) and wrote our own one instead.

Something that you would want to contribute ?

> My mail was mainly to find out if others
> have experienced similar problems.
>
> The problem is not from the EUMETSAT libraries, by the way. We have been
> using them with very small memory use (they only decompress the data). The
> memory use is coming from somewhere in the reflectance calculations. They
> seem well hidden but, as Christian mentioned, a valgrind could well find
> them.

The GDAL MSG driver is of modest size so that should be not too hard to track
down hopefully.
Do you have samples of such images and the GDAL connection string used ?

Even

>
> All the best,
> Simon
> ________________________________________
> Fra: Even Rouault [even.rouault at mines-paris.org]
> Sendt: 26. juni 2014 16:48
> Til: gdal-dev at lists.osgeo.org
> Cc: Simon Richard Proud
> Emne: Re: [gdal-dev] MSG Driver: two memory leaks
>
> Le jeudi 26 juin 2014 16:14:03, Simon Richard Proud a ?crit :
> > Hi,
> > Have you noticed any other memory leaks in the MSG driver? We have seen
> > some huge memory uses when working with the visible MSG channels
> > (converting from DN to Reflectance) but have not been able to track down
> > where the memory is being used. Would be good to have a second opinion!
>
> Simon,
>
> I just wanted to mention I can be available for contractual support on GDAL
> if
> you need.
>
> It might not be to be excluded that the leak might be in the Eumetsat library
> itself.
>
> Best regards,
>
> Even
>
>
> >
> > All the best,
> > Simon
> >
> > ________________________________________
> > Fra: gdal-dev-bounces at lists.osgeo.org [gdal-dev-bounces at lists.osgeo.org]
> > p&#229; vegne af Christian Authmann [authmanc at Mathematik.Uni-Marburg.de]
> > Sendt: 26. juni 2014 05:23
> > Til: gdal-dev at lists.osgeo.org
> > Emne: [gdal-dev] MSG Driver: two memory leaks
> >
> > Hello,
> >
> > valgrind'ing my application revealed two memory leaks in msgdataset.cpp.
> >
> > a) MSGDataset::pszProjection shall always point to a valid string during
> > the lifetime of the object; the old string needs to be released before
> > getting a new one from exportToWkt().
> >
> > b) A spatial reference is exported to a temporary string as WKT, but the
> > string is never released.
> >
> >
> > Attached you'll find a patch fixing both; valgrind confirms that both
> > memory leaks are gone.
> >
> >
> > --
> > Christian Authmann
> > Philipps-Universit?t Marburg
> > Fachbereich Mathematik und Informatik
> > AG Datenbanksysteme
> > Hans-Meerwein-Stra?e
> > D-35032 Marburg
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>



From alex.jong0019 at gmail.com  Fri Jun 27 07:10:46 2014
From: alex.jong0019 at gmail.com (00darki)
Date: Fri, 27 Jun 2014 07:10:46 -0700 (PDT)
Subject: [gdal-dev]  gdal 1.11 unable to read netcdf files
Message-ID: <1403878246618-5148406.post@n6.nabble.com>

Hi,
I'm new on the mailing list, and to begin i want to apologize for my bad
english skill.
I hope you could help me, i've a problem with gdal to read netcdf (.nc)
files.

In gdal_formats.txt , i found the line :
"netCDF (rw+s): Network Common Data Format"

But if i run *gdalinfo.exe --formats* , netcdf driver doesn't appear.

And if I try something on a netcdf file : 

*d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe D:/GDAL/MapServer/mnt00000.nc
ERROR 4: `D:/GDAL/MapServer/mnt00000.nc' not recognised as a supported file
format.

gdalinfo failed - unable to open 'D:/GDAL/MapServer/mnt00000.nc'.*

and same thing with :

*d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe
NETCDF:"D:/GDAL/MapServer/mnt00000.nc"
ERROR 4: `NETCDF:D:/GDAL/MapServer/mnt00000.nc' does not exist in the file
system,
and is not recognised as a supported dataset name.

gdalinfo failed - unable to open 'NETCDF:D:/GDAL/MapServer/mnt00000.nc'.*

But i've a file called "gdal_netCDF.dll" in gdal plugin and a file
"netcdf.dll" in bin directory..
I don't understand why gdal couldn't read any netcdf file ..
I'm using gdal version 1.11 and windows 7 x64.

Thank you for any help :)





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-1-11-unable-to-read-netcdf-files-tp5148406.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From etourigny.dev at gmail.com  Fri Jun 27 07:51:56 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 27 Jun 2014 11:51:56 -0300
Subject: [gdal-dev] gdal 1.11 unable to read netcdf files
In-Reply-To: <1403878246618-5148406.post@n6.nabble.com>
References: <1403878246618-5148406.post@n6.nabble.com>
Message-ID: <CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>

It would help if you tell use how you installed gdal-1.11. Also where did
this gdal_formats.txt file come from?


On Fri, Jun 27, 2014 at 11:10 AM, 00darki <alex.jong0019 at gmail.com> wrote:

> Hi,
> I'm new on the mailing list, and to begin i want to apologize for my bad
> english skill.
> I hope you could help me, i've a problem with gdal to read netcdf (.nc)
> files.
>
> In gdal_formats.txt , i found the line :
> "netCDF (rw+s): Network Common Data Format"
>
> But if i run *gdalinfo.exe --formats* , netcdf driver doesn't appear.
>
> And if I try something on a netcdf file :
>
> *d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe D:/GDAL/MapServer/
> mnt00000.nc
> ERROR 4: `D:/GDAL/MapServer/mnt00000.nc' not recognised as a supported
> file
> format.
>
> gdalinfo failed - unable to open 'D:/GDAL/MapServer/mnt00000.nc'.*
>
> and same thing with :
>
> *d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe
> NETCDF:"D:/GDAL/MapServer/mnt00000.nc"
> ERROR 4: `NETCDF:D:/GDAL/MapServer/mnt00000.nc' does not exist in the file
> system,
> and is not recognised as a supported dataset name.
>
> gdalinfo failed - unable to open 'NETCDF:D:/GDAL/MapServer/mnt00000.nc'.*
>
> But i've a file called "gdal_netCDF.dll" in gdal plugin and a file
> "netcdf.dll" in bin directory..
> I don't understand why gdal couldn't read any netcdf file ..
> I'm using gdal version 1.11 and windows 7 x64.
>
> Thank you for any help :)
>
>
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-1-11-unable-to-read-netcdf-files-tp5148406.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/ac9670c2/attachment.html>

From alex.jong0019 at gmail.com  Fri Jun 27 08:11:32 2014
From: alex.jong0019 at gmail.com (00darki)
Date: Fri, 27 Jun 2014 08:11:32 -0700 (PDT)
Subject: [gdal-dev] gdal 1.11 unable to read netcdf files
In-Reply-To: <1403881306082-5148428.post@n6.nabble.com>
References: <1403878246618-5148406.post@n6.nabble.com>
	<CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>
	<1403881306082-5148428.post@n6.nabble.com>
Message-ID: <1403881892920-5148434.post@n6.nabble.com>

..I found a solution, simply copy .dll files in a subdirectory called
/gdalplugins in the /apps directory .. it seems to works fine (with an error
on gdal_GEOR.dll)

*d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe D:/GDAL/MapServer/mnt00000.nc
ERROR 1: Can't load requested DLL:
d:\GDAL\gdal-1-11\bin\gdal\apps\gdalplugins\gdal_GEOR.dll
193: %1 n?est pas une application Win32 valide.

ERROR 1: Can't load requested DLL:
d:\GDAL\gdal-1-11\bin\gdal\apps\gdalplugins\gdal_GEOR.dll
193: %1 n?est pas une application Win32 valide.

Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
Driver: netCDF/Network Common Data Format
Files: D:/GDAL/MapServer/mnt00000.nc
Size is 4321, 2161
Coordinate System is `'
Metadata:
  NC_GLOBAL#latitude_max=90
  NC_GLOBAL#latitude_min=-90
  NC_GLOBAL#longitude_max=180
  NC_GLOBAL#longitude_min=-180
  profondeurs#desc=GRILLE
  profondeurs#name=Profondeur
  profondeurs#units=metre
Corner Coordinates:
Upper Left  (    0.0,    0.0)
Lower Left  (    0.0, 2161.0)
Upper Right ( 4321.0,    0.0)
Lower Right ( 4321.0, 2161.0)
Center      ( 2160.5, 1080.5)
Band 1 Block=4321x1 Type=Float32, ColorInterp=Undefined
  NoData Value=9.969209968386869e+036
  Metadata:
    desc=GRILLE
    name=Profondeur
    NETCDF_VARNAME=profondeurs
    units=metre*

Thank you for your answer :)
Problem solved



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-1-11-unable-to-read-netcdf-files-tp5148406p5148434.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From alex.jong0019 at gmail.com  Fri Jun 27 08:01:46 2014
From: alex.jong0019 at gmail.com (00darki)
Date: Fri, 27 Jun 2014 08:01:46 -0700 (PDT)
Subject: [gdal-dev] gdal 1.11 unable to read netcdf files
In-Reply-To: <CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>
References: <1403878246618-5148406.post@n6.nabble.com>
	<CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>
Message-ID: <1403881306082-5148428.post@n6.nabble.com>

To install gdal, I use release available on :
http://www.gisinternals.com/sdk/
(release-1600-x64-gdal-1-11-0-mapserver-6-4-1)

I try different release, same resultat.

GDAL and OGR work fine for any other file format, i've used gdalcontour,
shp2img, buildvrt abd other command without problem on my DTED data, but I
can't do anything on netCDF data.

gdal_formats.txt come from doc folder, in gdal release at first level
directory (there are the "bin" folder and the "doc" folder)
In doc folder, there are gdal_version.txt , gdal_formats.txt ,
ogr_formats.txt and some others txt files.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-1-11-unable-to-read-netcdf-files-tp5148406p5148428.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jlmcgraw at gmail.com  Fri Jun 27 10:49:35 2014
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Fri, 27 Jun 2014 13:49:35 -0400
Subject: [gdal-dev] gdaltranslate and gdalwarp rotating and resizing image
 without being asked to, why?
Message-ID: <CA+XueT2r7kQp1d_5B-wMTec9dY_CXxc8tSZRzKGKYU9XPsxTTA@mail.gmail.com>

Gdal gurus,

I'm writing a utility to automatically georeference Instrument Approach
Procedures and Airport Diagrams from the FAA (github.com/jlmcgraw, if
you're curious) and I'm hoping for some insight from the experts here as to
why I'm seeing the following behavior with Airport Diagrams

Most of the Airport Diagrams diagrams are portrait orientation (True North
up), however some of them are actually laid out in landscape orientation
(True North to the left or right) though the source PDF is still in portrait

If I georeference these landscape oriented using GCPs then gdalwarp will
swap X and Y axes and also resize the resulting bitmap (it also resizes
portrait oriented ones too, though without swapping axes)

My questions:
1) Why is gdalwarp swapping the axes rather than using the X and Y
pixel-skew parameters of the affine transformation (seems to be always 0)?
2) Why is it re-sizing the bitmap?
3) Do I have to do both of these steps separately (translate and then warp)
or can I simplify somehow?

Steps in the process:

1) Generate a list of Ground Control Points from the PDF, rasterize the PDF
to a 300dpi PNG

2) gdal_translate .PNG to an intermediate .VRT
("gdal_translate -q -of VRT -strict -a_srs EPSG:4326 $gcpstring
'$targetpng'  '$targetvrt'")

3) gdalwarp intermediate .VRT to get the final georeferenced output .VRT
 ("gdalwarp -q -of VRT -t_srs EPSG:4326 -order 1 -overwrite ''$targetvrt''
'$targetvrt2'")




*example from a landscape diagram*

(snippet of step 2 output from gdal_translate'd .vrt)
CA-SFO-00375AD-PDF-AIRPORT-DIAGRAM.vrt:
*<VRTDataset rasterXSize="1613" rasterYSize="2475">*

(snippet of step 3 output from gdalwarp'd .vrt)
warpedCA-SFO-00375AD.PDF-AIRPORT\ DIAGRAM.vrt:
*<VRTDataset rasterXSize="2623" rasterYSize="1359"
subClass="VRTWarpedDataset">*
*<GeoTransform> -1.2242081739746585e+02,  2.9114844968978991e-05,
0.0000000000000000e+00,  3.7641622693302779e+01,  0.0000000000000000e+00,
-2.9114844968978991e-05</GeoTransform>*


*example from a portrait diagram*
          (snippet of step 2 output from gdal_translate'd .vrt)
*VA-RIC-00347AD-PDF-AIRPORT-*
*DIAGRAM.vrt*
*<VRTDataset rasterXSize="1613" rasterYSize="2475">*

(snippet of step 3 output from gdalwarp'd .vrt)
*warpedVA-RIC-00347AD.PDF-*
*AIRPORT\ DIAGRAM.vrt*



*<VRTDataset rasterXSize="1870" rasterYSize="2287"
subClass="VRTWarpedDataset"><GeoTransform> -7.7341103107298423e+01,
2.1580033523515700e-05,  0.0000000000000000e+00,  3.7529840835409082e+01,
0.0000000000000000e+00, -2.1580033523515700e-05</GeoTransform>*
Thanks!
-Jesse McGraw
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/6f660b8e/attachment-0001.html>

From aperi2007 at gmail.com  Fri Jun 27 10:57:20 2014
From: aperi2007 at gmail.com (Andrea Peri)
Date: Fri, 27 Jun 2014 19:57:20 +0200
Subject: [gdal-dev] How open a subset dataset with python
In-Reply-To: <201406262330.42712.even.rouault@mines-paris.org>
References: <CABqTJk9BoFQLigeamnUEwJVkzvoF6-B1RWLjAzoQXjB8oEhpWQ@mail.gmail.com>
	<CABqTJk8VaFoqZsRXVf7+Ce9B2gotxYiy_Q30AYsEw4BHUBX=zg@mail.gmail.com>
	<201406262330.42712.even.rouault@mines-paris.org>
Message-ID: <CABqTJk9MP9qqL2mH-_Gd8GGqgrZiUwQjCGBVtwQGkro-42f4Jw@mail.gmail.com>

Thx Even,

I try it.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/ba224f87/attachment.html>

From etourigny.dev at gmail.com  Fri Jun 27 11:00:48 2014
From: etourigny.dev at gmail.com (Etienne Tourigny)
Date: Fri, 27 Jun 2014 15:00:48 -0300
Subject: [gdal-dev] gdal 1.11 unable to read netcdf files
In-Reply-To: <1403881892920-5148434.post@n6.nabble.com>
References: <1403878246618-5148406.post@n6.nabble.com>
	<CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>
	<1403881306082-5148428.post@n6.nabble.com>
	<1403881892920-5148434.post@n6.nabble.com>
Message-ID: <CA+TxYvOD_=ijpdnnmsO2yAZ3YmUB7rSv5oOQPU-u9+y+OH8z3A@mail.gmail.com>

If these plugin files came from gisinternals and netcdf is not supported
without moving the plugin files to another directory, then that is a bug in
gisinternals. Perhaps Tamas can comment on this?

Etienne


On Fri, Jun 27, 2014 at 12:11 PM, 00darki <alex.jong0019 at gmail.com> wrote:

> ..I found a solution, simply copy .dll files in a subdirectory called
> /gdalplugins in the /apps directory .. it seems to works fine (with an
> error
> on gdal_GEOR.dll)
>
> *d:\GDAL\gdal-1-11\bin\gdal\apps>gdalinfo.exe D:/GDAL/MapServer/
> mnt00000.nc
> ERROR 1: Can't load requested DLL:
> d:\GDAL\gdal-1-11\bin\gdal\apps\gdalplugins\gdal_GEOR.dll
> 193: %1 n?est pas une application Win32 valide.
>
> ERROR 1: Can't load requested DLL:
> d:\GDAL\gdal-1-11\bin\gdal\apps\gdalplugins\gdal_GEOR.dll
> 193: %1 n?est pas une application Win32 valide.
>
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute
> Driver: netCDF/Network Common Data Format
> Files: D:/GDAL/MapServer/mnt00000.nc
> Size is 4321, 2161
> Coordinate System is `'
> Metadata:
>   NC_GLOBAL#latitude_max=90
>   NC_GLOBAL#latitude_min=-90
>   NC_GLOBAL#longitude_max=180
>   NC_GLOBAL#longitude_min=-180
>   profondeurs#desc=GRILLE
>   profondeurs#name=Profondeur
>   profondeurs#units=metre
> Corner Coordinates:
> Upper Left  (    0.0,    0.0)
> Lower Left  (    0.0, 2161.0)
> Upper Right ( 4321.0,    0.0)
> Lower Right ( 4321.0, 2161.0)
> Center      ( 2160.5, 1080.5)
> Band 1 Block=4321x1 Type=Float32, ColorInterp=Undefined
>   NoData Value=9.969209968386869e+036
>   Metadata:
>     desc=GRILLE
>     name=Profondeur
>     NETCDF_VARNAME=profondeurs
>     units=metre*
>
> Thank you for your answer :)
> Problem solved
>
>
>
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-1-11-unable-to-read-netcdf-files-tp5148406p5148434.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> http://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/957acfda/attachment.html>

From andre+joost at nurfuerspam.de  Fri Jun 27 11:12:21 2014
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Fri, 27 Jun 2014 20:12:21 +0200
Subject: [gdal-dev] gdal 1.11 unable to read netcdf files
In-Reply-To: <CA+TxYvOD_=ijpdnnmsO2yAZ3YmUB7rSv5oOQPU-u9+y+OH8z3A@mail.gmail.com>
References: <1403878246618-5148406.post@n6.nabble.com>
	<CA+TxYvOsCD=yF4iy6-4TqmVhU8YTD-w-FKxRmOmZkwb-=E0NCA@mail.gmail.com>
	<1403881306082-5148428.post@n6.nabble.com>
	<1403881892920-5148434.post@n6.nabble.com>
	<CA+TxYvOD_=ijpdnnmsO2yAZ3YmUB7rSv5oOQPU-u9+y+OH8z3A@mail.gmail.com>
Message-ID: <lokc89$e24$1@ger.gmane.org>

Am 27.06.2014 20:00, schrieb Etienne Tourigny:
> If these plugin files came from gisinternals and netcdf is not supported
> without moving the plugin files to another directory, then that is a bug in
> gisinternals. Perhaps Tamas can comment on this?
>

Gdalinfo works for me, with GDAL 1.11.0 from Tamas, and the sample files 
from http://trac.osgeo.org/gdal/ticket/4285

Same Windows 7 64bit.

Greetings,
Andr? Joost


From gusevmihs at gmail.com  Fri Jun 27 14:36:06 2014
From: gusevmihs at gmail.com (Mikhail Gusev)
Date: Sat, 28 Jun 2014 01:36:06 +0400
Subject: [gdal-dev] GSoC weekly report 6. GDAL Networking
Message-ID: <CAJB43Vozd6msefd0_MmukbbWG7-QjzYah1b1hxf55TiuKNMcvQ@mail.gmail.com>

Hello everyone.
This is my week 6 report:
http://gsoc2014gnm.blogspot.ru/2014/06/week-6-gnm-in-gdal-20.html. There I
write about the methods of GNM API, which I integrated into GDAL library
(<gdal root>/gnm), and how to use them, for example via a console testing
application which I also implement in <gdal root>/apps.
My current approach of the working on GDAL is that I have a repo on Github
<https://github.com/MikhanGusev/gdal-svn/tree/cmake4gdal> which was forked
from an exterior repo because it had CMakefiles and I could easily build
GDAL and tried to integrate my API. The next week I will change this
approach and make a repo which will be the fork of the official GDAL git
repo, because it seems more convenient to make and share changes of my work
with library. I will continue to move methods from an old API to the
current in this sequence: automatic connectivity creation with some
algorithm, features addition and deletion, working with graph and analysis,
network's business logic.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140628/7296d869/attachment.html>

From kalu671 at gmail.com  Fri Jun 27 20:26:00 2014
From: kalu671 at gmail.com (devendra dahal)
Date: Fri, 27 Jun 2014 22:26:00 -0500
Subject: [gdal-dev] having problem with polygonize
Message-ID: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>

Dear All;

I have some annual landcovder raster datasets (preciously 20) with 7
different types.
Since the datasets covers large area and I just want to see trends of some
wetlands area changes over the year. I planned to subset the wetlands from
the dataset. Then using polygonize.py to convert the raster to polygon and
compute the area of each wetlands extent annually. The below is my concise
code.


file1 = "my_raster.tif"
OutFile = "wetlands.tif"
rastDriver = gdal.GetDriverByName('Gtiff') # reading gdal driver
rastDriver.Register()

src_ds = gdal.Open(file1)

srcband = src_ds.GetRasterBand(1)
cols = src_ds.RasterXSize
rows = src_ds.RasterYSize

Array1 = srcband.ReadAsArray(0, 0, cols, rows)
newArray = numpy.where(Array1 != 5, 0,Array1)


dst_ds = rastDriver.Create(OutFile, cols, rows, bands, GDT_Int16)
dst_ds.SetGeoTransform(geot)
dst_ds.SetProjection(proj)
dst_ds.GetRasterBand(1).WriteArray(newArray)
newArray = None


>From the code above I created wetlands only raster and saved a file. Now
using the line below I tried to convert the wetland raster to polygon.

PolyName = "wetland_poly"
ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "ESRI
Shapefile", PolyName + ".shp", PolyName)

os.system(ConvertPoly)


But it throws the error below.

dst_ds = drv.CreateDataSource( dst_filename )
AttributeError: 'NoneType' object has no attribute 'CreateDataSource'

When I tested qgis raster to vector conversion tool, I get the polygons as
I expected from the wetlands.tif but the polygon file lost the coordinate
system. if I use my_raster.tif in the code above it runs successfully but
runs for more than a hour so obviously I don't want to do this.

Any elegant suggestions for alternative idea or help to fix the script
would be highly appreciated.

Thank you very much

Deven
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/a3afa9d4/attachment.html>

From gdal at stripfamily.net  Fri Jun 27 20:56:54 2014
From: gdal at stripfamily.net (David Strip)
Date: Fri, 27 Jun 2014 21:56:54 -0600
Subject: [gdal-dev] having problem with polygonize
In-Reply-To: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
References: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
Message-ID: <53AE3D06.702@stripfamily.net>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140627/99ab12d3/attachment.html>

From even.rouault at mines-paris.org  Fri Jun 27 23:55:46 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 28 Jun 2014 08:55:46 +0200
Subject: [gdal-dev] having problem with polygonize
In-Reply-To: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
References: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
Message-ID: <201406280855.46120.even.rouault@mines-paris.org>

Le samedi 28 juin 2014 05:26:00, devendra dahal a ?crit :
> Dear All;
> 
> I have some annual landcovder raster datasets (preciously 20) with 7
> different types.
> Since the datasets covers large area and I just want to see trends of some
> wetlands area changes over the year. I planned to subset the wetlands from
> the dataset. Then using polygonize.py to convert the raster to polygon and
> compute the area of each wetlands extent annually. The below is my concise
> code.
> 
> 
> file1 = "my_raster.tif"
> OutFile = "wetlands.tif"
> rastDriver = gdal.GetDriverByName('Gtiff') # reading gdal driver
> rastDriver.Register()
> 
> src_ds = gdal.Open(file1)
> 
> srcband = src_ds.GetRasterBand(1)
> cols = src_ds.RasterXSize
> rows = src_ds.RasterYSize
> 
> Array1 = srcband.ReadAsArray(0, 0, cols, rows)
> newArray = numpy.where(Array1 != 5, 0,Array1)
> 
> 
> dst_ds = rastDriver.Create(OutFile, cols, rows, bands, GDT_Int16)
> dst_ds.SetGeoTransform(geot)
> dst_ds.SetProjection(proj)
> dst_ds.GetRasterBand(1).WriteArray(newArray)
> newArray = None
> 
> 
> From the code above I created wetlands only raster and saved a file. Now
> using the line below I tried to convert the wetland raster to polygon.
> 
> PolyName = "wetland_poly"
> ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "ESRI
> Shapefile", PolyName + ".shp", PolyName)

Deven,

The issue here is the lack of quoting around ESRI Shapefile once it is ingested 
into ConvertPoly.

You likely need something like

ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "\"ESRI 
Shapefile\"", PolyName + ".shp", PolyName)

Using the Python subprocess module might also be less error prone where you 
can pass an array of arguments instead of a string

Hint: shapefile is the default vector format of all OGR utilities. So you don't 
actually need to specify -f "ESRI Shapefile" at all.

Best regards,

Even

> 
> os.system(ConvertPoly)
> 
> 
> But it throws the error below.
> 
> dst_ds = drv.CreateDataSource( dst_filename )
> AttributeError: 'NoneType' object has no attribute 'CreateDataSource'
> 
> When I tested qgis raster to vector conversion tool, I get the polygons as
> I expected from the wetlands.tif but the polygon file lost the coordinate
> system. if I use my_raster.tif in the code above it runs successfully but
> runs for more than a hour so obviously I don't want to do this.
> 
> Any elegant suggestions for alternative idea or help to fix the script
> would be highly appreciated.
> 
> Thank you very much
> 
> Deven

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Sat Jun 28 09:01:27 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 28 Jun 2014 18:01:27 +0200
Subject: [gdal-dev] gdaltranslate and gdalwarp rotating and resizing
	image without being asked to, why?
In-Reply-To: <CA+XueT2r7kQp1d_5B-wMTec9dY_CXxc8tSZRzKGKYU9XPsxTTA@mail.gmail.com>
References: <CA+XueT2r7kQp1d_5B-wMTec9dY_CXxc8tSZRzKGKYU9XPsxTTA@mail.gmail.com>
Message-ID: <201406281801.27910.even.rouault@mines-paris.org>

Jesse,

I'm not completely sure to really understand the axis swapping issue without 
reproducing what you do.
The PDF driver should take into account the PDF rotation parameter when 
rasterizing it (so that it outputs something that is visually identical with 
what other PDF viewers do).

To answer your questions:

1) When not providing an existing target image, gdalwarp will indeed rectify 
images that have an arbitrary transform with skew/rotation terms, or GCPs, to 
an affine transform with squared pixels, which is generally the desired 
behaviour. If you prepare yourself the target dataset with the geotransform 
you whish, you should be able run gdalwarp on it. You can alternatively try 
the -ts option of gdalwarp to force the target dimensions.

2) The resizing is a consequence of the output geotransform being different 
that the source geotransform.

3) You could likely merge your step 1 and 2, i.e. directly generate a .png 
with the SRS and GCP set. However I'd recommand generating a tiled TIFF 
instead to make gdalwarp faster.

Best regards,

Even

Le vendredi 27 juin 2014 19:49:35, Jesse McGraw a ?crit :
> Gdal gurus,
> 
> I'm writing a utility to automatically georeference Instrument Approach
> Procedures and Airport Diagrams from the FAA (github.com/jlmcgraw, if
> you're curious) and I'm hoping for some insight from the experts here as to
> why I'm seeing the following behavior with Airport Diagrams
> 
> Most of the Airport Diagrams diagrams are portrait orientation (True North
> up), however some of them are actually laid out in landscape orientation
> (True North to the left or right) though the source PDF is still in
> portrait
> 
> If I georeference these landscape oriented using GCPs then gdalwarp will
> swap X and Y axes and also resize the resulting bitmap (it also resizes
> portrait oriented ones too, though without swapping axes)
> 
> My questions:
> 1) Why is gdalwarp swapping the axes rather than using the X and Y
> pixel-skew parameters of the affine transformation (seems to be always 0)?
> 2) Why is it re-sizing the bitmap?
> 3) Do I have to do both of these steps separately (translate and then warp)
> or can I simplify somehow?
> 
> Steps in the process:
> 
> 1) Generate a list of Ground Control Points from the PDF, rasterize the PDF
> to a 300dpi PNG
> 
> 2) gdal_translate .PNG to an intermediate .VRT
> ("gdal_translate -q -of VRT -strict -a_srs EPSG:4326 $gcpstring
> '$targetpng'  '$targetvrt'")
> 
> 3) gdalwarp intermediate .VRT to get the final georeferenced output .VRT
>  ("gdalwarp -q -of VRT -t_srs EPSG:4326 -order 1 -overwrite ''$targetvrt''
> '$targetvrt2'")
> 
> 
> 
> 
> *example from a landscape diagram*
> 
> (snippet of step 2 output from gdal_translate'd .vrt)
> CA-SFO-00375AD-PDF-AIRPORT-DIAGRAM.vrt:
> *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> 
> (snippet of step 3 output from gdalwarp'd .vrt)
> warpedCA-SFO-00375AD.PDF-AIRPORT\ DIAGRAM.vrt:
> *<VRTDataset rasterXSize="2623" rasterYSize="1359"
> subClass="VRTWarpedDataset">*
> *<GeoTransform> -1.2242081739746585e+02,  2.9114844968978991e-05,
> 0.0000000000000000e+00,  3.7641622693302779e+01,  0.0000000000000000e+00,
> -2.9114844968978991e-05</GeoTransform>*
> 
> 
> *example from a portrait diagram*
>           (snippet of step 2 output from gdal_translate'd .vrt)
> *VA-RIC-00347AD-PDF-AIRPORT-*
> *DIAGRAM.vrt*
> *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> 
> (snippet of step 3 output from gdalwarp'd .vrt)
> *warpedVA-RIC-00347AD.PDF-*
> *AIRPORT\ DIAGRAM.vrt*
> 
> 
> 
> *<VRTDataset rasterXSize="1870" rasterYSize="2287"
> subClass="VRTWarpedDataset"><GeoTransform> -7.7341103107298423e+01,
> 2.1580033523515700e-05,  0.0000000000000000e+00,  3.7529840835409082e+01,
> 0.0000000000000000e+00, -2.1580033523515700e-05</GeoTransform>*
> Thanks!
> -Jesse McGraw

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From kalu671 at gmail.com  Sat Jun 28 13:05:54 2014
From: kalu671 at gmail.com (devendra dahal)
Date: Sat, 28 Jun 2014 15:05:54 -0500
Subject: [gdal-dev] having problem with polygonize
In-Reply-To: <201406280855.46120.even.rouault@mines-paris.org>
References: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
	<201406280855.46120.even.rouault@mines-paris.org>
Message-ID: <CAMJhjUUAH=zoKoRyZKbhbSfX9wE6TmwpAUP4Xn1XBfKtm9F1NQ@mail.gmail.com>

Thank you David and Even.

I really apreciate your suggestions.

Even's suggestion of including quotation did help running the script
without problem. As you suggested I replaced the os.system with
subprocess.call. But still the shapefile has just one polygon with zero
value and it does not have the coordinate.

the "wetlands.tif" looks like this with two values 1 = wetlands (white) and
0= other lands (black)

[image: Inline image 1]

This is what "wetland_poly.shp" looks and without projection.

[image: Inline image 2]

On Sat, Jun 28, 2014 at 1:55 AM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le samedi 28 juin 2014 05:26:00, devendra dahal a ?crit :
> > Dear All;
> >
> > I have some annual landcovder raster datasets (preciously 20) with 7
> > different types.
> > Since the datasets covers large area and I just want to see trends of
> some
> > wetlands area changes over the year. I planned to subset the wetlands
> from
> > the dataset. Then using polygonize.py to convert the raster to polygon
> and
> > compute the area of each wetlands extent annually. The below is my
> concise
> > code.
> >
> >
> > file1 = "my_raster.tif"
> > OutFile = "wetlands.tif"
> > rastDriver = gdal.GetDriverByName('Gtiff') # reading gdal driver
> > rastDriver.Register()
> >
> > src_ds = gdal.Open(file1)
> >
> > srcband = src_ds.GetRasterBand(1)
> > cols = src_ds.RasterXSize
> > rows = src_ds.RasterYSize
> >
> > Array1 = srcband.ReadAsArray(0, 0, cols, rows)
> > newArray = numpy.where(Array1 != 5, 0,Array1)
> >
> >
> > dst_ds = rastDriver.Create(OutFile, cols, rows, bands, GDT_Int16)
> > dst_ds.SetGeoTransform(geot)
> > dst_ds.SetProjection(proj)
> > dst_ds.GetRasterBand(1).WriteArray(newArray)
> > newArray = None
> >
> >
> > From the code above I created wetlands only raster and saved a file. Now
> > using the line below I tried to convert the wetland raster to polygon.
> >
> > PolyName = "wetland_poly"
> > ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "ESRI
> > Shapefile", PolyName + ".shp", PolyName)
>
> Deven,
>
> The issue here is the lack of quoting around ESRI Shapefile once it is
> ingested
> into ConvertPoly.
>
> You likely need something like
>
> ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "\"ESRI
> Shapefile\"", PolyName + ".shp", PolyName)
>
> Using the Python subprocess module might also be less error prone where you
> can pass an array of arguments instead of a string
>
> Hint: shapefile is the default vector format of all OGR utilities. So you
> don't
> actually need to specify -f "ESRI Shapefile" at all.
>
> Best regards,
>
> Even
>
> >
> > os.system(ConvertPoly)
> >
> >
> > But it throws the error below.
> >
> > dst_ds = drv.CreateDataSource( dst_filename )
> > AttributeError: 'NoneType' object has no attribute 'CreateDataSource'
> >
> > When I tested qgis raster to vector conversion tool, I get the polygons
> as
> > I expected from the wetlands.tif but the polygon file lost the coordinate
> > system. if I use my_raster.tif in the code above it runs successfully but
> > runs for more than a hour so obviously I don't want to do this.
> >
> > Any elegant suggestions for alternative idea or help to fix the script
> > would be highly appreciated.
> >
> > Thank you very much
> >
> > Deven
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140628/55cad394/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 13105 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140628/55cad394/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 2811 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140628/55cad394/attachment-0003.png>

From even.rouault at mines-paris.org  Sat Jun 28 13:14:45 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Sat, 28 Jun 2014 22:14:45 +0200
Subject: [gdal-dev] having problem with polygonize
In-Reply-To: <CAMJhjUUAH=zoKoRyZKbhbSfX9wE6TmwpAUP4Xn1XBfKtm9F1NQ@mail.gmail.com>
References: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
	<201406280855.46120.even.rouault@mines-paris.org>
	<CAMJhjUUAH=zoKoRyZKbhbSfX9wE6TmwpAUP4Xn1XBfKtm9F1NQ@mail.gmail.com>
Message-ID: <201406282214.45586.even.rouault@mines-paris.org>

Le samedi 28 juin 2014 22:05:54, devendra dahal a ?crit :
> Thank you David and Even.
> 
> I really apreciate your suggestions.
> 
> Even's suggestion of including quotation did help running the script
> without problem. As you suggested I replaced the os.system with
> subprocess.call. But still the shapefile has just one polygon with zero
> value and it does not have the coordinate.
> 
> the "wetlands.tif" looks like this with two values 1 = wetlands (white) and
> 0= other lands (black)
> 
> [image: Inline image 1]
> 
> This is what "wetland_poly.shp" looks and without projection.
> 
> [image: Inline image 2]

Hum, you didn't show your code, but a possibility is that your raster file 
isn't properly closed before gdal_polygonize.py is run.

Make sure that dst_ds = None is executed before gdal_polygonize.
Check that wetlands.tif has got the projection (with gdalinfo for example), 
and try running outsize of your python script gdal_polygonize to determine 
where issues are.

> 
> On Sat, Jun 28, 2014 at 1:55 AM, Even Rouault
> <even.rouault at mines-paris.org>
> 
> wrote:
> > Le samedi 28 juin 2014 05:26:00, devendra dahal a ?crit :
> > > Dear All;
> > > 
> > > I have some annual landcovder raster datasets (preciously 20) with 7
> > > different types.
> > > Since the datasets covers large area and I just want to see trends of
> > 
> > some
> > 
> > > wetlands area changes over the year. I planned to subset the wetlands
> > 
> > from
> > 
> > > the dataset. Then using polygonize.py to convert the raster to polygon
> > 
> > and
> > 
> > > compute the area of each wetlands extent annually. The below is my
> > 
> > concise
> > 
> > > code.
> > > 
> > > 
> > > file1 = "my_raster.tif"
> > > OutFile = "wetlands.tif"
> > > rastDriver = gdal.GetDriverByName('Gtiff') # reading gdal driver
> > > rastDriver.Register()
> > > 
> > > src_ds = gdal.Open(file1)
> > > 
> > > srcband = src_ds.GetRasterBand(1)
> > > cols = src_ds.RasterXSize
> > > rows = src_ds.RasterYSize
> > > 
> > > Array1 = srcband.ReadAsArray(0, 0, cols, rows)
> > > newArray = numpy.where(Array1 != 5, 0,Array1)
> > > 
> > > 
> > > dst_ds = rastDriver.Create(OutFile, cols, rows, bands, GDT_Int16)
> > > dst_ds.SetGeoTransform(geot)
> > > dst_ds.SetProjection(proj)
> > > dst_ds.GetRasterBand(1).WriteArray(newArray)
> > > newArray = None
> > > 
> > > 
> > > From the code above I created wetlands only raster and saved a file.
> > > Now using the line below I tried to convert the wetland raster to
> > > polygon.
> > > 
> > > PolyName = "wetland_poly"
> > > ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "ESRI
> > > Shapefile", PolyName + ".shp", PolyName)
> > 
> > Deven,
> > 
> > The issue here is the lack of quoting around ESRI Shapefile once it is
> > ingested
> > into ConvertPoly.
> > 
> > You likely need something like
> > 
> > ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile, "\"ESRI
> > Shapefile\"", PolyName + ".shp", PolyName)
> > 
> > Using the Python subprocess module might also be less error prone where
> > you can pass an array of arguments instead of a string
> > 
> > Hint: shapefile is the default vector format of all OGR utilities. So you
> > don't
> > actually need to specify -f "ESRI Shapefile" at all.
> > 
> > Best regards,
> > 
> > Even
> > 
> > > os.system(ConvertPoly)
> > > 
> > > 
> > > But it throws the error below.
> > > 
> > > dst_ds = drv.CreateDataSource( dst_filename )
> > > AttributeError: 'NoneType' object has no attribute 'CreateDataSource'
> > > 
> > > When I tested qgis raster to vector conversion tool, I get the polygons
> > 
> > as
> > 
> > > I expected from the wetlands.tif but the polygon file lost the
> > > coordinate system. if I use my_raster.tif in the code above it runs
> > > successfully but runs for more than a hour so obviously I don't want
> > > to do this.
> > > 
> > > Any elegant suggestions for alternative idea or help to fix the script
> > > would be highly appreciated.
> > > 
> > > Thank you very much
> > > 
> > > Deven
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From kalu671 at gmail.com  Sat Jun 28 19:03:32 2014
From: kalu671 at gmail.com (devendra dahal)
Date: Sat, 28 Jun 2014 21:03:32 -0500
Subject: [gdal-dev] having problem with polygonize
In-Reply-To: <201406282214.45586.even.rouault@mines-paris.org>
References: <CAMJhjUU6BWzhReMU89g+ot2mj6PgET86NmAf3f3=WLi+w6=5Sg@mail.gmail.com>
	<201406280855.46120.even.rouault@mines-paris.org>
	<CAMJhjUUAH=zoKoRyZKbhbSfX9wE6TmwpAUP4Xn1XBfKtm9F1NQ@mail.gmail.com>
	<201406282214.45586.even.rouault@mines-paris.org>
Message-ID: <CAMJhjUUddj-vVOrKFkCjKtpA8BD6K-GBNYQ=vaTsBgxw5AF5xQ@mail.gmail.com>

That's it. I was not closing dst_ds, I  was closing only newArray.

Thank you Even. You are wonderful.


On Sat, Jun 28, 2014 at 3:14 PM, Even Rouault <even.rouault at mines-paris.org>
wrote:

> Le samedi 28 juin 2014 22:05:54, devendra dahal a ?crit :
> > Thank you David and Even.
> >
> > I really apreciate your suggestions.
> >
> > Even's suggestion of including quotation did help running the script
> > without problem. As you suggested I replaced the os.system with
> > subprocess.call. But still the shapefile has just one polygon with zero
> > value and it does not have the coordinate.
> >
> > the "wetlands.tif" looks like this with two values 1 = wetlands (white)
> and
> > 0= other lands (black)
> >
> > [image: Inline image 1]
> >
> > This is what "wetland_poly.shp" looks and without projection.
> >
> > [image: Inline image 2]
>
> Hum, you didn't show your code, but a possibility is that your raster file
> isn't properly closed before gdal_polygonize.py is run.
>
> Make sure that dst_ds = None is executed before gdal_polygonize.
> Check that wetlands.tif has got the projection (with gdalinfo for example),
> and try running outsize of your python script gdal_polygonize to determine
> where issues are.
>
> >
> > On Sat, Jun 28, 2014 at 1:55 AM, Even Rouault
> > <even.rouault at mines-paris.org>
> >
> > wrote:
> > > Le samedi 28 juin 2014 05:26:00, devendra dahal a ?crit :
> > > > Dear All;
> > > >
> > > > I have some annual landcovder raster datasets (preciously 20) with 7
> > > > different types.
> > > > Since the datasets covers large area and I just want to see trends of
> > >
> > > some
> > >
> > > > wetlands area changes over the year. I planned to subset the wetlands
> > >
> > > from
> > >
> > > > the dataset. Then using polygonize.py to convert the raster to
> polygon
> > >
> > > and
> > >
> > > > compute the area of each wetlands extent annually. The below is my
> > >
> > > concise
> > >
> > > > code.
> > > >
> > > >
> > > > file1 = "my_raster.tif"
> > > > OutFile = "wetlands.tif"
> > > > rastDriver = gdal.GetDriverByName('Gtiff') # reading gdal driver
> > > > rastDriver.Register()
> > > >
> > > > src_ds = gdal.Open(file1)
> > > >
> > > > srcband = src_ds.GetRasterBand(1)
> > > > cols = src_ds.RasterXSize
> > > > rows = src_ds.RasterYSize
> > > >
> > > > Array1 = srcband.ReadAsArray(0, 0, cols, rows)
> > > > newArray = numpy.where(Array1 != 5, 0,Array1)
> > > >
> > > >
> > > > dst_ds = rastDriver.Create(OutFile, cols, rows, bands, GDT_Int16)
> > > > dst_ds.SetGeoTransform(geot)
> > > > dst_ds.SetProjection(proj)
> > > > dst_ds.GetRasterBand(1).WriteArray(newArray)
> > > > newArray = None
> > > >
> > > >
> > > > From the code above I created wetlands only raster and saved a file.
> > > > Now using the line below I tried to convert the wetland raster to
> > > > polygon.
> > > >
> > > > PolyName = "wetland_poly"
> > > > ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile,
> "ESRI
> > > > Shapefile", PolyName + ".shp", PolyName)
> > >
> > > Deven,
> > >
> > > The issue here is the lack of quoting around ESRI Shapefile once it is
> > > ingested
> > > into ConvertPoly.
> > >
> > > You likely need something like
> > >
> > > ConvertPoly= "gdal_polygonize.py %s -f %s %s %s Value" %(OutFile,
> "\"ESRI
> > > Shapefile\"", PolyName + ".shp", PolyName)
> > >
> > > Using the Python subprocess module might also be less error prone where
> > > you can pass an array of arguments instead of a string
> > >
> > > Hint: shapefile is the default vector format of all OGR utilities. So
> you
> > > don't
> > > actually need to specify -f "ESRI Shapefile" at all.
> > >
> > > Best regards,
> > >
> > > Even
> > >
> > > > os.system(ConvertPoly)
> > > >
> > > >
> > > > But it throws the error below.
> > > >
> > > > dst_ds = drv.CreateDataSource( dst_filename )
> > > > AttributeError: 'NoneType' object has no attribute 'CreateDataSource'
> > > >
> > > > When I tested qgis raster to vector conversion tool, I get the
> polygons
> > >
> > > as
> > >
> > > > I expected from the wetlands.tif but the polygon file lost the
> > > > coordinate system. if I use my_raster.tif in the code above it runs
> > > > successfully but runs for more than a hour so obviously I don't want
> > > > to do this.
> > > >
> > > > Any elegant suggestions for alternative idea or help to fix the
> script
> > > > would be highly appreciated.
> > > >
> > > > Thank you very much
> > > >
> > > > Deven
> > >
> > > --
> > > Geospatial professional services
> > > http://even.rouault.free.fr/services.html
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140628/652fd2e5/attachment.html>

From jlmcgraw at gmail.com  Mon Jun 30 06:47:41 2014
From: jlmcgraw at gmail.com (Jesse McGraw)
Date: Mon, 30 Jun 2014 09:47:41 -0400
Subject: [gdal-dev] gdaltranslate and gdalwarp rotating and resizing
 image without being asked to, why?
In-Reply-To: <201406281801.27910.even.rouault@mines-paris.org>
References: <CA+XueT2r7kQp1d_5B-wMTec9dY_CXxc8tSZRzKGKYU9XPsxTTA@mail.gmail.com>
	<201406281801.27910.even.rouault@mines-paris.org>
Message-ID: <CA+XueT0gPC9SktS5a3M-ZG8myNh5dS88UgR0wXdWvmRx7d7NGQ@mail.gmail.com>

Even,
  Thank you for the response!

I'm actually rasterizing the PDF to PNG via pdftoppm before doing anything
with gdal*, that's why the rotating and resizing surprises me.

When do the pixelSkew parameters get used vs. swapping the axes?  The
swapping works in this case is because the rotation is 90 degrees but what
would happen with an arbitrary rotation (eg 37 degrees).

The reason I'm curious about all this is that I'm wanting to use only the
initially generated PNG for my final georeferenced image and not have to
generate an additional one that is rotated by gdal with the skew parameters
set to 0 and also resized.

If I can provide any more detail on my process or what I'm trying to
accomplish please let me know.

Here's the general flow for Airport Diagrams:

Source PDF -> create PNG, create list of GCPs from the PDF mapped to that
PNG -> gdal_translate PNG to intermediate VRT -> gdal_warp intermediate VRT
to final VRT

The final VRT displays properly in QGIS so the process is working correctly
but I was hoping to be able to extract from it all of the parameters of the
affine transformation necessary to properly display the PNG as a
geoferenced image (origin, extents, pixel sizes and pixel skew) in a
separate Android application.  (This bitmap is to be used in a separate
moving map application to display an airplane's real world position on the
image)

-Jesse


On Sat, Jun 28, 2014 at 12:01 PM, Even Rouault <even.rouault at mines-paris.org
> wrote:

> Jesse,
>
> I'm not completely sure to really understand the axis swapping issue
> without
> reproducing what you do.
> The PDF driver should take into account the PDF rotation parameter when
> rasterizing it (so that it outputs something that is visually identical
> with
> what other PDF viewers do).
>
> To answer your questions:
>
> 1) When not providing an existing target image, gdalwarp will indeed
> rectify
> images that have an arbitrary transform with skew/rotation terms, or GCPs,
> to
> an affine transform with squared pixels, which is generally the desired
> behaviour. If you prepare yourself the target dataset with the geotransform
> you whish, you should be able run gdalwarp on it. You can alternatively try
> the -ts option of gdalwarp to force the target dimensions.
>
> 2) The resizing is a consequence of the output geotransform being different
> that the source geotransform.
>
> 3) You could likely merge your step 1 and 2, i.e. directly generate a .png
> with the SRS and GCP set. However I'd recommand generating a tiled TIFF
> instead to make gdalwarp faster.
>
> Best regards,
>
> Even
>
> Le vendredi 27 juin 2014 19:49:35, Jesse McGraw a ?crit :
> > Gdal gurus,
> >
> > I'm writing a utility to automatically georeference Instrument Approach
> > Procedures and Airport Diagrams from the FAA (github.com/jlmcgraw, if
> > you're curious) and I'm hoping for some insight from the experts here as
> to
> > why I'm seeing the following behavior with Airport Diagrams
> >
> > Most of the Airport Diagrams diagrams are portrait orientation (True
> North
> > up), however some of them are actually laid out in landscape orientation
> > (True North to the left or right) though the source PDF is still in
> > portrait
> >
> > If I georeference these landscape oriented using GCPs then gdalwarp will
> > swap X and Y axes and also resize the resulting bitmap (it also resizes
> > portrait oriented ones too, though without swapping axes)
> >
> > My questions:
> > 1) Why is gdalwarp swapping the axes rather than using the X and Y
> > pixel-skew parameters of the affine transformation (seems to be always
> 0)?
> > 2) Why is it re-sizing the bitmap?
> > 3) Do I have to do both of these steps separately (translate and then
> warp)
> > or can I simplify somehow?
> >
> > Steps in the process:
> >
> > 1) Generate a list of Ground Control Points from the PDF, rasterize the
> PDF
> > to a 300dpi PNG
> >
> > 2) gdal_translate .PNG to an intermediate .VRT
> > ("gdal_translate -q -of VRT -strict -a_srs EPSG:4326 $gcpstring
> > '$targetpng'  '$targetvrt'")
> >
> > 3) gdalwarp intermediate .VRT to get the final georeferenced output .VRT
> >  ("gdalwarp -q -of VRT -t_srs EPSG:4326 -order 1 -overwrite
> ''$targetvrt''
> > '$targetvrt2'")
> >
> >
> >
> >
> > *example from a landscape diagram*
> >
> > (snippet of step 2 output from gdal_translate'd .vrt)
> > CA-SFO-00375AD-PDF-AIRPORT-DIAGRAM.vrt:
> > *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> >
> > (snippet of step 3 output from gdalwarp'd .vrt)
> > warpedCA-SFO-00375AD.PDF-AIRPORT\ DIAGRAM.vrt:
> > *<VRTDataset rasterXSize="2623" rasterYSize="1359"
> > subClass="VRTWarpedDataset">*
> > *<GeoTransform> -1.2242081739746585e+02,  2.9114844968978991e-05,
> > 0.0000000000000000e+00,  3.7641622693302779e+01,  0.0000000000000000e+00,
> > -2.9114844968978991e-05</GeoTransform>*
> >
> >
> > *example from a portrait diagram*
> >           (snippet of step 2 output from gdal_translate'd .vrt)
> > *VA-RIC-00347AD-PDF-AIRPORT-*
> > *DIAGRAM.vrt*
> > *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> >
> > (snippet of step 3 output from gdalwarp'd .vrt)
> > *warpedVA-RIC-00347AD.PDF-*
> > *AIRPORT\ DIAGRAM.vrt*
> >
> >
> >
> > *<VRTDataset rasterXSize="1870" rasterYSize="2287"
> > subClass="VRTWarpedDataset"><GeoTransform> -7.7341103107298423e+01,
> > 2.1580033523515700e-05,  0.0000000000000000e+00,  3.7529840835409082e+01,
> > 0.0000000000000000e+00, -2.1580033523515700e-05</GeoTransform>*
> > Thanks!
> > -Jesse McGraw
>
> --
> Geospatial professional services
> http://even.rouault.free.fr/services.html
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140630/46a10970/attachment.html>

From varunsaraf14 at gmail.com  Mon Jun 30 10:30:02 2014
From: varunsaraf14 at gmail.com (Varun Saraf)
Date: Mon, 30 Jun 2014 23:00:02 +0530
Subject: [gdal-dev] GSoC 2014 Weekly Report 6 : GDAL PostGIS Raster driver
Message-ID: <CAPfr+rtAkX3pUBM1chA6hXCCN7z66Ax7EqYf8bmtXAGJoeHR_w@mail.gmail.com>

Hi,

Sorry for the delay in submitting my weekly report. Below is my sixth
weekly report.

*What did I do this week?*

   - Implemented calls from IRasterIO to the methods which are writing the
   query.
   - Worked on the method for creating overviews and writing them to table.

*What do I plan on doing next week?*

   - Continue to modify IRasterIO method to be able to call different
   methods depending on the query to be executed and handle different sized
   raster regions.

*Am I blocked on anything?*

   - I am blocked with the overviews.

Link to weekly report :
https://github.com/varunsaraf/postgis_raster/wiki/Report-6
Link to code repository : https://github.com/varunsaraf/postgis_raster
More details at : http://trac.osgeo.org/gdal/wiki/PostGIS_raster_driver

Regards,
Varun Saraf
Lab for Spatial Informatics
IIIT Hyderabad, India
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140630/938857a0/attachment.html>

From awood at agi.com  Mon Jun 30 10:30:11 2014
From: awood at agi.com (Wood, Alexander)
Date: Mon, 30 Jun 2014 17:30:11 +0000
Subject: [gdal-dev] Truncated Coordinate System WKT post GDAL-1.9.2
Message-ID: <52dd9dea60994197a1e43b998a0ce101@BY2PR07MB842.namprd07.prod.outlook.com>

Hello,

I have recently upgraded from GDAL 1.9.2 to GDAL 1.11.0.  With this upgrade, I've experienced difficulties in extracting the projection definition from the swisstopo dataset (http://www.swisstopo.admin.ch/internet/swisstopo/en/home/products/height/swissALTI3D/swissALTI3D.html).

In GDAL-1.9.2, running gdalinfo on the lv95 GeoTIFF, 2m data returns the following Coordinate System:
PROJCS["Hotine Oblique Mercator Azimuth Center",
    GEOGCS["CH1903+ (L+T1997)",
        DATUM["CH1903+ (L+T1997)",
            SPHEROID["Bessel",6377397.155,299.1528131060786],
            TOWGS84[674.374,15.056,405.346,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Hotine_Oblique_Mercator_Azimuth_Center"],
    PARAMETER["latitude_of_center",46.95240555555557],
    PARAMETER["longitude_of_center",7.439583333333334],
    PARAMETER["azimuth",90.00000000000003],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",2600000],
    PARAMETER["false_northing",1200000],
    UNIT["meters",1]]

However in GDAL-1.11.0, gdalinfo on the same file returns the following (truncated) WKT for the Coordinate System:
PROJCS["Hotine Oblique Mercator Azimuth Center",
    GEOGCS["CH1903+ (L+T1997)",
        DATUM["CH1903+ (L+T1997)",
            SPHEROID["Bessel",6377397.155,299.1528131060786],
            TOWGS84[674.374,15.056,405.346,0,0,0,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    UNIT["meters",1]]

Notice that PROJECTION and related PARAMETER fields are missing in the WKT.  I've run gdalinfo from GDAL-1.10.0 and 1.10.1 with results identical to GDAL-1.11.0.  I suspect that the issue lies with the fact that the coordinate system is defined using ESRI WKT.

Is it possible in 1.11.0 to obtain a complete Projection WKT from GDALGetProjectionRef() that would include the PROJECTION["Hotine_Oblique_Mercator_Azimuth_Center"] in order to construct a OGRSpatialReference from the ESRI WKT?

Thanks in advance,
Alex
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20140630/3d4e7b17/attachment-0001.html>

From even.rouault at mines-paris.org  Mon Jun 30 11:59:08 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 30 Jun 2014 20:59:08 +0200
Subject: [gdal-dev] Truncated Coordinate System WKT post GDAL-1.9.2
In-Reply-To: <52dd9dea60994197a1e43b998a0ce101@BY2PR07MB842.namprd07.prod.outlook.com>
References: <52dd9dea60994197a1e43b998a0ce101@BY2PR07MB842.namprd07.prod.outlook.com>
Message-ID: <201406302059.08909.even.rouault@mines-paris.org>

Le lundi 30 juin 2014 19:30:11, Wood, Alexander a ?crit :
> Hello,
> 
> I have recently upgraded from GDAL 1.9.2 to GDAL 1.11.0.  With this
> upgrade, I've experienced difficulties in extracting the projection
> definition from the swisstopo dataset
> (http://www.swisstopo.admin.ch/internet/swisstopo/en/home/products/height/
> swissALTI3D/swissALTI3D.html).
> 
> In GDAL-1.9.2, running gdalinfo on the lv95 GeoTIFF, 2m data returns the
> following Coordinate System: PROJCS["Hotine Oblique Mercator Azimuth
> Center",
>     GEOGCS["CH1903+ (L+T1997)",
>         DATUM["CH1903+ (L+T1997)",
>             SPHEROID["Bessel",6377397.155,299.1528131060786],
>             TOWGS84[674.374,15.056,405.346,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Hotine_Oblique_Mercator_Azimuth_Center"],
>     PARAMETER["latitude_of_center",46.95240555555557],
>     PARAMETER["longitude_of_center",7.439583333333334],
>     PARAMETER["azimuth",90.00000000000003],
>     PARAMETER["scale_factor",1],
>     PARAMETER["false_easting",2600000],
>     PARAMETER["false_northing",1200000],
>     UNIT["meters",1]]
> 
> However in GDAL-1.11.0, gdalinfo on the same file returns the following
> (truncated) WKT for the Coordinate System: PROJCS["Hotine Oblique Mercator
> Azimuth Center",
>     GEOGCS["CH1903+ (L+T1997)",
>         DATUM["CH1903+ (L+T1997)",
>             SPHEROID["Bessel",6377397.155,299.1528131060786],
>             TOWGS84[674.374,15.056,405.346,0,0,0,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     UNIT["meters",1]]
> 
> Notice that PROJECTION and related PARAMETER fields are missing in the WKT.
>  I've run gdalinfo from GDAL-1.10.0 and 1.10.1 with results identical to
> GDAL-1.11.0.  I suspect that the issue lies with the fact that the
> coordinate system is defined using ESRI WKT.
> 
> Is it possible in 1.11.0 to obtain a complete Projection WKT from
> GDALGetProjectionRef() that would include the
> PROJECTION["Hotine_Oblique_Mercator_Azimuth_Center"] in order to construct
> a OGRSpatialReference from the ESRI WKT?

Alex

It was actually a regression introduced in 1.10. Now fixed in 1.10, 1.11 
branches and trunk per ticket http://trac.osgeo.org/gdal/ticket/5551

Best regards,

Even

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

From even.rouault at mines-paris.org  Mon Jun 30 12:07:58 2014
From: even.rouault at mines-paris.org (Even Rouault)
Date: Mon, 30 Jun 2014 21:07:58 +0200
Subject: [gdal-dev] gdaltranslate and gdalwarp rotating and resizing
	image without being asked to, why?
In-Reply-To: <CA+XueT0gPC9SktS5a3M-ZG8myNh5dS88UgR0wXdWvmRx7d7NGQ@mail.gmail.com>
References: <CA+XueT2r7kQp1d_5B-wMTec9dY_CXxc8tSZRzKGKYU9XPsxTTA@mail.gmail.com>
	<201406281801.27910.even.rouault@mines-paris.org>
	<CA+XueT0gPC9SktS5a3M-ZG8myNh5dS88UgR0wXdWvmRx7d7NGQ@mail.gmail.com>
Message-ID: <201406302107.59182.even.rouault@mines-paris.org>

Le lundi 30 juin 2014 15:47:41, Jesse McGraw a ?crit :
> Even,
>   Thank you for the response!
> 
> I'm actually rasterizing the PDF to PNG via pdftoppm before doing anything
> with gdal*, that's why the rotating and resizing surprises me.

hum ok I though you used the GDAL PDF driver.

> 
> When do the pixelSkew parameters get used vs. swapping the axes?  The
> swapping works in this case is because the rotation is 90 degrees but what
> would happen with an arbitrary rotation (eg 37 degrees).

gdalwarp has no explicit "swap axis" operation. It uses GCP information to 
warp the image. swaping might occur if your GCP ask GDAL to do so.

> 
> The reason I'm curious about all this is that I'm wanting to use only the
> initially generated PNG for my final georeferenced image and not have to
> generate an additional one that is rotated by gdal with the skew parameters
> set to 0 and also resized.
> 
> If I can provide any more detail on my process or what I'm trying to
> accomplish please let me know.
> 
> Here's the general flow for Airport Diagrams:
> 
> Source PDF -> create PNG, create list of GCPs from the PDF mapped to that
> PNG ->

That might the problem. If you create the GCPs on the PDF and not on the PNG, 
and that the PDF has rotation, pdftoppm I think will apply the rotation, hence 
the axis swapping.
Well I'm really confused by what you are trying to do.

For a better understanding, you should perhaps provide the PDF and all exact 
command lines you are typing.


> gdal_translate PNG to intermediate VRT -> gdal_warp intermediate VRT
> to final VRT
> 
> The final VRT displays properly in QGIS so the process is working correctly
> but I was hoping to be able to extract from it all of the parameters of the
> affine transformation necessary to properly display the PNG as a
> geoferenced image (origin, extents, pixel sizes and pixel skew) in a
> separate Android application.  (This bitmap is to be used in a separate
> moving map application to display an airplane's real world position on the
> image)
> 
> -Jesse
> 
> 
> On Sat, Jun 28, 2014 at 12:01 PM, Even Rouault
> <even.rouault at mines-paris.org
> 
> > wrote:
> > 
> > Jesse,
> > 
> > I'm not completely sure to really understand the axis swapping issue
> > without
> > reproducing what you do.
> > The PDF driver should take into account the PDF rotation parameter when
> > rasterizing it (so that it outputs something that is visually identical
> > with
> > what other PDF viewers do).
> > 
> > To answer your questions:
> > 
> > 1) When not providing an existing target image, gdalwarp will indeed
> > rectify
> > images that have an arbitrary transform with skew/rotation terms, or
> > GCPs, to
> > an affine transform with squared pixels, which is generally the desired
> > behaviour. If you prepare yourself the target dataset with the
> > geotransform you whish, you should be able run gdalwarp on it. You can
> > alternatively try the -ts option of gdalwarp to force the target
> > dimensions.
> > 
> > 2) The resizing is a consequence of the output geotransform being
> > different that the source geotransform.
> > 
> > 3) You could likely merge your step 1 and 2, i.e. directly generate a
> > .png with the SRS and GCP set. However I'd recommand generating a tiled
> > TIFF instead to make gdalwarp faster.
> > 
> > Best regards,
> > 
> > Even
> > 
> > Le vendredi 27 juin 2014 19:49:35, Jesse McGraw a ?crit :
> > > Gdal gurus,
> > > 
> > > I'm writing a utility to automatically georeference Instrument Approach
> > > Procedures and Airport Diagrams from the FAA (github.com/jlmcgraw, if
> > > you're curious) and I'm hoping for some insight from the experts here
> > > as
> > 
> > to
> > 
> > > why I'm seeing the following behavior with Airport Diagrams
> > > 
> > > Most of the Airport Diagrams diagrams are portrait orientation (True
> > 
> > North
> > 
> > > up), however some of them are actually laid out in landscape
> > > orientation (True North to the left or right) though the source PDF is
> > > still in portrait
> > > 
> > > If I georeference these landscape oriented using GCPs then gdalwarp
> > > will swap X and Y axes and also resize the resulting bitmap (it also
> > > resizes portrait oriented ones too, though without swapping axes)
> > > 
> > > My questions:
> > > 1) Why is gdalwarp swapping the axes rather than using the X and Y
> > > pixel-skew parameters of the affine transformation (seems to be always
> > 
> > 0)?
> > 
> > > 2) Why is it re-sizing the bitmap?
> > > 3) Do I have to do both of these steps separately (translate and then
> > 
> > warp)
> > 
> > > or can I simplify somehow?
> > > 
> > > Steps in the process:
> > > 
> > > 1) Generate a list of Ground Control Points from the PDF, rasterize the
> > 
> > PDF
> > 
> > > to a 300dpi PNG
> > > 
> > > 2) gdal_translate .PNG to an intermediate .VRT
> > > ("gdal_translate -q -of VRT -strict -a_srs EPSG:4326 $gcpstring
> > > '$targetpng'  '$targetvrt'")
> > > 
> > > 3) gdalwarp intermediate .VRT to get the final georeferenced output
> > > .VRT
> > > 
> > >  ("gdalwarp -q -of VRT -t_srs EPSG:4326 -order 1 -overwrite
> > 
> > ''$targetvrt''
> > 
> > > '$targetvrt2'")
> > > 
> > > 
> > > 
> > > 
> > > *example from a landscape diagram*
> > > 
> > > (snippet of step 2 output from gdal_translate'd .vrt)
> > > CA-SFO-00375AD-PDF-AIRPORT-DIAGRAM.vrt:
> > > *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> > > 
> > > (snippet of step 3 output from gdalwarp'd .vrt)
> > > warpedCA-SFO-00375AD.PDF-AIRPORT\ DIAGRAM.vrt:
> > > *<VRTDataset rasterXSize="2623" rasterYSize="1359"
> > > subClass="VRTWarpedDataset">*
> > > *<GeoTransform> -1.2242081739746585e+02,  2.9114844968978991e-05,
> > > 0.0000000000000000e+00,  3.7641622693302779e+01, 
> > > 0.0000000000000000e+00, -2.9114844968978991e-05</GeoTransform>*
> > > 
> > > 
> > > *example from a portrait diagram*
> > > 
> > >           (snippet of step 2 output from gdal_translate'd .vrt)
> > > 
> > > *VA-RIC-00347AD-PDF-AIRPORT-*
> > > *DIAGRAM.vrt*
> > > *<VRTDataset rasterXSize="1613" rasterYSize="2475">*
> > > 
> > > (snippet of step 3 output from gdalwarp'd .vrt)
> > > *warpedVA-RIC-00347AD.PDF-*
> > > *AIRPORT\ DIAGRAM.vrt*
> > > 
> > > 
> > > 
> > > *<VRTDataset rasterXSize="1870" rasterYSize="2287"
> > > subClass="VRTWarpedDataset"><GeoTransform> -7.7341103107298423e+01,
> > > 2.1580033523515700e-05,  0.0000000000000000e+00, 
> > > 3.7529840835409082e+01, 0.0000000000000000e+00,
> > > -2.1580033523515700e-05</GeoTransform>* Thanks!
> > > -Jesse McGraw
> > 
> > --
> > Geospatial professional services
> > http://even.rouault.free.fr/services.html

-- 
Geospatial professional services
http://even.rouault.free.fr/services.html

