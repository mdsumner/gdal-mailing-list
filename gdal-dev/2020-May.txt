From cdelancy at blackfangtechnologies.com  Fri May  1 13:00:36 2020
From: cdelancy at blackfangtechnologies.com (Craig Delancy)
Date: Fri, 1 May 2020 20:00:36 +0000
Subject: [gdal-dev] Affine transform: Practical uses of x-skew and y-skew
Message-ID: <DM6PR17MB3884F9D91962D87B89BE6375C7AB0@DM6PR17MB3884.namprd17.prod.outlook.com>

Hello.

I am trying to explain to a colleague how the affine transform maps image coordinates onto a projection system.
Specifically, I am trying to explain how mathematically speaking, any parallelogram section of the coordinate system can be represented by the rectangular image.
After a bit of searching, I wasn't able to find an example dataset to illustrate this.

I am wondering, is there any practical use for this?
Does anyone have an example dataset they would be willing to send/show me?

Thanks, Craig.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200501/51d0df2c/attachment.html>

From sebastic at xs4all.nl  Sat May  2 00:20:31 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 2 May 2020 09:20:31 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <5045356.a7JfxnZW0b@even-i700>
References: <5045356.a7JfxnZW0b@even-i700>
Message-ID: <02aa1f16-ab5f-c415-7af9-6142afbb84b9@xs4all.nl>

Just for the record and in case the R authors are reading along, the
test suite for r-cran-rgdal (1.4-8-1) [0] & r-cran-sf (0.9-2+dfsg-1) [1]
fail with gdal (3.1.0~rc2+dfsg-1~exp1) from Debian experimental [2].

[0]
https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-rgdal/5203587/log.gz
[1]
https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-sf/5203588/log.gz
[2] https://release.debian.org/britney/pseudo-excuses-experimental.html#gdal

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From Roger.Bivand at nhh.no  Sat May  2 12:59:13 2020
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 2 May 2020 12:59:13 -0700 (MST)
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <02aa1f16-ab5f-c415-7af9-6142afbb84b9@xs4all.nl>
References: <5045356.a7JfxnZW0b@even-i700>
 <02aa1f16-ab5f-c415-7af9-6142afbb84b9@xs4all.nl>
Message-ID: <1588449553149-0.post@n6.nabble.com>

Thanks. I've been testing on master, but last built a month ago. Installing
RC2 now.

Roger



-----
Roger Bivand
NHH Norwegian School of Economics, Bergen, Norway
--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From Roger.Bivand at nhh.no  Sat May  2 14:45:49 2020
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Sat, 2 May 2020 14:45:49 -0700 (MST)
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1588449553149-0.post@n6.nabble.com>
References: <5045356.a7JfxnZW0b@even-i700>
 <02aa1f16-ab5f-c415-7af9-6142afbb84b9@xs4all.nl>
 <1588449553149-0.post@n6.nabble.com>
Message-ID: <1588455949489-0.post@n6.nabble.com>

Perhaps crucially, I see no problems with released rgdal 1.4-8 on R 4.0.0 and
PROJ 7.0.1 with GDAL 3.1.0RC2, or with devel rgdal trunk SVN rev. 966 and
PROJ 7.0.1 with GDAL 3.1.0RC2. The failing cases are with PROJ 7.0.0, and R
3.6.3. Further, I don't know whether that is running ASAN, valgrind, or
other CI variants. My feeling is often that CI is strewn with lots of false
positives and negatives, and that manual testing (the old way) is actually
effective.



-----
Roger Bivand
NHH Norwegian School of Economics, Bergen, Norway
--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ao at t-kartor.se  Sun May  3 00:39:44 2020
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Sun, 3 May 2020 09:39:44 +0200
Subject: [gdal-dev] S-57 driver Generic attribute DSNM
In-Reply-To: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
References: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
Message-ID: <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>

Hi

I have not checked the GDAL implementation but DSNM is an unneccessary 
addition to the S57 spec to generate a (potential unique) GUID.
S57 spec has no GUID definition, IDs needs only be to unique inside a 
dataset/ENC cell.

DSNM belongs to the dataset-wide DSID fields, see 6.3.2 in 
https://iho.int/uploads/user/pubs/standards/s-57/20ApB1.pdf

> Hello,
>
> After reading this documentation concerning the S-57 driver :
>
> https://gdal.org/drivers/vector/s57.html
>
> I thought the attribute DSNM ( Dataset name) should be defined on all features, no ?
>
> But on the source code, the method S57GenerateStandardAttributes (s57featuredefns.cpp) always attaches theses standard feature attributes :
> GRUP, OBJL, RVER, AGEN, FIDN, FIDS but there is no mention of the DSNM attribute.
>
> Is it a mistake in the documentation? In the code? Or just a misunderstanding on my side?
>
> Thank you for your clarification,
>
> -- loïc
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Best Regards

Andreas Oxenstierna
T-Kartor Geospatial AB
Olof Mohlins väg 12 Kristianstad
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From kusala9 at googlemail.com  Sun May  3 01:54:22 2020
From: kusala9 at googlemail.com (kusala nine)
Date: Sun, 3 May 2020 09:54:22 +0100
Subject: [gdal-dev] S-57 driver Generic attribute DSNM
In-Reply-To: <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>
References: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
 <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>
Message-ID: <CAOn9mqfWfYqWVK3DPpyJZHfN__9x9KuBcCGiqnBNOpkzrO_+fQ@mail.gmail.com>

DSNM is dataset name. I'ts defined in the DSID which only occurs in the
first field/subfield group in the dataset - not sure what the driver does
in respect of it. In terms of identifiers s-57 has "FOID"s, so each feature
has a unique id made up of a combination of the agency code  and two
integers. These are used to identify features and take the place of the
GUID, Foods don't repeat in a dataset but can represent a feature leaving
and entering a cell... Hope this helps.

Jonathan,.

On Sun, 3 May 2020 at 08:39, Andreas Oxenstierna <ao at t-kartor.se> wrote:

> Hi
>
> I have not checked the GDAL implementation but DSNM is an unneccessary
> addition to the S57 spec to generate a (potential unique) GUID.
> S57 spec has no GUID definition, IDs needs only be to unique inside a
> dataset/ENC cell.
>
> DSNM belongs to the dataset-wide DSID fields, see 6.3.2 in
> https://iho.int/uploads/user/pubs/standards/s-57/20ApB1.pdf
>
> > Hello,
> >
> > After reading this documentation concerning the S-57 driver :
> >
> > https://gdal.org/drivers/vector/s57.html
> >
> > I thought the attribute DSNM ( Dataset name) should be defined on all
> features, no ?
> >
> > But on the source code, the method S57GenerateStandardAttributes
> (s57featuredefns.cpp) always attaches theses standard feature attributes :
> > GRUP, OBJL, RVER, AGEN, FIDN, FIDS but there is no mention of the DSNM
> attribute.
> >
> > Is it a mistake in the documentation? In the code? Or just a
> misunderstanding on my side?
> >
> > Thank you for your clarification,
> >
> > -- loïc
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> --
> Best Regards
>
> Andreas Oxenstierna
> T-Kartor Geospatial AB
> Olof Mohlins väg 12 Kristianstad
> mobile: +46 733 206831
> mailto: ao at t-kartor.se
> http://www.t-kartor.com
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/ee194d9a/attachment.html>

From even.rouault at spatialys.com  Sun May  3 03:49:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 12:49:26 +0200
Subject: [gdal-dev] S-57 driver Generic attribute DSNM
In-Reply-To: <CAOn9mqfWfYqWVK3DPpyJZHfN__9x9KuBcCGiqnBNOpkzrO_+fQ@mail.gmail.com>
References: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
 <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>
 <CAOn9mqfWfYqWVK3DPpyJZHfN__9x9KuBcCGiqnBNOpkzrO_+fQ@mail.gmail.com>
Message-ID: <2723806.VzL6uA1GNy@even-i700>

On dimanche 3 mai 2020 09:54:22 CEST kusala nine wrote:
> DSNM is dataset name. I'ts defined in the DSID which only occurs in the
> first field/subfield group in the dataset - not sure what the driver does
> in respect of it.

Right. The driver doc was incorrect. I've just fixed it per
https://github.com/OSGeo/gdal/commit/
c0722aed716e01fa3ab0ccc20fb911369baa3721

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/6ef9bbb5/attachment.html>

From even.rouault at spatialys.com  Sun May  3 10:09:48 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 19:09:48 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1588455949489-0.post@n6.nabble.com>
References: <5045356.a7JfxnZW0b@even-i700>
 <1588449553149-0.post@n6.nabble.com> <1588455949489-0.post@n6.nabble.com>
Message-ID: <1606719.W22ByrH90y@even-i700>

Roger,

For my understanding, are the failing tests mentioned by Bas maintained by the rgdal project 
?
I assume they must be run by
https://salsa.debian.org/r-pkg-team/r-cran-rgdal/-/blob/master/debian/tests/run-unit-test
and the actual tests are:
https://salsa.debian.org/r-pkg-team/r-cran-rgdal/-/tree/master/tests

Looking at
https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-rgdal/5203587/log.gz  , 
there doesn't seem to be much detail about what fails exactly.

Seeing
https://salsa.debian.org/r-pkg-team/r-cran-rgdal/-/blob/master/tests/
srs_rendering.Rout.save
and explicit mentions to PROJ and GDAL versions (6.0.0 and 2.4.0), if this .Rout.save file is 
compared to the output of tests against newer versions, that would be a likely explanation 
for at least a few failures.

The following message in the log is also a bit strange:
"""
 Loaded GDAL runtime: GDAL 3.1.0, released 2020/04/28
   but rgdal build and GDAL runtime not in sync:
   ... consider re-installing rgdal!!
"""
I'd assume everything to match perfectly in a Debian build env.

> Further, I don't know whether that is running ASAN, valgrind,
> or other CI variants. My feeling is often that CI is strewn with lots of
> false positives and negatives, and that manual testing (the old way) is
> actually effective.

I'm not sure to understand the message about CI. Some tests may be brittle and need to be 
adjusted/removed if needed, but that's considered a good practice to have automated tests. 
And running them under ASAN or valgrind is quite useful, I'd say even almost a requirement 
when you deal with native code that is very prone to a number of errors.

Anyway, I'll trust your judgment that things seem to be good on the rgdal side.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/b2863138/attachment-0001.html>

From sebastic at xs4all.nl  Sun May  3 10:22:11 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 3 May 2020 19:22:11 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1606719.W22ByrH90y@even-i700>
References: <5045356.a7JfxnZW0b@even-i700>
 <1588449553149-0.post@n6.nabble.com> <1588455949489-0.post@n6.nabble.com>
 <1606719.W22ByrH90y@even-i700>
Message-ID: <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>

On 5/3/20 7:09 PM, Even Rouault wrote:
> Looking at
> https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-rgdal/5203587/log.gz  , 
> there doesn't seem to be much detail about what fails exactly.

>From the log:

 autopkgtest [09:49:06]: test run-unit-test: [-----------------------
 ...
 BEGIN TEST srs_rendering.R

 R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
 Copyright (C) 2020 The R Foundation for Statistical Computing
 Platform: x86_64-pc-linux-gnu (64-bit)

 R is free software and comes with ABSOLUTELY NO WARRANTY.
 You are welcome to redistribute it under certain conditions.
 Type 'license()' or 'licence()' for distribution details.

 R is a collaborative project with many contributors.
 Type 'contributors()' for more information and
 'citation()' on how to cite R or R packages in publications.

 Type 'demo()' for some demos, 'help()' for on-line help, or
 'help.start()' for an HTML browser interface to help.
 Type 'q()' to quit R.

 > suppressPackageStartupMessages(library(rgdal))
 > getPROJ4VersionInfo()
 [1] "Rel. 7.0.0, March 1st, 2020, [PJ_VERSION: 700]"
 > getGDALVersionInfo()
 [1] "GDAL 3.1.0, released 2020/04/28"
 > d <- system.file("vectors", package="rgdal")
 > shps <- ogrListLayers(d)
 terminate called after throwing an instance of 'std::bad_alloc'
   what():  std::bad_alloc
 Aborted
 autopkgtest [09:49:07]: test run-unit-test: -----------------------]
 autopkgtest [09:49:07]: test run-unit-test:  - - - - - - - - - -
results - - - - - - - - - -
 run-unit-test        FAIL non-zero exit status 134

> The following message in the log is also a bit strange:
> """
>  Loaded GDAL runtime: GDAL 3.1.0, released 2020/04/28
>    but rgdal build and GDAL runtime not in sync:
>    ... consider re-installing rgdal!!
> """
> I'd assume everything to match perfectly in a Debian build env.

Nothing has been (re)built with GDAL 3.1.0 yet.

When packages are uploaded to experimental, autopkgtest is triggered for
the rdeps in unstable to test for any regressions.

The same is done when packages are uploaded to unstable, then the
autopkgtest for the rdeps in testing are triggered. Any regressions
block the migration of package.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From edzer.pebesma at uni-muenster.de  Sun May  3 10:36:55 2020
From: edzer.pebesma at uni-muenster.de (Edzer Pebesma)
Date: Sun, 3 May 2020 19:36:55 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
References: <5045356.a7JfxnZW0b@even-i700>
 <1588449553149-0.post@n6.nabble.com> <1588455949489-0.post@n6.nabble.com>
 <1606719.W22ByrH90y@even-i700>
 <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
Message-ID: <20ed7ed2-2835-e2ac-e4c7-aa18701f68a9@uni-muenster.de>

Hi Bas and Even,

I'm the author/maintainer of the sf package; Roger and I both follow
this list actively. Neither Roger nor me have been involved (nor
consulted, at least I wasn't) in the creation of the r-cran-sf or
r-cran-rgdal packages. I'd be happy to check out what is wrong, but have
no clue where to start.

In the r-cran-sf logs, I find:

autopkgtest [09:48:59]: build not needed

But if a new version of GDAL was just installed, a build would have been
needed (assuming we use dynamic linking).

The message you see from rgdal points to the same problem: rgdal seems
be built to GDAL version a, then GDAL version b is installed, then rgdal
is run: this shouldn't happen.

Could it be that the maintainer of both debian packages overlooked this?

I have tested sf earlier against GDAL 3.1.0RC1, and found no problems.

On 5/3/20 7:22 PM, Sebastiaan Couwenberg wrote:
> On 5/3/20 7:09 PM, Even Rouault wrote:
>> Looking at
>> https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-rgdal/5203587/log.gz  , 
>> there doesn't seem to be much detail about what fails exactly.
> 
> From the log:
> 
>  autopkgtest [09:49:06]: test run-unit-test: [-----------------------
>  ...
>  BEGIN TEST srs_rendering.R
> 
>  R version 3.6.3 (2020-02-29) -- "Holding the Windsock"
>  Copyright (C) 2020 The R Foundation for Statistical Computing
>  Platform: x86_64-pc-linux-gnu (64-bit)
> 
>  R is free software and comes with ABSOLUTELY NO WARRANTY.
>  You are welcome to redistribute it under certain conditions.
>  Type 'license()' or 'licence()' for distribution details.
> 
>  R is a collaborative project with many contributors.
>  Type 'contributors()' for more information and
>  'citation()' on how to cite R or R packages in publications.
> 
>  Type 'demo()' for some demos, 'help()' for on-line help, or
>  'help.start()' for an HTML browser interface to help.
>  Type 'q()' to quit R.
> 
>  > suppressPackageStartupMessages(library(rgdal))
>  > getPROJ4VersionInfo()
>  [1] "Rel. 7.0.0, March 1st, 2020, [PJ_VERSION: 700]"
>  > getGDALVersionInfo()
>  [1] "GDAL 3.1.0, released 2020/04/28"
>  > d <- system.file("vectors", package="rgdal")
>  > shps <- ogrListLayers(d)
>  terminate called after throwing an instance of 'std::bad_alloc'
>    what():  std::bad_alloc
>  Aborted
>  autopkgtest [09:49:07]: test run-unit-test: -----------------------]
>  autopkgtest [09:49:07]: test run-unit-test:  - - - - - - - - - -
> results - - - - - - - - - -
>  run-unit-test        FAIL non-zero exit status 134
> 
>> The following message in the log is also a bit strange:
>> """
>>  Loaded GDAL runtime: GDAL 3.1.0, released 2020/04/28
>>    but rgdal build and GDAL runtime not in sync:
>>    ... consider re-installing rgdal!!
>> """
>> I'd assume everything to match perfectly in a Debian build env.
> 
> Nothing has been (re)built with GDAL 3.1.0 yet.
> 
> When packages are uploaded to experimental, autopkgtest is triggered for
> the rdeps in unstable to test for any regressions.
> 
> The same is done when packages are uploaded to unstable, then the
> autopkgtest for the rdeps in testing are triggered. Any regressions
> block the migration of package.
> 
> Kind Regards,
> 
> Bas
> 

-- 
Edzer Pebesma
Institute for Geoinformatics
Heisenbergstrasse 2, 48149 Muenster, Germany
Phone: +49 251 8333081
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pEpkey.asc
Type: application/pgp-keys
Size: 3110 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/67e8ca93/attachment.key>

From even.rouault at spatialys.com  Sun May  3 10:47:30 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 19:47:30 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
References: <5045356.a7JfxnZW0b@even-i700> <1606719.W22ByrH90y@even-i700>
 <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
Message-ID: <8192055.4P4kRYIXZu@even-i700>

On dimanche 3 mai 2020 19:22:11 CEST Sebastiaan Couwenberg wrote:
> On 5/3/20 7:09 PM, Even Rouault wrote:
> > Looking at
> > https://ci.debian.net/data/autopkgtest/unstable/amd64/r/r-cran-rgdal/52035
> > 87/log.gz  , there doesn't seem to be much detail about what fails
> > exactly.
> 
> From the log:

ah ok, missed that was in the middle of the log

Looking at what is presumably the native side of ogrListLayers(),
https://salsa.debian.org/r-pkg-team/r-cran-rgdal/-/blob/master/src/ogrsource.cpp#L1090

I see it use thes GDAL C++ API. Given that the C++ ABI can change between GDAL feature 
releases (and it did change between 3.0 and 3.1 in the GDALDataset class used here), if rgdal 
isn't rebuilt against GDAL 3.1 headers, crashes are expected.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/aa3e9f39/attachment.html>

From sebastic at xs4all.nl  Sun May  3 10:50:17 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 3 May 2020 19:50:17 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <20ed7ed2-2835-e2ac-e4c7-aa18701f68a9@uni-muenster.de>
References: <5045356.a7JfxnZW0b@even-i700>
 <1588449553149-0.post@n6.nabble.com> <1588455949489-0.post@n6.nabble.com>
 <1606719.W22ByrH90y@even-i700>
 <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
 <20ed7ed2-2835-e2ac-e4c7-aa18701f68a9@uni-muenster.de>
Message-ID: <6b377898-b427-9a80-0721-bfd1ca0b07a1@xs4all.nl>

On 5/3/20 7:36 PM, Edzer Pebesma wrote:
> In the r-cran-sf logs, I find:
> 
> autopkgtest [09:48:59]: build not needed
> 
> But if a new version of GDAL was just installed, a build would have been
> needed (assuming we use dynamic linking).

GDAL did not bump the SONAME, so it claims to be ABI compatible with the
version the r-cran packages were built with. Rebuilding should not be
required. Or is this an R thing I'm not familiar with?

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From sebastic at xs4all.nl  Sun May  3 10:53:23 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 3 May 2020 19:53:23 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <8192055.4P4kRYIXZu@even-i700>
References: <5045356.a7JfxnZW0b@even-i700> <1606719.W22ByrH90y@even-i700>
 <f8c69060-dd77-b036-ea3a-b6746aa8229d@xs4all.nl>
 <8192055.4P4kRYIXZu@even-i700>
Message-ID: <aea885a1-1dda-8b72-5463-c7aec7688f6a@xs4all.nl>

On 5/3/20 7:47 PM, Even Rouault wrote:
> Looking at what is presumably the native side of ogrListLayers(),
> https://salsa.debian.org/r-pkg-team/r-cran-rgdal/-/blob/master/src/ogrsource.cpp#L1090
> 
> I see it use thes GDAL C++ API. Given that the C++ ABI can change between GDAL feature 
> releases (and it did change between 3.0 and 3.1 in the GDALDataset class used here), if rgdal 
> isn't rebuilt against GDAL 3.1 headers, crashes are expected.

Why wasn't the SONAME bumped to reflect the ABI breakage?

We dropped the virtual dependency that required rebuilding for every
GDAL version change because you claimed that this wasn't required any more.

It seems we'll need to reintroduce this because the libgdal ABI is not
stable.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From even.rouault at spatialys.com  Sun May  3 11:10:03 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 20:10:03 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <aea885a1-1dda-8b72-5463-c7aec7688f6a@xs4all.nl>
References: <5045356.a7JfxnZW0b@even-i700> <8192055.4P4kRYIXZu@even-i700>
 <aea885a1-1dda-8b72-5463-c7aec7688f6a@xs4all.nl>
Message-ID: <2860834.2dn08bBrkX@even-i700>

> Why wasn't the SONAME bumped to reflect the ABI breakage?

For me, SONAME bump was meant for the C ABI. I don't think this was intended for the C++ 
one.

> We dropped the virtual dependency that required rebuilding for every
> GDAL version change because you claimed that this wasn't required any more.

There has been obviously a misunderstanding. The rule we follow is that:
- between GDAL X.Y.Z and X.Y.(Z+1), both C and C++ ABI are stable
- between GDAL X.Y and X.(Y+1), the C ABI is stable, but the C++ one not

And this is what we have in our release procedure:
"""
4) Update LIBGDAL_CURRENT/REVISION/AGE macros in GDALmake.opt.in.
   - For a release with no interface changes just bump REVISION.
   - Adding interfaces, bump CURRENT/AGE, set REVISION to 0.
   - Deleting interfaces / compatibility issues - bump CURRENT, others to zero.
"""

So as interfaces were added, I bumped CURRENT/AGE and set REVISION to 0.
But maybe "compatibility issues" should also be understood to changes that affect the C++ 
ABI ?

I'm not sure about the resolution here. Should I do a RC3 that sets
CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/51d1bc1b/attachment.html>

From sebastic at xs4all.nl  Sun May  3 11:40:56 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 3 May 2020 20:40:56 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <2860834.2dn08bBrkX@even-i700>
References: <5045356.a7JfxnZW0b@even-i700> <8192055.4P4kRYIXZu@even-i700>
 <aea885a1-1dda-8b72-5463-c7aec7688f6a@xs4all.nl>
 <2860834.2dn08bBrkX@even-i700>
Message-ID: <08b0dc40-e1a8-e433-908b-8213617383fc@xs4all.nl>

On 5/3/20 8:10 PM, Even Rouault wrote:
>> Why wasn't the SONAME bumped to reflect the ABI breakage?
> 
> For me, SONAME bump was meant for the C ABI. I don't think this was intended for the C++ 
> one.

They share the same library, so the SONAME covers both.

If you don't want that, then two libraries need to be built with their
own library versioning.

That would allow for more granular rebuilds of rdeps as the C++ using
ones will need to be rebuilt for X.(Y+1) versions but the C using ones not.

>> We dropped the virtual dependency that required rebuilding for every
>> GDAL version change because you claimed that this wasn't required any more.
> 
> There has been obviously a misunderstanding. The rule we follow is that:
> - between GDAL X.Y.Z and X.Y.(Z+1), both C and C++ ABI are stable
> - between GDAL X.Y and X.(Y+1), the C ABI is stable, but the C++ one not
> 
> And this is what we have in our release procedure:
> """
> 4) Update LIBGDAL_CURRENT/REVISION/AGE macros in GDALmake.opt.in.
>    - For a release with no interface changes just bump REVISION.
>    - Adding interfaces, bump CURRENT/AGE, set REVISION to 0.
>    - Deleting interfaces / compatibility issues - bump CURRENT, others to zero.
> """
> 
> So as interfaces were added, I bumped CURRENT/AGE and set REVISION to 0.
> But maybe "compatibility issues" should also be understood to changes that affect the C++ 
> ABI ?

Yes. If the ABI of the library is not compatibly any more, i.e. rdeps
needs to be rebuilt, then the SONAME needs to be bumped.

> I'm not sure about the resolution here. Should I do a RC3 that sets
> CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?

Yes, as that bumps the SONAME to libgdal.so.27, which signals that rdeps
need to be rebuilt.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From gdt at lexort.com  Sun May  3 11:43:07 2020
From: gdt at lexort.com (Greg Troxel)
Date: Sun, 03 May 2020 14:43:07 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <2860834.2dn08bBrkX@even-i700> (Even Rouault's message of "Sun,
 03 May 2020 20:10:03 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <8192055.4P4kRYIXZu@even-i700>
 <aea885a1-1dda-8b72-5463-c7aec7688f6a@xs4all.nl>
 <2860834.2dn08bBrkX@even-i700>
Message-ID: <rmimu6o6ero.fsf@s1.lexort.com>

Even Rouault <even.rouault at spatialys.com> writes:

[I'm behind in dealing with gdal, but otherwise would be in the same
boat as Bas]

> There has been obviously a misunderstanding. The rule we follow is that:
> - between GDAL X.Y.Z and X.Y.(Z+1), both C and C++ ABI are stable
> - between GDAL X.Y and X.(Y+1), the C ABI is stable, but the C++ one not

That's a perfectly ok policy.

> And this is what we have in our release procedure:
> """
> 4) Update LIBGDAL_CURRENT/REVISION/AGE macros in GDALmake.opt.in.
>    - For a release with no interface changes just bump REVISION.
>    - Adding interfaces, bump CURRENT/AGE, set REVISION to 0.
>    - Deleting interfaces / compatibility issues - bump CURRENT, others to zero.
> """

This doesn't make sense.  The current/revision/age needs to be handled
differently for the C library and the C++ library, because in feature
releases one of them does not have an ABI break and the other one does
have an ABI break.  They will then not have the same shlib major
numbers, which is an obvious consequence of the above versioning policy.

> So as interfaces were added, I bumped CURRENT/AGE and set REVISION to 0.
> But maybe "compatibility issues" should also be understood to changes that affect the C++ 
> ABI ?
>
> I'm not sure about the resolution here. Should I do a RC3 that sets
> CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?

I think it would be really unfortunate to break the C ABI as a side
effect.  That would change your policy above that there is (perhaps) an
ABI break on feature releases.

Even better would be to keep the C++ ABI stable.  I'm not really clear
on the details here, but it seems that  C++ and stable  tend not to go
together, and I have heard people (not necessarily here) express that it
is too hard to know if the C++ lib ABI has changed or not.

From even.rouault at spatialys.com  Sun May  3 12:15:45 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 21:15:45 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <rmimu6o6ero.fsf@s1.lexort.com>
References: <5045356.a7JfxnZW0b@even-i700> <2860834.2dn08bBrkX@even-i700>
 <rmimu6o6ero.fsf@s1.lexort.com>
Message-ID: <3143160.AbzmgzM9H7@even-i700>

Answering Bas'

> If you don't want that, then two libraries need to be built with their
> own library versioning.

and Gregs'

> This doesn't make sense.  The current/revision/age needs to be handled
> differently for the C library and the C++ library, because in feature
> releases one of them does not have an ABI break and the other one does
> have an ABI break.  They will then not have the same shlib major
> numbers, which is an obvious consequence of the above versioning policy.

Separating a C library from a C++ one would represent a big deal of work, as there are C 
symbols called from C++ code, so that means that when currently there's a C function like 
GDALInvGeoTransform(), there should be a C++ one, like gdal::InvGeoTransform() that does 
what GDALInvGeoTransform() does, and GDALInvGeoTransform() would call this one, and 
make sure all code from drivers etc that calls currently GDALInvGeoTransform() would call 
instead gdal::InvGeoTransform().
Anyway this isn't a discussion for this release, but more for a GDAL 4 or more.

> > I'm not sure about the resolution here. Should I do a RC3 that sets
> > CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?
> 
> I think it would be really unfortunate to break the C ABI as a side
> effect.  That would change your policy above that there is (perhaps) an
> ABI break on feature releases.

The C ABI of GDAL 3.1 is the same as GDAL 3.0. But if I bump the CURRENT number, as there's 
just one lib, it will apply to the C and C++ side of it obviously. So I can imagine that's slightly 
inconvenient for people that just depend on the C ABI and wouldn't need to rebuild, but I'm 
afraid there's no way to make everybody happy.

> Even better would be to keep the C++ ABI stable.

Not doable. Sometimes you need to add a new virtual method for exemple, like was done for 
3.1.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/33c8c500/attachment.html>

From sebastic at xs4all.nl  Sun May  3 12:24:18 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sun, 3 May 2020 21:24:18 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <3143160.AbzmgzM9H7@even-i700>
References: <5045356.a7JfxnZW0b@even-i700> <2860834.2dn08bBrkX@even-i700>
 <rmimu6o6ero.fsf@s1.lexort.com> <3143160.AbzmgzM9H7@even-i700>
Message-ID: <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>

On 5/3/20 9:15 PM, Even Rouault wrote:
> Answering Bas'
> 
>> If you don't want that, then two libraries need to be built with their
>> own library versioning.
> 
> and Gregs'
> 
>> This doesn't make sense.  The current/revision/age needs to be handled
>> differently for the C library and the C++ library, because in feature
>> releases one of them does not have an ABI break and the other one does
>> have an ABI break.  They will then not have the same shlib major
>> numbers, which is an obvious consequence of the above versioning policy.
> 
> Separating a C library from a C++ one would represent a big deal of work, as there are C 
> symbols called from C++ code, so that means that when currently there's a C function like 
> GDALInvGeoTransform(), there should be a C++ one, like gdal::InvGeoTransform() that does 
> what GDALInvGeoTransform() does, and GDALInvGeoTransform() would call this one, and 
> make sure all code from drivers etc that calls currently GDALInvGeoTransform() would call 
> instead gdal::InvGeoTransform().
> Anyway this isn't a discussion for this release, but more for a GDAL 4 or more.
> 
>>> I'm not sure about the resolution here. Should I do a RC3 that sets
>>> CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?
>>
>> I think it would be really unfortunate to break the C ABI as a side
>> effect.  That would change your policy above that there is (perhaps) an
>> ABI break on feature releases.
> 
> The C ABI of GDAL 3.1 is the same as GDAL 3.0. But if I bump the CURRENT number, as there's 
> just one lib, it will apply to the C and C++ side of it obviously. So I can imagine that's slightly 
> inconvenient for people that just depend on the C ABI and wouldn't need to rebuild, but I'm 
> afraid there's no way to make everybody happy.

It's indeed not possible to make everybody happy, so the question is who
you do mind the least to make unhappy.

If nothing changes packagers like me will be unhappy because they need
to reintroduce the virtual dependency for the unstable C++ ABI.

C-only users will be unhappy about having to rebuild their code when the
only C++ ABI breaks.

And you will be unhappy if you have to split the library.

Bumping the SONAME for C++-only ABI breaks is the most correct solution
as long as its provided by the same library, and splitting the libraries
in GDAL 4 seems like the right thing to do.

The choice is up to you.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From gdt at lexort.com  Sun May  3 12:33:27 2020
From: gdt at lexort.com (Greg Troxel)
Date: Sun, 03 May 2020 15:33:27 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <3143160.AbzmgzM9H7@even-i700> (Even Rouault's message of "Sun,
 03 May 2020 21:15:45 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <2860834.2dn08bBrkX@even-i700>
 <rmimu6o6ero.fsf@s1.lexort.com> <3143160.AbzmgzM9H7@even-i700>
Message-ID: <rmiees06cfs.fsf@s1.lexort.com>

Even Rouault <even.rouault at spatialys.com> writes:

> Answering Bas'
>
>> If you don't want that, then two libraries need to be built with their
>> own library versioning.
>
> and Gregs'
>
>> This doesn't make sense.  The current/revision/age needs to be handled
>> differently for the C library and the C++ library, because in feature
>> releases one of them does not have an ABI break and the other one does
>> have an ABI break.  They will then not have the same shlib major
>> numbers, which is an obvious consequence of the above versioning policy.
>
> Separating a C library from a C++ one would represent a big deal of work, as there are C 
> symbols called from C++ code, so that means that when currently there's a C function like 
> GDALInvGeoTransform(), there should be a C++ one, like gdal::InvGeoTransform() that does 
> what GDALInvGeoTransform() does, and GDALInvGeoTransform() would call this one, and 
> make sure all code from drivers etc that calls currently GDALInvGeoTransform() would call 
> instead gdal::InvGeoTransform().
> Anyway this isn't a discussion for this release, but more for a GDAL 4 or more.

If the ABI changes you have to bump the shlib major.  Or, you have to
have some special, irregular rule, that says the C++ ABI is unstable
despite the shlib staying the same, or a special rule that says the C++
ABI is private and may not be used.

>> > I'm not sure about the resolution here. Should I do a RC3 that sets
>> > CURRENT/REVISION/AGE to 27/0/0 ? Would that help ?
>> 
>> I think it would be really unfortunate to break the C ABI as a side
>> effect.  That would change your policy above that there is (perhaps) an
>> ABI break on feature releases.
>
> The C ABI of GDAL 3.1 is the same as GDAL 3.0. But if I bump the CURRENT number, as there's 
> just one lib, it will apply to the C and C++ side of it obviously. So I can imagine that's slightly 
> inconvenient for people that just depend on the C ABI and wouldn't need to rebuild, but I'm 
> afraid there's no way to make everybody happy.

This is the nature of using C++ :-(

>> Even better would be to keep the C++ ABI stable.
>
> Not doable. Sometimes you need to add a new virtual method for exemple, like was done for 
> 3.1.


At least for this relase, there should be a paragraph in NEWS that very
clearly explains the API/ABI change situation with respect to previous
releases and whether shlib majors have changed, and any deviations from
norms.  Maybe that's there, but Bas seemed surprised by this.  I admit
that I don't usually see this, but I think statements of API/ABI compat
belong in NEWS and should be super clear.

From gdt at lexort.com  Sun May  3 12:35:31 2020
From: gdt at lexort.com (Greg Troxel)
Date: Sun, 03 May 2020 15:35:31 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl> (Sebastiaan
 Couwenberg's message of "Sun, 3 May 2020 21:24:18 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <2860834.2dn08bBrkX@even-i700>
 <rmimu6o6ero.fsf@s1.lexort.com> <3143160.AbzmgzM9H7@even-i700>
 <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>
Message-ID: <rmia72o6ccc.fsf@s1.lexort.com>

Sebastiaan Couwenberg <sebastic at xs4all.nl> writes:

> It's indeed not possible to make everybody happy, so the question is who
> you do mind the least to make unhappy.
>
> If nothing changes packagers like me will be unhappy because they need
> to reintroduce the virtual dependency for the unstable C++ ABI.
>
> C-only users will be unhappy about having to rebuild their code when the
> only C++ ABI breaks.
>
> And you will be unhappy if you have to split the library.
>
> Bumping the SONAME for C++-only ABI breaks is the most correct solution
> as long as its provided by the same library, and splitting the libraries
> in GDAL 4 seems like the right thing to do.
>
> The choice is up to you.

I wasn't as crisp but I agree with all that.

From even.rouault at spatialys.com  Sun May  3 13:05:57 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 03 May 2020 22:05:57 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>
References: <5045356.a7JfxnZW0b@even-i700> <3143160.AbzmgzM9H7@even-i700>
 <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>
Message-ID: <1713709.cfhjlL6yAi@even-i700>

> It's indeed not possible to make everybody happy, so the question is who
> you do mind the least to make unhappy.
> 
> If nothing changes packagers like me will be unhappy because they need
> to reintroduce the virtual dependency for the unstable C++ ABI.
> 
> C-only users will be unhappy about having to rebuild their code when the
> only C++ ABI breaks.
> 
> And you will be unhappy if you have to split the library.

OK, so here's what I intend to change for RC3:
https://github.com/OSGeo/gdal/pull/2466/files

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200503/a59decb6/attachment-0001.html>

From loic at justmagic.com  Sun May  3 15:27:25 2020
From: loic at justmagic.com (=?utf-8?B?bG/Dr2M=?=)
Date: Mon, 4 May 2020 00:27:25 +0200
Subject: [gdal-dev] S-57 driver Generic attribute DSNM
In-Reply-To: <2723806.VzL6uA1GNy@even-i700>
References: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
 <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>
 <CAOn9mqfWfYqWVK3DPpyJZHfN__9x9KuBcCGiqnBNOpkzrO_+fQ@mail.gmail.com>
 <2723806.VzL6uA1GNy@even-i700>
Message-ID: <35BC1F7E-CCD9-4796-B8E0-33717F592035@justmagic.com>

Thank you all for your explanations.

I'm sad that this is a mistake in the doc :-) because as you pointed out S57 spec has no GUID definition. With the combination of the LNAM + DSNM, it allowed to have one that would be convenient in a PostGIS database that contains many S-57 charts.

On my fork of GDAL I add this attribute DSNM (as defined in the previous documentation),  and since the DSNM field is mandatory in the S57 spec I did not detect any problem.  (Tested with several S57 source US, UK, ES, HR, ... )

In case it would be helpful, I could make a PR.

-- loïc  


> On 3 May 2020, at 12:49, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> On dimanche 3 mai 2020 09:54:22 CEST kusala nine wrote:
> > DSNM is dataset name. I'ts defined in the DSID which only occurs in the
> > first field/subfield group in the dataset - not sure what the driver does
> > in respect of it.
>  
> Right. The driver doc was incorrect. I've just fixed it per
> https://github.com/OSGeo/gdal/commit/c0722aed716e01fa3ab0ccc20fb911369baa3721
>  
> Even
>  
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From mwtoews at gmail.com  Sun May  3 16:17:52 2020
From: mwtoews at gmail.com (Mike Taves)
Date: Mon, 4 May 2020 11:17:52 +1200
Subject: [gdal-dev] Affine transform: Practical uses of x-skew and y-skew
In-Reply-To: <DM6PR17MB3884F9D91962D87B89BE6375C7AB0@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB3884F9D91962D87B89BE6375C7AB0@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <CAM2FmMps6jGk5-VpsL6hJt6gc5rJ73tRnk9J6Q9=cMsoqt1zpg@mail.gmail.com>

On Sat, 2 May 2020 at 08:01, Craig Delancy
<cdelancy at blackfangtechnologies.com> wrote:
> I am trying to explain to a colleague how the affine transform maps image coordinates onto a projection system.
> Specifically, I am trying to explain how mathematically speaking, any parallelogram section of the coordinate system can be represented by the rectangular image.
> After a bit of searching, I wasn’t able to find an example dataset to illustrate this.
>
> I am wondering, is there any practical use for this?
> Does anyone have an example dataset they would be willing to send/show me?

The terms "x-skew" and "y-skew" are a bit misleading, as these are two
coefficients in a matrix. Possibly a better label is "shear", since
they are coefficients that relate to two dimensions, which are
normally zero if the raster is aligned to the coordinate system. You
can see the maths and visualise some of the transforms with Shapely
docs:
https://shapely.readthedocs.io/en/latest/manual.html#affine-transformations

And you can assemble some real-world affine transforms for GDAL using
the Affine Python package:

from affine import Affine
a = Affine.from_gdal(101985.0, 300.0, 0.0, 826915.0, 0.0, -300.0)
print(a)
# | 300.00, 0.00, 101985.00|
# | 0.00,-300.00, 826915.00|
# | 0.00, 0.00, 1.00|
ash = a * Affine.shear(20)
print(ash)
# | 300.00, 109.19, 101985.00|
# | 0.00,-300.00, 826915.00|
# | 0.00, 0.00, 1.00|
print(ash.to_gdal())
# (101985.0, 300.0, 109.1910702798607, 826915.0, 0.0, -300.0)

As you can see there are from_gdal and to_gdal methods to re-arrange
the order of coefficients for GDAL's get/set GeoTransform methods.
Shearing the geotransform by 20 degrees along the x-axis only modifies
one coefficient in the matrix. Obviously there is plenty of further
reading on Wikipedia and other free sources.

From gdt at lexort.com  Sun May  3 17:01:03 2020
From: gdt at lexort.com (Greg Troxel)
Date: Sun, 03 May 2020 20:01:03 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1713709.cfhjlL6yAi@even-i700> (Even Rouault's message of "Sun,
 03 May 2020 22:05:57 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <3143160.AbzmgzM9H7@even-i700>
 <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>
 <1713709.cfhjlL6yAi@even-i700>
Message-ID: <rmiees01scg.fsf@s1.lexort.com>

Even Rouault <even.rouault at spatialys.com> writes:

>> It's indeed not possible to make everybody happy, so the question is who
>> you do mind the least to make unhappy.
>> 
>> If nothing changes packagers like me will be unhappy because they need
>> to reintroduce the virtual dependency for the unstable C++ ABI.
>> 
>> C-only users will be unhappy about having to rebuild their code when the
>> only C++ ABI breaks.
>> 
>> And you will be unhappy if you have to split the library.
>
> OK, so here's what I intend to change for RC3:
> https://github.com/OSGeo/gdal/pull/2466/files

Not 100% sure I followed, but:  If you change the shlib major number,
you have changed the ABI, even if the symbols are the same.

From even.rouault at spatialys.com  Sun May  3 17:14:35 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 May 2020 02:14:35 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <rmiees01scg.fsf@s1.lexort.com>
References: <5045356.a7JfxnZW0b@even-i700> <1713709.cfhjlL6yAi@even-i700>
 <rmiees01scg.fsf@s1.lexort.com>
Message-ID: <12414323.hFMcE6Xlbd@even-i700>

> Not 100% sure I followed, but:  If you change the shlib major 
number,
> you have changed the ABI, even if the symbols are the same.

Yes, but the reasoning is actually the reverse: the (C++) ABI has 
changed, so given libgdal contains both a C and C++ API, we 
have to bump th shlib major number.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200504/0d4838fe/attachment.html>

From gdt at lexort.com  Sun May  3 17:18:08 2020
From: gdt at lexort.com (Greg Troxel)
Date: Sun, 03 May 2020 20:18:08 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <12414323.hFMcE6Xlbd@even-i700> (Even Rouault's message of "Mon, 
 04 May 2020 02:14:35 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <1713709.cfhjlL6yAi@even-i700>
 <rmiees01scg.fsf@s1.lexort.com> <12414323.hFMcE6Xlbd@even-i700>
Message-ID: <rmia72o1rjz.fsf@s1.lexort.com>

Even Rouault <even.rouault at spatialys.com> writes:

>> Not 100% sure I followed, but:  If you change the shlib major 
> number,
>> you have changed the ABI, even if the symbols are the same.
>
> Yes, but the reasoning is actually the reverse: the (C++) ABI has 
> changed, so given libgdal contains both a C and C++ API, we 
> have to bump th shlib major number.

What I menat is that in the text of NEWS, you should not say that the C
ABI is unchanged.   A "ABI has not changed" statement implies that one
can swap in the new binaries without rebuilding any depending packages.

From even.rouault at spatialys.com  Sun May  3 17:27:17 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 May 2020 02:27:17 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <rmia72o1rjz.fsf@s1.lexort.com>
References: <5045356.a7JfxnZW0b@even-i700> <12414323.hFMcE6Xlbd@even-i700>
 <rmia72o1rjz.fsf@s1.lexort.com>
Message-ID: <1855226.03xh73XKCI@even-i700>

> What I menat is that in the text of NEWS, you should not say that 
the C
> ABI is unchanged.   A "ABI has not changed" statement implies that 
one
> can swap in the new binaries without rebuilding any depending 
packages.

That would be true: you could replace the .so of GDAL 3.0 by the one 
of 3.1 if the library/application that link to GDAL only use the C ABI. 
But given that the .so name will change, you'll probably have to 
recompile it anyway, unless you (ab)use symlinks tricks.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200504/c7e0c8ed/attachment.html>

From sebastic at xs4all.nl  Sun May  3 21:02:48 2020
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Mon, 4 May 2020 06:02:48 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1713709.cfhjlL6yAi@even-i700>
References: <5045356.a7JfxnZW0b@even-i700> <3143160.AbzmgzM9H7@even-i700>
 <09dfd653-7b4d-9676-66f7-b28935c37f6e@xs4all.nl>
 <1713709.cfhjlL6yAi@even-i700>
Message-ID: <3d7719db-9f83-7042-bd24-8e4c60260236@xs4all.nl>

On 5/3/20 10:05 PM, Even Rouault wrote:
>> It's indeed not possible to make everybody happy, so the question is who
>> you do mind the least to make unhappy.
>>
>> If nothing changes packagers like me will be unhappy because they need
>> to reintroduce the virtual dependency for the unstable C++ ABI.
>>
>> C-only users will be unhappy about having to rebuild their code when the
>> only C++ ABI breaks.
>>
>> And you will be unhappy if you have to split the library.
> 
> OK, so here's what I intend to change for RC3:
> https://github.com/OSGeo/gdal/pull/2466/files

Bumping the SONAME is great, the rest looks good too.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From ao at t-kartor.se  Sun May  3 23:35:30 2020
From: ao at t-kartor.se (Andreas Oxenstierna)
Date: Mon, 4 May 2020 08:35:30 +0200
Subject: [gdal-dev] S-57 driver Generic attribute DSNM
In-Reply-To: <35BC1F7E-CCD9-4796-B8E0-33717F592035@justmagic.com>
References: <D551738C-51A9-4F06-99A2-60CFAE4D2FE5@justmagic.com>
 <c7769cfb-0394-c16b-7c19-1c92054c644b@t-kartor.se>
 <CAOn9mqfWfYqWVK3DPpyJZHfN__9x9KuBcCGiqnBNOpkzrO_+fQ@mail.gmail.com>
 <2723806.VzL6uA1GNy@even-i700>
 <35BC1F7E-CCD9-4796-B8E0-33717F592035@justmagic.com>
Message-ID: <0a303e87-d956-e60c-dc18-65b9417c5bab@t-kartor.se>

Note that the same logic should be applied to the spatial features, if 
these are handled (i.e. RETURN_PRIMITIVES=ON).
And for feature-feature links, i.e. RETURN_LINKAGES=ON


> Thank you all for your explanations.
>
> I'm sad that this is a mistake in the doc :-) because as you pointed out S57 spec has no GUID definition. With the combination of the LNAM + DSNM, it allowed to have one that would be convenient in a PostGIS database that contains many S-57 charts.
>
> On my fork of GDAL I add this attribute DSNM (as defined in the previous documentation),  and since the DSNM field is mandatory in the S57 spec I did not detect any problem.  (Tested with several S57 source US, UK, ES, HR, ... )
>
> In case it would be helpful, I could make a PR.
>
> -- loïc
>
>
>> On 3 May 2020, at 12:49, Even Rouault <even.rouault at spatialys.com> wrote:
>>
>> On dimanche 3 mai 2020 09:54:22 CEST kusala nine wrote:
>>> DSNM is dataset name. I'ts defined in the DSID which only occurs in the
>>> first field/subfield group in the dataset - not sure what the driver does
>>> in respect of it.
>>   
>> Right. The driver doc was incorrect. I've just fixed it per
>> https://github.com/OSGeo/gdal/commit/c0722aed716e01fa3ab0ccc20fb911369baa3721
>>   
>> Even
>>   
>> -- 
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Best Regards

Andreas Oxenstierna
T-Kartor Geospatial AB
Olof Mohlins väg 12 Kristianstad
mobile: +46 733 206831
mailto: ao at t-kartor.se
http://www.t-kartor.com


From even.rouault at spatialys.com  Mon May  4 02:07:54 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 May 2020 11:07:54 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC2 --> withdrawn
In-Reply-To: <3621624.jAbUzChElj@even-i700>
References: <3621624.jAbUzChElj@even-i700>
Message-ID: <4662368.8X43qPpErc@even-i700>

On jeudi 30 avril 2020 11:34:52 CEST Even Rouault wrote:
> Hi,
> 
> Having adressed the few issues raised about RC1, I believe RC2 is good to
> go.
> 
> Motion: promote GDAL 3.1.0 RC2 to final 3.1.0
> 
> Starting with my +1

Changing my vote to -1 to prepare a RC3. Motion withdrawn

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200504/b66221f9/attachment.html>

From rajeshreddy_m at yahoo.co.in  Mon May  4 02:55:40 2020
From: rajeshreddy_m at yahoo.co.in (rmaddu)
Date: Mon, 4 May 2020 02:55:40 -0700 (MST)
Subject: [gdal-dev] OGR2OGR C# bindings: How to deliver with product
Message-ID: <1588586140080-0.post@n6.nabble.com>

Dear All,

We are using  GDAL C# bindings located at ...\bin\gdal\csharp (downloaded
the release-1911-gdal-3-0-4-mapserver-7-4-3.zip from
http://download.gisinternals.com/) in our product for vector tiles work.
Question is - How to deliver GDAL with our product?

1. Do we have any GDAL merge modules so that we can deliver with our setup?
2. What is the best approach to deliver binaries or plugins with our product
setup.
2. We don't want to convey customers saying that install GDAL utilities or
some other setups in their environment?


Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon May  4 03:31:20 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 04 May 2020 12:31:20 +0200
Subject: [gdal-dev] GDAL 3.1.0 RC3 available
Message-ID: <9809867.i1NWo2dYWH@even-i700>

Hi,

I have prepared a third, and hopefully final, release candidate.

The changes since RC2 are:
- (reason for this RC3) bump Unix SONAME to 27
- FlatGeobuf: add null check for readMultiPolygon (#2461) (fixes #2459)
- Warper RPC: fix issue when source image has a geotransform (fixes #2460)
- EXR: add missing #include <algorithm> (fixes #2467)
- gt_overview.h: remove CPL_DLL on GTIFFBuildOverviewsEx()
- EPSGTreatsAsNorthingEasting(): fix it to properly deal with Polar projected CRS with 
northing,easting order

Updated files are at:

  https://download.osgeo.org/gdal/3.1.0/gdal-3.1.0rc3.tar.xz
  https://download.osgeo.org/gdal/3.1.0/gdal-3.1.0rc3.tar.gz
  https://download.osgeo.org/gdal/3.1.0/gdal310rc3.zip

  https://download.osgeo.org/gdal/3.1.0/gdalautotest-3.1.0rc3.tar.gz
  https://download.osgeo.org/gdal/3.1.0/gdalautotest-3.1.0rc3.zip

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200504/b821af4f/attachment.html>

From gdt at lexort.com  Mon May  4 05:13:56 2020
From: gdt at lexort.com (Greg Troxel)
Date: Mon, 04 May 2020 08:13:56 -0400
Subject: [gdal-dev] GDAL 3.1.0 RC2 available
In-Reply-To: <1855226.03xh73XKCI@even-i700> (Even Rouault's message of "Mon,
 04 May 2020 02:27:17 +0200")
References: <5045356.a7JfxnZW0b@even-i700> <12414323.hFMcE6Xlbd@even-i700>
 <rmia72o1rjz.fsf@s1.lexort.com> <1855226.03xh73XKCI@even-i700>
Message-ID: <rmizhanzym3.fsf@s1.lexort.com>

Even Rouault <even.rouault at spatialys.com> writes:

>> What I menat is that in the text of NEWS, you should not say that 
> the C
>> ABI is unchanged.   A "ABI has not changed" statement implies that 
> one
>> can swap in the new binaries without rebuilding any depending 
> packages.
>
> That would be true: you could replace the .so of GDAL 3.0 by the one 
> of 3.1 if the library/application that link to GDAL only use the C ABI. 
> But given that the .so name will change, you'll probably have to 
> recompile it anyway, unless you (ab)use symlinks tricks.

Exactly, so from a "build the new release, remove all files from
previous build, and put the new files in place" point of view, there is
an ABI break, and programs compiled against the old one will fail.
Hence packaging systems need to treat this as an ABI break, and NEWS
should say that.

From even.rouault at spatialys.com  Tue May  5 02:39:35 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 05 May 2020 11:39:35 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
Message-ID: <226980322.neGjxTAKcH@even-i700>

Hi,

Motion: promote GDAL 3.1.0 RC3 to final 3.1.0

Starting with my +1

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200505/df1c7776/attachment.html>

From jmckenna at gatewaygeomatics.com  Tue May  5 04:25:21 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 5 May 2020 08:25:21 -0300
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <226980322.neGjxTAKcH@even-i700>
References: <226980322.neGjxTAKcH@even-i700>
Message-ID: <d52e6591-5403-1df9-b9de-75fbe244c49b@gatewaygeomatics.com>

On 2020-05-05 6:39 a.m., Even Rouault wrote:
> Hi,
> 
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
> 
>

+1 jeff



-- 
Jeff McKenna
MapServer Consulting and Training Services
https://gatewaygeo.com/

From howard at hobu.co  Tue May  5 06:43:31 2020
From: howard at hobu.co (Howard Butler)
Date: Tue, 5 May 2020 08:43:31 -0500
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <226980322.neGjxTAKcH@even-i700>
References: <226980322.neGjxTAKcH@even-i700>
Message-ID: <4C162FF1-761B-46E4-AA15-133D98E418E1@hobu.co>



> On May 5, 2020, at 4:39 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
>  
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
>  
> Starting with my +1

+1 Howard

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200505/eb4c1aba/attachment.html>

From mateusz at loskot.net  Tue May  5 07:12:11 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 5 May 2020 16:12:11 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <4C162FF1-761B-46E4-AA15-133D98E418E1@hobu.co>
References: <226980322.neGjxTAKcH@even-i700>
 <4C162FF1-761B-46E4-AA15-133D98E418E1@hobu.co>
Message-ID: <CABUeae-wcBotz=weLWfsg0nnUBXN0bg0JxmsqCZA1t=tj7K6Ww@mail.gmail.com>

+1   Mateusz

On Tue, 5 May 2020 at 15:43, Howard Butler <howard at hobu.co> wrote:
>
>
>
> On May 5, 2020, at 4:39 AM, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi,
>
>
>
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
>
>
>
> Starting with my +1
>
>
> +1 Howard
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Tue May  5 07:44:47 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 5 May 2020 07:44:47 -0700 (MST)
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <226980322.neGjxTAKcH@even-i700>
References: <226980322.neGjxTAKcH@even-i700>
Message-ID: <1588689887035-0.post@n6.nabble.com>

+1

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
> 
> Starting with my +1
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From dmorissette at mapgears.com  Tue May  5 08:04:26 2020
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 5 May 2020 11:04:26 -0400
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <226980322.neGjxTAKcH@even-i700>
References: <226980322.neGjxTAKcH@even-i700>
Message-ID: <056adc4a-82f0-a599-da0c-4c752f4634b9@mapgears.com>

+1

Daniel

On 2020-05-05 05:39, Even Rouault wrote:
> Hi,
> 
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
> 
> Starting with my +1
> 
> Even
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From doug at riverloopsecurity.com  Tue May  5 14:27:21 2020
From: doug at riverloopsecurity.com (Doug Gastonguay-Goddard)
Date: Tue, 5 May 2020 16:27:21 -0500
Subject: [gdal-dev] Example NITF files with TRE
Message-ID: <CABjQhjxCqegWXdiMmrGBqZZ0EK451WDdV51NyQXEq0oEr3quBQ@mail.gmail.com>

Hey, I have gotten pretty good coverage from Spacenet, WPAFB-2009, and
the Geospatial Working Group test files. I am wondering if anyone has
a public source for NITF files with DES, RES, or TRE. I am writing a
parser and it is always nice to have an example to validate my
interpretation of the spec.

There might be some in the datasets I have that I missed. I know there
is a trailing header example I have not gotten to supporting yet.

Thanks,
Doug

From bradh at frogmouth.net  Tue May  5 14:59:47 2020
From: bradh at frogmouth.net (Brad Hards)
Date: Wed, 6 May 2020 07:59:47 +1000
Subject: [gdal-dev] Example NITF files with TRE
In-Reply-To: <CABjQhjxCqegWXdiMmrGBqZZ0EK451WDdV51NyQXEq0oEr3quBQ@mail.gmail.com>
References: <CABjQhjxCqegWXdiMmrGBqZZ0EK451WDdV51NyQXEq0oEr3quBQ@mail.gmail.com>
Message-ID: <006101d62328$7e7f3c20$7b7db460$@frogmouth.net>

I assume you know gdal already has a parser, and that for some commercial or technical reason you need to write your own.

My test resources are at https://github.com/codice/imaging-nitf/tree/master/shared-test-resources/src/main/resources - clearly some overlap with yours. 

I'm not aware of any (public) use of RES, and there will be TREs and DES that are never public.
You might need to use gdal (or my equivalent approach) to create files for some of the newer TREs/DESs (e.g. those using gzip compression).

Brad

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Doug Gastonguay-Goddard
Sent: Wednesday, 6 May 2020 7:27 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Example NITF files with TRE

Hey, I have gotten pretty good coverage from Spacenet, WPAFB-2009, and the Geospatial Working Group test files. I am wondering if anyone has a public source for NITF files with DES, RES, or TRE. I am writing a parser and it is always nice to have an example to validate my interpretation of the spec.

There might be some in the datasets I have that I missed. I know there is a trailing header example I have not gotten to supporting yet.

Thanks,
Doug
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


From bradh at frogmouth.net  Tue May  5 16:09:15 2020
From: bradh at frogmouth.net (Brad Hards)
Date: Wed, 6 May 2020 09:09:15 +1000
Subject: [gdal-dev] Example NITF files with TRE
In-Reply-To: <CABjQhjwTVeF16sQu1_z_mhwE=5b86jUveOMmN2soJ2LJc2266Q@mail.gmail.com>
References: <CABjQhjxCqegWXdiMmrGBqZZ0EK451WDdV51NyQXEq0oEr3quBQ@mail.gmail.com>
 <006101d62328$7e7f3c20$7b7db460$@frogmouth.net>
 <CABjQhjwTVeF16sQu1_z_mhwE=5b86jUveOMmN2soJ2LJc2266Q@mail.gmail.com>
Message-ID: <016201d62332$32b9c260$982d4720$@frogmouth.net>

[Keeping on list]

The Daffodil framework may be relevant.
https://github.com/DFDLSchemas/NITF
And
http://dfdlschemas.github.io/

Brad

-----Original Message-----
From: Doug Gastonguay-Goddard <doug at riverloopsecurity.com> 
Sent: Wednesday, 6 May 2020 9:00 AM
To: Brad Hards <bradh at frogmouth.net>
Subject: Re: [gdal-dev] Example NITF files with TRE

Thanks a lot, I'll have a look through the resources. I think that's exactly what I'm looking for.

Working on a parser / mutator framework that will support a lot of different formats. Using NITF to work through some of the design. It's a lot higher level of just "can we chunk out this feature" rather than understanding how every field is going to affect rendering. Right now I'm just making sure all my structures are implemented correctly.

On 5/5/20, Brad Hards <bradh at frogmouth.net> wrote:
> I assume you know gdal already has a parser, and that for some 
> commercial or technical reason you need to write your own.
>
> My test resources are at
> https://github.com/codice/imaging-nitf/tree/master/shared-test-resourc
> es/src/main/resources
> - clearly some overlap with yours.
>
> I'm not aware of any (public) use of RES, and there will be TREs and 
> DES that are never public.
> You might need to use gdal (or my equivalent approach) to create files 
> for some of the newer TREs/DESs (e.g. those using gzip compression).
>
> Brad
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Doug 
> Gastonguay-Goddard
> Sent: Wednesday, 6 May 2020 7:27 AM
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Example NITF files with TRE
>
> Hey, I have gotten pretty good coverage from Spacenet, WPAFB-2009, and 
> the Geospatial Working Group test files. I am wondering if anyone has 
> a public source for NITF files with DES, RES, or TRE. I am writing a 
> parser and it is always nice to have an example to validate my interpretation of the spec.
>
> There might be some in the datasets I have that I missed. I know there 
> is a trailing header example I have not gotten to supporting yet.
>
> Thanks,
> Doug
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>


From hallo at frankbroniewski.com  Wed May  6 07:27:24 2020
From: hallo at frankbroniewski.com (Frank Broniewski)
Date: Wed, 6 May 2020 16:27:24 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
Message-ID: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>

Hi everybody,

I've written a small plugin for QGIS in which I am using OGR to 
transform GeoJSON from a Web API into a national CRS.
It used to work fine, but the changes introduced to axis ordering with 
the latest versions of GDAL introduced errors in my code. Things aren't 
anymore where they are supposed to be :-)


The GeoJSON I receive is in LON/LAT coordinate ordering:
"coordinates": [6.1409004235, 49.6127108119]

The projected coordinates in LUREF/EPSG:2169 are:
"coordinates": [ 78032.625859561609104, 75343.040142811907572 ]


An here is what I have tried so far:
# correctly transformed geometry X/Y (LUREF epsg:2169)
# used to perform the test
target_geom = ogr.CreateGeometryFromJson('{ "type": "Point", 
"coordinates": [ 78032.625859561609104, 75343.040142811907572 ] }')

# source geometry with LON/LAT coordinates
ogr_geom = ogr.CreateGeometryFromJson('{"coordinates": [6.1409004235, 
49.6127108119], "type": "Point"}')

source_srs = osr.SpatialReference()
source_srs.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER)
source_srs.ImportFromEPSG(4326)

target_srs = osr.SpatialReference()
target_srs.ImportFromEPSG(2169)

transformation = osr.CoordinateTransformation(source_srs, target_srs)
ogr_geom.Transform(transformation)

# test if equal /w unittest
self.assertEqual(target_geom.ExportToWkt(), ogr_geom.ExportToWkt())


So basically I imported the GeoJSON, created a transformation and 
applied it to the input geometry. The last line is just a test, the 
output from the test is as followed:

- POINT (78032.6258595616 75343.0401428119)
+ POINT (75343.0401428119 78032.6258595616)

As you can see the transformed geometry still has the coordinate order 
mixed up, but the numbers are already right with 
OAMS_TRADITIONAL_GIS_ORDER. I have searched quite a bit, stumbled over 
https://gdal.org/tutorials/osr_api_tut.html but I am out of wits here now.

I mean, I can easily swap the input coordinates to match LAT/LON, but 
this seems rather hacky. There must be a way to achieve this with OGR, 
right? So any help here is greatly appreciated!

Greetings,
Frank

From even.rouault at spatialys.com  Wed May  6 07:47:05 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 May 2020 16:47:05 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
Message-ID: <1633687.RO7bipXc2j@even-i700>

On mercredi 6 mai 2020 16:27:24 CEST Frank Broniewski wrote:
> Hi everybody,
> 
> I've written a small plugin for QGIS in which I am using OGR to
> transform GeoJSON from a Web API into a national CRS.
> It used to work fine, but the changes introduced to axis ordering with
> the latest versions of GDAL introduced errors in my code. Things aren't
> anymore where they are supposed to be :-)
> 
> 
> The GeoJSON I receive is in LON/LAT coordinate ordering:
> "coordinates": [6.1409004235, 49.6127108119]
> 
> The projected coordinates in LUREF/EPSG:2169 are:
> "coordinates": [ 78032.625859561609104, 75343.040142811907572 ]
> 
> 
> An here is what I have tried so far:
> # correctly transformed geometry X/Y (LUREF epsg:2169)
> # used to perform the test
> target_geom = ogr.CreateGeometryFromJson('{ "type": "Point",
> "coordinates": [ 78032.625859561609104, 75343.040142811907572 ] }')
> 
> # source geometry with LON/LAT coordinates
> ogr_geom = ogr.CreateGeometryFromJson('{"coordinates": [6.1409004235,
> 49.6127108119], "type": "Point"}')
> 
> source_srs = osr.SpatialReference()
> source_srs.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER)
> source_srs.ImportFromEPSG(4326)
> 
> target_srs = osr.SpatialReference()
> target_srs.ImportFromEPSG(2169)
> 
> transformation = osr.CoordinateTransformation(source_srs, target_srs)
> ogr_geom.Transform(transformation)
> 
> # test if equal /w unittest
> self.assertEqual(target_geom.ExportToWkt(), ogr_geom.ExportToWkt())
> 
> 
> So basically I imported the GeoJSON, created a transformation and
> applied it to the input geometry. The last line is just a test, the
> output from the test is as followed:
> 
> - POINT (78032.6258595616 75343.0401428119)
> + POINT (75343.0401428119 78032.6258595616)
> 
> As you can see the transformed geometry still has the coordinate order
> mixed up, but the numbers are already right with
> OAMS_TRADITIONAL_GIS_ORDER. I have searched quite a bit, stumbled over
> https://gdal.org/tutorials/osr_api_tut.html but I am out of wits here now.

Well, you are quite close to the solution by having spotted the existence of 
OAMS_TRADITIONAL_GIS_ORDER. The next step is that you look at the axis order reported 
by "gdalsrsinfo EPSG:2169", and you should figure out the solution :-)


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200506/0d467149/attachment-0001.html>

From cdelancy at blackfangtechnologies.com  Wed May  6 11:17:34 2020
From: cdelancy at blackfangtechnologies.com (Craig Delancy)
Date: Wed, 6 May 2020 18:17:34 +0000
Subject: [gdal-dev] Having trouble building latest GDAL from source
Message-ID: <DM6PR17MB38847F576B86F84A091EB390C7A40@DM6PR17MB3884.namprd17.prod.outlook.com>

Windows 10, 64-bit

I'm having a bit of trouble building GDAL from source.
It seems like it has a problem linking to PROJ, which build without issue for me.
Is anyone here familiar with this specific error?

1>   Creating library gdal_i.lib and object gdal_i.exp
1>proj.lib(filemanager.obj) : error LNK2019: unresolved external symbol __imp_SHGetFolderPathW referenced in function proj_context_get_user_writable_directory

Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200506/6668234f/attachment.html>

From even.rouault at spatialys.com  Wed May  6 11:37:28 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 06 May 2020 20:37:28 +0200
Subject: [gdal-dev] Having trouble building latest GDAL from source
In-Reply-To: <DM6PR17MB38847F576B86F84A091EB390C7A40@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB38847F576B86F84A091EB390C7A40@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <2814591.kS48QczDt7@even-i700>

On mercredi 6 mai 2020 18:17:34 CEST Craig Delancy wrote:
> Windows 10, 64-bit
> 
> I'm having a bit of trouble building GDAL from source.
> It seems like it has a problem linking to PROJ, which build without issue
> for me. Is anyone here familiar with this specific error?
> 
> 1>   Creating library gdal_i.lib and object gdal_i.exp
> 1>proj.lib(filemanager.obj) : error LNK2019: unresolved external symbol
> __imp_SHGetFolderPathW referenced in function
> proj_context_get_user_writable_directory

Is it a static build of PROJ ? Which PROJ version ?

According to
https://docs.microsoft.com/en-us/windows/win32/api/shlobj_core/nf-shlobj_core-shgetfolderpathw
SHGetFolderPathW() is defined in Shell32.lib,
so perhaps adding shell32.lib to the nmake.opt's PROJ_LIBRARY variable will help. I'm a bit 
puzzled why that wouldn't trigger in PROJ AppVeyor static builds though. I see in
https://ci.appveyor.com/api/buildjobs/xtgh93qbh7u96l5x/log that they have shell32.lib in 
linking lines. But perhaps that one comes from one of the dependent library like curl. Are you 
doing a non-curl enabled PROJ build ? But in that case, the linking of PROJ binaries would 
likely fail too. Hum...


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200506/98720e30/attachment.html>

From peter.hubner at ndpgroup.com  Wed May  6 11:39:31 2020
From: peter.hubner at ndpgroup.com (Peter Hubner)
Date: Wed, 6 May 2020 12:39:31 -0600
Subject: [gdal-dev] Intro
Message-ID: <CAJe5r0F_J2gXQROnOyfBmWNk6h9GVQ8_z=-cLErein=12D_CVg@mail.gmail.com>

Hi all,
I just wanted to introduce myself and the team I work with. I am a
software engineer at NDP in Boulder CO working on a variety of projects
which utilize a lot of the capabilities inside of GDAL. The lab which we
support is the Boulder TAP Lab (https://www.boulderlab.org/)

On many of the projects we support, there has been a need to create a gdal
driver / format to natively ingest a specification of the hdf5 format.
Since this data type is used by mainy vendors, we thought the best approach
would be to contribute the code back to the community. This would serve a
couple of goals. 1. To supply an easy way for future vendors to access this
driver. 2. Provide code back to a community that has already provided
(indirectly) so much to our projects.

The format which we would like to include is called HDF5-R. (The R stands
for raster) The detailed documentation/spec for the HDF5-R schema is
available with sample data to registered users at boulderlab.org. Ihave
provided an initial pull request located here
https://github.com/OSGeo/gdal/pull/2481. The code we are submitting for
incorporation has been validated with data from the Lab.

As for maintenance, the Lab in which this code is used will be providing
updates, if needed to support future projects and initiatives.

I hope that this can be an added benefit to an already awesome code base
and look forward to helping out where we can.

Thanks,
-- 
*Peter Hubner*

*NDP*
1909 26th Street, Suite 1E
Boulder, Colorado 80302
Office: 720.897.7332
Fax: 303-325-5136
peter.hubner at ndpgroup.com
www.ndpgroup.com

-- 
Confidential, proprietary, and/or 
privileged information may be contained 
in, and attached to, this 
message.  The information transmitted is 
intended only for the 
individual or entity to which it is addressed.  Any 
review, 
retransmission, dissemination or other use of, or taking of any 
action 
in reliance upon this information in this transmission by persons 
or 
entities other than the intended recipient(s) is prohibited. If you 

received this transmission in error, please immediately contact the 
sender 
and delete the material from all computers.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200506/dd96a0de/attachment.html>

From RejectKid at gmail.com  Wed May  6 13:42:56 2020
From: RejectKid at gmail.com (RejectKid)
Date: Wed, 6 May 2020 13:42:56 -0700 (MST)
Subject: [gdal-dev] New to Gdal and NITF
Message-ID: <1588797776141-0.post@n6.nabble.com>

Hello I am very new to the C# GDAL nuget and am trying to find an example of
the creation of a NITF image.  Are there any examples of that?

For example if i have a png and i want to create a nitf from that and add
geolocation to that nitf how would i do that with this GDAL nuget?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jgr at osgeopt.pt  Wed May  6 15:56:29 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Wed, 6 May 2020 23:56:29 +0100
Subject: [gdal-dev] Help building GDAL with ODA for the first time
Message-ID: <d509c581-ca31-e67e-ab19-d8c51eab4fcd@osgeopt.pt>

Hi,

I would like to compile GDAL with DWGv8 support in Ubuntu.

I already have an ODA account and I've downloaded the Kernel and
Drawings SDK (and an activation header):
Kernel_lnxX64_5.3dll_21.3
Drawings_lnxX64_5.3dll_21.3

I'm trying to compile GDAL with:
CPPFLAGS='-I/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/KernelBase/Include
-I/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/Kernel/Include
-I/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/Drawing/Include
-I/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/Kernel/Extensions/ExServices
-I/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/Drawing/Extensions/ExServices
-I/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/ThirdParty/activation
-I/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/Dgn/include
-I/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/Dgn/Extensions/ExServices'
LDFLAGS='-L/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/bin/lnxX64_5.3dll/'
./configure --without-libtool  --with-python=python3
--with-proj=/usr/local --with-pg=yes --with-poppler
--with-teigha=/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3
--with-teigha-plt=lnxX64_5.3dll

The two ODA related settings are:
--with-teigha=/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3
--with-teigha-plt=lnxX64_5.3dll

I got a small error about missing libTD_ExamplesCommon.a.
I did this workaround:
ln -s
`pwd`/Kernel_lnxX64_5.3dll_21.3/lib/lnxX64_5.3dll/libTD_ExamplesCommon.a
`pwd`/Drawings_lnxX64_5.3dll_21.3/lib/lnxX64_5.3dll/libTD_ExamplesCommon.a

Then I get many, many link errors, like:
/usr/bin/ld: /home/jgr/dev/gdal/gdal/libgdal.so: undefined reference to
`typeinfo for ExHostAppServices'
/usr/bin/ld:
/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/bin/lnxX64_5.3dll/TG_Db.tx:
undefined reference to `non-virtual thunk to
OdGiWorldDrawImpl::setTransparency(OdCmTransparency const&)'
/usr/bin/ld:
/home/jgr/dev/gdal/ODA/Kernel_lnxX64_5.3dll_21.3/bin/lnxX64_5.3dll//libTD_Root.so:
undefined reference to `oda_X509_get_serialNumber at liblibcrypto.so'
/usr/bin/ld:
/home/jgr/dev/gdal/ODA/Drawings_lnxX64_5.3dll_21.3/bin/lnxX64_5.3dll/TG_Db.tx:
undefined reference to `OdGiBaseVectorizer::worldLine(OdGePoint3d const*)'

I never built GDAL with ODA/Teigha before and I'm not able to move forward.

Regards,

Jorge Gustavo

From projjo9002 at gmail.com  Wed May  6 22:26:50 2020
From: projjo9002 at gmail.com (Projjolita Mahanta)
Date: Thu, 7 May 2020 10:56:50 +0530
Subject: [gdal-dev] Multiple gdal task
Message-ID: <CAAqurve_X=diyA8rnVg8KeOA6EvGOm1GrbEGDXD93fdjrhACng@mail.gmail.com>

Hi all,

I am new to gdal and was trying to save a grib image to tiff using the
below cmd line

gdal_translate f024.grb f024.tiff -of Gtiff

It worked perfectly for a single image but I have multiple images.

So is there something which we can use for this?


Regards,
Projjolita
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/67449d99/attachment.html>

From bradh at frogmouth.net  Wed May  6 22:35:07 2020
From: bradh at frogmouth.net (Brad Hards)
Date: Thu, 7 May 2020 15:35:07 +1000
Subject: [gdal-dev] New to Gdal and NITF
In-Reply-To: <1588797776141-0.post@n6.nabble.com>
References: <1588797776141-0.post@n6.nabble.com>
Message-ID: <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>

I doubt there is a NITF specific example, but it'll mostly look like other format transforms.
What have you looked at already?
What have you tried?
What did you expect to happen?
What happened instead?
What debugging have you already tried?

Brad

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of RejectKid
Sent: Thursday, 7 May 2020 6:43 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] New to Gdal and NITF

Hello I am very new to the C# GDAL nuget and am trying to find an example of the creation of a NITF image.  Are there any examples of that?

For example if i have a png and i want to create a nitf from that and add geolocation to that nitf how would i do that with this GDAL nuget?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


From hallo at frankbroniewski.com  Thu May  7 02:52:31 2020
From: hallo at frankbroniewski.com (Frank Broniewski)
Date: Thu, 7 May 2020 11:52:31 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <1633687.RO7bipXc2j@even-i700>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
 <1633687.RO7bipXc2j@even-i700>
Message-ID: <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>

Hi Even,

thank you very much for the hint. Although after researching on it I 
fell into a rabbit hole and just barely got out, but with a decent 
headache ;-)
Why do these coordinate systems and their axes have to be so 
complicated, they make my head hurt ... :-)

For future readers on the topic of coordinate systems, axes and the 
order of things, there is a nice Wiki article on the OSGeo website, 
aptly named Axis Order Confusion [1] where you can read about the stuff, 
follow the links and get a headache too :-)

Onwards to the solution of my problem, which I want to share of course. 
Even's hint suggested to look at the axis ordering of the LUREF CRS, 
which is "northing (X)" and then "easting (Y)". Reading [2] more 
carefully might have given me already a hint about what to do, since the 
page says:

"Starting with GDAL 3.0, the axis order mandated by the authority 
defining a CRS is by default honoured by the OGRCoordinateTransformation 
class, and always exported in WKT1"

which should have lead me to the conclusion that EPSG:2169 also has the 
axes swapped. And if my memory would have served me better, I once knew 
this fact as well.

Well, apparently all I needed to to was to tell my target 
SpatialReference to honour OAMS_TRADITIONAL_GIS_ORDER as well:
 
target_srs.SetAxisMappingStrategy(OAMS_TRADITIONAL_GIS_ORDER)

is all that was needed ...

But after reading all this stuff, I wonder if it would not have been 
better/more right to "correct" the GeoJSON coordinate order from Lon/Lat 
to Lat/Lon so that it matches the definition of EPSG:4326? I will have 
to think about how to deal with geo data and the treatment of CRS in 
future projects. Simply setting SetAxisMappingStrategy where it may fit 
does not seem to be a very thought-out and future proof process in the end.


PS
is the API documentation for Python up to date? The SpatialReference 
docs [3] are missing the SetAxisMappingStrategy method

[1] https://wiki.osgeo.org/wiki/Axis_Order_Confusion
[2] https://gdal.org/tutorials/osr_api_tut.html
[3] https://gdal.org/python/osgeo.osr.SpatialReference-class.html

From jukka.rahkonen at maanmittauslaitos.fi  Thu May  7 03:28:15 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 7 May 2020 03:28:15 -0700 (MST)
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
 <1633687.RO7bipXc2j@even-i700>
 <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
Message-ID: <1588847295554-0.post@n6.nabble.com>

Hi,

I fear that such a change in GeoJSON would not really correct anything but
rather move the confusion into another place. 

-Jukka Rahkonen-


Frank Broniewski-6 wrote
> But after reading all this stuff, I wonder if it would not have been 
> better/more right to "correct" the GeoJSON coordinate order from Lon/Lat 
> to Lat/Lon so that it matches the definition of EPSG:4326? I will have 
> to think about how to deal with geo data and the treatment of CRS in 
> future projects. Simply setting SetAxisMappingStrategy where it may fit 
> does not seem to be a very thought-out and future proof process in the
> end.





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu May  7 03:47:51 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 12:47:51 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <1588847295554-0.post@n6.nabble.com>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
 <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
 <1588847295554-0.post@n6.nabble.com>
Message-ID: <1717504.AZUOZXdW0P@even-i700>

On jeudi 7 mai 2020 03:28:15 CEST jratike80 wrote:
> Hi,
> 
> I fear that such a change in GeoJSON would not really correct anything but
> rather move the confusion into another place.

Yeah, especially since GeoJSON rather claims using OGC:1.3:CRS84 which is long, lat. But for 
interoperability with EPSG, the OGR GeoJSON driver reports EPSG:4326, with 
OAMS_TRADITIONAL_GIS_ORDER, and thus longitude, latitude coordinate order, as it has 
done forever.

When you want to reproject a geometry coming from a OGR driver, you can just use the SRS 
object of the layer or the geometry as the source CRS for the CoordinateTransformation 
object that will have the axis mapping consistent with the order of the geometry 
coordinates. No need to tweek axis mapping for the source.
For the target CRS, it is up to you to decide if you want to be authority compliant or in the 
GIS-friendly camp :-)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/610be8fc/attachment.html>

From even.rouault at spatialys.com  Thu May  7 03:48:42 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 12:48:42 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
 <1633687.RO7bipXc2j@even-i700>
 <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
Message-ID: <3059393.VPJrIDe8NU@even-i700>

> PS
> is the API documentation for Python up to date? The 
SpatialReference
> docs [3] are missing the SetAxisMappingStrategy method

Thanks for pointing that. There was indeed an issue with the refresh 
of the Python API. This is now mentionned


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/b40991f0/attachment-0001.html>

From even.rouault at spatialys.com  Thu May  7 06:01:24 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 15:01:24 +0200
Subject: [gdal-dev] Motion: promote GDAL 3.1.0 RC3
In-Reply-To: <226980322.neGjxTAKcH@even-i700>
References: <226980322.neGjxTAKcH@even-i700>
Message-ID: <1993646.ojSvHK538p@even-i700>

On mardi 5 mai 2020 11:39:35 CEST Even Rouault wrote:
> Hi,
> 
> Motion: promote GDAL 3.1.0 RC3 to final 3.1.0
> 

I declare this motion passed with +1 from PSC members HowardB, MateuszL, 
JukkaR, DanielM and myself

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/8937b00c/attachment.html>

From RejectKid at gmail.com  Thu May  7 06:47:20 2020
From: RejectKid at gmail.com (RejectKid)
Date: Thu, 7 May 2020 06:47:20 -0700 (MST)
Subject: [gdal-dev] New to Gdal and NITF
In-Reply-To: <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>
References: <1588797776141-0.post@n6.nabble.com>
 <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>
Message-ID: <1588859240907-0.post@n6.nabble.com>

It's hard to say what ive tried as I don't even know where to start really. 
I was expecting something like "new Nitf()" or "Nitf.Create()" style api and
I'm not seeing those.  

I'm guessing I'm supposed to do something with the Gdal.Open() method but I
dont know what I'd actually pass in there.  is the utf8_path a file path?
and what file formats does that read in? or is there a way to read in bytes
of an image? 

as you can tell im kinda lost on how to even start reading anything in using
the GDAL nuget.  so any help/getting started would be great



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From junt0015 at umn.edu  Thu May  7 07:12:27 2020
From: junt0015 at umn.edu (Thomas Juntunen)
Date: Thu, 7 May 2020 09:12:27 -0500
Subject: [gdal-dev] New to Gdal and NITF
In-Reply-To: <1588859240907-0.post@n6.nabble.com>
References: <1588797776141-0.post@n6.nabble.com>
 <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>
 <1588859240907-0.post@n6.nabble.com>
Message-ID: <CAF028HUtFANBV+f-QJ8Lyqyx37bTHXQ-ELKg4Du-hqLisnEx6A@mail.gmail.com>

NITF is a format designed to wrap various metadata sets into a package with
some number of raster layers. It isn't necessarily straightforward to
build. I suggest you have a look at the specifications:
https://gwg.nga.mil/ntb/baseline/documents.html

There's also a Wikipedia article that provides a decent summary:
https://en.wikipedia.org/wiki/National_Imagery_Transmission_Format

I don't use C# but there's an example in the GDAL/OGR Python cookbook that
worked for me (I used the NITF driver instead of the GTiff):
https://pcjericks.github.io/py-gdalogr-cookbook/raster_layers.html?highlight=rasterize#create-raster-from-array

Good luck,
Thomas

On Thu, May 7, 2020 at 8:47 AM RejectKid <RejectKid at gmail.com> wrote:

> It's hard to say what ive tried as I don't even know where to start
> really.
> I was expecting something like "new Nitf()" or "Nitf.Create()" style api
> and
> I'm not seeing those.
>
> I'm guessing I'm supposed to do something with the Gdal.Open() method but I
> dont know what I'd actually pass in there.  is the utf8_path a file path?
> and what file formats does that read in? or is there a way to read in bytes
> of an image?
>
> as you can tell im kinda lost on how to even start reading anything in
> using
> the GDAL nuget.  so any help/getting started would be great
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
*The right coordinate system can turn an impossible problem into two really
hard problems. -- Charlie Pellerin*

Thomas Juntunen
GIS Specialist
Polar Geospatial Center
R280 Learning and Environmental Science
1954 Buford Ave
University of Minnesota
St. Paul, MN 55108
612-626-0505
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/867dc0d5/attachment.html>

From even.rouault at spatialys.com  Thu May  7 07:20:48 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 16:20:48 +0200
Subject: [gdal-dev] GDAL 3.1.0 is released
Message-ID: <2780899.pn867nL82Z@even-i700>

Hi,

On behalf of the GDAL/OGR development team and community, I am pleased to announce 
the release of GDAL/OGR 3.1.0.  GDAL/OGR is a C++ geospatial data access library for raster 
and vector file formats, databases and web services.  It includes bindings for several 
languages, and a variety of command line tools.

   http://www.gdal.org/

The 3.1.0 release is a new feature release with the following highlights:

 * Implement [RFC 75]
(https://gdal.org/development/rfc/rfc75_multidimensional_arrays.html):
  support for multidimensional arrays in MEM, VRT, netCDF, HDF4, HDF5 and GRIB drivers. 
Read/write for MEM and netCDF. Read/only for others. Add gdalmdiminfo and 
gdalmdimtranslate utilities.
 * Implement [RFC 76]
(https://gdal.org/development/rfc/rfc76_ogrpythondrivers.html):
  add capability of writing vector drivers in Python
 * New GDAL drivers:
   - [COG](https://gdal.org/drivers/raster/cog.html): write-only, for Cloud Optimized GeoTIFF
   - [EXR](https://gdal.org/drivers/raster/exr.html): read/write driver, relying on OpenEXR 
library
   - [ISG](https://gdal.org/drivers/raster/isg.html): read-only, for geoid models of the 
International Service for the Geoid
   - [RDB](https://gdal.org/drivers/raster/rdb.html): read-only, for RIEGL Database .mpx RDB 2 
files (#1538) (needs proprietary SDK)
 * New OGR drivers:
   - [FlatGeoBuf](https://gdal.org/drivers/vector/flatgeobuf.html): read-support and creation 
(#1742)
   - [MapML](https://gdal.org/drivers/vector/mapml.html): read/write driver for experimental 
web spec
 * Improved drivers:
  - OAPIF driver (renamed from WFS3): updated to OGC API - Features 1.0 core spec
  - GTiff: improve performance of internal overview creation
  - GTiff: GeoTIFF 1.1 support
  - Shapefile driver: add read/creation/update support for .shz and .shp.zip
  - netCDF vector: read/write support for CF-1.8 Encoded Geometries (#1287)
  - VICAR: multiple improvements and write support (#1855)
  - DDS: add read support
 * Other improvements:
   - gdalwarp: accept output drivers with only CreateCopy() capabilities
   - [gdal_viewshed](https://gdal.org/programs/gdal_viewshed.html):
     new utility for viewshed algorithm
 * Remove GFT driver now that the online service no longer exists (#2050)
 * New Sphinx-based documentation
 * Multiple security related fixes (ossfuzz)
 * Continued code linting (cppcheck, CoverityScan, etc.)

More complete information on the new features and fixes in the 3.1.0
release can be found at:

  https://github.com/OSGeo/gdal/blob/v3.1.0/gdal/NEWS

The release can be downloaded from:
  * https://download.osgeo.org/gdal/3.1.0/gdal310.zip - source as a zip
  * https://download.osgeo.org/gdal/3.1.0/gdal-3.1.0.tar.gz - source as .tar.gz
  * https://download.osgeo.org/gdal/3.1.0/gdal-3.1.0.tar.xz - source as .tar.xz
  * https://download.osgeo.org/gdal/3.1.0/gdal-grass-3.1.0.tar.gz - GDAL-GRASS 
plugin
  * https://download.osgeo.org/gdal/3.1.0/gdalautotest-3.1.0.tar.gz - test 
suite
  * https://download.osgeo.org/gdal/3.1.0/gdal310doc.zip - documentation / 
website

The migration guide can be found at  :
      https://github.com/OSGeo/gdal/blob/release/3.1/gdal/MIGRATION_GUIDE.TXT

Best regards,

Even


Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/576ae7c1/attachment-0001.html>

From vincent.sarago at gmail.com  Thu May  7 07:35:42 2020
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 7 May 2020 10:35:42 -0400
Subject: [gdal-dev] GDAL versions Vs PROJ versions
Message-ID: <08724213-6AB1-44D4-BFE7-2522507B5897@gmail.com>

Dear GDAL devs,

Maybe this is a totally dumb question and there might be already a doc somewhere (which I couldn’t find), but what are the min (and or max?) PROJ version for let say gdal2.4 / gdal3.0 / gdal3.1 ? 

Regards,

Vincent

From vincent.sarago at gmail.com  Thu May  7 07:49:35 2020
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 7 May 2020 10:49:35 -0400
Subject: [gdal-dev] GDAL versions Vs PROJ versions
In-Reply-To: <rmi5zd7hkqh.fsf@s1.lexort.com>
References: <08724213-6AB1-44D4-BFE7-2522507B5897@gmail.com>
 <rmi5zd7hkqh.fsf@s1.lexort.com>
Message-ID: <EDFF56C6-D135-48B1-A923-38385CDB1EC3@gmail.com>

Thanks for your response Greg, 

I can’t see anything on https://github.com/OSGeo/gdal/blob/master/README.md <https://github.com/OSGeo/gdal/blob/master/README.md> about PROJ versions.

In the NEWS there are some info yes:
- https://github.com/OSGeo/gdal/blob/master/gdal/NEWS#L755 <https://github.com/OSGeo/gdal/blob/master/gdal/NEWS#L755> (so GDAL 3.0 needs PROJ >=6
- https://github.com/OSGeo/gdal/blob/master/gdal/NEWS#L1758 <https://github.com/OSGeo/gdal/blob/master/gdal/NEWS#L1758> (GDAL 2.3 support PROJ 5.0 and 4.0)  

My second question is then should we make the docs a bit more clear ?

Regards,

Vincent

> Le 7 mai 2020 à 10:40, Greg Troxel <gdt at lexort.com> a écrit :
> 
> Vincent Sarago <vincent.sarago at gmail.com> writes:
> 
>> Maybe this is a totally dumb question and there might be already a doc
>> somewhere (which I couldn’t find), but what are the min (and or max?)
>> PROJ version for let say gdal2.4 / gdal3.0 / gdal3.1 ?
> 
> Did you read NEWS and README?   README should say, and NEWS should
> describe changes.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/b85b1f9a/attachment.html>

From even.rouault at spatialys.com  Thu May  7 08:05:48 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 17:05:48 +0200
Subject: [gdal-dev] GDAL versions Vs PROJ versions
In-Reply-To: <EDFF56C6-D135-48B1-A923-38385CDB1EC3@gmail.com>
References: <08724213-6AB1-44D4-BFE7-2522507B5897@gmail.com>
 <rmi5zd7hkqh.fsf@s1.lexort.com>
 <EDFF56C6-D135-48B1-A923-38385CDB1EC3@gmail.com>
Message-ID: <1816501.kp2eajgDhZ@even-i700>

Vincent,

> My second question is then should we make the docs a bit more clear ?

Help to improve them is always welcome (hint hint!) but listing all min/max versions of 
dependencies of GDAL could be close to a full time job since you'd have to actually test 
building and at runtime...

Regarding PROJ specifically, GDAL 2.x is (was!) better used with PROJ 5.2 (in particular for 
consistency of the EPSG dictionaries between GDAL and PROJ), but could probably also 
work with later PROJ versions, although that is not tested by CI

The requirements for 3.1.0 are the same as 3.0 : PROJ >= 6. I'd strongly advise using either 
6.3.2 or 7.0.1 for best experience

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/f7784a42/attachment.html>

From vincent.sarago at gmail.com  Thu May  7 08:12:30 2020
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Thu, 7 May 2020 11:12:30 -0400
Subject: [gdal-dev] GDAL versions Vs PROJ versions
In-Reply-To: <1816501.kp2eajgDhZ@even-i700>
References: <08724213-6AB1-44D4-BFE7-2522507B5897@gmail.com>
 <rmi5zd7hkqh.fsf@s1.lexort.com>
 <EDFF56C6-D135-48B1-A923-38385CDB1EC3@gmail.com>
 <1816501.kp2eajgDhZ@even-i700>
Message-ID: <9F29B9BC-5C4B-4693-8F9D-233DCF04D353@gmail.com>

> Help to improve them is always welcome (hint hint!)

:-) I’ll see what I can do. I know that if we start adding PROJ version docs people may also ask for GEOS and more other libs.

> I'd strongly advise using either 6.3.2 or 7.0.1 for best experience

Thanks Even this is really helpful, I was also wondering if PROJ 7 was supported by gdal >= 3 so I got my answer 



> Le 7 mai 2020 à 11:05, Even Rouault <even.rouault at spatialys.com> a écrit :
> 
> Vincent,
>  
> > My second question is then should we make the docs a bit more clear ?
>  
> Help to improve them is always welcome (hint hint!) but listing all min/max versions of dependencies of GDAL could be close to a full time job since you'd have to actually test building and at runtime...
>  
> Regarding PROJ specifically, GDAL 2.x is (was!) better used with PROJ 5.2 (in particular for consistency of the EPSG dictionaries between GDAL and PROJ), but could probably also work with later PROJ versions, although that is not tested by CI
>  
> The requirements for 3.1.0 are the same as 3.0 : PROJ >= 6. I'd strongly advise using either 6.3.2 or 7.0.1 for best experience
>  
> Even
>  
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com <http://www.spatialys.com/>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/5458a633/attachment.html>

From even.rouault at spatialys.com  Thu May  7 08:23:42 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 17:23:42 +0200
Subject: [gdal-dev] GDAL versions Vs PROJ versions
In-Reply-To: <9F29B9BC-5C4B-4693-8F9D-233DCF04D353@gmail.com>
References: <08724213-6AB1-44D4-BFE7-2522507B5897@gmail.com>
 <1816501.kp2eajgDhZ@even-i700>
 <9F29B9BC-5C4B-4693-8F9D-233DCF04D353@gmail.com>
Message-ID: <6022957.bj9Mm6TyXV@even-i700>

On jeudi 7 mai 2020 11:12:30 CEST Vincent Sarago wrote:
> > Help to improve them is always welcome (hint hint!)
> :
> :-) I’ll see what I can do. I know that if we start adding PROJ version docs
> :people may also ask for GEOS and more other libs.:
> > I'd strongly advise using either 6.3.2 or 7.0.1 for best experience
> 
> Thanks Even this is really helpful, I was also wondering if PROJ 7 was
> supported by gdal >= 3 so I got my answer

Well, there's some overlap between the GDAL and PROJ teams, so hopefully HEAD of both 
projects work together. Actually the nightly Docker images at https://github.com/OSGeo/
gdal/tree/master/gdal/docker track both GDAL and PROJ master

And building tagged GDAL 3.1.0 images with PROJ 7.0.1 is making the fan of my computer 
busy right now :-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/ab7986dc/attachment-0001.html>

From eadam at co.lincoln.or.us  Thu May  7 09:05:43 2020
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Thu, 7 May 2020 09:05:43 -0700
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <2780899.pn867nL82Z@even-i700>
References: <2780899.pn867nL82Z@even-i700>
Message-ID: <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>

Congrats on another great release!

On Thu, May 7, 2020 at 7:20 AM Even Rouault <even.rouault at spatialys.com> wrote:
>
>
> The 3.1.0 release is a new feature release with the following highlights:
>
> - [gdal_viewshed](https://gdal.org/programs/gdal_viewshed.html):
>
> new utility for viewshed algorithm
>

On the documentation of this, it says:
[with the image with two dots] A computed visibility for two separate
-ox and -oy points on a DEM.
gdal_viewshed -md 500 -ox -10147017 -oy 5108065 source.tif destination.tif

The image with two dots makes me think that there can be multiple
observer inputs.  Is that the case?  Is the syntax for that just to
keep adding more -ox, -oy, (and oz)?  For instance, gdal_viewshed -md
500 -ox -10147017 -oy 5108065 -ox -10147117 -oy 5108165+100 source.tif
destination.tif

Best regards, Eli

From even.rouault at spatialys.com  Thu May  7 09:14:27 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 18:14:27 +0200
Subject: [gdal-dev] HDF5-R (Re:  Intro)
In-Reply-To: <CAJe5r0F_J2gXQROnOyfBmWNk6h9GVQ8_z=-cLErein=12D_CVg@mail.gmail.com>
References: <CAJe5r0F_J2gXQROnOyfBmWNk6h9GVQ8_z=-cLErein=12D_CVg@mail.gmail.com>
Message-ID: <3082755.apSYzZPiLO@even-i700>

Peter,

Thanks for reaching out.

> On many of the projects we support, there has been a need to create a gdal
> driver / format to natively ingest a specification of the hdf5 format.
> Since this data type is used by mainy vendors

HDF5 in general, or this particular formulation ?

> , we thought the best approach
> would be to contribute the code back to the community. This would serve a
> couple of goals. 1. To supply an easy way for future vendors to access this
> driver. 2. Provide code back to a community that has already provided
> (indirectly) so much to our projects.

Several questions come to mind:
- What's the reason for this specification of HDF5 ? Besides the existing generic HDF5 driver, 
there are also the specialized BAG one, and the generalist KEA one which was designed as a 
100% match for the GDAL raster data model. Not mentionning netCDF which uses HDF5 as a 
storage backend.
- Is it something only used in your lab ? Has it been reviewed by different stakeholders ?
- What use cases does it address: intended to be generic, or specific type of products?
- What is its history ?
- What is the volume of data available in this format ? Is it/will it be available as open or 
commercial datasets ?
- What is the intended audience ? General public or governemental only ?
- Did you consider extending the existing HDF5 driver ? Really an open question since it might 
be a good or bad idea depending on how the new driver is different.

I'm basically trying to have a clearer idea to which extent there would be an interest in having 
such driver in the upstream project.

> The format which we would like to include is called HDF5-R. (The R stands
> for raster)

Minor point: the existing HDF5 driver is about raster too. And if I may comment on the 
naming, I can anticipate some confusion since looking for HDF5-R in a popular search engine 
leads to a HDF5 library for the R language.

> The detailed documentation/spec for the HDF5-R schema is
> available with sample data to registered users at boulderlab.org.

Having it behind a registration step looks like an unnecessary hurdle. That stopped me from 
looking further.

> As for maintenance, the Lab in which this code is used will be providing
> updates, if needed to support future projects and initiatives.

I was also thinking to "invisible" maintenance cost for people doing an initial contribution, 
but that are well visible to people babysitting the project on a daily basis.


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/c6105196/attachment.html>

From howard at hobu.co  Thu May  7 09:41:14 2020
From: howard at hobu.co (Howard Butler)
Date: Thu, 7 May 2020 11:41:14 -0500
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
References: <2780899.pn867nL82Z@even-i700>
 <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
Message-ID: <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>



> On May 7, 2020, at 11:05 AM, Eli Adam <eadam at co.lincoln.or.us> wrote:
> 
> The image with two dots makes me think that there can be multiple
> observer inputs.  Is that the case?  Is the syntax for that just to
> keep adding more -ox, -oy, (and oz)?  For instance, gdal_viewshed -md
> 500 -ox -10147017 -oy 5108065 -ox -10147117 -oy 5108165+100 source.tif
> destination.tif

The picture is a poor example. You can't do multiple obvservers, but you can run a bunch of masks together and then merge to get a multipoint viewshed. I indeed made two masks with gdal_viewshed and then merged them together to make that picture.

That picture or the docs should maybe be updated to reflect a more common scenario with better description. File a ticket and attach some language and pictures to it as you start playing with it and we can merge it.

Thanks,

Howard

From hallo at frankbroniewski.com  Thu May  7 10:14:29 2020
From: hallo at frankbroniewski.com (Frank Broniewski)
Date: Thu, 7 May 2020 19:14:29 +0200
Subject: [gdal-dev] OGR GeoJSON transormation woes
In-Reply-To: <1588847295554-0.post@n6.nabble.com>
References: <011898db-287d-73b4-1dca-db47d2c6c8ee@frankbroniewski.com>
 <1633687.RO7bipXc2j@even-i700>
 <7fe90b1e-8c2e-1573-36ae-f7829c13d1a6@frankbroniewski.com>
 <1588847295554-0.post@n6.nabble.com>
Message-ID: <9b52fc2d-120e-b941-ec2f-c4fed01f4e13@frankbroniewski.com>

Ah, I did not make myself clear enough. My intention surely wasn't to 
change any existing standards/formats, I believe especially the GeoJSON 
coordinate thing has been already sufficiently discussed. I was 
referring to the GeoJSON data I receive in my plugin or any future project.

I was merely musing how to approach the coordinate order problem for my 
next project. Using SetAxisMappingStrategy feels more like a patch to 
the problem.

I could as well make the input coordinates follow the standard axis 
order, do my transformation with well behaved coordinates and manipulate 
the output to match what QGIS needs. Just a different approach to the 
problem ...





Am 07.05.20 um 12:28 schrieb jratike80:
> Hi,
> 
> I fear that such a change in GeoJSON would not really correct anything but
> rather move the confusion into another place.
> 
> -Jukka Rahkonen-
> 
> 
> Frank Broniewski-6 wrote
>> But after reading all this stuff, I wonder if it would not have been
>> better/more right to "correct" the GeoJSON coordinate order from Lon/Lat
>> to Lat/Lon so that it matches the definition of EPSG:4326? I will have
>> to think about how to deal with geo data and the treatment of CRS in
>> future projects. Simply setting SetAxisMappingStrategy where it may fit
>> does not seem to be a very thought-out and future proof process in the
>> end.
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

From pedrongvenancio at gmail.com  Thu May  7 10:29:02 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Thu, 7 May 2020 18:29:02 +0100
Subject: [gdal-dev] Wrong GDAL VersionInfo
Message-ID: <CAMCJChuBj06re4TcpLN0ZSM=3UceNnD1WOgapFuVxKCheV5s_Q@mail.gmail.com>

Hi all,

I'm seeing that gdal 3.2.0dev is giving a wrong gdal.VersionInfo() output:
'3000400'.

Testing several GDAL versions:


3.2.0dev
import gdal
gdal.VersionInfo()
'3000400'

3.0.2
import gdal
gdal.VersionInfo()
'3000200'

2.4.3
import gdal
gdal.VersionInfo()
'2040300'

This is happening with OSGeo4W 64bits.

Anyone confirm?

Thanks! Best regards,
Pedro Venâncio
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/37653009/attachment.html>

From even.rouault at spatialys.com  Thu May  7 10:44:17 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 19:44:17 +0200
Subject: [gdal-dev] Wrong GDAL VersionInfo
In-Reply-To: <CAMCJChuBj06re4TcpLN0ZSM=3UceNnD1WOgapFuVxKCheV5s_Q@mail.gmail.com>
References: <CAMCJChuBj06re4TcpLN0ZSM=3UceNnD1WOgapFuVxKCheV5s_Q@mail.gmail.com>
Message-ID: <2864514.cWpvo0am4r@even-i700>

On jeudi 7 mai 2020 18:29:02 CEST Pedro Venâncio wrote:
> Hi all,
> 
> I'm seeing that gdal 3.2.0dev is giving a wrong gdal.VersionInfo() output:
> '3000400'.

> Anyone confirm?

You're probably not using the Python module corresponding to master. Have you 
intalled the python3-gdal-dev package and run gdal-dev-py3-env.bat to set the 
appropriate environment ? (didn't try. no Windows VM started. Just looking at the 
content of 
https://download.osgeo.org/osgeo4w/x86_64/release/gdal/gdal-dev/python3-gdal-dev/python3-gdal-dev-3.2.0-9.tar.bz2 )


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/ae2d8e3b/attachment-0001.html>

From even.rouault at spatialys.com  Thu May  7 11:53:15 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 20:53:15 +0200
Subject: [gdal-dev] Removal of API_PROXY mechanism: objections?
Message-ID: <2072127.vqHJZ2d2Pg@even-i700>

Hi,

https://github.com/OSGeo/gdal/pull/2489 kills the API_PROXY mechanism, 
which removes 7820 lines of code. Anyone objects ?

Note: if you have no idea what this is about, then it means you never used 
that stuff since it couldn't be used just accidentally like other functionalities. 
I'm not aware of anyone having used that ever (except me when developing 
it long time ago)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/d78c0939/attachment.html>

From schwehr at gmail.com  Thu May  7 11:59:42 2020
From: schwehr at gmail.com (Kurt Schwehr)
Date: Thu, 7 May 2020 11:59:42 -0700
Subject: [gdal-dev] Removal of API_PROXY mechanism: objections?
In-Reply-To: <2072127.vqHJZ2d2Pg@even-i700>
References: <2072127.vqHJZ2d2Pg@even-i700>
Message-ID: <CACmBxytWgzjt7d7ngFeJ5B9CL29+af=6ccxG5fkUe6Ec5A4XvA@mail.gmail.com>

+1 for removing

On Thu, May 7, 2020 at 11:53 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
>
>
> https://github.com/OSGeo/gdal/pull/2489 kills the API_PROXY mechanism,
> which removes 7820 lines of code. Anyone objects ?
>
>
>
> Note: if you have no idea what this is about, then it means you never used
> that stuff since it couldn't be used just accidentally like other
> functionalities. I'm not aware of anyone having used that ever (except me
> when developing it long time ago)
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/a5c6717e/attachment.html>

From pedrongvenancio at gmail.com  Thu May  7 14:38:27 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Thu, 7 May 2020 22:38:27 +0100
Subject: [gdal-dev] Wrong GDAL VersionInfo
In-Reply-To: <2864514.cWpvo0am4r@even-i700>
References: <CAMCJChuBj06re4TcpLN0ZSM=3UceNnD1WOgapFuVxKCheV5s_Q@mail.gmail.com>
 <2864514.cWpvo0am4r@even-i700>
Message-ID: <CAMCJCht1_6AmaiMeQYJ+_FV2H6kpdudkkP8N4A+-Y_GmnuJgEQ@mail.gmail.com>

Hi Even,

You're right, I hadn't python3-gdal-dev package installed. After install it
and run gdal-dev-py3-env, version become correct in OSGeo4W Shell

gdal.VersionInfo()
'3020000'

Should not python3-gdal-dev package be installed by default with gdal-dev?

However, I was trying it inside QGIS, in Python console, and there the
output is still '3000400', both in qgis-rel-dev (3.12.2) and qgis-dev
(3.13.0-master), compiled against GDAL 3.2.0dev.

I tried to change in qgis-rel-dev-g7.bat

call gdal-dev-env.bat
to
call gdal-dev-py3-env.bat

but without success. It seems that something more needs to be changed.

Do you think I should open a ticket in QGIS or OSGeo4W tracker?

Thanks again!

Best regards,
Pedro


Even Rouault <even.rouault at spatialys.com> escreveu no dia quinta, 7/05/2020
à(s) 18:44:

> On jeudi 7 mai 2020 18:29:02 CEST Pedro Venâncio wrote:
>
> > Hi all,
>
> >
>
> > I'm seeing that gdal 3.2.0dev is giving a wrong gdal.VersionInfo()
> output:
>
> > '3000400'.
>
>
>
> > Anyone confirm?
>
>
>
> You're probably not using the Python module corresponding to master. Have
> you intalled the python3-gdal-dev package and run gdal-dev-py3-env.bat to
> set the appropriate environment ? (didn't try. no Windows VM started. Just
> looking at the content of
>
>
> https://download.osgeo.org/osgeo4w/x86_64/release/gdal/gdal-dev/python3-gdal-dev/python3-gdal-dev-3.2.0-9.tar.bz2
> )
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/6e681fe7/attachment.html>

From even.rouault at spatialys.com  Thu May  7 14:45:20 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 07 May 2020 23:45:20 +0200
Subject: [gdal-dev] Wrong GDAL VersionInfo
In-Reply-To: <CAMCJCht1_6AmaiMeQYJ+_FV2H6kpdudkkP8N4A+-Y_GmnuJgEQ@mail.gmail.com>
References: <CAMCJChuBj06re4TcpLN0ZSM=3UceNnD1WOgapFuVxKCheV5s_Q@mail.gmail.com>
 <2864514.cWpvo0am4r@even-i700>
 <CAMCJCht1_6AmaiMeQYJ+_FV2H6kpdudkkP8N4A+-Y_GmnuJgEQ@mail.gmail.com>
Message-ID: <2183125.eotQVKDROF@even-i700>

> Do you think I should open a ticket in QGIS or 
OSGeo4W tracker?

I'd say OSGeo4W

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200507/4f068330/attachment.html>

From pedrongvenancio at gmail.com  Thu May  7 16:03:10 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Fri, 8 May 2020 00:03:10 +0100
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>
References: <2780899.pn867nL82Z@even-i700>
 <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
 <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>
Message-ID: <CAMCJChv9QO4CWu-ENAdgqOhnQQyoy2JNCtXkuczAebOh-CXaLw@mail.gmail.com>

Hi,

I'm trying the new gdal_viewshed and it is in fact really quick! But the
result is completely different than other viewshed analysis algorithms:

https://cld.pt/dl/download/e80216bb-d7eb-40b0-b6da-8e45572e9eb3/viewshed.jpg

https://cld.pt/dl/download/ee993a0b-cf86-462a-b831-307aecde7865/viewshed2.jpg

GRASS and Visibility Analysis plugin for QGIS have almost the same result.
The result from gdal_viewshed seems completely overrated. The options I'm
using are [almost] the same in both algorithms.

gdal_viewshed -b 1 -md 28000.0 -ox -41597.922 -oy 71254.049 -oz 21.6 -tz
10.0 -vv 1 -cc 0.85714 -f GTiff path_to_mdt.tif path_to_output.tif

Has anyone else this experience?

Thanks! Best regards,
Pedro Venâncio


Howard Butler <howard at hobu.co> escreveu no dia quinta, 7/05/2020 à(s) 17:41:

>
>
> > On May 7, 2020, at 11:05 AM, Eli Adam <eadam at co.lincoln.or.us> wrote:
> >
> > The image with two dots makes me think that there can be multiple
> > observer inputs.  Is that the case?  Is the syntax for that just to
> > keep adding more -ox, -oy, (and oz)?  For instance, gdal_viewshed -md
> > 500 -ox -10147017 -oy 5108065 -ox -10147117 -oy 5108165+100 source.tif
> > destination.tif
>
> The picture is a poor example. You can't do multiple obvservers, but you
> can run a bunch of masks together and then merge to get a multipoint
> viewshed. I indeed made two masks with gdal_viewshed and then merged them
> together to make that picture.
>
> That picture or the docs should maybe be updated to reflect a more common
> scenario with better description. File a ticket and attach some language
> and pictures to it as you start playing with it and we can merge it.
>
> Thanks,
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/69470cac/attachment.html>

From eadam at co.lincoln.or.us  Thu May  7 16:39:03 2020
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Thu, 7 May 2020 16:39:03 -0700
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <CAMCJChv9QO4CWu-ENAdgqOhnQQyoy2JNCtXkuczAebOh-CXaLw@mail.gmail.com>
References: <2780899.pn867nL82Z@even-i700>
 <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
 <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>
 <CAMCJChv9QO4CWu-ENAdgqOhnQQyoy2JNCtXkuczAebOh-CXaLw@mail.gmail.com>
Message-ID: <CACqBkM-+zjjbWUdzXo9_L2_0tUFXjBzrSvj44f3Lo-crz8=NCg@mail.gmail.com>

Hi Pedro,

On Thu, May 7, 2020 at 4:03 PM Pedro Venâncio <pedrongvenancio at gmail.com> wrote:
>
> Hi,
>
> I'm trying the new gdal_viewshed and it is in fact really quick! But the result is completely different than other viewshed analysis algorithms:
>
> https://cld.pt/dl/download/e80216bb-d7eb-40b0-b6da-8e45572e9eb3/viewshed.jpg
>
> https://cld.pt/dl/download/ee993a0b-cf86-462a-b831-307aecde7865/viewshed2.jpg
>
> GRASS and Visibility Analysis plugin for QGIS have almost the same result. The result from gdal_viewshed seems completely overrated. The options I'm using are [almost] the same in both algorithms.
>
> gdal_viewshed -b 1 -md 28000.0 -ox -41597.922 -oy 71254.049 -oz 21.6 -tz 10.0 -vv 1 -cc 0.85714 -f GTiff path_to_mdt.tif path_to_output.tif
>

Does -tz 10.0 in effect raise your DEM target elevation by 10 units?
Was the same done in GRASS and the Visibility Analysis plugin for
QGIS?

Was the observer height of -oz 21.6 the same for all three as well?

Best regards, Eli

> Has anyone else this experience?
>
> Thanks! Best regards,
> Pedro Venâncio
>
>
> Howard Butler <howard at hobu.co> escreveu no dia quinta, 7/05/2020 à(s) 17:41:
>>
>>
>>
>> > On May 7, 2020, at 11:05 AM, Eli Adam <eadam at co.lincoln.or.us> wrote:
>> >
>> > The image with two dots makes me think that there can be multiple
>> > observer inputs.  Is that the case?  Is the syntax for that just to
>> > keep adding more -ox, -oy, (and oz)?  For instance, gdal_viewshed -md
>> > 500 -ox -10147017 -oy 5108065 -ox -10147117 -oy 5108165+100 source.tif
>> > destination.tif
>>
>> The picture is a poor example. You can't do multiple obvservers, but you can run a bunch of masks together and then merge to get a multipoint viewshed. I indeed made two masks with gdal_viewshed and then merged them together to make that picture.
>>
>> That picture or the docs should maybe be updated to reflect a more common scenario with better description. File a ticket and attach some language and pictures to it as you start playing with it and we can merge it.
>>
>> Thanks,
>>
>> Howard
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Eli L Adam, PLS
Lincoln County Surveyor's Office
880 NE 7th Street
Newport, OR 97365
541-574-1289

From bradh at frogmouth.net  Thu May  7 16:50:03 2020
From: bradh at frogmouth.net (Brad Hards)
Date: Fri, 8 May 2020 09:50:03 +1000
Subject: [gdal-dev] New to Gdal and NITF
In-Reply-To: <1588859240907-0.post@n6.nabble.com>
References: <1588797776141-0.post@n6.nabble.com>
 <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>
 <1588859240907-0.post@n6.nabble.com>
Message-ID: <019b01d624ca$3ab43290$b01c97b0$@frogmouth.net>

I'd suggest with the documentation. 
https://trac.osgeo.org/gdal/wiki/GdalOgrInCsharp

An example is shown at https://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALRead.cs for reading and at https://trac.osgeo.org/gdal/browser/trunk/gdal/swig/csharp/apps/GDALWrite.cs for writing out.

The C# bindings are closely tied to the underlying C/C++ implementation. You can use the documentation for the equivalent methods.

Even in C/C++, you'll need to do quite a lot of reading of STDI-0002 if you need anything but the most basic TREs.

If your needs are simple, maybe you'd be better off calling out to a command line utility instead. Then you can decouple the conversion from your C# code.

Brad
-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of RejectKid
Sent: Thursday, 7 May 2020 11:47 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] New to Gdal and NITF

It's hard to say what ive tried as I don't even know where to start really. 
I was expecting something like "new Nitf()" or "Nitf.Create()" style api and I'm not seeing those.  

I'm guessing I'm supposed to do something with the Gdal.Open() method but I dont know what I'd actually pass in there.  is the utf8_path a file path?
and what file formats does that read in? or is there a way to read in bytes of an image? 

as you can tell im kinda lost on how to even start reading anything in using the GDAL nuget.  so any help/getting started would be great



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev


From pedrongvenancio at gmail.com  Thu May  7 16:52:29 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Fri, 8 May 2020 00:52:29 +0100
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <CACqBkM-+zjjbWUdzXo9_L2_0tUFXjBzrSvj44f3Lo-crz8=NCg@mail.gmail.com>
References: <2780899.pn867nL82Z@even-i700>
 <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
 <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>
 <CAMCJChv9QO4CWu-ENAdgqOhnQQyoy2JNCtXkuczAebOh-CXaLw@mail.gmail.com>
 <CACqBkM-+zjjbWUdzXo9_L2_0tUFXjBzrSvj44f3Lo-crz8=NCg@mail.gmail.com>
Message-ID: <CAMCJCht8K8S9C8o2xB_d9X=hXtWcQPFBAbu5g6RaMP1VawMaMA@mail.gmail.com>

Hi Eli,

Does -tz 10.0 in effect raise your DEM target elevation by 10 units?
>


> Was the observer height of -oz 21.6 the same for all three as well?
>

I'm using
-oz 21.6 to put my observer at 21.6 meters above the DEM (it is a
watch-tower);
-tz10.0 to put the target at 10 meters above the DEM (representing a smoke
plume).

Or am I misunderstanding the documentation of gdal_viewshed?

-oz <value> The height of the observer above the DEM surface in the height
unit of the DEM. Default: 2
-tz <value> The height of the target above the DEM surface in the height
unit of the DEM. Default: 0

Thanks Eli!

Best regards,
Pedro
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/37c4ea53/attachment-0001.html>

From pedrongvenancio at gmail.com  Thu May  7 17:31:14 2020
From: pedrongvenancio at gmail.com (=?UTF-8?Q?Pedro_Ven=C3=A2ncio?=)
Date: Fri, 8 May 2020 01:31:14 +0100
Subject: [gdal-dev] gdal_viewshed
In-Reply-To: <CACqBkM8mTNBBuDCrE10qcR5grakizAJ9ThE7baNRYQ5KbzPHqQ@mail.gmail.com>
References: <2780899.pn867nL82Z@even-i700>
 <CACqBkM9ampNVyx2KUJ-RoUH2xRAegVsp9dUDvmH3VD1vxahPKA@mail.gmail.com>
 <E7CD10C4-4878-472A-AF02-DACAEC19A759@hobu.co>
 <CAMCJChv9QO4CWu-ENAdgqOhnQQyoy2JNCtXkuczAebOh-CXaLw@mail.gmail.com>
 <CACqBkM-+zjjbWUdzXo9_L2_0tUFXjBzrSvj44f3Lo-crz8=NCg@mail.gmail.com>
 <CACqBkM8mTNBBuDCrE10qcR5grakizAJ9ThE7baNRYQ5KbzPHqQ@mail.gmail.com>
Message-ID: <CAMCJChtRYjt3iuyfyycKMu3k0+a=RcUmtv5DQ9TKLycaG3aaPA@mail.gmail.com>

Hi Eli,

Oh yes, I used the same parameters in all three. The only difference is in
atmospheric refraction and curvature effect, but even playing a bit with
that parameter, the overall effect is minimum compared with the huge
difference I see between gdal_viewshed and the others.

I'm putting Tamas in CC to ask if I'm missing something.

Thanks and best regards!
Pedro


Eli Adam <eadam at co.lincoln.or.us> escreveu no dia sexta, 8/05/2020 à(s)
01:16:

> Hi Pedro,
>
> On Thu, May 7, 2020 at 4:39 PM Eli Adam <eadam at co.lincoln.or.us> wrote:
> >
> > Was the same done in GRASS and the Visibility Analysis plugin for
> > QGIS?
>
> This was the main part of my question, that all three had the same
> inputs.  Did GRASS and QGIS have all the same parameters?
>
> I'm not certain but my impression is that you're using the parameters
> correctly.  Perhaps the author, Tamas will reply.
>
> Best regards, Eli
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/70e8b981/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri May  8 02:57:08 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 8 May 2020 09:57:08 +0000
Subject: [gdal-dev] gdal_viewshed
Message-ID: <79697097e2ec48d284647ad0b658073a@C119S212VM042.msvyvi.vaha.local>

Hi Pedro,

You wrote that you used this command in your test

gdal_viewshed -b 1 -md 28000.0 -ox -41597.922 -oy 71254.049 -oz 21.6 -tz
10.0 -vv 1 -cc 0.85714 -f GTiff path_to_mdt.tif path_to_output.tif

Could you also give a link to "path_to_mdt.tif" or repeat the test with some other DEM that other users can access with a direct link? Also showing the exact parameters that you used with other software would help lazy people like me to catch the challenge.

I wonder if your DEM is using scaling and offset and somehow gdal_viewshed believes that the observer and target are much higher. Gdalinfo about the DEM would help.

I started a new thread intentionally because the discussion started in a renamed "GDAL 3.1.0 is released" thread.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/2ab0d91b/attachment.html>

From a09550 at gmail.com  Fri May  8 04:44:23 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Fri, 8 May 2020 13:44:23 +0200
Subject: [gdal-dev] How to calculate affine transformation by Python gdal as
	same as gdal_translate?
Message-ID: <CAJGa3-n8NiD7m=fk6k3OS-1phVvzOEh4JxRUqzkh4kuOqnUrgA@mail.gmail.com>

Hello,

I've tried to reproduce a problem to subset (clip) an UTM 32 Sentinel 2
GeoTiff by a given Bounding box (BBOX) in EPSG:4326.

I've created a python gdal script for it, but the result is always contain
few more pixels than what I've tried with gdal_translate binary.

All information of the python script and the gdalinfo was posted here:
https://gis.stackexchange.com/questions/361003/how-to-calculate-affine-transformation-by-python-gdal-as-same-as-gdal-translate

Could someone give me an insight to make the result as same as
gdal_translate?

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/9cbcae58/attachment.html>

From a09550 at gmail.com  Fri May  8 04:50:43 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Fri, 8 May 2020 13:50:43 +0200
Subject: [gdal-dev] Difference results from QGIS project on fly and gdalwarp
 for EPSG:4326 of Sentinel 2 UTM zone 32?
Message-ID: <CAJGa3-nUna413-N8LgXypCkcvGyWynuM53OkE0sTQ6Evw1NQ5g@mail.gmail.com>

Hello,

I always thought QGIS and gdalwarp should return same result for projecting
a 2D Sentinel 2 image (e.g: T32UQD_20200421T102021_TCI_60m.jp2) from UTM 32
to EPSG:4326.

What I did was:

   - Open the .jp2 in QGis 2.14.9 with 'Enable on the fly CRS
   transformation'.
   -

   Warp the .jp2 to geotiff by gdalwarp:

   gdalwarp T32UQD_20200421T102021_TCI_60m.jp2 -t_srs EPSG:4326
   4.warped.tiff

But the output results from them look different significantly (on the left
hand side with QGIS it looks rotated and on the right hand side with
gdalwarp it looks aligned).

Illustration image of differences: https://i.stack.imgur.com/Idisx.png

More information given described at:
https://gis.stackexchange.com/q/360919/17733

Could someone show the opinion?

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/f1359961/attachment.html>

From rajeshreddy_m at yahoo.co.in  Fri May  8 05:36:05 2020
From: rajeshreddy_m at yahoo.co.in (rmaddu)
Date: Fri, 8 May 2020 05:36:05 -0700 (MST)
Subject: [gdal-dev] GDAL C# Bindings: How to implement callback
Message-ID: <1588941365431-0.post@n6.nabble.com>

Dear All,

I have called below GDAL function with callback, not getting the call to
callback function?

var newDs = Gdal.wrapper_GDALVectorTranslateDestName(output, ds,
gdalOptions, new Gdal.GDALProgressFuncDelegate(ProgressFunc), null);

 public static int ProgressFunc(double Complete, IntPtr Message, IntPtr
Data)
    {

    }

How to know that this call is complete?

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From RejectKid at gmail.com  Fri May  8 10:31:33 2020
From: RejectKid at gmail.com (RejectKid)
Date: Fri, 8 May 2020 10:31:33 -0700 (MST)
Subject: [gdal-dev] New to Gdal and NITF
In-Reply-To: <019b01d624ca$3ab43290$b01c97b0$@frogmouth.net>
References: <1588797776141-0.post@n6.nabble.com>
 <015801d62431$449ee5f0$cddcb1d0$@frogmouth.net>
 <1588859240907-0.post@n6.nabble.com>
 <019b01d624ca$3ab43290$b01c97b0$@frogmouth.net>
Message-ID: <1588959093056-0.post@n6.nabble.com>

sweet thanks. this thread has helped a bunch thanks!



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From giuseppe.amatulli at gmail.com  Fri May  8 10:38:39 2020
From: giuseppe.amatulli at gmail.com (Giuseppe Amatulli)
Date: Fri, 8 May 2020 13:38:39 -0400
Subject: [gdal-dev] Fwd: Gecomputation web-seminars (GDAL, PKTOOLS, GRASS,
	HPC)
In-Reply-To: <CAKoiDHKA+0VV89eWRY-Hhii_ZqU3LX8RN2fTwhrnJqRYo3tOsw@mail.gmail.com>
References: <CAKoiDHKA+0VV89eWRY-Hhii_ZqU3LX8RN2fTwhrnJqRYo3tOsw@mail.gmail.com>
Message-ID: <CAKoiDH+9TDLWxaiLvN=cMH49bRt4FQp2ML8-TFNBuN1xb3L5vA@mail.gmail.com>

---------- Forwarded message ---------
From: Giuseppe Amatulli <giuseppe.amatulli at gmail.com>
Date: Fri, 8 May 2020 at 13:35
Subject: Gecomputation web-seminars (GDAL, PKTOOLS, GRASS, HPC)
To: <geoforall at lists.osgeo.org>


Dear Colleagues,
In reference to the Gecomputation web-seminars starting on Monday, May 11th
2020, below you can find the youtube hyperlink for the live streaming.
After the event, the youtube videos will be linked to my youtube channel
<https://www.youtube.com/channel/UCbDBJoGr8ojUklD27AKvvSw/videos?view_as=subscriber>
.
Please register if you want to follow via zoom and also if you want have
the instructions to access to the Linux Virtual Machine.
Please disseminate.
Best regards
Giuseppe Amatulli

---------- Forwarded message ---------
From: Giuseppe Amatulli <giuseppe.amatulli at gmail.com>
Date: Thu, 30 Apr 2020 at 11:45
Subject: Gecomputation web-seminars (GDAL, PKTOOLS, GRASS, HPC)
To: <spatial-ecology at lists.osgeo.org>


Dear Colleagues,

During the second week of May (Eastern Daylight Time), I will be teaching 4
web-seminars for enhancing *gecomputation skills to process large
geographic data*.
Each of these seminars will be held in both *English* and *Spanish*.
Participants will be given access to a cloud-based Linux virtual machine
that can be reached via an SSH tunnel.
Please distribute the details of these seminars among your colleagues and
students.

To view this email as a web page, go here.
<https://view.S10.exacttarget.com/?qs=19041bfa7521d2e931fc72d14ad1a14844ed5d698621a8cc5d6c34b29adec9b14f4d6bc8db15f1b08df380850cc0002c6e8b75eed41f67a60b8eabb984d4e341772e26106ea8d753f2939d3fbde912f6>
[image: Yale Center for Research Computing]

Raster/Vector Processing using GDAL/OGR
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a5648ebf788c5a48f0b32b9687162c7cc16377a075daf4795bd4e5655083687663d31cb0bd576d6f5e7ffe32c39b6038c0b5615a3db185efdcd>
may 11, 2020
9:00 - 11:30 AM EDT
(IN ENGLISH, VIA ZOOM: register; VIA YOUTUBE <https://youtu.be/TPJm7fhBTDQ>)
1:00 - 3:30 PM EDT
(En Español, via zoom: REGISTER; Via YOUTUBE <https://youtu.be/NGLEOznOFn0>)

The workshop covers geo-data processing tasks: cropping and re-projecting,
mosaicing, and filtering images, and how to script processes for complex
geo-functions.
REGISTER
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a5661ad07e9a8bc054b761b52265cf3d9e2eed5404ee84b0fdd3d0cbff2f896ca6ae9bd8cbaf81cbe733405accee86530b5140cb11a1c49cfe8>
[image: Globe with GDAL logo]
Image Processing using Pktools
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a563645cf07ff61648d66e5cff64d0d6fcbb36789065b1a672af3a7ed476118fa3ce91f73f682bb1d99943ee5cdb66dd897f85621faa5abc92a>
may 12, 2020
9:00 - 11:30 AM EDT
(IN ENGLISH, Via Zoom: REGISTER; Via YOUTUBE <https://youtu.be/xhnfYZ_ei4E>)
1:00 - 3:30 PM EDT
(En Español, via zoom: REGISTER; Via YOUTUBE <https://youtu.be/YzfuN0Q5q3o>)
This workshop will focus on Processing Kernel for geospatial data (Pktools)
to perform remote sensing image analysis. The workshop will include
examples of mosaicing, filtering, histogram, masking, and raster
re-classification.
REGISTER
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56f0079c6f30e5d37805e245e6c7596fe075f336e37b313d82da808246fa8168bb7e52e8c213249fa4b4f1aef0fe08dacef658cd3f4d402f8a>
[image: Globe with Pktools logo]
Introduction to GRASS GIS
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56a12ee181e58dd9a60186607cc65af10fe32b61ccb07db501f4b95d210ef27b22cea6da00c624720d2e13cc4b75ea4ace0ad40f57ea1a0c65>
may 13, 2020
9:00 - 11:30 AM EDT
(IN ENGLISH, Via Zoom: REGISTER; Via YOUTUBE <https://youtu.be/VDsVcijsrkg>)
1:00 - 3:30 PM EDT
(En Español, via zoom: REGISTER; Via YOUTUBE <https://youtu.be/o9rIq0JBbT8>)
This workshop introduces students to the powerful GRASS GIS software to
manipulate raster and vector data, and covers using the graphical user
interface and simple Bash scripts to automate many common geo-data
processing tasks such as cropping and re-projecting images, and how to
script processes for complex geo-functions.
REGISTER
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56860922368c969e67b08909d6ebd19464e5611220722973629abc57276f8c68d1e0d8b3cf38e9d8d83eb9e97091198dd94768eeb8b4441e15>
[image: Globe with GRASS logo]
GeoComputation with High Performance Computing
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a567652106f032c4bc2c42e5dbc587878576a027f7eefd9d45b13b4fa91430c9bb976b612956b8723f2fdbff99b716782971254aa3f0590883e>
may 14, 2020
9:00 - 11:30 AM EDT
(IN ENGLISH, Via Zoom: REGISTER; Via YOUTUBE <https://youtu.be/gcQ_74v87xk>)
1:00 - 3:30 PM EDT
(En Español, via zoom: REGISTER; Via YOUTUBE <https://youtu.be/KXiVF0l59Ok>)
This workshop introduces students to perform Geocomputation analysis in
High Performance Computing (HPC) that use the Slurm queuing system. Using
simple Bash scripts, we will show four main ways to tile an image, perform
a filter operation and reassemble back the image.
REGISTER
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a5648b1a8e5b0ad31206355cb842fa0bf4c1f5a459c2cadb70e019f27184cd37d0606dae6dcbb4fcc4b9db7a872d89700758be63db7b55df9cd>
[image: Globe with Bash logo]

[image: Yale University]
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56d7821406633c8f9a035bac975b7646346f3210b8b1f8238eddf959b5a6d9cdbd70dd2b452160ab846bb3f14dc5e32c5f>
Yale Center for Research Computing: research.computing at yale.edu.
Copyright © 2020 Yale University • All rights reserved
[image: Twitter]
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56895ad533ef9de2d9fadd83007501cac7385ce0859509fb4c91ed32f11d1d60820eedbf37cbe01d3dc37555f2f1010374>
Twitter
<http://cl.S10.exct.net/?qs=a85f232b8a2b9a56895ad533ef9de2d9fadd83007501cac7385ce0859509fb4c91ed32f11d1d60820eedbf37cbe01d3dc37555f2f1010374>




-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
School of Forestry & Environmental Studies
Center for Research Computing
Yale University
New Haven, CT, USA
06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/


-- 
Giuseppe Amatulli, Ph.D.

Research scientist at
School of Forestry & Environmental Studies
Center for Research Computing
Yale University
New Haven, CT, USA
06511
Teaching: http://spatial-ecology.net
Work:  https://environment.yale.edu/profile/giuseppe-amatulli/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/88bf14f1/attachment-0001.html>

From emmburris at gmail.com  Fri May  8 11:36:47 2020
From: emmburris at gmail.com (Meghan Burris)
Date: Fri, 8 May 2020 11:36:47 -0700
Subject: [gdal-dev] gdalwarp results differ in different gdal versions?
Message-ID: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>

Hello!

I'm hoping someone can shine some light in my direction because I can't
find any answers.

I'm trying to warp a Polar Stereographic image into an Equal Cylindrical
projection. When I run the gdalwarp command on older versions (specifically
1.8.1), my image looks as I would expect. When I run the same command in
gdal versions 2.2.4 or 2.4.1, the pole is clipped out and missing. I've
tried adding different parameters such as -te, and multiple -wo parameters
and nothing works for me. Am I missing something? Any help would be greatly
appreciated because I can't use the older versions anymore in my script. My
original warp command is below as well as the original polar header.
Although, I have tried multiple images and I still don't get the results
that I was getting in version 1.8.

Thank you in advance!!

Meghan

gdalwarp -overwrite -of GTiff -t_srs "+proj=eqc +a=3375.0 +b=3375.0
+towgs=0,0,0,0,0,0" input.tif output.tif

Driver: GTiff/GeoTIFF
Files: SP_MY34_summer_18mpp_gd2.tif
Size is 35928, 35815
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",3396000,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-90],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-383491.061348880291916,410399.872797137824818)
Pixel Size = (17.999204982112094,-17.999204982112094)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -383491.061,  410399.873) ( 43d 3'31.36"W, 80d32'41.89"S)
Lower Left  ( -383491.061, -234241.654) (121d25' 1.79"W, 82d25'46.00"S)
Upper Right (  263184.375,  410399.873) ( 32d40'17.59"E, 81d47'18.78"S)
Lower Right (  263184.375, -234241.654) (131d40'12.00"E, 84d 3'39.60"S)
Center      (  -60153.343,   88079.110) ( 34d19'51.59"W, 88d12' 2.26"S)
Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
  Min=2146.000 Max=10112.000
  Minimum=2146.000, Maximum=10112.000, Mean=5382.365, StdDev=1638.523
  NoData Value=0
  Overviews: 17964x17908, 8982x8954, 4491x4477, 2246x2239, 1123x1120,
562x560, 281x280, 141x140, 71x70
  Metadata:
    STATISTICS_MAXIMUM=10112
    STATISTICS_MEAN=5382.3651107267
    STATISTICS_MINIMUM=2146
    STATISTICS_STDDEV=1638.5226548658
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/93b8ab72/attachment.html>

From even.rouault at spatialys.com  Fri May  8 11:55:48 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 May 2020 20:55:48 +0200
Subject: [gdal-dev] gdalwarp results differ in different gdal versions?
In-Reply-To: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>
References: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>
Message-ID: <2006024.HD4pbBI4Xp@even-i700>

Meghan,

Handling poles tend to be fragile, so perhaps something that worked previously no longer 
works.
 
Did you try -wo SAMPLE_GRID=YES ?

If that still doesn't work, the best is you open a ticket with an input image attached 
(dimensions reduced as much as possible while still reproducing the issue), and the exact 
command line to reproduce.
I'd note that in your below attempt there's a likely mismatch in the units of the target 
ellipsoid w.r.t the initial one. This should be a/b=3375000.

Even

> Hello!
> 
> I'm hoping someone can shine some light in my direction because I can't
> find any answers.
> 
> I'm trying to warp a Polar Stereographic image into an Equal Cylindrical
> projection. When I run the gdalwarp command on older versions (specifically
> 1.8.1), my image looks as I would expect. When I run the same command in
> gdal versions 2.2.4 or 2.4.1, the pole is clipped out and missing. I've
> tried adding different parameters such as -te, and multiple -wo parameters
> and nothing works for me. Am I missing something? Any help would be greatly
> appreciated because I can't use the older versions anymore in my script. My
> original warp command is below as well as the original polar header.
> Although, I have tried multiple images and I still don't get the results
> that I was getting in version 1.8.
> 
> Thank you in advance!!
> 
> Meghan
> 
> gdalwarp -overwrite -of GTiff -t_srs "+proj=eqc +a=3375.0 +b=3375.0
> +towgs=0,0,0,0,0,0" input.tif output.tif
> 
> Driver: GTiff/GeoTIFF
> Files: SP_MY34_summer_18mpp_gd2.tif
> Size is 35928, 35815
> Coordinate System is:
> PROJCS["unnamed",
>     GEOGCS["unnamed ellipse",
>         DATUM["unknown",
>             SPHEROID["unnamed",3396000,0]],
>         PRIMEM["Greenwich",0],
>         UNIT["degree",0.0174532925199433]],
>     PROJECTION["Polar_Stereographic"],
>     PARAMETER["latitude_of_origin",-90],
>     PARAMETER["central_meridian",0],
>     PARAMETER["scale_factor",1],
>     PARAMETER["false_easting",0],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]]]
> Origin = (-383491.061348880291916,410399.872797137824818)
> Pixel Size = (17.999204982112094,-17.999204982112094)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   COMPRESSION=DEFLATE
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  ( -383491.061,  410399.873) ( 43d 3'31.36"W, 80d32'41.89"S)
> Lower Left  ( -383491.061, -234241.654) (121d25' 1.79"W, 82d25'46.00"S)
> Upper Right (  263184.375,  410399.873) ( 32d40'17.59"E, 81d47'18.78"S)
> Lower Right (  263184.375, -234241.654) (131d40'12.00"E, 84d 3'39.60"S)
> Center      (  -60153.343,   88079.110) ( 34d19'51.59"W, 88d12' 2.26"S)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
>   Min=2146.000 Max=10112.000
>   Minimum=2146.000, Maximum=10112.000, Mean=5382.365, StdDev=1638.523
>   NoData Value=0
>   Overviews: 17964x17908, 8982x8954, 4491x4477, 2246x2239, 1123x1120,
> 562x560, 281x280, 141x140, 71x70
>   Metadata:
>     STATISTICS_MAXIMUM=10112
>     STATISTICS_MEAN=5382.3651107267
>     STATISTICS_MINIMUM=2146
>     STATISTICS_STDDEV=1638.5226548658


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/7edd8589/attachment.html>

From thare at usgs.gov  Fri May  8 11:52:11 2020
From: thare at usgs.gov (Hare, Trent M)
Date: Fri, 8 May 2020 18:52:11 +0000
Subject: [gdal-dev] [EXTERNAL] gdalwarp results differ in different gdal
 versions?
In-Reply-To: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>
References: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>
Message-ID: <BY5PR09MB464179A7C183821CDACCFD4ED2A20@BY5PR09MB4641.namprd09.prod.outlook.com>

Meghan,
  Looks like you are on Mars and in your warp command your +a and +b appear to be in kilometers -- when they should be meters.

Now I'm not sure where those radii values are coming from. I guess I would recommend using the same as the input image though.
+a=3396000 +b=3396000

-Trent



________________________________
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Meghan Burris <emmburris at gmail.com>
Sent: Friday, May 8, 2020 11:36 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: [EXTERNAL] [gdal-dev] gdalwarp results differ in different gdal versions?

Hello!

I'm hoping someone can shine some light in my direction because I can't find any answers.

I'm trying to warp a Polar Stereographic image into an Equal Cylindrical projection. When I run the gdalwarp command on older versions (specifically 1.8.1), my image looks as I would expect. When I run the same command in gdal versions 2.2.4 or 2.4.1, the pole is clipped out and missing. I've tried adding different parameters such as -te, and multiple -wo parameters and nothing works for me. Am I missing something? Any help would be greatly appreciated because I can't use the older versions anymore in my script. My original warp command is below as well as the original polar header. Although, I have tried multiple images and I still don't get the results that I was getting in version 1.8.

Thank you in advance!!

Meghan

gdalwarp -overwrite -of GTiff -t_srs "+proj=eqc +a=3375.0 +b=3375.0 +towgs=0,0,0,0,0,0" input.tif output.tif

Driver: GTiff/GeoTIFF
Files: SP_MY34_summer_18mpp_gd2.tif
Size is 35928, 35815
Coordinate System is:
PROJCS["unnamed",
    GEOGCS["unnamed ellipse",
        DATUM["unknown",
            SPHEROID["unnamed",3396000,0]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    PROJECTION["Polar_Stereographic"],
    PARAMETER["latitude_of_origin",-90],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]]]
Origin = (-383491.061348880291916,410399.872797137824818)
Pixel Size = (17.999204982112094,-17.999204982112094)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=DEFLATE
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -383491.061,  410399.873) ( 43d 3'31.36"W, 80d32'41.89"S)
Lower Left  ( -383491.061, -234241.654) (121d25' 1.79"W, 82d25'46.00"S)
Upper Right (  263184.375,  410399.873) ( 32d40'17.59"E, 81d47'18.78"S)
Lower Right (  263184.375, -234241.654) (131d40'12.00"E, 84d 3'39.60"S)
Center      (  -60153.343,   88079.110) ( 34d19'51.59"W, 88d12' 2.26"S)
Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
  Min=2146.000 Max=10112.000
  Minimum=2146.000, Maximum=10112.000, Mean=5382.365, StdDev=1638.523
  NoData Value=0
  Overviews: 17964x17908, 8982x8954, 4491x4477, 2246x2239, 1123x1120, 562x560, 281x280, 141x140, 71x70
  Metadata:
    STATISTICS_MAXIMUM=10112
    STATISTICS_MEAN=5382.3651107267
    STATISTICS_MINIMUM=2146
    STATISTICS_STDDEV=1638.5226548658

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/c220bf6e/attachment.html>

From traviskirstine at gmail.com  Fri May  8 12:08:36 2020
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Fri, 8 May 2020 15:08:36 -0400
Subject: [gdal-dev] COG - RGBI
Message-ID: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>

Is it possible to create RGBI Cloud Optimized Tiffs with JPEG compression?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/a4589859/attachment.html>

From vincent.sarago at gmail.com  Fri May  8 12:12:18 2020
From: vincent.sarago at gmail.com (Vincent Sarago)
Date: Fri, 8 May 2020 15:12:18 -0400
Subject: [gdal-dev] COG - RGBI
In-Reply-To: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
References: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
Message-ID: <F1F0061D-4C3B-4716-A387-7E0D8948B23C@gmail.com>

I guess you mean RGB and I for Infra-red ?  Anyway the answer will be NO. JPEG only allow 3 bands + a bit mask (same for Webp).

For raster with more than 3 bands there is no real option to get compression (with loss) as high as with JPEG or WEBP . 

> Le 8 mai 2020 à 15:08, Travis Kirstine <traviskirstine at gmail.com> a écrit :
> 
> Is it possible to create RGBI Cloud Optimized Tiffs with JPEG compression?
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From even.rouault at spatialys.com  Fri May  8 12:14:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 08 May 2020 21:14:26 +0200
Subject: [gdal-dev] COG - RGBI
In-Reply-To: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
References: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
Message-ID: <9212010.eCTi8inMlp@even-i700>

On vendredi 8 mai 2020 15:08:36 CEST Travis Kirstine wrote:
> Is it possible to create RGBI Cloud Optimized Tiffs with JPEG 
compression?

Possibly. But not with the COG driver, which doesn't offer the option 
for that. You should use the old way with the GTiff driver by forcing
-co INTERLEAVE=BAND so that each band is JPEG compressed 
separately (since pixel-interleaved JPEG compression is limited to 3 
samples)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/effc69a7/attachment-0001.html>

From warmerdam at pobox.com  Fri May  8 12:14:34 2020
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Fri, 8 May 2020 15:14:34 -0400
Subject: [gdal-dev] COG - RGBI
In-Reply-To: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
References: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
Message-ID: <CA+YzLBe2-Pikxy=FfiWG09Y6DG-aSo4kXV-kEpMdEBx=D3WZmw@mail.gmail.com>

Travis,

The big benefit of JPEG compression comes with YCbCr color space which I do
not believe can be mixed with a 4 band RGBI product.  So I'm not sure how
one would do this.  One could certainly put the NIR in a distinct directory
in the GeoTIFF, but not many applications would know how to utilize that,
and it would not appear as just a 4th band from the GDAL view of things.

In theory you could do BAND interleaved JPEG and compress each of the 4
bands separately but I do not think you get a great quality/compression
result from this.

I'm also curious if you were wanting to just do 8bit or 12/16bit?

I would love to have a way of distributing 12/16 bit RGBI data with a good
(gentle) lossy compression and good application compatibility in TIFF.

Best regards,
Frank

On Fri, May 8, 2020 at 3:08 PM Travis Kirstine <traviskirstine at gmail.com>
wrote:

> Is it possible to create RGBI Cloud Optimized Tiffs with JPEG compression?
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/c11b8453/attachment.html>

From emmburris at gmail.com  Fri May  8 12:20:09 2020
From: emmburris at gmail.com (Meghan Burris)
Date: Fri, 8 May 2020 12:20:09 -0700
Subject: [gdal-dev] gdalwarp results differ in different gdal versions?
In-Reply-To: <2006024.HD4pbBI4Xp@even-i700>
References: <CAFO=5LU4Zn-Ojd5AjXppgvPBM-K2OJOFEOeSOkTx8oFqaNv_gw@mail.gmail.com>
 <2006024.HD4pbBI4Xp@even-i700>
Message-ID: <CAFO=5LV7UmPrb4cS9WaWrsmFpu+iePVO3GZRx-yCYKicMdej3A@mail.gmail.com>

That is correct, my image is a Mars southern pole image. Those radii are
pulled from another file but I have run the command with the +a/b being in
meters, specifically 3396000 and I still get the same result (missing polar
information).

I have also run the command using -wo SAMPLE_GRID=YES and nothing changed.
I just tried the command with the -wo SAMPLE_GRID and the +a/b being 337500
and I still get the pole clipped.

I would be happy to submit a ticket. Is this the location that I would do
that :  https://github.com/OSGeo/gdal

Thank you Trent and Even!


On Fri, May 8, 2020 at 11:55 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Meghan,
>
>
>
> Handling poles tend to be fragile, so perhaps something that worked
> previously no longer works.
>
> Did you try -wo SAMPLE_GRID=YES ?
>
>
>
> If that still doesn't work, the best is you open a ticket with an input
> image attached (dimensions reduced as much as possible while still
> reproducing the issue), and the exact command line to reproduce.
>
> I'd note that in your below attempt there's a likely mismatch in the units
> of the target ellipsoid w.r.t the initial one. This should be a/b=3375000.
>
>
>
> Even
>
>
>
> > Hello!
>
> >
>
> > I'm hoping someone can shine some light in my direction because I can't
>
> > find any answers.
>
> >
>
> > I'm trying to warp a Polar Stereographic image into an Equal Cylindrical
>
> > projection. When I run the gdalwarp command on older versions
> (specifically
>
> > 1.8.1), my image looks as I would expect. When I run the same command in
>
> > gdal versions 2.2.4 or 2.4.1, the pole is clipped out and missing. I've
>
> > tried adding different parameters such as -te, and multiple -wo
> parameters
>
> > and nothing works for me. Am I missing something? Any help would be
> greatly
>
> > appreciated because I can't use the older versions anymore in my script.
> My
>
> > original warp command is below as well as the original polar header.
>
> > Although, I have tried multiple images and I still don't get the results
>
> > that I was getting in version 1.8.
>
> >
>
> > Thank you in advance!!
>
> >
>
> > Meghan
>
> >
>
> > gdalwarp -overwrite -of GTiff -t_srs "+proj=eqc +a=3375.0 +b=3375.0
>
> > +towgs=0,0,0,0,0,0" input.tif output.tif
>
> >
>
> > Driver: GTiff/GeoTIFF
>
> > Files: SP_MY34_summer_18mpp_gd2.tif
>
> > Size is 35928, 35815
>
> > Coordinate System is:
>
> > PROJCS["unnamed",
>
> > GEOGCS["unnamed ellipse",
>
> > DATUM["unknown",
>
> > SPHEROID["unnamed",3396000,0]],
>
> > PRIMEM["Greenwich",0],
>
> > UNIT["degree",0.0174532925199433]],
>
> > PROJECTION["Polar_Stereographic"],
>
> > PARAMETER["latitude_of_origin",-90],
>
> > PARAMETER["central_meridian",0],
>
> > PARAMETER["scale_factor",1],
>
> > PARAMETER["false_easting",0],
>
> > PARAMETER["false_northing",0],
>
> > UNIT["metre",1,
>
> > AUTHORITY["EPSG","9001"]]]
>
> > Origin = (-383491.061348880291916,410399.872797137824818)
>
> > Pixel Size = (17.999204982112094,-17.999204982112094)
>
> > Metadata:
>
> > AREA_OR_POINT=Area
>
> > Image Structure Metadata:
>
> > COMPRESSION=DEFLATE
>
> > INTERLEAVE=BAND
>
> > Corner Coordinates:
>
> > Upper Left ( -383491.061, 410399.873) ( 43d 3'31.36"W, 80d32'41.89"S)
>
> > Lower Left ( -383491.061, -234241.654) (121d25' 1.79"W, 82d25'46.00"S)
>
> > Upper Right ( 263184.375, 410399.873) ( 32d40'17.59"E, 81d47'18.78"S)
>
> > Lower Right ( 263184.375, -234241.654) (131d40'12.00"E, 84d 3'39.60"S)
>
> > Center ( -60153.343, 88079.110) ( 34d19'51.59"W, 88d12' 2.26"S)
>
> > Band 1 Block=256x256 Type=Byte, ColorInterp=Gray
>
> > Min=2146.000 Max=10112.000
>
> > Minimum=2146.000, Maximum=10112.000, Mean=5382.365, StdDev=1638.523
>
> > NoData Value=0
>
> > Overviews: 17964x17908, 8982x8954, 4491x4477, 2246x2239, 1123x1120,
>
> > 562x560, 281x280, 141x140, 71x70
>
> > Metadata:
>
> > STATISTICS_MAXIMUM=10112
>
> > STATISTICS_MEAN=5382.3651107267
>
> > STATISTICS_MINIMUM=2146
>
> > STATISTICS_STDDEV=1638.5226548658
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/fe332c00/attachment.html>

From traviskirstine at gmail.com  Fri May  8 12:55:12 2020
From: traviskirstine at gmail.com (Travis Kirstine)
Date: Fri, 8 May 2020 15:55:12 -0400
Subject: [gdal-dev] COG - RGBI
In-Reply-To: <CA+YzLBe2-Pikxy=FfiWG09Y6DG-aSo4kXV-kEpMdEBx=D3WZmw@mail.gmail.com>
References: <CALtm4h2e=J3vJh7p4twcCqs4pE0GPAthvEKKfRcCe1O=EExvQQ@mail.gmail.com>
 <CA+YzLBe2-Pikxy=FfiWG09Y6DG-aSo4kXV-kEpMdEBx=D3WZmw@mail.gmail.com>
Message-ID: <CALtm4h0+1O3vPW+dmLt3rxmsMNsCO9m=bPzfo6iEB+nO0-tTnQ@mail.gmail.com>

Thanks all for the feedback!

Right now we are looking at doing this for only 8bit.

Regards


On Fri, 8 May 2020 at 15:14, Frank Warmerdam <warmerdam at pobox.com> wrote:

> Travis,
>
> The big benefit of JPEG compression comes with YCbCr color space which I
> do not believe can be mixed with a 4 band RGBI product.  So I'm not sure
> how one would do this.  One could certainly put the NIR in a distinct
> directory in the GeoTIFF, but not many applications would know how to
> utilize that, and it would not appear as just a 4th band from the GDAL view
> of things.
>
> In theory you could do BAND interleaved JPEG and compress each of the 4
> bands separately but I do not think you get a great quality/compression
> result from this.
>
> I'm also curious if you were wanting to just do 8bit or 12/16bit?
>
> I would love to have a way of distributing 12/16 bit RGBI data with a good
> (gentle) lossy compression and good application compatibility in TIFF.
>
> Best regards,
> Frank
>
> On Fri, May 8, 2020 at 3:08 PM Travis Kirstine <traviskirstine at gmail.com>
> wrote:
>
>> Is it possible to create RGBI Cloud Optimized Tiffs with JPEG compression?
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
> --
>
> ---------------------------------------+--------------------------------------
> I set the clouds in motion - turn up   | Frank Warmerdam,
> warmerdam at pobox.com
> light and sound - activate the windows | +1 650-701-7823
> and watch the world go round - Rush    | Geospatial Software Developer
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200508/c7eb0393/attachment-0001.html>

From rajanchauhan11 at gmail.com  Sat May  9 14:04:54 2020
From: rajanchauhan11 at gmail.com (Rajan Chauhan)
Date: Sun, 10 May 2020 02:34:54 +0530
Subject: [gdal-dev] Fwd: GDAL 3.0.5 release in conda
In-Reply-To: <CAOVAmqvmmKpjX44gEaAFE+Fq5CBvJPgzwQ5=LCF8FCuEjUMV+w@mail.gmail.com>
References: <CAOVAmqvmmKpjX44gEaAFE+Fq5CBvJPgzwQ5=LCF8FCuEjUMV+w@mail.gmail.com>
Message-ID: <CAOVAmqsEcb6pUGaYNXs7f1+OQaftm7v9JX24seL6bxtpWbfuDw@mail.gmail.com>

Hi GDAL devs,
This is regarding issue #2221
<https://github.com/OSGeo/gdal/issues/2221> which got
fixed in GDAL 3.0.5 release.
Current GDALrelease on conda is at 3.0.4
https://anaconda.org/conda-forge/gdal
May I know the timeline for GDAL new release on conda environment.
Could you please prioritize this? I am afraid that this could be a
performance hampering issue.

Thank you.
-- 
Regards
Rajan Chauhan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200510/0fc8765d/attachment.html>

From neteler at osgeo.org  Sat May  9 14:09:14 2020
From: neteler at osgeo.org (Markus Neteler)
Date: Sat, 9 May 2020 23:09:14 +0200
Subject: [gdal-dev] installing gdal in CentOS
In-Reply-To: <alpine.DEB.2.21.1904080910430.25436@warden.aitchison.me.uk>
References: <CAKVWn8A1uWEhN7hhjHv2VEarxd1ajeFE8_vP=H8Ti9f-p7FYBg@mail.gmail.com>
 <CALFmHhtCO8yQk_WuBQY5y3JLueAFq=2tCjxad0jgVz3z8yPSmw@mail.gmail.com>
 <1708034.anJ8qsWJeK@even-i700>
 <CALFmHhvmZ0QpcF4jh9DYyeJH1ftd9p4imjs-sT5-FnfRRjZwtw@mail.gmail.com>
 <alpine.DEB.2.21.1904012208090.9932@warden.aitchison.me.uk>
 <CALFmHhv5qWct7==JyBGtdwEwzv4QqVpnsTU-ctf6Zk_Eh3RVkA@mail.gmail.com>
 <alpine.DEB.2.21.1904080910430.25436@warden.aitchison.me.uk>
Message-ID: <CALFmHhvSS_LkK40seFo7t8uZK6njAsLKy-QgN2F6cK=XWEToSg@mail.gmail.com>

Hi,

(bumping an older discussion, some success)

On Mon, Apr 8, 2019 at 10:32 AM Andrew C Aitchison
<andrew at aitchison.me.uk> wrote:
> On Fri, 5 Apr 2019, Markus Neteler wrote:
> > On Mon, Apr 1, 2019 at 11:17 PM Andrew C Aitchison
> >> On Mon, 1 Apr 2019, Markus Neteler wrote:
> >>> Now I am stuck at
> >>> ...
> >>>
> >>> BUILD SUCCESSFUL
> >>> Total time: 10 seconds
> >>> + popd
> >>> + %mvn_artifact swig/java/build/maven/gdal-2.3.2.pom
> >>> swig/java/build/maven/gdal-2.3.2.jar
> >>> ~/build/BUILD/gdal-2.3.2-fedora
> >>> /var/tmp/rpm-tmp.R4QpDm: line 139: fg: no job control
> >>> error: Bad exit status from /var/tmp/rpm-tmp.R4QpDm (%build)
> >>> ....
> >>
> >> That is probably a bug in the rpm .spec file
> >>      https://www.redhat.com/archives/rpm-list/2002-October/msg00271.html
> >> suggests that it is a % character being passed to the shell.
> >
> > Thanks Andrew,
> >
> > I made further attempts but I am stuck.
> > Maybe the Python-3 support needs to be kicked out as well?
> >
[...]
> I only have RedHat/CentOS/SL 6, not 7 and
>         grep -r py3_build /usr/lib/rpm
> shows nothing. Does py3_build exist in your rpm tree,
> or is it part of COPR ?

So, today I started a new attempt and was kind of successful by
modifying the GDAL 3.0.4 SPEC file for Centos 8, i.e. I have used the
official GDAL 3.0.4 SPEC file [1] and made the following changes:
- disabled JAVA and LaTeX support for EPEL8, due to (yet) missing dependencies

FWIW, this modified file I attached here:
https://bugzilla.redhat.com/show_bug.cgi?id=1741567

Best,
Markus

[1] https://koji.fedoraproject.org/koji/packageinfo?packageID=1826


--
Markus Neteler, PhD
https://www.mundialis.de - free data with free software
https://grass.osgeo.org
https://courses.neteler.org/blog

From even.rouault at spatialys.com  Sat May  9 14:10:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 09 May 2020 23:10:55 +0200
Subject: [gdal-dev] Fwd: GDAL 3.0.5 release in conda
In-Reply-To: <CAOVAmqsEcb6pUGaYNXs7f1+OQaftm7v9JX24seL6bxtpWbfuDw@mail.gmail.com>
References: <CAOVAmqvmmKpjX44gEaAFE+Fq5CBvJPgzwQ5=LCF8FCuEjUMV+w@mail.gmail.com>
 <CAOVAmqsEcb6pUGaYNXs7f1+OQaftm7v9JX24seL6bxtpWbfuDw@mail.gmail.com>
Message-ID: <6333028.IGJzdN5eIl@even-i700>

On dimanche 10 mai 2020 02:34:54 CEST Rajan Chauhan wrote:
> Hi GDAL devs,
> This is regarding issue #2221
> <https://github.com/OSGeo/gdal/issues/2221> which got
> fixed in GDAL 3.0.5 release.
> Current GDALrelease on conda is at 3.0.4
> https://anaconda.org/conda-forge/gdal
> May I know the timeline for GDAL new release on conda environment.
> Could you please prioritize this? I am afraid that this could be a
> performance hampering issue.

It's unlikely we release a 3.0.5 now that 3.1.0 is out. I presume conda-forge GDAL maintainers 
will tackle that soon. Monitor
https://github.com/conda-forge/gdal-feedstock

I see a https://github.com/conda-forge/gdal-feedstock/pull/391

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200509/30161776/attachment.html>

From sandra.maksimovic at mcri.edu.au  Sun May 10 22:37:07 2020
From: sandra.maksimovic at mcri.edu.au (Sandra Maksimovic)
Date: Mon, 11 May 2020 05:37:07 +0000
Subject: [gdal-dev] how to install gdal from source?
Message-ID: <D0A3132393C48A4A95D733EC22902B1203536F2FF6@MITSMXMBX02V.mcri.edu.au>

Hi all,

I'm trying to install GDAL v3.1.0 with Proj v6.2.1 on CentOS 7.7. I am continually receiving the following error during the make step:

../gdal.h:44:26: fatal error: gdal_version.h: No such file or directory
#include "gdal_version.h"

I have tried including the headers from the OS installed version of GDAL (v1.11.4) to no avail. Here is my configure line:

./configure --prefix=$PREFIX --with-proj=$PROJDIR --includedir=/usr/include/gdal --with-threads --with-libtiff=internal --with-geotiff=internal --with-jpeg=internal --with-gif=internal --with-png=internal --with-libz=internal

Any ideas?

Thanks,

Sandra Maksimovic
Systems Administrator
Information Technology

Murdoch Children's Research Institute
The Royal Children's Hospital, 50 Flemington Road
Parkville, Victoria 3052 Australia

T    +61 3 8341 6498
E    sandra.maksimovic at mcri.edu.au<mailto:sandra.maksimovic at mcri.edu.au>
W   mcri.edu.au<https://www.mcri.edu.au/>

Disclaimer

This e-mail and any attachments to it (the "Communication") are, unless otherwise stated, confidential, may contain copyright material and is for the use only of the intended recipient. If you receive the Communication in error, please notify the sender immediately by return e-mail, delete the Communication and the return e-mail, and do not read, copy, retransmit or otherwise deal with it. Any views expressed in the Communication are those of the individual sender only, unless expressly stated to be those of Murdoch Children’s Research Institute (MCRI) ABN 21 006 566 972 or any of its related entities. MCRI does not accept liability in connection with the integrity of or errors in the Communication, computer virus, data corruption, interference or delay arising from or in respect of the Communication.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200511/55dff5a8/attachment.html>

From jgr at osgeopt.pt  Mon May 11 01:36:08 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Mon, 11 May 2020 09:36:08 +0100
Subject: [gdal-dev] how to install gdal from source?
In-Reply-To: <D0A3132393C48A4A95D733EC22902B1203536F2FF6@MITSMXMBX02V.mcri.edu.au>
References: <D0A3132393C48A4A95D733EC22902B1203536F2FF6@MITSMXMBX02V.mcri.edu.au>
Message-ID: <f7f0eed1-a3bf-b3bf-b186-81cab7bee1b7@osgeopt.pt>

Hi Sandra,

Are you switch to gdal/gdal? You shouldn't have to add a includedir for
gdal. gdal_version.h is included in the code, at gcore/gdal_version.h

Here my recipe to compile gdal (on Ubuntu):

git clone https://github.com/OSGeo/gdal
cd gdal/gdal
./autogen.sh
./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes
--with-poppler
make -j8
sudo make install
sudo ldconfig
cd swig/python
python3 setup.py build
sudo python3 setup.py install

I hope it helps. Regards,

Jorge Gustavo

On 11/05/20 06:37, Sandra Maksimovic wrote:
> Hi all,
> 
>  
> 
> I’m trying to install GDAL v3.1.0 with Proj v6.2.1 on CentOS 7.7. I am
> continually receiving the following error during the make step:
> 
>  
> 
> ../gdal.h:44:26: fatal error: gdal_version.h: No such file or directory
> 
> #include "gdal_version.h"
> 
>  
> 
> I have tried including the headers from the OS installed version of GDAL
> (v1.11.4) to no avail. Here is my configure line:
> 
>  
> 
> ./configure --prefix=$PREFIX --with-proj=$PROJDIR
> --includedir=/usr/include/gdal --with-threads --with-libtiff=internal
> --with-geotiff=internal --with-jpeg=internal --with-gif=internal
> --with-png=internal --with-libz=internal
> 
>  
> 
> Any ideas?
> 
>  
> 
> Thanks,
> 
>  
> 
> *Sandra Maksimovic*
> 
> Systems Administrator
> 
> Information Technology
> 
>  
> 
> *Murdoch Children’s Research Institute*
> 
> The Royal Children’s Hospital, 50 Flemington Road
> 
> Parkville, Victoria 3052 Australia
> 
>  
> 
> *T    *+61 3 8341 6498
> 
> *E    *sandra.maksimovic at mcri.edu.au <mailto:sandra.maksimovic at mcri.edu.au>
> 
> *W   *mcri.edu.au <https://www.mcri.edu.au/>
> 
>  
> 
> 
> 
> This e-mail and any attachments to it (the "Communication") are, unless
> otherwise stated, confidential, may contain copyright material and is
> for the use only of the intended recipient. If you receive the
> Communication in error, please notify the sender immediately by return
> e-mail, delete the Communication and the return e-mail, and do not read,
> copy, retransmit or otherwise deal with it. Any views expressed in the
> Communication are those of the individual sender only, unless expressly
> stated to be those of Murdoch Children’s Research Institute (MCRI) ABN
> 21 006 566 972 or any of its related entities. MCRI does not accept
> liability in connection with the integrity of or errors in the
> Communication, computer virus, data corruption, interference or delay
> arising from or in respect of the Communication.
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/

From rajeshreddy82 at gmail.com  Mon May 11 22:14:49 2020
From: rajeshreddy82 at gmail.com (rmaddu .)
Date: Tue, 12 May 2020 10:44:49 +0530
Subject: [gdal-dev] Vector Tile Service
Message-ID: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>

I need some help on usage of GDAL C# bindings to convert VRT to MVT. How do
I know that, below call is complete? We observed that below call is Async
(All the code lines are executed and Parent thread is waiting until the MVT
files/folders are created in disk). Is this correct?

I want to create a Vector Tile Service. My goal is to return the tile to
client once the tiles are generated. For this, whether the call is
completed or not? Below is the code, written in console app.

var options = new[]
      {
          "-f", "MVT",
          "-dsco", "TILE_EXTENSION=pbf",
          "-dsco", "MINZOOM=0",
          "-dsco", "MAXZOOM=10",
    };

      string input = @"C:\Temp\vrtfile.vrt";
      string output = @"C:\Temp\myMVTtiles";

using (
        Dataset ds = Gdal.OpenEx(input, 4, null, null, null))
      {
        var newDs = Gdal.wrapper_GDALVectorTranslateDestName (output, ds,
gdalOptions, new Gdal.GDALProgressFuncDelegate(ProgressFunc), null);
        newDs.FlushCache();
      }
    }


Regards,
Rajesh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/f3635ceb/attachment.html>

From sandra.maksimovic at mcri.edu.au  Mon May 11 22:20:08 2020
From: sandra.maksimovic at mcri.edu.au (Sandra Maksimovic)
Date: Tue, 12 May 2020 05:20:08 +0000
Subject: [gdal-dev] how to install gdal from source?
In-Reply-To: <f7f0eed1-a3bf-b3bf-b186-81cab7bee1b7@osgeopt.pt>
References: <D0A3132393C48A4A95D733EC22902B1203536F2FF6@MITSMXMBX02V.mcri.edu.au>
 <f7f0eed1-a3bf-b3bf-b186-81cab7bee1b7@osgeopt.pt>
Message-ID: <D0A3132393C48A4A95D733EC22902B1203536F4324@MITSMXMBX02V.mcri.edu.au>

Thanks Jorge,

It ended up being an unrelated POSIX permissions issue on the local file system, so it seems things were not executing correctly when making the source.

Cheers,
Sandra

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Jorge Gustavo Rocha
Sent: Monday, 11 May 2020 6:36 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] how to install gdal from source?

Hi Sandra,

Are you switch to gdal/gdal? You shouldn't have to add a includedir for
gdal. gdal_version.h is included in the code, at gcore/gdal_version.h

Here my recipe to compile gdal (on Ubuntu):

git clone https://github.com/OSGeo/gdal<https://github.com/OSGeo/gdal>
cd gdal/gdal
./autogen.sh
./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes
--with-poppler
make -j8
sudo make install
sudo ldconfig
cd swig/python
python3 setup.py build
sudo python3 setup.py install

I hope it helps. Regards,

Jorge Gustavo

On 11/05/20 06:37, Sandra Maksimovic wrote:
> Hi all,
>
>
>
> I’m trying to install GDAL v3.1.0 with Proj v6.2.1 on CentOS 7.7. I am
> continually receiving the following error during the make step:
>
>
>
> ../gdal.h:44:26: fatal error: gdal_version.h: No such file or directory
>
> #include "gdal_version.h"
>
>
>
> I have tried including the headers from the OS installed version of GDAL
> (v1.11.4) to no avail. Here is my configure line:
>
>
>
> ./configure --prefix=$PREFIX --with-proj=$PROJDIR
> --includedir=/usr/include/gdal --with-threads --with-libtiff=internal
> --with-geotiff=internal --with-jpeg=internal --with-gif=internal
> --with-png=internal --with-libz=internal
>
>
>
> Any ideas?
>
>
>
> Thanks,
>
>
>
> *Sandra Maksimovic*
>
> Systems Administrator
>
> Information Technology
>
>
>
> *Murdoch Children’s Research Institute*
>
> The Royal Children’s Hospital, 50 Flemington Road
>
> Parkville, Victoria 3052 Australia
>
>
>
> *T    *+61 3 8341 6498
>
> *E    *sandra.maksimovic at mcri.edu.au<mailto:*sandra.maksimovic at mcri.edu.au> <mailto:sandra.maksimovic at mcri.edu.au>
>
> *W   *mcri.edu.au <https://www.mcri.edu.au/<https://www.mcri.edu.au>>
>
>
>
>
>
> This e-mail and any attachments to it (the "Communication") are, unless
> otherwise stated, confidential, may contain copyright material and is
> for the use only of the intended recipient. If you receive the
> Communication in error, please notify the sender immediately by return
> e-mail, delete the Communication and the return e-mail, and do not read,
> copy, retransmit or otherwise deal with it. Any views expressed in the
> Communication are those of the individual sender only, unless expressly
> stated to be those of Murdoch Children’s Research Institute (MCRI) ABN
> 21 006 566 972 or any of its related entities. MCRI does not accept
> liability in connection with the integrity of or errors in the
> Communication, computer virus, data corruption, interference or delay
> arising from or in respect of the Communication.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://lists.osgeo.org/mailman/listinfo/gdal-dev>
>

--
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt<mailto:geral at osgeopt.pt>
https://www.osgeopt.pt/<https://www.osgeopt.pt>

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/<http://osgeopt.pt/sasig2017>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev<https://lists.osgeo.org/mailman/listinfo/gdal-dev>

Disclaimer

This e-mail and any attachments to it (the "Communication") are, unless otherwise stated, confidential, may contain copyright material and is for the use only of the intended recipient. If you receive the Communication in error, please notify the sender immediately by return e-mail, delete the Communication and the return e-mail, and do not read, copy, retransmit or otherwise deal with it. Any views expressed in the Communication are those of the individual sender only, unless expressly stated to be those of Murdoch Children’s Research Institute (MCRI) ABN 21 006 566 972 or any of its related entities. MCRI does not accept liability in connection with the integrity of or errors in the Communication, computer virus, data corruption, interference or delay arising from or in respect of the Communication.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/84a2b551/attachment-0001.html>

From ari.jolma at gmail.com  Tue May 12 02:25:58 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 12 May 2020 12:25:58 +0300
Subject: [gdal-dev] Vector Tile Service
In-Reply-To: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
References: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
Message-ID: <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>

rmaddu,

VRT is raster format and MVT is vector format, so they are incompatible 
without raster to vector transformation. So, I think there's something 
missing from your problem statement.

Best,

Ari

rmaddu . kirjoitti 12.5.2020 klo 8.14:
> I need some help on usage of GDAL C# bindings to convert VRT to MVT. 
> How do I know that, below call is complete? We observed that below 
> call is Async (All the code lines are executed and Parent thread is 
> waiting until the MVT files/folders are created in disk). Is this 
> correct?
>
> I want to create a Vector Tile Service. My goal is to return the tile 
> to client once the tiles are generated. For this, whether the call is 
> completed or not? Below is the code, written in console app.
>
> var options = new[]
> {
>     "-f", "MVT",
>     "-dsco", "TILE_EXTENSION=pbf",
>     "-dsco", "MINZOOM=0",
>     "-dsco", "MAXZOOM=10",
>     };
>
> string input = @"C:\Temp\vrtfile.vrt";
> string output = @"C:\Temp\myMVTtiles";
>
> using (
>   Dataset ds = Gdal.OpenEx(input, 4, null, null, null))
> {
>   var newDs = Gdal.wrapper_GDALVectorTranslateDestName (output, ds, 
> gdalOptions, new Gdal.GDALProgressFuncDelegate(ProgressFunc), null);
>   newDs.FlushCache();
> }
>     }
>
>
> Regards,
> Rajesh
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/b6c8c538/attachment.html>

From rajeshreddy82 at gmail.com  Tue May 12 03:28:35 2020
From: rajeshreddy82 at gmail.com (rmaddu)
Date: Tue, 12 May 2020 03:28:35 -0700 (MST)
Subject: [gdal-dev] Vector Tile Service
In-Reply-To: <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>
References: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
 <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>
Message-ID: <1589279315425-0.post@n6.nabble.com>

Hi,

We have "VRT - Virtual format" for Vectors also
(https://gdal.org/drivers/vector/vrt.html).

Using this format and with C# bindings, presently I am able to generate the
vector tiles in disk. My problem here is -

Presently I have written code in console, whenever I open this console
application and after few seconds tiles are generated in disk and console
window is closed. Manually I am waiting till the console close and checking
for my required tile. 

My server side requirement is, we will get multiple tile requests from
client. We have to write mutiple calls
"Gdal.wrapper_GDALVectorTranslateDestName" at a time. Question here is how
to track these threads. How do I know, particular thread is completed so
that I will check for a tile and return to client.

Please provide the suggestions. 

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ari.jolma at gmail.com  Tue May 12 04:01:09 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 12 May 2020 14:01:09 +0300
Subject: [gdal-dev] Vector Tile Service
In-Reply-To: <1589279315425-0.post@n6.nabble.com>
References: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
 <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>
 <1589279315425-0.post@n6.nabble.com>
Message-ID: <b371468b-ed48-55bb-055d-7e2fa29e6ad8@gmail.com>

I don't know about C#. In JavaScript I have a use case where I combine 
several single theme vector tiles into one multi theme tile each in its 
own thread async and then combine them before sending. I use the 
async.series method for that.

Ari

rmaddu kirjoitti 12.5.2020 klo 13.28:
> Hi,
>
> We have "VRT - Virtual format" for Vectors also
> (https://gdal.org/drivers/vector/vrt.html).
>
> Using this format and with C# bindings, presently I am able to generate the
> vector tiles in disk. My problem here is -
>
> Presently I have written code in console, whenever I open this console
> application and after few seconds tiles are generated in disk and console
> window is closed. Manually I am waiting till the console close and checking
> for my required tile.
>
> My server side requirement is, we will get multiple tile requests from
> client. We have to write mutiple calls
> "Gdal.wrapper_GDALVectorTranslateDestName" at a time. Question here is how
> to track these threads. How do I know, particular thread is completed so
> that I will check for a tile and return to client.
>
> Please provide the suggestions.
>
> Regards,
> Rajesh
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From rajeshreddy82 at gmail.com  Tue May 12 04:33:52 2020
From: rajeshreddy82 at gmail.com (rmaddu)
Date: Tue, 12 May 2020 04:33:52 -0700 (MST)
Subject: [gdal-dev] Vector Tile Service
In-Reply-To: <b371468b-ed48-55bb-055d-7e2fa29e6ad8@gmail.com>
References: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
 <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>
 <1589279315425-0.post@n6.nabble.com>
 <b371468b-ed48-55bb-055d-7e2fa29e6ad8@gmail.com>
Message-ID: <1589283232821-0.post@n6.nabble.com>

Hi,

Are you using GDAL binaries for vector tiles generation? Can you please
share the sample code?

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ari.jolma at gmail.com  Tue May 12 04:43:07 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Tue, 12 May 2020 14:43:07 +0300
Subject: [gdal-dev] Vector Tile Service
In-Reply-To: <1589283232821-0.post@n6.nabble.com>
References: <CAJt4Q0TH1cAfwMwMWrKuDZsthy1_Qig3h9TEEKDfDs-dEFpjMw@mail.gmail.com>
 <3a10ab9e-d046-0b73-500b-b19a74c4088f@gmail.com>
 <1589279315425-0.post@n6.nabble.com>
 <b371468b-ed48-55bb-055d-7e2fa29e6ad8@gmail.com>
 <1589283232821-0.post@n6.nabble.com>
Message-ID: <667d0a2a-7f2f-eb71-b389-c9e61c0a11d8@gmail.com>

Sorry, no. I'm using PostGIS via tilestrata-postgismvt. The code that 
combines the single-theme tiles it makes is mine, though. The 
tilestrata-postgismvt works under tilestrata, which works under express.

Ari

rmaddu kirjoitti 12.5.2020 klo 14.33:
> Hi,
>
> Are you using GDAL binaries for vector tiles generation? Can you please
> share the sample code?
>
> Regards,
> Rajesh
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From a09550 at gmail.com  Tue May 12 07:19:43 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Tue, 12 May 2020 16:19:43 +0200
Subject: [gdal-dev] Results of gdalwarp from UTM32 to EPSG:4326 are not
	aligned?
Message-ID: <CAJGa3-m0n5ODSxjJNRE07m1oeR5XXxsBm8d5CsFEQDt2Q_iXOQ@mail.gmail.com>

Hello,

I've a Sentinel 2 UTM32 scene (JPEG2000 format).

What I want to do is:

+ Warp this scene from UTM32 to EPSG:4326 by gdalwarp
gdalwarp T32UQD_20200421T102021_TCI_60m.jp2 -t_srs EPSG:4326 full_warp.tif

+ Clip a small subset of this file by gdal_translate
gdal_translate -projwin 798326.68347 5795956.80269 799609.577326
5794397.95642 T32UQD_20200421T102021_TCI_60m.jp2 crop.tif

Then warp this small subset also from UTM32 to EPSG:4326 by gdalwarp:

gdalwarp crop.tif -t_srs EPSG:4326 small_warp.tif -dstnodata 0

However, when I overlay the small_warp.tif on the full_warp.tif by
QGIS 2.14.9, I see the small file is not aligned on the big one.

Illustration: https://i.stack.imgur.com/U5Vql.png

What can be the reason for it?

More details given on this link:
https://gis.stackexchange.com/questions/361410/results-of-gdalwarp-from-utm32-to-epsg4326-are-not-aligned

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/d959775e/attachment-0001.html>

From even.rouault at spatialys.com  Tue May 12 08:18:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2020 17:18:26 +0200
Subject: [gdal-dev] Removal of API_PROXY mechanism: objections?
In-Reply-To: <2072127.vqHJZ2d2Pg@even-i700>
References: <2072127.vqHJZ2d2Pg@even-i700>
Message-ID: <2453647.OA0Ycbpa5W@even-i700>

On jeudi 7 mai 2020 20:53:15 CEST Even Rouault wrote:
> Hi,
> 
> https://github.com/OSGeo/gdal/pull/2489 kills the API_PROXY 
mechanism,
> which removes 7820 lines of code. Anyone objects ?

Hearing no objection, this PR has been merged

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/6c10ccd0/attachment.html>

From even.rouault at spatialys.com  Tue May 12 09:12:34 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2020 18:12:34 +0200
Subject: [gdal-dev] Results of gdalwarp from UTM32 to EPSG:4326 are not
	aligned?
In-Reply-To: <CAJGa3-m0n5ODSxjJNRE07m1oeR5XXxsBm8d5CsFEQDt2Q_iXOQ@mail.gmail.com>
References: <CAJGa3-m0n5ODSxjJNRE07m1oeR5XXxsBm8d5CsFEQDt2Q_iXOQ@mail.gmail.com>
Message-ID: <3574784.DPoRx6xCdY@even-i700>

On mardi 12 mai 2020 16:19:43 CEST Pham Huu Bang wrote:
> Hello,
> 
> I've a Sentinel 2 UTM32 scene (JPEG2000 format).
> 
> What I want to do is:
> 
> + Warp this scene from UTM32 to EPSG:4326 by gdalwarp
> gdalwarp T32UQD_20200421T102021_TCI_60m.jp2 -t_srs EPSG:4326 full_warp.tif
> 
> + Clip a small subset of this file by gdal_translate
> gdal_translate -projwin 798326.68347 5795956.80269 799609.577326
> 5794397.95642 T32UQD_20200421T102021_TCI_60m.jp2 crop.tif
> 
> Then warp this small subset also from UTM32 to EPSG:4326 by gdalwarp:
> 
> gdalwarp crop.tif -t_srs EPSG:4326 small_warp.tif -dstnodata 0
> 
> However, when I overlay the small_warp.tif on the full_warp.tif by
> QGIS 2.14.9, I see the small file is not aligned on the big one.
> 
> Illustration: https://i.stack.imgur.com/U5Vql.png
> 
> What can be the reason for it?

When you don't specify any target extent or resolution, gdalwarp guesses them from the 
input raster georeferencing and target SRS. It doesn't try to align on any particular resolution

You may want to use the -tr and -tap switches to specify a target resolution, and constraint 
the extents to be aligned on it.

Another reason for the misalignment is that you use the default nearest resampling. Using -r 
cubic could likely improve things

To get perfectly overlapping images, you may also need to specify -et 0

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/2f5f49f3/attachment.html>

From a09550 at gmail.com  Tue May 12 09:32:14 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Tue, 12 May 2020 18:32:14 +0200
Subject: [gdal-dev] Results of gdalwarp from UTM32 to EPSG:4326 are not
	aligned?
In-Reply-To: <3574784.DPoRx6xCdY@even-i700>
References: <CAJGa3-m0n5ODSxjJNRE07m1oeR5XXxsBm8d5CsFEQDt2Q_iXOQ@mail.gmail.com>
 <3574784.DPoRx6xCdY@even-i700>
Message-ID: <CAJGa3-mnugPF3SGYJ-D_kjiuVR1p-s+fDJ0d_ZjyKGPu2BqwvA@mail.gmail.com>

Thanks Even,

I managed to make them aligned (illustration:
https://i.imgur.com/1TwmVMN.png) from your valuable suggestion with these 2
commands (-tr are used same for both gdapwarp and -tap option is the
critical):

gdalwarp -tr 0.0007161230037719291 -0.0007161230037719291
T32UQD_20200421T102021_TCI_60m.jp2 full_warp.tif -t_srs EPSG:4326
-dstnodata 0 -tap

gdalwarp -tr 0.0007161230037719291 -0.0007161230037719291 crop.tif
small_warp.tif -t_srs EPSG:4326 -dstnodata 0 -tap




On Tue, 12 May 2020 at 18:12, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 12 mai 2020 16:19:43 CEST Pham Huu Bang wrote:
>
> > Hello,
>
> >
>
> > I've a Sentinel 2 UTM32 scene (JPEG2000 format).
>
> >
>
> > What I want to do is:
>
> >
>
> > + Warp this scene from UTM32 to EPSG:4326 by gdalwarp
>
> > gdalwarp T32UQD_20200421T102021_TCI_60m.jp2 -t_srs EPSG:4326
> full_warp.tif
>
> >
>
> > + Clip a small subset of this file by gdal_translate
>
> > gdal_translate -projwin 798326.68347 5795956.80269 799609.577326
>
> > 5794397.95642 T32UQD_20200421T102021_TCI_60m.jp2 crop.tif
>
> >
>
> > Then warp this small subset also from UTM32 to EPSG:4326 by gdalwarp:
>
> >
>
> > gdalwarp crop.tif -t_srs EPSG:4326 small_warp.tif -dstnodata 0
>
> >
>
> > However, when I overlay the small_warp.tif on the full_warp.tif by
>
> > QGIS 2.14.9, I see the small file is not aligned on the big one.
>
> >
>
> > Illustration: https://i.stack.imgur.com/U5Vql.png
>
> >
>
> > What can be the reason for it?
>
>
>
> When you don't specify any target extent or resolution, gdalwarp guesses
> them from the input raster georeferencing and target SRS. It doesn't try to
> align on any particular resolution
>
>
>
> You may want to use the -tr and -tap switches to specify a target
> resolution, and constraint the extents to be aligned on it.
>
>
>
> Another reason for the misalignment is that you use the default nearest
> resampling. Using -r cubic could likely improve things
>
>
>
> To get perfectly overlapping images, you may also need to specify -et 0
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>


-- 

*Bang Pham Huu *
*-------------------------------------------------------------------------------------*
*Master of Science - Research Assistant at Field Monitoring Center - 4 F,
E3 BuildingViet Nam - Ha Noi National University - University of
Engineering and Technology*
*Email: a09550 at gmail.com <a09550 at gmail.com> - Tel: +84 164.6339.217*

*“Life is like riding a bicycle. To keep your balance, you must keep
moving.”― Albert Einstein*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/ce92552c/attachment.html>

From eadam at co.lincoln.or.us  Tue May 12 12:09:04 2020
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Tue, 12 May 2020 12:09:04 -0700
Subject: [gdal-dev] Appending to a single feature class in a gdb via
	ogr2ogr
In-Reply-To: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
References: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
Message-ID: <CACqBkM91Uy4eSpGTcS-m37VtucBCfyL4FmtTbc+DDBfTeywh9Q@mail.gmail.com>

Hi Maggie,

On Mon, Apr 27, 2020 at 9:03 AM Maggie Wooten <mwoo391 at gmail.com> wrote:
>
> First, I apologize if I am using this mailing list improperly. This is my first time here.

Asking questions is an appropriate use of the list.

>
> I am trying to iterate over some shapefiles (109 shapefiles to be exact) and append them to a *single* feature class in an output geodatabase, but the resulting output geodatabase is one with 100 feature classes that looks like this:
>

Do all the shapefiles have (exactly) the same fields?  If not, it
probably won't work.

> INFO: Open of `output.gdb' using driver `FileGDB' successful.
> 1: output (Multi Polygon)
> 2: output_1 (Multi Polygon)
> 3: output_1_2 (Multi Polygon)
> 4: output_1_2_3 (Multi Polygon)
> 5: output_1_2_3_4 (Multi Polygon)
> .....
> 99: output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_98 (Multi Polygon)
> 100: output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_99 (Multi Polygon)
>
>
> These are the commands I'm running in the iteration:
>
> if i == 0: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -f "FileGDB" output.gdb input1.shp"
>
> else: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -update -append -f "FileGDB" output.gdb inputX.shp"
>
>
> What am I doing wrong here? How can I get the desired result? I tried a bunch of different things and flags and still could not get it all to append to one feature class. Any advice would be greatly appreciated and I'd be happy to provide whatever information may be necessary.
>
I'm not quite sure what is going wrong there.  I didn't try with an
output of FileGDB but did something similar all with shapefiles.  The
final resulting combined shapefile could probably be manually
ogr2ogr'ed into a FileGDB.

I did this on Ubuntu using Bash.  If you're using a different shell,
you will need different command syntax.  Specifically variables,
filenames without extensions, quoting, escape characters and other
things all need adjustment.  Complicated filenames with spaces or
other symbols can make this more difficult too.

mkdir merged

This is to make an "empty" shapefile with the correct fields and types
and an additional field named s_file to put the source file name in
later:
ogr2ogr -sql "select *, '' as s_file from
Surveys_Invalid_ManualFix_7of7 where SURVEYID='fake'"
merged/surveys_v1.shp Surveys_Invalid_ManualFix_7of7.shp -nln
surveys_v1

This is to check that my empty shapefile turned out okay:
ogrinfo merged/surveys_v1.shp -al

(I worked in a directory where I was selecting ALL the shapefiles, all
of which have the same fields):
FILES=*.shp

for f in $FILES; do g=${f%%.*}; ogr2ogr -sql "select *, '$g' as s_file
from $g" -update -append merged/surveys_v1.shp $f -nln surveys_v1;
done

This is to check that my shapefile is no longer empty and turned out okay:
ogrinfo merged/surveys_v1.shp -al

If you are using DOS on windows, here is a note (untested) from some
previous work.  I don't have windows readily available to test it (the
% might need to be %%):

for %f in (*.shp) do ogr2ogr -sql "select *, '%~nf' as s_file from
%~nf" -update -append merged\output.shp %f -nln output


Hope that helps.

Best regards, Eli

> Thank you!
> Ma
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Tue May 12 14:10:19 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2020 23:10:19 +0200
Subject: [gdal-dev] Appending to a single feature class in a gdb via
	ogr2ogr
In-Reply-To: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
References: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
Message-ID: <7668191.2AGE9qqlLk@even-i700>

On lundi 27 avril 2020 12:02:57 CEST Maggie Wooten wrote:
> First, I apologize if I am using this mailing list improperly. This is my
> first time here.
> 
> I am trying to iterate over some shapefiles (109 shapefiles to be exact)
> and append them to a *single* feature class in an output geodatabase, but
> the resulting output geodatabase is one with 100 feature classes that looks
> like this:
> 
> INFO: Open of `output.gdb' using driver `FileGDB' successful.
> 1: output (Multi Polygon)
> 2: output_1 (Multi Polygon)
> 3: output_1_2 (Multi Polygon)
> 4: output_1_2_3 (Multi Polygon)
> 5: output_1_2_3_4 (Multi Polygon)
> .....
> 99:
> output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_
> 27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_98 (Multi Polygon)
> 100:
> output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_
> 27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_99 (Multi Polygon)
> 
> 
> These are the commands I'm running in the iteration:
> 
> if i == 0: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -f
> "FileGDB" output.gdb input1.shp"
> 
> else: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -update
> -append -f "FileGDB" output.gdb inputX.shp"
> 
> 
> What am I doing wrong here?

I'm not sure. I've just tried to replicate your issue with:

ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -f "FileGDB" output.gdb  poly1.shp
ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -update -append -f "FileGDB" 
output.gdb poly2.shp

and I get a single 'output' layer in the GDB with the features of the 2 input layers 
concatenated. This is with GDAL 3.1/master and FileGDB SDK 1.5.1

Looking at the driver code, I can see a layer renaming strategy, but that shouldn't normally be 
triggered with the -update -output flag of ogr2ogr. And my understanding of that renaming 
strategy is that it should rather result in names like output, output_1, output_2, etc. 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/426c9166/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue May 12 14:21:30 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 12 May 2020 21:21:30 +0000
Subject: [gdal-dev] OAPIF and apikey
Message-ID: <8430039b96354d6582cbab8648742f75@C119S212VM042.msvyvi.vaha.local>

Hi,

I wonder how I could deal with an OGC API Features service that requires to use apikey as an extra parameter in each request. First step is easy because I can just add the apikey parameter to the URL of the landing page (?api-key=xxxyyyzzzkkk) but the link to collections in the document that is returned comes without the apikey and ogrinfo and og2ogr are using the link as is. Result is a "HTTP 401 not authorized".

OAPIF supports USERPWD and I found that various vsi systems have service specific configuration options https://gdal.org/user/virtual_file_systems.html. WFS driver https://gdal.org/drivers/vector/wfs.html supports UserPwd and COOKIE. WMS driver supports also UserPwd but I did not find any example of concatenating base URLs with extra parameters.

I think that the WMS driver could also benefit from extra parameters which would be added to GetMaps because WMS servers support quite nice features with their own vendor options.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/71dd6417/attachment.html>

From even.rouault at spatialys.com  Tue May 12 14:50:57 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 12 May 2020 23:50:57 +0200
Subject: [gdal-dev] OAPIF and apikey
In-Reply-To: <8430039b96354d6582cbab8648742f75@C119S212VM042.msvyvi.vaha.local>
References: <8430039b96354d6582cbab8648742f75@C119S212VM042.msvyvi.vaha.local>
Message-ID: <42981841.noiLIxh4o7@even-i700>

On mardi 12 mai 2020 21:21:30 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I wonder how I could deal with an OGC API Features service that requires to
> use apikey as an extra parameter in each request. First step is easy
> because I can just add the apikey parameter to the URL of the landing page
> (?api-key=xxxyyyzzzkkk) but the link to collections in the document that is
> returned comes without the apikey and ogrinfo and og2ogr are using the link
> as is. Result is a "HTTP 401 not authorized".

Hum, normally there's code to handle that in the driver. And even a test (against a 
stub server).
Are you using GDAL 3.1 / master ? If so, how can I replicate that ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200512/cc9a8e3d/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed May 13 01:59:18 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 13 May 2020 08:59:18 +0000
Subject: [gdal-dev] OAPIF and apikey
Message-ID: <5290c1d0e515422e9bfdd2910ef493cc@C119S212VM042.msvyvi.vaha.local>

Even Rouault wrote:

> On mardi 12 mai 2020 21:21:30 CEST Rahkonen Jukka (MML) wrote:
>> Hi,
>> 
>> I wonder how I could deal with an OGC API Features service that requires to
>> use apikey as an extra parameter in each request. First step is easy
>> because I can just add the apikey parameter to the URL of the landing page
>> (?api-key=xxxyyyzzzkkk) but the link to collections in the document that is
>> returned comes without the apikey and ogrinfo and og2ogr are using the link
>> as is. Result is a "HTTP 401 not authorized".
 
> Hum, normally there's code to handle that in the driver. And even a test (against a stub server).
> Are you using GDAL 3.1 / master ? If so, how can I replicate that ?

There was a misconfiguration on the server side yesterday and it did not work. Now the configuration is corrected and apikey is indeed added. That certain server will be opened within a few weeks but extra parameters can be tested with any OAPIF server.
 
ogrinfo oapif:"https://beta-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1?apikey=111222" hylky --debug on
HTTP: Fetch(https://beta-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/hylky/items?limit=10&apikey=111222)

There is a small glitch with GDAL and the new service. On the contrary to what I wrote yesterday, the new service, when it is configured right, adds the api-key that is used for accessing the landing page into the links. Now GDAL is picking the links which contain api-key parameter and adds api-key again from the connection URL. The result looks like this:

HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/hylky/items?next=MDoxMTY%3D&api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880&limit=10&api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880)

Duplicated api-key does not make trouble for our server because the values are equal. The next test with two duplicated parameters reveals that our server is using the first KVP parameter.

ogrinfo oapif:"https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/?api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880&limit=5" hylky --debug on

The generated requests contain &limit=10 and &limit=5 and value 10 is used.
HTTP: Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/v1/collections/hylky/items?next=MDoxMzk%3D&api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880&limit=10&api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880&limit=5)

This leads to next question: Is there a way to run ogrinfo for a small sample of OAPIF collection that can contain millions of features? I can set the page size (limit) with an open option but ogrinfo follows the "next" links until the end of data. I can use ogr2ogr with the -limit option as a quite effective workaround  because ogr2ogr seems to read just as many pages from OAPIF that are needed to reach the desired count.  Ogrinfo with -sql "select * from oapif_layer limit 3" is a poor workaround because filtering happens after the whole collection is fetched. I would rather see something like OAPIF open option like "hard_limit/count/maxfeatures" that sets the standard OAPIF parameter &limit= and does not follow the next links.

Finally, I think that the default page_size could be increased to 1000 from the default that is 10.

-Jukka-

From even.rouault at spatialys.com  Wed May 13 02:28:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 13 May 2020 11:28:26 +0200
Subject: [gdal-dev] OAPIF and apikey
In-Reply-To: <5290c1d0e515422e9bfdd2910ef493cc@C119S212VM042.msvyvi.vaha.local>
References: <5290c1d0e515422e9bfdd2910ef493cc@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2064883.eYUOCompjD@even-i700>

> The generated requests contain &limit=10 and &limit=5 and value 10 is used.
> HTTP:
> Fetch(https://avoin-paikkatieto.maanmittauslaitos.fi/maastotiedot/features/
> v1/collections/hylky/items?next=MDoxMzk%3D&api-key=12be7903-e203-4836-9bd9-8
> cc6bdfcf880&limit=10&api-key=12be7903-e203-4836-9bd9-8cc6bdfcf880&limit=5)

Yes, there's no logic to de-duplicate KVP parameters. It just append any present in the 
connection string

> 
> This leads to next question: Is there a way to run ogrinfo for a small
> sample of OAPIF collection that can contain millions of features? I can set
> the page size (limit) with an open option but ogrinfo follows the "next"
> links until the end of data.

Apart Ctrl-C, no. Adding a -limit option to ogrinfo could also be done.

> Finally, I think that the default page_size could be increased to 1000 from
> the default that is 10.

The server can advertize a larger default page size in the API document. This was 
implemented in the QGIS OPAIF provider, but I see that it isn't in the OGR one. Anyway, 
servers seem to stick to the default 10 which was chosen in the standard. I presume this 
might be for HTML rendering. Or maybe just the result of a (dodecahedronal) die roll.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200513/01c627b8/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu May 14 00:39:03 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 14 May 2020 00:39:03 -0700 (MST)
Subject: [gdal-dev] Appending to a single feature class in a gdb via
 ogr2ogr
In-Reply-To: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
References: <CAB=GGNFT56e0cow26g2Jf+5ZUi6WLOfPT39hMYq3suoPEPkLXw@mail.gmail.com>
Message-ID: <1589441943140-0.post@n6.nabble.com>

Hi,

I do not program, but what if something unexpedted happens in your loop and
"i == 0:" is always true? Forget your code for a while and gather more
information with complete ogr2ogr commands like Even did. But I am
remembering that this has been asked before on gis.stackexchange and the
code worked fine when the target was GeoPackage,  do I remember right?

-Jukka Rahkonen-



Maggie Wooten wrote
> ...
> I am trying to iterate over some shapefiles (109 shapefiles to be exact)
> and append them to a *single* feature class in an output geodatabase, but
> the resulting output geodatabase is one with 100 feature classes that
> looks
> like this:
> 
> INFO: Open of `output.gdb' using driver `FileGDB' successful.
> 1: output (Multi Polygon)
> 2: output_1 (Multi Polygon)
> 3: output_1_2 (Multi Polygon)
> 4: output_1_2_3 (Multi Polygon)
> 5: output_1_2_3_4 (Multi Polygon)
> .....
> 99:
> output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_98
> (Multi Polygon)
> 100:
> output_1_2_3_4_5_6_7_8_9_10_11_12_13_14_15_16_17_18_19_20_21_22_23_24_25_26_27_28_29_30_31_32_33_34_35_36_37_38_39_40_41_42_43_44_45_99
> (Multi Polygon)
> 
> 
> These are the commands I'm running in the iteration:
> 
> if i == 0: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -f
> "FileGDB" output.gdb input1.shp"
> 
> else: "ogr2ogr -nln output -a_srs EPSG:4326 -t_srs EPSG:4326 -update
> -append -f "FileGDB" output.gdb inputX.shp"
> 
> 
> What am I doing wrong here? How can I get the desired result? I tried a
> bunch of different things and flags and still could not get it all to
> append to one feature class. Any advice would be greatly appreciated and
> I'd be happy to provide whatever information may be necessary.
> 
> Thank you!
> Ma
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jidanni at jidanni.org  Thu May 14 01:52:13 2020
From: jidanni at jidanni.org (Dan Jacobson)
Date: Thu, 14 May 2020 16:52:13 +0800
Subject: [gdal-dev] Gettin' started: WMTS -> gdal2tiles
Message-ID: <87blmqdhky.8.fsf@jidanni.org>

I have got this far:
$ wget https://maps.nlsc.gov.tw/OpenData/wmts
$ gdalinfo wmts

I want to use
$ gdal2tiles
on one of its layers, for a few km. wide rectangle, for offline browsing.

So I need to somehow save the tiles from WMTS, and then feed them into gdal2tiles.
Yes I read
https://gdal.org/drivers/raster/wmts.html
https://gdal.org/programs/gdal2tiles.html
but it is not clear what to do.

P.S., the data was found via
https://maps.nlsc.gov.tw/ > FAQ > Q: Are you offering Open Data?
Thanks.

From pda at geomaster.pt  Thu May 14 02:16:28 2020
From: pda at geomaster.pt (Paulo Dias Almeida)
Date: Thu, 14 May 2020 10:16:28 +0100
Subject: [gdal-dev] Problem building GDAL with Teigha ODA libraries
Message-ID: <62b64cfd-abcd-bdba-24c0-a8cbc19e1537@geomaster.pt>

Hello,

I was wondering if you could help with a problem I encountered when 
building GDAL with the Open Design Alliance Libraries (ODA >= 2021) on 
Linux.

I've been trying to build GDAL with ODA version 2021.2 based on the 
changes made to build on Windows in the following commit 
<https://github.com/OSGeo/gdal/commit/44ce5be4c043eea2fb2bc719858fb62285a5cc03>.

Following those changes I've edited the configure and dwg's GNUmakefile 
as seen in the attached diff. However I've run into a linking problem 
that I haven't been able to solve. Namely when building the 'gdalinfo' 
target I'm getting several 'undefined reference' errors with the built 
libgdal.so:

...

/bin/bash /home/paulo/Dev/gdal/gdal/libtool --mode=link --silent g++  
gdalinfo_bin.lo  /home/paulo/Dev/gdal/gdal/libgdal.la  -o gdalinfo
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgHostAppServices::program()'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`pcre_study'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgFontTable::getFont(unsigned int) const'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgDatabase::getNamedViewTable(OdDg::OpenMode) const'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgGraphicsElementPE::desc()'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgElement::elementId() const'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgArc2d::desc()'
/home/paulo/Dev/gdal/gdal/.libs/libgdal.so: undefined reference to 
`OdDgHostAppServices::getThumbnail(OdString const&, OdBinaryData&)'

...

collect2: error: ld returned 1 exit status
GNUmakefile:90: recipe for target 'gdalinfo' failed
make[1]: *** [gdalinfo] Error 1


The configure command used for this build was the following:

./configure --with-python=python3 --with-proj=/usr/local --with-pg=yes 
--with-teigha=/home/paulo/Dev/oda/21.2/Drawings_lnxX64_7.2dll 
--with-teigha-krl=/home/paulo/Dev/oda/21.2/Kernel_lnxX64_7.2dll 
--with-teigha-plt=lnxX64_7.2dll

If you could give some insights about this problem it would be greatly 
appreciated.

Regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/e4acd4a2/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: oda.diff
Type: text/x-patch
Size: 2822 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/e4acd4a2/attachment.bin>

From even.rouault at spatialys.com  Thu May 14 02:28:50 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2020 11:28:50 +0200
Subject: [gdal-dev] Problem building GDAL with Teigha ODA libraries
In-Reply-To: <62b64cfd-abcd-bdba-24c0-a8cbc19e1537@geomaster.pt>
References: <62b64cfd-abcd-bdba-24c0-a8cbc19e1537@geomaster.pt>
Message-ID: <49697506.ts59T1v9K9@even-i700>

Paulo,

> I was wondering if you could help with a problem I encountered when
> building GDAL with the Open Design Alliance Libraries (ODA >= 2021) on
> Linux.

Linking against ODA libs is always a pain. What I did to get Windows build working is to grep 
for symbols names in the .lib to find which one where exposing the missing symbols that 
were reported when linking GDAL. You could probably do the same on the Linux ODA .so, or 
use objdump -TC on the .so to have the demangled C++ symbols

When you are doing trial & error, you can directly edit GDALmake.opt to speed up the 
process (instead of patching configure and re-run it)

For pcre_study, you need -lpcre. But that should normally already be in the linking line if 
libpcre is available (libpcre-dev package on Ubuntu)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/5a5dfad7/attachment.html>

From camila at labsid.eng.br  Thu May 14 06:31:41 2020
From: camila at labsid.eng.br (Camila)
Date: Thu, 14 May 2020 10:31:41 -0300
Subject: [gdal-dev] Gdal python - gpkg driver creation options
Message-ID: <CAC3p_CHXwaiROybTB_We-fphDRUO2s-SpeJ7SQMDDUdp=CWVKw@mail.gmail.com>

Hi
This is my first time using the mailing list, I apologize if this question
is out of place.
I am using python 3.6, with gdal python api version 3.6.0

I am working with pcraster framework, and need to store the resulting
simulation files in a geopackage. I found the best way to do this is by
converting the pcr object output to numpy array, and store the numpy array
directly to gpkg file using:

    creationOptions = ['TILE_FORMAT=PNG', 'APPEND_SUBDATASET=YES',
'PRECISION=0', str('RASTER_TABLE='+str(raster_table))]
    outputType= gdal.GDT_Float32
    driver = gdal.GetDriverByName('GPKG')
    outDs = driver.Create(outpath, cols, rows, 1, outputType, options =
creationOptions)
    outBand = outDs.GetRasterBand(1)
    outBand.SetNoDataValue(-999)
    outBand.WriteArray(numpy_array)  # this is where I store my np arrays
    outDs.SetGeoTransform(trans)
    ds = None
    outDs = None

the rows and cols are based on a file I'm using as reference, the output
type
Issues I found:
1) I'm using the option "Tile format = PNG" because I found this option to
be more effective to compress the final output files, I'm working with
about 6000 outputs / Is that actual right, or there is another way to have
tiff files compressed effectively with output data format as Float32?
2) As I said I am working with more than 6000 simulation outputs.. I found
that my final gpkg created file has a limit of 1000 layers... Is that a
default creation option?? How can I make sure my final gpkg file store all
the layers?
3) What is the best way to access a certain via gdal python api the gpkg
layers? Or is best to access the individual layer using sqlite3 lib? I use
the following script to view list the raster tables, but I want to access a
certain layer individually
ds = gdal.OpenEx('my.gpkg')
x = ds.GetMetadata_List('SUBDATASETS')


Thank you!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/61668a03/attachment-0001.html>

From camila at labsid.eng.br  Thu May 14 06:32:41 2020
From: camila at labsid.eng.br (Camila)
Date: Thu, 14 May 2020 10:32:41 -0300
Subject: [gdal-dev] Gdal python - gpkg driver creation options
In-Reply-To: <CAC3p_CHXwaiROybTB_We-fphDRUO2s-SpeJ7SQMDDUdp=CWVKw@mail.gmail.com>
References: <CAC3p_CHXwaiROybTB_We-fphDRUO2s-SpeJ7SQMDDUdp=CWVKw@mail.gmail.com>
Message-ID: <CAC3p_CF8PwmBKEru5R7aV_zokYFhiO9XZvKWZvOpAM4Js4f3Bw@mail.gmail.com>

Sorry gdal python version 3.0.2 (not 3.6.0 my mistake)

Em qui., 14 de mai. de 2020 às 10:31, Camila <camila at labsid.eng.br>
escreveu:

> Hi
> This is my first time using the mailing list, I apologize if this question
> is out of place.
> I am using python 3.6, with gdal python api version 3.6.0
>
> I am working with pcraster framework, and need to store the resulting
> simulation files in a geopackage. I found the best way to do this is by
> converting the pcr object output to numpy array, and store the numpy array
> directly to gpkg file using:
>
>     creationOptions = ['TILE_FORMAT=PNG', 'APPEND_SUBDATASET=YES',
> 'PRECISION=0', str('RASTER_TABLE='+str(raster_table))]
>     outputType= gdal.GDT_Float32
>     driver = gdal.GetDriverByName('GPKG')
>     outDs = driver.Create(outpath, cols, rows, 1, outputType, options =
> creationOptions)
>     outBand = outDs.GetRasterBand(1)
>     outBand.SetNoDataValue(-999)
>     outBand.WriteArray(numpy_array)  # this is where I store my np arrays
>     outDs.SetGeoTransform(trans)
>     ds = None
>     outDs = None
>
> the rows and cols are based on a file I'm using as reference, the output
> type
> Issues I found:
> 1) I'm using the option "Tile format = PNG" because I found this option to
> be more effective to compress the final output files, I'm working with
> about 6000 outputs / Is that actual right, or there is another way to have
> tiff files compressed effectively with output data format as Float32?
> 2) As I said I am working with more than 6000 simulation outputs.. I found
> that my final gpkg created file has a limit of 1000 layers... Is that a
> default creation option?? How can I make sure my final gpkg file store all
> the layers?
> 3) What is the best way to access a certain via gdal python api the gpkg
> layers? Or is best to access the individual layer using sqlite3 lib? I use
> the following script to view list the raster tables, but I want to access a
> certain layer individually
> ds = gdal.OpenEx('my.gpkg')
> x = ds.GetMetadata_List('SUBDATASETS')
>
>
> Thank you!
>
>

-- 
*C**amila* *B**illerbeck*
Engenheira Civil
+55 11 3091-5403
+55 11 3091-5549
<camila at labsid.eng.br> <http://www.labsid.eng.br/>
<http://www.youtube.com/labsidengbr>
<https://www.facebook.com/labsid.eng.br>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/6fefaded/attachment.html>

From even.rouault at spatialys.com  Thu May 14 07:43:02 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 14 May 2020 16:43:02 +0200
Subject: [gdal-dev] Gdal python - gpkg driver creation options
In-Reply-To: <CAC3p_CHXwaiROybTB_We-fphDRUO2s-SpeJ7SQMDDUdp=CWVKw@mail.gmail.com>
References: <CAC3p_CHXwaiROybTB_We-fphDRUO2s-SpeJ7SQMDDUdp=CWVKw@mail.gmail.com>
Message-ID: <3951850.bR3llzdsYl@even-i700>

Camila,

> Issues I found:
> 1) I'm using the option "Tile format = PNG" because I found this option to
> be more effective to compress the final output files, I'm working with
> about 6000 outputs / Is that actual right, or there is another way to have
> tiff files compressed effectively with output data format as Float32?

This is probably the most effective option indeed. But not a lossless one, as when using PNG 
for Float32, data will be encoded on 16 bit with offset/scale

> 2) As I said I am working with more than 6000 simulation outputs.. I found
> that my final gpkg created file has a limit of 1000 layers... Is that a
> default creation option?? How can I make sure my final gpkg file store all
> the layers?

All layers should be stored, but this was a hardcoded limitation in the driver to avoid 
potential denial of service attacks. I've raised the limit to 10 000, consistently with vector 
layers, and also for consistency with them, make it configurable with the OGR_TABLE_LIMIT 
configuration option.

Fixed per
https://github.com/OSGeo/gdal/commit/3fb6bf8762d634610f7983b4e03760dbdc9e664d

> 3) What is the best way to access a certain via gdal python api the gpkg
> layers? Or is best to access the individual layer using sqlite3 lib? I use
> the following script to view list the raster tables, but I want to access a
> certain layer individually
> ds = gdal.OpenEx('my.gpkg')
> x = ds.GetMetadata_List('SUBDATASETS')

Use the value of the SUBDATASET_x_NAME metadate items as the connection string to get a 
raster.

The syntax is GPKG:the.gpkg:raster_table_name

This will overcome the limitation of 2) (even if layers you want to get accessed aren't 
currently listed)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/cfb45b1e/attachment.html>

From pda at geomaster.pt  Thu May 14 08:02:07 2020
From: pda at geomaster.pt (Paulo Dias Almeida)
Date: Thu, 14 May 2020 16:02:07 +0100
Subject: [gdal-dev] Problem building GDAL with Teigha ODA libraries
In-Reply-To: <49697506.ts59T1v9K9@even-i700>
References: <62b64cfd-abcd-bdba-24c0-a8cbc19e1537@geomaster.pt>
 <49697506.ts59T1v9K9@even-i700>
Message-ID: <4fd48de3-11a1-7bd0-c746-b5f6909976ba@geomaster.pt>

Thank you Even,

I will follow your advice and report progress.

Regards,

Paulo

Às 10:28 de 14/05/20, Even Rouault escreveu:
>
> Paulo,
>
> > I was wondering if you could help with a problem I encountered when
>
> > building GDAL with the Open Design Alliance Libraries (ODA >= 2021) on
>
> > Linux.
>
> Linking against ODA libs is always a pain. What I did to get Windows 
> build working is to grep for symbols names in the .lib to find which 
> one where exposing the missing symbols that were reported when linking 
> GDAL. You could probably do the same on the Linux ODA .so, or use 
> objdump -TC on the .so to have the demangled C++ symbols
>
> When you are doing trial & error, you can directly edit GDALmake.opt 
> to speed up the process (instead of patching configure and re-run it)
>
> For pcre_study, you need -lpcre. But that should normally already be 
> in the linking line if libpcre is available (libpcre-dev package on 
> Ubuntu)
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-- 
Email Signature
Logo <https://www.geomaster.pt> 	
*Geomaster*
*Paulo Dias Almeida* | Software Engineer
*e:* 	pda at geomaster.pt 	| 	*m:* 	+351 968 248 575
*g:* 	41.54094,-8.40490 	| 	*v: * 	510 906 109
*a: * 	Rua António Cândido Pinto N.º 67, 4715-400 Braga

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200514/da0f7abb/attachment-0001.html>

From rykovd at gmail.com  Fri May 15 10:23:30 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Fri, 15 May 2020 19:23:30 +0200
Subject: [gdal-dev] Setting up a source resolution for TMS
Message-ID: <CAJbvKNo7AhvKsrToKEi3cB34ELS8rbxjbtjb-=Se8K59yqEwaA@mail.gmail.com>

Hello,

I'm using gdal_translate to convert a certain area of TMS service (WMS
driver) to GeoTIFF. Is there a way to set up a zoom level for GDAL to be
used for building an image? By now GDAL picks zoom level with closest
resolution. For example, if I want to get image of 1 meter resolution (
"-tr 1 1") GDAL goes to zoom level that has 1.2 resolution. But it would be
great to have a way to pick a zoom level with resolution not lower than the
specified (0.6 in this case). Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200515/83ccaa5f/attachment.html>

From even.rouault at spatialys.com  Fri May 15 13:14:32 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 15 May 2020 22:14:32 +0200
Subject: [gdal-dev] Setting up a source resolution for TMS
In-Reply-To: <CAJbvKNo7AhvKsrToKEi3cB34ELS8rbxjbtjb-=Se8K59yqEwaA@mail.gmail.com>
References: <CAJbvKNo7AhvKsrToKEi3cB34ELS8rbxjbtjb-=Se8K59yqEwaA@mail.gmail.com>
Message-ID: <6541886.oetlxWV5em@even-i700>

On vendredi 15 mai 2020 19:23:30 CEST Denis Rykov wrote:
> Hello,
> 
> I'm using gdal_translate to convert a certain area of TMS service (WMS
> driver) to GeoTIFF. Is there a way to set up a zoom level for GDAL to be
> used for building an image? By now GDAL picks zoom level with closest
> resolution. For example, if I want to get image of 1 meter resolution (
> "-tr 1 1") GDAL goes to zoom level that has 1.2 resolution. But it would be
> great to have a way to pick a zoom level with resolution not lower than the
> specified (0.6 in this case). Thanks.

You can use the generic open option -oo OVERVIEW_LEVEL=x

If the full resolution is zoom_level=18, and you're interested in zoom_level=15, then x = (18 
- 15) - 1 = 2

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200515/cb1312a4/attachment.html>

From rykovd at gmail.com  Fri May 15 15:51:27 2020
From: rykovd at gmail.com (Denis Rykov)
Date: Sat, 16 May 2020 00:51:27 +0200
Subject: [gdal-dev] Setting up a source resolution for TMS
In-Reply-To: <6541886.oetlxWV5em@even-i700>
References: <CAJbvKNo7AhvKsrToKEi3cB34ELS8rbxjbtjb-=Se8K59yqEwaA@mail.gmail.com>
 <6541886.oetlxWV5em@even-i700>
Message-ID: <CAJbvKNrTsGGyVLR0s+Z5cqPgQ8UOo+zmXGS+zqhOg-N_A6DEfA@mail.gmail.com>

Great! Thank you. I also found out that the same result can be achieved
with gdalwarp and "-ovr" option.
Is there any advantages of using gdalwarp instead of gdal_translate to
convert partial extent of TMS service to an image if reprojection is not
required?

On Fri, May 15, 2020 at 10:14 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 15 mai 2020 19:23:30 CEST Denis Rykov wrote:
>
> > Hello,
>
> >
>
> > I'm using gdal_translate to convert a certain area of TMS service (WMS
>
> > driver) to GeoTIFF. Is there a way to set up a zoom level for GDAL to be
>
> > used for building an image? By now GDAL picks zoom level with closest
>
> > resolution. For example, if I want to get image of 1 meter resolution (
>
> > "-tr 1 1") GDAL goes to zoom level that has 1.2 resolution. But it would
> be
>
> > great to have a way to pick a zoom level with resolution not lower than
> the
>
> > specified (0.6 in this case). Thanks.
>
>
>
> You can use the generic open option -oo OVERVIEW_LEVEL=x
>
>
>
> If the full resolution is zoom_level=18, and you're interested in
> zoom_level=15, then x = (18 - 15) - 1 = 2
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200516/7885df65/attachment.html>

From even.rouault at spatialys.com  Sat May 16 04:29:23 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 May 2020 13:29:23 +0200
Subject: [gdal-dev] Setting up a source resolution for TMS
In-Reply-To: <CAJbvKNrTsGGyVLR0s+Z5cqPgQ8UOo+zmXGS+zqhOg-N_A6DEfA@mail.gmail.com>
References: <CAJbvKNo7AhvKsrToKEi3cB34ELS8rbxjbtjb-=Se8K59yqEwaA@mail.gmail.com>
 <6541886.oetlxWV5em@even-i700>
 <CAJbvKNrTsGGyVLR0s+Z5cqPgQ8UOo+zmXGS+zqhOg-N_A6DEfA@mail.gmail.com>
Message-ID: <1819380.nYYpjYi85g@even-i700>

On samedi 16 mai 2020 00:51:27 CEST Denis Rykov wrote:
> Great! Thank you. I also found out that the same result can be achieved
> with gdalwarp and "-ovr" option.

Yes, uses the same mechanism underneath

> Is there any advantages of using gdalwarp instead of gdal_translate to
> convert partial extent of TMS service to an image if reprojection is not
> required?

gdal_translate is generally faster than gdalwarp for operations that can be done 
by both.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200516/23380bcd/attachment.html>

From a.neumann at carto.net  Sat May 16 05:41:10 2020
From: a.neumann at carto.net (Andreas Neumann)
Date: Sat, 16 May 2020 14:41:10 +0200
Subject: [gdal-dev] self-compiled gdal linking to old already-remove proj
	libs
Message-ID: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>

Hi,

After my upgrade of Ubuntu 18.04 to 20.04 I am also renewing all my 
self-compiled "geo" libraries, such as proj, geos and gdal.

I removed old proj libs in /usr/local/lib then compiled and installed 
the  newest proj 7.0.1.

But now I am struggling with gdal - it always tries to link to old, 
already removed libproj versions. When I do

ldd /usr/local/lib/libgdal.so | grep proj

I get

         libproj.so.19 => /usr/local/lib/libproj.so.19 (0x00007fbaff612000)
         libproj.so.15 => /usr/lib/x86_64-linux-gnu/libproj.so.15 
(0x00007fbafd84e000)
         libproj.so.12 => not found

The libproj.so.12 was removed by me, libproj.so.19 and libproj.so.15 
probably came through some Ubuntu dependency.

How I can I tell the gdal configuration not to link to the already 
removed libproj.so.12 ? And maybe also ignore the libproj.so.15 version?

Thanks for any help!

Andreas


From even.rouault at spatialys.com  Sat May 16 07:11:43 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 May 2020 16:11:43 +0200
Subject: [gdal-dev] self-compiled gdal linking to old already-remove
	proj libs
In-Reply-To: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
References: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
Message-ID: <3409449.vjhBYfMlmm@even-i700>

Andreas,

Several advice:

- if you do several builds from the same checkout of GDAL that you refresh with "git pull", 
make sure to 'make clean' before rebuilding

- the multiple links to libproj.so.X probably come from other dependencies of GDAL that try 
to link against the older versions (libproj.so.12) or the system one (libproj.so.15). Spatialite is 
a typical candidate. You also need to rebuild them against the updated PROJ

- remove the libproj-dev package to minimize the risks of linking agains the system /usr/lib/
x86_64-linux-gnu/libproj.so.15 (or temporary do a rename of
/usr/lib/x86_64-linux-gnu/libproj.so to /usr/lib/x86_64-linux-gnu/libproj.so.disabled)

- due to the potentially big numbers of libraries GDAL link to, and some system paths being 
put in the linking line (-L/usr/lib/x86_64-linux-gnu ), you may want to edit GDALmake.opt 
after ./configure to remove manually occurences of "-L/usr/lib/x86_64-linux-gnu "

- in the LIBS = line (at line 36 of GDALmake.opt), you may replace the -lproj (that can be 
influenced by previous -L paths) with the direct .so name, e.g /usr/local/lib/libproj.so.19, to 
control precisely the lib you want to link against (but probably only works on a ./configure --
without-libool GDAL build)

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200516/9feedb4e/attachment-0001.html>

From jmckenna at gatewaygeomatics.com  Sat May 16 07:12:00 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sat, 16 May 2020 11:12:00 -0300
Subject: [gdal-dev] self-compiled gdal linking to old already-remove
 proj libs
In-Reply-To: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
References: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
Message-ID: <764c879b-1fb7-33b9-03ee-58eee03dc768@gatewaygeomatics.com>

Hi Andreas,

I have been in your exact situation before.  What's happening is that a 
GDAL dependency lib is still pointing to the old libproj version. 
Please check:

  ldd /usr/local/lib/libgdal.so | grep geotiff

     and then ldd to the exact path of the geotiff lib, and look at 
which libproj is linked to

and do the same for spatialite:

   ldd /usr/local/lib/libgdal.so | grep spatialite

      and then ldd to the exact path of the spatialite lib, and look at 
which libproj is linked to

I bet that is what happening in your case also.  If I am correct, then 
you have to recompile those libraries and point to PROJ in /usr/local/

Cheers from across the ocean.

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
http://gatewaygeo.com/




On 2020-05-16 9:41 a.m., Andreas Neumann wrote:
> Hi,
> 
> After my upgrade of Ubuntu 18.04 to 20.04 I am also renewing all my 
> self-compiled "geo" libraries, such as proj, geos and gdal.
> 
> I removed old proj libs in /usr/local/lib then compiled and installed 
> the  newest proj 7.0.1.
> 
> But now I am struggling with gdal - it always tries to link to old, 
> already removed libproj versions. When I do
> 
> ldd /usr/local/lib/libgdal.so | grep proj
> 
> I get
> 
>          libproj.so.19 => /usr/local/lib/libproj.so.19 (0x00007fbaff612000)
>          libproj.so.15 => /usr/lib/x86_64-linux-gnu/libproj.so.15 
> (0x00007fbafd84e000)
>          libproj.so.12 => not found
> 
> The libproj.so.12 was removed by me, libproj.so.19 and libproj.so.15 
> probably came through some Ubuntu dependency.
> 
> How I can I tell the gdal configuration not to link to the already 
> removed libproj.so.12 ? And maybe also ignore the libproj.so.15 version?
> 
> Thanks for any help!
> 
> Andreas
> 


From a.neumann at carto.net  Sat May 16 10:18:27 2020
From: a.neumann at carto.net (Andreas Neumann)
Date: Sat, 16 May 2020 19:18:27 +0200
Subject: [gdal-dev] self-compiled gdal linking to old already-remove
 proj libs
In-Reply-To: <764c879b-1fb7-33b9-03ee-58eee03dc768@gatewaygeomatics.com>
References: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
 <764c879b-1fb7-33b9-03ee-58eee03dc768@gatewaygeomatics.com>
Message-ID: <4a93b9a6-e026-7ede-c68a-7f9b0cde695e@carto.net>

Hi,

Thank you both Jeff and Even.

Yes, apparently libspatialite was also self-compiled. I can renew that. 
That was the one linking against non-existant old libproj.

For libgeotiff I used the packaged one, which links against 
/usr/lib/x86_64-linux-gnu/libproj.so.15

Is it a problem if libgeotiff links against a different libproj than 
gdal? Should I also self-compile libgeotiff?

Thanks for your help! It helps me to solve the compile and link issues.

Andreas

Am 16.05.20 um 16:12 schrieb Jeff McKenna:
> Hi Andreas,
>
> I have been in your exact situation before.  What's happening is that 
> a GDAL dependency lib is still pointing to the old libproj version. 
> Please check:
>
>  ldd /usr/local/lib/libgdal.so | grep geotiff
>
>     and then ldd to the exact path of the geotiff lib, and look at 
> which libproj is linked to
>
> and do the same for spatialite:
>
>   ldd /usr/local/lib/libgdal.so | grep spatialite
>
>      and then ldd to the exact path of the spatialite lib, and look at 
> which libproj is linked to
>
> I bet that is what happening in your case also.  If I am correct, then 
> you have to recompile those libraries and point to PROJ in /usr/local/
>
> Cheers from across the ocean.
>
> -jeff
>
>

From even.rouault at spatialys.com  Sat May 16 11:19:47 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 16 May 2020 20:19:47 +0200
Subject: [gdal-dev] self-compiled gdal linking to old already-remove
	proj libs
In-Reply-To: <4a93b9a6-e026-7ede-c68a-7f9b0cde695e@carto.net>
References: <ca8acd78-227d-6d7f-0826-a2875152d83d@carto.net>
 <764c879b-1fb7-33b9-03ee-58eee03dc768@gatewaygeomatics.com>
 <4a93b9a6-e026-7ede-c68a-7f9b0cde695e@carto.net>
Message-ID: <24104784.oETIhIa696@even-i700>

On samedi 16 mai 2020 19:18:27 CEST Andreas Neumann wrote:
> Hi,
> 
> Thank you both Jeff and Even.
> 
> Yes, apparently libspatialite was also self-compiled. I can renew that.
> That was the one linking against non-existant old libproj.
> 
> For libgeotiff I used the packaged one, which links against
> /usr/lib/x86_64-linux-gnu/libproj.so.15
> 
> Is it a problem if libgeotiff links against a different libproj than
> gdal? Should I also self-compile libgeotiff?

If your GDAL build is against the internal libgeotiff copy, then no problem.

If you have another library or binary that links both your GDAL build and the system 
libgeotiff, then you might get clashes at runtime due to the conflicting PROJ versions used 
by GDAL and system libgeotiff.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200516/fd8ec3fe/attachment.html>

From cmulershen at gmail.com  Mon May 18 01:19:10 2020
From: cmulershen at gmail.com (zs s)
Date: Mon, 18 May 2020 16:19:10 +0800
Subject: [gdal-dev] When use std::string OGRPoint::exportToWkt(),
	get a LNK2019 error on Windows
Message-ID: <CAMrRSDUvjawfk6AXwmwoY_WaRc8Yks7j=EKZnFbHViAyPTP9pg@mail.gmail.com>

Hi,

I am a newbie in c ++ and gdal.
I used the following command to compile gdal3.1.0 on windows successfully:

nmake -f makefile.vc MSVC_VER=1910 WIN64=1 GDAL_HOME=path\to\gdal_home
PROJ_INCLUDE=-IC:\OSGeo4W\include PROJ_LIBRARY=C:\OSGeo4W\lib\proj.lib
SQLITE_INC=-Ipath\to\sqlite\include
SQLITE_LIB=path\to\sqlite\lib\libsqlite3.lib devinstall

But when I use std::string OGRPoint::exportToWkt() function, and compiled,
get a LNK2019 error like that:

error LNK2019: unresolved external symbol "private: static int __cdecl
OGRWktOptions::getDefaultPrecision(void)"
(?getDefaultPrecision at OGRWktOptions@@CAHXZ)，referenced in function "public:
__cdecl OGRWktOptions::OGRWktOptions(void)" (??0OGRWktOptions@@QEAA at XZ)

my code:

#include <iostream>

#include <ogrsf_frmts.h>
#include <ogr_geometry.h>

int main()
{
GDALAllRegister();
CPLSetConfigOption("GDAL_FILENAME_IS_UTF8", "YES");

GDALDataset *dataset;
dataset = (GDALDataset *)GDALOpenEx("D:\\Point.shp", GDAL_OF_VECTOR,
nullptr, nullptr, nullptr);

if (dataset == nullptr)
{
std::cerr << "Open failed.\n";
exit(1);
}

OGRLayer *layer = dataset->GetLayer(0);

OGRFeature *feature;
layer->ResetReading();
while ((feature = layer->GetNextFeature()) != nullptr)
{

OGRGeometry *geom = feature->GetGeometryRef();

if (geom != nullptr)
{
const std::string wkt = geom->toPoint()->exportToWkt();

// std::cout << "GEOM: " << wkt << std::endl;
}
}

OGRFeature::DestroyFeature(feature);
GDALClose(dataset);

return 0;
}

CMakeLists.txt:

cmake_minimum_required(VERSION 3.17)

project(gdal-sample VERSION 1.0.0 LANGUAGES CXX)
set(CMAKE_CXX_STANDARD 11)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

find_package(GDAL REQUIRED)

add_executable(sample sample.cpp)

target_include_directories(sample PRIVATE ${GDAL_INCLUDE_DIR})

target_link_libraries(sample PRIVATE ${GDAL_LIBRARIES})

Am I doing something wrong?

thanks in advance!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/9ab048e6/attachment.html>

From even.rouault at spatialys.com  Mon May 18 01:51:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 May 2020 10:51:07 +0200
Subject: [gdal-dev] When use std::string OGRPoint::exportToWkt(),
	get a LNK2019 error on Windows
In-Reply-To: <CAMrRSDUvjawfk6AXwmwoY_WaRc8Yks7j=EKZnFbHViAyPTP9pg@mail.gmail.com>
References: <CAMrRSDUvjawfk6AXwmwoY_WaRc8Yks7j=EKZnFbHViAyPTP9pg@mail.gmail.com>
Message-ID: <1636415.R6GBgZSazk@even-i700>

On lundi 18 mai 2020 16:19:10 CEST zs s wrote:
> OGRWktOptions::OGRWktOptions

I believe this is due to the OGRWktOptions struct not being CPL_DLL 
exported. Temptative fix in https://github.com/OSGeo/gdal/pull/
2576

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/badd24cc/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 18 04:17:52 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 18 May 2020 11:17:52 +0000
Subject: [gdal-dev] Finnish KKJ and MapInfo MIF with GDAL 3.1
Message-ID: <ab7630657f524a319bcb9684636a98d1@C119S212VM042.msvyvi.vaha.local>

Hi,

This command
ogr2ogr -f "MapInfo file" -s_srs epsg:3067 -t_srs epsg:2393 2393.mif tm35.jml
writes into MIF
CoordSys Earth Projection 8, 104, "m", 27, 0, 1, 3500000, 0

ogrinfo shows

ogrinfo 2393.mif -al -so
INFO: Open of `2393.mif'
      using driver `MapInfo File' successful.

Layer name: 2393
Geometry: Unknown (any)
Feature Count: 3
Extent: (3284260.027390, 6962722.914217) - (3284610.369420, 6962941.953889)
Layer SRS WKT:
PROJCRS["unnamed",
    BASEGEOGCRS["unnamed",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1,
                    ID["EPSG",9001]]]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["degree",0.0174532925199433,
                ID["EPSG",9122]]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",0,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",27,
            ANGLEUNIT["degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",3500000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",0,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["easting",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["northing",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]
Data axis to CRS axis mapping: 1,2

When I convert this data back into EPSG:3067 the coordinates are shifted by a hundred meters probably because what was called towgs84 parameters are not applied. Parameters appear in the mitab source code https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrsf_frmts/mitab/mitab_spatialref.cpp#L251
{ 0,    1016,"Finnish_KKJ",                4, -96.062, -82.428, -121.754, -4.801, -0.345, 1.376, 1.496, 0},

I tried to fix the MIF by changing the CoordSys line into
CoordSys Earth Projection 24, 1016, "m", 27, 0, 1, 3500000, 0
that is to my knowledge what MapInfo itself is using but that does not work at all with GDAL

ogr2ogr -f "jml" -t_srs epsg:3067 2393_alt_from_mif.jml 2393_alt.mif
ERROR 1: PROJ: proj_as_proj_string: Unsupported conversion method: Transverse_Mercator_MapInfo_24
ERROR 6: Cannot find coordinate operations from `PROJCRS["unnamed",BASEGEOGCRS["unnamed",DATUM["Finnish_KKJ",ELLIPSOID["International 1924",6378388,297,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],PRIMEM["Greenwich",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]]],CONVERSION["unnamed",METHOD["Transverse_Mercator_MapInfo_24"],PARAMETER["latitude_of_origin",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARAMETER["central_meridian",27,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARAMETER["scale_factor",1,SCALEUNIT["unity",1,ID["EPSG",9201]]],PARAMETER["false_easting",3500000,LENGTHUNIT["metre",1,ID["EPSG",9001]]],PARAMETER["false_northing",0,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],CS[Cartesian,2],AXIS["easting",east,ORDER[1],LENGTHUNIT["metre",1,ID["EPSG",9001]]],AXIS["northing",north,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]]]' to `EPSG:3067'
ERROR 1: Failed to create coordinate transformation between the
following coordinate systems.  This may be because they
are not transformable.

Is there something that I could do for making the conversion to round-trip?

-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/156e7953/attachment-0001.html>

From Owen.Varley at inzpire.com  Mon May 18 05:32:05 2020
From: Owen.Varley at inzpire.com (Owen Varley)
Date: Mon, 18 May 2020 12:32:05 +0000
Subject: [gdal-dev] Odd Contours
Message-ID: <8de146800a31452bb35be5a8702985bc@VS1015934.inzpire.com>

Hi all,

I'm seeing some odd contour line points being generated from gdal_contour and I was wondering whether anything else might have seen something similar?

Using gdal_contour -i 15.24 -a height e100n00.dt2 n00.shp on the attached tile (Removed as too large) gives some contours which have points very close together. Take a look at the first three points in the contour line below, there are all < 0.1m of each other which, given the height posts are spaced at 30m's, seems very odd.

Contour Line (381m):
(100.1727777777963, 0.5436111111111112)
(100.17277777777778, 0.5436111111039885)
(100.17277777770833, 0.5436111111111112)
(100.1725, 0.5437345679012346)
(100.17222222222223, 0.5438518518518518)
(100.1720833332639, 0.5438888888888889)
(100.17222222222223, 0.5440277778472222)
(100.1724074074074, 0.5441666666666667)
(100.1725, 0.5442222222222222)
(100.17277777777778, 0.5443888888888889)
(100.17305555555556, 0.5442592592592592)
(100.17314814814816, 0.5441666666666667)
(100.1731944445139, 0.5438888888888889)
(100.17305555555556, 0.5438562091503267)
(100.1727777777963, 0.5436111111111112)

Related DTED height posts (m):
       [371, 374, 377, 380, 379, 379]
       [376, 379, 382, 385, 382, 379]
       [379, 383, 386, 390, 383, 379]
       [368, 368, 377, 381, 366, 375]
       [364, 357, 347, 342, 329, 345]


Has anyone seen this before or know what is going on? For the majority of other contours the contour points are at least 30m apart.

Kind regards,

Owen

[http://revolutionindefence.com/images/Logobannerwithwarning.png]
This email and any attachments to it may be confidential and are intended solely for the use of the individual to whom it is addressed. If you are not the intended recipient of this email, you must neither take any action based upon its contents, nor copy or show it to anyone. Please contact the sender if you believe you have received this email in error. Inzpire retains personal data relating to our customers and partners for the purposes of conducting a business relationship, communicating and marketing to them as well as to providing invitations to upcoming events. Please see our Privacy Notice <https://www.inzpire.com/privacy-cookie-policy/> for further information. In accordance with our Privacy Notice, you have the right to withdraw your consent at any time. Inzpire may monitor email traffic data and also the content of email for the purposes of security. Inzpire Limited (Registered in England & Wales: Company Number: 05456427) Registered office: Unit 1B, Alpha Court Business Park, Kingsley Road, Lincoln, LN6 3TA. https://www.inzpire.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/7cd0878f/attachment.html>

From even.rouault at spatialys.com  Mon May 18 06:13:10 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 May 2020 15:13:10 +0200
Subject: [gdal-dev] Finnish KKJ and MapInfo MIF with GDAL 3.1
In-Reply-To: <ab7630657f524a319bcb9684636a98d1@C119S212VM042.msvyvi.vaha.local>
References: <ab7630657f524a319bcb9684636a98d1@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2930865.H2Wh94DXzC@even-i700>

On lundi 18 mai 2020 11:17:52 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> This command
> ogr2ogr -f "MapInfo file" -s_srs epsg:3067 -t_srs epsg:2393 2393.mif
> tm35.jml writes into MIF
> CoordSys Earth Projection 8, 104, "m", 27, 0, 1, 3500000, 0
> 
> ogrinfo shows
> 
> ogrinfo 2393.mif -al -so
> INFO: Open of `2393.mif'
>       using driver `MapInfo File' successful.
> 
> Layer name: 2393
> Geometry: Unknown (any)
> Feature Count: 3
> Extent: (3284260.027390, 6962722.914217) - (3284610.369420, 6962941.953889)
> Layer SRS WKT:
> PROJCRS["unnamed",
>     BASEGEOGCRS["unnamed",
>         DATUM["World Geodetic System 1984",
>             ELLIPSOID["WGS 84",6378137,298.257223563,
>                 LENGTHUNIT["metre",1,
>                     ID["EPSG",9001]]]],
>         PRIMEM["Greenwich",0,
>             ANGLEUNIT["degree",0.0174532925199433,
>                 ID["EPSG",9122]]]],
>     CONVERSION["unnamed",
>         METHOD["Transverse Mercator",
>             ID["EPSG",9807]],
>         PARAMETER["Latitude of natural origin",0,
>             ANGLEUNIT["degree",0.0174532925199433],
>             ID["EPSG",8801]],
>         PARAMETER["Longitude of natural origin",27,
>             ANGLEUNIT["degree",0.0174532925199433],
>             ID["EPSG",8802]],
>         PARAMETER["Scale factor at natural origin",1,
>             SCALEUNIT["unity",1],
>             ID["EPSG",8805]],
>         PARAMETER["False easting",3500000,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8806]],
>         PARAMETER["False northing",0,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8807]]],
>     CS[Cartesian,2],
>         AXIS["easting",east,
>             ORDER[1],
>             LENGTHUNIT["metre",1,
>                 ID["EPSG",9001]]],
>         AXIS["northing",north,
>             ORDER[2],
>             LENGTHUNIT["metre",1,
>                 ID["EPSG",9001]]]]
> Data axis to CRS axis mapping: 1,2
> 
> When I convert this data back into EPSG:3067 the coordinates are shifted by
> a hundred meters probably because what was called towgs84 parameters are
> not applied. Parameters appear in the mitab source code
> https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrsf_frmts/mitab/mitab_
> spatialref.cpp#L251 { 0,    1016,"Finnish_KKJ",                4, -96.062,
> -82.428, -121.754, -4.801, -0.345, 1.376, 1.496, 0},
> 
> I tried to fix the MIF by changing the CoordSys line into
> CoordSys Earth Projection 24, 1016, "m", 27, 0, 1, 3500000, 0
> that is to my knowledge what MapInfo itself is using but that does not work
> at all with GDAL
> 
> ogr2ogr -f "jml" -t_srs epsg:3067 2393_alt_from_mif.jml 2393_alt.mif
> ERROR 1: PROJ: proj_as_proj_string: Unsupported conversion method:
> Transverse_Mercator_MapInfo_24 ERROR 6: Cannot find coordinate operations
> from
> `PROJCRS["unnamed",BASEGEOGCRS["unnamed",DATUM["Finnish_KKJ",ELLIPSOID["Int
> ernational
> 1924",6378388,297,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],PRIMEM["Greenwich
> ",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]]],CONVERSION["unn
> amed",METHOD["Transverse_Mercator_MapInfo_24"],PARAMETER["latitude_of_origin
> ",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARAMETER["centr
> al_meridian",27,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARA
> METER["scale_factor",1,SCALEUNIT["unity",1,ID["EPSG",9201]]],PARAMETER["fals
> e_easting",3500000,LENGTHUNIT["metre",1,ID["EPSG",9001]]],PARAMETER["false_n
> orthing",0,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],CS[Cartesian,2],AXIS["eas
> ting",east,ORDER[1],LENGTHUNIT["metre",1,ID["EPSG",9001]]],AXIS["northing",n
> orth,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]]]' to `EPSG:3067' ERROR
> 1: Failed to create coordinate transformation between the
> following coordinate systems.  This may be because they
> are not transformable.
> 
> Is there something that I could do for making the conversion to round-trip?

Temptative fix for both datum and projection code in
https://github.com/OSGeo/gdal/pull/2577

I presume the separate codes for the TMerc projection on KKJ and the regular one came 
from using the Snyder's tmerc formula vs using the extended one.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/1e3f1dc3/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon May 18 06:23:48 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 18 May 2020 13:23:48 +0000
Subject: [gdal-dev] Finnish KKJ and MapInfo MIF with GDAL 3.1
Message-ID: <0568dfb8ed0848f9a74b51362f4f8eab@C119S212VM042.msvyvi.vaha.local>

Thanks, Even.

EPSG:2393 is a Northing-Easting system and I read
    assert wkt == 'PROJCS["unnamed",GEOGCS["unnamed",DATUM["Kartastokoordinaattijarjestelma_1966",SPHEROID["International 1924",6378388,297]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["latitude_of_origin",0],PARAMETER["central_meridian",27],PARAMETER["scale_factor",1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["metre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH]]'

It is in the test and I don't know if it can make trouble for users.

-Jukka-

Lähettäjä: Even Rouault <even.rouault at spatialys.com>
Lähetetty: maanantai 18. toukokuuta 2020 16.13
Vastaanottaja: gdal-dev at lists.osgeo.org
Kopio: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Finnish KKJ and MapInfo MIF with GDAL 3.1


On lundi 18 mai 2020 11:17:52 CEST Rahkonen Jukka (MML) wrote:

> Hi,

>

> This command

> ogr2ogr -f "MapInfo file" -s_srs epsg:3067 -t_srs epsg:2393 2393.mif

> tm35.jml writes into MIF

> CoordSys Earth Projection 8, 104, "m", 27, 0, 1, 3500000, 0

>

> ogrinfo shows

>

> ogrinfo 2393.mif -al -so

> INFO: Open of `2393.mif'

> using driver `MapInfo File' successful.

>

> Layer name: 2393

> Geometry: Unknown (any)

> Feature Count: 3

> Extent: (3284260.027390, 6962722.914217) - (3284610.369420, 6962941.953889)

> Layer SRS WKT:

> PROJCRS["unnamed",

> BASEGEOGCRS["unnamed",

> DATUM["World Geodetic System 1984",

> ELLIPSOID["WGS 84",6378137,298.257223563,

> LENGTHUNIT["metre",1,

> ID["EPSG",9001]]]],

> PRIMEM["Greenwich",0,

> ANGLEUNIT["degree",0.0174532925199433,

> ID["EPSG",9122]]]],

> CONVERSION["unnamed",

> METHOD["Transverse Mercator",

> ID["EPSG",9807]],

> PARAMETER["Latitude of natural origin",0,

> ANGLEUNIT["degree",0.0174532925199433],

> ID["EPSG",8801]],

> PARAMETER["Longitude of natural origin",27,

> ANGLEUNIT["degree",0.0174532925199433],

> ID["EPSG",8802]],

> PARAMETER["Scale factor at natural origin",1,

> SCALEUNIT["unity",1],

> ID["EPSG",8805]],

> PARAMETER["False easting",3500000,

> LENGTHUNIT["metre",1],

> ID["EPSG",8806]],

> PARAMETER["False northing",0,

> LENGTHUNIT["metre",1],

> ID["EPSG",8807]]],

> CS[Cartesian,2],

> AXIS["easting",east,

> ORDER[1],

> LENGTHUNIT["metre",1,

> ID["EPSG",9001]]],

> AXIS["northing",north,

> ORDER[2],

> LENGTHUNIT["metre",1,

> ID["EPSG",9001]]]]

> Data axis to CRS axis mapping: 1,2

>

> When I convert this data back into EPSG:3067 the coordinates are shifted by

> a hundred meters probably because what was called towgs84 parameters are

> not applied. Parameters appear in the mitab source code

> https://github.com/OSGeo/gdal/blob/master/gdal/ogr/ogrsf_frmts/mitab/mitab_

> spatialref.cpp#L251 { 0, 1016,"Finnish_KKJ", 4, -96.062,

> -82.428, -121.754, -4.801, -0.345, 1.376, 1.496, 0},

>

> I tried to fix the MIF by changing the CoordSys line into

> CoordSys Earth Projection 24, 1016, "m", 27, 0, 1, 3500000, 0

> that is to my knowledge what MapInfo itself is using but that does not work

> at all with GDAL

>

> ogr2ogr -f "jml" -t_srs epsg:3067 2393_alt_from_mif.jml 2393_alt.mif

> ERROR 1: PROJ: proj_as_proj_string: Unsupported conversion method:

> Transverse_Mercator_MapInfo_24 ERROR 6: Cannot find coordinate operations

> from

> `PROJCRS["unnamed",BASEGEOGCRS["unnamed",DATUM["Finnish_KKJ",ELLIPSOID["Int

> ernational

> 1924",6378388,297,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],PRIMEM["Greenwich

> ",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]]],CONVERSION["unn

> amed",METHOD["Transverse_Mercator_MapInfo_24"],PARAMETER["latitude_of_origin

> ",0,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARAMETER["centr

> al_meridian",27,ANGLEUNIT["degree",0.0174532925199433,ID["EPSG",9122]]],PARA

> METER["scale_factor",1,SCALEUNIT["unity",1,ID["EPSG",9201]]],PARAMETER["fals

> e_easting",3500000,LENGTHUNIT["metre",1,ID["EPSG",9001]]],PARAMETER["false_n

> orthing",0,LENGTHUNIT["metre",1,ID["EPSG",9001]]]],CS[Cartesian,2],AXIS["eas

> ting",east,ORDER[1],LENGTHUNIT["metre",1,ID["EPSG",9001]]],AXIS["northing",n

> orth,ORDER[2],LENGTHUNIT["metre",1,ID["EPSG",9001]]]]' to `EPSG:3067' ERROR

> 1: Failed to create coordinate transformation between the

> following coordinate systems. This may be because they

> are not transformable.

>

> Is there something that I could do for making the conversion to round-trip?



Temptative fix for both datum and projection code in

https://github.com/OSGeo/gdal/pull/2577



I presume the separate codes for the TMerc projection on KKJ and the regular one came from using the Snyder's tmerc formula vs using the extended one.



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/3f7d3bb4/attachment-0001.html>

From even.rouault at spatialys.com  Mon May 18 06:35:19 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 18 May 2020 15:35:19 +0200
Subject: [gdal-dev] Finnish KKJ and MapInfo MIF with GDAL 3.1
In-Reply-To: <0568dfb8ed0848f9a74b51362f4f8eab@C119S212VM042.msvyvi.vaha.local>
References: <0568dfb8ed0848f9a74b51362f4f8eab@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1920815.Ifz1d6t5Fn@even-i700>

On lundi 18 mai 2020 13:23:48 CEST Rahkonen Jukka (MML) wrote:
> Thanks, Even.
> 
> EPSG:2393 is a Northing-Easting system and I read
>     assert wkt ==
> 'PROJCS["unnamed",GEOGCS["unnamed",DATUM["Kartastokoordinaattijarjestelma_1
> 966",SPHEROID["International
> 1924",6378388,297]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,
> AUTHORITY["EPSG","9122"]]],PROJECTION["Transverse_Mercator"],PARAMETER["lati
> tude_of_origin",0],PARAMETER["central_meridian",27],PARAMETER["scale_factor"
> ,1],PARAMETER["false_easting",3500000],PARAMETER["false_northing",0],UNIT["m
> etre",1,AUTHORITY["EPSG","9001"]],AXIS["Easting",EAST],AXIS["Northing",NORTH
> ]]'
> 
> It is in the test and I don't know if it can make trouble for users.

That should be fine. At least for reprojection purposes. On reading, the driver doesn't try to 
match with a EPSG CRS. It builds a custom SRS. So it can decide which axis order is fine (here 
the "traditional" one) and advertize it consistently in the data axis to CRS axis mapping

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200518/a99c9da7/attachment.html>

From E.Nash at dvz-mv.de  Tue May 19 02:49:58 2020
From: E.Nash at dvz-mv.de (Nash, Edward)
Date: Tue, 19 May 2020 09:49:58 +0000
Subject: [gdal-dev] GML xlink:href resolving: Any disadvantages to HUGE
	compared to NONE?
Message-ID: <8e81ccd1068d47bca9a273fcbe6a0cc7@dvz-mv.de>

Hi,

I've just been reading the description of GML_SKIP_RESOLVE_ELEMS on https://gdal.org/drivers/vector/gml.html#gml-xlink-resolving and the advantages of using HUGE compared to NONE are clearly listed. My question is whether there are any serious disadvantages, such that it would not be a reasonable strategy to always use HUGE instead of NONE for resolving all xlink:hrefs? The use is in the context of a QGIS plugin, where temporary files are no problem and SQLite is going to be available.

Thanks in advance!

Regards,

Edward Nash

--

Edward Nash
Sachgebiet Geoinformation
E-Mail  E.Nash at dvz-mv.de<mailto:E.Nash at dvz-mv.de>
Telefon: +49 385 4800 527
Telefax: +49 385 4800 98 527
Mobilfunk: +49 170 454 7434
Internet: www.dvz-mv.de<http://www.dvz-mv.de/>
_____________________________________

DVZ Datenverarbeitungszentrum
Mecklenburg-Vorpommern GmbH
Lübecker Str. 283 - 19059 Schwerin
Sitz der Gesellschaft: Schwerin | Eintrag im Handelsregister: HRB 187/ Amtsgericht Schwerin
Geschäftsführer:  Hubert Ludwig | Aufsichtsratsvorsitzender: Staatssekretärin Ina-Maria Ulbrich
_____________________________________

Allgemeine Datenschutzinformation: Der telefonische, schriftliche oder elektronische Kontakt ist ggf. mit der Speicherung und Verarbeitung der von Ihnen mitgeteilten persönlichen Daten verbunden. Sollte die DVZ M-V GmbH Daten von Ihnen erhalten, dann werden diese zweckbezogen erhoben und verarbeitet. Eine Datenverarbeitung zu anderen Zwecken kommt nur dann in Betracht, wenn die insoweit erforderlichen rechtlichen Vorgaben gemäß Art. 6 Abs. 4 DSGVO vorliegen. Die DVZ M-V GmbH beachtet etwaige Informationspflichten nach Art. 13 Abs. 3 DSGVO und Art. 14 Abs. 4 DSGVO sowie das Widerspruchsrecht nach Art. 21 DSGVO. Weitere Informationen erhalten Sie auf https://www.dvz-mv.de/Datenschutz/

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/d4ccbf03/attachment.html>

From a09550 at gmail.com  Tue May 19 08:58:49 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Tue, 19 May 2020 17:58:49 +0200
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo coordinates
 and width / height without warping dataset?
Message-ID: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>

Hello,

I have a Sentinel 2 in UTM32 with these metadata from gdalinfo:

Size is 1830, 1830
Pixel Size = (60.000000000000000,-60.000000000000000)
Lower Left  (  600000.000, 5790240.000)
Upper Left  (  600000.000, 5900040.000)

How can I have these same metadata* by GDAL Python/Java binding* but in
EPSG:4326, given Pixel Size = (0.000700000000000,-0.000700000000000) *without
running gdalwarp*?

Because, the input file can be big and I don't need the reprojected file,
just need these metadata in EPSG:4326, for example:

Size is 2395, 1454
Lower Left  (  10.4649804,  52.2224083)
Upper Left  (  10.4649804,  53.2402083)

I've tried to find some method, but this one only exist in C++ (
GDALSuggestedWarpOutput)
https://github.com/OSGeo/gdal/blob/106c8288e7a05f4efc1a588c5a3b2da7ec52d915/gdal/alg/gdaltransformer.cpp#L177

Thanks,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/11cd7cd5/attachment.html>

From warmerdam at pobox.com  Tue May 19 09:01:58 2020
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 19 May 2020 12:01:58 -0400
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo
 coordinates and width / height without warping dataset?
In-Reply-To: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
References: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
Message-ID: <CA+YzLBfRyBxZAuUg4thoFtx27YV7xJTZ4j-LkHHTaT03zwDAow@mail.gmail.com>

Pham,

I have sometimes taken the approach of doing a "gdalwarp to VRT" which
creates the configuration of the target dataset in VRT format, but does not
actually resample any imagery.  The you can open the VRT and query it's
configuration.  There are also lower level apis to get this information but
they are not normally exposed through SWIG in Java, Python, etc as far as I
know.

Best regards,


On Tue, May 19, 2020 at 11:59 AM Pham Huu Bang <a09550 at gmail.com> wrote:

> Hello,
>
> I have a Sentinel 2 in UTM32 with these metadata from gdalinfo:
>
> Size is 1830, 1830
> Pixel Size = (60.000000000000000,-60.000000000000000)
> Lower Left  (  600000.000, 5790240.000)
> Upper Left  (  600000.000, 5900040.000)
>
> How can I have these same metadata* by GDAL Python/Java binding* but in
> EPSG:4326, given Pixel Size = (0.000700000000000,-0.000700000000000) *without
> running gdalwarp*?
>
> Because, the input file can be big and I don't need the reprojected file,
> just need these metadata in EPSG:4326, for example:
>
> Size is 2395, 1454
> Lower Left  (  10.4649804,  52.2224083)
> Upper Left  (  10.4649804,  53.2402083)
>
> I've tried to find some method, but this one only exist in C++ (
> GDALSuggestedWarpOutput)
> https://github.com/OSGeo/gdal/blob/106c8288e7a05f4efc1a588c5a3b2da7ec52d915/gdal/alg/gdaltransformer.cpp#L177
>
> Thanks,
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/617fcbf6/attachment.html>

From even.rouault at spatialys.com  Tue May 19 09:14:13 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2020 18:14:13 +0200
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo
	coordinates and width / height without warping dataset?
In-Reply-To: <CA+YzLBfRyBxZAuUg4thoFtx27YV7xJTZ4j-LkHHTaT03zwDAow@mail.gmail.com>
References: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
 <CA+YzLBfRyBxZAuUg4thoFtx27YV7xJTZ4j-LkHHTaT03zwDAow@mail.gmail.com>
Message-ID: <8754870.HT1OTa8uNf@even-i700>

On mardi 19 mai 2020 12:01:58 CEST Frank Warmerdam wrote:
> Pham,
> 
> I have sometimes taken the approach of doing a "gdalwarp to VRT" which
> creates the configuration of the target dataset in VRT format, but does not
> actually resample any imagery.  The you can open the VRT and query it's
> configuration.  There are also lower level apis to get this information but
> they are not normally exposed through SWIG in Java, Python, etc as far as I
> know.
> 

gdal.AutoCreateWarpedVRT() is available in Java bindings:

https://gdal.org/java/org/gdal/gdal/gdal.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/de2cf814/attachment-0001.html>

From even.rouault at spatialys.com  Tue May 19 09:15:17 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2020 18:15:17 +0200
Subject: [gdal-dev] GML xlink:href resolving: Any disadvantages to HUGE
	compared to NONE?
In-Reply-To: <8e81ccd1068d47bca9a273fcbe6a0cc7@dvz-mv.de>
References: <8e81ccd1068d47bca9a273fcbe6a0cc7@dvz-mv.de>
Message-ID: <3591950.2BOB8V7mP1@even-i700>

On mardi 19 mai 2020 09:49:58 CEST Nash, Edward wrote:
> Hi,
> 
> I've just been reading the description of GML_SKIP_RESOLVE_ELEMS on
> https://gdal.org/drivers/vector/gml.html#gml-xlink-resolving and the
> advantages of using HUGE compared to NONE are clearly listed. My question
> is whether there are any serious disadvantages, such that it would not be a
> reasonable strategy to always use HUGE instead of NONE for resolving all
> xlink:hrefs? The use is in the context of a QGIS plugin, where temporary
> files are no problem and SQLite is going to be available.
> 

GML_SKIP_RESOLVE_ELEMS=HUGE should be fine. It was added later than NONE 

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/1dc53afa/attachment.html>

From a09550 at gmail.com  Tue May 19 09:36:53 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Tue, 19 May 2020 18:36:53 +0200
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo
 coordinates and width / height without warping dataset?
In-Reply-To: <8754870.HT1OTa8uNf@even-i700>
References: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
 <CA+YzLBfRyBxZAuUg4thoFtx27YV7xJTZ4j-LkHHTaT03zwDAow@mail.gmail.com>
 <8754870.HT1OTa8uNf@even-i700>
Message-ID: <CAJGa3-mNYFk3D0y9LYAvVeuJc07=obS02Eo84cC79wkhuW4Rjg@mail.gmail.com>

@Even Rouault <even.rouault at spatialys.com>

Unfortunately, this method is not enough to solve my problem as I *also
have a given geo X, Y resolutions *in target CRS (EPSG:4326) as input.

Below is what I've with Python GDAL:

    src_ds = gdal.GetDriverByName("VRT").Create("", 1830, 1830)
    src_ds.SetGeoTransform([600000.000, 60, 0,  5900040, 0, -60])

     // source CRS EPSG:32632
    src_srs = osr.SpatialReference()
    src_srs.ImportFromEPSG(32632)
    src_wkt = src_srs.ExportToWkt()

     // destination CRS EPSG:4326
    dst_srs = osr.SpatialReference()
    dst_srs.ImportFromEPSG(4326)
    dst_wkt = dst_srs.ExportToWkt()

   // This method doesn't have the possibility to add the given geo X, Y
resolutions in EPSG:4326  (!)
    dst_ds = gdal.AutoCreateWarpedVRT(src_ds,
                                      src_wkt,
                                      dst_wkt,
                                      gdal.GRA_NearestNeighbour,
                                      0.125)

On Tue, 19 May 2020 at 18:14, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 19 mai 2020 12:01:58 CEST Frank Warmerdam wrote:
>
> > Pham,
>
> >
>
> > I have sometimes taken the approach of doing a "gdalwarp to VRT" which
>
> > creates the configuration of the target dataset in VRT format, but does
> not
>
> > actually resample any imagery. The you can open the VRT and query it's
>
> > configuration. There are also lower level apis to get this information
> but
>
> > they are not normally exposed through SWIG in Java, Python, etc as far
> as I
>
> > know.
>
> >
>
>
>
> gdal.AutoCreateWarpedVRT() is available in Java bindings:
>
>
>
> https://gdal.org/java/org/gdal/gdal/gdal.html
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/15d71253/attachment.html>

From warmerdam at pobox.com  Tue May 19 10:03:07 2020
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 19 May 2020 13:03:07 -0400
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo
 coordinates and width / height without warping dataset?
In-Reply-To: <CAJGa3-mNYFk3D0y9LYAvVeuJc07=obS02Eo84cC79wkhuW4Rjg@mail.gmail.com>
References: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
 <CA+YzLBfRyBxZAuUg4thoFtx27YV7xJTZ4j-LkHHTaT03zwDAow@mail.gmail.com>
 <8754870.HT1OTa8uNf@even-i700>
 <CAJGa3-mNYFk3D0y9LYAvVeuJc07=obS02Eo84cC79wkhuW4Rjg@mail.gmail.com>
Message-ID: <CA+YzLBcPx-MiXzxWJumsUgLbrV9PnU+OtBzjm0o_Fh4YyasMpQ@mail.gmail.com>

Pham,

My point was that I use gdalwarp itself along with all the options (such as
setting the target resolution), but to VRT format.  I imagine the
"commandline gdalwarp API" interface would be able to do this from Java.
  If often just shell out and run the command.

Best regards,
Frank


On Tue, May 19, 2020 at 12:37 PM Pham Huu Bang <a09550 at gmail.com> wrote:

> @Even Rouault <even.rouault at spatialys.com>
>
> Unfortunately, this method is not enough to solve my problem as I *also
> have a given geo X, Y resolutions *in target CRS (EPSG:4326) as input.
>
> Below is what I've with Python GDAL:
>
>     src_ds = gdal.GetDriverByName("VRT").Create("", 1830, 1830)
>     src_ds.SetGeoTransform([600000.000, 60, 0,  5900040, 0, -60])
>
>      // source CRS EPSG:32632
>     src_srs = osr.SpatialReference()
>     src_srs.ImportFromEPSG(32632)
>     src_wkt = src_srs.ExportToWkt()
>
>      // destination CRS EPSG:4326
>     dst_srs = osr.SpatialReference()
>     dst_srs.ImportFromEPSG(4326)
>     dst_wkt = dst_srs.ExportToWkt()
>
>    // This method doesn't have the possibility to add the given geo X, Y
> resolutions in EPSG:4326  (!)
>     dst_ds = gdal.AutoCreateWarpedVRT(src_ds,
>                                       src_wkt,
>                                       dst_wkt,
>                                       gdal.GRA_NearestNeighbour,
>                                       0.125)
>
> On Tue, 19 May 2020 at 18:14, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On mardi 19 mai 2020 12:01:58 CEST Frank Warmerdam wrote:
>>
>> > Pham,
>>
>> >
>>
>> > I have sometimes taken the approach of doing a "gdalwarp to VRT" which
>>
>> > creates the configuration of the target dataset in VRT format, but does
>> not
>>
>> > actually resample any imagery. The you can open the VRT and query it's
>>
>> > configuration. There are also lower level apis to get this information
>> but
>>
>> > they are not normally exposed through SWIG in Java, Python, etc as far
>> as I
>>
>> > know.
>>
>> >
>>
>>
>>
>> gdal.AutoCreateWarpedVRT() is available in Java bindings:
>>
>>
>>
>> https://gdal.org/java/org/gdal/gdal/gdal.html
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>

-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows | +1 650-701-7823
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/acd4decc/attachment.html>

From even.rouault at spatialys.com  Tue May 19 10:24:17 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 19 May 2020 19:24:17 +0200
Subject: [gdal-dev] Python/Java GDAL - How to estimate the geo
	coordinates and width / height without warping dataset?
In-Reply-To: <CA+YzLBcPx-MiXzxWJumsUgLbrV9PnU+OtBzjm0o_Fh4YyasMpQ@mail.gmail.com>
References: <CAJGa3-nZEXQDVuKuZoejNaLBEDWoH9TqrzJ7e3r-DWsTDEtJpw@mail.gmail.com>
 <CAJGa3-mNYFk3D0y9LYAvVeuJc07=obS02Eo84cC79wkhuW4Rjg@mail.gmail.com>
 <CA+YzLBcPx-MiXzxWJumsUgLbrV9PnU+OtBzjm0o_Fh4YyasMpQ@mail.gmail.com>
Message-ID: <3453058.HpzJuGOj4B@even-i700>

On mardi 19 mai 2020 13:03:07 CEST Frank Warmerdam wrote:
> Pham,
> 
> My point was that I use gdalwarp itself along with all the options (such as
> setting the target resolution), but to VRT format.  I imagine the
> "commandline gdalwarp API" interface would be able to do this from Java.
>   If often just shell out and run the command.

Yes, or use the gdal.Warp() Java function. I'm not sure to have tested it myself with the Java 
bindings, but works fine for the Python ones.

should be something like (please fix to use correct Java syntax!)

options = new WarpOptions( new Vector() { "-of", "VRT", "-t_srs", "EPSG:4326","-tr", ... } );
vrt_ds = gdal.Warp("", new Dataset[] { src_ds }, options );

> 
> Best regards,
> Frank
> 
> On Tue, May 19, 2020 at 12:37 PM Pham Huu Bang <a09550 at gmail.com> wrote:
> > @Even Rouault <even.rouault at spatialys.com>
> > 
> > Unfortunately, this method is not enough to solve my problem as I *also
> > have a given geo X, Y resolutions *in target CRS (EPSG:4326) as input.
> > 
> > Below is what I've with Python GDAL:
> >     src_ds = gdal.GetDriverByName("VRT").Create("", 1830, 1830)
> >     src_ds.SetGeoTransform([600000.000, 60, 0,  5900040, 0, -60])
> >     
> >      // source CRS EPSG:32632
> >     
> >     src_srs = osr.SpatialReference()
> >     src_srs.ImportFromEPSG(32632)
> >     src_wkt = src_srs.ExportToWkt()
> >     
> >      // destination CRS EPSG:4326
> >     
> >     dst_srs = osr.SpatialReference()
> >     dst_srs.ImportFromEPSG(4326)
> >     dst_wkt = dst_srs.ExportToWkt()
> >    
> >    // This method doesn't have the possibility to add the given geo X, Y
> > 
> > resolutions in EPSG:4326  (!)
> > 
> >     dst_ds = gdal.AutoCreateWarpedVRT(src_ds,
> >     
> >                                       src_wkt,
> >                                       dst_wkt,
> >                                       gdal.GRA_NearestNeighbour,
> >                                       0.125)
> > 
> > On Tue, 19 May 2020 at 18:14, Even Rouault <even.rouault at spatialys.com>
> > 
> > wrote:
> >> On mardi 19 mai 2020 12:01:58 CEST Frank Warmerdam wrote:
> >> > Pham,
> >> > 
> >> > 
> >> > 
> >> > I have sometimes taken the approach of doing a "gdalwarp to VRT" which
> >> > 
> >> > creates the configuration of the target dataset in VRT format, but does
> >> 
> >> not
> >> 
> >> > actually resample any imagery. The you can open the VRT and query it's
> >> > 
> >> > configuration. There are also lower level apis to get this information
> >> 
> >> but
> >> 
> >> > they are not normally exposed through SWIG in Java, Python, etc as far
> >> 
> >> as I
> >> 
> >> > know.
> >> 
> >> gdal.AutoCreateWarpedVRT() is available in Java bindings:
> >> 
> >> 
> >> 
> >> https://gdal.org/java/org/gdal/gdal/gdal.html
> >> 
> >> 
> >> 
> >> Even
> >> 
> >> 
> >> 
> >> --
> >> 
> >> Spatialys - Geospatial professional services
> >> 
> >> http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/2bbcdfdf/attachment-0001.html>

From E.Nash at dvz-mv.de  Tue May 19 13:40:27 2020
From: E.Nash at dvz-mv.de (Nash, Edward)
Date: Tue, 19 May 2020 20:40:27 +0000
Subject: [gdal-dev] GML xlink:href resolving: Any disadvantages to HUGE
 compared to NONE?
In-Reply-To: <3591950.2BOB8V7mP1@even-i700>
References: <8e81ccd1068d47bca9a273fcbe6a0cc7@dvz-mv.de>
 <3591950.2BOB8V7mP1@even-i700>
Message-ID: <32bc0b2120a44807b0c2e53386723317@dvz-mv.de>

Many thanks for the reply, Even. I'll just use HUGE then and ignore NONE.

Best regards,

Edward

Von: Even Rouault [mailto:even.rouault at spatialys.com]
Gesendet: Dienstag, 19. Mai 2020 18:15
An: gdal-dev at lists.osgeo.org
Cc: Nash, Edward <E.Nash at dvz-mv.de>
Betreff: Re: [gdal-dev] GML xlink:href resolving: Any disadvantages to HUGE compared to NONE?


On mardi 19 mai 2020 09:49:58 CEST Nash, Edward wrote:

> Hi,

>

> I've just been reading the description of GML_SKIP_RESOLVE_ELEMS on

> https://gdal.org/drivers/vector/gml.html#gml-xlink-resolving and the

> advantages of using HUGE compared to NONE are clearly listed. My question

> is whether there are any serious disadvantages, such that it would not be a

> reasonable strategy to always use HUGE instead of NONE for resolving all

> xlink:hrefs? The use is in the context of a QGIS plugin, where temporary

> files are no problem and SQLite is going to be available.

>



GML_SKIP_RESOLVE_ELEMS=HUGE should be fine. It was added later than NONE



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200519/8cf85710/attachment.html>

From cdelancy at blackfangtechnologies.com  Wed May 20 07:32:25 2020
From: cdelancy at blackfangtechnologies.com (Craig Delancy)
Date: Wed, 20 May 2020 14:32:25 +0000
Subject: [gdal-dev] Updated GDAL and PROJ,
 now certain datasets crash when calling GetGeoTransform
Message-ID: <DM6PR17MB38843F360442FA46AA007E16C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>

I've just updated my PROJ and GDAL libraries from the github source again, building in debug configuration, and when testing discovered that certain datasets crash while other do not.
Specifically, when I call GetGeoTransform on the dataset, I get an exception on line 3395 of c_api.cpp.
The param new_geod_crs passed into the function proj_crs_alter_geodetic_crs is NULL.

When I open certain geotiff files to make the datasets, some work fine while others cause this crash. All were working before I updated the GDAL version. Previously I was on 3.0.0.
Is this a bug or have I messed up something on my end?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200520/fe6b4ed4/attachment.html>

From even.rouault at spatialys.com  Wed May 20 07:43:07 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2020 16:43:07 +0200
Subject: [gdal-dev] Updated GDAL and PROJ,
	now certain datasets crash when calling GetGeoTransform
In-Reply-To: <DM6PR17MB38843F360442FA46AA007E16C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB38843F360442FA46AA007E16C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <2236683.ANA6LaD3Oe@even-i700>

On mercredi 20 mai 2020 14:32:25 CEST Craig Delancy wrote:
> I've just updated my PROJ and GDAL libraries from the github source again,
> building in debug configuration, and when testing discovered that certain
> datasets crash while other do not. Specifically, when I call
> GetGeoTransform on the dataset, I get an exception on line 3395 of
> c_api.cpp. The param new_geod_crs passed into the function
> proj_crs_alter_geodetic_crs is NULL.
> 
> When I open certain geotiff files to make the datasets, some work fine while
> others cause this crash. All were working before I updated the GDAL
> version. Previously I was on 3.0.0. Is this a bug or have I messed up
> something on my end?

Hard to know. If you "git pull" from an existing GDAL checkout, make sure to make clean 
before rebuilding.
If you still reproduce crashes, please provide a dataset that can reproduce the issue. 
Probably as an attachment in an issue in
https://github.com/OSGeo/gdal/

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200520/5c57a1b9/attachment.html>

From even.rouault at spatialys.com  Wed May 20 08:07:50 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2020 17:07:50 +0200
Subject: [gdal-dev] Updated GDAL and PROJ,
	now certain datasets crash when calling GetGeoTransform
In-Reply-To: <DM6PR17MB388415F3900606BE0D8E8E52C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB38843F360442FA46AA007E16C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
 <2236683.ANA6LaD3Oe@even-i700>
 <DM6PR17MB388415F3900606BE0D8E8E52C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <23750283.lNGfQ57Zz4@even-i700>

On mercredi 20 mai 2020 14:47:00 CEST Craig Delancy wrote:
> I already clean the solution before rebuilding, as I can't get a successful
> build without doing this. Here is an example that causes the crash.

(Readding the list without the download URL)
[...]

Works fine for me with gdalinfo, or with just GetGeoTransform() with the 
Python bindings.
I'd suspect something wrong in your configuration. Check that your GDAL 
build links against a single PROJ lib for example

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200520/077e65fa/attachment-0001.html>

From even.rouault at spatialys.com  Wed May 20 08:47:55 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2020 17:47:55 +0200
Subject: [gdal-dev] Updated GDAL and PROJ,
	now certain datasets crash when calling GetGeoTransform
In-Reply-To: <DM6PR17MB3884109BF93A7CC8FA365549C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
References: <DM6PR17MB38843F360442FA46AA007E16C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
 <23750283.lNGfQ57Zz4@even-i700>
 <DM6PR17MB3884109BF93A7CC8FA365549C7B60@DM6PR17MB3884.namprd17.prod.outlook.com>
Message-ID: <1894117.bQ1CqJ6aTg@even-i700>

Please keep the list posted when you reply

> I didn't know it was possible for GDAL to link against multiple PROJ libs.

By accident, yes.

> How would I go about checking this?

See https://lists.osgeo.org/pipermail/gdal-dev/2020-May/thread.html#52187 that 
discusses this for Linux
On Windows, this is more likely to happen. You didn't mention which OS you are 
running.

Might be something else. Who knows

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200520/6c0cb14e/attachment.html>

From andrew at aitchison.me.uk  Wed May 20 09:02:12 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 20 May 2020 17:02:12 +0100 (BST)
Subject: [gdal-dev] Hints for debugging gdal vector drivers ?
Message-ID: <alpine.DEB.2.22.394.2005201615290.22784@warden.aitchison.me.uk>


I'm writing a gdal vector driver for a file-based data format.
I'm getting a SIGSEGV in OGRLayer::GetExtentInternal called from
ogrinfo code when I run
    /usr/local/gdal3.1.0/bin/ogrinfo /home/maps/MemoryMap/Norway-1m.qct "outline"
on my datafiles.

The stack trace below suggests that the feature has no valid extent (see
m_sFilterEnvelope) - which is reasonable as the driver never sets a filter,
envelope or extent.

I believe I've followed what was https://gdal.org/ogr_drivertut.html
(IIRC http://manpages.org/ogr_drivertut is a reasonable mirror).
How should the driver ensure that it gives OGR the necessary filter/envolope.extent information ?

Thanks,

(gdb) where
#0  0x00007ffff65e1cf0 in main_arena () from /lib/x86_64-linux-gnu/libc.so.6
#1  0x00007ffff7809d0f in OGRLayer::GetExtentInternal 
(this=0x555555620710,
     iGeomField=0, psExtent=0x7fffffffd600, bForce=<optimised out>)
     at ogrlayer.cpp:267
#2  0x0000555555558de0 in ReportOnLayer (poLayer=0x555555620710,
     pszWHERE=<optimised out>, pszGeomField=<optimised out>,
     poSpatialFilter=<optimised out>, bListMDD=<optimised out>,
     bShowMetadata=<optimised out>, papszExtraMDDomains=0x0,
     bFeatureCount=true, bExtent=true, bGeomType=true,
     pszWKTFormat=0x55555555a6c0 "WKT2") at ogrinfo.cpp:293
#3  0x00005555555576ef in main (nArgc=<optimised out>,
     papszArgv=<optimised out>) at ogrinfo.cpp:1038
(gdb) up
#1  0x00007ffff7809d0f in OGRLayer::GetExtentInternal 
(this=0x555555620710,
     iGeomField=0, psExtent=0x7fffffffd600, bForce=<optimised out>)
     at ogrlayer.cpp:267
267             if (poGeom == nullptr || poGeom->IsEmpty())
(gdb) print *this
$3 = {<GDALMajorObject> = {
     _vptr.GDALMajorObject = 0x7ffff08f9c08 <vtable for OGRQCTLayer+16>,
     nFlags = 1,
     sDescription = {<std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >> = "outline", <No data fields>}, oMDMD = {
       papszDomainList = 0x0, papoMetadataLists = 0x0}},
   m_poPrivate = std::unique_ptr<OGRLayer::Private> = {get() = 0x555555620800},
   m_bFilterIsEnvelope = 0, m_poFilterGeom = 0x0, m_pPreparedFilterGeom = 0x0,
   m_sFilterEnvelope = {MinX = inf, MaxX = -inf, MinY = inf, MaxY = -inf},
   m_iGeomFieldFilter = 0, m_poStyleTable = 0x0, m_poAttrQuery = 0x0,
   m_pszAttrQueryString = 0x0, m_poAttrIndex = 0x0, m_nRefCount = 0,
   m_nFeaturesRead = 0}

-- 
Andrew C. Aitchison 					Kendal, UK
 			andrew at aitchison.me.uk

From even.rouault at spatialys.com  Wed May 20 09:11:24 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 20 May 2020 18:11:24 +0200
Subject: [gdal-dev] Hints for debugging gdal vector drivers ?
In-Reply-To: <alpine.DEB.2.22.394.2005201615290.22784@warden.aitchison.me.uk>
References: <alpine.DEB.2.22.394.2005201615290.22784@warden.aitchison.me.uk>
Message-ID: <14089847.nn3qrZ31uF@even-i700>

On mercredi 20 mai 2020 17:02:12 CEST Andrew C Aitchison wrote:
> I'm writing a gdal vector driver for a file-based data format.
> I'm getting a SIGSEGV in OGRLayer::GetExtentInternal called from
> ogrinfo code when I run
>     /usr/local/gdal3.1.0/bin/ogrinfo /home/maps/MemoryMap/Norway-1m.qct
> "outline" on my datafiles.
> 
> The stack trace below suggests that the feature has no valid extent (see
> m_sFilterEnvelope) - which is reasonable as the driver never sets a filter,
> envelope or extent.
> 
> I believe I've followed what was https://gdal.org/ogr_drivertut.html
> (IIRC http://manpages.org/ogr_drivertut is a reasonable mirror).
> How should the driver ensure that it gives OGR the necessary
> filter/envolope.extent information ?

>From the crash at line 267 of ogrlyaer.cpp, I'd say your driver returns a geometry object that 
has been destroyed

Random guess: you might do something like:
{
	OGRPoint p;
	poFeature->SetGeometryDirectly(&p);
	// p is destroy now, and poFeature has just kept the pointer on it.
}

==> Run Valgrind. Or run valgrind. Or perhaps run valgrind :-)

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200520/b13d9153/attachment.html>

From jidanni at jidanni.org  Wed May 20 13:27:32 2020
From: jidanni at jidanni.org (Dan Jacobson)
Date: Thu, 21 May 2020 04:27:32 +0800
Subject: [gdal-dev] Gettin' started: WMTS -> gdal2tiles
References: <OSGeo/gdal/issues/2052@github.com>
 <OSGeo/gdal/issues/2052/628650934@github.com>
Message-ID: <87367ugxmz.5.fsf_-_@jidanni.org>

Or, how would I download a few tiles,
from openstreetmap, say near 24,121 lat/lon?
Yes, https://github.com/OSGeo/gdal/issues/2052#issuecomment-628650934
but of course works for me, but is black.

I suppose there is no way to pipe this into gdal2tiles, so I will save
it as a separate file(s) first.

From andrew at aitchison.me.uk  Wed May 20 14:25:44 2020
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 20 May 2020 22:25:44 +0100 (BST)
Subject: [gdal-dev] Hints for debugging gdal vector drivers ?
In-Reply-To: <14089847.nn3qrZ31uF@even-i700>
References: <alpine.DEB.2.22.394.2005201615290.22784@warden.aitchison.me.uk>
 <14089847.nn3qrZ31uF@even-i700>
Message-ID: <alpine.DEB.2.22.394.2005202225160.37443@warden.aitchison.me.uk>


Evan,

Thanks.
Those two hints were just what I needed.

On Wed, 20 May 2020, Even Rouault wrote:
> On mercredi 20 mai 2020 17:02:12 CEST Andrew C Aitchison wrote:
>> I'm writing a gdal vector driver for a file-based data format.
>> I'm getting a SIGSEGV in OGRLayer::GetExtentInternal called from
>> ogrinfo code when I run
>>     /usr/local/gdal3.1.0/bin/ogrinfo /home/maps/MemoryMap/Norway-1m.qct
>> "outline" on my datafiles.
>>
>> The stack trace below suggests that the feature has no valid extent (see
>> m_sFilterEnvelope) - which is reasonable as the driver never sets a filter,
>> envelope or extent.
>>
>> I believe I've followed what was https://gdal.org/ogr_drivertut.html
>> (IIRC http://manpages.org/ogr_drivertut is a reasonable mirror).
>> How should the driver ensure that it gives OGR the necessary
>> filter/envolope.extent information ?
>
>> From the crash at line 267 of ogrlyaer.cpp, I'd say your driver returns a geometry object that
> has been destroyed
>
> Random guess: you might do something like:
> {
> 	OGRPoint p;
> 	poFeature->SetGeometryDirectly(&p);
> 	// p is destroy now, and poFeature has just kept the pointer on it.
> }
>
> ==> Run Valgrind. Or run valgrind. Or perhaps run valgrind :-)


-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From sean at mapbox.com  Thu May 21 10:32:56 2020
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 21 May 2020 11:32:56 -0600
Subject: [gdal-dev] Conflict between scipy/pypocketfft and GDAL/ECW
Message-ID: <CADPhZXxOs96ikEEid1ahpc-ESegmsB_kXAc0gdemy_kGXS=khA@mail.gmail.com>

Hi all,

I've run into an apparent conflict between pypocketfft, the basis for
scipy.fft introduced in scipy 1.4.0, and GDAL 3.1.0 built with the ECWJP2
SDK version 5.5. I'm wondering if anyone has seen this and found a solution
other than downgrading scipy to 1.3.2?

$ pip install scipy
...
Successfully installed scipy-1.4.1
$ python
Python 3.6.6 (default, Sep 12 2018, 18:26:19)
[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import rasterio
>>> import scipy
free(): invalid pointer
Aborted (core dumped)

I've looked at the above more closely using gdb and the crash occurs on
import of one of pypocketfft's C extension modules (an .so file).

Downgrading scipy sidesteps the problem.

$ pip uninstall scipy
...
Successfully uninstalled scipy-1.4.1
$ pip install scipy==1.3.2
...
Successfully installed scipy-1.3.2
$ python
Python 3.6.6 (default, Sep 12 2018, 18:26:19)
[GCC 8.0.1 20180414 (experimental) [trunk revision 259383]] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import rasterio
>>> import scipy
>>>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200521/d01e3c06/attachment.html>

From even.rouault at spatialys.com  Thu May 21 10:54:11 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2020 19:54:11 +0200
Subject: [gdal-dev] Conflict between scipy/pypocketfft and GDAL/ECW
In-Reply-To: <CADPhZXxOs96ikEEid1ahpc-ESegmsB_kXAc0gdemy_kGXS=khA@mail.gmail.com>
References: <CADPhZXxOs96ikEEid1ahpc-ESegmsB_kXAc0gdemy_kGXS=khA@mail.gmail.com>
Message-ID: <2414699.mDXfvOtFBS@even-i700>

Sean,

> I've run into an apparent conflict between pypocketfft, the basis for
> scipy.fft introduced in scipy 1.4.0, and GDAL 3.1.0 built with the ECWJP2
> SDK version 5.5. I'm wondering if anyone has seen this and found a solution
> other than downgrading scipy to 1.3.2?

I suspect this is another manifestation of the issue raised in
https://github.com/OSGeo/gdal/issues/2394 , that is that the ECW SDK 5.5 on Linux 
is statically linked against a libstdc++ implementation, incompatible of the one of 
the system, that other libraries may use. However it is not obvious to me that scipy 
contains C++ code.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200521/2dc29e27/attachment.html>

From even.rouault at spatialys.com  Thu May 21 11:02:58 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 21 May 2020 20:02:58 +0200
Subject: [gdal-dev] Conflict between scipy/pypocketfft and GDAL/ECW
In-Reply-To: <2414699.mDXfvOtFBS@even-i700>
References: <CADPhZXxOs96ikEEid1ahpc-ESegmsB_kXAc0gdemy_kGXS=khA@mail.gmail.com>
 <2414699.mDXfvOtFBS@even-i700>
Message-ID: <5377414.PapRWpugxF@even-i700>

> However it is not obvious to me that scipy contains C++ code.

... but pypocketfft does:
https://gitlab.mpcdf.mpg.de/mtr/pypocketfft/-/blob/master/
pypocketfft.cc

Mystery solve !

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200521/a3c45888/attachment.html>

From sean at mapbox.com  Thu May 21 11:10:44 2020
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 21 May 2020 12:10:44 -0600
Subject: [gdal-dev] Conflict between scipy/pypocketfft and GDAL/ECW
In-Reply-To: <5377414.PapRWpugxF@even-i700>
References: <CADPhZXxOs96ikEEid1ahpc-ESegmsB_kXAc0gdemy_kGXS=khA@mail.gmail.com>
 <2414699.mDXfvOtFBS@even-i700> <5377414.PapRWpugxF@even-i700>
Message-ID: <CADPhZXy6=x_g9Xe9GSsNEsAJayv780k9+NKysA84hK37q69O9A@mail.gmail.com>

Hi Even,

On Thu, May 21, 2020 at 12:03 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> > However it is not obvious to me that scipy contains C++ code.
>
>
>
> ... but pypocketfft does:
>
> https://gitlab.mpcdf.mpg.de/mtr/pypocketfft/-/blob/master/pypocketfft.cc
>
>
>
> Mystery solve !
>

Yes, I was just about to point out

$ ldd
~/.virtualenvs/dev-rasterio/lib/python3.6/site-packages/scipy/fft/_pocketfft/
pypocketfft.cpython-36m-x86_64-linux-gnu.so
        linux-vdso.so.1 (0x00007ffe423e1000)
        libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6
(0x00007f1a4e03c000)
        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f1a4dc9e000)
        libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1
(0x00007f1a4da86000)
        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0
(0x00007f1a4d867000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f1a4d476000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f1a4e67d000)

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200521/ffaf656e/attachment.html>

From jachym.cepicky at gmail.com  Mon May 25 01:44:10 2020
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Mon, 25 May 2020 10:44:10 +0200
Subject: [gdal-dev] python code inside of VRT results to empty values
Message-ID: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>

Hi all,

I have some python code inside of VRT file, but I can not produce
reasonable output with gdal_transalte. All the input data do look ok,
even when I print() the values I would like to store, the data are
displayed, but the resulting TIFF file is just empty, any hint how to
approach? I've tested it on gdal 2.2 as well as 3.8, so I assume, I do
something wrong here. The minimal code looks like

import numpy as np
import copy
def blur(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize,
raster_ysize, buf_radius, gt, **kwargs):
    out_ar = copy.copy(in_ar[0])
    print(out_ar)
    return out_ar

Any hint?

Thank you

Jachym
-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/pgp/JachymCepicky.pgp

From even.rouault at spatialys.com  Mon May 25 02:11:08 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 May 2020 11:11:08 +0200
Subject: [gdal-dev] python code inside of VRT results to empty values
In-Reply-To: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>
References: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>
Message-ID: <2232481.0V7u7DgNHC@even-i700>

Jachym,

> I have some python code inside of VRT file, but I can not produce
> reasonable output with gdal_transalte. All the input data do look ok,
> even when I print() the values I would like to store, the data are
> displayed, but the resulting TIFF file is just empty, any hint how to
> approach?

Can you show the full VRT ?

Can you also try with the below one.vrt

<VRTDataset rasterXSize="5" rasterYSize="5">
  <VRTRasterBand dataType="Byte" band="1" subClass="VRTDerivedRasterBand">
    <ColorInterp>Gray</ColorInterp>
    <PixelFunctionType>ones</PixelFunctionType>
    <PixelFunctionLanguage>Python</PixelFunctionLanguage>
    <PixelFunctionCode><![CDATA[
def ones(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize, raster_ysize, r, gt, **kwargs):
    out_ar.fill(1)
]]>
    </PixelFunctionCode>
  </VRTRasterBand>
</VRTDataset>

and report the output of

gdal_translate one.vrt /vsistdout/ -of aaigrid  --debug ON --config GDAL_VRT_ENABLE_PYTHON YES

on it ?

> I've tested it on gdal 2.2 as well as 3.8

Python 3.8 with GDAL 2.2 might be too recent. There was a fix recently for 3.8.0 on Windows (but you won't
have got to the point where any python code was executed if you hit that bug)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200525/e0ddbb90/attachment.html>

From even.rouault at spatialys.com  Mon May 25 02:14:34 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 May 2020 11:14:34 +0200
Subject: [gdal-dev] python code inside of VRT results to empty values
In-Reply-To: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>
References: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>
Message-ID: <3262695.MdUIbNyvLz@even-i700>

On lundi 25 mai 2020 10:44:10 CEST Jachym Cepicky wrote:
> Hi all,
> 
> I have some python code inside of VRT file, but I can not produce
> reasonable output with gdal_transalte. All the input data do look ok,
> even when I print() the values I would like to store, the data are
> displayed, but the resulting TIFF file is just empty, any hint how to
> approach? I've tested it on gdal 2.2 as well as 3.8, so I assume, I do
> something wrong here. The minimal code looks like
> 
> import numpy as np
> import copy
> def blur(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize,
> raster_ysize, buf_radius, gt, **kwargs):
>     out_ar = copy.copy(in_ar[0])
>     print(out_ar)
>     return out_ar
> 
> Any hint?

Actually, just realizing that you just don't follow the expectations of the
pixel function. The function should not return an array: it must modify in place
the provided out_ar argument.
Like all examples at
https://gdal.org/drivers/raster/vrt.html#using-derived-bands-with-pixel-functions-in-python

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200525/274ea033/attachment.html>

From jachym.cepicky at gmail.com  Mon May 25 02:36:47 2020
From: jachym.cepicky at gmail.com (Jachym Cepicky)
Date: Mon, 25 May 2020 11:36:47 +0200
Subject: [gdal-dev] python code inside of VRT results to empty values
In-Reply-To: <3262695.MdUIbNyvLz@even-i700>
References: <CAAZUH4G=DOHgRe-2ZZeOcinsyTySKN1edow=Wbim-EOaAt1ajA@mail.gmail.com>
 <3262695.MdUIbNyvLz@even-i700>
Message-ID: <CAAZUH4HcGmDvn0XtyDoBzf9iumJMbYwoPQKdrUZ7cmLVuNpsPQ@mail.gmail.com>

Aahaa, the problem was

out_ar[:] = data

while I was using

out_ara = data

Thank you!

Jachym

po 25. 5. 2020 v 11:14 odesílatel Even Rouault
<even.rouault at spatialys.com> napsal:
>
> On lundi 25 mai 2020 10:44:10 CEST Jachym Cepicky wrote:
>
> > Hi all,
>
> >
>
> > I have some python code inside of VRT file, but I can not produce
>
> > reasonable output with gdal_transalte. All the input data do look ok,
>
> > even when I print() the values I would like to store, the data are
>
> > displayed, but the resulting TIFF file is just empty, any hint how to
>
> > approach? I've tested it on gdal 2.2 as well as 3.8, so I assume, I do
>
> > something wrong here. The minimal code looks like
>
> >
>
> > import numpy as np
>
> > import copy
>
> > def blur(in_ar, out_ar, xoff, yoff, xsize, ysize, raster_xsize,
>
> > raster_ysize, buf_radius, gt, **kwargs):
>
> > out_ar = copy.copy(in_ar[0])
>
> > print(out_ar)
>
> > return out_ar
>
> >
>
> > Any hint?
>
>
>
> Actually, just realizing that you just don't follow the expectations of the
>
> pixel function. The function should not return an array: it must modify in place
>
> the provided out_ar argument.
>
> Like all examples at
>
> https://gdal.org/drivers/raster/vrt.html#using-derived-bands-with-pixel-functions-in-python
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com



-- 
Jachym Cepicky
e-mail: jachym.cepicky gmail com
URL: http://les-ejk.cz
GPG: http://les-ejk.cz/pgp/JachymCepicky.pgp

From cedric.traizet at csgroup.eu  Mon May 25 07:22:15 2020
From: cedric.traizet at csgroup.eu (=?UTF-8?Q?C=c3=a9dric_Traizet?=)
Date: Mon, 25 May 2020 16:22:15 +0200
Subject: [gdal-dev] DEM handling in GDAL
Message-ID: <b092edd9-39cd-eb79-3bcb-0742a830992e@c-s.fr>

Hi all,

I am trying to use the GDAL C++ API to read and use DEMs. Is it possible ?

In GDAL source code, in alg/gdal_rpc.cpp, there are several functions 
for DEM handling (e.g. GDALRPCGetHeigthAtLongLat that supports several 
resampling methods, GDALRPCOpenDEM). These functions are used internally 
by the RPC algorithms. However, these DEM processing functions are not 
exposed in GDAL API (only the rpc functions are). Is there a reason for 
this ? These functions could be useful in other applications than rpc 
transformations !

Kind regards,


Cédric


From even.rouault at spatialys.com  Mon May 25 07:30:53 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 May 2020 16:30:53 +0200
Subject: [gdal-dev] DEM handling in GDAL
In-Reply-To: <b092edd9-39cd-eb79-3bcb-0742a830992e@c-s.fr>
References: <b092edd9-39cd-eb79-3bcb-0742a830992e@c-s.fr>
Message-ID: <4620177.LzchLHUa8x@even-i700>

On lundi 25 mai 2020 16:22:15 CEST Cédric Traizet wrote:
> Hi all,
> 
> I am trying to use the GDAL C++ API to read and use DEMs. Is it possible ?
> 
> In GDAL source code, in alg/gdal_rpc.cpp, there are several functions
> for DEM handling (e.g. GDALRPCGetHeigthAtLongLat that supports several
> resampling methods, GDALRPCOpenDEM). These functions are used internally
> by the RPC algorithms. However, these DEM processing functions are not
> exposed in GDAL API (only the rpc functions are). Is there a reason for
> this ? These functions could be useful in other applications than rpc
> transformations !

Those routines are DEM specific usages for the RPC transformer. They are implementation 
details.

But if you just need to extract elevation values from a DEM, this is exactly the same as 
reading pixel values from a generic raster.
Look at https://gdal.org/tutorials/raster_api_tut.html or any documentation related to 
reading raster in GDAL.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200525/1ec8765c/attachment.html>

From cedric.traizet at csgroup.eu  Mon May 25 09:00:35 2020
From: cedric.traizet at csgroup.eu (=?UTF-8?Q?C=c3=a9dric_Traizet?=)
Date: Mon, 25 May 2020 18:00:35 +0200
Subject: [gdal-dev] DEM handling in GDAL
In-Reply-To: <4620177.LzchLHUa8x@even-i700>
References: <b092edd9-39cd-eb79-3bcb-0742a830992e@c-s.fr>
 <4620177.LzchLHUa8x@even-i700>
Message-ID: <91f5c961-0334-6fd9-51d9-891c8b29856b@c-s.fr>

Thanks for your answer, In addition to the extraction of values from the 
DEM raster, these functions implement the interpolation of the DEM 
height on any point. Is there any chance to have this kind of function 
in the public API someday ? In my project I want to use the GDAL RPC 
algorithms, but I also need to use DEM in other processings, so I wanted 
to know if there was a way to reuse these DEM routines. Anyway, it 
shouldn't be too hard to re-implement the DEM interpolation in my code.

Cédric

On 25/05/2020 16:30, Even Rouault wrote:
>
> On lundi 25 mai 2020 16:22:15 CEST Cédric Traizet wrote:
>
> > Hi all,
>
> >
>
> > I am trying to use the GDAL C++ API to read and use DEMs. Is it 
> possible ?
>
> >
>
> > In GDAL source code, in alg/gdal_rpc.cpp, there are several functions
>
> > for DEM handling (e.g. GDALRPCGetHeigthAtLongLat that supports several
>
> > resampling methods, GDALRPCOpenDEM). These functions are used internally
>
> > by the RPC algorithms. However, these DEM processing functions are not
>
> > exposed in GDAL API (only the rpc functions are). Is there a reason for
>
> > this ? These functions could be useful in other applications than rpc
>
> > transformations !
>
> Those routines are DEM specific usages for the RPC transformer. They 
> are implementation details.
>
> But if you just need to extract elevation values from a DEM, this is 
> exactly the same as reading pixel values from a generic raster.
>
> Look at https://gdal.org/tutorials/raster_api_tut.html or any 
> documentation related to reading raster in GDAL.
>
> Even
>
> -- 
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200525/8931c9c0/attachment.html>

From even.rouault at spatialys.com  Mon May 25 09:19:03 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 25 May 2020 18:19:03 +0200
Subject: [gdal-dev] DEM handling in GDAL
In-Reply-To: <91f5c961-0334-6fd9-51d9-891c8b29856b@c-s.fr>
References: <b092edd9-39cd-eb79-3bcb-0742a830992e@c-s.fr>
 <4620177.LzchLHUa8x@even-i700> <91f5c961-0334-6fd9-51d9-891c8b29856b@c-s.fr>
Message-ID: <4673957.5yzrLodiBD@even-i700>

On lundi 25 mai 2020 18:00:35 CEST Cédric Traizet wrote:
> Thanks for your answer, In addition to the extraction of values from the
> DEM raster, these functions implement the interpolation of the DEM
> height on any point. Is there any chance to have this kind of function
> in the public API someday ? In my project I want to use the GDAL RPC
> algorithms, but I also need to use DEM in other processings, so I wanted
> to know if there was a way to reuse these DEM routines. Anyway, it
> shouldn't be too hard to re-implement the DEM interpolation in my code.$

I see your point now.

You can probably accomplish what you want by using the GDALRasterIOExtraArg argument 
of the RasterIO function, by setting bFloatingPointWindowValidity to TRUE and setting 
dfXOff, dfYOff, dfXSize, dfYSize

You'll likely have to play with half-pixel shift. If you want an interpolated value at (X_georef, 
Y_georef),

dfXOff = (X_georef - gt[0]) / gt[1] - 0.5
dfYOff = (Y_georef - gt[3]) / gt[5] - 0.5
dfXSize = dfYSize = 1

(untested)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200525/dbbfbfd2/attachment.html>

From rajeshreddy82 at gmail.com  Tue May 26 05:45:28 2020
From: rajeshreddy82 at gmail.com (rmaddu)
Date: Tue, 26 May 2020 05:45:28 -0700 (MST)
Subject: [gdal-dev] C#: How to generate pbf file from bytes array for Vector
 Tiles Service
Message-ID: <1590497128828-0.post@n6.nabble.com>

Hi,

Below is the C# code snippet. How to generate pbf file from bytes data? Is
this the correct way or any other way to return to client?

string filePath = string.Format(@"/vsimem/mvt-{0}/{1}/{2}/{3}.pbf",
uniqueUUID, 18, 66027, 96262);
var bufPtr = Gdal.VSIFOpenL(filePath, "rb");
     
      if (bufPtr != null)
      {
        Gdal.VSIFSeekL(bufPtr, 0, 2); // seek to end
        var contentSize = Gdal.VSIFTellL(bufPtr);        
        Gdal.VSIFSeekL(bufPtr, 0, 0); // seek to beginning 
        Gdal.VSIFCloseL(bufPtr);
       
        byte[] data = new byte[contentSize];
        Marshal.Copy(bufPtr, data, 0, contentSize);
       
        Gdal.Unlink(vsibuf);

Regards,
Rajesh



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From stenger at lat-lon.de  Tue May 26 05:39:02 2020
From: stenger at lat-lon.de (Dirk Stenger)
Date: Tue, 26 May 2020 14:39:02 +0200
Subject: [gdal-dev] Binaries of GDAL JNI
Message-ID: <41baf5ae-aac2-db13-ff2f-6704114421b1@lat-lon.de>

Hi all,

We are using GDAL in Java applications via JNI.

For that, we install GDAL JNI on Ubuntu or Debian by using package
"libgdal-java".

However, the number of available GDAL JNI versions is limited to one.
Thus, it is not possible to install an old GDAL + GDAL JNI version (e.g.
2.4) on the current release of Ubuntu.

We also had problems to install GDAL JNI on other Linux distributions
not providing package "libgdal-java".

Is there any place where we can download binaries of current and older
versions of GDAL JNI like it is possible for GDAL itself
(https://gdal.org/download.html)?
Does anyone have similar problems?

Kind regards,
Dirk

From even.rouault at spatialys.com  Tue May 26 06:06:19 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2020 15:06:19 +0200
Subject: [gdal-dev] Binaries of GDAL JNI
In-Reply-To: <41baf5ae-aac2-db13-ff2f-6704114421b1@lat-lon.de>
References: <41baf5ae-aac2-db13-ff2f-6704114421b1@lat-lon.de>
Message-ID: <4872676.TLUfl68ZV0@even-i700>

On mardi 26 mai 2020 14:39:02 CEST Dirk Stenger wrote:
> Hi all,
> 
> We are using GDAL in Java applications via JNI.
> 
> For that, we install GDAL JNI on Ubuntu or Debian by using package
> "libgdal-java".
> 
> However, the number of available GDAL JNI versions is limited to one.
> Thus, it is not possible to install an old GDAL + GDAL JNI version (e.g.
> 2.4) on the current release of Ubuntu.
> 
> We also had problems to install GDAL JNI on other Linux distributions
> not providing package "libgdal-java".
> 
> Is there any place where we can download binaries of current and older
> versions of GDAL JNI like it is possible for GDAL itself
> (https://gdal.org/download.html)?

You'll have to build it yourself from the corresponding source archive of the GDAL version 
you're interested in.


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/7ade0803/attachment.html>

From nelson.gerald.c at gmail.com  Tue May 26 07:03:40 2020
From: nelson.gerald.c at gmail.com (Gerald Nelson)
Date: Tue, 26 May 2020 14:03:40 +0000
Subject: [gdal-dev] make failing with gdal-3.1.0 on Mac Catalina (10.15.4)
Message-ID: <MWHPR16MB1438A3F3BEB53B82F16A0555ADB00@MWHPR16MB1438.namprd16.prod.outlook.com>

I get through the ./configure process successfully (at least with no error messages). When I run make I get a lot of messages but obvious error messages until I get towards the end when I get the following


 -rpath /usr/local/lib \

    -no-undefined \

    -version-info 27:0:0

Undefined symbols for architecture x86_64:

  "_FreeMapObject", referenced from:

      GIFDataset::CreateCopy(char const*, GDALDataset*, int, char**, int (*)(double, char const*, void*), void*) in gifdataset.o

  "_MakeMapObject", referenced from:

      GIFDataset::CreateCopy(char const*, GDALDataset*, int, char**, int (*)(double, char const*, void*), void*) in gifdataset.o

ld: symbol(s) not found for architecture x86_64

clang: error: linker command failed with exit code 1 (use -v to see invocation)

make[1]: *** [GNUmakefile:68: libgdal.la] Error 1

make[1]: Leaving directory '/Users/gcn/Downloads/gdal-3.1.0'

make: *** [GNUmakefile:79: check-lib] Error 2

The error seems to be associated with libgdal.1a. When I run


locate libgdal.la

It returns

/Applications/GRASS-7.4.1.app/Contents/Resources/lib/libgdal.la

This is a file with a June 2018 date which I suspect is both out of date and in the wrong place.

Suggestions for fixes greatly appreciated!

Gerald C. Nelson
Professor Emeritus, UIUC
+1 217-390-7888 (cell)
+1 970-639-2079 (land line)
Skype: jerrynelson
http://bit.ly/1arho7d
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/684a60f0/attachment.html>

From bengvr at gmail.com  Tue May 26 12:25:01 2020
From: bengvr at gmail.com (Ben Van Riper)
Date: Tue, 26 May 2020 15:25:01 -0400
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
Message-ID: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>

Hello all,

I am trying to build GDAL 3.1.0 on my machine with Ubuntu 18.04. Why go
through all the trouble? Because ubuntu-gis doesn't seem to want to bundle
the ESRI GDB driver with the gdal binaries, so I have to do it myself. Very
annoying.

Anyway, here is the problematic output from running make:

make[3]: Entering directory
> '/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts/sqlite'
> /bin/bash /home/ben/software/gdal/gdal-3.1.0/libtool --mode=compile
> --silent --tag=CXX g++ -I/home/ben/software/gdal/gdal-3.1.0/port
> -I/home/ben/software/gdal/gdal-3.1.0/gcore
> -I/home/ben/software/gdal/gdal-3.1.0/alg
> -I/home/ben/software/gdal/gdal-3.1.0/ogr
> -I/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts
> -I/home/ben/software/gdal/gdal-3.1.0/gnm
> -I/home/ben/software/gdal/gdal-3.1.0/apps -DHAVE_AVX_AT_COMPILE_TIME
> -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall
> -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security
> -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
> -Wnull-dereference -Wduplicated-cond -Wfloat-conversion
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
> -Wimplicit-fallthrough  -I..    -I/usr/local/include  -DGNM_ENABLED
> -D_REENTRANT  -I/home/ben/software/gdal/gdal-3.1.0/port
> -I/usr/include/openjpeg-2.3 -I/usr/include -I/usr/local/share/libgta
> -I/usr/local/share/libgta/include -I/usr -I/usr/include  -DGDAL_COMPILATION
> -DHAVE_XERCES -I/usr/include -I/usr/include/xercesc -D_REENTRANT
>  -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
> -I/usr/include -I/usr/local/share/libgta -I/usr/local/share/libgta/include
> -I/usr -I/usr/include  -DGDAL_COMPILATION -DHAVE_SPATIALITE
> -DSPATIALITE_412_OR_LATER -DHAVE_PCRE -DSQLITE_HAS_COLUMN_METADATA
> -DHAVE_RASTERLITE2  -c -o ../o/rasterlite2.lo rasterlite2.cpp
> rasterlite2.cpp: In function ‘GDALDataset* OGRSQLiteDriverCreateCopy(const
> char*, GDALDataset*, int, char**, GDALProgressFunc, void*)’:
> rasterlite2.cpp:2283:57: error: invalid conversion from ‘void*’ to
> ‘rl2CoveragePtr {aka rl2_coverage*}’ [-fpermissive]
>                                       poDS->GetRL2Context(),
>                                       ~~~~~~~~~~~~~~~~~~~^~
> rasterlite2.cpp:2292:49: error: cannot convert ‘rl2CoveragePtr {aka
> rl2_coverage*}’ to ‘const char*’ for argument ‘3’ to ‘int
> rl2_load_raw_tiles_into_dbms(sqlite3*, rl2CoveragePtr, const char*,
> unsigned int, unsigned int, int, double, double, double, double, int
> (*)(void*, double, double, double, double, unsigned char*, rl2Palette**),
> void*, int)’
>                                       bPyramidize) != RL2_OK )
>                                                  ^
> rasterlite2.cpp: In member function ‘virtual CPLErr
> OGRSQLiteDataSource::IBuildOverviews(const char*, int, int*, int, int*,
> GDALProgressFunc, void*)’:
> rasterlite2.cpp:2382:68: error: invalid conversion from ‘void*’ to ‘int’
> [-fpermissive]
>                  ret = rl2_build_section_pyramid( hDB, GetRL2Context(),
>                                                        ~~~~~~~~~~~~~^~
> In file included from rasterlite2_header.h:46:0,
>                  from ogr_sqlite.h:44,
>                  from rasterlite2.cpp:37:
> /usr/local/include/rasterlite2/rasterlite2.h:4735:2: note:   initializing
> argument 2 of ‘int rl2_build_section_pyramid(sqlite3*, int, const char*,
> sqlite3_int64, int, int)’
>   rl2_build_section_pyramid (sqlite3 * handle, int max_threads,
>   ^~~~~~~~~~~~~~~~~~~~~~~~~
> rasterlite2.cpp:2388:71: error: invalid conversion from ‘void*’ to ‘const
> char*’ [-fpermissive]
>                  ret = rl2_build_monolithic_pyramid (hDB, GetRL2Context(),
>                                                           ~~~~~~~~~~~~~^~
> rasterlite2.cpp:2389:53: error: invalid user-defined conversion from
> ‘CPLString’ to ‘int’ [-fpermissive]
>                                                      m_osCoverageName,
>                                                      ^~~~~~~~~~~~~~~~
> In file included from
> /home/ben/software/gdal/gdal-3.1.0/gcore/gdal_priv.h:64:0,
>                  from
> /home/ben/software/gdal/gdal-3.1.0/gcore/gdal_pam.h:35,
>                  from ogr_sqlite.h:41,
>                  from rasterlite2.cpp:37:
> /home/ben/software/gdal/gdal-3.1.0/port/cpl_string.h:348:5: note:
> candidate is: CPLString::operator const char*() const <near match>
>      operator const char* (void) const { return c_str(); }
>      ^~~~~~~~
> /home/ben/software/gdal/gdal-3.1.0/port/cpl_string.h:348:5: note:   no
> known conversion from ‘const char*’ to ‘int’
> rasterlite2.cpp:2391:61: error: too many arguments to function ‘int
> rl2_build_monolithic_pyramid(sqlite3*, const char*, int, int)’
>                                                      bVerbose);
>                                                              ^
> In file included from rasterlite2_header.h:46:0,
>                  from ogr_sqlite.h:44,
>                  from rasterlite2.cpp:37:
> /usr/local/include/rasterlite2/rasterlite2.h:4741:2: note: declared here
>   rl2_build_monolithic_pyramid (sqlite3 * handle, const char *coverage,
>   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
> rasterlite2.cpp:2398:62: error: invalid conversion from ‘void*’ to ‘const
> char*’ [-fpermissive]
>                                                  GetRL2Context(),
>                                                  ~~~~~~~~~~~~~^~
> rasterlite2.cpp:2399:49: error: invalid user-defined conversion from
> ‘CPLString’ to ‘int’ [-fpermissive]
>                                                  m_osCoverageName,
>                                                  ^~~~~~~~~~~~~~~~
> In file included from
> /home/ben/software/gdal/gdal-3.1.0/gcore/gdal_priv.h:64:0,
>                  from
> /home/ben/software/gdal/gdal-3.1.0/gcore/gdal_pam.h:35,
>                  from ogr_sqlite.h:41,
>                  from rasterlite2.cpp:37:
> /home/ben/software/gdal/gdal-3.1.0/port/cpl_string.h:348:5: note:
> candidate is: CPLString::operator const char*() const <near match>
>      operator const char* (void) const { return c_str(); }
>      ^~~~~~~~
> /home/ben/software/gdal/gdal-3.1.0/port/cpl_string.h:348:5: note:   no
> known conversion from ‘const char*’ to ‘int’
> rasterlite2.cpp:2401:57: error: too many arguments to function ‘int
> rl2_build_monolithic_pyramid(sqlite3*, const char*, int, int)’
>                                                  bVerbose);
>                                                          ^
> In file included from rasterlite2_header.h:46:0,
>                  from ogr_sqlite.h:44,
>                  from rasterlite2.cpp:37:
> /usr/local/include/rasterlite2/rasterlite2.h:4741:2: note: declared here
>   rl2_build_monolithic_pyramid (sqlite3 * handle, const char *coverage,
>   ^~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ../../../GDALmake.opt:649: recipe for target '../o/rasterlite2.lo' failed
> make[3]: *** [../o/rasterlite2.lo] Error 1
> make[3]: Leaving directory
> '/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts/sqlite'
> ../../GDALmake.opt:662: recipe for target 'sqlite-target' failed
> make[2]: *** [sqlite-target] Error 2
> make[2]: Leaving directory
> '/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts'
> GNUmakefile:58: recipe for target 'sublibs' failed
> make[1]: *** [sublibs] Error 2
> make[1]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/ogr'
> GNUmakefile:91: recipe for target 'ogr-target' failed
> make: *** [ogr-target] Error 2


I have librasterlite3 version 1.1.0-beta0-1 installed on my system, so
that's the version that it's linking against or whatever. Honestly doing
this is such a nightmare, makes me wish we had OSGEO4W on Linux.

For reference, here is my configure command:

> ./configure \
> --with-libz=internal \
> --with-liblzma=yes \
> --with-zstd=yes \
> --with-pg=yes \
> --with-cfitsio=/usr \
> --with-gta=/usr/local/share/libgta \
> --with-libtiff=yes \
> --with-charls \
> --with-sosi=yes \
> --with-kea=yes \
> --with-netcdf=/usr/bin \
> --with-fgdb=/opt/FileGDB_API-64 \
> --with-epsilon \
> --with-mysql=/usr/bin/mysql_config \
> --with-dods-root=/usr \
> --with-spatialite=yes \
> --with-rasterlite2=yes \
> --with-sfcgal=yes \
> --with-poppler=yes \
> --with-opencl \
> --with-armadillo=yes \
> --with-mdb \
> --with-java \
> --with-proj=/usr/local \
> --with-mrsid=/opt/mrsid/Raster_DSDK/ \
> --prefix=/usr \
>     --with-python=python2.7 --with-python=python3.6 \
> --with-grass=/usr/lib/grass74 \
> --with-libgrass=/usr/lib/grass74/lib \
> --with-ogdi=no

Basically I've been trying to build GDAL with as many drivers as possible.
Some of them I just couldn't get to work, which I guess is whatever, but I
definitely need rasterlite2, so this not working is a problem.

Any chance someone can point me in the right direction here? I know I was
able to compile version 2.4.0 back in December after hours of headaches,
hoping to avoid such a process this time around.

Thanks,
Ben Van Riper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/f6ded0d6/attachment.html>

From even.rouault at spatialys.com  Tue May 26 12:33:12 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2020 21:33:12 +0200
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
In-Reply-To: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
References: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
Message-ID: <88385906.CX3AAS7Y6c@even-i700>

> 
> Anyway, here is the problematic output from running make:

See this thread:
https://lists.osgeo.org/pipermail/gdal-dev/2020-February/
051613.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/802a510f/attachment.html>

From even.rouault at spatialys.com  Tue May 26 13:32:38 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2020 22:32:38 +0200
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
In-Reply-To: <CABitnoWabkVf_LuJ4y3vsiDQC=+kkLNbtgREfrx-u_XyA-bspw@mail.gmail.com>
References: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
 <88385906.CX3AAS7Y6c@even-i700>
 <CABitnoWabkVf_LuJ4y3vsiDQC=+kkLNbtgREfrx-u_XyA-bspw@mail.gmail.com>
Message-ID: <4454028.QBvLITer0I@even-i700>

> I'm compiling against PROJ6, if that explains any of these issues. I know
> that I had to go into one of the makefiles in the source tree and add a
> compiler flag to allow use of the deprecated API, (don't remember the flag
> name), so maybe this is related to that?

Quite certainly. Don't do this. It is likely that in your include path you have 
the proj.h file of PROJ 5, and proj_experimental.h includes that one instead 
of the proj.h that matches it. Some cleanup in your build environment seems 
necessary

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/64d3f070/attachment-0001.html>

From bengvr at gmail.com  Tue May 26 14:02:12 2020
From: bengvr at gmail.com (Ben Van Riper)
Date: Tue, 26 May 2020 17:02:12 -0400
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
In-Reply-To: <4454028.QBvLITer0I@even-i700>
References: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
 <88385906.CX3AAS7Y6c@even-i700>
 <CABitnoWabkVf_LuJ4y3vsiDQC=+kkLNbtgREfrx-u_XyA-bspw@mail.gmail.com>
 <4454028.QBvLITer0I@even-i700>
Message-ID: <CABitnoWMtwD3R1cMtuy2FEQ8UGg7eH4Ezums1G7vkrnWPS8R4w@mail.gmail.com>

I undid the changes that I made to the makefiles and am now getting the
following error:
>
> make[2]: Entering directory
> '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
> /bin/bash /home/ben/software/gdal/gdal-3.1.0/libtool --mode=compile
> --silent --tag=CXX g++ -I/home/ben/software/gdal/gdal-3.1.0/port
> -I/home/ben/software/gdal/gdal-3.1.0/gcore
> -I/home/ben/software/gdal/gdal-3.1.0/alg
> -I/home/ben/software/gdal/gdal-3.1.0/ogr
> -I/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts
> -I/home/ben/software/gdal/gdal-3.1.0/gnm
> -I/home/ben/software/gdal/gdal-3.1.0/apps -DHAVE_AVX_AT_COMPILE_TIME
> -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall
> -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security
> -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
> -Wnull-dereference -Wduplicated-cond -Wfloat-conversion
> -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
> -Wimplicit-fallthrough  -DGRASS_GISBASE=\"/usr/lib/grass74\"
> -I/usr/lib/grass74/include -I/usr/local/include -DGNM_ENABLED -D_REENTRANT
>  -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
> -I/usr/include -I/usr/local/share/libgta -I/usr/local/share/libgta/include
> -I/usr -I/usr/include  -DGDAL_COMPILATION -DHAVE_XERCES -I/usr/include
> -I/usr/include/xercesc -D_REENTRANT
>  -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
> -I/usr/include -I/usr/local/share/libgta -I/usr/local/share/libgta/include
> -I/usr -I/usr/include  -DGDAL_COMPILATION -c -o ../o/grass57dataset.lo
> grass57dataset.cpp
> In file included from /usr/lib/grass74/include/grass/gprojects.h:21:0,
>                  from grass57dataset.cpp:50:
> /usr/local/include/proj_api.h:37:2: error: #error 'To use the proj_api.h
> you must define the macro ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
>  #error 'To use the proj_api.h you must define the macro
> ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
>   ^~~~~
> ../../GDALmake.opt:649: recipe for target '../o/grass57dataset.lo' failed
> make[2]: *** [../o/grass57dataset.lo] Error 1
> make[2]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
> GNUmakefile:15: recipe for target 'grass-install-obj' failed
> make[1]: *** [grass-install-obj] Error 2
> make[1]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/frmts'
> GNUmakefile:105: recipe for target 'frmts-target' failed
> make: *** [frmts-target] Error 2
>
When you say that my environment might be linking against the proj.h from
PROJ5, I think that's possible, and if I'm not mistaken, I did have PROJ5
installed (or was it 4?) when I compiled GDAL v2.4.0. I suppose I can
uninstall the old version and try again, but does that explain the current
error I'm having?

On Tue, May 26, 2020 at 4:32 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> > I'm compiling against PROJ6, if that explains any of these issues. I know
>
> > that I had to go into one of the makefiles in the source tree and add a
>
> > compiler flag to allow use of the deprecated API, (don't remember the
> flag
>
> > name), so maybe this is related to that?
>
>
>
> Quite certainly. Don't do this. It is likely that in your include path you
> have the proj.h file of PROJ 5, and proj_experimental.h includes that one
> instead of the proj.h that matches it. Some cleanup in your build
> environment seems necessary
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/a487058d/attachment.html>

From even.rouault at spatialys.com  Tue May 26 14:05:56 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 26 May 2020 23:05:56 +0200
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
In-Reply-To: <CABitnoWMtwD3R1cMtuy2FEQ8UGg7eH4Ezums1G7vkrnWPS8R4w@mail.gmail.com>
References: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
 <4454028.QBvLITer0I@even-i700>
 <CABitnoWMtwD3R1cMtuy2FEQ8UGg7eH4Ezums1G7vkrnWPS8R4w@mail.gmail.com>
Message-ID: <2108166.1el4QEVKNM@even-i700>

On mardi 26 mai 2020 17:02:12 CEST Ben Van Riper wrote:
> I undid the changes that I made to the makefiles and am now getting the
> 
> following error:
> > make[2]: Entering directory
> > '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
> > /bin/bash /home/ben/software/gdal/gdal-3.1.0/libtool --mode=compile
> > --silent --tag=CXX g++ -I/home/ben/software/gdal/gdal-3.1.0/port
> > -I/home/ben/software/gdal/gdal-3.1.0/gcore
> > -I/home/ben/software/gdal/gdal-3.1.0/alg
> > -I/home/ben/software/gdal/gdal-3.1.0/ogr
> > -I/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts
> > -I/home/ben/software/gdal/gdal-3.1.0/gnm
> > -I/home/ben/software/gdal/gdal-3.1.0/apps -DHAVE_AVX_AT_COMPILE_TIME
> > -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2  -Wall
> > -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security
> > -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
> > -Wnull-dereference -Wduplicated-cond -Wfloat-conversion
> > -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
> > -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
> > -Wimplicit-fallthrough  -DGRASS_GISBASE=\"/usr/lib/grass74\"
> > -I/usr/lib/grass74/include -I/usr/local/include -DGNM_ENABLED -D_REENTRANT
> > 
> >  -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
> > 
> > -I/usr/include -I/usr/local/share/libgta -I/usr/local/share/libgta/include
> > -I/usr -I/usr/include  -DGDAL_COMPILATION -DHAVE_XERCES -I/usr/include
> > -I/usr/include/xercesc -D_REENTRANT
> > 
> >  -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
> > 
> > -I/usr/include -I/usr/local/share/libgta -I/usr/local/share/libgta/include
> > -I/usr -I/usr/include  -DGDAL_COMPILATION -c -o ../o/grass57dataset.lo
> > grass57dataset.cpp
> > In file included from /usr/lib/grass74/include/grass/gprojects.h:21:0,
> > 
> >                  from grass57dataset.cpp:50:
> > /usr/local/include/proj_api.h:37:2: error: #error 'To use the proj_api.h
> > you must define the macro ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
> > 
> >  #error 'To use the proj_api.h you must define the macro
> > 
> > ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
> > 
> >   ^~~~~
> > 
> > ../../GDALmake.opt:649: recipe for target '../o/grass57dataset.lo' failed
> > make[2]: *** [../o/grass57dataset.lo] Error 1
> > make[2]: Leaving directory
> > '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
> > GNUmakefile:15: recipe for target 'grass-install-obj' failed
> > make[1]: *** [grass-install-obj] Error 2
> > make[1]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/frmts'
> > GNUmakefile:105: recipe for target 'frmts-target' failed
> > make: *** [frmts-target] Error 2
> 
> When you say that my environment might be linking against the proj.h from
> PROJ5, I think that's possible, and if I'm not mistaken, I did have PROJ5
> installed (or was it 4?) when I compiled GDAL v2.4.0. I suppose I can
> uninstall the old version and try again, but does that explain the current
> error I'm having?

Ah that might be something different. It might be that grass 7.4 still tries to use the old 
proj_api.h. I'm not completely sure of the effect of building GDAL 3 with  
ACCEPT_USE_OF_DEPRECATED_PROJ_API_H defined. I'd say, either drop the GRASS driver if 
you don't need it, or upgrade to a more recent GRASS version that can use PROJ >= 5 API

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/7020ca35/attachment-0001.html>

From bengvr at gmail.com  Tue May 26 14:42:52 2020
From: bengvr at gmail.com (Ben Van Riper)
Date: Tue, 26 May 2020 17:42:52 -0400
Subject: [gdal-dev] Cannot Build GDAL 3.1.0 on Ubuntu 18.04
In-Reply-To: <2108166.1el4QEVKNM@even-i700>
References: <CABitnoVcgq8hgn6jFXG0-FKTV8MYX5HdYOgo9YKxVYcNn9_E6w@mail.gmail.com>
 <4454028.QBvLITer0I@even-i700>
 <CABitnoWMtwD3R1cMtuy2FEQ8UGg7eH4Ezums1G7vkrnWPS8R4w@mail.gmail.com>
 <2108166.1el4QEVKNM@even-i700>
Message-ID: <CABitnoWZ7Wt17Wps+BuqQAs5APdrs_sQGeYtsUOhXuze2NUrzw@mail.gmail.com>

Upgrading to GRASS 7.8 fixed that problem, and consequentially revealed
another one. I'm going to trim some of the output because there's a lot of
it.


> In file included from /usr/include/c++/7/list:63:0,
>                  from
> /home/ben/software/gdal/gdal-3.1.0/port/cpl_mem_cache.h:37,
>                  from ogr_proj_p.h:34,
>                  from ogrspatialreference.cpp:53:
> /usr/include/c++/7/bits/stl_list.h:503:11: note:   ‘std::__cxx11::list’
>      class list : protected _List_base<_Tp, _Alloc>
>            ^~~~
> /usr/include/c++/7/bits/stl_list.h:503:11: note:   ‘std::__cxx11::list’
> ogrspatialreference.cpp:10880:64: error: ‘type’ was not declared in this
> scope
>          d->getPROJContext(), "ESRI", "NAD_1983_HARN_WISCRS_", &type, 1,
> true,
>                                                                 ^~~~
> ogrspatialreference.cpp:10880:64: note: suggested alternative: ‘pipe’
>          d->getPROJContext(), "ESRI", "NAD_1983_HARN_WISCRS_", &type, 1,
> true,
>                                                                 ^~~~
>                                                                 pipe
> ogrspatialreference.cpp:10879:25: error: ‘proj_create_from_name’ was not
> declared in this scope
>      PJ_OBJ_LIST* list = proj_create_from_name(
>                          ^~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10879:25: note: suggested alternative:
> ‘proj_create_argv’
>      PJ_OBJ_LIST* list = proj_create_from_name(
>                          ^~~~~~~~~~~~~~~~~~~~~
>                          proj_create_argv
> ogrspatialreference.cpp:10884:31: error: ‘proj_list_get_count’ was not
> declared in this scope
>          const auto listSize = proj_list_get_count(list);
>                                ^~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10884:31: note: suggested alternative:
> ‘proj_list_units’
>          const auto listSize = proj_list_get_count(list);
>                                ^~~~~~~~~~~~~~~~~~~
>                                proj_list_units
> ogrspatialreference.cpp:10887:24: error: ‘proj_list_get’ was not declared
> in this scope
>              auto crs = proj_list_get(d->getPROJContext(), list, i);
>                         ^~~~~~~~~~~~~
> ogrspatialreference.cpp:10887:24: note: suggested alternative:
> ‘proj_list_units’
>              auto crs = proj_list_get(d->getPROJContext(), list, i);
>                         ^~~~~~~~~~~~~
>                         proj_list_units
> ogrspatialreference.cpp:10893:25: error: ‘proj_crs_get_coordoperation’ was
> not declared in this scope
>              auto conv = proj_crs_get_coordoperation(
>                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10893:25: note: suggested alternative:
> ‘proj_list_operations’
>              auto conv = proj_crs_get_coordoperation(
>                          ^~~~~~~~~~~~~~~~~~~~~~~~~~~
>                          proj_list_operations
> ogrspatialreference.cpp:10901:13: error:
> ‘proj_coordoperation_get_method_info’ was not declared in this scope
>              proj_coordoperation_get_method_info(
>              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10914:29: error: ‘proj_crs_get_coordinate_system’
> was not declared in this scope
>              auto coordSys = proj_crs_get_coordinate_system(
>                              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10924:13: error: ‘proj_cs_get_axis_info’ was not
> declared in this scope
>              proj_cs_get_axis_info(
>              ^~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10924:13: note: suggested alternative:
> ‘proj_grid_info’
>              proj_cs_get_axis_info(
>              ^~~~~~~~~~~~~~~~~~~~~
>              proj_grid_info
> ogrspatialreference.cpp:10938:27: error:
> ‘proj_coordoperation_get_param_index’ was not declared in this scope
>              int idx_lat = proj_coordoperation_get_param_index(
>                            ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10942:13: error: ‘proj_coordoperation_get_param’
> was not declared in this scope
>              proj_coordoperation_get_param(
>              ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10959:17: error: ‘proj_list_destroy’ was not
> declared in this scope
>                  proj_list_destroy(list);
>                  ^~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10959:17: note: suggested alternative:
> ‘proj_destroy’
>                  proj_list_destroy(list);
>                  ^~~~~~~~~~~~~~~~~
>                  proj_destroy
> ogrspatialreference.cpp:10967:9: error: ‘proj_list_destroy’ was not
> declared in this scope
>          proj_list_destroy(list);
>          ^~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:10967:9: note: suggested alternative:
> ‘proj_destroy’
>          proj_list_destroy(list);
>          ^~~~~~~~~~~~~~~~~
>          proj_destroy
> ogrspatialreference.cpp: In member function ‘bool
> OGRSpatialReference::GetAreaOfUse(double*, double*, double*, double*, const
> char**) const’:
> ogrspatialreference.cpp:11172:20: error: ‘proj_get_area_of_use’ was not
> declared in this scope
>      int bSuccess = proj_get_area_of_use(
>                     ^~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11172:20: note: suggested alternative:
> ‘proj_errno_set’
>      int bSuccess = proj_get_area_of_use(
>                     ^~~~~~~~~~~~~~~~~~~~
>                     proj_errno_set
> ogrspatialreference.cpp: In function ‘OSRCRSInfo**
> OSRGetCRSInfoListFromDatabase(const char*, const OSRCRSListParameters*,
> int*)’:
> ogrspatialreference.cpp:11237:21: error:
> ‘proj_get_crs_info_list_from_database’ was not declared in this scope
>      auto projList =
> proj_get_crs_info_list_from_database(OSRGetProjTLSContext(),
>                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11237:21: note: suggested alternative:
> ‘OSRGetCRSInfoListFromDatabase’
>      auto projList =
> proj_get_crs_info_list_from_database(OSRGetProjTLSContext(),
>                      ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
>                      OSRGetCRSInfoListFromDatabase
> ogrspatialreference.cpp:11260:18: error: ‘PJ_TYPE_GEOGRAPHIC_2D_CRS’ was
> not declared in this scope
>              case PJ_TYPE_GEOGRAPHIC_2D_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11260:18: note: suggested alternative:
> ‘OSR_CRS_TYPE_GEOGRAPHIC_2D’
>              case PJ_TYPE_GEOGRAPHIC_2D_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~~~~
>                   OSR_CRS_TYPE_GEOGRAPHIC_2D
> ogrspatialreference.cpp:11262:18: error: ‘PJ_TYPE_GEOGRAPHIC_3D_CRS’ was
> not declared in this scope
>              case PJ_TYPE_GEOGRAPHIC_3D_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11262:18: note: suggested alternative:
> ‘OSR_CRS_TYPE_GEOGRAPHIC_3D’
>              case PJ_TYPE_GEOGRAPHIC_3D_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~~~~
>                   OSR_CRS_TYPE_GEOGRAPHIC_3D
> ogrspatialreference.cpp:11264:18: error: ‘PJ_TYPE_GEOCENTRIC_CRS’ was not
> declared in this scope
>              case PJ_TYPE_GEOCENTRIC_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11264:18: note: suggested alternative:
> ‘OSR_CRS_TYPE_GEOCENTRIC’
>              case PJ_TYPE_GEOCENTRIC_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~~
>                   OSR_CRS_TYPE_GEOCENTRIC
> ogrspatialreference.cpp:11266:18: error: ‘PJ_TYPE_PROJECTED_CRS’ was not
> declared in this scope
>              case PJ_TYPE_PROJECTED_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11266:18: note: suggested alternative:
> ‘OSR_CRS_TYPE_PROJECTED’
>              case PJ_TYPE_PROJECTED_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~~
>                   OSR_CRS_TYPE_PROJECTED
> ogrspatialreference.cpp:11268:18: error: ‘PJ_TYPE_VERTICAL_CRS’ was not
> declared in this scope
>              case PJ_TYPE_VERTICAL_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11270:18: error: ‘PJ_TYPE_COMPOUND_CRS’ was not
> declared in this scope
>              case PJ_TYPE_COMPOUND_CRS:
>                   ^~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11287:5: error: ‘proj_crs_info_list_destroy’ was
> not declared in this scope
>      proj_crs_info_list_destroy(projList);
>      ^~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11287:5: note: suggested alternative:
> ‘proj_context_destroy’
>      proj_crs_info_list_destroy(projList);
>      ^~~~~~~~~~~~~~~~~~~~~~~~~~
>      proj_context_destroy
> ogrspatialreference.cpp: In member function ‘void
> OGRSpatialReference::UpdateCoordinateSystemFromGeogCRS()’:
> ogrspatialreference.cpp:11332:12: error: ‘struct
> OGRSpatialReference::Private’ has no member named ‘m_pjType’; did you mean
> ‘m_pj_crs’?
>      if( d->m_pjType != PJ_TYPE_PROJECTED_CRS )
>             ^~~~~~~~
>             m_pj_crs
> ogrspatialreference.cpp:11332:24: error: ‘PJ_TYPE_PROJECTED_CRS’ was not
> declared in this scope
>      if( d->m_pjType != PJ_TYPE_PROJECTED_CRS )
>                         ^~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11332:24: note: suggested alternative:
> ‘OSR_CRS_TYPE_PROJECTED’
>      if( d->m_pjType != PJ_TYPE_PROJECTED_CRS )
>                         ^~~~~~~~~~~~~~~~~~~~~
>                         OSR_CRS_TYPE_PROJECTED
> ogrspatialreference.cpp:11337:20: error: ‘proj_crs_get_geodetic_crs’ was
> not declared in this scope
>      auto baseCRS = proj_crs_get_geodetic_crs(ctxt, d->m_pj_crs);
>                     ^~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11337:20: note: suggested alternative:
> ‘proj_create_crs_to_crs’
>      auto baseCRS = proj_crs_get_geodetic_crs(ctxt, d->m_pj_crs);
>                     ^~~~~~~~~~~~~~~~~~~~~~~~~
>                     proj_create_crs_to_crs
> ogrspatialreference.cpp:11340:22: error: ‘proj_crs_get_coordinate_system’
> was not declared in this scope
>      auto baseCRSCS = proj_crs_get_coordinate_system(ctxt, baseCRS);
>                       ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11346:9: error: ‘proj_cs_get_axis_count’ was not
> declared in this scope
>      if( proj_cs_get_axis_count(ctxt, baseCRSCS) != 3 )
>          ^~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11353:20: error: ‘proj_cs_get_axis_count’ was not
> declared in this scope
>      if( !projCS || proj_cs_get_axis_count(ctxt, projCS) != 2 )
>                     ^~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11369:9: error: ‘proj_cs_get_axis_info’ was not
> declared in this scope
>          proj_cs_get_axis_info(ctxt,
>          ^~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11369:9: note: suggested alternative:
> ‘proj_grid_info’
>          proj_cs_get_axis_info(ctxt,
>          ^~~~~~~~~~~~~~~~~~~~~
>          proj_grid_info
> ogrspatialreference.cpp:11386:36: error: ‘PJ_CS_TYPE_CARTESIAN’ was not
> declared in this scope
>      auto cs = proj_create_cs(ctxt, PJ_CS_TYPE_CARTESIAN, 3, axis);
>                                     ^~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11386:36: note: suggested alternative:
> ‘OSR_CRS_TYPE_VERTICAL’
>      auto cs = proj_create_cs(ctxt, PJ_CS_TYPE_CARTESIAN, 3, axis);
>                                     ^~~~~~~~~~~~~~~~~~~~
>                                     OSR_CRS_TYPE_VERTICAL
> ogrspatialreference.cpp:11386:15: error: ‘proj_create_cs’ was not declared
> in this scope
>      auto cs = proj_create_cs(ctxt, PJ_CS_TYPE_CARTESIAN, 3, axis);
>                ^~~~~~~~~~~~~~
> ogrspatialreference.cpp:11386:15: note: suggested alternative:
> ‘proj_create’
>      auto cs = proj_create_cs(ctxt, PJ_CS_TYPE_CARTESIAN, 3, axis);
>                ^~~~~~~~~~~~~~
>                proj_create
> ogrspatialreference.cpp:11399:23: error: ‘proj_crs_get_coordoperation’ was
> not declared in this scope
>      auto conversion = proj_crs_get_coordoperation(ctxt, d->m_pj_crs);
>                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11399:23: note: suggested alternative:
> ‘proj_list_operations’
>      auto conversion = proj_crs_get_coordoperation(ctxt, d->m_pj_crs);
>                        ^~~~~~~~~~~~~~~~~~~~~~~~~~~
>                        proj_list_operations
> ogrspatialreference.cpp:11400:16: error: ‘proj_create_projected_crs’ was
> not declared in this scope
>      auto crs = proj_create_projected_crs(ctxt,
>                 ^~~~~~~~~~~~~~~~~~~~~~~~~
> ogrspatialreference.cpp:11400:16: note: suggested alternative:
> ‘proj_create_crs_to_crs’
>      auto crs = proj_create_projected_crs(ctxt,
>                 ^~~~~~~~~~~~~~~~~~~~~~~~~
>                 proj_create_crs_to_crs
> ogrspatialreference.cpp: At global scope:
> ogrspatialreference.cpp:322:13: warning: ‘bool
> isNorthEastAxisOrder(PJ_CONTEXT*, PJ*)’ defined but not used
> [-Wunused-function]
>  static bool isNorthEastAxisOrder(PJ_CONTEXT* ctx, PJ* cs)
>              ^~~~~~~~~~~~~~~~~~~~
> ../GDALmake.opt:655: recipe for target 'ogrspatialreference.lo' failed
> make[1]: *** [ogrspatialreference.lo] Error 1
> make[1]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/ogr'
> GNUmakefile:91: recipe for target 'ogr-target' failed
> make: *** [ogr-target] Error 2
>

On Tue, May 26, 2020 at 5:05 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 26 mai 2020 17:02:12 CEST Ben Van Riper wrote:
>
> > I undid the changes that I made to the makefiles and am now getting the
>
> >
>
> > following error:
>
> > > make[2]: Entering directory
>
> > > '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
>
> > > /bin/bash /home/ben/software/gdal/gdal-3.1.0/libtool --mode=compile
>
> > > --silent --tag=CXX g++ -I/home/ben/software/gdal/gdal-3.1.0/port
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/gcore
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/alg
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/ogr
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/ogr/ogrsf_frmts
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/gnm
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/apps -DHAVE_AVX_AT_COMPILE_TIME
>
> > > -DHAVE_SSSE3_AT_COMPILE_TIME -DHAVE_SSE_AT_COMPILE_TIME -g -O2 -Wall
>
> > > -Wextra -Winit-self -Wunused-parameter -Wformat -Werror=format-security
>
> > > -Wno-format-nonliteral -Wlogical-op -Wshadow -Werror=vla -Wdate-time
>
> > > -Wnull-dereference -Wduplicated-cond -Wfloat-conversion
>
> > > -Wmissing-declarations -Wnon-virtual-dtor -Woverloaded-virtual
>
> > > -fno-operator-names -Wzero-as-null-pointer-constant -Wsuggest-override
>
> > > -Wimplicit-fallthrough -DGRASS_GISBASE=\"/usr/lib/grass74\"
>
> > > -I/usr/lib/grass74/include -I/usr/local/include -DGNM_ENABLED
> -D_REENTRANT
>
> > >
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
>
> > >
>
> > > -I/usr/include -I/usr/local/share/libgta
> -I/usr/local/share/libgta/include
>
> > > -I/usr -I/usr/include -DGDAL_COMPILATION -DHAVE_XERCES -I/usr/include
>
> > > -I/usr/include/xercesc -D_REENTRANT
>
> > >
>
> > > -I/home/ben/software/gdal/gdal-3.1.0/port -I/usr/include/openjpeg-2.3
>
> > >
>
> > > -I/usr/include -I/usr/local/share/libgta
> -I/usr/local/share/libgta/include
>
> > > -I/usr -I/usr/include -DGDAL_COMPILATION -c -o ../o/grass57dataset.lo
>
> > > grass57dataset.cpp
>
> > > In file included from /usr/lib/grass74/include/grass/gprojects.h:21:0,
>
> > >
>
> > > from grass57dataset.cpp:50:
>
> > > /usr/local/include/proj_api.h:37:2: error: #error 'To use the
> proj_api.h
>
> > > you must define the macro ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
>
> > >
>
> > > #error 'To use the proj_api.h you must define the macro
>
> > >
>
> > > ACCEPT_USE_OF_DEPRECATED_PROJ_API_H'
>
> > >
>
> > > ^~~~~
>
> > >
>
> > > ../../GDALmake.opt:649: recipe for target '../o/grass57dataset.lo'
> failed
>
> > > make[2]: *** [../o/grass57dataset.lo] Error 1
>
> > > make[2]: Leaving directory
>
> > > '/home/ben/software/gdal/gdal-3.1.0/frmts/grass'
>
> > > GNUmakefile:15: recipe for target 'grass-install-obj' failed
>
> > > make[1]: *** [grass-install-obj] Error 2
>
> > > make[1]: Leaving directory '/home/ben/software/gdal/gdal-3.1.0/frmts'
>
> > > GNUmakefile:105: recipe for target 'frmts-target' failed
>
> > > make: *** [frmts-target] Error 2
>
> >
>
> > When you say that my environment might be linking against the proj.h from
>
> > PROJ5, I think that's possible, and if I'm not mistaken, I did have PROJ5
>
> > installed (or was it 4?) when I compiled GDAL v2.4.0. I suppose I can
>
> > uninstall the old version and try again, but does that explain the
> current
>
> > error I'm having?
>
>
>
> Ah that might be something different. It might be that grass 7.4 still
> tries to use the old proj_api.h. I'm not completely sure of the effect of
> building GDAL 3 with ACCEPT_USE_OF_DEPRECATED_PROJ_API_H defined. I'd say,
> either drop the GRASS driver if you don't need it, or upgrade to a more
> recent GRASS version that can use PROJ >= 5 API
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20200526/a77fde6d/attachment-0001.html>

