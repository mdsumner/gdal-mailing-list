From kai.muehlbauer at uni-bonn.de  Thu Jun  1 09:13:00 2017
From: kai.muehlbauer at uni-bonn.de (Kai Muehlbauer)
Date: Thu, 1 Jun 2017 18:13:00 +0200
Subject: [gdal-dev] DataSource/Dataset using gdal.Grid()
Message-ID: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>

Hi everyone,

I'm using python-bindings gdal.Grid() function to grid scattered data.

I have a in-memory vector point data inside <class
'osgeo.ogr.DataSource'> "ds" which I want to feed directly to gdal.Grid().

ds2 = gdal.Grid('', ds, format='MEM',
                    width=900, height=900,
                    algorithm=algo,
                    zfield='ZX')

Unfortunately I get a "TypeError: in method 'GridInternal', argument 2
of type 'GDALDatasetShadow *'", see complete trace at the end.

If I save this dataset as is to an ESRI-Shapefile "test", I can
successfully do this:

ds2 = gdal.Grid('', 'test', format='MEM',
                    width=900, height=900,
                    algorithm=algo,
                    zfield='ZX')

Although I'm happy to get this running that way, I really would avoid
the save-to-disc part. Can I somehow fake my <osgeo.ogr.DataSource>
object to behave like a Dataset object or do some other magic? Any hints
very much appreciated.

Cheers,
Kai


---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-140-a2fa980db211> in <module>()
     12                     width = 900, height = 900,
     13                     algorithm=algo,
---> 14                     zfield='ZX'
     15                     )
     16 dvx_ip2 = np.flipud(ds2.ReadAsArray())

/home/kai/miniconda3/envs/wradlib36/lib/python3.6/site-packages/osgeo/gdal.py
in Grid(destName, srcDS, **kwargs)
    952         srcDS = OpenEx(srcDS, OF_VECTOR)
    953
--> 954     return GridInternal(destName, srcDS, opts, callback,
callback_data)
    955
    956 def RasterizeOptions(options = [], format = None,

/home/kai/miniconda3/envs/wradlib36/lib/python3.6/site-packages/osgeo/gdal.py
in GridInternal(*args)
   3147 def GridInternal(*args):
   3148     """GridInternal(char const * dest, Dataset dataset,
GDALGridOptions options, GDALProgressFunc callback=0, void *
callback_data=None) -> Dataset"""
-> 3149     return _gdal.GridInternal(*args)
   3150 class GDALRasterizeOptions(_object):
   3151     """Proxy of C++ GDALRasterizeOptions class."""

TypeError: in method 'GridInternal', argument 2 of type
'GDALDatasetShadow *'


-- 
Kai Muehlbauer
Meteorological Institute University of Bonn
Auf dem Huegel 20       | +49 228 739083
D-53121 Bonn            | kai.muehlbauer at uni-bonn.de

From even.rouault at spatialys.com  Thu Jun  1 11:21:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 01 Jun 2017 20:21:21 +0200
Subject: [gdal-dev] DataSource/Dataset using gdal.Grid()
In-Reply-To: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>
References: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>
Message-ID: <2152967.tHejIOCylY@even-i700>

On jeudi 1 juin 2017 18:13:00 CEST Kai Muehlbauer wrote:
> Hi everyone,
> 
> I'm using python-bindings gdal.Grid() function to grid scattered data.
> 
> I have a in-memory vector point data inside <class
> 'osgeo.ogr.DataSource'> "ds" which I want to feed directly to gdal.Grid().
> 
> ds2 = gdal.Grid('', ds, format='MEM',
>                     width=900, height=900,
>                     algorithm=algo,
>                     zfield='ZX')
> 
> Unfortunately I get a "TypeError: in method 'GridInternal', argument 2
> of type 'GDALDatasetShadow *'", see complete trace at the end.
> 
> If I save this dataset as is to an ESRI-Shapefile "test", I can
> successfully do this:
> 
> ds2 = gdal.Grid('', 'test', format='MEM',
>                     width=900, height=900,
>                     algorithm=algo,
>                     zfield='ZX')
> 
> Although I'm happy to get this running that way, I really would avoid
> the save-to-disc part. Can I somehow fake my <osgeo.ogr.DataSource>
> object to behave like a Dataset object or do some other magic? Any hints
> very much appreciated.

gdal.Grid() and other utility-as-a-function requires GDALDataset and not 
legacy OGRDataSource,
so create your vector memory dataset with :

ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0, gdal.GDT_Unknown)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170601/3bcc13c3/attachment.html>

From kai.muehlbauer at uni-bonn.de  Thu Jun  1 12:10:36 2017
From: kai.muehlbauer at uni-bonn.de (=?ISO-8859-1?Q?Kai_M=FChlbauer?=)
Date: Thu, 01 Jun 2017 21:10:36 +0200
Subject: [gdal-dev] DataSource/Dataset using gdal.Grid()
In-Reply-To: <2152967.tHejIOCylY@even-i700>
References: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>
 <2152967.tHejIOCylY@even-i700>
Message-ID: <18D73C18-1813-4031-A109-29B0921BD57D@uni-bonn.de>



Am 1. Juni 2017 20:21:21 MESZ schrieb Even Rouault <even.rouault at spatialys.com>:
>On jeudi 1 juin 2017 18:13:00 CEST Kai Muehlbauer wrote:
>> Hi everyone,
>> 
>> I'm using python-bindings gdal.Grid() function to grid scattered
>data.
>> 
>> I have a in-memory vector point data inside <class
>> 'osgeo.ogr.DataSource'> "ds" which I want to feed directly to
>gdal.Grid().
>> 
>> ds2 = gdal.Grid('', ds, format='MEM',
>>                     width=900, height=900,
>>                     algorithm=algo,
>>                     zfield='ZX')
>> 
>> Unfortunately I get a "TypeError: in method 'GridInternal', argument
>2
>> of type 'GDALDatasetShadow *'", see complete trace at the end.
>> 
>> If I save this dataset as is to an ESRI-Shapefile "test", I can
>> successfully do this:
>> 
>> ds2 = gdal.Grid('', 'test', format='MEM',
>>                     width=900, height=900,
>>                     algorithm=algo,
>>                     zfield='ZX')
>> 
>> Although I'm happy to get this running that way, I really would avoid
>> the save-to-disc part. Can I somehow fake my <osgeo.ogr.DataSource>
>> object to behave like a Dataset object or do some other magic? Any
>hints
>> very much appreciated.
>
>gdal.Grid() and other utility-as-a-function requires GDALDataset and
>not 
>legacy OGRDataSource,
>so create your vector memory dataset with :
>
>ds = gdal.GetDriverByName('Memory').Create('', 0, 0, 0,
>gdal.GDT_Unknown)

Thanks Even, for the fast response. You mention the OGRDataSource as legacy. 
I wasn't aware of that fact. Is there anything important to know about that, because I would need to port quite some code to use the GDALDataset. 

Kai
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170601/6c05ea99/attachment.html>

From even.rouault at spatialys.com  Thu Jun  1 12:27:06 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 01 Jun 2017 21:27:06 +0200
Subject: [gdal-dev] DataSource/Dataset using gdal.Grid()
In-Reply-To: <18D73C18-1813-4031-A109-29B0921BD57D@uni-bonn.de>
References: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>
 <2152967.tHejIOCylY@even-i700>
 <18D73C18-1813-4031-A109-29B0921BD57D@uni-bonn.de>
Message-ID: <24137652.FbkJRC77cz@even-i700>

> Thanks Even, for the fast response. You mention the OGRDataSource as 
legacy.
> I wasn't aware of that fact. Is there anything important to know about
> that, because I would need to port quite some code to use the 
GDALDataset.

Have a look at https://svn.osgeo.org/gdal/trunk/gdal/
MIGRATION_GUIDE.TXT
and particularly
http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170601/aa4a5486/attachment.html>

From kai.muehlbauer at uni-bonn.de  Thu Jun  1 12:48:23 2017
From: kai.muehlbauer at uni-bonn.de (=?ISO-8859-1?Q?Kai_M=FChlbauer?=)
Date: Thu, 01 Jun 2017 21:48:23 +0200
Subject: [gdal-dev] DataSource/Dataset using gdal.Grid()
In-Reply-To: <24137652.FbkJRC77cz@even-i700>
References: <4a6258d4-1cb1-65d2-6b51-1ba13f49a972@uni-bonn.de>
 <2152967.tHejIOCylY@even-i700>
 <18D73C18-1813-4031-A109-29B0921BD57D@uni-bonn.de>
 <24137652.FbkJRC77cz@even-i700>
Message-ID: <AC1A6CD4-0ACD-4618-8D08-D1B95A3A700D@uni-bonn.de>



Am 1. Juni 2017 21:27:06 MESZ schrieb Even Rouault <even.rouault at spatialys.com>:
>> Thanks Even, for the fast response. You mention the OGRDataSource as 
>legacy.
>> I wasn't aware of that fact. Is there anything important to know
>about
>> that, because I would need to port quite some code to use the 
>GDALDataset.
>
>Have a look at https://svn.osgeo.org/gdal/trunk/gdal/
>MIGRATION_GUIDE.TXT
>and particularly
>http://trac.osgeo.org/gdal/wiki/rfc46_gdal_ogr_unification

Thank you again for the pointers. Seems, that my needed changes are not that hard to code. 

Cheers, 
Kai 

From caboe at sdfe.dk  Fri Jun  2 04:23:26 2017
From: caboe at sdfe.dk (=?iso-8859-1?Q?Casper_B=F8rgesen?=)
Date: Fri, 2 Jun 2017 11:23:26 +0000
Subject: [gdal-dev] Problem with polygon and gdal.RasterizeLayer causing
 endless cpu usage
Message-ID: <800A1C4B99390947B3BAA86C02CBDB26FF1C2E@S000014.PROD.SITAD.DK>

Hi devs

I have stumpled upon an issue where I need some help to investigate further. I have a simple polygon which I would like to rasterise into a small quadratic raster (see the code below and also attached ready to run).

I think the problem is the geometry. Using FME and QGIS I have tried to validate the polygon file, but it came back valid. The attached file is created using "Save As..." in QGIS, but the issue also occurs on the original dataset. Running the script prints the WKT and its pretty simple with only 4 points.

Running the script below results in python getting stuck at the line with gdal.RasterizeLayer(...) with high CPU usage. No exceptions, no python crash and looking in task manager I see no change in memory consumption.

In the original file I had more polygons and the three neighbouring polygons (north, north east and east of the polygon) all have the same problems - but not the rest of the polygons in the dataset.

I have tried this using GDAL 2.2.0 x64 running on Windows 7.

Can anyone give me a hint to whats going on in this case? If this is a bug somehow, I will gladly report it. But I think it would help if I was able to narrow down the problem a bit more.

Regards, Casper


    # -*- coding: utf-8 -*-
    import os

    from osgeo import gdal, ogr

    src_polygons = os.path.join(os.path.dirname(os.path.realpath(__file__)), 'polygon.shp')

    data_source = ogr.Open(src_polygons, 0)
    layer = data_source.GetLayer(0)
    projection = layer.GetSpatialRef()
    current_feature = layer.GetNextFeature()
    polygon = current_feature.GetGeometryRef().Clone()
    layer = None
    data_source = None

    print polygon.ExportToWkt()

    geotransform = [499000, 0.4, 0, 6095000, 0, -0.4]

    data_source = ogr.GetDriverByName('MEMORY').CreateDataSource('')
    layer = data_source.CreateLayer('', projection, geom_type=ogr.wkbPolygon)
    feature = ogr.Feature(layer.GetLayerDefn())
    feature.SetGeometry(polygon.Clone())
    layer.CreateFeature(feature)

    mask_ds = gdal.GetDriverByName('Mem').Create('', 5000, 5000, 1, gdal.GDT_Byte)
    mask_ds.SetGeoTransform(geotransform)
    mask_ds.SetProjection(projection.ExportToWkt())

    gdal.RasterizeLayer(mask_ds, [1], layer, burn_values=[1], options=["ALL_TOUCHED"])

    mask = mask_ds.ReadAsArray().astype(int)

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: polygon.dbf
Type: application/octet-stream
Size: 78 bytes
Desc: polygon.dbf
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0005.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: polygon.prj
Type: application/octet-stream
Size: 388 bytes
Desc: polygon.prj
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0006.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: polygon.shp
Type: application/octet-stream
Size: 236 bytes
Desc: polygon.shp
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0007.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: polygon.shx
Type: application/octet-stream
Size: 108 bytes
Desc: polygon.shx
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0008.obj>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.py
Type: application/octet-stream
Size: 1044 bytes
Desc: test.py
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/328da37b/attachment-0009.obj>

From even.rouault at spatialys.com  Fri Jun  2 05:09:12 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 02 Jun 2017 14:09:12 +0200
Subject: [gdal-dev] Problem with polygon and gdal.RasterizeLayer causing
	endless cpu usage
In-Reply-To: <800A1C4B99390947B3BAA86C02CBDB26FF1C2E@S000014.PROD.SITAD.DK>
References: <800A1C4B99390947B3BAA86C02CBDB26FF1C2E@S000014.PROD.SITAD.DK>
Message-ID: <2014349.erYsSB0Bio@even-i700>

Casper,

actually this was known as https://trac.osgeo.org/gdal/ticket/5580

I've just fixed it (at least for your case and the one reported in the 
ticket)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/67e24e63/attachment.html>

From julien.michel at cnes.fr  Fri Jun  2 05:28:18 2017
From: julien.michel at cnes.fr (Julien Michel)
Date: Fri, 2 Jun 2017 14:28:18 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
Message-ID: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>

Dear all,

There is a lot of activity around this Open Data Cube [1] initiative, 
which seems promising. As far as I understand it however, what we can do 
with data in the datacube is limited to what the python API allows you 
to do. Is there any plan (and does it even make sense ?) to have a gdal 
driver that allows to address data ingested in a datacube instance ?

Thanks a lot,

Regards,

Julien

[1] https://github.com/opendatacube/datacube-core

-- 
Julien MICHEL
CNES - DSO/SI/2A


From even.rouault at spatialys.com  Fri Jun  2 06:20:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 02 Jun 2017 15:20:34 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
In-Reply-To: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
References: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
Message-ID: <1827941.29MXtmlNYi@even-i700>

On vendredi 2 juin 2017 14:28:18 CEST Julien Michel wrote:
> Dear all,
> 
> There is a lot of activity around this Open Data Cube [1] initiative,
> which seems promising. As far as I understand it however, what we can do
> with data in the datacube is limited to what the python API allows you
> to do. Is there any plan (and does it even make sense ?) to have a gdal
> driver that allows to address data ingested in a datacube instance ?

I've just discovered this project, and browsed quickly through the docs at
http://datacube-core.readthedocs.io/en/latest/, so the following might be not really 
relevant.

According to
http://datacube-core.readthedocs.io/en/latest/user/intro.html , it seems that ingested data 
is put in tiled netCDF files, and referenced in a PostgreSQL database (not clear if the files are 
blob in the DB or in the filesystem)

So if the data itself is stored in the filesystem, a driver could probably read the metadata in 
the DB and create some sort of virtual mosaic around the tiles. If their database schema is 
stable enough (it doesn't seem to be formally documented or I didn't find where), the driver 
could probably read it directly. Otherwise if the DB schema may change, then yes you'd need 
to use their Python API. Could be a potential use case for my experimental concept of GDAL 
drivers written in Python (*). What would be fun here is that given they use GDAL, their 
Python API probably uses GDAL under the hood, so you would have GDAL core -> 
OpenDataCube driver in Python -> OpenDataCube Python API -> GDAL SWIG Python bindings 
-> GDAL core -> netCDF driver ;-)

Even

(*) https://lists.osgeo.org/pipermail/gdal-dev/2017-April/046526.html

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/ac7a70f0/attachment.html>

From caboe at sdfe.dk  Fri Jun  2 06:55:12 2017
From: caboe at sdfe.dk (=?iso-8859-1?Q?Casper_B=F8rgesen?=)
Date: Fri, 2 Jun 2017 13:55:12 +0000
Subject: [gdal-dev] Problem with polygon and gdal.RasterizeLayer causing
 endless cpu usage
In-Reply-To: <2014349.erYsSB0Bio@even-i700>
References: <800A1C4B99390947B3BAA86C02CBDB26FF1C2E@S000014.PROD.SITAD.DK>
 <2014349.erYsSB0Bio@even-i700>
Message-ID: <800A1C4B99390947B3BAA86C02CBDB26FF1D4B@S000014.PROD.SITAD.DK>

Hi Even

Thank you for the fast bug fix, and for pointing out what the problem was. I look forward to test the fix when the current code reaches OSGeo4W.

Regards, Casper


From: Even Rouault [mailto:even.rouault at spatialys.com]
Sent: 2. juni 2017 14:09
To: gdal-dev at lists.osgeo.org
Cc: Casper Børgesen
Subject: Re: [gdal-dev] Problem with polygon and gdal.RasterizeLayer causing endless cpu usage


Casper,



actually this was known as https://trac.osgeo.org/gdal/ticket/5580



I've just fixed it (at least for your case and the one reported in the ticket)



Even



--

Spatialys - Geospatial professional services

http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170602/a5b91772/attachment.html>

From julien.michel at cnes.fr  Fri Jun  2 08:18:25 2017
From: julien.michel at cnes.fr (Julien Michel)
Date: Fri, 2 Jun 2017 17:18:25 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
In-Reply-To: <1827941.29MXtmlNYi@even-i700>
References: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
 <1827941.29MXtmlNYi@even-i700>
Message-ID: <9e0633a8-ca01-ee51-d6fc-74c27d80858f@cnes.fr>

Le 02/06/2017 à 15:20, Even Rouault a écrit :
>
> On vendredi 2 juin 2017 14:28:18 CEST Julien Michel wrote:
>
> > Dear all,
>
> >
>
> > There is a lot of activity around this Open Data Cube [1] initiative,
>
> > which seems promising. As far as I understand it however, what we can do
>
> > with data in the datacube is limited to what the python API allows you
>
> > to do. Is there any plan (and does it even make sense ?) to have a gdal
>
> > driver that allows to address data ingested in a datacube instance ?
>
> I've just discovered this project, and browsed quickly through the docs at
>
> http://datacube-core.readthedocs.io/en/latest/, so the following might 
> be not really relevant.
>
> According to
>
> http://datacube-core.readthedocs.io/en/latest/user/intro.html , it 
> seems that ingested data is put in tiled netCDF files, and referenced 
> in a PostgreSQL database (not clear if the files are blob in the DB or 
> in the filesystem)
>
> So if the data itself is stored in the filesystem, a driver could 
> probably read the metadata in the DB and create some sort of virtual 
> mosaic around the tiles. If their database schema is stable enough (it 
> doesn't seem to be formally documented or I didn't find where), the 
> driver could probably read it directly. Otherwise if the DB schema may 
> change, then yes you'd need to use their Python API. Could be a 
> potential use case for my experimental concept of GDAL drivers written 
> in Python (*). What would be fun here is that given they use GDAL, 
> their Python API probably uses GDAL under the hood, so you would have 
> GDAL core -> OpenDataCube driver in Python -> OpenDataCube Python API 
> -> GDAL SWIG Python bindings -> GDAL core -> netCDF driver ;-)
>
Thanks a lot for your response. I am still trying to figure out if this 
is of any interest or not (I mean the gdal driver for ODC). It seems to 
me that if you spent all the time and storage to build such a datacube, 
it would be better to still be able to read back data with standard 
tools. Plus the datacube could offer a nice abstraction of image 
collections. Maybe the simplest way is to ask them.
>
> (*) https://lists.osgeo.org/pipermail/gdal-dev/2017-April/046526.html
>
-- 
Julien MICHEL
CNES - DSO/SI/2A - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From jluis at ualg.pt  Sat Jun  3 09:04:07 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 03 Jun 2017 17:04:07 +0100
Subject: [gdal-dev] libcurl and the certificates and Windows
Message-ID: <op.y09lk51sdbaoe8@macmarilu>

Hi,

For quite some time I cannot use the 'vsis' because of certificates issue.  
For example, a GMT test that has a command like this no longer works on  
Windows

gdalinfo  
/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit.jpg

because

ERROR 11: HTTP response code: 301 - SSL certificate problem: unable to get  
local issuer certificate
gdalinfo failed - unable to open  
'/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit.jpg'.

It used to work but probably with an older libcurl dll.
The above is with my own build gdal and dependencies (libcurl included)  
but the same happens with the gisinternals binaries.

I have re(and re)ad this page about the certificates

https://curl.haxx.se/docs/sslcerts.html

but regarding Windows and the curl-ca-bundle.crt file what is said about  
it simply does not work. The only thing that works is setting the ENV  
variable

set CURL_CA_BUNDLE=V:\bin\curl-ca-bundle.crt

Now, we had this in GMT recently and I used the nuke option

	curl_easy_setopt (Curl, CURLOPT_SSL_VERIFYPEER, 0L);	/* Tell libcurl to  
not verify the peer */

so tried to do the same thing in the GDAL code (the obvious point seamed  
to be VSICurlSetOptions in cpl_vsi_curl.cpp) but still does not work.

OSGeo4W works but probably because they are still using a 4 years old  
libcurl.dll

Am I the only one seeing this?

Thanks

Joaquim

From even.rouault at spatialys.com  Sat Jun  3 09:22:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 03 Jun 2017 18:22:33 +0200
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <op.y09lk51sdbaoe8@macmarilu>
References: <op.y09lk51sdbaoe8@macmarilu>
Message-ID: <6013120.OmM33MHs1Z@even-i700>

On samedi 3 juin 2017 17:04:07 CEST Joaquim Luis wrote:
> Hi,
> 
> For quite some time I cannot use the 'vsis' because of certificates issue.
> For example, a GMT test that has a command like this no longer works on
> Windows
> 
> gdalinfo
> /vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit
> .jpg
> 
> because
> 
> ERROR 11: HTTP response code: 301 - SSL certificate problem: unable to get
> local issuer certificate
> gdalinfo failed - unable to open
> '/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbi
> t.jpg'.
> 
> It used to work but probably with an older libcurl dll.
> The above is with my own build gdal and dependencies (libcurl included)
> but the same happens with the gisinternals binaries.
> 
> I have re(and re)ad this page about the certificates
> 
> https://curl.haxx.se/docs/sslcerts.html
> 
> but regarding Windows and the curl-ca-bundle.crt file what is said about
> it simply does not work. The only thing that works is setting the ENV
> variable
> 
> set CURL_CA_BUNDLE=V:\bin\curl-ca-bundle.crt
> 
> Now, we had this in GMT recently and I used the nuke option
> 
> 	curl_easy_setopt (Curl, CURLOPT_SSL_VERIFYPEER, 0L);	/* Tell libcurl to
> not verify the peer */
> 
> so tried to do the same thing in the GDAL code (the obvious point seamed
> to be VSICurlSetOptions in cpl_vsi_curl.cpp) but still does not work.

Someone reported to me a similar issue with recent OSGeo4W.

Did you try setting GDAL_HTTP_UNSAFESSL=YES? This is taken into account in 
CPLHTTPSetOptions() that is called by VSICurlSetOptions(), and this set 
CURLOPT_SSL_VERIFYPEER=0 and 	CURLOPT_SSL_VERIFYHOST=0.

This solved the issue.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170603/a82f4454/attachment.html>

From jluis at ualg.pt  Sat Jun  3 09:38:35 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 03 Jun 2017 17:38:35 +0100
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <6013120.OmM33MHs1Z@even-i700>
References: <op.y09lk51sdbaoe8@macmarilu> <6013120.OmM33MHs1Z@even-i700>
Message-ID: <op.y09m6lr6dbaoe8@macmarilu>

On Sat, 03 Jun 2017 17:22:33 +0100, Even Rouault  
<even.rouault at spatialys.com> wrote:

>
> On samedi 3 juin 2017 17:04:07 CEST Joaquim Luis wrote:
>
>> Hi,
>
>>
>
>> For quite some time I cannot use the 'vsis' because of certificates  
>> issue.
>
>> For example, a GMT test that has a command like this no longer works on
>
>> Windows
>
>>
>
>> gdalinfo
>
>> /vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit
>
>> .jpg
>
>>
>
>> because
>
>>
>
>> ERROR 11: HTTP response code: 301 - SSL certificate problem: unable to  
>> get
>
>> local issuer certificate
>
>> gdalinfo failed - unable to open
>
>> '/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbi
>
>> t.jpg'.
>
>>
>
>> It used to work but probably with an older libcurl dll.
>
>> The above is with my own build gdal and dependencies (libcurl included)
>
>> but the same happens with the gisinternals binaries.
>
>>
>
>> I have re(and re)ad this page about the certificates
>
>>
>
>> https://curl.haxx.se/docs/sslcerts.html
>
>>
>
>> but regarding Windows and the curl-ca-bundle.crt file what is said about
>
>> it simply does not work. The only thing that works is setting the ENV
>
>> variable
>
>>
>
>> set CURL_CA_BUNDLE=V:\bin\curl-ca-bundle.crt
>
>>
>
>> Now, we had this in GMT recently and I used the nuke option
>
>>
>
>> curl_easy_setopt (Curl, CURLOPT_SSL_VERIFYPEER, 0L); /* Tell libcurl to
>
>> not verify the peer */
>
>>
>
>> so tried to do the same thing in the GDAL code (the obvious point seamed
>
>> to be VSICurlSetOptions in cpl_vsi_curl.cpp) but still does not work.
>
>
> Someone reported to me a similar issue with recent OSGeo4W.
>
>
> Did you try setting GDAL_HTTP_UNSAFESSL=YES? This is taken into account  
> in CPLHTTPSetOptions() that is called by VSICurlSetOptions(), and >this  
> set CURLOPT_SSL_VERIFYPEER=0 and CURLOPT_SSL_VERIFYHOST=0.
>
>
> This solved the issue.
>
>

Thanks, yes that works too (and, no I hadn't tried it before) although  
it's a different solution than setting  CURL_CA_BUNDLE , which does not  
turn out the certificates verification.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170603/3bfc07a4/attachment-0001.html>

From jluis at ualg.pt  Sat Jun  3 10:29:34 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Sat, 03 Jun 2017 18:29:34 +0100
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <op.y09m6lr6dbaoe8@macmarilu>
References: <op.y09lk51sdbaoe8@macmarilu> <6013120.OmM33MHs1Z@even-i700>
 <op.y09m6lr6dbaoe8@macmarilu>
Message-ID: <op.y09pjky9dbaoe8@macmarilu>

For reference

https://github.com/curl/curl/issues/1538


> On Sat, 03 Jun 2017 17:22:33 +0100, Even Rouault  
> <even.rouault at spatialys.com> wrote:
>
>>
>> On samedi 3 juin 2017 17:04:07 CEST Joaquim Luis wrote:
>>
>>> Hi,
>>
>>>
>>
>>> For quite some time I cannot use the 'vsis' because of certificates  
>>> issue.
>>
>>> For example, a GMT test that has a command like this no longer works on
>>
>>> Windows
>>
>>>
>>
>>> gdalinfo
>>
>>> /vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit
>>
>>> .jpg
>>
>>>
>>
>>> because
>>
>>>
>>
>>> ERROR 11: HTTP response code: 301 - SSL certificate problem: unable to  
>>> get
>>
>>> local issuer certificate
>>
>>> gdalinfo failed - unable to open
>>
>>> '/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbi
>>
>>> t.jpg'.
>>
>>>
>>
>>> It used to work but probably with an older libcurl dll.
>>
>>> The above is with my own build gdal and dependencies (libcurl included)
>>
>>> but the same happens with the gisinternals binaries.
>>
>>>
>>
>>> I have re(and re)ad this page about the certificates
>>
>>>
>>
>>> https://curl.haxx.se/docs/sslcerts.html
>>
>>>
>>
>>> but regarding Windows and the curl-ca-bundle.crt file what is said  
>>> about
>>
>>> it simply does not work. The only thing that works is setting the ENV
>>
>>> variable
>>
>>>
>>
>>> set CURL_CA_BUNDLE=V:\bin\curl-ca-bundle.crt
>>
>>>
>>
>>> Now, we had this in GMT recently and I used the nuke option
>>
>>>
>>
>>> curl_easy_setopt (Curl, CURLOPT_SSL_VERIFYPEER, 0L); /* Tell libcurl to
>>
>>> not verify the peer */
>>
>>>
>>
>>> so tried to do the same thing in the GDAL code (the obvious point  
>>> seamed
>>
>>> to be VSICurlSetOptions in cpl_vsi_curl.cpp) but still does not work.
>>
>>
>> Someone reported to me a similar issue with recent OSGeo4W.
>>
>>
>> Did you try setting GDAL_HTTP_UNSAFESSL=YES? This is taken into account  
>> in CPLHTTPSetOptions() that is called by VSICurlSetOptions(), >>and  
>> this set CURLOPT_SSL_VERIFYPEER=0 and CURLOPT_SSL_VERIFYHOST=0.
>>
>>
>> This solved the issue.
>>
>>
>
> Thanks, yes that works too (and, no I hadn't tried it before) although  
> it's a different solution than setting  CURL_CA_BUNDLE , which does not  
> turn >out the certificates verification.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170603/825d5801/attachment.html>

From p.baumann at jacobs-university.de  Sat Jun  3 23:59:22 2017
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Sun, 4 Jun 2017 08:59:22 +0200
Subject: [gdal-dev] [Geoserver-devel] GML lat-lon coverages and
 interoperability
In-Reply-To: <1491844962970-5316705.post@n6.nabble.com>
References: <5c7f1db772a34b96aeb11c26c21e7878@C119S212VM022.msvyvi.vaha.local>
 <7ca9e954-dbad-7787-100a-66c980305c5b@jacobs-university.de>
 <CA+nxMTu04=+k1HuZHdvX_URJHvO+PdmzN9EKihFmUoDSNNQkEQ@mail.gmail.com>
 <58781414-2e0b-0e1f-9677-fbf81efaa221@jacobs-university.de>
 <CA+nxMTsFYO=EFKxH20x-5DjjLtEF1QDedAwp3DZu9UbPWaz=fw@mail.gmail.com>
 <7107168.hhLIJib3oB@even-i700>
 <CA+nxMTvNYA79GvE_P5Xq=TwfQMWies-baJqXFcNpozj1FhMC1A@mail.gmail.com>
 <4158738.fBMHjsndya@even-i700>
 <f4295c1e-837e-6a6c-7d5c-6df12408bf70@jacobs-university.de>
 <1491844962970-5316705.post@n6.nabble.com>
Message-ID: <11aca847-09cc-1cef-b8ba-c18b150cd21d@jacobs-university.de>


On 04/10/2017 07:22 PM, jratike80 wrote:
> Peter Baumann wrote
>> Hi all,
>>
>> why not simply check against the compliance tests of WCS 2 and maybe a
>> reference
>> implementation? Might be the easiest for answering all such questions.
>>
>> cheers,
>>
>> Peter
> Hi,
>
> I could not find exact match for raster image (GeoTIFF) case from
> http://cite.opengeospatial.org/teamengine/about/wcs/2.0.1/site/ or
> http://schemas.opengis.net/wcs/2.0/examples/.
>
>
> When it comes to reference implementation, by following the link
> http://standards.rasdaman.org/ to the WCS endpoint demo using service
> http://ows.rasdaman.org/rasdaman/ows and then to coverage BlueMarbleCov I
> can read that DescribeCoverage contains this:
>
>     <coverageFunction>
>       <GridFunction>
>         <sequenceRule axisOrder="+2 +1">Linear</sequenceRule>
>         <startPoint>0 0</startPoint>
>       </GridFunction>
>     </coverageFunction>
>     <gmlcov:metadata/>
>     <domainSet>
>       <RectifiedGrid dimension="2" gml:id="BlueMarbleCov-grid">
>         <limits>
>           <GridEnvelope>
>             <low>0 0</low>
>             <high>17999 8999</high>
>           </GridEnvelope>
>         </limits>
>         <axisLabels>Lat Long</axisLabels>
>         <origin>
>           <Point gml:id="BlueMarbleCov-origin"
> srsName="http://ows.rasdaman.org/def/crs/EPSG/0/4326">
>             <pos>89.99 -179.99</pos>
>           </Point>
>         </origin>
>         <offsetVector
> srsName="http://ows.rasdaman.org/def/crs/EPSG/0/4326">-0.02 0</offsetVector>
>         <offsetVector
> srsName="http://ows.rasdaman.org/def/crs/EPSG/0/4326">0 0.02</offsetVector>
>       </RectifiedGrid>
>
> So both the Rasdaman demo and Geoserver are using gridFunction axisOrder +2
> +1 with EPSG:4326. However, on April 4th you wrote on this mailing list:
>
> "So it is not necessary to use GridFunctions for this purpose. My personal
> opinion is that such mechanisms are not optimal for fiddling with coordinate
> positions as they make it unnecessarily
> difficult to determine the final pixel position."
>
> I am not yet sure what is the conclusion.
>
> -Jukka Rahkonen-

Hi Jukka,

sorry for the late response, busy as hell again.

The issue (with ISO 19123) is that coverageFunction can do a lot of things - up
to containing MathML expressions for analytic definitions of grids. (this I was
referring to as less than optimal - AFAIK, this is not used by anybody,
fortunately). OTOH, we have storage relevant parameters like sequenceRule which
determines the sequence of pixels in the sequentialization scheme. This is
relevant indeed, and there is a meaningful default (forgot whether row major or
column major, cannot look it up from here).

As for GeoTIFF, there is a specification defining the mapping, see OGC 12-100r1
available from http://www.opengeospatial.org/standards/wcs.

HTH,

Peter





>
>
>
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-GML-lat-lon-coverages-and-interoperability-tp5315441p5316705.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-- 
Dr. Peter Baumann
 - Professor of Computer Science, Jacobs University Bremen
   www.faculty.jacobs-university.de/pbaumann
   mail: p.baumann at jacobs-university.de
   tel: +49-421-200-3178, fax: +49-421-200-493178
 - Executive Director, rasdaman GmbH Bremen (HRB 26793)
   www.rasdaman.com, mail: baumann at rasdaman.com
   tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From p.baumann at jacobs-university.de  Sun Jun  4 06:09:46 2017
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Sun, 4 Jun 2017 15:09:46 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
In-Reply-To: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
References: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
Message-ID: <1d71f05f-2e06-c8ae-caea-bcc016935c76@jacobs-university.de>

Hi Julien,

already seen rasdaman (www.rasdaman.org)? Fully implemented nD datacube engine,
proven on massive data, in operational use (not just planning phase)...and
proudly using GDAL.

As I am editor of the OGC datacube standards I'll be glad to give advice on
standards-based coupling. Just le me know your plans.

cheers,

Peter


On 06/02/2017 02:28 PM, Julien Michel wrote:
> Dear all,
>
> There is a lot of activity around this Open Data Cube [1] initiative, which
> seems promising. As far as I understand it however, what we can do with data
> in the datacube is limited to what the python API allows you to do. Is there
> any plan (and does it even make sense ?) to have a gdal driver that allows to
> address data ingested in a datacube instance ?
>
> Thanks a lot,
>
> Regards,
>
> Julien
>
> [1] https://github.com/opendatacube/datacube-core
>

-- 
Dr. Peter Baumann
 - Professor of Computer Science, Jacobs University Bremen
   www.faculty.jacobs-university.de/pbaumann
   mail: p.baumann at jacobs-university.de
   tel: +49-421-200-3178, fax: +49-421-200-493178
 - Executive Director, rasdaman GmbH Bremen (HRB 26793)
   www.rasdaman.com, mail: baumann at rasdaman.com
   tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From Andre.Vautour at Teledyne.com  Mon Jun  5 12:07:24 2017
From: Andre.Vautour at Teledyne.com (=?iso-8859-1?Q?Vautour=2C_Andr=E9_=28INT=29?=)
Date: Mon, 5 Jun 2017 19:07:24 +0000
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <op.y09pjky9dbaoe8@macmarilu>
References: <op.y09lk51sdbaoe8@macmarilu> <6013120.OmM33MHs1Z@even-i700>
 <op.y09m6lr6dbaoe8@macmarilu> <op.y09pjky9dbaoe8@macmarilu>
Message-ID: <8FD06BD4C598D8419F88B9DC4CD35FB20102F2AE@CA1-VPMSG-MBX02.TDY.Teledyne.com>

I'd like to add that I think an option like GDAL_HTTP_CA_CERT_FILE or GDAL_HTTP_CA_CERT_PATH would be useful to have.

In our applications, usage of libcurl outside of GDAL sets the CURLOPT_CAINFO to point to our certificate bundle, but, for GDAL, we instead set GDAL_HTTP_UNSAFESSL=YES. Had that option existed, I'm sure we would have used it.

That being said, I still feel that, for Windows, using the Certificate Stores is what makes the most sense. That way, in an organizational setting, certificates can be managed via the domain instead of having to configure each workstation separately. That would involve building libcurl with SChannel support instead of OpenSSL. From I can tell, that would only work for Windows XP onwards.

André


From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Joaquim Luis
Sent: Saturday, June 3, 2017 14:30
To: gdal-dev at lists.osgeo.org; Even Rouault <even.rouault at spatialys.com>; Joaquim Luis <jluis at ualg.pt>
Subject: Re: [gdal-dev] libcurl and the certificates and Windows

For reference

https://github.com/curl/curl/issues/1538


On Sat, 03 Jun 2017 17:22:33 +0100, Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>> wrote:

On samedi 3 juin 2017 17:04:07 CEST Joaquim Luis wrote:

> Hi,

>

> For quite some time I cannot use the 'vsis' because of certificates issue.

> For example, a GMT test that has a command like this no longer works on

> Windows

>

> gdalinfo

> /vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbit

> .jpg

>

> because

>

> ERROR 11: HTTP response code: 301 - SSL certificate problem: unable to get

> local issuer certificate

> gdalinfo failed - unable to open

> '/vsicurl/http://larryfire.files.wordpress.com/2009/07/untooned_jessicarabbi

> t.jpg'.

>

> It used to work but probably with an older libcurl dll.

> The above is with my own build gdal and dependencies (libcurl included)

> but the same happens with the gisinternals binaries.

>

> I have re(and re)ad this page about the certificates

>

> https://curl.haxx.se/docs/sslcerts.html

>

> but regarding Windows and the curl-ca-bundle.crt file what is said about

> it simply does not work. The only thing that works is setting the ENV

> variable

>

> set CURL_CA_BUNDLE=V:\bin\curl-ca-bundle.crt

>

> Now, we had this in GMT recently and I used the nuke option

>

> curl_easy_setopt (Curl, CURLOPT_SSL_VERIFYPEER, 0L); /* Tell libcurl to

> not verify the peer */

>

> so tried to do the same thing in the GDAL code (the obvious point seamed

> to be VSICurlSetOptions in cpl_vsi_curl.cpp) but still does not work.



Someone reported to me a similar issue with recent OSGeo4W.



Did you try setting GDAL_HTTP_UNSAFESSL=YES? This is taken into account in CPLHTTPSetOptions() that is called by VSICurlSetOptions(), and this set CURLOPT_SSL_VERIFYPEER=0 and CURLOPT_SSL_VERIFYHOST=0.



This solved the issue.



Thanks, yes that works too (and, no I hadn't tried it before) although it's a different solution than setting  CURL_CA_BUNDLE , which does not turn out the certificates verification.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170605/16a524fe/attachment.html>

From even.rouault at spatialys.com  Mon Jun  5 13:54:30 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 05 Jun 2017 22:54:30 +0200
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <8FD06BD4C598D8419F88B9DC4CD35FB20102F2AE@CA1-VPMSG-MBX02.TDY.Teledyne.com>
References: <op.y09lk51sdbaoe8@macmarilu> <op.y09pjky9dbaoe8@macmarilu>
 <8FD06BD4C598D8419F88B9DC4CD35FB20102F2AE@CA1-VPMSG-MBX02.TDY.Teledyne.com>
Message-ID: <2573013.tMi4506Dpv@even-i700>

On lundi 5 juin 2017 19:07:24 CEST Vautour, André (INT) wrote:
> I'd like to add that I think an option like GDAL_HTTP_CA_CERT_FILE or
> GDAL_HTTP_CA_CERT_PATH would be useful to have.

See http://gdal.org/cpl__http_8h.html#aee8368b7821300f4b81ef4da8a9c6a29

"""
CAINFO=/path/to/bundle.crt. This is path to Certificate Authority (CA) bundle file. 
By default, it will be looked in a system location. If the CAINFO options is not 
defined, GDAL will also look if the CURL_CA_BUNDLE environment variable is 
defined to use it as the CAINFO value, and as a fallback to the SSL_CERT_FILE 
environment variable. (GDAL >= 2.1.3) 
"""

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170605/30bd91f5/attachment.html>

From jluis at ualg.pt  Mon Jun  5 15:02:54 2017
From: jluis at ualg.pt (Joaquim Luis)
Date: Mon, 05 Jun 2017 23:02:54 +0100
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <2573013.tMi4506Dpv@even-i700>
References: <op.y09lk51sdbaoe8@macmarilu> <op.y09pjky9dbaoe8@macmarilu>
 <8FD06BD4C598D8419F88B9DC4CD35FB20102F2AE@CA1-VPMSG-MBX02.TDY.Teledyne.com>
 <2573013.tMi4506Dpv@even-i700>
Message-ID: <op.y1dri4jrdbaoe8@macmarilu>

Even ,

I think you may be interested to see the all extend of  
https://github.com/curl/curl/issues/1538 Not friendliest place to report  
(possible) issues.

Joaquim


>
> On lundi 5 juin 2017 19:07:24 CEST Vautour, André (INT) wrote:
>
>> I'd like to add that I think an option like GDAL_HTTP_CA_CERT_FILE or
>
>> GDAL_HTTP_CA_CERT_PATH would be useful to have.
>
>
> See http://gdal.org/cpl__http_8h.html#aee8368b7821300f4b81ef4da8a9c6a29
>
>
> """
>
> CAINFO=/path/to/bundle.crt. This is path to Certificate Authority (CA)  
> bundle file. By default, it will be looked in a system location. If the  
> CAINFO options is >not defined, GDAL will also look if the  
> CURL_CA_BUNDLE environment variable is defined to use it as the CAINFO  
> value, and as a fallback to the >SSL_CERT_FILE environment variable.  
> (GDAL >= 2.1.3)
> """
>
>
> --
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170605/dc3be9e1/attachment-0001.html>

From even.rouault at spatialys.com  Mon Jun  5 16:07:10 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 06 Jun 2017 01:07:10 +0200
Subject: [gdal-dev] libcurl and the certificates and Windows
In-Reply-To: <op.y1dri4jrdbaoe8@macmarilu>
References: <op.y09lk51sdbaoe8@macmarilu> <2573013.tMi4506Dpv@even-i700>
 <op.y1dri4jrdbaoe8@macmarilu>
Message-ID: <4513083.vGs7Nquc6y@even-i700>

On lundi 5 juin 2017 23:02:54 CEST Joaquim Luis wrote:
> https://github.com/curl/curl/issues/1538

Hopefully https://trac.osgeo.org/gdal/changeset/38903 should improve 
the situation a bit (note: completely untested), provided curl-ca-bundle.crt 
is in one of the searched paths. Note: as far as I can see, this is not the case 
in gisinternals since it is not in the path where GDAL binaries are...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170606/47bbf2c9/attachment.html>

From naresh919 at gmail.com  Mon Jun  5 22:05:26 2017
From: naresh919 at gmail.com (naresh)
Date: Mon, 5 Jun 2017 22:05:26 -0700 (MST)
Subject: [gdal-dev] gdalenhance command issue with stddev option
Message-ID: <1496725526965-5323137.post@n6.nabble.com>

Dear All, 
I have configured GDAL2.1.0 in windows 64 bit machine. I am using following
command 

gdalenhance -of JPEG -stddev 2.0 E:\first.jpg E:\first_enhance.jpg 

got the following error 

option -stddev incomplete, or not recognised 

Please help me how to use gdalenhance command with option stddev 

Thanks&Regards, 
Naresh



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-option-tp5323137.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From naresh919 at gmail.com  Mon Jun  5 22:07:07 2017
From: naresh919 at gmail.com (naresh)
Date: Mon, 5 Jun 2017 22:07:07 -0700 (MST)
Subject: [gdal-dev] Pix format reading Gdal
Message-ID: <1496725627912-5323138.post@n6.nabble.com>

Dear All, 
I have configured GDAL2.1.0 in windows 64 bit machine.

The  gdalwrap, gdaltranslate  commands for pixfile formats showing error.
Please kindly help me how to overcome the issue

Thanks&Regards, 
Naresh



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Pix-format-reading-Gdal-tp5323138.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jun  5 22:18:09 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 5 Jun 2017 22:18:09 -0700 (MST)
Subject: [gdal-dev] gdalenhance command issue with stddev option
In-Reply-To: <1496725526965-5323137.post@n6.nabble.com>
References: <1496725526965-5323137.post@n6.nabble.com>
Message-ID: <1496726289936-5323140.post@n6.nabble.com>

naresh wrote
> Dear All, 
> I have configured GDAL2.1.0 in windows 64 bit machine. I am using
> following command 
> 
> gdalenhance -of JPEG -stddev 2.0 E:\first.jpg E:\first_enhance.jpg 
> 
> got the following error 
> 
> option -stddev incomplete, or not recognised 
> 
> Please help me how to use gdalenhance command with option stddev 
> 
> Thanks&Regards, 
> Naresh

Hi,

By http://lists.maptools.org/pipermail/fwtools/2008-February/001153.html the
tool was 9 years ago "essentially an abandoned prototype".

-Jukka Rahkonen-





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-option-tp5323137p5323140.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From jukka.rahkonen at maanmittauslaitos.fi  Mon Jun  5 22:22:49 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 5 Jun 2017 22:22:49 -0700 (MST)
Subject: [gdal-dev] Pix format reading Gdal
In-Reply-To: <1496725627912-5323138.post@n6.nabble.com>
References: <1496725627912-5323138.post@n6.nabble.com>
Message-ID: <1496726569626-5323142.post@n6.nabble.com>

naresh wrote
> Dear All, 
> I have configured GDAL2.1.0 in windows 64 bit machine.
> 
> The  gdalwrap, gdaltranslate  commands for pixfile formats showing error.
> Please kindly help me how to overcome the issue
> 
> Thanks&Regards, 
> Naresh

Please kindly enhance your question which does not tell really anything
about your problem as it stands. Provide details.

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Pix-format-reading-Gdal-tp5323138p5323142.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From naresh919 at gmail.com  Mon Jun  5 23:52:22 2017
From: naresh919 at gmail.com (naresh)
Date: Mon, 5 Jun 2017 23:52:22 -0700 (MST)
Subject: [gdal-dev] gdalenhance command issue with stddev option
In-Reply-To: <1496726289936-5323140.post@n6.nabble.com>
References: <1496725526965-5323137.post@n6.nabble.com>
 <1496726289936-5323140.post@n6.nabble.com>
Message-ID: <CAKAPXzPfpztaOjoN+jVK_rWZ=gbbq2+V336cDmwdkTJgU3Z3LQ@mail.gmail.com>

Dear Rahkonen,
Thanks for the quick response. However with gdalenhace  -help  showing the
-stddev option. Please find the attache screenshot.

   [image: Inline image 1]

 Is there any other mechanism/tool is available for enhancing the images
with stddev option.


Thanks&Regards,
Naresh

On Tue, Jun 6, 2017 at 10:48 AM, jratike80 [via OSGeo.org] <
ml+s1560n5323140h33 at n6.nabble.com> wrote:

> naresh wrote
> Dear All,
> I have configured GDAL2.1.0 in windows 64 bit machine. I am using
> following command
>
> gdalenhance -of JPEG -stddev 2.0 E:\first.jpg E:\first_enhance.jpg
>
> got the following error
>
> option -stddev incomplete, or not recognised
>
> Please help me how to use gdalenhance command with option stddev
>
> Thanks&Regards,
> Naresh
>
> Hi,
>
> By http://lists.maptools.org/pipermail/fwtools/2008-February/001153.html the
> tool was 9 years ago "essentially an abandoned prototype".
>
> -Jukka Rahkonen-
>
>
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-
> option-tp5323137p5323140.html
> To unsubscribe from gdalenhance command issue with stddev option, click
> here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5323137&code=bmFyZXNoOTE5QGdtYWlsLmNvbXw1MzIzMTM3fC0xMDc3NTYzNDE5>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>


image.png (48K) <http://osgeo-org.1560.x6.nabble.com/attachment/5323152/0/image.png>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-option-tp5323137p5323152.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170605/7a463ef7/attachment.html>

From even.rouault at spatialys.com  Tue Jun  6 01:14:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 06 Jun 2017 10:14:59 +0200
Subject: [gdal-dev] gdalenhance command issue with stddev option
In-Reply-To: <CAKAPXzPfpztaOjoN+jVK_rWZ=gbbq2+V336cDmwdkTJgU3Z3LQ@mail.gmail.com>
References: <1496725526965-5323137.post@n6.nabble.com>
 <1496726289936-5323140.post@n6.nabble.com>
 <CAKAPXzPfpztaOjoN+jVK_rWZ=gbbq2+V336cDmwdkTJgU3Z3LQ@mail.gmail.com>
Message-ID: <2289455.Ms3qX11LuP@even-i700>

On lundi 5 juin 2017 23:52:22 CEST naresh wrote:
> Dear Rahkonen,
> Thanks for the quick response. However with gdalenhace  -help  showing the
> -stddev option. Please find the attache screenshot.
> 
>    [image: Inline image 1]
> 
>  Is there any other mechanism/tool is available for enhancing the images
> with stddev option.
> 

You can run gdalinfo -stats in.tif

note the mean and stddev values

and then compute

s_min=mean - factor * stddev
s_max= mean + factor * stddev

gdal_translate in.tif out.tif -scale s_min s_max 0 255

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170606/051fd1fe/attachment.html>

From naresh919 at gmail.com  Tue Jun  6 02:32:39 2017
From: naresh919 at gmail.com (naresh)
Date: Tue, 6 Jun 2017 02:32:39 -0700 (MST)
Subject: [gdal-dev] gdalenhance command issue with stddev option
In-Reply-To: <2289455.Ms3qX11LuP@even-i700>
References: <1496725526965-5323137.post@n6.nabble.com>
 <1496726289936-5323140.post@n6.nabble.com>
 <CAKAPXzPfpztaOjoN+jVK_rWZ=gbbq2+V336cDmwdkTJgU3Z3LQ@mail.gmail.com>
 <2289455.Ms3qX11LuP@even-i700>
Message-ID: <CAKAPXzNiW3=2CccMAJL4f0NDHwucUmnadP0D1mEqv1Na+ObFWA@mail.gmail.com>

Dear Even Rouault-2,
  Thanks for the suggestion, I will do.

Thanks&Regards,
Naresh

On Tue, Jun 6, 2017 at 1:45 PM, Even Rouault-2 [via OSGeo.org] <
ml+s1560n5323158h91 at n6.nabble.com> wrote:

> On lundi 5 juin 2017 23:52:22 CEST naresh wrote:
>
> > Dear Rahkonen,
>
> > Thanks for the quick response. However with gdalenhace -help showing the
>
> > -stddev option. Please find the attache screenshot.
>
> >
>
> > [image: Inline image 1]
>
> >
>
> > Is there any other mechanism/tool is available for enhancing the images
>
> > with stddev option.
>
> >
>
>
>
> You can run gdalinfo -stats in.tif
>
>
>
> note the mean and stddev values
>
>
>
> and then compute
>
>
>
> s_min=mean - factor * stddev
>
> s_max= mean + factor * stddev
>
>
>
> gdal_translate in.tif out.tif -scale s_min s_max 0 255
>
>
>
> Best regards,
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
> _______________________________________________
> gdal-dev mailing list
> [hidden email] <http:///user/SendEmail.jtp?type=node&node=5323158&i=0>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
> If you reply to this email, your message will be added to the discussion
> below:
> http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-
> option-tp5323137p5323158.html
> To unsubscribe from gdalenhance command issue with stddev option, click
> here
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=unsubscribe_by_code&node=5323137&code=bmFyZXNoOTE5QGdtYWlsLmNvbXw1MzIzMTM3fC0xMDc3NTYzNDE5>
> .
> NAML
> <http://osgeo-org.1560.x6.nabble.com/template/NamlServlet.jtp?macro=macro_viewer&id=instant_html%21nabble%3Aemail.naml&base=nabble.naml.namespaces.BasicNamespace-nabble.view.web.template.NabbleNamespace-nabble.view.web.template.NodeNamespace&breadcrumbs=notify_subscribers%21nabble%3Aemail.naml-instant_emails%21nabble%3Aemail.naml-send_instant_email%21nabble%3Aemail.naml>
>




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdalenhance-command-issue-with-stddev-option-tp5323137p5323167.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170606/d982834e/attachment-0001.html>

From jujumbura at hotmail.com  Tue Jun  6 17:35:21 2017
From: jujumbura at hotmail.com (Mike K)
Date: Tue, 6 Jun 2017 17:35:21 -0700 (MST)
Subject: [gdal-dev] Unable to obtain EPSG from OGRSpatialReference
Message-ID: <1496795721935-5323281.post@n6.nabble.com>

Hello,

I have a situation in which I would like to load up a set of polygons, and
determine what EPSG code they are using.  I am testing with a simple square
polygon in upstate New York using the UTM projection, saved into a Shapefile
.

I am able to create my dataset, layer, and read the geometry just fine.  I
can get access to the spatial reference, but if I call the
OGRSpatialReference::GetEPSGGeogCS() function, it always returns code 4326 (
which is lat/lon ).  This is not correct, but if I query other values, they
seem to be valid.  For instance, OGRSpatialReference::GetUTMZone() will
return 17 N, which is correct.

Does anybody know why I might be getting the wrong EPSG code?  I had thought
I might just have bad data, but the fact that I can get the values
individually makes me think it is something about how I am using the
functions.  Thank you for any advice.



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Unable-to-obtain-EPSG-from-OGRSpatialReference-tp5323281.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From andre+joost at nurfuerspam.de  Tue Jun  6 22:30:53 2017
From: andre+joost at nurfuerspam.de (Andre Joost)
Date: Wed, 07 Jun 2017 07:30:53 +0200
Subject: [gdal-dev] Unable to obtain EPSG from OGRSpatialReference
In-Reply-To: <1496795721935-5323281.post@n6.nabble.com>
References: <1496795721935-5323281.post@n6.nabble.com>
Message-ID: <oh8334$ti9$1@blaine.gmane.org>

Am 07.06.2017 um 02:35 schrieb Mike K:
> Hello,
>
> I have a situation in which I would like to load up a set of polygons, and
> determine what EPSG code they are using.  I am testing with a simple square
> polygon in upstate New York using the UTM projection, saved into a Shapefile
> .
>
> I am able to create my dataset, layer, and read the geometry just fine.  I
> can get access to the spatial reference, but if I call the
> OGRSpatialReference::GetEPSGGeogCS() function, it always returns code 4326 (
> which is lat/lon ).  This is not correct, but if I query other values, they
> seem to be valid.  For instance, OGRSpatialReference::GetUTMZone() will
> return 17 N, which is correct.
>
> Does anybody know why I might be getting the wrong EPSG code?  I had thought
> I might just have bad data, but the fact that I can get the values
> individually makes me think it is something about how I am using the
> functions.  Thank you for any advice.
>

What EPSG code do you think is "right" ?

Many projected coordinate systems are based on a geographical coordinate 
system more or less identical to WGS84 (EPSG:4326).

HTH,
André Joost



From nik at nixanz.com  Wed Jun  7 00:15:10 2017
From: nik at nixanz.com (Nik)
Date: Wed, 7 Jun 2017 17:15:10 +1000
Subject: [gdal-dev] Unable to obtain EPSG from OGRSpatialReference
In-Reply-To: <oh8334$ti9$1@blaine.gmane.org>
References: <1496795721935-5323281.post@n6.nabble.com>
 <oh8334$ti9$1@blaine.gmane.org>
Message-ID: <265D63D1-67BE-448A-A19C-21DBA94B79AC@nixanz.com>

It seems like you may be trying to get the EPSG code for the projected SRS but you are using a call that retrieves the geographic SRS.   If this is the case then you might want to try using both of:

OGRSpatialReference::GetAuthorityName

OGRSpatialReference::GetAuthorityCode

These are not guaranteed to produce results, but if the information is available, the first is likely to return "EPSG" and the second would then return the numeric EPSG code.  

-----------------------------------------
NIK SANDS
Line Tamer | Time Traveller | Space Cadet

> On 7 Jun 2017, at 3:30 pm, Andre Joost <andre+joost at nurfuerspam.de> wrote:
> 
>> Am 07.06.2017 um 02:35 schrieb Mike K:
>> Hello,
>> 
>> I have a situation in which I would like to load up a set of polygons, and
>> determine what EPSG code they are using.  I am testing with a simple square
>> polygon in upstate New York using the UTM projection, saved into a Shapefile
>> .
>> 
>> I am able to create my dataset, layer, and read the geometry just fine.  I
>> can get access to the spatial reference, but if I call the
>> OGRSpatialReference::GetEPSGGeogCS() function, it always returns code 4326 (
>> which is lat/lon ).  This is not correct, but if I query other values, they
>> seem to be valid.  For instance, OGRSpatialReference::GetUTMZone() will
>> return 17 N, which is correct.
>> 
>> Does anybody know why I might be getting the wrong EPSG code?  I had thought
>> I might just have bad data, but the fact that I can get the values
>> individually makes me think it is something about how I am using the
>> functions.  Thank you for any advice.
>> 
> 
> What EPSG code do you think is "right" ?
> 
> Many projected coordinate systems are based on a geographical coordinate system more or less identical to WGS84 (EPSG:4326).
> 
> HTH,
> André Joost
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170607/32813e95/attachment.html>

From ianjlilly at gmail.com  Wed Jun  7 00:32:51 2017
From: ianjlilly at gmail.com (Ian Lilly)
Date: Wed, 7 Jun 2017 15:32:51 +0800
Subject: [gdal-dev] Unable to obtain EPSG from OGRSpatialReference
In-Reply-To: <oh8334$ti9$1@blaine.gmane.org>
References: <1496795721935-5323281.post@n6.nabble.com>
 <oh8334$ti9$1@blaine.gmane.org>
Message-ID: <CAJyyP+T5NxsD+ZS2hkkcsUsqA_YmWQNzO3h2RrqUprH+u_bYWg@mail.gmail.com>

Andre,
My reading of his description is that he's using projected coords (i.e.
metres) so for UTM 17N isn't that this - https://epsg.io/32617?
EPSG4326 is WGS84, geographic (lat/lon) which defines the spheroid used in
UTM.

I'm not a C++ programmer nor have I read the docs for the GDAL API -
perhaps it's not the correct function?

Ian Lilly
+60 1 7608 5310


On 7 Jun 2017 13:46, "Andre Joost" <andre+joost at nurfuerspam.de> wrote:

Am 07.06.2017 um 02:35 schrieb Mike K:

> Hello,
>
> I have a situation in which I would like to load up a set of polygons, and
> determine what EPSG code they are using.  I am testing with a simple square
> polygon in upstate New York using the UTM projection, saved into a
> Shapefile
> .
>
> I am able to create my dataset, layer, and read the geometry just fine.  I
> can get access to the spatial reference, but if I call the
> OGRSpatialReference::GetEPSGGeogCS() function, it always returns code
> 4326 (
> which is lat/lon ).  This is not correct, but if I query other values, they
> seem to be valid.  For instance, OGRSpatialReference::GetUTMZone() will
> return 17 N, which is correct.
>
> Does anybody know why I might be getting the wrong EPSG code?  I had
> thought
> I might just have bad data, but the fact that I can get the values
> individually makes me think it is something about how I am using the
> functions.  Thank you for any advice.
>
>
What EPSG code do you think is "right" ?

Many projected coordinate systems are based on a geographical coordinate
system more or less identical to WGS84 (EPSG:4326).

HTH,
André Joost



_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170607/304058e7/attachment.html>

From mswope at gmail.com  Wed Jun  7 05:07:38 2017
From: mswope at gmail.com (Mike)
Date: Wed, 7 Jun 2017 06:07:38 -0600
Subject: [gdal-dev] S-57 open options with python bindings
Message-ID: <CAKTSvBg1-2+CdL3yOWa=COk4QPOdkO5OYjB7U0gAYGR7OSH52Q@mail.gmail.com>

Hi,
I looked to see if this was asked before but couldn't find it.
Are any of the S57 open options exposed in the swig bindings? If so, how do
I use them?

the page I refer to is here http://www.gdal.org/drv_s57.html

Thanks
-Mike
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170607/d01bd403/attachment.html>

From even.rouault at spatialys.com  Wed Jun  7 05:16:20 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 07 Jun 2017 14:16:20 +0200
Subject: [gdal-dev] S-57 open options with python bindings
In-Reply-To: <CAKTSvBg1-2+CdL3yOWa=COk4QPOdkO5OYjB7U0gAYGR7OSH52Q@mail.gmail.com>
References: <CAKTSvBg1-2+CdL3yOWa=COk4QPOdkO5OYjB7U0gAYGR7OSH52Q@mail.gmail.com>
Message-ID: <20821347.ezYtMzBRBY@even-i700>

On mercredi 7 juin 2017 06:07:38 CEST Mike wrote:
> Hi,
> I looked to see if this was asked before but couldn't find it.
> Are any of the S57 open options exposed in the swig bindings? If so, how do
> I use them?
> 
> the page I refer to is here http://www.gdal.org/drv_s57.html

>From https://svn.osgeo.org/gdal/trunk/autotest/ogr/ogr_s57.py

ds = gdal.OpenEx( 'tmp/ogr_s57_9.000', open_options = ['RETURN_PRIMITIVES=ON'])

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170607/25a20806/attachment-0001.html>

From sfkeller at gmail.com  Wed Jun  7 08:36:52 2017
From: sfkeller at gmail.com (Stefan Keller)
Date: Wed, 7 Jun 2017 17:36:52 +0200
Subject: [gdal-dev] How to convert a local GeoTIFF to a tile set with
	minimal WMTSCapabilities.xml?
Message-ID: <CAFcOn297eu8Dht6dC4E0b=VNRQNDnGFk2jcrrupr6WRc04mK2g@mail.gmail.com>

Sorry for this question since I know GDAL. But it seems I'm missing
something here:

I'd like to do the following:
A. Given a local GeoTIFF, create WMTS compatible tile set (of single
zoom level 18 or a range)
% python gdal2tiles.py -z 18 infile.tif outdir
B. Then I'd like to test this locally
% gdalinfo WMTSCapabilities.xml
C. or - if needed - I copy WMTSCapabilities.xml to a web space (say
https://www.myweb.org/wmts/1.0.0/WMTSCapabilities.xml) with the
unpacked tile set - and test it there.

Step A works but produces no WMTSCapabilities.xml (stub), only
tilemapresource.xml which obviously is not same as
WMTSCapabilities.xml.

1. How can I generate such a WMTSCapabilities.xml?
2. What is the "minimal viable" XML, given I want/have to create
WMTSCapabilities.xml by hand?

:Stefan

From jujumbura at hotmail.com  Wed Jun  7 10:51:44 2017
From: jujumbura at hotmail.com (Mike K)
Date: Wed, 7 Jun 2017 10:51:44 -0700 (MST)
Subject: [gdal-dev] Unable to obtain EPSG from OGRSpatialReference
In-Reply-To: <265D63D1-67BE-448A-A19C-21DBA94B79AC@nixanz.com>
References: <1496795721935-5323281.post@n6.nabble.com>
 <oh8334$ti9$1@blaine.gmane.org>
 <265D63D1-67BE-448A-A19C-21DBA94B79AC@nixanz.com>
Message-ID: <1496857904056-5323403.post@n6.nabble.com>

Nik Sands, thank you, you nailed it.  

That was my problem: the UTM coordinate system I was expecting is projected,
so I needed to use those functions you listed with the "PROJCS" key to get
the proper EPSG code.  Once I parsed out the code, I get 32617 as expected.  

Thank you all!



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Unable-to-obtain-EPSG-from-OGRSpatialReference-tp5323281p5323403.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From sravan.velagandula at openscg.com  Thu Jun  8 23:46:17 2017
From: sravan.velagandula at openscg.com (Velagandula, Sravan Kumar)
Date: Fri, 9 Jun 2017 12:16:17 +0530
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
Message-ID: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>

Hello,
   I am trying to build gdal-2.2.0 from source on windows 7 64 bit using
msys2 environment. gcc is 4.8.3.

   This is the source I am using:
   http://download.osgeo.org/gdal/2.2.0/gdal-2.2.0.tar.gz

   The binaries produced do not have the .exe extension. But building the
gdal-2.0.3 produces the binaries
   with the .exe extension. I am wondering if anyone else has across this
issue and if so if they were able
   to find a resolution. I appreciate your help.

Thanks,
Sravan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170609/c839b178/attachment.html>

From even.rouault at spatialys.com  Fri Jun  9 01:30:59 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 09 Jun 2017 10:30:59 +0200
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
In-Reply-To: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
References: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
Message-ID: <4004146.syNnpz8eIf@even-i700>

On vendredi 9 juin 2017 12:16:17 CEST Velagandula, Sravan Kumar wrote:
> Hello,
>    I am trying to build gdal-2.2.0 from source on windows 7 64 bit using
> msys2 environment. gcc is 4.8.3.
> 
>    This is the source I am using:
>    http://download.osgeo.org/gdal/2.2.0/gdal-2.2.0.tar.gz
> 
>    The binaries produced do not have the .exe extension. But building the
> gdal-2.0.3 produces the binaries
>    with the .exe extension. I am wondering if anyone else has across this
> issue and if so if they were able
>    to find a resolution. I appreciate your help.

Sravan,

I don't think this aspect of the project has changed in years. Did you use the same msys/
mingw toolchain when compiling GDAL 2.0 and GDAL 2.2 ? I suspect not

In configure.ac, the relevant snippet is :

dnl ---------------------------------------------------------------------------
dnl Check whether we need to add specific suffix for executables (.EXE when
dnl building for Windows). This test should work for the case of
dnl cross-compilation too.
dnl ---------------------------------------------------------------------------
case "${host_os}" in
    cygwin* | mingw32* | pw32*)
      EXE_EXT=.exe
      SO_EXT=dll
      ;;
    *)
      EXE_EXT=
      ;;
esac


I suspect that your toolchain is identified a bit differently.

Could you open "configure" in a text editor and add the following lines at the end of it :

echo "-------------------------"
echo "Host OS: '${host_os}'"
echo "-------------------------"

Then run configure again and report the value displayed

For example with the x86_64-w64-mingw32 cross-compilation toolchain (host: Linux), I get 
the following, which matches the above expressions

-------------------------
Host OS: 'mingw32'
-------------------------

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170609/459394d3/attachment.html>

From sravan.velagandula at openscg.com  Fri Jun  9 03:01:12 2017
From: sravan.velagandula at openscg.com (Velagandula, Sravan Kumar)
Date: Fri, 9 Jun 2017 15:31:12 +0530
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
In-Reply-To: <4004146.syNnpz8eIf@even-i700>
References: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
 <4004146.syNnpz8eIf@even-i700>
Message-ID: <CAJRRhdaCn=9D3Acp0hM2NUg4s=O1Epnt-_+nVK23j=u1Q4b6Uw@mail.gmail.com>

Hello Even,

    I see that the value of ${host_os} is "mingw64" for gdal-2.20 and
"mingw32" for gdal-2.0

gdal-2.2

-------------------------
Host OS: 'mingw64'
-------------------------

gdal-2.0.3

-------------------------
Host OS: 'mingw32'
-------------------------

Thanks,
Sravan

On Fri, Jun 9, 2017 at 2:00 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 9 juin 2017 12:16:17 CEST Velagandula, Sravan Kumar wrote:
>
> > Hello,
>
> > I am trying to build gdal-2.2.0 from source on windows 7 64 bit using
>
> > msys2 environment. gcc is 4.8.3.
>
> >
>
> > This is the source I am using:
>
> > http://download.osgeo.org/gdal/2.2.0/gdal-2.2.0.tar.gz
>
> >
>
> > The binaries produced do not have the .exe extension. But building the
>
> > gdal-2.0.3 produces the binaries
>
> > with the .exe extension. I am wondering if anyone else has across this
>
> > issue and if so if they were able
>
> > to find a resolution. I appreciate your help.
>
>
>
> Sravan,
>
>
>
> I don't think this aspect of the project has changed in years. Did you use
> the same msys/mingw toolchain when compiling GDAL 2.0 and GDAL 2.2 ? I
> suspect not
>
>
>
> In configure.ac, the relevant snippet is :
>
>
>
> dnl ------------------------------------------------------------
> ---------------
>
> dnl Check whether we need to add specific suffix for executables (.EXE when
>
> dnl building for Windows). This test should work for the case of
>
> dnl cross-compilation too.
>
> dnl ------------------------------------------------------------
> ---------------
>
> case "${host_os}" in
>
> cygwin* | mingw32* | pw32*)
>
> EXE_EXT=.exe
>
> SO_EXT=dll
>
> ;;
>
> *)
>
> EXE_EXT=
>
> ;;
>
> esac
>
>
>
>
>
> I suspect that your toolchain is identified a bit differently.
>
>
>
> Could you open "configure" in a text editor and add the following lines at
> the end of it :
>
>
>
> echo "-------------------------"
>
> echo "Host OS: '${host_os}'"
>
> echo "-------------------------"
>
>
>
> Then run configure again and report the value displayed
>
>
>
> For example with the x86_64-w64-mingw32 cross-compilation toolchain (host:
> Linux), I get the following, which matches the above expressions
>
>
>
> -------------------------
>
> Host OS: 'mingw32'
>
> -------------------------
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170609/1cdd30de/attachment-0001.html>

From even.rouault at spatialys.com  Fri Jun  9 03:10:25 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 09 Jun 2017 12:10:25 +0200
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
In-Reply-To: <CAJRRhdaCn=9D3Acp0hM2NUg4s=O1Epnt-_+nVK23j=u1Q4b6Uw@mail.gmail.com>
References: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
 <4004146.syNnpz8eIf@even-i700>
 <CAJRRhdaCn=9D3Acp0hM2NUg4s=O1Epnt-_+nVK23j=u1Q4b6Uw@mail.gmail.com>
Message-ID: <7096282.upXSzWeVuh@even-i700>

On vendredi 9 juin 2017 15:31:12 CEST Velagandula, Sravan Kumar wrote:
> Hello Even,
> 
>     I see that the value of ${host_os} is "mingw64" for gdal-2.20 and
> "mingw32" for gdal-2.0

OK, so with a different toolchain between both builds ?

Anyway, should be now fixed per https://trac.osgeo.org/gdal/ticket/6919 that changes the 
mingw32* pattern to mingw* to catch both cases.

Or you can just edit GDALmake.opt after ./configure , look for the
EXE             =
line and modify it as
EXE             = .exe

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170609/ae5bd968/attachment.html>

From sravan.velagandula at openscg.com  Fri Jun  9 03:14:07 2017
From: sravan.velagandula at openscg.com (Velagandula, Sravan Kumar)
Date: Fri, 9 Jun 2017 15:44:07 +0530
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
In-Reply-To: <7096282.upXSzWeVuh@even-i700>
References: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
 <4004146.syNnpz8eIf@even-i700>
 <CAJRRhdaCn=9D3Acp0hM2NUg4s=O1Epnt-_+nVK23j=u1Q4b6Uw@mail.gmail.com>
 <7096282.upXSzWeVuh@even-i700>
Message-ID: <CAJRRhdYgXsaJPenV+hsqH=kdRBz7rNdYzA++d0FTNtLno4Dm4A@mail.gmail.com>

I apologize for not having confirmed that I am using the same toolchain for
both the builds.

Thanks for the valuable feedback. I would tweak the configure script to get
my builds going.

- Sravan

On Fri, Jun 9, 2017 at 3:40 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On vendredi 9 juin 2017 15:31:12 CEST Velagandula, Sravan Kumar wrote:
>
> > Hello Even,
>
> >
>
> > I see that the value of ${host_os} is "mingw64" for gdal-2.20 and
>
> > "mingw32" for gdal-2.0
>
>
>
> OK, so with a different toolchain between both builds ?
>
>
>
> Anyway, should be now fixed per https://trac.osgeo.org/gdal/ticket/6919
> that changes the mingw32* pattern to mingw* to catch both cases.
>
>
>
> Or you can just edit GDALmake.opt after ./configure , look for the
>
> EXE =
>
> line and modify it as
>
> EXE = .exe
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170609/8e557155/attachment.html>

From bontepaarden at gmail.com  Sat Jun 10 08:04:34 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Sat, 10 Jun 2017 17:04:34 +0200
Subject: [gdal-dev] ISO-11783,
	known as Tractors and machinery for agriculture and forestry
Message-ID: <CAHNf2YRd=RvM99-mOShdZ=yKVhMhYEgfRZL1P06QVONgAptL2g@mail.gmail.com>

Hi List,

I need to export my tiff file to ISOBUS (ISO-11783), which is a standard
for the agriculture.
In short I create a task map which will be loaded into a terminal of a
tractor and the terminal will manage the, for example, crop duster to spray
more or less according the the task map (using GPS).

Before I'm going to try to implement this by myself I want to check if
somebody already has made a converter (preferable using GDAL).

Useful links:
https://en.wikipedia.org/wiki/ISO_11783
http://www.aef-online.org/en/about-isobus/first-priority-isobus.html
I haven't found the link to the specifications, yet.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170610/8af58526/attachment.html>

From issworld2000 at yahoo.com  Sat Jun 10 10:28:06 2017
From: issworld2000 at yahoo.com (Djordje Spasic)
Date: Sat, 10 Jun 2017 17:28:06 +0000 (UTC)
Subject: [gdal-dev] What is the maximum number of fields a shapefile can
	contain?
References: <1315355449.6266196.1497115686524.ref@mail.yahoo.com>
Message-ID: <1315355449.6266196.1497115686524@mail.yahoo.com>

Hello everyone,

When converting an .osm file to .shp files with ogr2ogr.exe, one needs to define a list of required fields in gdal-data\osmconf.ini file.
I defined today a total of 338 field names, and the ogr2ogr.exe succeeded successfully in converting the .osm file to a .shp file containing all those 338 fields. 2 additional fields are added on top of 338 fields (osm_id, osm_way_id). Here is a screenshot of the fields from the .shp file opened in QGIS (QGIS lists fields from 0 as a starting index):
https://www.dropbox.com/s/qw4uqvartn16b0b/shapefile_fields_QGIS2.jpg?dl=0

When .dbf file which is created along the .shp file is being opened in DBF Viewer, it also shows 340 fields:
https://www.dropbox.com/s/hjzthyjzumjbddz/dbf_fields_DBFViewer2000.jpg?dl=0

My question is: how is this possible if a .shp file (.dbf file that is) can only store maximum of 255 fields? This is what Jukka Rahkonen pointed to me, a couple of months ago.
Does this mean that when performing conversion, the ogr2ogr.exe is using some other shapefile format?

I would welcome any kind of reply.

Best regards.
Djordje
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170610/3540618e/attachment.html>

From andrew.bell.ia at gmail.com  Sat Jun 10 10:43:36 2017
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Sat, 10 Jun 2017 12:43:36 -0500
Subject: [gdal-dev] ISO-11783,
 known as Tractors and machinery for agriculture and forestry
In-Reply-To: <CAHNf2YRd=RvM99-mOShdZ=yKVhMhYEgfRZL1P06QVONgAptL2g@mail.gmail.com>
References: <CAHNf2YRd=RvM99-mOShdZ=yKVhMhYEgfRZL1P06QVONgAptL2g@mail.gmail.com>
Message-ID: <CACJ51z23SiGhbqWH-f8c7ASqZE38OxqNFed=Gk1n2FnEHHFVPg@mail.gmail.com>

You have to pay for the spec. Its

On Jun 10, 2017 10:05 AM, "Paul Meems" <bontepaarden at gmail.com> wrote:

Hi List,

I need to export my tiff file to ISOBUS (ISO-11783), which is a standard
for the agriculture.
In short I create a task map which will be loaded into a terminal of a
tractor and the terminal will manage the, for example, crop duster to spray
more or less according the the task map (using GPS).

Before I'm going to try to implement this by myself I want to check if
somebody already has made a converter (preferable using GDAL).

Useful links:
https://en.wikipedia.org/wiki/ISO_11783
http://www.aef-online.org/en/about-isobus/first-priority-isobus.html
I haven't found the link to the specifications, yet.


You have to pay for the specification.

I assume you're talking about task controller (ISO-11783 - 10)

For a treatment zone grid, the binary file is just an list of treatment
zones numbers as unsigned 8-bit entities (origin lower left -- southwest).
You also need to create the XML GRD object for the treatment zones.  The
binary spec. for process data values is more complicated.  You need to get
a copy of the spec in order to implement this, I think.  You can write me
off list if you have specific questions.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170610/61362398/attachment.html>

From even.rouault at spatialys.com  Sat Jun 10 11:07:33 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 10 Jun 2017 20:07:33 +0200
Subject: [gdal-dev] What is the maximum number of fields a shapefile can
	contain?
In-Reply-To: <1315355449.6266196.1497115686524@mail.yahoo.com>
References: <1315355449.6266196.1497115686524.ref@mail.yahoo.com>
 <1315355449.6266196.1497115686524@mail.yahoo.com>
Message-ID: <5804264.skNMJ2SAIO@even-i700>

On samedi 10 juin 2017 17:28:06 CEST Djordje Spasic wrote:
> Hello everyone,
> 
> When converting an .osm file to .shp files with ogr2ogr.exe, one needs to
> define a list of required fields in gdal-data\osmconf.ini file. I defined
> today a total of 338 field names, and the ogr2ogr.exe succeeded
> successfully in converting the .osm file to a .shp file containing all
> those 338 fields. 2 additional fields are added on top of 338 fields
> (osm_id, osm_way_id). Here is a screenshot of the fields from the .shp file
> opened in QGIS (QGIS lists fields from 0 as a starting index):
> https://www.dropbox.com/s/qw4uqvartn16b0b/shapefile_fields_QGIS2.jpg?dl=0
> 
> When .dbf file which is created along the .shp file is being opened in DBF
> Viewer, it also shows 340 fields:
> https://www.dropbox.com/s/hjzthyjzumjbddz/dbf_fields_DBFViewer2000.jpg?dl=0
> 
> My question is: how is this possible if a .shp file (.dbf file that is) can
> only store maximum of 255 fields? This is what Jukka Rahkonen pointed to
> me, a couple of months ago. Does this mean that when performing conversion,
> the ogr2ogr.exe is using some other shapefile format?

The DBF spec (or recommandations for shapefiles like
https://www.loc.gov/preservation/digital/formats/fdd/fdd000326.shtml) indeed say 255 
fields but there's nothing technically storing the field count in the DBF, so in practice the 
limit is determined by the most constraining of those 2 conditions :

field_count <= int((65535 - 33) / 32) = 2046

and

sum of all field_widths <= 65535

When OGR adds the 256th field it emits the following warning 

"""Creating a 256th field, but some DBF readers might only 
support 255 fields """

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170610/e9035d5a/attachment.html>

From sravan.velagandula at openscg.com  Mon Jun 12 00:12:32 2017
From: sravan.velagandula at openscg.com (Velagandula, Sravan Kumar)
Date: Mon, 12 Jun 2017 12:42:32 +0530
Subject: [gdal-dev] .exe extension missing for gdal-2.2.0 binaries
In-Reply-To: <CAJRRhdYgXsaJPenV+hsqH=kdRBz7rNdYzA++d0FTNtLno4Dm4A@mail.gmail.com>
References: <CAJRRhdbezr7L7HznP4RfOEc9AKwP3p=kWXiw1rURPp1YSxPPmA@mail.gmail.com>
 <4004146.syNnpz8eIf@even-i700>
 <CAJRRhdaCn=9D3Acp0hM2NUg4s=O1Epnt-_+nVK23j=u1Q4b6Uw@mail.gmail.com>
 <7096282.upXSzWeVuh@even-i700>
 <CAJRRhdYgXsaJPenV+hsqH=kdRBz7rNdYzA++d0FTNtLno4Dm4A@mail.gmail.com>
Message-ID: <CAJRRhdY4pHtnZG1EG-eua5iTT_PS58ZuEHj02346P54z2OXQAg@mail.gmail.com>

If it may help anyone running into the same issue I was able to build the
binaries with the .exe
suffix without having to edit the GDALmake.opt by doing the following:

a) export MINGHOST=x86_64-w64-mingw32
b) Use the --host option as "--host=${MINGHOST}" of the configure command.

Thanks,
Sravan

On Fri, Jun 9, 2017 at 3:44 PM, Velagandula, Sravan Kumar <
sravan.velagandula at openscg.com> wrote:

> I apologize for not having confirmed that I am using the same toolchain
> for both the builds.
>
> Thanks for the valuable feedback. I would tweak the configure script to
> get my builds going.
>
> - Sravan
>
> On Fri, Jun 9, 2017 at 3:40 PM, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> On vendredi 9 juin 2017 15:31:12 CEST Velagandula, Sravan Kumar wrote:
>>
>> > Hello Even,
>>
>> >
>>
>> > I see that the value of ${host_os} is "mingw64" for gdal-2.20 and
>>
>> > "mingw32" for gdal-2.0
>>
>>
>>
>> OK, so with a different toolchain between both builds ?
>>
>>
>>
>> Anyway, should be now fixed per https://trac.osgeo.org/gdal/ticket/6919
>> that changes the mingw32* pattern to mingw* to catch both cases.
>>
>>
>>
>> Or you can just edit GDALmake.opt after ./configure , look for the
>>
>> EXE =
>>
>> line and modify it as
>>
>> EXE = .exe
>>
>>
>>
>> Even
>>
>>
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/143c6a7f/attachment.html>

From julien.michel at cnes.fr  Mon Jun 12 02:55:16 2017
From: julien.michel at cnes.fr (Julien Michel)
Date: Mon, 12 Jun 2017 11:55:16 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
In-Reply-To: <1d71f05f-2e06-c8ae-caea-bcc016935c76@jacobs-university.de>
References: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
 <1d71f05f-2e06-c8ae-caea-bcc016935c76@jacobs-university.de>
Message-ID: <5d6b6f72-9809-91bc-5b4d-9a5bfc34faf3@cnes.fr>

Hi Peter,

I know about rasdaman, I even attended the rasdaman tutorial at FOSS4GEU 
2015. But my point is not to choose or compare implementations : I am 
working with a project that uses the this ODC,  I want to be able to do 
some OTB processing with it, and OTB reads data through gdal. And from a 
gdal perspective, it makes sense to have drivers for every possible 
(open-source) data source. Hence my question. I am a bit worried about 
the overhead of what Even sketched ;)

Regards,

Julien


Le 04/06/2017 à 15:09, Peter Baumann a écrit :
> Hi Julien,
>
> already seen rasdaman (www.rasdaman.org)? Fully implemented nD datacube engine,
> proven on massive data, in operational use (not just planning phase)...and
> proudly using GDAL.
>
> As I am editor of the OGC datacube standards I'll be glad to give advice on
> standards-based coupling. Just le me know your plans.
>
> cheers,
>
> Peter
>
>
> On 06/02/2017 02:28 PM, Julien Michel wrote:
>> Dear all,
>>
>> There is a lot of activity around this Open Data Cube [1] initiative, which
>> seems promising. As far as I understand it however, what we can do with data
>> in the datacube is limited to what the python API allows you to do. Is there
>> any plan (and does it even make sense ?) to have a gdal driver that allows to
>> address data ingested in a datacube instance ?
>>
>> Thanks a lot,
>>
>> Regards,
>>
>> Julien
>>
>> [1] https://github.com/opendatacube/datacube-core
>>


-- 
Julien MICHEL
CNES - DSO/SI/2A - BPI 1219
18, avenue Edouard Belin
31401 Toulouse Cedex 09 - France
Tel: +33 561 282 894 - Fax: +33 561 283 109


From p.baumann at jacobs-university.de  Mon Jun 12 04:24:23 2017
From: p.baumann at jacobs-university.de (Peter Baumann)
Date: Mon, 12 Jun 2017 13:24:23 +0200
Subject: [gdal-dev] Gdal and Open Data Cube
In-Reply-To: <5d6b6f72-9809-91bc-5b4d-9a5bfc34faf3@cnes.fr>
References: <b036ab8e-398d-cdc9-9346-356d50e486fa@cnes.fr>
 <1d71f05f-2e06-c8ae-caea-bcc016935c76@jacobs-university.de>
 <5d6b6f72-9809-91bc-5b4d-9a5bfc34faf3@cnes.fr>
Message-ID: <2e6cfd1d-fc86-18f7-66c5-54fc01a33eec@jacobs-university.de>

Hi Julien,

understood, a particular project will usually have particular constraints, no
problem. Actually, should you be willing to undertake this ODC endeavour maybe
you can post a summary of functionality and performance comparison here
afterwards? Might be interesting for some.

best,

Peter



On 06/12/2017 11:55 AM, Julien Michel wrote:
> Hi Peter,
>
> I know about rasdaman, I even attended the rasdaman tutorial at FOSS4GEU 2015.
> But my point is not to choose or compare implementations : I am working with a
> project that uses the this ODC,  I want to be able to do some OTB processing
> with it, and OTB reads data through gdal. And from a gdal perspective, it
> makes sense to have drivers for every possible (open-source) data source.
> Hence my question. I am a bit worried about the overhead of what Even sketched ;)
>
> Regards,
>
> Julien
>
>
> Le 04/06/2017 à 15:09, Peter Baumann a écrit :
>> Hi Julien,
>>
>> already seen rasdaman (www.rasdaman.org)? Fully implemented nD datacube engine,
>> proven on massive data, in operational use (not just planning phase)...and
>> proudly using GDAL.
>>
>> As I am editor of the OGC datacube standards I'll be glad to give advice on
>> standards-based coupling. Just le me know your plans.
>>
>> cheers,
>>
>> Peter
>>
>>
>> On 06/02/2017 02:28 PM, Julien Michel wrote:
>>> Dear all,
>>>
>>> There is a lot of activity around this Open Data Cube [1] initiative, which
>>> seems promising. As far as I understand it however, what we can do with data
>>> in the datacube is limited to what the python API allows you to do. Is there
>>> any plan (and does it even make sense ?) to have a gdal driver that allows to
>>> address data ingested in a datacube instance ?
>>>
>>> Thanks a lot,
>>>
>>> Regards,
>>>
>>> Julien
>>>
>>> [1] https://github.com/opendatacube/datacube-core
>>>
>
>

-- 
Dr. Peter Baumann
 - Professor of Computer Science, Jacobs University Bremen
   www.faculty.jacobs-university.de/pbaumann
   mail: p.baumann at jacobs-university.de
   tel: +49-421-200-3178, fax: +49-421-200-493178
 - Executive Director, rasdaman GmbH Bremen (HRB 26793)
   www.rasdaman.com, mail: baumann at rasdaman.com
   tel: 0800-rasdaman, fax: 0800-rasdafax, mobile: +49-173-5837882
"Si forte in alienas manus oberraverit hec peregrina epistola incertis ventis dimissa, sed Deo commendata, precamur ut ei reddatur cui soli destinata, nec preripiat quisquam non sibi parata." (mail disclaimer, AD 1083)



From bontepaarden at gmail.com  Mon Jun 12 07:14:21 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Mon, 12 Jun 2017 16:14:21 +0200
Subject: [gdal-dev] Clip tiff with shapefile
Message-ID: <CAHNf2YRhx+F=87vDmCaLm=9dbZteYbwnOuyfieGvTTue37f9iw@mail.gmail.com>

Hi,

I'm trying to clip a tiff-file with a shapefile.
I'm using GDAL v2.1.3 with the SWIG-bindings in my C# application.

The tiff-file has this info:
Driver: GTiff/GeoTIFF
Files:
Size is 5140, 6065
Coordinate System is:
PROJCS["WGS 84 / UTM zone 32N",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","32632"]]
Origin = (360810.191610000040000,5860662.620930000200000)
Pixel Size = (0.125010000000000,-0.125010000000000)
Metadata:
  AREA_OR_POINT=Area
  TIFFTAG_SOFTWARE=pix4dmapper
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (  360810.192, 5860662.621) (  6d55'54.04"E, 52d52'39.50"N)
Lower Left  (  360810.192, 5859904.435) (  6d55'55.21"E, 52d52'14.98"N)
Upper Right (  361452.743, 5860662.621) (  6d56'28.39"E, 52d52'40.10"N)
Lower Right (  361452.743, 5859904.435) (  6d56'29.55"E, 52d52'15.58"N)
Center      (  361131.467, 5860283.528) (  6d56'11.80"E, 52d52'27.54"N)
Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
  Min=-0.177 Max=33.644
  Minimum=-0.177, Maximum=33.644, Mean=18.605, StdDev=7.894
  NoData Value=-10000
  Metadata:
    STATISTICS_MAXIMUM=33.644180297852
    STATISTICS_MEAN=18.604999564386
    STATISTICS_MINIMUM=-0.17713606357574
    STATISTICS_STDDEV=7.8939827089249

The border can be in a different projection. Because I create this file
earlier I know its EPSG-code.
Before clipping I want to check if both files are in the same projection.
How can I do this? I know I can use SpatialReference. But how to convert
the projection string in the metadata of my tiff to EPSG code?
If they have different projections I need to reproject my border shapefile
first using VectorTranslate.

I was think of using these options:
var options = new[]
{
    "-s_srs", "EPSG:" + sridInput,
    "-t_srs", "EPSG:" + sridOutput,
    "-f", "ESRI Shapefile"
};
VectorTranslate(input, output, options);

But then I need to get the EPSG code of the tiff file.

Please advice.

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/1fa6a913/attachment-0001.html>

From spencergardner at gmail.com  Mon Jun 12 07:40:54 2017
From: spencergardner at gmail.com (Spencer Gardner)
Date: Mon, 12 Jun 2017 09:40:54 -0500
Subject: [gdal-dev] gdal_calc not ignoring NoData values?
Message-ID: <CAHCHdbJhdoqXBsoPrL-4hY5svykcGyUATzT00jBaeT2S7r25iQ@mail.gmail.com>

I have two integer rasters, A and B, with the same dimensions and cell
sizes. I want to compare each cell in A with each cell in B and keep the
maximum value. In cases where both have nodata, I want the result to be
nodata. In cases where one is nodata, I want the result to be the integer
value of the one with data.

   Raster A                    Raster B
|   1     |   1     |             |   3     |   1     |
|   1     |nodata|             |nodata|   3     |
|nodata|   1     |             |nodata|nodata|
|nodata|   4     |             |nodata|   1     |

--------------------------------------------
                Desired result
               |   3     |   1     |
               |   1     |   3     |
               |nodata|   1     |
               |nodata|   4     |

've tried combining them in many different ways using gdal_calc but somehow
I can't seem to get the answer I'm looking for. My first instinct was to
use numpy.fmax since the documentation states that the NaN value is
ignored. But this calculation

--calc "numpy.fmax(A,B)"

only gives me the results I want in cells where both datasets have a value.
A nodata in either results in nodata in the result:

              numpy.fmax result
               |   3     |   1     |
               |nodata|nodata|
               |nodata|nodata|
               |nodata|   4     |

Perhaps I'm confused about how nodata translates to NaN in numpy? What is a
straightforward way to accomplish this with gdal_calc?

Thanks for any help,
Spencer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/67f484f0/attachment.html>

From cgodkin at gmail.com  Mon Jun 12 08:04:08 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 12 Jun 2017 08:04:08 -0700
Subject: [gdal-dev] Building with plugins...
Message-ID: <CAE=8kmnS0cA4Q5=EZX0ikxga3Hr1zQoYBBRm92Gf5Pq=KMg7Lw@mail.gmail.com>

Hi,

I am interested in building GDAL 2.2.0 with some of the available drivers
as plugins.

1. Is the procedure for building GDAL plugins documented anywhere for
Linux?  I see that there are several variables like XXX_PLUGIN listed in
nmake.opt for Windows but I'd like to use plugins on Linux as well and
can't see any relevant arguments for "configure" (except
--enable-pdf-plugin).

2. Is there a list of which drivers can be built as plugins anywhere?  (I
know that the GISInternals build provides about 10 drivers as plugins but
the many commented-out drivers in nmake.opt leads me to believe that there
could be even more than that.

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/bc08833a/attachment.html>

From Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com  Mon Jun 12 08:22:58 2017
From: Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com (Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com)
Date: Mon, 12 Jun 2017 17:22:58 +0200
Subject: [gdal-dev] Question on creating geotiff from tif based on tfw/tab
 and EPSG code
Message-ID: <OF794E8570.9DE4B057-ONC125813D.005292C0-C125813D.005482CE@rohde-schwarz.com>

Hello, 
I would like to add geotiff meta data to an existing tif file. 
The meta data is known as tfw/tab files and as EPSG code. I was trying 
hard to have this done with fwtools and geotifcp, but I couldn't create a 
proper meta data file based on the EPSG code (even though the proj4 is 
available). As I haven't got a working sample file with the desired EPSG 
code, I wonder if there is some non-manual method to create one based on 
one of the strings given here: http://spatialreference.org/ref/epsg/31468/
). 
Is this feasible at all? Or how would a GDAL expert do this? 
Any hint would be welcome! 

Thank you very much  in advance
Niels


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/2962ce4e/attachment.html>

From even.rouault at spatialys.com  Mon Jun 12 10:41:00 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 Jun 2017 19:41:00 +0200
Subject: [gdal-dev] Question on creating geotiff from tif based on
	tfw/tab and EPSG code
In-Reply-To: <OF794E8570.9DE4B057-ONC125813D.005292C0-C125813D.005482CE@rohde-schwarz.com>
References: <OF794E8570.9DE4B057-ONC125813D.005292C0-C125813D.005482CE@rohde-schwarz.com>
Message-ID: <5506220.kxYnBU8KXc@even-i700>

On lundi 12 juin 2017 17:22:58 CEST Niels.vonFestenberg-Packisch.ext at rohde-schwarz.com 
wrote:
> Hello,
> I would like to add geotiff meta data to an existing tif file.
> The meta data is known as tfw/tab files and as EPSG code. I was trying
> hard to have this done with fwtools and geotifcp, but I couldn't create a
> proper meta data file based on the EPSG code (even though the proj4 is
> available). As I haven't got a working sample file with the desired EPSG
> code, I wonder if there is some non-manual method to create one based on
> one of the strings given here: http://spatialreference.org/ref/epsg/31468/
> ).
> Is this feasible at all? 

Niels,

gdal_edit.py -a_srs EPSG:XXXXX your.tif

See http://gdal.org/gdal_edit.html

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/d643a915/attachment.html>

From even.rouault at spatialys.com  Mon Jun 12 10:44:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 Jun 2017 19:44:49 +0200
Subject: [gdal-dev] Building with plugins...
In-Reply-To: <CAE=8kmnS0cA4Q5=EZX0ikxga3Hr1zQoYBBRm92Gf5Pq=KMg7Lw@mail.gmail.com>
References: <CAE=8kmnS0cA4Q5=EZX0ikxga3Hr1zQoYBBRm92Gf5Pq=KMg7Lw@mail.gmail.com>
Message-ID: <15598246.vSWZxYo1ch@even-i700>

On lundi 12 juin 2017 08:04:08 CEST Carl Godkin wrote:
> Hi,
> 
> I am interested in building GDAL 2.2.0 with some of the available drivers
> as plugins.
> 
> 1. Is the procedure for building GDAL plugins documented anywhere for
> Linux?

I don't think so. Plugin building in Linux is more experimental/advanced.

> I see that there are several variables like XXX_PLUGIN listed in
> nmake.opt for Windows but I'd like to use plugins on Linux as well and
> can't see any relevant arguments for "configure" (except
> --enable-pdf-plugin).

There's also the GRASS plugin that has its own configure. And Debian/Ubuntu has a package 
with a configure to build the ECW (and MrSID I think) plugins. Otherwise except for the PDF 
plugin, you need to tweak yourself the makefile if you need a driver build as a plugin.

> 
> 2. Is there a list of which drivers can be built as plugins anywhere?  (I
> know that the GISInternals build provides about 10 drivers as plugins but
> the many commented-out drivers in nmake.opt leads me to believe that there
> could be even more than that.

Well, basically the list in nmake.opt should be pretty much what is available:

$ grep _PLUGIN nmake.opt | grep "#"
#ECW_PLUGIN = YES
#JP2LURA_PLUGIN = YES
#TD_PLUGIN = YES
#HDF4_PLUGIN = NO
#HDF5_PLUGIN = NO
#KEA_PLUGIN = NO
# INGRES_PLUGIN = YES
#FITS_PLUGIN = NO
#NETCDF_PLUGIN = NO
#OCI_PLUGIN = YES
#SDE_PLUGIN = NO
#FGDB_PLUGIN = YES
#AMIGOCLOUD_PLUGIN = YES
#ARCOBJECTS_PLUGIN = YES
#SOSI_PLUGIN = YES
#PDF_PLUGIN = NO
#MONGODB_PLUGIN = NO
# MONGODB_PLUGIN = YES


> 
> Thanks very much,
> 
> carl


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/68e978e5/attachment-0001.html>

From even.rouault at spatialys.com  Mon Jun 12 10:48:16 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 12 Jun 2017 19:48:16 +0200
Subject: [gdal-dev] Clip tiff with shapefile
In-Reply-To: <CAHNf2YRhx+F=87vDmCaLm=9dbZteYbwnOuyfieGvTTue37f9iw@mail.gmail.com>
References: <CAHNf2YRhx+F=87vDmCaLm=9dbZteYbwnOuyfieGvTTue37f9iw@mail.gmail.com>
Message-ID: <9599491.oM78pJ1tpX@even-i700>

On lundi 12 juin 2017 16:14:21 CEST Paul Meems wrote:
> Hi,
> 
> I'm trying to clip a tiff-file with a shapefile.
> I'm using GDAL v2.1.3 with the SWIG-bindings in my C# application.
> 
> The tiff-file has this info:
> Driver: GTiff/GeoTIFF
> Files:
> Size is 5140, 6065
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 32N",
>     GEOGCS["WGS 84",
>         DATUM["WGS_1984",
>             SPHEROID["WGS 84",6378137,298.257223563,
>                 AUTHORITY["EPSG","7030"]],
>             AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich",0,
>             AUTHORITY["EPSG","8901"]],
>         UNIT["degree",0.0174532925199433,
>             AUTHORITY["EPSG","9122"]],
>         AUTHORITY["EPSG","4326"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",9],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AXIS["Easting",EAST],
>     AXIS["Northing",NORTH],
>     AUTHORITY["EPSG","32632"]]
> Origin = (360810.191610000040000,5860662.620930000200000)
> Pixel Size = (0.125010000000000,-0.125010000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=pix4dmapper
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  360810.192, 5860662.621) (  6d55'54.04"E, 52d52'39.50"N)
> Lower Left  (  360810.192, 5859904.435) (  6d55'55.21"E, 52d52'14.98"N)
> Upper Right (  361452.743, 5860662.621) (  6d56'28.39"E, 52d52'40.10"N)
> Lower Right (  361452.743, 5859904.435) (  6d56'29.55"E, 52d52'15.58"N)
> Center      (  361131.467, 5860283.528) (  6d56'11.80"E, 52d52'27.54"N)
> Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>   Min=-0.177 Max=33.644
>   Minimum=-0.177, Maximum=33.644, Mean=18.605, StdDev=7.894
>   NoData Value=-10000
>   Metadata:
>     STATISTICS_MAXIMUM=33.644180297852
>     STATISTICS_MEAN=18.604999564386
>     STATISTICS_MINIMUM=-0.17713606357574
>     STATISTICS_STDDEV=7.8939827089249
> 
> The border can be in a different projection. Because I create this file
> earlier I know its EPSG-code.
> Before clipping I want to check if both files are in the same projection.
> How can I do this? I know I can use SpatialReference. But how to convert
> the projection string in the metadata of my tiff to EPSG code?

You don't necessarily need to do that. As a value of -s_srs / -t_srs you can pass a WKT string 
(or a proj.4 string)

To answer your question if you use the SpatialReference.GetAuthorityCode(), you will get the 
EPSG code (when there's one explicitly set in the projection string)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/f628d692/attachment.html>

From cgodkin at gmail.com  Mon Jun 12 10:55:11 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 12 Jun 2017 10:55:11 -0700
Subject: [gdal-dev] Building with plugins...
In-Reply-To: <15598246.vSWZxYo1ch@even-i700>
References: <CAE=8kmnS0cA4Q5=EZX0ikxga3Hr1zQoYBBRm92Gf5Pq=KMg7Lw@mail.gmail.com>
 <15598246.vSWZxYo1ch@even-i700>
Message-ID: <CAE=8kmm3B5ARqEXBdyOMjLG74wd=90Yp7--OJNbN94J=AA_7GQ@mail.gmail.com>

Thanks very much.  (No wonder I couldn't find much information about these
things anywhere!)

carl

On Mon, Jun 12, 2017 at 10:44 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On lundi 12 juin 2017 08:04:08 CEST Carl Godkin wrote:
>
> > Hi,
>
> >
>
> > I am interested in building GDAL 2.2.0 with some of the available drivers
>
> > as plugins.
>
> >
>
> > 1. Is the procedure for building GDAL plugins documented anywhere for
>
> > Linux?
>
>
>
> I don't think so. Plugin building in Linux is more experimental/advanced.
>
>
>
> > I see that there are several variables like XXX_PLUGIN listed in
>
> > nmake.opt for Windows but I'd like to use plugins on Linux as well and
>
> > can't see any relevant arguments for "configure" (except
>
> > --enable-pdf-plugin).
>
>
>
> There's also the GRASS plugin that has its own configure. And
> Debian/Ubuntu has a package with a configure to build the ECW (and MrSID I
> think) plugins. Otherwise except for the PDF plugin, you need to tweak
> yourself the makefile if you need a driver build as a plugin.
>
>
>
> >
>
> > 2. Is there a list of which drivers can be built as plugins anywhere? (I
>
> > know that the GISInternals build provides about 10 drivers as plugins but
>
> > the many commented-out drivers in nmake.opt leads me to believe that
> there
>
> > could be even more than that.
>
>
>
> Well, basically the list in nmake.opt should be pretty much what is
> available:
>
>
>
> $ grep _PLUGIN nmake.opt | grep "#"
>
> #ECW_PLUGIN = YES
>
> #JP2LURA_PLUGIN = YES
>
> #TD_PLUGIN = YES
>
> #HDF4_PLUGIN = NO
>
> #HDF5_PLUGIN = NO
>
> #KEA_PLUGIN = NO
>
> # INGRES_PLUGIN = YES
>
> #FITS_PLUGIN = NO
>
> #NETCDF_PLUGIN = NO
>
> #OCI_PLUGIN = YES
>
> #SDE_PLUGIN = NO
>
> #FGDB_PLUGIN = YES
>
> #AMIGOCLOUD_PLUGIN = YES
>
> #ARCOBJECTS_PLUGIN = YES
>
> #SOSI_PLUGIN = YES
>
> #PDF_PLUGIN = NO
>
> #MONGODB_PLUGIN = NO
>
> # MONGODB_PLUGIN = YES
>
>
>
>
>
> >
>
> > Thanks very much,
>
> >
>
> > carl
>
>
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170612/51ffcff9/attachment-0001.html>

From bontepaarden at gmail.com  Tue Jun 13 04:20:24 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 13 Jun 2017 13:20:24 +0200
Subject: [gdal-dev] Raster calculation optimalisation
Message-ID: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>

 I'm using GDAL v2.1.3 with the SWIG bindings in my custom C# application.

I've created a method to do some calculation of my raster file:
public bool GdalCalculate(string input, string output, string formula,
double? minValue = null)
{
    if (!File.Exists(input))
        throw new FileNotFoundException("Can't find the input file", new
Exception("Working with " + input));

    // 1. First copy the input file to create the output file
    try
    {
        /*
-------------------------------------------------------------------- */
        /*      Get driver
     */
        /*
-------------------------------------------------------------------- */
        using (var drv = Gdal.GetDriverByName("GTiff"))
        {
            if (drv == null)
            {
                throw new Exception("Can't get GTiff driver");
            }

            /*
-------------------------------------------------------------------- */
            /*      Open dataset.
        */
            /*
-------------------------------------------------------------------- */
            using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
            {
                if (ds == null)
                {
                    throw new Exception("Can't open GDAL dataset: " +
input);
                }

                var options = new[] { "" };
                using (var newDataset = drv.CreateCopy(output, ds, 0,
options, null, "Sample Data"))
                {
                    if (newDataset == null)
                    {
                        throw new Exception("Can't create destination
dataset: " + output);
                    }

                    // Close input dataset:
                    ds.Dispose();

                    // 2. Loop through all pixels and perform formula on it:
                    using (var band = newDataset.GetRasterBand(1))
                    {
                        double noData;
                        int hasValue;
                        band.GetNoDataValue(out noData, out hasValue);
                        var sizeX = band.XSize;
                        var numLines = band.YSize;
                        var func = new Function("f(A) = " + formula);

                        // Loop through each line in turn.
                        for (var line = 0; line < numLines; line++)
                        {
                            var scanline = new float[sizeX];
                            // Read in data for the current line
                            var cplReturn = band.ReadRaster(0, line, sizeX,
1, scanline, sizeX, 1, 0, 0);
                            if (cplReturn != CPLErr.CE_None)
                            {
                                throw new Exception("band.ReadRaster
failed: " + Gdal.GetLastErrorMsg());
                            }

                            var outputLine = new List<float>();
                            foreach (var f in scanline)
                            {
                                var pixelValue = f;
                                if ((float)f != (float)noData)
                                {
                                    // Calculate
                                    pixelValue = (float)func.calculate(f);
                                    if (minValue.HasValue)
                                        pixelValue =
(float)Math.Max(pixelValue, minValue.GetValueOrDefault());
                                }
                                outputLine.Add(pixelValue);
                            }

                            // Rewrite line:
                            cplReturn = band.WriteRaster(0, line, sizeX, 1,
outputLine.ToArray(), sizeX, 1, 0, 0);
                            if (cplReturn != CPLErr.CE_None)
                            {
                                throw new Exception("band.WriteRaster
failed: " + Gdal.GetLastErrorMsg());
                            }
                        }

                        // 3. Save changes to file:
                        band.FlushCache();
                        newDataset.FlushCache();
                    }
                }
            }
        }
    }
    catch (Exception e)
    {
        throw new Exception("Can't open GDAL dataset: " + input, e);
    }

    return true;
}

This method is working fine, but is very slow.
I'm using a 3621x4466 tiff file, which has a size of 67MB.
It is taking around 10 minutes to process.
(float)func.calculate(f); is using http://mathparser.org/
An example of a function I'm using: 9.7E-05-e^(3.1 + 0.9 * A) where A is
the pixel value.

How can I optimize my function?

Thanks,

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/a514624c/attachment.html>

From damian.dixon at gmail.com  Tue Jun 13 06:05:03 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Tue, 13 Jun 2017 14:05:03 +0100
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
Message-ID: <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>

Hi Paul,

What is the time to run your code without applying the calculation to each
pixel?

It is usually better to process the pixels in a block rather than walking
across each row especially if you are processing a TIFF as these are
usually stored as tiles (blocks).

The crossing from C# to C++ will also impact the performance so take a look
at the time it takes to set the pixels. There may also be a method to set a
block of pixels.

Sorry I can't help you more than some general advice and hints.

Regards
Damian



On 13 June 2017 at 12:20, Paul Meems <bontepaarden at gmail.com> wrote:

> I'm using GDAL v2.1.3 with the SWIG bindings in my custom C# application.
>
> I've created a method to do some calculation of my raster file:
> public bool GdalCalculate(string input, string output, string formula,
> double? minValue = null)
> {
>     if (!File.Exists(input))
>         throw new FileNotFoundException("Can't find the input file", new
> Exception("Working with " + input));
>
>     // 1. First copy the input file to create the output file
>     try
>     {
>         /* --------------------------------------------------------------------
> */
>         /*      Get driver
>      */
>         /* --------------------------------------------------------------------
> */
>         using (var drv = Gdal.GetDriverByName("GTiff"))
>         {
>             if (drv == null)
>             {
>                 throw new Exception("Can't get GTiff driver");
>             }
>
>             /* ------------------------------
> -------------------------------------- */
>             /*      Open dataset.
>           */
>             /* ------------------------------
> -------------------------------------- */
>             using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
>             {
>                 if (ds == null)
>                 {
>                     throw new Exception("Can't open GDAL dataset: " +
> input);
>                 }
>
>                 var options = new[] { "" };
>                 using (var newDataset = drv.CreateCopy(output, ds, 0,
> options, null, "Sample Data"))
>                 {
>                     if (newDataset == null)
>                     {
>                         throw new Exception("Can't create destination
> dataset: " + output);
>                     }
>
>                     // Close input dataset:
>                     ds.Dispose();
>
>                     // 2. Loop through all pixels and perform formula on
> it:
>                     using (var band = newDataset.GetRasterBand(1))
>                     {
>                         double noData;
>                         int hasValue;
>                         band.GetNoDataValue(out noData, out hasValue);
>                         var sizeX = band.XSize;
>                         var numLines = band.YSize;
>                         var func = new Function("f(A) = " + formula);
>
>                         // Loop through each line in turn.
>                         for (var line = 0; line < numLines; line++)
>                         {
>                             var scanline = new float[sizeX];
>                             // Read in data for the current line
>                             var cplReturn = band.ReadRaster(0, line,
> sizeX, 1, scanline, sizeX, 1, 0, 0);
>                             if (cplReturn != CPLErr.CE_None)
>                             {
>                                 throw new Exception("band.ReadRaster
> failed: " + Gdal.GetLastErrorMsg());
>                             }
>
>                             var outputLine = new List<float>();
>                             foreach (var f in scanline)
>                             {
>                                 var pixelValue = f;
>                                 if ((float)f != (float)noData)
>                                 {
>                                     // Calculate
>                                     pixelValue = (float)func.calculate(f);
>                                     if (minValue.HasValue)
>                                         pixelValue =
> (float)Math.Max(pixelValue, minValue.GetValueOrDefault());
>                                 }
>                                 outputLine.Add(pixelValue);
>                             }
>
>                             // Rewrite line:
>                             cplReturn = band.WriteRaster(0, line, sizeX,
> 1, outputLine.ToArray(), sizeX, 1, 0, 0);
>                             if (cplReturn != CPLErr.CE_None)
>                             {
>                                 throw new Exception("band.WriteRaster
> failed: " + Gdal.GetLastErrorMsg());
>                             }
>                         }
>
>                         // 3. Save changes to file:
>                         band.FlushCache();
>                         newDataset.FlushCache();
>                     }
>                 }
>             }
>         }
>     }
>     catch (Exception e)
>     {
>         throw new Exception("Can't open GDAL dataset: " + input, e);
>     }
>
>     return true;
> }
>
> This method is working fine, but is very slow.
> I'm using a 3621x4466 tiff file, which has a size of 67MB.
> It is taking around 10 minutes to process.
> (float)func.calculate(f); is using http://mathparser.org/
> An example of a function I'm using: 9.7E-05-e^(3.1 + 0.9 * A) where A is
> the pixel value.
>
> How can I optimize my function?
>
> Thanks,
>
> Paul
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/14daa79e/attachment-0001.html>

From bontepaarden at gmail.com  Tue Jun 13 06:21:32 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Tue, 13 Jun 2017 15:21:32 +0200
Subject: [gdal-dev] Clip tiff with shapefile
In-Reply-To: <CAHNf2YRhx+F=87vDmCaLm=9dbZteYbwnOuyfieGvTTue37f9iw@mail.gmail.com>
References: <CAHNf2YRhx+F=87vDmCaLm=9dbZteYbwnOuyfieGvTTue37f9iw@mail.gmail.com>
Message-ID: <CAHNf2YS0KRDXzEmo2J_EKGUg2MMxV_kioXbOEm2MKr71dJDH5g@mail.gmail.com>

To answer my own question:

GdalWarp is smart enough to internally reproject if needed.
So I can use my tiff in UTM and my border in 28992 and I get a perfectly
clipped output.



Paul

*Paul Meems *
Release manager, configuration manager
and forum moderator of MapWindow GIS.
www.mapwindow.org

Owner of MapWindow.nl - Support for
Dutch speaking users.
www.mapwindow.nl


*The MapWindow GIS project has moved to GitHub
<https://github.com/MapWindow>!*


Download the latest MapWinGIS mapping engine.
<https://github.com/MapWindow/MapWinGIS/releases>

Download the latest MapWindow 5 open source desktop application.
<https://github.com/MapWindow/MapWindow5/releases>

2017-06-12 16:14 GMT+02:00 Paul Meems <bontepaarden at gmail.com>:

> Hi,
>
> I'm trying to clip a tiff-file with a shapefile.
> I'm using GDAL v2.1.3 with the SWIG-bindings in my C# application.
>
> The tiff-file has this info:
> Driver: GTiff/GeoTIFF
> Files:
> Size is 5140, 6065
> Coordinate System is:
> PROJCS["WGS 84 / UTM zone 32N",
>     GEOGCS["WGS 84",
>         DATUM["WGS_1984",
>             SPHEROID["WGS 84",6378137,298.257223563,
>                 AUTHORITY["EPSG","7030"]],
>             AUTHORITY["EPSG","6326"]],
>         PRIMEM["Greenwich",0,
>             AUTHORITY["EPSG","8901"]],
>         UNIT["degree",0.0174532925199433,
>             AUTHORITY["EPSG","9122"]],
>         AUTHORITY["EPSG","4326"]],
>     PROJECTION["Transverse_Mercator"],
>     PARAMETER["latitude_of_origin",0],
>     PARAMETER["central_meridian",9],
>     PARAMETER["scale_factor",0.9996],
>     PARAMETER["false_easting",500000],
>     PARAMETER["false_northing",0],
>     UNIT["metre",1,
>         AUTHORITY["EPSG","9001"]],
>     AXIS["Easting",EAST],
>     AXIS["Northing",NORTH],
>     AUTHORITY["EPSG","32632"]]
> Origin = (360810.191610000040000,5860662.620930000200000)
> Pixel Size = (0.125010000000000,-0.125010000000000)
> Metadata:
>   AREA_OR_POINT=Area
>   TIFFTAG_SOFTWARE=pix4dmapper
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=BAND
> Corner Coordinates:
> Upper Left  (  360810.192, 5860662.621) (  6d55'54.04"E, 52d52'39.50"N)
> Lower Left  (  360810.192, 5859904.435) (  6d55'55.21"E, 52d52'14.98"N)
> Upper Right (  361452.743, 5860662.621) (  6d56'28.39"E, 52d52'40.10"N)
> Lower Right (  361452.743, 5859904.435) (  6d56'29.55"E, 52d52'15.58"N)
> Center      (  361131.467, 5860283.528) (  6d56'11.80"E, 52d52'27.54"N)
> Band 1 Block=256x256 Type=Float32, ColorInterp=Gray
>   Min=-0.177 Max=33.644
>   Minimum=-0.177, Maximum=33.644, Mean=18.605, StdDev=7.894
>   NoData Value=-10000
>   Metadata:
>     STATISTICS_MAXIMUM=33.644180297852
>     STATISTICS_MEAN=18.604999564386
>     STATISTICS_MINIMUM=-0.17713606357574
>     STATISTICS_STDDEV=7.8939827089249
>
> The border can be in a different projection. Because I create this file
> earlier I know its EPSG-code.
> Before clipping I want to check if both files are in the same projection.
> How can I do this? I know I can use SpatialReference. But how to convert
> the projection string in the metadata of my tiff to EPSG code?
> If they have different projections I need to reproject my border shapefile
> first using VectorTranslate.
>
> I was think of using these options:
> var options = new[]
> {
>     "-s_srs", "EPSG:" + sridInput,
>     "-t_srs", "EPSG:" + sridOutput,
>     "-f", "ESRI Shapefile"
> };
> VectorTranslate(input, output, options);
>
> But then I need to get the EPSG code of the tiff file.
>
> Please advice.
>
> Thanks,
>
> Paul
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/96dac083/attachment.html>

From damian.dixon at gmail.com  Tue Jun 13 06:36:11 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Tue, 13 Jun 2017 14:36:11 +0100
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <CAHNf2YRxVNDJZz91Hj8XSnFuhLN1Q0NcgBw9ZBbGz-cJBS9L7A@mail.gmail.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
 <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>
 <CAHNf2YRxVNDJZz91Hj8XSnFuhLN1Q0NcgBw9ZBbGz-cJBS9L7A@mail.gmail.com>
Message-ID: <CAJjdW1zLQw_QAz=896DncA_D9R-8W14X6kA_9kooeu2YcGyyrg@mail.gmail.com>

​Hi Paul,

I can only do snippets in C++...

You can get the block size using:

  poBand->GetBlockSize( &nBlockXSize, &nBlockYSize );

then do a read something like:

  for(int band = 0; band <noBands;band++)
  {

poBand[0]->AdviseRead(startX+xoffset,startY+yoffset,blockWidth,blockHeight,blockWidth,blockHeight,GDT_Int32,
NULL);
    CPLErr err =
poBand[band]->RasterIO(GF_Read,startX+xoffset,startY+yoffset,blockWidth,blockHeight,buffer[band],blockWidth,blockHeight,GDT_Int32,0,0);
    if(err != CE_None)
    {
      report an error
    }
  }

I don't normally put raster back into GDAL we just use GDAL to read data
and do all the processing ourselves.

I suspect all you have to do is change GF_Read to GF_Write and a few other
tweaks :>>.

Regards
Damian
​
The following page may be of help: http://www.gdal.org/gdal_tutorial.html



On 13 June 2017 at 14:19, Paul Meems <bontepaarden at gmail.com> wrote:

> Thanks Damian for your hint.
> I'll try in a minute without the formula.
> You mention process the pixels in a block. How would I do that? Do you
> have an example?
>
> Thanks,
>
> Paul
>
> 2017-06-13 15:05 GMT+02:00 Damian Dixon <damian.dixon at gmail.com>:
>
>> Hi Paul,
>>
>> What is the time to run your code without applying the calculation to
>> each pixel?
>>
>> It is usually better to process the pixels in a block rather than walking
>> across each row especially if you are processing a TIFF as these are
>> usually stored as tiles (blocks).
>>
>> The crossing from C# to C++ will also impact the performance so take a
>> look at the time it takes to set the pixels. There may also be a method to
>> set a block of pixels.
>>
>> Sorry I can't help you more than some general advice and hints.
>>
>> Regards
>> Damian
>>
>>
>>
>> On 13 June 2017 at 12:20, Paul Meems <bontepaarden at gmail.com> wrote:
>>
>>> I'm using GDAL v2.1.3 with the SWIG bindings in my custom C# application.
>>>
>>> I've created a method to do some calculation of my raster file:
>>> public bool GdalCalculate(string input, string output, string formula,
>>> double? minValue = null)
>>> {
>>>     if (!File.Exists(input))
>>>         throw new FileNotFoundException("Can't find the input file", new
>>> Exception("Working with " + input));
>>>
>>>     // 1. First copy the input file to create the output file
>>>     try
>>>     {
>>>         /* --------------------------------------------------------------------
>>> */
>>>         /*      Get driver
>>>        */
>>>         /* --------------------------------------------------------------------
>>> */
>>>         using (var drv = Gdal.GetDriverByName("GTiff"))
>>>         {
>>>             if (drv == null)
>>>             {
>>>                 throw new Exception("Can't get GTiff driver");
>>>             }
>>>
>>>             /* ------------------------------
>>> -------------------------------------- */
>>>             /*      Open dataset.
>>>             */
>>>             /* ------------------------------
>>> -------------------------------------- */
>>>             using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
>>>             {
>>>                 if (ds == null)
>>>                 {
>>>                     throw new Exception("Can't open GDAL dataset: " +
>>> input);
>>>                 }
>>>
>>>                 var options = new[] { "" };
>>>                 using (var newDataset = drv.CreateCopy(output, ds, 0,
>>> options, null, "Sample Data"))
>>>                 {
>>>                     if (newDataset == null)
>>>                     {
>>>                         throw new Exception("Can't create destination
>>> dataset: " + output);
>>>                     }
>>>
>>>                     // Close input dataset:
>>>                     ds.Dispose();
>>>
>>>                     // 2. Loop through all pixels and perform formula on
>>> it:
>>>                     using (var band = newDataset.GetRasterBand(1))
>>>                     {
>>>                         double noData;
>>>                         int hasValue;
>>>                         band.GetNoDataValue(out noData, out hasValue);
>>>                         var sizeX = band.XSize;
>>>                         var numLines = band.YSize;
>>>                         var func = new Function("f(A) = " + formula);
>>>
>>>                         // Loop through each line in turn.
>>>                         for (var line = 0; line < numLines; line++)
>>>                         {
>>>                             var scanline = new float[sizeX];
>>>                             // Read in data for the current line
>>>                             var cplReturn = band.ReadRaster(0, line,
>>> sizeX, 1, scanline, sizeX, 1, 0, 0);
>>>                             if (cplReturn != CPLErr.CE_None)
>>>                             {
>>>                                 throw new Exception("band.ReadRaster
>>> failed: " + Gdal.GetLastErrorMsg());
>>>                             }
>>>
>>>                             var outputLine = new List<float>();
>>>                             foreach (var f in scanline)
>>>                             {
>>>                                 var pixelValue = f;
>>>                                 if ((float)f != (float)noData)
>>>                                 {
>>>                                     // Calculate
>>>                                     pixelValue =
>>> (float)func.calculate(f);
>>>                                     if (minValue.HasValue)
>>>                                         pixelValue =
>>> (float)Math.Max(pixelValue, minValue.GetValueOrDefault());
>>>                                 }
>>>                                 outputLine.Add(pixelValue);
>>>                             }
>>>
>>>                             // Rewrite line:
>>>                             cplReturn = band.WriteRaster(0, line, sizeX,
>>> 1, outputLine.ToArray(), sizeX, 1, 0, 0);
>>>                             if (cplReturn != CPLErr.CE_None)
>>>                             {
>>>                                 throw new Exception("band.WriteRaster
>>> failed: " + Gdal.GetLastErrorMsg());
>>>                             }
>>>                         }
>>>
>>>                         // 3. Save changes to file:
>>>                         band.FlushCache();
>>>                         newDataset.FlushCache();
>>>                     }
>>>                 }
>>>             }
>>>         }
>>>     }
>>>     catch (Exception e)
>>>     {
>>>         throw new Exception("Can't open GDAL dataset: " + input, e);
>>>     }
>>>
>>>     return true;
>>> }
>>>
>>> This method is working fine, but is very slow.
>>> I'm using a 3621x4466 tiff file, which has a size of 67MB.
>>> It is taking around 10 minutes to process.
>>> (float)func.calculate(f); is using http://mathparser.org/
>>> An example of a function I'm using: 9.7E-05-e^(3.1 + 0.9 * A) where A
>>> is the pixel value.
>>>
>>> How can I optimize my function?
>>>
>>> Thanks,
>>>
>>> Paul
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/5f7fb741/attachment-0001.html>

From jan.heckman at gmail.com  Tue Jun 13 06:51:46 2017
From: jan.heckman at gmail.com (Jan Heckman)
Date: Tue, 13 Jun 2017 15:51:46 +0200
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
Message-ID: <CAKMUAtC4s48VNnj31tLfU3GaWHdu0c4+qphFQSs97Ho988WFjQ@mail.gmail.com>

Maybe it does not compile the formula but runs parser etc. as a kind of
interpreter at each function call.
Googled and saw http://beltoforion.de/article.php?a=muparsersse. Did not
try, so no recommendation, let alone guarantee ;)
You could check by defining a test function explicitly, if it is much
faster when compiled directly, that should be it, I guess.
Good luck,
Jan

On Tue, Jun 13, 2017 at 1:20 PM, Paul Meems <bontepaarden at gmail.com> wrote:

> I'm using GDAL v2.1.3 with the SWIG bindings in my custom C# application.
>
> I've created a method to do some calculation of my raster file:
> public bool GdalCalculate(string input, string output, string formula,
> double? minValue = null)
> {
>     if (!File.Exists(input))
>         throw new FileNotFoundException("Can't find the input file", new
> Exception("Working with " + input));
>
>     // 1. First copy the input file to create the output file
>     try
>     {
>         /* --------------------------------------------------------------------
> */
>         /*      Get driver
>      */
>         /* --------------------------------------------------------------------
> */
>         using (var drv = Gdal.GetDriverByName("GTiff"))
>         {
>             if (drv == null)
>             {
>                 throw new Exception("Can't get GTiff driver");
>             }
>
>             /* ------------------------------
> -------------------------------------- */
>             /*      Open dataset.
>           */
>             /* ------------------------------
> -------------------------------------- */
>             using (var ds = Gdal.Open(input, Access.GA_ReadOnly))
>             {
>                 if (ds == null)
>                 {
>                     throw new Exception("Can't open GDAL dataset: " +
> input);
>                 }
>
>                 var options = new[] { "" };
>                 using (var newDataset = drv.CreateCopy(output, ds, 0,
> options, null, "Sample Data"))
>                 {
>                     if (newDataset == null)
>                     {
>                         throw new Exception("Can't create destination
> dataset: " + output);
>                     }
>
>                     // Close input dataset:
>                     ds.Dispose();
>
>                     // 2. Loop through all pixels and perform formula on
> it:
>                     using (var band = newDataset.GetRasterBand(1))
>                     {
>                         double noData;
>                         int hasValue;
>                         band.GetNoDataValue(out noData, out hasValue);
>                         var sizeX = band.XSize;
>                         var numLines = band.YSize;
>                         var func = new Function("f(A) = " + formula);
>
>                         // Loop through each line in turn.
>                         for (var line = 0; line < numLines; line++)
>                         {
>                             var scanline = new float[sizeX];
>                             // Read in data for the current line
>                             var cplReturn = band.ReadRaster(0, line,
> sizeX, 1, scanline, sizeX, 1, 0, 0);
>                             if (cplReturn != CPLErr.CE_None)
>                             {
>                                 throw new Exception("band.ReadRaster
> failed: " + Gdal.GetLastErrorMsg());
>                             }
>
>                             var outputLine = new List<float>();
>                             foreach (var f in scanline)
>                             {
>                                 var pixelValue = f;
>                                 if ((float)f != (float)noData)
>                                 {
>                                     // Calculate
>                                     pixelValue = (float)func.calculate(f);
>                                     if (minValue.HasValue)
>                                         pixelValue =
> (float)Math.Max(pixelValue, minValue.GetValueOrDefault());
>                                 }
>                                 outputLine.Add(pixelValue);
>                             }
>
>                             // Rewrite line:
>                             cplReturn = band.WriteRaster(0, line, sizeX,
> 1, outputLine.ToArray(), sizeX, 1, 0, 0);
>                             if (cplReturn != CPLErr.CE_None)
>                             {
>                                 throw new Exception("band.WriteRaster
> failed: " + Gdal.GetLastErrorMsg());
>                             }
>                         }
>
>                         // 3. Save changes to file:
>                         band.FlushCache();
>                         newDataset.FlushCache();
>                     }
>                 }
>             }
>         }
>     }
>     catch (Exception e)
>     {
>         throw new Exception("Can't open GDAL dataset: " + input, e);
>     }
>
>     return true;
> }
>
> This method is working fine, but is very slow.
> I'm using a 3621x4466 tiff file, which has a size of 67MB.
> It is taking around 10 minutes to process.
> (float)func.calculate(f); is using http://mathparser.org/
> An example of a function I'm using: 9.7E-05-e^(3.1 + 0.9 * A) where A is
> the pixel value.
>
> How can I optimize my function?
>
> Thanks,
>
> Paul
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/d0949938/attachment.html>

From siebe at hydroconsult.nl  Tue Jun 13 07:05:32 2017
From: siebe at hydroconsult.nl (Siebe Bosch)
Date: Tue, 13 Jun 2017 16:05:32 +0200
Subject: [gdal-dev] Calling GDAL directly from within Python
Message-ID: <758910fe-8482-63f1-ba1f-8373990663b2@hydroconsult.nl>

Dear list,

Below you will find a question from my intern Bram. Unfortunately I could not help him out either since I only use the gdal executables.
We would highly appreciate your help calling GDAL functions from within Python.

Kind regards,
Siebe Bosch


Hi devs,

This is my first time using the Gdal library directly in Python using the Anaconda Spyder shell. I want to write a program that automatically imports GRIB files from a public ftp server and use GDAL to perform some actions. I installed GDAL with the PIP installer. Python version 2.7.13, Anaconda 32-bit, GDAL 3.0.8.
First off it worked well; GDAL opened the file and could read its information (as in raster size and coordinates (not taking the automatically importing from the server into account)). I did noticed the difference in commands (for example, gdal_Translate turns into gdal.Translate(src_ds, DestName, **kwargs)):

Import gdal
 From osgeo import osr
src_ds = gdal.Open('C:\Users\wijna_000\H11_V72_NED_SINGLE_LEVEL_00_000_GB')

raster_wkt = src_ds.GetProjection()
spatial_ref = osr.SpatialReference()
spatial_ref.ImportFromWkt(raster_wkt)
print spatial_ref.ExportToPrettyWkt()

 From here I want to transform the GRIB file into ,preferably ASCII files, but tried .tif first since it’s the default. But when I run the gdal.Translate command and do the coordinate check again it still returns as data imported from a grib-file:

tif_ds = gdal.Translate("C:\Users\wijna_000\output.tif", src_ds)

raster_wkt2 = tif_ds.GetProjection()
spatial_ref2 = osr.SpatialReference()
spatial_ref2.ImportFromWkt(raster_wkt2)
print spatial_ref2.ExportToPrettyWkt()

Return:
GEOGCS["Coordinate System imported from GRIB file", DATUM["unknown",SPHEROID["Sphere",6367470,0]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433]]

Help on internet is rare since its within the Python environment. Can anyone point me towards a better direction?

Regards, Bram


-- 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/87d7b20a/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature_60pct.gif
Type: image/gif
Size: 30165 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/87d7b20a/attachment-0001.gif>

From daniel.teske at web.de  Tue Jun 13 08:24:59 2017
From: daniel.teske at web.de (teeschke)
Date: Tue, 13 Jun 2017 08:24:59 -0700 (MST)
Subject: [gdal-dev] Way to increase global LRU cache of the /vsis3/ driver
Message-ID: <1497367499747-5324049.post@n6.nabble.com>

Dear GDAL Devs,

the vsis3 driver truly is a masterpiece of a driver!!
http://www.gdal.org/cpl__vsi_8h.html#a5b4754999acd06444bfda172ff2aaa16

I just wonder if there is any possibility to increase the global LRU cache
which has a fixed size of 16MB.

In my use-case I have time-related Gribfiles, stored on S3. The timestamp is
part of the filename. The front-end uses _tiles_ and has an _animation_
functionality. That ends up in lots of data accesses from Mapserver to S3
and I hope that increasing the global LRU cache to 2GB would be a
performance kick.

Thanks and best regards,
tee



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/Way-to-increase-global-LRU-cache-of-the-vsis3-driver-tp5324049.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Tue Jun 13 08:34:05 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 13 Jun 2017 17:34:05 +0200
Subject: [gdal-dev] Way to increase global LRU cache of the /vsis3/
	driver
In-Reply-To: <1497367499747-5324049.post@n6.nabble.com>
References: <1497367499747-5324049.post@n6.nabble.com>
Message-ID: <25380600.nr4q6OmpON@even-i700>

On mardi 13 juin 2017 08:24:59 CEST teeschke wrote:
> Dear GDAL Devs,
> 
> the vsis3 driver truly is a masterpiece of a driver!!
> http://www.gdal.org/cpl__vsi_8h.html#a5b4754999acd06444bfda172ff2aaa16
> 
> I just wonder if there is any possibility to increase the global LRU cache
> which has a fixed size of 16MB.
> 
> In my use-case I have time-related Gribfiles, stored on S3. The timestamp is
> part of the filename. The front-end uses _tiles_ and has an _animation_
> functionality. That ends up in lots of data accesses from Mapserver to S3
> and I hope that increasing the global LRU cache to 2GB would be a
> performance kick.

In

https://github.com/OSGeo/gdal/blob/trunk/gdal/port/cpl_vsil_curl.cpp#L101

replace
static const int N_MAX_REGIONS = 1000;
with
static const int N_MAX_REGIONS = 122070;

(122070 * 16384 ~= 2 GB)

and recompile

However the algorithm that handles cached region eviction/lookup might exhibit bad 
performance with such a big numbers since it is rather native right now, so I'd suggest you to 
test carefully. It should probably use a hashset rather than an array.

Ultimately I'd like that this setting to be user tunable, so might be worth that you file an 
enhancement ticket at https://trac.osgeo.org/gdal/newticket

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170613/bf0eb69a/attachment.html>

From kassies at gmail.com  Wed Jun 14 00:29:22 2017
From: kassies at gmail.com (Rutger)
Date: Wed, 14 Jun 2017 00:29:22 -0700 (MST)
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
 <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>
Message-ID: <1497425362696-5324120.post@n6.nabble.com>

Damian Dixon wrote
> It is usually better to process the pixels in a block rather than walking
> across each row especially if you are processing a TIFF as these are
> usually stored as tiles (blocks).

Other layouts are common as well. For example, the Landsat TIFF's provided
by the USGS have a row based-layout.  If you can choose it yourself, bocks
are prefered in my opinion, since GDAL VRT's have a fixed blocksize
of128*128. So when writing TIFF's, setting "TILED=YES" is a good default. 

I think your spot on by mentioning the blocks. Don't assume the layout at
all, look at the blocksize of the file and use it. If the blocks are
relatively small (memoy-wise), using a multiple of the size can increase
performance a bit more. So if its row-based and you have plenty of memory to
spare, why not read blocks of (xsize, 128). Or if the blocksize is 128x128,
use blocks of 256x256 etc.

If the volume of data is really large, increasing GDAL's block cache can be
helpful. Although its best to avoid relying on the cache (if possible) by
specifying an appropriate blocksize.

Here are a few mini-benchmarks:
http://nbviewer.jupyter.org/gist/RutgerK/4faa43873ee6389873dd4de85de7c450

https://stackoverflow.com/questions/41742162/gdal-readasarray-for-vrt-extremely-slow/41853759#41853759

Regards,
Rutger




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Raster-calculation-optimalisation-tp5324014p5324120.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From kassies at gmail.com  Wed Jun 14 06:36:24 2017
From: kassies at gmail.com (Rutger)
Date: Wed, 14 Jun 2017 06:36:24 -0700 (MST)
Subject: [gdal-dev] Calling GDAL directly from within Python
In-Reply-To: <758910fe-8482-63f1-ba1f-8373990663b2@hydroconsult.nl>
References: <758910fe-8482-63f1-ba1f-8373990663b2@hydroconsult.nl>
Message-ID: <1497447384748-5324191.post@n6.nabble.com>

Hey,

To start with a side note, your GDAL version of 3.0.8 doesn't make much
sense. The utilities from the bindings are available since 2.1 if I'm
correct, and the latest release is 2.2. Doesn't matter though. 

The text about "GRIB" you are seeing is only the name of the coordinate
system, 'gdal.Translate' simply copies this projection to the TIFF file. Its
a bit confusing indeed. The name probably comes from GDAL's GRIB driver, or
some library it uses. 

Your call to gdal.Translate appears to work fine, although its always good
to check if the projection, extent etc are correct. And preferably also find
some documentation from the data provider to confirm. 


Regards,
Rutger





--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Calling-GDAL-directly-from-within-Python-tp5324036p5324191.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From mathieu.lattes at yahoo.fr  Wed Jun 14 09:43:56 2017
From: mathieu.lattes at yahoo.fr (M. LATTES)
Date: Wed, 14 Jun 2017 16:43:56 +0000 (UTC)
Subject: [gdal-dev] gdalmanage enhancement proposal
References: <2124450221.2330028.1497458636953.ref@mail.yahoo.com>
Message-ID: <2124450221.2330028.1497458636953@mail.yahoo.com>


Hi everybody,
Using GDAL I've made an utility program to rename raster datasets using theire SRS coordinates.I made it to rename datasets downloaded from different sources, so they have a consistent naming pattern or to update the name after a SRS change with gdalwarp. 

There is the possibility to choose a prefix, a suffix, a corner (W/N by default) of the bounding box of the dataset as reference point.It's also possible to specify a separator for coordinates values, the numeric format of coordinates (integer, double), the number of digits and the format of the sign (wheter or not using +/- , or N/S and E/W).There is also an option to output the rename shell commands in the console, instead of performing it (Usefull to generate batch rename shell commands). 

If the community think it can be helpfull, I can try to enhance the gdalmanage utility to add these options to it...

You can take a look at the original application here ​https://github.com/MattLatt/gdal_rename
Best regards. 

Mathieu Lattes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170614/59420882/attachment.html>

From hellik at web.de  Wed Jun 14 12:16:06 2017
From: hellik at web.de (Helmut Kudrnovsky)
Date: Wed, 14 Jun 2017 12:16:06 -0700 (MST)
Subject: [gdal-dev] gdal_translate via wmts.xml produces an empty tif
Message-ID: <1497467766746-5324225.post@n6.nabble.com>

hi,

following the example in [1] with the WMTS GetCapabilities of [2], I do:

gdal_translate
"WMTS:https://www.basemap.at/wmts/1.0.0/WMTSCapabilities.xml,layer=bmaporthofoto30cm"
wmts_bm.xml -of WMTS

gives this file:  wmts_bm.xml
<http://osgeo-org.1560.x6.nabble.com/file/n5324225/wmts_bm.xml>  

then gdalinfo of wmts_bm.xml shows:

gdalinfo wmts_bm.xml
Driver: WMTS/OGC Web Mab Tile Service
Files: wmts_bm.xml
Size is 6268828, 2969099
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
+no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (977649.895640023052692,6281289.982633858919144)
Pixel Size = (0.149291070871600,-0.149291070871600)
Metadata:
  ABSTRACT=Basemap als farbiges Orthofoto
  TITLE=Geoland Basemap Orthofoto
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  977649.896, 6281289.983) (  8d46'56.56"E, 49d 2'16.34"N)
Lower Left  (  977649.896, 5838030.013) (  8d46'56.56"E, 46d21'31.57"N)
Upper Right ( 1913529.941, 6281289.983) ( 17d11'22.31"E, 49d 2'16.34"N)
Lower Right ( 1913529.941, 5838030.013) ( 17d11'22.31"E, 46d21'31.57"N)
Center      ( 1445589.918, 6059659.998) ( 12d59' 9.44"E, 47d42'55.93"N)
Band 1 Block=128x128 Type=Byte, ColorInterp=Red
  Overviews: 3134414x1484550, 1567207x742275, 783604x371137, 391802x185569,
195901x92784, 97950x46392, 48975x23196, 24488x11598, 12244x5799, 6122x2900,
3061x1450, 1530x725, 765x362, 383x181
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 3134414x1484550, 1567207x742275, 783604x371137,
391802x185569, 195901x92784, 97950x46392, 48975x23196, 24488x11598,
12244x5799, 6122x2900, 3061x1450, 1530x725, 765x362, 383x181
Band 2 Block=128x128 Type=Byte, ColorInterp=Green
  Overviews: 3134414x1484550, 1567207x742275, 783604x371137, 391802x185569,
195901x92784, 97950x46392, 48975x23196, 24488x11598, 12244x5799, 6122x2900,
3061x1450, 1530x725, 765x362, 383x181
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 3134414x1484550, 1567207x742275, 783604x371137,
391802x185569, 195901x92784, 97950x46392, 48975x23196, 24488x11598,
12244x5799, 6122x2900, 3061x1450, 1530x725, 765x362, 383x181
Band 3 Block=128x128 Type=Byte, ColorInterp=Blue
  Overviews: 3134414x1484550, 1567207x742275, 783604x371137, 391802x185569,
195901x92784, 97950x46392, 48975x23196, 24488x11598, 12244x5799, 6122x2900,
3061x1450, 1530x725, 765x362, 383x181
  Mask Flags: PER_DATASET ALPHA
  Overviews of mask band: 3134414x1484550, 1567207x742275, 783604x371137,
391802x185569, 195901x92784, 97950x46392, 48975x23196, 24488x11598,
12244x5799, 6122x2900, 3061x1450, 1530x725, 765x362, 383x181
Band 4 Block=128x128 Type=Byte, ColorInterp=Alpha
  Overviews: 3134414x1484550, 1567207x742275, 783604x371137, 391802x185569,
195901x92784, 97950x46392, 48975x23196, 24488x11598, 12244x5799, 6122x2900,
3061x1450, 1530x725, 765x362, 383x181

when I try to get some smaller area of this WMTS by gdal_translating this 
wmts_bm2.xml
<http://osgeo-org.1560.x6.nabble.com/file/n5324225/wmts_bm2.xml>  :

gdal_translate wmts_bm2.xml test.tif
Input file size is 3363, 3363
0...10...20...30...40...50...60...70...80...90...100 - done.

the result is an empty tif:

D:\basemap_orthos\2017\inn>gdalinfo test.tif -mm
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 3363, 3363
Coordinate System is:
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["X",EAST],
    AXIS["Y",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
+lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext
+no_defs"],
    AUTHORITY["EPSG","3857"]]
Origin = (1168011.985145896673203,5932420.039413984864950)
Pixel Size = (0.149291070871600,-0.149291070871600)
Metadata:
  ABSTRACT=Basemap als farbiges Orthofoto
  AREA_OR_POINT=Area
  TITLE=Geoland Basemap Orthofoto
Image Structure Metadata:
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  ( 1168011.985, 5932420.039) ( 10d29'32.75"E, 46d56'26.96"N)
Lower Left  ( 1168011.985, 5931917.974) ( 10d29'32.75"E, 46d56'15.87"N)
Upper Right ( 1168514.051, 5932420.039) ( 10d29'48.99"E, 46d56'26.96"N)
Lower Right ( 1168514.051, 5931917.974) ( 10d29'48.99"E, 46d56'15.87"N)
Center      ( 1168263.018, 5932169.006) ( 10d29'40.87"E, 46d56'21.42"N)
Band 1 Block=3363x1 Type=Byte, ColorInterp=Red
    Computed Min/Max=0.000,0.000
  Mask Flags: PER_DATASET ALPHA
Band 2 Block=3363x1 Type=Byte, ColorInterp=Green
    Computed Min/Max=0.000,0.000
  Mask Flags: PER_DATASET ALPHA
Band 3 Block=3363x1 Type=Byte, ColorInterp=Blue
    Computed Min/Max=0.000,0.000
  Mask Flags: PER_DATASET ALPHA
Band 4 Block=3363x1 Type=Byte, ColorInterp=Alpha
    Computed Min/Max=0.000,0.000

displaying this WMTS in QGIS with
https://www.basemap.at/wmts/1.0.0/WMTSCapabilities.xml works. the layers are
all displayed.

any hint to solve this?

[1] http://www.gdal.org/frmt_wmts.html
[2] https://www.basemap.at/






-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-via-wmts-xml-produces-an-empty-tif-tp5324225.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun 14 12:39:21 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 14 Jun 2017 21:39:21 +0200
Subject: [gdal-dev] gdal_translate via wmts.xml produces an empty tif
In-Reply-To: <1497467766746-5324225.post@n6.nabble.com>
References: <1497467766746-5324225.post@n6.nabble.com>
Message-ID: <1797601.tvHqFnJ6qJ@even-i700>

On mercredi 14 juin 2017 12:16:06 CEST Helmut Kudrnovsky wrote:
> http://osgeo-org.1560.x6.nabble.com/file/n5324225/wmts_bm2.xml


Add   <TileMatrix>19</TileMatrix>

It appears that there are not tiles at zoom level 20, at least in this area.

If you add --debug on to the gdal_translate, you'll see:

HTTP: Request [13] https://maps1.wien.gv.at/basemap/bmaporthofoto30cm/normal/
google3857/20/369064/554862.jpeg : status = 404, content type = text/html; 
charset=iso-8859-1, error = <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>404 Not Found</title>
</head><body>
<h1>Not Found</h1>
<p>The requested URL /basemap/bmaporthofoto30cm/normal/
google3857/20/369064/554862.jpeg was not found on this server.</p>
<hr>
<address>Apache Server at maps1.wien.gv.at Port 80</address>
</body></html>

The reason the error is silent is because of the
<ZeroBlockHttpCodes>204,404</ZeroBlockHttpCodes>

If you remove that, then gdal_translate would have failed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170614/da35862c/attachment.html>

From issam1975 at live.fr  Wed Jun 14 15:26:42 2017
From: issam1975 at live.fr (issam boughanmi)
Date: Wed, 14 Jun 2017 22:26:42 +0000
Subject: [gdal-dev] gdal_translate with srcwin and center reference point
Message-ID: <DB6P194MB0133B7FDE85FE36EE781CA75B9C30@DB6P194MB0133.EURP194.PROD.OUTLOOK.COM>

hi,

i want to use subset a large raster image using gdal_translate with srcwin parameter

but i want also to give some reference point to be at the center of the output file .


so if the output file size is 2000X2000 pixel   for exemple, i want that my given point(lat/lon) to be at the center


any idea on how this can be achieved is welcome .


thanks .
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170614/2a0b4968/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Jun 15 00:35:57 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 15 Jun 2017 00:35:57 -0700 (MST)
Subject: [gdal-dev] gdal_translate with srcwin and center reference point
In-Reply-To: <DB6P194MB0133B7FDE85FE36EE781CA75B9C30@DB6P194MB0133.EURP194.PROD.OUTLOOK.COM>
References: <DB6P194MB0133B7FDE85FE36EE781CA75B9C30@DB6P194MB0133.EURP194.PROD.OUTLOOK.COM>
Message-ID: <1497512157323-5324298.post@n6.nabble.com>

issam boughanmi wrote
> hi,
> i want to use subset a large raster image using gdal_translate with srcwin
> parameter
> 
> but i want also to give some reference point to be at the center of the
> output file .
> 
> so if the output file size is 2000X2000 pixel   for exemple, i want that
> my given point(lat/lon) to be at the center
> 
> any idea on how this can be achieved is welcome .

Hi,

Instead of -srcwin use -projwin and with very little scripting you can
construct the ulx, uly, lrx, lry values from the coordinates of the given
centre point.

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-translate-with-srcwin-and-center-reference-point-tp5324260p5324298.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From hellik at web.de  Thu Jun 15 01:08:33 2017
From: hellik at web.de (Helmut Kudrnovsky)
Date: Thu, 15 Jun 2017 01:08:33 -0700 (MST)
Subject: [gdal-dev] gdal_translate via wmts.xml produces an empty tif
In-Reply-To: <1797601.tvHqFnJ6qJ@even-i700>
References: <1497467766746-5324225.post@n6.nabble.com>
 <1797601.tvHqFnJ6qJ@even-i700>
Message-ID: <1497514113583-5324302.post@n6.nabble.com>

Even Rouault-2 wrote
> On mercredi 14 juin 2017 12:16:06 CEST Helmut Kudrnovsky wrote:
>> http://osgeo-org.1560.x6.nabble.com/file/n5324225/wmts_bm2.xml
> 
> 
> Add   
> <TileMatrix>
> 19
> </TileMatrix>
> It appears that there are not tiles at zoom level 20, at least in this
> area.

thanks for the hint, it works now.




-----
best regards
Helmut
--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-translate-via-wmts-xml-produces-an-empty-tif-tp5324225p5324302.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Thu Jun 15 05:23:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 15 Jun 2017 14:23:41 +0200
Subject: [gdal-dev] Next GDAL bugfix releases
Message-ID: <11435747.ge24HpEadM@even-i700>

Hi,

I'll probably cut release candidates for a 2.2.1 and 2.1.4 end of 
next week, unless someone needs more time to push something.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170615/58f03465/attachment-0001.html>

From bontepaarden at gmail.com  Thu Jun 15 06:04:10 2017
From: bontepaarden at gmail.com (Paul Meems)
Date: Thu, 15 Jun 2017 15:04:10 +0200
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <1497425362696-5324120.post@n6.nabble.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
 <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>
 <1497425362696-5324120.post@n6.nabble.com>
Message-ID: <CAHNf2YTXohonHtPxw0_=CY71xsZL+4JCb_UQShoLMMp42R7=Pg@mail.gmail.com>

Thanks all for your suggestions.

@Rutger and @Damian:
Thanks for your suggestion about the blocks.
I had a look at Rutger's links,
I create the input file myself so I can add 'TILES=YES' but I'm not sure
how to change my calculation code.
I see in this first link xbs, ybs = b1.GetBlockSize() But I don't see when
to use the xbs or ybs variables.
I assume I need to change the reading of the data: band.ReadRaster(0, line,
sizeX, 1, scanline, sizeX, 1, 0, 0); but I'm not sure how.
And how should I write back the block?

BTW. The main bottle-neck seems to be in the used formula parser.
With the formula it takes 68s, without the formule - just setting the
pixelvalue takes 3.3s and with the formula written in code pixelValue =
(float)Math.Exp(3.1 + 0.9 * f); it only takes 3.4s.
So not using mathparser has the highest benefits. I will do that first, but
I also want to understand the block reading and writing.

@Jan, thanks for your link to the other parser. I had a quick look and it
looks very promising. Sadly I couldn't get their C# example working.
I will look at as well.

Just a more general question.
Doesn't it makes sense if gdal would provide a gdal_calculate tool which
also is librified like VectorTranslate?
It seems lots of people are implementing it on their own.

Thanks,

Paul


2017-06-14 9:29 GMT+02:00 Rutger <kassies at gmail.com>:

> Damian Dixon wrote
> > It is usually better to process the pixels in a block rather than walking
> > across each row especially if you are processing a TIFF as these are
> > usually stored as tiles (blocks).
>
> Other layouts are common as well. For example, the Landsat TIFF's provided
> by the USGS have a row based-layout.  If you can choose it yourself, bocks
> are prefered in my opinion, since GDAL VRT's have a fixed blocksize
> of128*128. So when writing TIFF's, setting "TILED=YES" is a good default.
>
> I think your spot on by mentioning the blocks. Don't assume the layout at
> all, look at the blocksize of the file and use it. If the blocks are
> relatively small (memoy-wise), using a multiple of the size can increase
> performance a bit more. So if its row-based and you have plenty of memory
> to
> spare, why not read blocks of (xsize, 128). Or if the blocksize is 128x128,
> use blocks of 256x256 etc.
>
> If the volume of data is really large, increasing GDAL's block cache can be
> helpful. Although its best to avoid relying on the cache (if possible) by
> specifying an appropriate blocksize.
>
> Here are a few mini-benchmarks:
> http://nbviewer.jupyter.org/gist/RutgerK/4faa43873ee6389873dd4de85de7c450
>
> https://stackoverflow.com/questions/41742162/gdal-
> readasarray-for-vrt-extremely-slow/41853759#41853759
>
> Regards,
> Rutger
>
>
>
>
> --
> View this message in context: http://osgeo-org.1560.x6.
> nabble.com/gdal-dev-Raster-calculation-optimalisation-
> tp5324014p5324120.html
> Sent from the GDAL - Dev mailing list archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170615/a622049b/attachment.html>

From damian.dixon at gmail.com  Thu Jun 15 08:22:57 2017
From: damian.dixon at gmail.com (Damian Dixon)
Date: Thu, 15 Jun 2017 16:22:57 +0100
Subject: [gdal-dev] Raster calculation optimalisation
In-Reply-To: <CAHNf2YTXohonHtPxw0_=CY71xsZL+4JCb_UQShoLMMp42R7=Pg@mail.gmail.com>
References: <CAHNf2YTZhsYu0kxsNSU7Pki61vrKMQTGoqSMnscx_7h_BJ7rWw@mail.gmail.com>
 <CAJjdW1x6kHKnyDxC1wd_ysP2hPuqnoa6HpegPscuozrve==A+g@mail.gmail.com>
 <1497425362696-5324120.post@n6.nabble.com>
 <CAHNf2YTXohonHtPxw0_=CY71xsZL+4JCb_UQShoLMMp42R7=Pg@mail.gmail.com>
Message-ID: <CAJjdW1zfoQpj8PrAWiwFi3v8VYX61+szeLuO=4SP7itzH8H5Gg@mail.gmail.com>

Personally I would agree with your approach at looking at the cost of
running the
formula first.


However if you do change your code to read/write blocks than there are
additional
opportunities for speeding the processing up.

Once you have the block size reading working consider using multiple
threads.
You will need to use a GDALDataset for each thread.

You will however need to consider how you write the results out again
as you will not be able to write to a single output. You will have to write
to
a separate raster for each thread.

This is the approach I have taken.

I can't help you with writing the block back as once I've got the raster
data I
processes it into a format that allows me to load and display the data a lot
quicker than going back to GDAL for the data.

You need to find the equivalent to:

http://www.gdal.org/classGDALRasterBand.html#a30786c81246455321e96d73047b8edf1
Also these may help...

http://www.gdal.org/classGDALRasterBand.html#ad80cecc562fd48f5783677de625360ac

http://www.gdal.org/classGDALRasterBand.html#a457ae6645dd2680289734aed0afce357



On 15 June 2017 at 14:04, Paul Meems <bontepaarden at gmail.com> wrote:

> Thanks all for your suggestions.
>
> @Rutger and @Damian:
> Thanks for your suggestion about the blocks.
> I had a look at Rutger's links,
> I create the input file myself so I can add 'TILES=YES' but I'm not sure
> how to change my calculation code.
> I see in this first link xbs, ybs = b1.GetBlockSize() But I don't see
> when to use the xbs or ybs variables.
> I assume I need to change the reading of the data: band.ReadRaster(0,
> line, sizeX, 1, scanline, sizeX, 1, 0, 0); but I'm not sure how.
> And how should I write back the block?
>
> BTW. The main bottle-neck seems to be in the used formula parser.
> With the formula it takes 68s, without the formule - just setting the
> pixelvalue takes 3.3s and with the formula written in code pixelValue =
> (float)Math.Exp(3.1 + 0.9 * f); it only takes 3.4s.
> So not using mathparser has the highest benefits. I will do that first,
> but I also want to understand the block reading and writing.
>
> @Jan, thanks for your link to the other parser. I had a quick look and it
> looks very promising. Sadly I couldn't get their C# example working.
> I will look at as well.
>
> Just a more general question.
> Doesn't it makes sense if gdal would provide a gdal_calculate tool which
> also is librified like VectorTranslate?
> It seems lots of people are implementing it on their own.
>
> Thanks,
>
> Paul
>
>
> 2017-06-14 9:29 GMT+02:00 Rutger <kassies at gmail.com>:
>
>> Damian Dixon wrote
>> > It is usually better to process the pixels in a block rather than
>> walking
>> > across each row especially if you are processing a TIFF as these are
>> > usually stored as tiles (blocks).
>>
>> Other layouts are common as well. For example, the Landsat TIFF's provided
>> by the USGS have a row based-layout.  If you can choose it yourself, bocks
>> are prefered in my opinion, since GDAL VRT's have a fixed blocksize
>> of128*128. So when writing TIFF's, setting "TILED=YES" is a good default.
>>
>> I think your spot on by mentioning the blocks. Don't assume the layout at
>> all, look at the blocksize of the file and use it. If the blocks are
>> relatively small (memoy-wise), using a multiple of the size can increase
>> performance a bit more. So if its row-based and you have plenty of memory
>> to
>> spare, why not read blocks of (xsize, 128). Or if the blocksize is
>> 128x128,
>> use blocks of 256x256 etc.
>>
>> If the volume of data is really large, increasing GDAL's block cache can
>> be
>> helpful. Although its best to avoid relying on the cache (if possible) by
>> specifying an appropriate blocksize.
>>
>> Here are a few mini-benchmarks:
>> http://nbviewer.jupyter.org/gist/RutgerK/4faa43873ee6389873dd4de85de7c450
>>
>> https://stackoverflow.com/questions/41742162/gdal-readasarra
>> y-for-vrt-extremely-slow/41853759#41853759
>>
>> Regards,
>> Rutger
>>
>>
>>
>>
>> --
>> View this message in context: http://osgeo-org.1560.x6.nabbl
>> e.com/gdal-dev-Raster-calculation-optimalisation-tp5324014p5324120.html
>> Sent from the GDAL - Dev mailing list archive at Nabble.com.
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170615/9b016d87/attachment.html>

From even.rouault at spatialys.com  Thu Jun 15 12:56:24 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 15 Jun 2017 21:56:24 +0200
Subject: [gdal-dev] [FIXED] Re:  OpenJPEG lossless encode broken
In-Reply-To: <CAK8GPyDkvm+RTD4r170w_EFos07oQV0OYTu+t_-t0mmbGmrfdQ@mail.gmail.com>
References: <CAK8GPyDkvm+RTD4r170w_EFos07oQV0OYTu+t_-t0mmbGmrfdQ@mail.gmail.com>
Message-ID: <93601511.mpVDdHagf6@even-i700>

On vendredi 17 février 2017 14:02:37 CEST Aaron Boxer wrote:
> See https://github.com/uclouvain/openjpeg/issues/892 for further details.
> 
> Since problems occur unpredictably for various image dimensions and number
> of encoder decompositions, safest approach is to avoid using the codec for
> lossless until this issue is resolved.

FYI, this issue has been fixed in OpenJPEG master,  as well as with speed 
improvements. A new release will come in the following weeks.

For more details, see
 https://groups.google.com/forum/#!topic/openjpeg/2lgzhnoRTYA

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170615/d14838e5/attachment.html>

From ruslan.sivak at reis.com  Thu Jun 15 15:09:48 2017
From: ruslan.sivak at reis.com (Russ Sivak)
Date: Thu, 15 Jun 2017 18:09:48 -0400
Subject: [gdal-dev] MSSQLSpatial Driver fails to bulk insert (n)varchar
	columns
Message-ID: <9d7b5023-bb55-1806-18d5-eddce3a6b7a5@reis.com>

We are trying to use ogr2ogr to load shapefiles into SQL Server. It 
works when we are not using bulk copy, but once we use a windows build 
with bulk copy, it's super fast, but inserts garbage characters into the 
varchar/nvarchar fields.  The numeric and geometry fields seem to be fine.

We are using the latest stable build from here:

http://gisinternals.com/release.php

We tried SQL Server 2014, 2016 and 2017 and none work.

This is what I'm using to load a test shape file into SQL 2014

ogr2ogr -f "MSSQLSpatial" 
"MSSQL:SERVER=localhost\SQL2014;DATABASE=test;DRIVER={SQL Server Native 
Client 11.0};trusted_connection=yes" C:\russ\cb_2016_us_county_500k -nln 
test -progress -overwrite
ERROR 4: Unable to open EPSG support file gcs.csv.
Try setting the GDAL_DATA environment variable to point to the directory 
containing EPSG csv files.
ERROR 6: No translation for an empty SRS to PROJ.4 format is known.
0...10...20...30...40...50...60...70...80...90...100 - done.


Also the error about GDAL_DATA persists even after setting

GDAL_DATA="C:\Program Files\GDAL\gdal-data"

The nvarchar fields seem to contain one junk character (which is 
different every time you run the load).  Also all the fields have the 
same character (at least for this shape file).  For the last run every 
single nvarchar field is 'v'

Here is a sample row.

ogr_fid    ogr_geometry    statefp    countyfp    countyns affgeoid 
geoid    name    lsad    aland    awater
1 
0x0000000001043F00000064C746205E1A57C000DF6DDE38C14440EC1681B1BE1657C0C34483143CC14440F92EA52E191657C0FE428F183DC14440663046240A1357C0F6E978CC40C144402FBDFDB9681257C0E44A3D0B42C1444040A374E95F0E57C04E999B6F44C14440CB811E6ADB0C57C058AB764D48C14440E8BB5B59A20B57C0CFDBD8EC48C1444062F54718060A57C0D8EDB3CA4CC1444039419B1C3E0557C0FA27B85851C1444011548D5E0D0557C0AC8A709351C14440CC069964E40457C05930F14751C14440F6CE68AB920457C0D5E940D653C14440F69507E9290457C0E063B0E254C144406C0377A04E0357C08CD5E6FF55C1444030F0DC7BB80257C033BE2F2E55C144404B749659840257C0B398D87C5CC14440802A6EDC620257C02C99637957C144400567F0F78BFC56C07BBB253960C144409F53909F8DFC56C033BF9A0304BB444028D53E1D8FFC56C05ED4EE5701BA4440307F85CC95FC56C084622B685AB6444055D7A19A92FC56C0A19E3E027FB4444013807F4A95FC56C08F32E202D0B044402A8E03AF96FC56C027F911BF62AF4440AD6C1FF296FC56C063096B63ECAE4440D05CA79196FC56C037A79201A0AE4440B229577897FC56C07D21E4BCFFAD44402F17F19D98FC56C00FD253E410AD4440041C42959AFC56C04FE449D235AB44409C2FF65E7CFC56C00C569C6A2DA044403A2009FB76FC56C0C556D0B4C49E4440FF0758AB76FC56C03F1878EE3D9E44407C5D86FF74FC56C0BDE13E726B9C4440F2423A3C84FC56C02C2CB81FF0944440368FC360FEFC56C09B374E0AF3944440DAAB8F87BEFD56C04C327216F69444408FE21C75740157C0C1A90F24EF944440342A70B20D0457C0A3737E8AE39444405708ABB1840B57C0A626C11BD29444406B7D91D0960E57C08AA9F413CE944440A833F790F01257C077853E58C6944440F6949C137B1457C0300DC347C494444026C5C727641557C002F1BA7EC19444405C52B5DD041A57C05F402FDCB99444405BAFE941411A57C0A6ECF483BA944440253ACB2C421A57C09291B3B0A795444086C43D963E1A57C0AE0B3F389F964440378B170B431A57C0F3B0506B9A9744407E37DDB2431A57C0F677B6476F98444090A2CEDC431A57C059349D9D0C9A4440F3FFAA23471A57C0630B410E4A9A44402A8F6E84451A57C079CC4065FC9F4440ECC039234A1A57C013984EEB36A24440FD1186014B1A57C067B62BF4C1A24440F14927124C1A57C0B854A52DAEA344408FA50F5D501A57C04AB3791C06AB44403526C45C521A57C0BD378600E0AC44408E3D7B2E531A57C0BD361B2B31AF444009C38025571A57C0C804FC1A49B444405BE9B5D9581A57C02BA391CF2BB644402F6CCD565E1A57C064AE0CAA0DBE444064C746205E1A57C000DF6DDE38C1444001000000020000000001000000FFFFFFFF0000000003 
v    v    v    v    v    v    v    1500067253    1929323


The file I'm currently trying to load is 
http://www2.census.gov/geo/tiger/GENZ2016/shp/cb_2016_us_county_500k.zip 
(unzipped obviously), but it fails with every shapefile I've tried.

Disclaimer

The information contained in this communication from the sender is confidential. It is intended solely for use by the recipient and others authorized to receive it. If you are not the recipient, you are hereby notified that any disclosure, copying, distribution or taking action in relation of the contents of this information is strictly prohibited and may be unlawful.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170615/f637056a/attachment.html>

From tbma-1 at yandex.ru  Fri Jun 16 02:16:19 2017
From: tbma-1 at yandex.ru (AndrewB)
Date: Fri, 16 Jun 2017 02:16:19 -0700 (MST)
Subject: [gdal-dev] csharp/gdal/fwtools. Problem with migrating from window
 to ubuntu/mono
Message-ID: <1497604579985-5324458.post@n6.nabble.com>

I'm novice in csharp but i need to migrate csharp project from windows to
linux(ubuntu)/mono and have problem with this.
I'm using FWTools in C# project under Windows(code below):
including in project 2 dlls and FWTools/Bin in $PATH:
ogr_csharp.dll
osr_csharp.dll

CODE:
using OSGeo.OGR;
using OSGeo.OSR;

private void GenerateMif( ...params... )
{
     Ogr.RegisterAll();
     using (var driver = Ogr.GetDriverByName("MapInfo File") )
            using (var dataSource = driver.CreateDataSource(mifOutputPath,
null) )
            {		
                SpatialReference spatial =
GetSpatialByProjection(projection);
                var layer = dataSource.CreateLayer("layer1", spatial,
wkbGeometryType.wkbUnknown, null);
                CreateLayerFields(result, layer, fieldDefinitionParameters);


and its works.
 

Now i want migrate this functionality to mono/Ubuntu.  
I'm building project in Xamarin Studio from Windows under Mono/.NET platform 

Ogr.RegisterAll();  handles exception in Ubuntu:

The type initializer for 'OSGeo.OGR.Ogr' threw an exception.
The type initializer for 'OSGeo.OGR.OgrPINVOKE' threw an exception.
  at OSGeo.OGR.Ogr..cctor () [0x0000a] in
<beb44ad5c34649f88fca9cbfa4f938ac>:0 
  at ExportPerformer.GenerateMif (
Adding FWTools/Bin into PATH didnt help.

Then
I've downloaded and compiled the source for gdal in GNU/Linux. 
I've compiled the swig/csharp bindings. 

Include compiled
gdal_csharp.dll,gdalconst_csharp.dll,ogr_csharp.dll,osr_csharp.dll to
Xamarin Studio in Windows, build project under Mono/.NET platform,
run "mono project.exe" from ubuntu and Ogr.RegisterAll(); same
DllNotFoundException error:
System.TypeInitializationException: The type initializer for 'OSGeo.OGR.Ogr'
threw an exception. 
---> System.TypeInitializationException: The type initializer for
'OSGeo.OGR.OgrPINVOKE' threw an exception. 
---> System.TypeInitializationException: The type initializer for
'SWIGExceptionHelper' threw an exception. 
---> System.DllNotFoundException: ogrcsharp
  at (wrapper managed-to-native)
OSGeo.OGR.OgrPINVOKE+SWIGExceptionHelper:SWIGRegisterExceptionCallbacks_Ogr 
(OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate,
OSGeo.OGR.OgrPINVOKE/SWIGExceptionHelper/ExceptionDelegate)
  at OSGeo.OGR.OgrPINVOKE+SWIGExceptionHelper..cctor () [0x000ef] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---
  at (wrapper managed-to-native)
System.Object:__icall_wrapper_mono_generic_class_init (intptr)
  at OSGeo.OGR.OgrPINVOKE..cctor () [0x00000] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---
  at OSGeo.OGR.Ogr..cctor () [0x0000a] in
<f65c599d29ac40c4b98fd48137f45269>:0    
--- End of inner exception stack trace ---

What's wrong with that build?


Does that way to migrating from Windows to Linux will works? 
What way(csharp) to migrate this case will be correct?

Thanks.

List of files after compiling swig/csharp under linux
<http://osgeo-org.1560.x6.nabble.com/file/n5324458/gdalbuild.png> 



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/csharp-gdal-fwtools-Problem-with-migrating-from-window-to-ubuntu-mono-tp5324458.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From schwehr at gmail.com  Fri Jun 16 05:40:53 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 16 Jun 2017 05:40:53 -0700
Subject: [gdal-dev] r 39092: vsigzip filesize check
Message-ID: <CACmBxytcmy_XRAedisO2BZejZLZhmABwLi2P1H3FfkPqBe=T_Q@mail.gmail.com>

Even,

With https://trac.osgeo.org/gdal/changeset/39092, can you explain the this
check?

    uncompressed_pos - startOff > m_compressed_size

That looks to be comparing the number of bytes compressed vrs
uncompressed.  How is this checking that the filesize changed?  Something
seems wrong or there needs to be a comment somewhere because this doesn't
seem correct.

Thanks,
-kurt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170616/b560c0f7/attachment.html>

From even.rouault at spatialys.com  Fri Jun 16 05:53:34 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 16 Jun 2017 14:53:34 +0200
Subject: [gdal-dev] r 39092: vsigzip filesize check
In-Reply-To: <CACmBxytcmy_XRAedisO2BZejZLZhmABwLi2P1H3FfkPqBe=T_Q@mail.gmail.com>
References: <CACmBxytcmy_XRAedisO2BZejZLZhmABwLi2P1H3FfkPqBe=T_Q@mail.gmail.com>
Message-ID: <9364335.SMDMFZleTs@even-i700>

On vendredi 16 juin 2017 05:40:53 CEST Kurt Schwehr wrote:
> Even,
> 
> With https://trac.osgeo.org/gdal/changeset/39092, can you explain the this
> check?
> 
>     uncompressed_pos - startOff > m_compressed_size
> 
> That looks to be comparing the number of bytes compressed vrs
> uncompressed.  How is this checking that the filesize changed?  Something
> seems wrong or there needs to be a comment somewhere because this doesn't
> seem correct.

uncompressed_pos was badly named indeed. It was the "raw" position in the compressed file 
actually. Fixed per 
https://trac.osgeo.org/gdal/changeset/39136

> 
> Thanks,
> -kurt


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170616/f75ac198/attachment-0001.html>

From ruslan.sivak at reis.com  Fri Jun 16 07:06:57 2017
From: ruslan.sivak at reis.com (Russ Sivak)
Date: Fri, 16 Jun 2017 10:06:57 -0400
Subject: [gdal-dev] MSSQLSpatial Driver fails to bulk insert (n)varchar
	columns
Message-ID: <5d75da3f-43f4-edeb-6ddc-1696473e2ecc@reis.com>

We are trying to use ogr2ogr to load shapefiles into SQL Server. It 
works when we are not using bulk copy, but once we use a windows build 
with bulk copy, it's super fast, but inserts garbage characters into the 
varchar/nvarchar fields.  The numeric and geometry fields seem to be fine.

We are using the latest stable build from here:

http://gisinternals.com/release.php

We tried SQL Server 2014, 2016 and 2017 and none work.

This is what I'm using to load a test shape file into SQL 2014

ogr2ogr -f "MSSQLSpatial" 
"MSSQL:SERVER=localhost\SQL2014;DATABASE=test;DRIVER={SQL Server Native 
Client 11.0};trusted_connection=yes" C:\russ\cb_2016_us_county_500k -nln 
test -progress -overwrite
ERROR 4: Unable to open EPSG support file gcs.csv.
Try setting the GDAL_DATA environment variable to point to the directory 
containing EPSG csv files.
ERROR 6: No translation for an empty SRS to PROJ.4 format is known.
0...10...20...30...40...50...60...70...80...90...100 - done.


Also the error about GDAL_DATA persists even after setting

GDAL_DATA="C:\Program Files\GDAL\gdal-data"

The nvarchar fields seem to contain one junk character (which is 
different every time you run the load).  Also all the fields have the 
same character (at least for this shape file).  For the last run every 
single nvarchar field is 'v'

Here is a sample row.

ogr_fid    ogr_geometry    statefp    countyfp    countyns affgeoid 
geoid    name    lsad    aland    awater
1 
0x0000000001043F00000064C746205E1A57C000DF6DDE38C14440EC1681B1BE1657C0C34483143CC14440F92EA52E191657C0FE428F183DC14440663046240A1357C0F6E978CC40C144402FBDFDB9681257C0E44A3D0B42C1444040A374E95F0E57C04E999B6F44C14440CB811E6ADB0C57C058AB764D48C14440E8BB5B59A20B57C0CFDBD8EC48C1444062F54718060A57C0D8EDB3CA4CC1444039419B1C3E0557C0FA27B85851C1444011548D5E0D0557C0AC8A709351C14440CC069964E40457C05930F14751C14440F6CE68AB920457C0D5E940D653C14440F69507E9290457C0E063B0E254C144406C0377A04E0357C08CD5E6FF55C1444030F0DC7BB80257C033BE2F2E55C144404B749659840257C0B398D87C5CC14440802A6EDC620257C02C99637957C144400567F0F78BFC56C07BBB253960C144409F53909F8DFC56C033BF9A0304BB444028D53E1D8FFC56C05ED4EE5701BA4440307F85CC95FC56C084622B685AB6444055D7A19A92FC56C0A19E3E027FB4444013807F4A95FC56C08F32E202D0B044402A8E03AF96FC56C027F911BF62AF4440AD6C1FF296FC56C063096B63ECAE4440D05CA79196FC56C037A79201A0AE4440B229577897FC56C07D21E4BCFFAD44402F17F19D98FC56C00FD253E410AD4440041C42959AFC56C04FE449D235AB44409C2FF65E7CFC56C00C569C6A2DA044403A2009FB76FC56C0C556D0B4C49E4440FF0758AB76FC56C03F1878EE3D9E44407C5D86FF74FC56C0BDE13E726B9C4440F2423A3C84FC56C02C2CB81FF0944440368FC360FEFC56C09B374E0AF3944440DAAB8F87BEFD56C04C327216F69444408FE21C75740157C0C1A90F24EF944440342A70B20D0457C0A3737E8AE39444405708ABB1840B57C0A626C11BD29444406B7D91D0960E57C08AA9F413CE944440A833F790F01257C077853E58C6944440F6949C137B1457C0300DC347C494444026C5C727641557C002F1BA7EC19444405C52B5DD041A57C05F402FDCB99444405BAFE941411A57C0A6ECF483BA944440253ACB2C421A57C09291B3B0A795444086C43D963E1A57C0AE0B3F389F964440378B170B431A57C0F3B0506B9A9744407E37DDB2431A57C0F677B6476F98444090A2CEDC431A57C059349D9D0C9A4440F3FFAA23471A57C0630B410E4A9A44402A8F6E84451A57C079CC4065FC9F4440ECC039234A1A57C013984EEB36A24440FD1186014B1A57C067B62BF4C1A24440F14927124C1A57C0B854A52DAEA344408FA50F5D501A57C04AB3791C06AB44403526C45C521A57C0BD378600E0AC44408E3D7B2E531A57C0BD361B2B31AF444009C38025571A57C0C804FC1A49B444405BE9B5D9581A57C02BA391CF2BB644402F6CCD565E1A57C064AE0CAA0DBE444064C746205E1A57C000DF6DDE38C1444001000000020000000001000000FFFFFFFF0000000003 
v    v    v    v    v    v    v    1500067253    1929323


The file I'm currently trying to load is 
http://www2.census.gov/geo/tiger/GENZ2016/shp/cb_2016_us_county_500k.zip 
(unzipped obviously), but it fails with every shapefile I've tried.

Disclaimer

The information contained in this communication from the sender is confidential. It is intended solely for use by the recipient and others authorized to receive it. If you are not the recipient, you are hereby notified that any disclosure, copying, distribution or taking action in relation of the contents of this information is strictly prohibited and may be unlawful.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170616/c21847b7/attachment.html>

From ruslan.sivak at reis.com  Fri Jun 16 08:59:26 2017
From: ruslan.sivak at reis.com (Russ Sivak)
Date: Fri, 16 Jun 2017 11:59:26 -0400
Subject: [gdal-dev] MSSQLSpatial Driver fails to bulk insert (n)varchar
	columns
Message-ID: <566ae310-d50f-5eaf-afff-bc4f87d0ab21@reis.com>

We are trying to use ogr2ogr to load shapefiles into SQL Server. It 
works when we are not using bulk copy, but once we use a windows build 
with bulk copy, it's super fast, but inserts garbage characters into the 
varchar/nvarchar fields.  The numeric and geometry fields seem to be fine.

We are using the latest stable build from here:

http://gisinternals.com/release.php

We tried SQL Server 2014, 2016 and 2017 and none work.

This is what I'm using to load a test shape file into SQL 2014

ogr2ogr -f "MSSQLSpatial" 
"MSSQL:SERVER=localhost\SQL2014;DATABASE=test;DRIVER={SQL Server Native 
Client 11.0};trusted_connection=yes" C:\russ\cb_2016_us_county_500k -nln 
test -progress -overwrite
ERROR 4: Unable to open EPSG support file gcs.csv.
Try setting the GDAL_DATA environment variable to point to the directory 
containing EPSG csv files.
ERROR 6: No translation for an empty SRS to PROJ.4 format is known.
0...10...20...30...40...50...60...70...80...90...100 - done.


Also the error about GDAL_DATA persists even after setting

GDAL_DATA="C:\Program Files\GDAL\gdal-data"

The nvarchar fields seem to contain one junk character (which is 
different every time you run the load).  Also all the fields have the 
same character (at least for this shape file).  For the last run every 
single nvarchar field is 'v'

Here is a sample row.

ogr_fid    ogr_geometry    statefp    countyfp    countyns affgeoid 
geoid    name    lsad    aland    awater
1 
0x0000000001043F00000064C746205E1A57C000DF6DDE38C14440EC1681B1BE1657C0C34483143CC14440F92EA52E191657C0FE428F183DC14440663046240A1357C0F6E978CC40C144402FBDFDB9681257C0E44A3D0B42C1444040A374E95F0E57C04E999B6F44C14440CB811E6ADB0C57C058AB764D48C14440E8BB5B59A20B57C0CFDBD8EC48C1444062F54718060A57C0D8EDB3CA4CC1444039419B1C3E0557C0FA27B85851C1444011548D5E0D0557C0AC8A709351C14440CC069964E40457C05930F14751C14440F6CE68AB920457C0D5E940D653C14440F69507E9290457C0E063B0E254C144406C0377A04E0357C08CD5E6FF55C1444030F0DC7BB80257C033BE2F2E55C144404B749659840257C0B398D87C5CC14440802A6EDC620257C02C99637957C144400567F0F78BFC56C07BBB253960C144409F53909F8DFC56C033BF9A0304BB444028D53E1D8FFC56C05ED4EE5701BA4440307F85CC95FC56C084622B685AB6444055D7A19A92FC56C0A19E3E027FB4444013807F4A95FC56C08F32E202D0B044402A8E03AF96FC56C027F911BF62AF4440AD6C1FF296FC56C063096B63ECAE4440D05CA79196FC56C037A79201A0AE4440B229577897FC56C07D21E4BCFFAD44402F17F19D98FC56C00FD253E410AD4440041C42959AFC56C04FE449D235AB44409C2FF65E7CFC56C00C569C6A2DA044403A2009FB76FC56C0C556D0B4C49E4440FF0758AB76FC56C03F1878EE3D9E44407C5D86FF74FC56C0BDE13E726B9C4440F2423A3C84FC56C02C2CB81FF0944440368FC360FEFC56C09B374E0AF3944440DAAB8F87BEFD56C04C327216F69444408FE21C75740157C0C1A90F24EF944440342A70B20D0457C0A3737E8AE39444405708ABB1840B57C0A626C11BD29444406B7D91D0960E57C08AA9F413CE944440A833F790F01257C077853E58C6944440F6949C137B1457C0300DC347C494444026C5C727641557C002F1BA7EC19444405C52B5DD041A57C05F402FDCB99444405BAFE941411A57C0A6ECF483BA944440253ACB2C421A57C09291B3B0A795444086C43D963E1A57C0AE0B3F389F964440378B170B431A57C0F3B0506B9A9744407E37DDB2431A57C0F677B6476F98444090A2CEDC431A57C059349D9D0C9A4440F3FFAA23471A57C0630B410E4A9A44402A8F6E84451A57C079CC4065FC9F4440ECC039234A1A57C013984EEB36A24440FD1186014B1A57C067B62BF4C1A24440F14927124C1A57C0B854A52DAEA344408FA50F5D501A57C04AB3791C06AB44403526C45C521A57C0BD378600E0AC44408E3D7B2E531A57C0BD361B2B31AF444009C38025571A57C0C804FC1A49B444405BE9B5D9581A57C02BA391CF2BB644402F6CCD565E1A57C064AE0CAA0DBE444064C746205E1A57C000DF6DDE38C1444001000000020000000001000000FFFFFFFF0000000003 
v    v    v    v    v    v    v    1500067253    1929323


The file I'm currently trying to load is 
http://www2.census.gov/geo/tiger/GENZ2016/shp/cb_2016_us_county_500k.zip 
(unzipped obviously), but it fails with every shapefile I've tried.

Disclaimer

The information contained in this communication from the sender is confidential. It is intended solely for use by the recipient and others authorized to receive it. If you are not the recipient, you are hereby notified that any disclosure, copying, distribution or taking action in relation of the contents of this information is strictly prohibited and may be unlawful.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170616/7a9ae0fd/attachment.html>

From cgodkin at gmail.com  Sat Jun 17 18:34:37 2017
From: cgodkin at gmail.com (Carl Godkin)
Date: Sat, 17 Jun 2017 18:34:37 -0700
Subject: [gdal-dev] Looking to understand /vsicurl usage...
Message-ID: <CAE=8kmkdFcr3HF0H_GBiMV63DCxzmk3upfQ8aJRigK1503Eumg@mail.gmail.com>

Hi,

The OpenTopography site provides a web service to download its SRTM data.
See

http://www.opentopography.org/developers#SRTM

where there is an example URL for a query (that works).

What I don't understand is that

gdalinfo "/vsicurl/<example URL>"

fails with "ERROR 4: `/vsicurl/
http://opentopo.sdsc.edu/otr/getdem?demtype=SRTMGL3&west=-120.168457&south=36.738884&east=-118.465576&north=38.091337&outputFormat=GTiff'
not recognized as a supported file format."

but

gdalinfo "<example URL>"

works just fine.  While it's wonderful that it works, I'm looking to do
something like this from a C++ program so I would like to understand why
/vsicurl is not used in this situation.

Thanks very much,

carl
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170617/6cf2f08c/attachment.html>

From even.rouault at spatialys.com  Sun Jun 18 02:09:49 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 18 Jun 2017 11:09:49 +0200
Subject: [gdal-dev] Looking to understand /vsicurl usage...
In-Reply-To: <CAE=8kmkdFcr3HF0H_GBiMV63DCxzmk3upfQ8aJRigK1503Eumg@mail.gmail.com>
References: <CAE=8kmkdFcr3HF0H_GBiMV63DCxzmk3upfQ8aJRigK1503Eumg@mail.gmail.com>
Message-ID: <21401039.3jv4agPWxP@even-i700>

On samedi 17 juin 2017 18:34:37 CEST Carl Godkin wrote:
> Hi,
> 
> The OpenTopography site provides a web service to download its SRTM data.
> See
> 
> http://www.opentopography.org/developers#SRTM
> 
> where there is an example URL for a query (that works).
> 
> What I don't understand is that
> 
> gdalinfo "/vsicurl/<example URL>"
> 
> fails with "ERROR 4: `/vsicurl/
> http://opentopo.sdsc.edu/otr/getdem?demtype=SRTMGL3&west=-120.168457&south=3
> 6.738884&east=-118.465576&north=38.091337&outputFormat=GTiff' not recognized
> as a supported file format."
> 
> but
> 
> gdalinfo "<example URL>"
> 
> works just fine.  While it's wonderful that it works, I'm looking to do
> something like this from a C++ program so I would like to understand why
> /vsicurl is not used in this situation.
> 

/vsicurl/ requires the server to accept random reading with Range HTTP headers. This is 
generally the case for HTTP server that serve static files. But in the example you show, it 
seems the server will dynamically generate the content and in that case it doesn't seem to be 
the case. It responds with chunked transfer encoding, which /vsicurl/ doesn't support.

If you just do gdalinfo http://.... , the pseudo HTTP driver will download in-memory the whole 
file with a regular non-ranged GET before passing it to other GDAL drivers.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170618/d03721b7/attachment.html>

From 24dakenlo at gmail.com  Mon Jun 19 03:10:30 2017
From: 24dakenlo at gmail.com (NASAHARA Kenlo)
Date: Mon, 19 Jun 2017 19:10:30 +0900
Subject: [gdal-dev] gdal 8-bit signed int support unavailable?
Message-ID: <20170619191030.122c4dc74353c677a647efef@gmail.com>

Hi, GDAL people:

I want to handle 8-bit signed integer raster data by C++
but it seems GDAL does not such data type:
https://naturalatlas.github.io/node-gdal/classes/Constants%20(GDT).html#prop-gdal.GDT_Byte

Does it mean GDAL cannot handle 8-bit signed int?

-- 
Kenlo Nishida Nasahara
Faculty of Life and Environmental Sciences
University of Tsukuba, Japan 305-8572
24dakenlo at gmail.com

From even.rouault at spatialys.com  Mon Jun 19 03:22:56 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Jun 2017 12:22:56 +0200
Subject: [gdal-dev] gdal 8-bit signed int support unavailable?
In-Reply-To: <20170619191030.122c4dc74353c677a647efef@gmail.com>
References: <20170619191030.122c4dc74353c677a647efef@gmail.com>
Message-ID: <55480809.rNPJGS4DQu@even-i700>

On lundi 19 juin 2017 19:10:30 CEST NASAHARA Kenlo wrote:
> Hi, GDAL people:
> 
> I want to handle 8-bit signed integer raster data by C++
> but it seems GDAL does not such data type:
> https://naturalatlas.github.io/node-gdal/classes/Constants%20(GDT).html#prop
> -gdal.GDT_Byte
> 
> Does it mean GDAL cannot handle 8-bit signed int?

Kenlo,

There's no dedicated type for 8-bit signed int indeed. The hack used is to still use GDT_Byte 
but advertize PIXELTYPE=SIGNEDBYTE in the IMAGE_STRUCTURE metadata domain of the 
band. See http://gdal.org/gdal_datamodel.html

Statistics computation should take that into account to properly interpret the values as 
signed, but apart from a few drivers (from a quick search GTIff, netCDF, HFA, EHdr, ERS, MEM) 
that correctly interpret/set the PIXELTYPE=SIGNEDBYTE hint, other drivers will generally 
ignore it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170619/a7f35fd7/attachment.html>

From 24dakenlo at gmail.com  Mon Jun 19 03:44:10 2017
From: 24dakenlo at gmail.com (Kenlo Nasahara)
Date: Mon, 19 Jun 2017 03:44:10 -0700 (MST)
Subject: [gdal-dev] gdal 8-bit signed int support unavailable?
In-Reply-To: <55480809.rNPJGS4DQu@even-i700>
References: <20170619191030.122c4dc74353c677a647efef@gmail.com>
 <55480809.rNPJGS4DQu@even-i700>
Message-ID: <1497869050955-5324652.post@n6.nabble.com>

Even, thanks a lot. It was a surprise for me that GDAL does not support 8-bit
signed int. It may be better not to use it with GDAL. Kenlo Nasahara



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-8-bit-signed-int-support-unavailable-tp5324647p5324652.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Mon Jun 19 03:52:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 19 Jun 2017 12:52:17 +0200
Subject: [gdal-dev] gdal 8-bit signed int support unavailable?
In-Reply-To: <1497869050955-5324652.post@n6.nabble.com>
References: <20170619191030.122c4dc74353c677a647efef@gmail.com>
 <55480809.rNPJGS4DQu@even-i700> <1497869050955-5324652.post@n6.nabble.com>
Message-ID: <2416253.zJ9T9rTdzt@even-i700>

On lundi 19 juin 2017 03:44:10 CEST Kenlo Nasahara wrote:
> Even, thanks a lot. It was a surprise for me that GDAL does not support
> 8-bit signed int. It may be better not to use it with GDAL. Kenlo Nasahara

If you've got the choice, use Int16 datatype instead.

> 
> 
> 
> --
> View this message in context:
> http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdal-8-bit-signed-int-support-> unavailable-tp5324647p5324652.html Sent from the GDAL - Dev mailing list
> archive at Nabble.com.
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170619/5d7b9a64/attachment.html>

From 24dakenlo at gmail.com  Mon Jun 19 17:24:37 2017
From: 24dakenlo at gmail.com (NASAHARA Kenlo)
Date: Tue, 20 Jun 2017 09:24:37 +0900
Subject: [gdal-dev] What is CPL?
Message-ID: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>

Dear GDAL people,

Let me raise a silly question, please. 

What is "CPL" which appears around the 
GDAL world, such as "CPLError"?

I tried to figure out but I still cannot. 
For example, 
 Combined Programming Language
 computer pidgin language
 Combined Programming Language
...

-- 
Kenlo Nishida Nasahara
Faculty of Life and Environmental Sciences
University of Tsukuba, Japan 305-8572
24dakenlo at gmail.com

From mateusz at loskot.net  Mon Jun 19 17:35:09 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 20 Jun 2017 02:35:09 +0200
Subject: [gdal-dev] What is CPL?
In-Reply-To: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
Message-ID: <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>

On 20 Jun 2017 02:24, "NASAHARA Kenlo" <24dakenlo at gmail.com> wrote:

Dear GDAL people,

Let me raise a silly question, please.

What is "CPL" which appears around the
GDAL world, such as "CPLError"?



common portability library
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170620/16a18025/attachment.html>

From kyle at pobox.com  Mon Jun 19 17:31:06 2017
From: kyle at pobox.com (Kyle Shannon)
Date: Mon, 19 Jun 2017 18:31:06 -0600
Subject: [gdal-dev] What is CPL?
In-Reply-To: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
Message-ID: <CAJ0mEz2vBEt9PNXzhdzR5FkPXVQ3vGjMKtZ_hSUP1kppQ8H-hQ@mail.gmail.com>

Hi,

On Mon, Jun 19, 2017 at 6:24 PM, NASAHARA Kenlo <24dakenlo at gmail.com> wrote:
> Dear GDAL people,
>
> Let me raise a silly question, please.
>
> What is "CPL" which appears around the
> GDAL world, such as "CPLError"?
>
> I tried to figure out but I still cannot.
> For example,
>  Combined Programming Language
>  computer pidgin language
>  Combined Programming Language
> ...
>
> --
> Kenlo Nishida Nasahara
> Faculty of Life and Environmental Sciences
> University of Tsukuba, Japan 305-8572
> 24dakenlo at gmail.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

If I remember correctly, it stands for Common Portability Library.

-- 
Kyle

From 24dakenlo at gmail.com  Mon Jun 19 17:56:17 2017
From: 24dakenlo at gmail.com (NASAHARA Kenlo)
Date: Tue, 20 Jun 2017 09:56:17 +0900
Subject: [gdal-dev] What is CPL?
In-Reply-To: <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
 <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>
Message-ID: <20170620095617.716b7938494d3f2716449224@gmail.com>

Thak you, Mateusz and Kyle.

By using your key word, I found it in the source code:

http://gdal.org/cpl__port_8h-source.html
00004  * Project:  CPL - Common Portability Library
00005  * Author:   Frank Warmerdam, warmerdam at pobox.com

It seems CPL is a part of GDAL libraries for me.  Is it correct? 
Or is CPL a general library used commonly in many projects
outside GDAL as well?


On Tue, 20 Jun 2017 02:35:09 +0200
Mateusz Loskot <mateusz at loskot.net> wrote:

> On 20 Jun 2017 02:24, "NASAHARA Kenlo" <24dakenlo at gmail.com> wrote:
> 
> Dear GDAL people,
> 
> Let me raise a silly question, please.
> 
> What is "CPL" which appears around the
> GDAL world, such as "CPLError"?
> 
> 
> 
> common portability library


-- 
Kenlo Nishida Nasahara
Faculty of Life and Environmental Sciences
University of Tsukuba, Japan 305-8572
24dakenlo at gmail.com

From mateusz at loskot.net  Tue Jun 20 00:08:00 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 20 Jun 2017 09:08:00 +0200
Subject: [gdal-dev] What is CPL?
In-Reply-To: <20170620095617.716b7938494d3f2716449224@gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
 <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>
 <20170620095617.716b7938494d3f2716449224@gmail.com>
Message-ID: <CABUeae-0kOC8r3KvGm4u_UoBTZMvdudfMt8KXekuL2gxKf6UzA@mail.gmail.com>

On 20 Jun 2017 2:56 am, "NASAHARA Kenlo" <24dakenlo at gmail.com> wrote:

Thak you, Mateusz and Kyle.

By using your key word, I found it in the source code:

http://gdal.org/cpl__port_8h-source.html
00004  * Project:  CPL - Common Portability Library
00005  * Author:   Frank Warmerdam, warmerdam at pobox.com

It seems CPL is a part of GDAL libraries for me.  Is it correct?


Yes, it is part of GDAL

Mateusz
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170620/d7a9102b/attachment.html>

From mateusz at loskot.net  Tue Jun 20 01:33:31 2017
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 20 Jun 2017 10:33:31 +0200
Subject: [gdal-dev] What is CPL?
In-Reply-To: <CABUeae-0kOC8r3KvGm4u_UoBTZMvdudfMt8KXekuL2gxKf6UzA@mail.gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
 <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>
 <20170620095617.716b7938494d3f2716449224@gmail.com>
 <CABUeae-0kOC8r3KvGm4u_UoBTZMvdudfMt8KXekuL2gxKf6UzA@mail.gmail.com>
Message-ID: <CABUeae-DYGaDZ9=84pMrSCHjxkUoMgCePP91r_JG3wD0reCNyw@mail.gmail.com>

FYI, I have added "What does CPL stand for?" to the FAQ

https://trac.osgeo.org/gdal/wiki/FAQGeneral#WhatdoesCPLstandfor

Mateusz


On 20 June 2017 at 09:08, Mateusz Loskot <mateusz at loskot.net> wrote:
> On 20 Jun 2017 2:56 am, "NASAHARA Kenlo" <24dakenlo at gmail.com> wrote:
>
> Thak you, Mateusz and Kyle.
>
> By using your key word, I found it in the source code:
>
> http://gdal.org/cpl__port_8h-source.html
> 00004  * Project:  CPL - Common Portability Library
> 00005  * Author:   Frank Warmerdam, warmerdam at pobox.com
>
> It seems CPL is a part of GDAL libraries for me.  Is it correct?
>
>
> Yes, it is part of GDAL
>
> Mateusz
>
>



-- 
Mateusz Loskot, http://mateusz.loskot.net

From mathieu.lattes at yahoo.fr  Tue Jun 20 04:33:54 2017
From: mathieu.lattes at yahoo.fr (M. LATTES)
Date: Tue, 20 Jun 2017 11:33:54 +0000 (UTC)
Subject: [gdal-dev] gdalmanage enhancement proposal
References: <2104140458.3983135.1497958434853.ref@mail.yahoo.com>
Message-ID: <2104140458.3983135.1497958434853@mail.yahoo.com>

Hi everybody,
Using GDAL I've made an utility program to rename raster datasets using theire SRS coordinates.I made it to rename datasets downloaded from different sources, so they have a consistent naming pattern or to update the name after a SRS change with gdalwarp. 

There is the possibility to choose a prefix, a suffix, a corner (W/N by default) of the bounding box of the dataset as reference point.It's also possible to specify a separator for coordinates values, the numeric format of coordinates (integer, double), the number of digits and the format of the sign (wheter or not using +/- , or N/S and E/W).There is also an option to output the rename shell commands in the console, instead of performing it (Usefull to generate batch rename shell commands). 

If the community think it can be helpfull, I can try to enhance the gdalmanage utility to add these options...

You can take a look at the original application here ​https://github.com/MattLatt/gdal_rename
Best regards. 

Mathieu Lattes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170620/f54d3a72/attachment-0001.html>

From schwehr at gmail.com  Tue Jun 20 09:11:14 2017
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 20 Jun 2017 09:11:14 -0700
Subject: [gdal-dev] What is CPL?
In-Reply-To: <CABUeae-DYGaDZ9=84pMrSCHjxkUoMgCePP91r_JG3wD0reCNyw@mail.gmail.com>
References: <20170620092437.8fd9b307af24eded475fafcc@gmail.com>
 <CABUeae-OPFDY6eCC6=JDGTHMy744Ozmzt5Kee3hndfr3dn1ysg@mail.gmail.com>
 <20170620095617.716b7938494d3f2716449224@gmail.com>
 <CABUeae-0kOC8r3KvGm4u_UoBTZMvdudfMt8KXekuL2gxKf6UzA@mail.gmail.com>
 <CABUeae-DYGaDZ9=84pMrSCHjxkUoMgCePP91r_JG3wD0reCNyw@mail.gmail.com>
Message-ID: <CACmBxyv_ZWkWqUftRJ2sd8dDBmXYs7Mg-cRaaZnAd-c1iRFkcA@mail.gmail.com>

CPL is used in libgeotiff and a few other places, but those are closely
tied to GDAL.



On Tue, Jun 20, 2017 at 1:33 AM, Mateusz Loskot <mateusz at loskot.net> wrote:

> FYI, I have added "What does CPL stand for?" to the FAQ
>
> https://trac.osgeo.org/gdal/wiki/FAQGeneral#WhatdoesCPLstandfor
>
> Mateusz
>
>
> On 20 June 2017 at 09:08, Mateusz Loskot <mateusz at loskot.net> wrote:
> > On 20 Jun 2017 2:56 am, "NASAHARA Kenlo" <24dakenlo at gmail.com> wrote:
> >
> > Thak you, Mateusz and Kyle.
> >
> > By using your key word, I found it in the source code:
> >
> > http://gdal.org/cpl__port_8h-source.html
> > 00004  * Project:  CPL - Common Portability Library
> > 00005  * Author:   Frank Warmerdam, warmerdam at pobox.com
> >
> > It seems CPL is a part of GDAL libraries for me.  Is it correct?
> >
> >
> > Yes, it is part of GDAL
> >
> > Mateusz
> >
> >
>
>
>
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
--
http://schwehr.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170620/e2ecee12/attachment.html>

From bespin at gmail.com  Tue Jun 20 19:35:47 2017
From: bespin at gmail.com (Travis Featherston)
Date: Tue, 20 Jun 2017 19:35:47 -0700
Subject: [gdal-dev] FileGDB locks don't produce error during indexing
Message-ID: <CAHK7dsvuEoVvCABHe6iX4UndGxWkpp=0bnZqg7hoYAKQhs4Keg@mail.gmail.com>

I have 2 concurrent processes creating indexes on FileGDB tables.  I
expected to receive some sort of error or warning due to locking.
Unfortunately, both processes complete without any message or error. The
end result is that one of the indexes gets created and the other does not.

Run in 2 shells concurrently
ogrinfo -sql "create index ndx_one on foo_table (field1)" C:\temp\my.gdb
ogrinfo -sql "create index ndx_two on foo_table (field2)" C:\temp\my.gdb

Both return the following message but only one index is actually created.
INFO: Open of `C:\temp\my.gdb'
      using driver `FileGDB' successful.


I actually found this during some processing using python/ogr like this.
Nothing gets raised here either.
ogr.UseExceptions()
driver = ogr.GetDriverByName('FileGDB')
ds = driver.Open(self.gdb, 0)
layer = ds.GetLayer(self.fc)
sqlcmd = "create index {0} on {1}({2})".format(self.ndx_name, self.fc,
self.field)
ds.ExecuteSQL(sqlcmd)
ds = None

Is there anything I can do to catch this at runtime?  At the very least is
there a pattern to look for the existence of an index?  I went through
different dialects and couldn't figure anything out.

Thanks,
bespin
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170620/6b1ada0d/attachment.html>

From matt.a.hanson at gmail.com  Tue Jun 20 21:58:46 2017
From: matt.a.hanson at gmail.com (Matt Hanson)
Date: Wed, 21 Jun 2017 00:58:46 -0400
Subject: [gdal-dev] Cannot open S3 files after upload
Message-ID: <CAGYeuZ=YGf_0rA3L_80BBNhby1bYzK7DPCYEC90f77WKSuuChA@mail.gmail.com>

Hello everyone,

My actual problem is a bit more specific then being unable to open S3 files
after upload. The actual problem is that within the same Python session, I
can open a file off S3 with the vsis3 driver, but then if I upload a new
file that previously did not exist (using boto3), gdal does not see it as a
valid file. I originally encountered this problem in rasterio, and with
gippy, but got the same problem when using gdal directly.

I have an app that generates time series by calculating values from images
off S3, however it also uploads files to S3 if they did not previously
exist for that particular date. If all the files currently exist then there
is no problem and they can be read fine. However, if a file is missing
*and* the app has already read a file from S3, then it is unable to see the
file as existing.

What appears to be happening is that once an S3 file is read the contents
of that bucket are read into a cache, but then if an new file is uploaded
in the meantime, trying to then read that file looks in the cache and
doesn't see that file as existing and throws an error. If I recall
correctly GDAL is reading other contents of that bucket/key-prefix because
it's looking accompanying metadata files so is this cached in some way? It
seemed like a plausible explanation but I've been unable to find reference
to such a cache other than potentially VSI_CACHE, but setting that to FALSE
did nothing and my understanding is that it applies to specific datasets,
not bucket contents.

I've managed to replicate the problem in a very simple Python program
below. While both files are uploaded without error (you can use gdalinfo
remotely on both), the attempt to open the second file will throw:
ERROR 4: `/vsis3/pail-of-images/test2.tif' not recognized as a supported
file format.

Calling the script a second time works, because (presumably) even though it
uploads and overwrites both images again, they both exist from the
beginning.

Either this is a bug or it's intended behavior in which case there's
hopefully some way to change it to force to reread a bucket when trying to
open a file. My current workaround is to change the behavior of my app to
upload all images first before accessing, but this seems unsatisfactory,
not to mention it wreaks havoc with my tests which don't assume such
behavior.

Suggestions very welcome, been banging my head on this for a couple days.

Tested with both Python v2.7 and 3.5, and with gdal 2.1.3 and gdal 2.2.0,
with Docker, without Docker, and on both Ubuntu and OSX.

########################
#!/usr/bin/env python3

from osgeo import gdal
import boto3

filenames = [
    'file1.tif',
    'file2.tif'
]

bucket = 'pail-of-images'

s3 = boto3.resource('s3')
for f in filenames:
    print('Uploading %s to %s' % (f, bucket))
    s3.meta.client.upload_file(f, bucket, f)
    uri = '/vsis3/%s/%s' % (bucket, f)
    print('Opening %s' % uri)
    ds = gdal.Open(uri)
    print(ds.GetMetadata())
    ds = None
##########################

Matthew Hanson
Development Seed
matthew at developmentseed.org
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/8db2f1c8/attachment.html>

From even.rouault at spatialys.com  Wed Jun 21 01:07:07 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 21 Jun 2017 10:07:07 +0200
Subject: [gdal-dev] FileGDB locks don't produce error during indexing
In-Reply-To: <CAHK7dsvuEoVvCABHe6iX4UndGxWkpp=0bnZqg7hoYAKQhs4Keg@mail.gmail.com>
References: <CAHK7dsvuEoVvCABHe6iX4UndGxWkpp=0bnZqg7hoYAKQhs4Keg@mail.gmail.com>
Message-ID: <1817823.0jVu4T2d8B@even-i700>

On mardi 20 juin 2017 19:35:47 CEST Travis Featherston wrote:
> I have 2 concurrent processes creating indexes on FileGDB tables.  I
> expected to receive some sort of error or warning due to locking.
> Unfortunately, both processes complete without any message or error. The
> end result is that one of the indexes gets created and the other does not.
> 
> Run in 2 shells concurrently
> ogrinfo -sql "create index ndx_one on foo_table (field1)" C:\temp\my.gdb
> ogrinfo -sql "create index ndx_two on foo_table (field2)" C:\temp\my.gdb
> 
> Both return the following message but only one index is actually created.
> INFO: Open of `C:\temp\my.gdb'
>       using driver `FileGDB' successful.
> 
> 
> I actually found this during some processing using python/ogr like this.
> Nothing gets raised here either.
> ogr.UseExceptions()
> driver = ogr.GetDriverByName('FileGDB')
> ds = driver.Open(self.gdb, 0)
> layer = ds.GetLayer(self.fc)
> sqlcmd = "create index {0} on {1}({2})".format(self.ndx_name, self.fc,
> self.field)
> ds.ExecuteSQL(sqlcmd)
> ds = None
> 
> Is there anything I can do to catch this at runtime?  At the very least is
> there a pattern to look for the existence of an index?  I went through
> different dialects and couldn't figure anything out.

Travis,

Do you use the latest version of the FileGDB SDK (1.5) ? just in case.

I believe that the SDK should be responsible for setting locks here (it does for some 
operations, but I haven't checked if that works properly). If that doesn't work, then you 
should probably raise the issue directly to ESRI. This could perhaps be done at the OGR level 
by explicitly calling SetWriteLock() / FreeWriteLock(), although the documentation of those 
functions only suggest they should be used for bulk loading (and that's what is actually used 
when doing bulk loading by OGR)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/5d8d0b0f/attachment.html>

From even.rouault at spatialys.com  Wed Jun 21 02:02:25 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 21 Jun 2017 11:02:25 +0200
Subject: [gdal-dev] Cannot open S3 files after upload
In-Reply-To: <CAGYeuZ=YGf_0rA3L_80BBNhby1bYzK7DPCYEC90f77WKSuuChA@mail.gmail.com>
References: <CAGYeuZ=YGf_0rA3L_80BBNhby1bYzK7DPCYEC90f77WKSuuChA@mail.gmail.com>
Message-ID: <4867977.OoOCttcZhO@even-i700>

Matt,

> My actual problem is a bit more specific then being unable to open S3 files
> after upload. The actual problem is that within the same Python session, I
> can open a file off S3 with the vsis3 driver, but then if I upload a new
> file that previously did not exist (using boto3), gdal does not see it as a
> valid file. 

Yes I'm aware of that issue. There's indeed metadata (file size & date, directory listing) and 
data (chunks of files) cached by /vsicurl/ and related file systems like /vsis3/ . /vsicurl/ was 
designed at a time where web resources didn't change that much and it was unlikely during a 
same GDAL session to see changes, but with cloud offerings, this is no longer the case.

A few weeks ago I've added in trunk a CPL_VSIL_CURL_NON_CACHED config option that can 
be set to disable caching on a file or set of files.
See https://trac.osgeo.org/gdal/wiki/ConfigOptions#CPL_VSIL_CURL_NON_CACHED

So in your example, if you set
CPL_VSIL_CURL_NON_CACHED=/vsis3/put_here_the_bucket_name , that will work.

I've also just added per https://trac.osgeo.org/gdal/ticket/6937 a new function 
VSICurlClearCache() function (bound to SWIG as gdal.VSICurlClearCache()). So if you add 
gdal.VSICurlClearCache() just after the s3.meta.client.upload_file() call, that will work too.

Both mechanisms are complementary.

CPL_VSIL_CURL_NON_CACHED is useful in scenarios where you don't know when the server 
content can change (some other processes or machines do that behind your back). Its 
advantage is that it doesn't require modification of code (it was designed for MapServer use 
case typically). The drawback of it is that you loose all caching when a same file is opened, 
close, opened, closed, ... several times during the process.

VSICurlClearCache() will give you more control if you master when uploads happen.

I've also backported VSICurlClearCache() to 2.2 branch.

As far as VSI_CACHE=TRUE is concerned, its scope of caching is restricted to a same VSI file 
handle instance. Can be useful if the global 16 MB vsicurl cache isn't big enough for very 
large files.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/34958ac4/attachment-0001.html>

From matt.a.hanson at gmail.com  Wed Jun 21 08:47:49 2017
From: matt.a.hanson at gmail.com (Matt Hanson)
Date: Wed, 21 Jun 2017 11:47:49 -0400
Subject: [gdal-dev] Cannot open S3 files after upload
In-Reply-To: <4867977.OoOCttcZhO@even-i700>
References: <CAGYeuZ=YGf_0rA3L_80BBNhby1bYzK7DPCYEC90f77WKSuuChA@mail.gmail.com>
 <4867977.OoOCttcZhO@even-i700>
Message-ID: <CAGYeuZ=zOzvgQcj3WnF8Ezz++YRug6StNG_-nF6KZ713muK_Tg@mail.gmail.com>

Thanks Even,

Disabling reading the directory is another work around for my use case as
well:
(GDAL_DISABLE_READDIR_ON_OPEN=TRUE)

On Wed, Jun 21, 2017 at 5:02 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Matt,
>
>
>
> > My actual problem is a bit more specific then being unable to open S3
> files
>
> > after upload. The actual problem is that within the same Python session,
> I
>
> > can open a file off S3 with the vsis3 driver, but then if I upload a new
>
> > file that previously did not exist (using boto3), gdal does not see it
> as a
>
> > valid file.
>
>
>
> Yes I'm aware of that issue. There's indeed metadata (file size & date,
> directory listing) and data (chunks of files) cached by /vsicurl/ and
> related file systems like /vsis3/ . /vsicurl/ was designed at a time where
> web resources didn't change that much and it was unlikely during a same
> GDAL session to see changes, but with cloud offerings, this is no longer
> the case.
>
>
>
> A few weeks ago I've added in trunk a CPL_VSIL_CURL_NON_CACHED config
> option that can be set to disable caching on a file or set of files.
>
> See https://trac.osgeo.org/gdal/wiki/ConfigOptions#CPL_VSIL_
> CURL_NON_CACHED
>
>
>
> So in your example, if you set
>
> CPL_VSIL_CURL_NON_CACHED=/vsis3/put_here_the_bucket_name , that will work.
>
>
>
> I've also just added per https://trac.osgeo.org/gdal/ticket/6937 a new
> function VSICurlClearCache() function (bound to SWIG as
> gdal.VSICurlClearCache()). So if you add gdal.VSICurlClearCache() just
> after the s3.meta.client.upload_file() call, that will work too.
>
>
>
> Both mechanisms are complementary.
>
>
>
> CPL_VSIL_CURL_NON_CACHED is useful in scenarios where you don't know when
> the server content can change (some other processes or machines do that
> behind your back). Its advantage is that it doesn't require modification of
> code (it was designed for MapServer use case typically). The drawback of it
> is that you loose all caching when a same file is opened, close, opened,
> closed, ... several times during the process.
>
>
>
> VSICurlClearCache() will give you more control if you master when uploads
> happen.
>
>
>
> I've also backported VSICurlClearCache() to 2.2 branch.
>
>
>
> As far as VSI_CACHE=TRUE is concerned, its scope of caching is restricted
> to a same VSI file handle instance. Can be useful if the global 16 MB
> vsicurl cache isn't big enough for very large files.
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/9b46e2e2/attachment.html>

From even.rouault at spatialys.com  Wed Jun 21 08:52:03 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 21 Jun 2017 17:52:03 +0200
Subject: [gdal-dev] Cannot open S3 files after upload
In-Reply-To: <CAGYeuZ=zOzvgQcj3WnF8Ezz++YRug6StNG_-nF6KZ713muK_Tg@mail.gmail.com>
References: <CAGYeuZ=YGf_0rA3L_80BBNhby1bYzK7DPCYEC90f77WKSuuChA@mail.gmail.com>
 <4867977.OoOCttcZhO@even-i700>
 <CAGYeuZ=zOzvgQcj3WnF8Ezz++YRug6StNG_-nF6KZ713muK_Tg@mail.gmail.com>
Message-ID: <1744132.q4oiiUdWfD@even-i700>

On mercredi 21 juin 2017 11:47:49 CEST Matt Hanson wrote:
> Thanks Even,
> 
> Disabling reading the directory is another work around for my use case as
> well:
> (GDAL_DISABLE_READDIR_ON_OPEN=TRUE)

This can work, but will cause probing of lots of side-car files.

If you don't have any side-car files related to your .tif, try :
GDAL_DISABLE_READDIR_ON_OPEN=EMPTY_DIR

> 
> On Wed, Jun 21, 2017 at 5:02 AM, Even Rouault <even.rouault at spatialys.com>
> 
> wrote:
> > Matt,
> > 
> > > My actual problem is a bit more specific then being unable to open S3
> > 
> > files
> > 
> > > after upload. The actual problem is that within the same Python session,
> > 
> > I
> > 
> > > can open a file off S3 with the vsis3 driver, but then if I upload a new
> > > 
> > > file that previously did not exist (using boto3), gdal does not see it
> > 
> > as a
> > 
> > > valid file.
> > 
> > Yes I'm aware of that issue. There's indeed metadata (file size & date,
> > directory listing) and data (chunks of files) cached by /vsicurl/ and
> > related file systems like /vsis3/ . /vsicurl/ was designed at a time where
> > web resources didn't change that much and it was unlikely during a same
> > GDAL session to see changes, but with cloud offerings, this is no longer
> > the case.
> > 
> > 
> > 
> > A few weeks ago I've added in trunk a CPL_VSIL_CURL_NON_CACHED config
> > option that can be set to disable caching on a file or set of files.
> > 
> > See https://trac.osgeo.org/gdal/wiki/ConfigOptions#CPL_VSIL_
> > CURL_NON_CACHED
> > 
> > 
> > 
> > So in your example, if you set
> > 
> > CPL_VSIL_CURL_NON_CACHED=/vsis3/put_here_the_bucket_name , that will work.
> > 
> > 
> > 
> > I've also just added per https://trac.osgeo.org/gdal/ticket/6937 a new
> > function VSICurlClearCache() function (bound to SWIG as
> > gdal.VSICurlClearCache()). So if you add gdal.VSICurlClearCache() just
> > after the s3.meta.client.upload_file() call, that will work too.
> > 
> > 
> > 
> > Both mechanisms are complementary.
> > 
> > 
> > 
> > CPL_VSIL_CURL_NON_CACHED is useful in scenarios where you don't know when
> > the server content can change (some other processes or machines do that
> > behind your back). Its advantage is that it doesn't require modification
> > of
> > code (it was designed for MapServer use case typically). The drawback of
> > it
> > is that you loose all caching when a same file is opened, close, opened,
> > closed, ... several times during the process.
> > 
> > 
> > 
> > VSICurlClearCache() will give you more control if you master when uploads
> > happen.
> > 
> > 
> > 
> > I've also backported VSICurlClearCache() to 2.2 branch.
> > 
> > 
> > 
> > As far as VSI_CACHE=TRUE is concerned, its scope of caching is restricted
> > to a same VSI file handle instance. Can be useful if the global 16 MB
> > vsicurl cache isn't big enough for very large files.
> > 
> > 
> > 
> > Even
> > 
> > 
> > 
> > --
> > 
> > Spatialys - Geospatial professional services
> > 
> > http://www.spatialys.com


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/8007784a/attachment-0001.html>

From bespin at gmail.com  Wed Jun 21 09:03:12 2017
From: bespin at gmail.com (Travis Featherston)
Date: Wed, 21 Jun 2017 09:03:12 -0700
Subject: [gdal-dev] FileGDB locks don't produce error during indexing
In-Reply-To: <1817823.0jVu4T2d8B@even-i700>
References: <CAHK7dsvuEoVvCABHe6iX4UndGxWkpp=0bnZqg7hoYAKQhs4Keg@mail.gmail.com>
 <1817823.0jVu4T2d8B@even-i700>
Message-ID: <CAHK7dssrQKbZgRpm-f53SmNqhiNEotjTxsZUwXc4KacxsJTufA@mail.gmail.com>

Yes, I just confirmed this same behavior happens in the 1.5 SDK through the
latest OSGeo4W install.

Is the special GetLayerDefinition the best way to check for successful
indexes?

On Wed, Jun 21, 2017 at 1:07 AM, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 20 juin 2017 19:35:47 CEST Travis Featherston wrote:
>
> > I have 2 concurrent processes creating indexes on FileGDB tables. I
>
> > expected to receive some sort of error or warning due to locking.
>
> > Unfortunately, both processes complete without any message or error. The
>
> > end result is that one of the indexes gets created and the other does
> not.
>
> >
>
> > Run in 2 shells concurrently
>
> > ogrinfo -sql "create index ndx_one on foo_table (field1)" C:\temp\my.gdb
>
> > ogrinfo -sql "create index ndx_two on foo_table (field2)" C:\temp\my.gdb
>
> >
>
> > Both return the following message but only one index is actually created.
>
> > INFO: Open of `C:\temp\my.gdb'
>
> > using driver `FileGDB' successful.
>
> >
>
> >
>
> > I actually found this during some processing using python/ogr like this.
>
> > Nothing gets raised here either.
>
> > ogr.UseExceptions()
>
> > driver = ogr.GetDriverByName('FileGDB')
>
> > ds = driver.Open(self.gdb, 0)
>
> > layer = ds.GetLayer(self.fc)
>
> > sqlcmd = "create index {0} on {1}({2})".format(self.ndx_name, self.fc,
>
> > self.field)
>
> > ds.ExecuteSQL(sqlcmd)
>
> > ds = None
>
> >
>
> > Is there anything I can do to catch this at runtime? At the very least is
>
> > there a pattern to look for the existence of an index? I went through
>
> > different dialects and couldn't figure anything out.
>
>
>
> Travis,
>
>
>
> Do you use the latest version of the FileGDB SDK (1.5) ? just in case.
>
>
>
> I believe that the SDK should be responsible for setting locks here (it
> does for some operations, but I haven't checked if that works properly). If
> that doesn't work, then you should probably raise the issue directly to
> ESRI. This could perhaps be done at the OGR level by explicitly calling
> SetWriteLock() / FreeWriteLock(), although the documentation of those
> functions only suggest they should be used for bulk loading (and that's
> what is actually used when doing bulk loading by OGR)
>
>
>
> Even
>
>
>
> --
>
> Spatialys - Geospatial professional services
>
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170621/dea8077f/attachment.html>

From thehesiod at gmail.com  Wed Jun 21 21:20:12 2017
From: thehesiod at gmail.com (Alexander Mohr)
Date: Wed, 21 Jun 2017 21:20:12 -0700
Subject: [gdal-dev] Dropping dlopen/LoadLibrary loading of proj.4 ?
Message-ID: <D6FD9423-5E68-4E56-977E-27B97CCCFD08@gmail.com>

actually, even more importantly the reason to drop this is because it is wrong on linux.  When building gdal it will link to a specific version of libproj (ex libproj.so.3), with the current implementation, at runtime it will try to load libproj.so.  This does not existing in non -dev packages on purpose because it expects you to have a hard dependency to a versioned library so you won't accidentally load a version that's incompatible.

If a dynamic load is to be performed, it needs to remember the version that it was linked against, and not try to load the dev version.

Furthermore, the only reason to dynamically load the library is if it may not be available, but there currently is no fallback, you get an error that it can't load libproj.so.

So in fact the current implementation is broken in two ways.  It should just have a hard linker dependency against libproj.so.XX and if needed a flag that will cause all the methods to either not be available, or throw an exception if it was built w/o libproj support.

From aritchie at usgs.gov  Thu Jun 22 11:00:26 2017
From: aritchie at usgs.gov (Ritchie, Andrew)
Date: Thu, 22 Jun 2017 11:00:26 -0700
Subject: [gdal-dev] Fwd: NBITS=1 not preserved from vrt to tiff in
	multilayer tiff
In-Reply-To: <CAD3WMfUN4QngGSbkQ428=rWtAC1drTUWZ-avqq0pGKejdPXWRA@mail.gmail.com>
References: <CAD3WMfUN4QngGSbkQ428=rWtAC1drTUWZ-avqq0pGKejdPXWRA@mail.gmail.com>
Message-ID: <CAD3WMfV5cBWRTE=-E2mbXT8UokUoKNrLNS2NM6cBvdpQdNW3YQ@mail.gmail.com>

From: Ritchie, Andrew <aritchie at usgs.gov>
Date: Thu, Jun 22, 2017 at 10:30 AM
Subject: NBITS=1 not preserved from vrt to tiff in multilayer tiff
To: gdal-dev at lists.osgeo.org


We are building TIFFs with fourteen layers, four of which are byte, and the
remainder being binary. We are able to generate binary tiffs with NBITS=1
and stack them with gdalbuildvrt -separate, but when muiltilayer tiffs are
created with gdal_translate or gdal_merge -separate, the NBITS metadata are
ignored and the resulting tiff has the same bit depth (byte) for all
fourteen layers.

Is there a way to force NBITS per band with a -co NBITS=1 option when using
gdal_merge with the -separate flag? alternatively, is there a way to force
gdal_translate to honor the NBITS of the source layers in a VRT?

Andy

-- 
====================================
Andy Ritchie
U.S. Geological Survey
Pacific Coastal and Marine Science Center
2885 Mission St.
Santa Cruz, CA 95060
Office (831) 460-7454
Cell (360) 460-9453
aritchie at usgs.gov
---------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170622/84ad2c75/attachment.html>

From even.rouault at spatialys.com  Thu Jun 22 11:49:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 22 Jun 2017 20:49:27 +0200
Subject: [gdal-dev] Fwd: NBITS=1 not preserved from vrt to tiff in
	multilayer tiff
In-Reply-To: <CAD3WMfV5cBWRTE=-E2mbXT8UokUoKNrLNS2NM6cBvdpQdNW3YQ@mail.gmail.com>
References: <CAD3WMfUN4QngGSbkQ428=rWtAC1drTUWZ-avqq0pGKejdPXWRA@mail.gmail.com>
 <CAD3WMfV5cBWRTE=-E2mbXT8UokUoKNrLNS2NM6cBvdpQdNW3YQ@mail.gmail.com>
Message-ID: <1693241.7GDTx5TNAZ@even-i700>

On jeudi 22 juin 2017 11:00:26 CEST Ritchie, Andrew wrote:
> From: Ritchie, Andrew <aritchie at usgs.gov>
> Date: Thu, Jun 22, 2017 at 10:30 AM
> Subject: NBITS=1 not preserved from vrt to tiff in multilayer tiff
> To: gdal-dev at lists.osgeo.org
> 
> 
> We are building TIFFs with fourteen layers, four of which are byte, and the
> remainder being binary. We are able to generate binary tiffs with NBITS=1
> and stack them with gdalbuildvrt -separate, but when muiltilayer tiffs are
> created with gdal_translate or gdal_merge -separate, the NBITS metadata are
> ignored and the resulting tiff has the same bit depth (byte) for all
> fourteen layers.
> 
> Is there a way to force NBITS per band with a -co NBITS=1 option when using
> gdal_merge with the -separate flag? alternatively, is there a way to force
> gdal_translate to honor the NBITS of the source layers in a VRT?

Andy,

NBITS metadata is honoured by the GeoTIFF driver if you translate the following single-band 
VRT

<VRTDataset rasterXSize="20" rasterYSize="20">
  <VRTRasterBand dataType="Byte" band="1">
    <Metadata domain="IMAGE_STRUCTURE">
      <MDI key="NBITS">1</MDI>
    </Metadata>
    <SimpleSource>
      <SourceFilename relativeToVRT="1">byte.tif</SourceFilename>
      <SourceBand>1</SourceBand>
      <SourceProperties RasterXSize="20" RasterYSize="20" DataType="Byte" BlockXSize="20" 
BlockYSize="20" />
      <SrcRect xOff="0" yOff="0" xSize="20" ySize="20" />
      <DstRect xOff="0" yOff="0" xSize="20" ySize="20" />
    </SimpleSource>
  </VRTRasterBand>
</VRTDataset>

However in the particular case you mention, multiple bands with different bit depth, there's 
nothing we can do. At least not easily.
In theory, the BitsPerSample tag could be used to record a different bit depth per band.
See http://www.awaresystems.be/imaging/tiff/tifftags/bitspersample.html
But the libtiff library used by GDAL (and lots of other software!) only support one single 
value (the first one).  So basically the GeoTIFF writer looks at the parameter of the first input 
band and use them to create the TIFF file.

One potential format candidate would be the HFA / Erdas Imagine format. From a quick test, 
it doesn't look that multiple bit depth is supported on writing write now by the driver (but I 
think it supports that on reading). I think this is a limitation that could be relatively easily 
removed.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170622/f952b67e/attachment.html>

From even.rouault at spatialys.com  Fri Jun 23 05:38:41 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 23 Jun 2017 14:38:41 +0200
Subject: [gdal-dev] GDAL 2.1.4 and 2.2.1 release candidates
Message-ID: <9926221.NiV82KH5br@even-i700>

Hi,

I have prepared a GDAL/OGR 2.1.4 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4RC1.tar.xz
  http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4RC1.tar.gz
  http://download.osgeo.org/gdal/2.1.4/gdal214RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.1.4/gdalautotest-2.1.4.tar.gz
  http://download.osgeo.org/gdal/2.1.4/gdalautotest-2.1.4.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.1.4-News

AND


I have prepared a GDAL/OGR 2.2.1 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1RC1.tar.xz
  http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1RC1.tar.gz
  http://download.osgeo.org/gdal/2.2.1/gdal221RC1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.2.1/gdalautotest-2.2.1.tar.gz
  http://download.osgeo.org/gdal/2.2.1/gdalautotest-2.2.1.zip

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.2.1-News


I'll call for a vote promoting them to final in the middle of next week if no
serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170623/60599509/attachment.html>

From jmckenna at gatewaygeomatics.com  Fri Jun 23 07:59:50 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Fri, 23 Jun 2017 11:59:50 -0300
Subject: [gdal-dev] GDAL 2.1.4 and 2.2.1 release candidates
In-Reply-To: <9926221.NiV82KH5br@even-i700>
References: <9926221.NiV82KH5br@even-i700>
Message-ID: <390436b5-fc69-dc12-1efa-42e8742fc7ea@gatewaygeomatics.com>

Initial testing going well with 2.2.1 on VisualStudio 2012.

-jeff





On 2017-06-23 9:38 AM, Even Rouault wrote:
> Hi,
> 
> I have prepared a GDAL/OGR 2.1.4 release candidate.
> 
> Peek up an archive among the following ones (by ascending size):
> 
> http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4RC1.tar.xz
> 
> http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4RC1.tar.gz
> 
> http://download.osgeo.org/gdal/2.1.4/gdal214RC1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
> http://download.osgeo.org/gdal/2.1.4/gdalautotest-2.1.4.tar.gz
> 
> http://download.osgeo.org/gdal/2.1.4/gdalautotest-2.1.4.zip
> 
> The NEWS file is here :
> 
> http://trac.osgeo.org/gdal/wiki/Release/2.1.4-News
> 
> AND
> 
> I have prepared a GDAL/OGR 2.2.1 release candidate.
> 
> Peek up an archive among the following ones (by ascending size):
> 
> http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1RC1.tar.xz
> 
> http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1RC1.tar.gz
> 
> http://download.osgeo.org/gdal/2.2.1/gdal221RC1.zip
> 
> A snapshot of the gdalautotest suite is also available :
> 
> http://download.osgeo.org/gdal/2.2.1/gdalautotest-2.2.1.tar.gz
> 
> http://download.osgeo.org/gdal/2.2.1/gdalautotest-2.2.1.zip
> 
> The NEWS file is here :
> 
> http://trac.osgeo.org/gdal/wiki/Release/2.2.1-News
> 
> I'll call for a vote promoting them to final in the middle of next week 
> if no
> 
> serious problems are reported before.
> 
> Best regards,
> 
> Even
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 

From jfuch at indec.mecon.gov.ar  Fri Jun 23 11:18:59 2017
From: jfuch at indec.mecon.gov.ar (Fuchs Juan Carlos)
Date: Fri, 23 Jun 2017 15:18:59 -0300
Subject: [gdal-dev] RV: question how to get spot and landsat share a common
	grid.
Message-ID: <1BB23056909B35408598895A19530483085DB2D2@indec2.mecon.ar>

Let us introduce ourselves, we are a GIS team of the Cartographic division
of INDEC (the national census buro of Argentina), we are working on the next
national Agricultural Census 2018, which will be carried out on Tablets with
Android O.S., running Leaflet to show the maps.

 

We have strong storage restrictions (SD 16 GB memory) and the hole program
(images included) has to run local on the tablet (no internet signal in the
most areas to be covered)

 

We get an province wide 30mts. LANDSAT mosaic, resampled at 15mts with the
monocromatic band (each pair: census tacker/tablet) are restricted to only
one province.

 

But for some zones (intensive agricultural use) we need SPOT 2,5 mts images.

 

We get to generate the tiled pyramid of the 15mts landsat, using GDAL
gdal2tile

gdal2tiles.py -t "BS AS" -c INDEC -z 0-8 -e -d -a 0 -p raster -v -s
EPSG:22185 -r cubic /BsAsGK5.tif /tiles_bs_as

 

After that we convert the png files to jpg, using :

find tiles_bsas -iname '.png' | while read i; do mogrify -format jpg "$i" &&
rm "$i"; echo "Converted $i to ${i%.}.jpg"; done

 

Here is our question: How should we generate the tiled pyramids of the 2,5
mts SPOT images in a way that both images use the same grid without
'resampling' the whole landsat to 2,5mts, of course, hoping to make one web
tile tree that goes down to 2.5 meters in some places, but only down to
15meters in other places. (as Frank Warmerdam clearly put out)

 

If you are willing to give us some advice, we will send you the link`s to
some sample images.

 

Link to LANDSAT 15mts. example (prov of BsAs) 6.5GB

Link to SPOT 2,5mts. example (Department of San Pedro) 2.3Gb

 

Thank`s in advance

JC

 

---------------------------------------------------------------------

Arqto. - Mgster.  Juan Carlos Fuchs
Sistema de Información Geográfica

Instructor y Soporte de Firma Digital
Instituto Nacional de Estadística y Censos - INDEC
Av. Julio A. Roca 609, 8° piso, of. 807/808 - CABA (1067)
Tel.: 54 11 4349-9704 - 4349-9702/03/05/06/08/00

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170623/a1fd5569/attachment.html>

From even.rouault at spatialys.com  Fri Jun 23 13:49:46 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 23 Jun 2017 22:49:46 +0200
Subject: [gdal-dev] RV: question how to get spot and landsat share a
	common grid.
In-Reply-To: <1BB23056909B35408598895A19530483085DB2D2@indec2.mecon.ar>
References: <1BB23056909B35408598895A19530483085DB2D2@indec2.mecon.ar>
Message-ID: <1973017.qmqnb0XeoT@even-i700>

Juan Carlos,

> 
> Here is our question: How should we generate the tiled pyramids of the 2,5
> mts SPOT images in a way that both images use the same grid without
> 'resampling' the whole landsat to 2,5mts, of course, hoping to make one web
> tile tree that goes down to 2.5 meters in some places, but only down to
> 15meters in other places. (as Frank Warmerdam clearly put out)

I don't think this is possible with a unmodified gdal2tiles (but I'm not a specialist of 
gdal2tiles, so I'd be happy to be corrected), at least not by having the 2.5 and 15m 
resolutions. The issue is that 15 / 2.5 = 6 which is not a power of 2, and as far as I know, 
gdal2tiles only knows to generate zoom levels that differ by power of twos.
A workaround would be to use a global tiling system like Google Maps, run gdal2tiles on your 
landsat and spot separately (which will cause resampling them to the closest pre-defined 
zoom level to their native resolution), and then copy the file tree structure of spot on top of 
landsat.

An enhanced gdal2tiles could possibly handle your case by generating a custom WMTS tiling 
scheme where you would define the zoom levels, but this has yet to be written.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170623/04da40b7/attachment.html>

From petr.pridal at klokantech.com  Mon Jun 26 23:14:15 2017
From: petr.pridal at klokantech.com (Petr Pridal)
Date: Tue, 27 Jun 2017 08:14:15 +0200
Subject: [gdal-dev] RV: question how to get spot and landsat share a
 common grid.
In-Reply-To: <1973017.qmqnb0XeoT@even-i700>
References: <1BB23056909B35408598895A19530483085DB2D2@indec2.mecon.ar>
 <1973017.qmqnb0XeoT@even-i700>
Message-ID: <CAH-RUCRgJbA3gB0QdqC5ZTjAwtiWftJu_7uuXwaexZRM+NAfUw@mail.gmail.com>

Juan,

> An enhanced gdal2tiles could possibly handle your case by generating a
custom WMTS tiling scheme where you would define the zoom levels, but this
has yet to be written.

MapTiler Pro is the enhanced GDAL2Tiles which is being actively developed
for years now - and it is able to do this (next to many other things - such
as boost in rendering speed, significantly smaller size of the produced
tiles, reprojection on the way, cutline clipping, palette expansion,
MBTiles output, WMTS compatibilty, support for native mobile apps, very
fast tile upload to S3/GCS, cluster processing mode, etc.).

If you want the .deb or .rpm instalers of MapTiler for your linux distro,
or the Windows or Mac binary, just fill the form at
http://www.maptiler.com/demo/.

You can also use the MapTiler Pro on a command line directly with this
docker command:
$ docker run -ti --rm -v $(pwd):/data klokantech/maptiler maptiler -help

See https://www.docker.com/ and  https://hub.docker.com/r/
klokantech/maptiler/ for more details. Files in local directory can be
processed easily on any computer where docker is installed - without a need
to resolve GDAL installation dependencies and proprietary drivers.

If you are limited by the size - I recommend to try rendering into WebP as
an alternative to JPEG. WebP can be made with option "-f webp" and it will
have half the size of JPEG tiles probably. Android tables should be able to
display these fine.

There is a manual describing the functionality of the MapTiler software:
http://manual.maptiler.com/.

If you render the Mercator tiles (and resample your rasters to more
detailed resolution - probably native zoom +1), then everything is done
with a single command on CLI.

If you really want to preserve the pixel perfect native resolution and
fiddle with dirrent grids and resolutions on different zoom levels, then
you may be interested in the advanced options at:
http://manual.maptiler.com/en/stable/usage.html#defining-a-
custom-tiling-profile-for-a-specified-coordinate-system

If you need help - just drop me an email. We can also render for you the
sample data if you upload them to https://www.klokantech.com/upload/ and
let me know.

Best regards,

Petr

P.S.
Recently we have also made a free mobile app for Android and iOS tables -
which displays GPS position on top of maps and can help to collect the
field data into GeoJSON - even offline. See: http://blog.klokantech.
com/2017/05/geoeditor-mobile-app-for-maptiler.html and
https://www.youtube.com/watch?v=OuoKvq03nNA

Disclaimer: I am the original author of GDAL2Tiles, and also the leader of
the team behind MapTiler Pro product, which is not open-source - but it is
fully powered by open-source components. We contribute back to GDAL (such
as with PDFium driver) and FOSS4G community (with EPSG.io, TileServer GL,
OpenMapTiles, WebGL Earth, and many other open-source projects and patches).
--
Petr Pridal, Ph.D.
CEO

Klokan Technologies GmbH
Hofnerstrasse 98, 6314 Unterageri, Switzerland
Tel: +41 (0)41 511 26 12 <041%20511%2026%2012>
Email: info at klokantech.com
Web: http://www.klokantech.com/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170627/873cc71c/attachment.html>

From mofoyoda at gmail.com  Tue Jun 27 00:01:11 2017
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Tue, 27 Jun 2017 10:01:11 +0300
Subject: [gdal-dev] Adding "Constant width" to LWPOLYLINE objects for DXF
	driver
Message-ID: <7D783CBF-CACE-4908-BC70-9AFA0399BE9C@gmail.com>

Hello,

I’d like to add a parser for Constant width property to LWPOLYLINE objects for DXF driver.
The property has no.43 according to the autodesk DXF format specification:
https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.htm <https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.htm>

My initial idea was to add it as a pen width (“w”) to an OGR style string, but that property is already taken by LineWeight DXF property.
I’m ok with putting Constant width to the style string when LineWeight = 0 (since my data contains either Lineweight or Constant width) but that’s not a generic solution.
So what is the suitable place to put this property to?

Cheers,
Nick

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170627/72d41872/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Jun 27 00:34:59 2017
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 27 Jun 2017 07:34:59 +0000
Subject: [gdal-dev] Interesting issue with ogr2ogr and -tps
Message-ID: <083ef8a826e641e2b17709a5121ac267@C119S212VM042.msvyvi.vaha.local>

Hi,

There is a well written question in gis.stackexchange about how the -tps option in ogr2ogr behaves https://gis.stackexchange.com/questions/245391/ogr2org-tps-spline-method-creates-progressive-error

Does anybody have a clue about what happens?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170627/515a2ded/attachment.html>

From even.rouault at spatialys.com  Tue Jun 27 04:58:14 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Jun 2017 13:58:14 +0200
Subject: [gdal-dev] Interesting issue with ogr2ogr and -tps
In-Reply-To: <083ef8a826e641e2b17709a5121ac267@C119S212VM042.msvyvi.vaha.local>
References: <083ef8a826e641e2b17709a5121ac267@C119S212VM042.msvyvi.vaha.local>
Message-ID: <1622545.3QpZCzHrot@even-i700>

On mardi 27 juin 2017 07:34:59 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> There is a well written question in gis.stackexchange about how the -tps
> option in ogr2ogr behaves
> https://gis.stackexchange.com/questions/245391/ogr2org-tps-spline-method-cr
> eates-progressive-error
> 
> Does anybody have a clue about what happens?

TPS is supposed to be exact at GCP, and interpolate between them. That said, it looks from 
this report like there might be a numerical stability issue. There are 2 solvers for the TPS 
transformer: a built-in that does matrix inversion "at hand" using Gauss-Jordan elimination 
method (the one that is taught at school if I remember well -:) ), and another one that uses 
the armadillo library that is faster and relates underneath on well proven numerical 
computation libraries (blas/lapack). I don't think osgeo4w builds use armadillo (actually I 
don't see anything in the nmake.opt related to armadillo).
That said, I see that the Gauss-Jordan implementation usd uses the "partial pivonting" 
mentionned in
https://en.wikipedia.org/wiki/Pivot_element#Partial_and_complete_pivoting so this should 
normally account for most numerical stabilities issues.
So either the user is rather unlikely and has encountered a case where numerical instability 
occur, either his test/GCPs are wrong.
And I wouldn't have anticipated that numerical stabilities issues have such a north-to-south 
pattern, but perhaps...

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170627/241190c7/attachment-0001.html>

From even.rouault at spatialys.com  Tue Jun 27 05:35:37 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 27 Jun 2017 14:35:37 +0200
Subject: [gdal-dev] Adding "Constant width" to LWPOLYLINE objects for
	DXF driver
In-Reply-To: <7D783CBF-CACE-4908-BC70-9AFA0399BE9C@gmail.com>
References: <7D783CBF-CACE-4908-BC70-9AFA0399BE9C@gmail.com>
Message-ID: <9370268.Y2K4vQAnb9@even-i700>

On mardi 27 juin 2017 10:01:11 CEST Nikolai Bezdna wrote:
> Hello,
> 
> I’d like to add a parser for Constant width property to LWPOLYLINE objects
> for DXF driver. The property has no.43 according to the autodesk DXF format
> specification:
> https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.ht
> m
> <https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.h
> tm>
> 
> My initial idea was to add it as a pen width (“w”) to an OGR style string,
> but that property is already taken by LineWeight DXF property. I’m ok with
> putting Constant width to the style string when LineWeight = 0 (since my
> data contains either Lineweight or Constant width) but that’s not a generic
> solution. So what is the suitable place to put this property to?

Nick,

I'm wondering if we couldn't add in the layer definition a new OGR attribute RawCodeValues 
whose content would be "code=value[,code=value]*". Only for non repeated attributes (ie 
not for the vertices of a line), and probably only for the ones that are not already handled by 
OGR. Not particularly user friendly admitedly, but this would at least be generic for advanced 
uses.
Could potentially be used on the writing side if a user needs to add a specific DXF property.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170627/a0be4c61/attachment.html>

From even.rouault at spatialys.com  Wed Jun 28 01:47:11 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jun 2017 10:47:11 +0200
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
Message-ID: <4901740.IzFs0eODms@even-i700>

Hi,

Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.

Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
---

+1 to both: Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170628/4de8ebd3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jun 28 03:40:51 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 28 Jun 2017 03:40:51 -0700 (MST)
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <4901740.IzFs0eODms@even-i700>
References: <4901740.IzFs0eODms@even-i700>
Message-ID: <1498646451665-5325822.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
> 
> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
> ---
> 
> +1 to both: Even

+1 to both.

-Jukka Rahkonen-




--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-Motions-Promote-2-1-4RC1-and-2-2-1RC1-for-release-tp5325801p5325822.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun 28 05:10:17 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jun 2017 14:10:17 +0200
Subject: [gdal-dev] gdaladdo without explicit factors specified
Message-ID: <1882234.ajV6qkJ4KS@even-i700>

Hi,

I'm pretty sure this must have annoyed a lot of people. When you run gdaladdo, you need to 
specify the appropriate overview levels. Generally you use power-of-two factors, but the 
question is then: what is the last relevant factor given the dimension of my file size ? 

I've a ready to commit improvement where you can just do :
gdaladdo [other options] my.tif
and it will compute the appropriate power of two factors until the smallest overview is 
smaller or equal to 256x256 (this threshould can be adjusted with a new -minsize switch. 
Actually it should be named -maxminsize, since this is the maximum size of the smallest 
overview, but I guess -minsize will be clear enough)

The effect of this patch is the same as specifying manually all the overview factors implicitly 
computed. That means existing overview levels will be recomputed if their factor match one 
of the implicitly computed factors. Or they will be left unchanged if not matching one of the 
implictly computed overview factors.

Thoughts ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170628/4b91260d/attachment.html>

From jmckenna at gatewaygeomatics.com  Wed Jun 28 05:27:32 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 28 Jun 2017 09:27:32 -0300
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <4901740.IzFs0eODms@even-i700>
References: <4901740.IzFs0eODms@even-i700>
Message-ID: <e2f545de-8fe5-e18b-93a3-5c312cfcd03a@gatewaygeomatics.com>

On 2017-06-28 5:47 AM, Even Rouault wrote:
> Hi,
> 
> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
> 
> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
> 
> ---
> 

+1 jeff





From andrea.aime at geo-solutions.it  Wed Jun 28 05:30:51 2017
From: andrea.aime at geo-solutions.it (Andrea Aime)
Date: Wed, 28 Jun 2017 14:30:51 +0200
Subject: [gdal-dev] gdaladdo without explicit factors specified
In-Reply-To: <1882234.ajV6qkJ4KS@even-i700>
References: <1882234.ajV6qkJ4KS@even-i700>
Message-ID: <CA+nxMTu2-7SUtSL==ufUT3GaZB_jXsZC1FF1JW+NeuDq-b5Hsg@mail.gmail.com>

On Wed, Jun 28, 2017 at 2:10 PM, Even Rouault <even.rouault at spatialys.com>
wrote:

> Thoughts ?
>

/me likes :-)

-- 

Regards,

Andrea Aime

==
GeoServer Professional Services from the experts! Visit http://goo.gl/it488V
for more information.
==

Ing. Andrea Aime
@geowolf
Technical Lead

GeoSolutions S.A.S.
Via di Montramito 3/A
55054  Massarosa (LU)
phone: +39 0584 962313
fax: +39 0584 1660272
mob: +39  339 8844549

http://www.geo-solutions.it
http://twitter.com/geosolutions_it

AVVERTENZE AI SENSI DEL D.Lgs. 196/2003

Le informazioni contenute in questo messaggio di posta elettronica e/o
nel/i file/s allegato/i sono da considerarsi strettamente riservate. Il
loro utilizzo è consentito esclusivamente al destinatario del messaggio,
per le finalità indicate nel messaggio stesso. Qualora riceviate questo
messaggio senza esserne il destinatario, Vi preghiamo cortesemente di
darcene notizia via e-mail e di procedere alla distruzione del messaggio
stesso, cancellandolo dal Vostro sistema. Conservare il messaggio stesso,
divulgarlo anche in parte, distribuirlo ad altri soggetti, copiarlo, od
utilizzarlo per finalità diverse, costituisce comportamento contrario ai
principi dettati dal D.Lgs. 196/2003.

The information in this message and/or attachments, is intended solely for
the attention and use of the named addressee(s) and may be confidential or
proprietary in nature or covered by the provisions of privacy act
(Legislative Decree June, 30 2003, no.196 - Italy's New Data Protection
Code).Any use not in accord with its purpose, any disclosure, reproduction,
copying, distribution, or either dissemination, either whole or partial, is
strictly forbidden except previous formal approval of the named
addressee(s). If you are not the intended recipient, please contact
immediately the sender by telephone, fax or e-mail and delete the
information in this message that has been received in error. The sender
does not give any warranty or accept liability as the content, accuracy or
completeness of sent messages and accepts no responsibility  for changes
made after they were sent or for other risks which arise as a result of
e-mail transmission, viruses, etc.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170628/7dd77dad/attachment.html>

From jmckenna at gatewaygeomatics.com  Wed Jun 28 05:38:06 2017
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Wed, 28 Jun 2017 09:38:06 -0300
Subject: [gdal-dev] gdaladdo without explicit factors specified
In-Reply-To: <1882234.ajV6qkJ4KS@even-i700>
References: <1882234.ajV6qkJ4KS@even-i700>
Message-ID: <17ad0c64-addf-a665-bfc3-e643fa240581@gatewaygeomatics.com>

On 2017-06-28 9:10 AM, Even Rouault wrote:
> Hi,
> 
> I'm pretty sure this must have annoyed a lot of people. When you run 
> gdaladdo, you need to specify the appropriate overview levels. Generally 
> you use power-of-two factors, but the question is then: what is the last 
> relevant factor given the dimension of my file size ?
> 
> I've a ready to commit improvement where you can just do :
> 
> gdaladdo [other options] my.tif
> 
> and it will compute the appropriate power of two factors until the 
> smallest overview is smaller or equal to 256x256 (this threshould can be 
> adjusted with a new -minsize switch. Actually it should be named 
> -maxminsize, since this is the maximum size of the smallest overview, 
> but I guess -minsize will be clear enough)
> 
> The effect of this patch is the same as specifying manually all the 
> overview factors implicitly computed. That means existing overview 
> levels will be recomputed if their factor match one of the implicitly 
> computed factors. Or they will be left unchanged if not matching one of 
> the implictly computed overview factors.
> 
> Thoughts ?
> 

I agree with Andrea.  I've been copy/pasting the command with the 
power-of-2 levels for almost 2 decades it seems ha, and I am sure 99% of 
the users do the same.  This is a great addition!

-jeff




From mofoyoda at gmail.com  Wed Jun 28 05:40:50 2017
From: mofoyoda at gmail.com (Nikolai Bezdna)
Date: Wed, 28 Jun 2017 15:40:50 +0300
Subject: [gdal-dev] Adding "Constant width" to LWPOLYLINE objects for	
	DXF driver
In-Reply-To: <mailman.13.1498590002.8605.gdal-dev@lists.osgeo.org>
References: <mailman.13.1498590002.8605.gdal-dev@lists.osgeo.org>
Message-ID: <55ACBD09-708D-4392-9AF0-32478F4E0D59@gmail.com>

Even, 

RawCodeValues field seems ok to me.

1. Should it be of JSON type or a plain string?

2. Where in the code should I add this field it to use it later in DXF driver?
Or is it already there?

Sorry, not yet familiar enough with gdal codebase. Examining docs now.

Nick

> 
> On mardi 27 juin 2017 10:01:11 CEST Nikolai Bezdna wrote:
>> Hello,
>> 
>> I’d like to add a parser for Constant width property to LWPOLYLINE objects
>> for DXF driver. The property has no.43 according to the autodesk DXF format
>> specification:
>> https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.ht
>> m
>> <https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.h
>> tm>
>> 
>> My initial idea was to add it as a pen width (“w”) to an OGR style string,
>> but that property is already taken by LineWeight DXF property. I’m ok with
>> putting Constant width to the style string when LineWeight = 0 (since my
>> data contains either Lineweight or Constant width) but that’s not a generic
>> solution. So what is the suitable place to put this property to?
> 
> Nick,
> 
> I'm wondering if we couldn't add in the layer definition a new OGR attribute RawCodeValues 
> whose content would be "code=value[,code=value]*". Only for non repeated attributes (ie 
> not for the vertices of a line), and probably only for the ones that are not already handled by 
> OGR. Not particularly user friendly admitedly, but this would at least be generic for advanced 
> uses.
> Could potentially be used on the writing side if a user needs to add a specific DXF property.
> 
> Even
> 


From even.rouault at spatialys.com  Wed Jun 28 06:02:56 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jun 2017 15:02:56 +0200
Subject: [gdal-dev] Adding "Constant width" to LWPOLYLINE objects for	
	DXF driver
In-Reply-To: <55ACBD09-708D-4392-9AF0-32478F4E0D59@gmail.com>
References: <mailman.13.1498590002.8605.gdal-dev@lists.osgeo.org>
 <55ACBD09-708D-4392-9AF0-32478F4E0D59@gmail.com>
Message-ID: <5998844.9c29AHvASE@even-i700>

On mercredi 28 juin 2017 15:40:50 CEST Nikolai Bezdna wrote:
> Even,
> 
> RawCodeValues field seems ok to me.
> 
> 1. Should it be of JSON type or a plain string?

Good question

I'd hava said a plain string, unless we anticipate that comma might be a valid value. But JSon might also
make sense. Actually we could extend the OGRFieldSubType enumeration to have a
OFSTJSon value that would apply to the OFTString type.

(The closest thing I can think of is in the OSM driver where the other_fields field content,
which is also a dictionary, is exposed as a serialiezd Postgres HSTORE column. But
really OSM -> PG ingestion is a common use case, and it made sense to do that that way. And
at that time JSONB didn't exist as a PG type, otherwise we might have used it instead of HSTORE. And I don't
think this would make sense to reuse HSTORE for the DXF driver.)

> 
> 2. Where in the code should I add this field it to use it later in DXF
> driver? 

In https://github.com/OSGeo/gdal/blob/trunk/gdal/ogr/ogrsf_frmts/dxf/ogrdxfdatasource.cpp#L630

> 
> Sorry, not yet familiar enough with gdal codebase. Examining docs now.
> 
> Nick
> 
> > On mardi 27 juin 2017 10:01:11 CEST Nikolai Bezdna wrote:
> >> Hello,
> >> 
> >> I’d like to add a parser for Constant width property to LWPOLYLINE
> >> objects
> >> for DXF driver. The property has no.43 according to the autodesk DXF
> >> format
> >> specification:
> >> https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06.
> >> ht
> >> m
> >> <https://www.autodesk.com/techpubs/autocad/acad2000/dxf/lwpolyline_dxf_06
> >> .h
> >> tm>
> >> 
> >> My initial idea was to add it as a pen width (“w”) to an OGR style
> >> string,
> >> but that property is already taken by LineWeight DXF property. I’m ok
> >> with
> >> putting Constant width to the style string when LineWeight = 0 (since my
> >> data contains either Lineweight or Constant width) but that’s not a
> >> generic
> >> solution. So what is the suitable place to put this property to?
> > 
> > Nick,
> > 
> > I'm wondering if we couldn't add in the layer definition a new OGR
> > attribute RawCodeValues whose content would be
> > "code=value[,code=value]*". Only for non repeated attributes (ie not for
> > the vertices of a line), and probably only for the ones that are not
> > already handled by OGR. Not particularly user friendly admitedly, but
> > this would at least be generic for advanced uses.
> > Could potentially be used on the writing side if a user needs to add a
> > specific DXF property.
> > 
> > Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170628/1306c354/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Jun 28 08:08:11 2017
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 28 Jun 2017 08:08:11 -0700 (MST)
Subject: [gdal-dev] gdaladdo without explicit factors specified
In-Reply-To: <1882234.ajV6qkJ4KS@even-i700>
References: <1882234.ajV6qkJ4KS@even-i700>
Message-ID: <1498662491486-5325875.post@n6.nabble.com>

Even Rouault-2 wrote
> Hi,
> 
> I'm pretty sure this must have annoyed a lot of people. When you run
> gdaladdo, you need to 
> specify the appropriate overview levels. Generally you use power-of-two
> factors, but the 
> question is then: what is the last relevant factor given the dimension of
> my file size ? 
> ...
> 
> Thoughts ?

Excellent idea especially because it works in scripts also with variable
sized images. My second thought is that is there any living soul in the
World who can memorize "--config COMPRESS_OVERVIEW JPEG --config
PHOTOMETRIC_OVERVIEW YCBCR --config INTERLEAVE_OVERVIEW PIXEL" without going
to http://www.gdal.org/gdaladdo.html or by re-using their old scripts?

-Jukka Rahkonen-



--
View this message in context: http://osgeo-org.1560.x6.nabble.com/gdal-dev-gdaladdo-without-explicit-factors-specified-tp5325832p5325875.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Wed Jun 28 08:38:30 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 28 Jun 2017 17:38:30 +0200
Subject: [gdal-dev] gdaladdo without explicit factors specified
In-Reply-To: <1882234.ajV6qkJ4KS@even-i700>
References: <1882234.ajV6qkJ4KS@even-i700>
Message-ID: <3441528.vqU9zYWWoT@even-i700>

On mercredi 28 juin 2017 14:10:17 CEST Even Rouault wrote:
> Hi,
> 
> I'm pretty sure this must have annoyed a lot of people. When you run
> gdaladdo, you need to specify the appropriate overview levels. Generally
> you use power-of-two factors, but the question is then: what is the last
> relevant factor given the dimension of my file size ?
> 
> I've a ready to commit improvement where you can just do :
> gdaladdo [other options] my.tif
> and it will compute the appropriate power of two factors until the smallest
> overview is smaller or equal to 256x256 (this threshould can be adjusted
> with a new -minsize switch. Actually it should be named -maxminsize, since
> this is the maximum size of the smallest overview, but I guess -minsize
> will be clear enough)
> 
> The effect of this patch is the same as specifying manually all the overview
> factors implicitly computed. That means existing overview levels will be
> recomputed if their factor match one of the implicitly computed factors. Or
> they will be left unchanged if not matching one of the implictly computed
> overview factors.
> 
> Thoughts ?

Just committed into trunk

> 
> Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170628/d77eb67e/attachment-0001.html>

From dmorissette at mapgears.com  Wed Jun 28 12:59:26 2017
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 28 Jun 2017 15:59:26 -0400
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <4901740.IzFs0eODms@even-i700>
References: <4901740.IzFs0eODms@even-i700>
Message-ID: <0861ad51-6d30-c9b6-1faa-d624c44732e1@mapgears.com>

+1

Daniel

On 2017-06-28 4:47 AM, Even Rouault wrote:
> Hi,
> 
> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
> 
> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
> 
> ---
> 
> +1 to both: Even
> 
> -- 
> 
> Spatialys - Geospatial professional services
> 
> http://www.spatialys.com
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From sean at mapbox.com  Thu Jun 29 08:20:48 2017
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 29 Jun 2017 17:20:48 +0200
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <0861ad51-6d30-c9b6-1faa-d624c44732e1@mapgears.com>
References: <4901740.IzFs0eODms@even-i700>
 <0861ad51-6d30-c9b6-1faa-d624c44732e1@mapgears.com>
Message-ID: <CADPhZXyspf4wziz=oatXQNtzcSqQ1YN=Jzb1jw=pxbnfJKUq4g@mail.gmail.com>

FWIW, I built Rasterio with GDAL2.2.1RC1 and its tests pass. Thanks, Even!

On Wed, Jun 28, 2017 at 9:59 PM, Daniel Morissette <dmorissette at mapgears.com
> wrote:

> +1
>
> Daniel
>
>
> On 2017-06-28 4:47 AM, Even Rouault wrote:
>
>> Hi,
>>
>> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
>>
>> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
>>
>> ---
>>
>> +1 to both: Even
>>
>> --
>>
>> Spatialys - Geospatial professional services
>>
>> http://www.spatialys.com
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170629/9341d2c8/attachment.html>

From howard at hobu.co  Thu Jun 29 09:39:21 2017
From: howard at hobu.co (Howard Butler)
Date: Thu, 29 Jun 2017 11:39:21 -0500
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <0861ad51-6d30-c9b6-1faa-d624c44732e1@mapgears.com>
References: <4901740.IzFs0eODms@even-i700>
 <0861ad51-6d30-c9b6-1faa-d624c44732e1@mapgears.com>
Message-ID: <F606D544-A1F1-4EE7-B2CF-17FA8F80A878@hobu.co>

+1

Howard

> On Jun 28, 2017, at 2:59 PM, Daniel Morissette <dmorissette at mapgears.com> wrote:
> 
> +1
> 
> Daniel
> 
> On 2017-06-28 4:47 AM, Even Rouault wrote:
>> Hi,
>> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
>> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
>> ---
>> +1 to both: Even
>> -- 
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> -- 
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From bfraser at geoanalytic.com  Thu Jun 29 10:34:21 2017
From: bfraser at geoanalytic.com (Brent Fraser)
Date: Thu, 29 Jun 2017 11:34:21 -0600
Subject: [gdal-dev] Problem in ogr converting polygon coverages
Message-ID: <6593d661-b8e9-e100-533a-fc23119c5a88@geoanalytic.com>

Hi all,

I'm having trouble with OGR converting ESRI polygon coverages to 
shapefiles.  Basically the newer versions of ogr ignore the attributes 
on the polygons and show only the ArcIds attribute. Looks like a bug 
possibly introduced during RFC 50 
(https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype).

   If there is a option to the command line to fix this, please let me 
know, otherwise I'll file a bug report.

Details:

Ogrinfo in GDAL version 1.11.0 works fine (note all the attributes after 
ArcIds):
========================================================
C:\Projects>C:\Programs\gdal-1-11-0-mapserver-6-4-1\bin\ogrinfo.exe 
--version
GDAL 1.11.0, released 2014/04/16

C:\Projects>C:\Programs\gdal-1-11-0-mapserver-6-4-1\bin\ogrinfo -geom=no 
ea_20090105 PAL | more
Had to open data source read-only.
INFO: Open of `ea_20090105'
       using driver `AVCBin' successful.

Layer name: PAL
Geometry: Polygon
Feature Count: 467
Extent: (-195031.966405, 2723260.836220) - (1970740.118994, 5186575.947505)
Layer SRS WKT:
     :

ArcIds: IntegerList (0.0)
AREA: Real (18.5)
PERIMETER: Real (18.5)
EA_20090105#: Integer (5.0)
EA_20090105-ID: Integer (5.0)
A_LEGEND: String (11.0)
REGION: String (2.0)
DATE_CARTE: String (10.0)
SOURCE: String (5.0)
MOD: String (1.0)
EGG_ID: Integer (5.0)
PNT_TYPE: Integer (3.0)
EGG_NAME: String (2.0)
EGG_SCALE: Integer (5.0)
EGG_ATTR: String (49.0)
USER_ATTR: String (49.0)
ROTATION: Integer (3.0)
E_CT: String (2.0)
E_CA: String (1.0)
E_CB: String (1.0)
     :

========================================================
while GDAL version 2.1.3 just shows the ArcIds attribute:

C:\Projects>ogrinfo.exe --version
GDAL 2.1.3, released 2017/20/01

C:\Projects>ogrinfo -geom=no ea_20090105 PAL | more
Had to open data source read-only.
INFO: Open of `ea_20090105'
       using driver `AVCBin' successful.

Layer name: PAL
Geometry: Polygon
Feature Count: 467
Extent: (-195031.966405, 2843291.569215) - (1870695.841972, 4961994.591590)
Layer SRS WKT:
     :

ArcIds: IntegerList (0.0)
OGRFeature(PAL):2
   ArcIds (IntegerList) = 
(146:883,-893,-889,-868,-890,-898,-886,-885,-880,-875,-854,-856,-841,-840,...)

OGRFeature(PAL):3
   ArcIds (IntegerList) = (5:1,12,14,15,2)

==============================================================
To try it out, download the e00 file:
http://ice-glaces.ec.gc.ca//www_archive/AOI_11/Coverages/rgc_a11_20090105_CEXPREA.e00

and use "avcimport" to convert it to a coverage
avcimport gc_a11_20090105_CEXPREA.e00 ea_20090105
then use the ogrinfo command shown above.


-- 
Best Regards,
Brent Fraser



From even.rouault at spatialys.com  Thu Jun 29 12:28:19 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Jun 2017 21:28:19 +0200
Subject: [gdal-dev] Problem in ogr converting polygon coverages
In-Reply-To: <6593d661-b8e9-e100-533a-fc23119c5a88@geoanalytic.com>
References: <6593d661-b8e9-e100-533a-fc23119c5a88@geoanalytic.com>
Message-ID: <3547403.JMBAOuUl3g@even-i700>

Brent,

> 
> I'm having trouble with OGR converting ESRI polygon coverages to
> shapefiles.  Basically the newer versions of ogr ignore the attributes
> on the polygons and show only the ArcIds attribute. Looks like a bug
> possibly introduced during RFC 50
> (https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype).

I don't think this is related. More likely a regression caused by a code cleanup/hardening.

> 
>    If there is a option to the command line to fix this, please let me
> know, otherwise I'll file a bug report.

Please file a bug report

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170629/913e4d0e/attachment.html>

From even.rouault at spatialys.com  Thu Jun 29 13:28:43 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 29 Jun 2017 22:28:43 +0200
Subject: [gdal-dev] Problem in ogr converting polygon coverages
In-Reply-To: <3547403.JMBAOuUl3g@even-i700>
References: <6593d661-b8e9-e100-533a-fc23119c5a88@geoanalytic.com>
 <3547403.JMBAOuUl3g@even-i700>
Message-ID: <3473595.By69eePQxy@even-i700>

On jeudi 29 juin 2017 21:28:19 CEST Even Rouault wrote:
> Brent,
> 
> > I'm having trouble with OGR converting ESRI polygon coverages to
> > shapefiles.  Basically the newer versions of ogr ignore the attributes
> > on the polygons and show only the ArcIds attribute. Looks like a bug
> > possibly introduced during RFC 50
> > (https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype).
> 
> I don't think this is related. More likely a regression caused by a code
> cleanup/hardening.
> >    If there is a option to the command line to fix this, please let me
> > 
> > know, otherwise I'll file a bug report.
> 
> Please file a bug report

Actually I've just done it with https://trac.osgeo.org/gdal/ticket/6950 and committed the fix.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170629/3514f2e2/attachment.html>

From bfraser at GeoAnalytic.com  Thu Jun 29 15:55:39 2017
From: bfraser at GeoAnalytic.com (Brent Fraser)
Date: Thu, 29 Jun 2017 16:55:39 -0600
Subject: [gdal-dev] Problem in ogr converting polygon coverages
In-Reply-To: <3473595.By69eePQxy@even-i700>
References: <6593d661-b8e9-e100-533a-fc23119c5a88@geoanalytic.com>
 <3547403.JMBAOuUl3g@even-i700> <3473595.By69eePQxy@even-i700>
Message-ID: <ddbfae60db884828a1d4d457d9da1a63@GeoAnalytic.com>

You're awesome Even!  Thanks!
  
 Brent
  
  
  

----------------------------------------
 From: "Even Rouault" <even.rouault at spatialys.com>
Sent: Thursday, June 29, 2017 2:29 PM
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Problem in ogr converting polygon coverages   

On jeudi 29 juin 2017 21:28:19 CEST Even Rouault wrote:  

> Brent,  

>  

> > I'm having trouble with OGR converting ESRI polygon coverages to  

> > shapefiles. Basically the newer versions of ogr ignore the attributes  


> > on the polygons and show only the ArcIds attribute. Looks like a bug  

> > possibly introduced during RFC 50  

> > (https://trac.osgeo.org/gdal/wiki/rfc50_ogr_field_subtype).  

>  

> I don't think this is related. More likely a regression caused by a code  


> cleanup/hardening.  

> > If there is a option to the command line to fix this, please let me  

> >  

> > know, otherwise I'll file a bug report.  

>  

> Please file a bug report  

   

Actually I've just done it with https://trac.osgeo.org/gdal/ticket/6950 and 
committed the fix.  

   

Even  

   

--  

Spatialys - Geospatial professional services  

http://www.spatialys.com 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170629/6484f92d/attachment.html>

From even.rouault at spatialys.com  Fri Jun 30 03:02:13 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Jun 2017 12:02:13 +0200
Subject: [gdal-dev] Motions: Promote 2.1.4RC1 and 2.2.1RC1 for release
In-Reply-To: <4901740.IzFs0eODms@even-i700>
References: <4901740.IzFs0eODms@even-i700>
Message-ID: <3372352.C83mdBWhKL@even-i700>

On mercredi 28 juin 2017 10:47:11 CEST Even Rouault wrote:
> Hi,
> 
> Motion 1: GDAL/OGR 2.1.4RC1 is promoted to be the official 2.1.4 release.
> 
> Motion 2: GDAL/OGR 2.2.1RC1 is promoted to be the official 2.2.1 release.
> ---
> 

Those motions have passed with +1 from PSC members JukkaR, DanielM, HowardB 
and myself, and support from community members JeffM and SeanG.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170630/cdbb7b4a/attachment.html>

From even.rouault at spatialys.com  Fri Jun 30 03:26:42 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Jun 2017 12:26:42 +0200
Subject: [gdal-dev] GDAL/OGR 2.2.1 and 2.1.4 are released
Message-ID: <11024948.OQmd95KDIC@even-i700>

Hi,

On behalf of the GDAL/OGR development team, I am pleased to announce the release of the 
GDAL/OGR 2.2.1 and 2.1.4 bug fix versions. 

Consult their release notes for the list of issues addressed :
  https://trac.osgeo.org/gdal/wiki/Release/2.2.1-News
  https://trac.osgeo.org/gdal/wiki/Release/2.1.4-News

The sources are available at:

GDAL 2.2.1:
  http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1.tar.xz
  http://download.osgeo.org/gdal/2.2.1/gdal-2.2.1.tar.gz
  http://download.osgeo.org/gdal/2.2.1/gdal221.zip

GDAL 2.1.4:
  http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4.tar.xz
  http://download.osgeo.org/gdal/2.1.4/gdal-2.1.4.tar.gz
  http://download.osgeo.org/gdal/2.1.4/gdal214.zip

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170630/ce88fe13/attachment-0001.html>

From Anna-Lena.Hock at bkg.bund.de  Fri Jun 30 04:52:26 2017
From: Anna-Lena.Hock at bkg.bund.de (Anna-Lena.Hock at bkg.bund.de)
Date: Fri, 30 Jun 2017 11:52:26 +0000
Subject: [gdal-dev] Gdal_retile - overviews - incremental updates
Message-ID: <6664547A76ECDC4589407BCD66203B73A3AED225@lsv819.bkg>

Hello,

currently I am building overviews with gdal_retile for a bunch of tiled rasters - the overviews are stored in geotiff for each level  in a separate folder 1, 2, 3, 4.

I am quite happy with the performance of the format on geoserver, but I think there is a problem with updates. Usually just some rasters get an update - the rest remains the same. So I want to recalculate only some rasters and all the overviews of those.

I couldn't find a way to recalculate only a part of a the gdal_retile output - it's always adding new geotiffs instead of overwriting the existing ones.  I thought maybe gdalddo is an alternative to gdal_retile for the updates, but as far as I see it's not possible to create a pyramid with external tif files (not ovr).

So, my question is: Is there a possibility to recalculate a part of a pyramid created with gdal_retile?

Thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170630/a4f51db3/attachment.html>

From osahon.gis at gmail.com  Fri Jun 30 08:15:54 2017
From: osahon.gis at gmail.com (Osahon Oduware)
Date: Fri, 30 Jun 2017 16:15:54 +0100
Subject: [gdal-dev] GDAL Support For PostGIS Out-DB Raster
Message-ID: <CAGpiUSjeZbxb0RbKDsshn-FGXfWR2tC1koamn44FVk-6DFj-Kw@mail.gmail.com>

Hi All,

Currently, GDAL seems not to support PostGIS Out-DB raster as QGIS
struggles to display such raster as described in my post in the link below:
http://osgeo-org.1560.x6.nabble.com/QGIS-GDAL-OUT-DB-RASTER-SUPPORT-td5318735.html

*Please, I wanted to find out if there is any ongoing work towards
providing GDAL support for PostGIS Out-DB raster.*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170630/9e3893c2/attachment.html>

From luc.vanlinden at gmail.com  Fri Jun 30 08:51:19 2017
From: luc.vanlinden at gmail.com (lucvanlinden)
Date: Fri, 30 Jun 2017 08:51:19 -0700 (MST)
Subject: [gdal-dev] ogr2ogr sqlite to spatialite (retain views as views)
Message-ID: <1498837879788-5326273.post@n6.nabble.com>

Hi

I was testing the ogr2ogr from sqlite to spatialite.

The sqlite source file is an FDO type (with geometry_columns &
spatial_ref_sys tables). 
Also the encoding is FGF, but we know ogr can deal with this.

Our sqlite file has spatial tables and non spatial tables.
We have the config options SQLITE_LIST_ALL_TABLES set in the windows
variables.

The sqlitefile contains views (spatial and non spatial view).

The spatial views have an entry in geometry_columns metadata table.

Running the OGR2OGR -f sqlite targetfile sourcefile -dsco SPATIALITE=YES we
noticed:

- the views become populated tables (and not views anymore)
- the ex-spatial-view tables (source spatial view now table) are properly
created as spatial tables
- the ex spatial tables re converted as ordanary tables with "fdo_' prefix,
no entry in the geometry columns, although the geomtry is correctly encoded.

- a side effect it seems to have difficulties with FID columns in the views
(used -unsetFID to bypass but are still wondered)

My question short is how to use ogr2ogr to properly change an (fdo) sqlite
file to spatial lite?
How to do this when having spatial and non-spatial tables?
How to do this when having spatial views and non-spatial views?

should this not be possible straightforward, it would be helpfull to know
the limitations, constraints and possible workarounds or post process steps,
would they be required.

Thanks and regards

Luc








--
View this message in context: http://osgeo-org.1560.x6.nabble.com/ogr2ogr-sqlite-to-spatialite-retain-views-as-views-tp5326273.html
Sent from the GDAL - Dev mailing list archive at Nabble.com.

From even.rouault at spatialys.com  Fri Jun 30 09:25:27 2017
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 30 Jun 2017 18:25:27 +0200
Subject: [gdal-dev] ogr2ogr sqlite to spatialite (retain views as views)
In-Reply-To: <1498837879788-5326273.post@n6.nabble.com>
References: <1498837879788-5326273.post@n6.nabble.com>
Message-ID: <8377632.QyYC8bmj22@even-i700>

Luc,

> I was testing the ogr2ogr from sqlite to spatialite.
> 
> The sqlite source file is an FDO type (with geometry_columns &
> spatial_ref_sys tables).
> Also the encoding is FGF, but we know ogr can deal with this.
> 
> Our sqlite file has spatial tables and non spatial tables.
> We have the config options SQLITE_LIST_ALL_TABLES set in the windows
> variables.
> 
> The sqlitefile contains views (spatial and non spatial view).
> 
> The spatial views have an entry in geometry_columns metadata table.
> 
> Running the OGR2OGR -f sqlite targetfile sourcefile -dsco SPATIALITE=YES we
> noticed:
> 
> - the views become populated tables (and not views anymore)

Yes, that's expected. At the OGR abstraction level, there are only layers. That they come from 
database views or tables (or anything else) is lost.

> - the ex-spatial-view tables (source spatial view now table) are properly
> created as spatial tables
> - the ex spatial tables re converted as ordanary tables with "fdo_' prefix,
> no entry in the geometry columns, although the geomtry is correctly encoded.

As far as I can see, apart the FGF geometry deserialization, there's nothing FDO specific in 
the SQLite driver (at least, I cannot see the 'fdo_' string, so I presume this is the name of the 
table in source database).

https://trac.osgeo.org/fdo/wiki/FDORfc16 doesn't mention this fdo_ prefix either, but 
perhaps this doc is out of date.

But what you report is a bit strange: if the geometry is properly exported, then the table 
should normally be registered as a spatial one. Difficult to say what happens here without a 
sample

> 
> - a side effect it seems to have difficulties with FID columns in the views
> (used -unsetFID to bypass but are still wondered)

Yes, in general when reading views, you cannot associate a FID. Unless some explicit 
metadata is set somewhere to tell that this column can be used as a FID (which spatialite 
system tables allow)

> 
> My question short is how to use ogr2ogr to properly change an (fdo) sqlite
> file to spatial lite?
> How to do this when having spatial and non-spatial tables?
> How to do this when having spatial views and non-spatial views?
> 
> should this not be possible straightforward, it would be helpfull to know
> the limitations, constraints and possible workarounds or post process steps,
> would they be required.

For the view -> view conversion, you'd probably need a dedicated conversion script that 
would understand that the source layer is a view and would thus manually create a view in 
the output database.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20170630/8d53c2a5/attachment.html>

