From cgodkin at gmail.com  Sun Nov  1 16:13:30 2020
From: cgodkin at gmail.com (Carl Godkin)
Date: Sun, 1 Nov 2020 16:13:30 -0800
Subject: [gdal-dev] Retrieving 3DEP data via GDAL's WCS driver...
In-Reply-To: <CAE=8kmmMwMiGrp+Jn9aekcSyTRP0_hQEWWJQmanE7zQWmAhwGg@mail.gmail.com>
References: <CAE=8kmmMwMiGrp+Jn9aekcSyTRP0_hQEWWJQmanE7zQWmAhwGg@mail.gmail.com>
Message-ID: <CAE=8km=623pO-9sEc8imhnADVvbJzFxkBhd_v=sVgamnnbouCg@mail.gmail.com>

Hi GDAL list,

I sent the following question in June about using gdal_translate with the
USGS' WCS Services.  One kind person tried to help but their suggestion did
not lead anywhere.  Since then I've also written a few times to the USGS
help addresses and all they can tell me is that the areas look okay to them
(through their ESRI interfaces, I think).

I just tried it again with (the latest OSGeo4W) GDAL 3.1.4 and found the
same problem.  Since the USGS thinks the data sets are fine, it's either a
usage mistake on my part (still the leading candidate!) or possibly a bug
in the WCS driver.

Can anyone suggest how I might investigate this since I'm not very
familiar with the inner workings of gdal_translate and the WCS driver?

Does anyone use this service regularly with GDAL tools (or just via ArcGIS
or some other tools)?

Thank you very much for your help,
carl


On Sat, Jun 13, 2020 at 5:27 PM Carl Godkin <cgodkin at gmail.com> wrote:

> Hi,
>
> This page https://viewer.nationalmap.gov/services/ includes a link under
> "WCS Services" that lists a number of subdatasets.  This command
>
> gdalnfo "
> https://elevation.nationalmap.gov/arcgis/services/3DEPElevation/ImageServer/WCSServer?request=GetCapabilities&service=WCS
> "
>
> works fine.  I have been retrieving elevation data from the first
> subdataset:
>
>   SUBDATASET_1_NAME=WCS:
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation
>   SUBDATASET_1_DESC=DEP3Elevation
>
> and most of the time it works but I think I must be doing something wrong
> since sometimes there are large missing areas.
>
> For instance this area (Boston) works just fine:
>
> gdal_translate "WCS:
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation"
> test.tif -projwin -71.07 42.36 -71.03 42.33 -projwin_srs EPSG:4326 -tr 100
> 100
>
> but this command with only a different "projwin" (in Colorado) is about
> 75% missing:
>
> gdal_translate "WCS:
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation"
> test.tif -projwin -107.03 37.28 -107 37.25 -projwin_srs EPSG:4326 -tr 100
> 100
>
> Can anyone help me understand what I'm doing wrong here and how to fix
> it?
>
> I am using a very recent OSGeo4W featuring GDAL 3.0.4, released
> 2020/01/28.
>
> Thanks very much for your help,
>
> carl
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201101/1a317300/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Nov  1 23:36:59 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 2 Nov 2020 00:36:59 -0700 (MST)
Subject: [gdal-dev] Retrieving 3DEP data via GDAL's WCS driver...
In-Reply-To: <CAE=8km=623pO-9sEc8imhnADVvbJzFxkBhd_v=sVgamnnbouCg@mail.gmail.com>
References: <CAE=8kmmMwMiGrp+Jn9aekcSyTRP0_hQEWWJQmanE7zQWmAhwGg@mail.gmail.com>
 <CAE=8km=623pO-9sEc8imhnADVvbJzFxkBhd_v=sVgamnnbouCg@mail.gmail.com>
Message-ID: <1604302619679-0.post@n6.nabble.com>

Hi,

By adding "-- debug on" into your command it is possible to get details
about what GDAL is doing. Here are the main parts from the log

gdal_translate
"WCS:https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation"
test.tif -projwin -107.03 37.28 -107 37.25 -projwin_srs EPSG:4326 -tr 100
100 --debug on

GDAL:
GDALOpen(WCS:https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation,
this=000002944175BD50) succeeds as WCS.
GDAL: Using GTiff driver
Input file size is 40075015, 20498394
GDAL: Using GTiff driver
0GDAL: GDAL_CACHEMAX = 1632 MB
GDAL: GDALDatasetCopyWholeRaster(): 33*42 swaths, bInterleave=0
WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)

WCS: Requesting
https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff
HTTP:
Fetch(https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff)
HTTP: libcurl/7.70.0-DEV OpenSSL/1.1.1g zlib/1.2.3
WCS: GDALOpenResult() on content-type: multipart/related; boundary="wcs";
start="GML-Part"; type="text/xml"
GDAL: GDALOpen(/vsimem/wcs/000002944175BD50/wcsresult.dat,
this=0000029441C0D9A0) succeeds as GTiff.
GDAL: GDALClose(/vsimem/wcs/000002944175BD50/wcsresult.dat,
this=0000029441C0D9A0)
...10...20...30...40...50...60...70...80...90...100 - done.
GDAL: Flushing dirty blocks:
0...10...20...30...40...50...60...70...80...90...100 - done.

Image test.tif looks somehow corrupted from the right side.
The only WCS request that GDAL sends can be found from the log. I removed
url-encoding for clarity

https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x(-20037507.0672000013,-11911185.14836644)&SUBSET=y(4474012.1150791775,4478208.115037268)&SCALESIZE=x(33),y(42)&Format=image/tiff

Unfortunately the server returns the GeoTIFF within a multipart content with
some GML. I do not know how to extract the GeoTIFF from the multipart
package so I could compare the results obtained by using WCS service
directly with curl or a browser. But because GDAL does not do much for the
result, just extract the tiff part and write it into separate GeoTIFF, I
suppose that it is the WCS server that generates the corrupted output.
However, the request that GDAL sends feels odd to me. Compare the projwin in
gdal_translate command with subsets in the GetCoverage

 -projwin -107.03 37.28 -107 37.25
SUBSET=x(-20037507.0672000013,-11911185.14836644)
SUBSET=y(4474012.1150791775,4478208.115037268)

Subract the numbers and notice that subset x is 8126321.919 meters while
subset y is 4196 meters. 
I can see number 4196 also in this line of the log
WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)

Perhaps the meaning is to create SUBSET=x() so that it is 3340 meters wide,
not 8126322? And maybe the ESRI WCS server creates a corrupted tiff when it
receives a somewhat lunatic request?

-Jukka Rahkonen-




  






--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Nov  2 01:12:04 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 02 Nov 2020 10:12:04 +0100
Subject: [gdal-dev] Motion: promote GDAL 3.2.0 RC1
In-Reply-To: <10094701.IN4IPj3KlC@even-i700>
References: <10094701.IN4IPj3KlC@even-i700>
Message-ID: <4958460.cWkMqA6u9x@even-i700>

> Motion:
> 
> Adopt GDAL 3.2.0 RC1 as final 3.2.0 release

I declare this motion passed with +1 from PSC members MateuszL, JukkaR, 
NormanB, DanielM, SeanG and myself

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  2 01:44:10 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 02 Nov 2020 10:44:10 +0100
Subject: [gdal-dev] GDAL/OGR 3.2.0 is released
Message-ID: <2140283.2X0KSRqLIz@even-i700>

Hi,

On behalf of the GDAL/OGR development team and community, I am pleased to 
announce the release of GDAL/OGR 3.2.0.  GDAL/OGR is a C++ geospatial data 
access library for raster and vector file formats, databases and web services.  
It includes bindings for several languages, and a variety of command line 
tools.

   http://www.gdal.org/

The 3.2.0 release is a new feature release with the following highlights:

* New GDAL drivers:
   - [ESRIC](https://gdal.org/drivers/raster/esric.html): ESRI bundle cache 
read-only driver (#2663)
   - [HEIF](https://gdal.org/drivers/raster/heif.html): read-only driver for 
HEIF/HEIC file. Requires libheif
   - [OGCAPI](https://gdal.org/drivers/raster/ogcapi.html): tiles/maps/
coverage raster/vector experimental driver
   - [TGA](https://gdal.org/drivers/raster/tga.html): read/only driver to read 
TGA image file format
 * New OGR drivers:
   - [LVBAG](https://gdal.org/drivers/vector/lvbag.html): read-only support 
for Dutch LVBAG/Kadaster 2.0 vector format
 * New utilities:
   - [gdal_create](https://gdal.org/programs/gdal_create.htm): to create/
initialize a new raster file
 * Other improvements:
   - Multi-threaded overview computation (if GDAL_NUM_THREADS set)
   - COG driver: TILING_SCHEME creation option
   - OpenFileGDB driver: add support for using spatial indexes
   - BAG driver: multiple improvements
   - FITS driver: multiple improvements (MEF and binary table support)
   - NITF driver: support for SNIP TREs
   - OGRFieldDefn: support UNIQUE constraint
   - OGRFieldDefn: support a AlternativeName (alias) property (#2729)
   - Python bindings: move implementation of scripts (except gdal2tiles) in 
osgeo.utils package to be reusable
   - Faster GTIFF Deflate compression/decompression through libdeflate (if 
using internal libtiff or libtiff > 4.1.0)
 * Removed functionality:
   - API_PROXY mechanism: likely never used for real usage.
   - Removal of GDAL and OGR ArcSDE drivers

More complete information on the new features and fixes in the 3.2.0
release can be found at:

  https://github.com/OSGeo/gdal/blob/v3.2.0/gdal/NEWS

The release can be downloaded from:
  * https://download.osgeo.org/gdal/3.2.0/gdal320.zip - source as a zip
  * https://download.osgeo.org/gdal/3.2.0/gdal-3.2.0.tar.gz - source as 
.tar.gz
  * https://download.osgeo.org/gdal/3.2.0/gdal-3.2.0.tar.xz - source as 
.tar.xz
  * https://download.osgeo.org/gdal/3.2.0/gdal-grass-3.2.0.tar.gz - GDAL-GRASS 
plugin
  * https://download.osgeo.org/gdal/3.2.0/gdalautotest-3.2.0.tar.gz - test 
suite
  * https://download.osgeo.org/gdal/3.2.0/gdal320doc.zip - documentation / 
website

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Mon Nov  2 02:10:11 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 02 Nov 2020 11:10:11 +0100
Subject: [gdal-dev] Passing open options along dataset name in a string ?
Message-ID: <1752606.LJUL4JdboQ@even-i700>

Hi,

I've heard interest in having the capability of passing a GDAL dataset name 
and its open options in a single string, since this is easier for storing.

The syntax could be a JSON serialized string prefixed by GDAL_JSON: to avoid 
any ambiguity with drivers that would accept JSON as a connection string/
dataset name.

So something like:

GDAL_JSON:{"dataset":"foo.csv","open_options":["AUTODETECT_TYPE=YES", 
"KEEP_GEOM_COLUMNS=NO"]}

A "allowed_drivers" member could also be added to reflect the corresponding 
argument of GDALOpenEx()

GDALOpen()/GDALOpenEx() would parse this, and process that exactly as if it 
was called with the dataset name, open options and allowed drivers put in the 
dedicated C arguments. So no change in drivers, just in GDALOpenEx().

If using that syntax, it wouldn't make sense to have both serialized options 
and options passed as C-argument together, so a warning would be emitted if 
that happened

Thoughts ?

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cgodkin at gmail.com  Mon Nov  2 06:38:29 2020
From: cgodkin at gmail.com (Carl Godkin)
Date: Mon, 2 Nov 2020 06:38:29 -0800
Subject: [gdal-dev] Retrieving 3DEP data via GDAL's WCS driver...
In-Reply-To: <1604302619679-0.post@n6.nabble.com>
References: <CAE=8kmmMwMiGrp+Jn9aekcSyTRP0_hQEWWJQmanE7zQWmAhwGg@mail.gmail.com>
 <CAE=8km=623pO-9sEc8imhnADVvbJzFxkBhd_v=sVgamnnbouCg@mail.gmail.com>
 <1604302619679-0.post@n6.nabble.com>
Message-ID: <CAE=8kmm_kbaTs9_rW+txifLnbAvQ7Wjx_PxrhXO-K3KgtvzhSQ@mail.gmail.com>

Hi Jukka,

That's very interesting.  Thanks a lot.  I wonder if I can figure out how
the X dimension is being changed to (or interpreted as) such a large range.

Certainly something that I can dig into step by step.

I can try sending your findings along to the USGS and hope that someone
there takes an interest.  This is a potentially very useful facility and I
would be surprised if no one else had tried using GDAL tools with it!

Thanks again,

carl


On Sun, Nov 1, 2020 at 11:37 PM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> By adding "-- debug on" into your command it is possible to get details
> about what GDAL is doing. Here are the main parts from the log
>
> gdal_translate
> "WCS:
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation
> "
> test.tif -projwin -107.03 37.28 -107 37.25 -projwin_srs EPSG:4326 -tr 100
> 100 --debug on
>
> GDAL:
> GDALOpen(WCS:
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation
> ,
> this=000002944175BD50) succeeds as WCS.
> GDAL: Using GTiff driver
> Input file size is 40075015, 20498394
> GDAL: Using GTiff driver
> 0GDAL: GDAL_CACHEMAX = 1632 MB
> GDAL: GDALDatasetCopyWholeRaster(): 33*42 swaths, bInterleave=0
> WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)
>
> WCS: Requesting
>
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff
> HTTP:
> Fetch(
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff
> )
> HTTP: libcurl/7.70.0-DEV OpenSSL/1.1.1g zlib/1.2.3
> WCS: GDALOpenResult() on content-type: multipart/related; boundary="wcs";
> start="GML-Part"; type="text/xml"
> GDAL: GDALOpen(/vsimem/wcs/000002944175BD50/wcsresult.dat,
> this=0000029441C0D9A0) succeeds as GTiff.
> GDAL: GDALClose(/vsimem/wcs/000002944175BD50/wcsresult.dat,
> this=0000029441C0D9A0)
> ...10...20...30...40...50...60...70...80...90...100 - done.
> GDAL: Flushing dirty blocks:
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> Image test.tif looks somehow corrupted from the right side.
> The only WCS request that GDAL sends can be found from the log. I removed
> url-encoding for clarity
>
>
> https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x(-20037507.0672000013,-11911185.14836644)&SUBSET=y(4474012.1150791775,4478208.115037268)&SCALESIZE=x(33),y(42)&Format=image/tiff
>
> Unfortunately the server returns the GeoTIFF within a multipart content
> with
> some GML. I do not know how to extract the GeoTIFF from the multipart
> package so I could compare the results obtained by using WCS service
> directly with curl or a browser. But because GDAL does not do much for the
> result, just extract the tiff part and write it into separate GeoTIFF, I
> suppose that it is the WCS server that generates the corrupted output.
> However, the request that GDAL sends feels odd to me. Compare the projwin
> in
> gdal_translate command with subsets in the GetCoverage
>
>  -projwin -107.03 37.28 -107 37.25
> SUBSET=x(-20037507.0672000013,-11911185.14836644)
> SUBSET=y(4474012.1150791775,4478208.115037268)
>
> Subract the numbers and notice that subset x is 8126321.919 meters while
> subset y is 4196 meters.
> I can see number 4196 also in this line of the log
> WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)
>
> Perhaps the meaning is to create SUBSET=x() so that it is 3340 meters wide,
> not 8126322? And maybe the ESRI WCS server creates a corrupted tiff when it
> receives a somewhat lunatic request?
>
> -Jukka Rahkonen-
>
>
>
>
>
>
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/23d34921/attachment-0001.html>

From habibutsu at gmail.com  Mon Nov  2 06:58:32 2020
From: habibutsu at gmail.com (Alexander Verbitsky)
Date: Mon, 2 Nov 2020 17:58:32 +0300
Subject: [gdal-dev] Slow speed in remote reading
Message-ID: <CAJ1+ekvYO=hDRTxPKiTDS8jRaZukS-_9poa3a_oYTBxbw1AwXg@mail.gmail.com>

Hi All, I am trying to implement remote reading small blocks of images, but
find slow performance.

For example i am trying to read 100x100 block from `sentinel-2` image, with
using following code:

filename = (
    '/vsigs/gcp-public-data-sentinel-2/tiles/31/U/FS/'
    'S2A_MSIL1C_20201024T104121_N0209_R008_T31UFS_20201024T125115.SAFE/'

'GRANULE/L1C_T31UFS_A027890_20201024T104121/IMG_DATA/T31UFS_20201024T104121_B08.jp2'
)
ds = gdal.OpenEx(filename, gdal.OF_RASTER)
band = ds.GetRasterBand(1)
img = band.ReadAsArray(1000, 1000, 100, 100)

In result I am getting more low performance in comparison if I just
download the whole image in memory and then read the necessary block. AS I
understand it happens due to a lot of small requests (is about 100)  that
are made during reading a small part of the image. Is it a fundamental
feature of JP2OpenJPEG and this format not suitable for doing things like
that? Should I take another format like GeoTiff and store my own data in
it? Thank, for your reply.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/c4282a6e/attachment.html>

From patrick.mckendree.young at gmail.com  Mon Nov  2 07:28:45 2020
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Mon, 2 Nov 2020 08:28:45 -0700
Subject: [gdal-dev] Slow speed in remote reading
In-Reply-To: <CAJ1+ekvYO=hDRTxPKiTDS8jRaZukS-_9poa3a_oYTBxbw1AwXg@mail.gmail.com>
References: <CAJ1+ekvYO=hDRTxPKiTDS8jRaZukS-_9poa3a_oYTBxbw1AwXg@mail.gmail.com>
Message-ID: <CADXYQQ4OnqFBsVsA4nW0fCm8c1XhbDw3T6f7OpzuscSboBSVjA@mail.gmail.com>

You can check how a S2 COG compares at

https://registry.opendata.aws/sentinel-2-l2a-cogs/

You should hopefully see a lot less network requests when accessing a sub
block directly.

P


On Mon, Nov 2, 2020 at 7:58 AM Alexander Verbitsky <habibutsu at gmail.com>
wrote:

> Hi All, I am trying to implement remote reading small blocks of images,
> but find slow performance.
>
> For example i am trying to read 100x100 block from `sentinel-2` image,
> with using following code:
>
> filename = (
>     '/vsigs/gcp-public-data-sentinel-2/tiles/31/U/FS/'
>     'S2A_MSIL1C_20201024T104121_N0209_R008_T31UFS_20201024T125115.SAFE/'
>
> 'GRANULE/L1C_T31UFS_A027890_20201024T104121/IMG_DATA/T31UFS_20201024T104121_B08.jp2'
> )
> ds = gdal.OpenEx(filename, gdal.OF_RASTER)
> band = ds.GetRasterBand(1)
> img = band.ReadAsArray(1000, 1000, 100, 100)
>
> In result I am getting more low performance in comparison if I just
> download the whole image in memory and then read the necessary block. AS I
> understand it happens due to a lot of small requests (is about 100)  that
> are made during reading a small part of the image. Is it a fundamental
> feature of JP2OpenJPEG and this format not suitable for doing things like
> that? Should I take another format like GeoTiff and store my own data in
> it? Thank, for your reply.
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/183f8a78/attachment.html>

From ari.jolma at gmail.com  Mon Nov  2 10:03:01 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Mon, 2 Nov 2020 20:03:01 +0200
Subject: [gdal-dev] Retrieving 3DEP data via GDAL's WCS driver...
In-Reply-To: <CAE=8kmm_kbaTs9_rW+txifLnbAvQ7Wjx_PxrhXO-K3KgtvzhSQ@mail.gmail.com>
References: <CAE=8kmmMwMiGrp+Jn9aekcSyTRP0_hQEWWJQmanE7zQWmAhwGg@mail.gmail.com>
 <CAE=8km=623pO-9sEc8imhnADVvbJzFxkBhd_v=sVgamnnbouCg@mail.gmail.com>
 <1604302619679-0.post@n6.nabble.com>
 <CAE=8kmm_kbaTs9_rW+txifLnbAvQ7Wjx_PxrhXO-K3KgtvzhSQ@mail.gmail.com>
Message-ID: <954cdbd8-491c-5c4f-0dca-64bcabb6d431@gmail.com>

The WCS driver stores data in folder $HOME/.gdal/wcs_cache. The folder 
contains a text file db which contains keys and URLs and responses from 
the server

// key.xml = service file
// key.xml.aux.xml = metadata file
// key.xml = Capabilities response
// key.aux.xml = Global metadata
// key.DC.xml = DescribeCoverage response

The issue could perhaps be debugged with those files.

I tried

gdalinfo -if WCS -oo CLEAR_CACHE 
"WCS:https://elevation.nationalmap.gov/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation"

(CLEAR_CACHE clears the whole cache so use with caution) but it returns 
504 and a HTML file describing an error.

Best,

Ari

Carl Godkin kirjoitti 2.11.2020 klo 16.38:
> Hi Jukka,
>
> That's very interesting.  Thanks a lot.  I wonder if I can figure out 
> how the X dimension is being changed to (or interpreted as) such a 
> large range.
>
> Certainly something that I can dig into step by step.
>
> I can try sending your findings along to the USGS and hope that 
> someone there takes an interest.  This is a potentially very useful 
> facility and I would be surprised if no one else had tried using GDAL 
> tools with it!
>
> Thanks again,
>
> carl
>
>
> On Sun, Nov 1, 2020 at 11:37 PM jratike80 
> <jukka.rahkonen at maanmittauslaitos.fi 
> <mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
>
>     Hi,
>
>     By adding "-- debug on" into your command it is possible to get
>     details
>     about what GDAL is doing. Here are the main parts from the log
>
>     gdal_translate
>     "WCS:https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation"
>     test.tif -projwin -107.03 37.28 -107 37.25 -projwin_srs EPSG:4326
>     -tr 100
>     100 --debug on
>
>     GDAL:
>     GDALOpen(WCS:https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?version=2.0.1&coverage=DEP3Elevation,
>     this=000002944175BD50) succeeds as WCS.
>     GDAL: Using GTiff driver
>     Input file size is 40075015, 20498394
>     GDAL: Using GTiff driver
>     0GDAL: GDAL_CACHEMAX = 1632 MB
>     GDAL: GDALDatasetCopyWholeRaster(): 33*42 swaths, bInterleave=0
>     WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)
>
>     WCS: Requesting
>     https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff
>     HTTP:
>     Fetch(https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x%28-20037507.0672000013,-11911185.14836644%29&SUBSET=y%284474012.1150791775,4478208.115037268%29&SCALESIZE=x%2833%29,y%2842%29&Format=image/tiff)
>     HTTP: libcurl/7.70.0-DEV OpenSSL/1.1.1g zlib/1.2.3
>     WCS: GDALOpenResult() on content-type: multipart/related;
>     boundary="wcs";
>     start="GML-Part"; type="text/xml"
>     GDAL: GDALOpen(/vsimem/wcs/000002944175BD50/wcsresult.dat,
>     this=0000029441C0D9A0) succeeds as GTiff.
>     GDAL: GDALClose(/vsimem/wcs/000002944175BD50/wcsresult.dat,
>     this=0000029441C0D9A0)
>     ...10...20...30...40...50...60...70...80...90...100 - done.
>     GDAL: Flushing dirty blocks:
>     0...10...20...30...40...50...60...70...80...90...100 - done.
>
>     Image test.tif looks somehow corrupted from the right side.
>     The only WCS request that GDAL sends can be found from the log. I
>     removed
>     url-encoding for clarity
>
>     https://elevation.nationalmap.gov:443/arcgis/services/3DEPElevation/ImageServer/WCSServer?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=DEP3Elevation&SUBSET=x(-20037507.0672000013,-11911185.14836644)&SUBSET=y(4474012.1150791775,4478208.115037268)&SCALESIZE=x(33),y(42)&Format=image/tiff
>
>     Unfortunately the server returns the GeoTIFF within a multipart
>     content with
>     some GML. I do not know how to extract the GeoTIFF from the multipart
>     package so I could compare the results obtained by using WCS service
>     directly with curl or a browser. But because GDAL does not do much
>     for the
>     result, just extract the tiff part and write it into separate
>     GeoTIFF, I
>     suppose that it is the WCS server that generates the corrupted output.
>     However, the request that GDAL sends feels odd to me. Compare the
>     projwin in
>     gdal_translate command with subsets in the GetCoverage
>
>      -projwin -107.03 37.28 -107 37.25
>     SUBSET=x(-20037507.0672000013,-11911185.14836644)
>     SUBSET=y(4474012.1150791775,4478208.115037268)
>
>     Subract the numbers and notice that subset x is 8126321.919 meters
>     while
>     subset y is 4196 meters.
>     I can see number 4196 also in this line of the log
>     WCS: DirectRasterIO(8122982,14330794,3340,4196) -> (33,42) (1 bands)
>
>     Perhaps the meaning is to create SUBSET=x() so that it is 3340
>     meters wide,
>     not 8126322? And maybe the ESRI WCS server creates a corrupted
>     tiff when it
>     receives a somewhat lunatic request?
>
>     -Jukka Rahkonen-
>
>
>
>
>
>
>
>
>
>
>
>     --
>     Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/95116e88/attachment-0001.html>

From sean at mapbox.com  Mon Nov  2 11:46:31 2020
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 2 Nov 2020 12:46:31 -0700
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <1752606.LJUL4JdboQ@even-i700>
References: <1752606.LJUL4JdboQ@even-i700>
Message-ID: <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>

Hi Even,

On Mon, Nov 2, 2020 at 3:10 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> I've heard interest in having the capability of passing a GDAL dataset
> name
> and its open options in a single string, since this is easier for storing.
>
> The syntax could be a JSON serialized string prefixed by GDAL_JSON: to
> avoid
> any ambiguity with drivers that would accept JSON as a connection string/
> dataset name.
>
> So something like:
>
> GDAL_JSON:{"dataset":"foo.csv","open_options":["AUTODETECT_TYPE=YES",
> "KEEP_GEOM_COLUMNS=NO"]}
>
> A "allowed_drivers" member could also be added to reflect the
> corresponding
> argument of GDALOpenEx()
>
> GDALOpen()/GDALOpenEx() would parse this, and process that exactly as if
> it
> was called with the dataset name, open options and allowed drivers put in
> the
> dedicated C arguments. So no change in drivers, just in GDALOpenEx().
>
> If using that syntax, it wouldn't make sense to have both serialized
> options
> and options passed as C-argument together, so a warning would be emitted
> if
> that happened
>
> Thoughts ?
>
> Even
>

We already have a way of passing "open" options for vsicurl:
https://gdal.org/user/virtual_file_systems.html#vsicurl-http-https-ftp-files-random-access.
What about reusing that conceptual framework and syntax?

For example:

"foo.csv?AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO"

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/fc60c067/attachment.html>

From habibutsu at gmail.com  Mon Nov  2 12:07:25 2020
From: habibutsu at gmail.com (Alexander Verbitsky)
Date: Mon, 2 Nov 2020 23:07:25 +0300
Subject: [gdal-dev] Slow speed in remote reading
In-Reply-To: <CADXYQQ4OnqFBsVsA4nW0fCm8c1XhbDw3T6f7OpzuscSboBSVjA@mail.gmail.com>
References: <CAJ1+ekvYO=hDRTxPKiTDS8jRaZukS-_9poa3a_oYTBxbw1AwXg@mail.gmail.com>
 <CADXYQQ4OnqFBsVsA4nW0fCm8c1XhbDw3T6f7OpzuscSboBSVjA@mail.gmail.com>
Message-ID: <CAJ1+ektOiNGFnxniXmh6SENndnvnzH4aoaYUVGjOiptpKgBzPw@mail.gmail.com>

I have checked. Yes, in using S2 COG with images in tiff format gdal makes
5 requests for getting 100x100px images and speed significantly higher in
comparison with jp2. Unfortunately the size of tiff-file in this case is
twice higher than corresponding jp2.

On Mon, Nov 2, 2020 at 6:28 PM Patrick Young <
patrick.mckendree.young at gmail.com> wrote:

> You can check how a S2 COG compares at
>
> https://registry.opendata.aws/sentinel-2-l2a-cogs/
>
> You should hopefully see a lot less network requests when accessing a sub
> block directly.
>
> P
>
>
> On Mon, Nov 2, 2020 at 7:58 AM Alexander Verbitsky <habibutsu at gmail.com>
> wrote:
>
>> Hi All, I am trying to implement remote reading small blocks of images,
>> but find slow performance.
>>
>> For example i am trying to read 100x100 block from `sentinel-2` image,
>> with using following code:
>>
>> filename = (
>>     '/vsigs/gcp-public-data-sentinel-2/tiles/31/U/FS/'
>>     'S2A_MSIL1C_20201024T104121_N0209_R008_T31UFS_20201024T125115.SAFE/'
>>
>> 'GRANULE/L1C_T31UFS_A027890_20201024T104121/IMG_DATA/T31UFS_20201024T104121_B08.jp2'
>> )
>> ds = gdal.OpenEx(filename, gdal.OF_RASTER)
>> band = ds.GetRasterBand(1)
>> img = band.ReadAsArray(1000, 1000, 100, 100)
>>
>> In result I am getting more low performance in comparison if I just
>> download the whole image in memory and then read the necessary block. AS I
>> understand it happens due to a lot of small requests (is about 100)  that
>> are made during reading a small part of the image. Is it a fundamental
>> feature of JP2OpenJPEG and this format not suitable for doing things like
>> that? Should I take another format like GeoTiff and store my own data in
>> it? Thank, for your reply.
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201102/3ca91d84/attachment.html>

From even.rouault at spatialys.com  Mon Nov  2 12:16:57 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 02 Nov 2020 21:16:57 +0100
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>
References: <1752606.LJUL4JdboQ@even-i700>
 <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>
Message-ID: <18238121.3TO5vI0ssJ@even-i700>

Sean,

> We already have a way of passing "open" options for vsicurl:
> https://gdal.org/user/virtual_file_systems.html#vsicurl-http-https-ftp-files
> -random-access. What about reusing that conceptual framework and syntax?
> 
> For example:
> 
> "foo.csv?AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO"

I actually considered that, but realized that things would get messy if you want
to use that vsicurl syntax and open options...

You would then have strings like

/vsicurl?max_retry=5&url=http://example.com/foo.csv&AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO

and the GDALOpen() logic would have to figure out whas is the /vsicurl part and the open option part.

Or we would have to URL-escape the "/vsicurl?max_retry=5&url=http://example.com/foo.csv" part
to avoid using '?' and '&', like:

/vsicurl%3Fmax_retry=5%26url=http://example.com/foo.csv?AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO


Another issue is we have connection strings like "WFS:http://example.com/wfs?SERVICE=WFS&VERSION=2.0.0" (or actually
just the "/vsicurl?max_retry=5&url=http://example.com/foo.csv" string mentioned above).
GDALOpen() would then mis-interpret this as dataset name = "WFS:http://example.com/wfs"
with open options SERVICE=WFS and VERSION=2.0.0

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From laasunde at hotmail.com  Tue Nov  3 05:43:52 2020
From: laasunde at hotmail.com (Lars Sunde)
Date: Tue, 3 Nov 2020 13:43:52 +0000
Subject: [gdal-dev] Build GDAL with static PROJ6
Message-ID: <AM6PR03MB3944D2AA91037013B882C538CA110@AM6PR03MB3944.eurprd03.prod.outlook.com>

Hello,

Does GDAL 3.0.4 support being statically linked with Proj 6.2.1?

Environment is RedHat 7.2 (64 bit) and GCC 9.3.

We have successfully built Proj 6.2.1 as static library.  The proj build folder is located at /tmp/proj and contains /tmp/proj/lib/libproj.a.

We have tried below command to configured gdal but it failed with error message "configure error: PROJ 6 symbols not found"
./configure ---with-proj=/tmp/proj

What are we doing wrong?

kind regards, Lars





-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201103/7eee6f41/attachment.html>

From neteler at osgeo.org  Tue Nov  3 06:06:03 2020
From: neteler at osgeo.org (Markus Neteler)
Date: Tue, 3 Nov 2020 15:06:03 +0100
Subject: [gdal-dev] Build GDAL with static PROJ6
In-Reply-To: <AM6PR03MB3944D2AA91037013B882C538CA110@AM6PR03MB3944.eurprd03.prod.outlook.com>
References: <AM6PR03MB3944D2AA91037013B882C538CA110@AM6PR03MB3944.eurprd03.prod.outlook.com>
Message-ID: <CALFmHhsqzGjHiHnTZfO7YwGoL=9FWEFHcX-BcUmN89+xBUsP6A@mail.gmail.com>

On Tue, Nov 3, 2020 at 2:44 PM Lars Sunde <laasunde at hotmail.com> wrote:
>
> Hello,
>
> Does GDAL 3.0.4 support being statically linked with Proj 6.2.1?
>
> Environment is RedHat 7.2 (64 bit) and GCC 9.3.
>
> We have successfully built Proj 6.2.1 as static library.  The proj build folder is located at /tmp/proj and contains /tmp/proj/lib/libproj.a.
>
> We have tried below command to configured gdal but it failed with error message "configure error: PROJ 6 symbols not found"
> ./configure ---with-proj=/tmp/proj

Please check towards the end of the file "config.log" which is
generated by "configure". It may contain the error message.

Best,
Markus

From angus at myheat.ca  Tue Nov  3 11:35:28 2020
From: angus at myheat.ca (Angus Dickey)
Date: Tue, 3 Nov 2020 12:35:28 -0700
Subject: [gdal-dev] Reading a VRT file & overview usage
In-Reply-To: <2544976.hIIP4EiWIH@even-i700>
References: <CABADqymXhQ=ty6m9UkNLexL9Hg6goMdtVj1qznyfR3xRqnWqug@mail.gmail.com>
 <2544976.hIIP4EiWIH@even-i700>
Message-ID: <CABADqy==uNrDhKfKjOSkz2h9JMPVRdMesDRNV5c4kCLP2Gn9vw@mail.gmail.com>

Even,

Thank you for your response.

Since you can't reproduce this with your test it makes me think there is
something about the input data. I put together some sample data in a public
S3 bucket and some commands. Would you be able to try them out to see if
that reproduces the behaviour? I tried GDAL 2.2.3, GDAL 2.4.2, and GDAL
3.0.1 and saw the same thing. No overlay use with any resampling method
other than nearest.

The COGS are single band float32 with zero indicating NODATA and the VRT is
built with using gdal.BuildVRT('mosaic.vrt', files,
options=gdal.BuildVRTOptions(srcNodata=0, VRTNodata=0)) in Python. The VRT
also has pre-built statistics, if that is a factor.

# v3.0.1
gdalinfo --version

# Output looks normal to me.
gdalinfo /vsicurl/
https://dev-myheat-ca.s3-us-west-2.amazonaws.com/data/gdal/mosaic.vrt
--config GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR

# This is actually your tool I think! Reports the COG as valid.
python validate_cloud_optimized_geotiff.py /vsicurl/
https://dev-myheat-ca.s3-us-west-2.amazonaws.com/data/gdal/20.cog.tiff

# ~4 seconds (--debug ON will show GDAL loading overviews)
gdal_translate /vsicurl/
https://dev-myheat-ca.s3-us-west-2.amazonaws.com/data/gdal/mosaic.vrt
/tmp/tile.tiff -projwin -9177335.364031402 5305341.259217514
-9174889.379126277 5302895.274312388 -outsize 256 256 -r nearest --config
GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR

# ~60 seconds (--debug ON will show GDAL loading full resolution data)
gdal_translate /vsicurl/
https://dev-myheat-ca.s3-us-west-2.amazonaws.com/data/gdal/mosaic.vrt
/tmp/tile.tiff -projwin -9177335.364031402 5305341.259217514
-9174889.379126277 5302895.274312388 -outsize 256 256 -r bilinear --config
GDAL_DISABLE_READDIR_ON_OPEN EMPTY_DIR

Could it have to do with the data being float32 or the way the overviews
are built? GDAL seems to be making the choice to skip the overviews for
some reason.

Thank again,

Angus


On Fri, Oct 30, 2020 at 8:53 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Angus,
>
> > But the second command ignores the overviews and downloads the full
> > resolution imagery leading to very long download times. Is it expected
> > behaviour that all re-sampling methods except 'nearest neighbour' need to
> > request the full resolution data? Can't they apply the selected
> re-sampling
> > method to the overviews? Is it something to do with the way I created my
> > VRT file?
>
> I can't confirm with the following little test
>
> gdal_translate byte.tif test.tif -outsize 2048 2048
> gdal_translate test.tif left.tif -srcwin 0 0 1024 2048 -b 1 -b 1 -b 1
> gdal_translate test.tif right.tif -srcwin 1024 0 1024 2048  -b 1 -b 1 -b 1
> gdalbuildvrt vrt.vrt left.tif right.tif
> gdaladdo left.tif
> gdaladdo right.tif
> python -c "from osgeo import gdal; ds = gdal.Open('left.tif',
> gdal.GA_Update);
> ds.GetRasterBand(1).GetOverview(2).Fill(0)"
>
> copy left.tif, right.tif and vrt.vrt on S3
>
> gdal_translate /vsis3/mybucket/vrt.vrt out.tif -r bilinear -outsize 128 128
>
> Works fine with GDAL 2.4.4 and master
>
> If you can come up with a minimum reproducing scenario (input files +
> script/
> command to reproduce), please file a ticket on github
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201103/a4b26459/attachment-0001.html>

From sean at mapbox.com  Tue Nov  3 14:20:49 2020
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 3 Nov 2020 15:20:49 -0700
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <18238121.3TO5vI0ssJ@even-i700>
References: <1752606.LJUL4JdboQ@even-i700>
 <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>
 <18238121.3TO5vI0ssJ@even-i700>
Message-ID: <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>

Even,

On Mon, Nov 2, 2020 at 1:16 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> Sean,
>
> > We already have a way of passing "open" options for vsicurl:
> >
> https://gdal.org/user/virtual_file_systems.html#vsicurl-http-https-ftp-files
> > -random-access. What about reusing that conceptual framework and syntax?
> >
> > For example:
> >
> > "foo.csv?AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO"
>
> I actually considered that, but realized that things would get messy if
> you want
> to use that vsicurl syntax and open options...
>
> You would then have strings like
>
> /vsicurl?max_retry=5&url=
> http://example.com/foo.csv&AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO
>
> and the GDALOpen() logic would have to figure out whas is the /vsicurl
> part and the open option part.
>
> Or we would have to URL-escape the "/vsicurl?max_retry=5&url=
> http://example.com/foo.csv" part
> to avoid using '?' and '&', like:
>
> /vsicurl%3Fmax_retry=5%26url=
> http://example.com/foo.csv?AUTODETECT_TYPE=YES&KEEP_GEOM_COLUMNS=NO
>
>
> Another issue is we have connection strings like "WFS:
> http://example.com/wfs?SERVICE=WFS&VERSION=2.0.0" (or actually
> just the "/vsicurl?max_retry=5&url=http://example.com/foo.csv" string
> mentioned above).
> GDALOpen() would then mis-interpret this as dataset name = "WFS:
> http://example.com/wfs"
> with open options SERVICE=WFS and VERSION=2.0.0
>

I see.

I wish our data formats were more standard and less slippery and didn't
need these open options. But it's true that some files are very different
without the proper combination of opening options and there's a benefit to
helping applications use the right combination.

I'm not a fan of the mix of JSON and not-JSON elements in the syntax you
proposed. I think a good solution for naming datasets and including all the
driver options and vsi options looks more like a URN [1] and I think we
should write a GDAL RFC to standardize it. I also think that we should get
some people outside of GDAL involved. Like folks from the Dask community,
who might share some lessons learned from writing fsspec [2].

The URN or GDN version might look something like the thing below, using ?+
and ?= [3] to identify vsi and driver option sections

gdn:curl:csv:
example.com/foo.csv?a=1&b=2?+max_retry=5?=autodetect_type=yes&keep_geom_columns=no

Bringing a little more order to how we name and address datasets was on my
todo list at the start of the year, but then 2020 went into a spiral. I
don't think rasterio's "zip+s3" etc approach is the best. We should start
from scratch and come up with something excellent and expressive and
broadly supported in GDAL, QGIS, rasterio, GeoPandas, GeoTrellis etc.

[1] https://en.wikipedia.org/wiki/Uniform_Resource_Name
[2] https://filesystem-spec.readthedocs.io/en/latest/index.html
[3] https://tools.ietf.org/html/rfc8141#section-2.3

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201103/4058fe8e/attachment.html>

From a.muslic at outlook.com  Wed Nov  4 01:56:48 2020
From: a.muslic at outlook.com (=?iso-8859-2?Q?Aneta_Musli=E6?=)
Date: Wed, 4 Nov 2020 09:56:48 +0000
Subject: [gdal-dev] Encoding when creating pdf
Message-ID: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>

Hello,

I am using gdal version 2.4.4 in my c# app.
As a part of my project I am creating pdf with gdal_translate command. GDAL translate command is
"gdal_translate  --config SHAPE_ENCODING "utf-8" -of PDF -tr 0.001 0.001 -a_srs EPSG:3765 Granice.tif Sisacko_moslavacka_zupanija3.pdf -co OGR_DATASOURCE=Extent.vrt".

Part of vrt file that displays labels is:
<OGRVRTLayer name="SHPCounties">
<SrcDataSource relativeToVRT="0">MSSQL: driver={SQL Server Native Client 11.0};
server=xxx;uid=xx;pwd=xx;database=HAPIH;
Integrated Security=False;MARS_Connection=yes</SrcDataSource>
<SrcLayer>SHPCounties</SrcLayer>
<LayerSRS>EPSG:3765</LayerSRS>
<SrcSQL>
select Geometry.STCentroid() as pointPolygonCounties,
CAST(Name AS varchar(100)) COLLATE Croatian_CI_AI AS NameCollated,
'LABEL(f:"Times New Roman",t:{NameCollated},c:#000000,s:40pt)' AS OGR_STYLE
FROM SHPCounties
</SrcSQL>
<GeometryType>wkbPoints</GeometryType>
<GeometryField name="pointPolygonCounties" />
</OGRVRTLayer>

My labels have special characters (č and ć). I defined encoding to utf-8 and gdal-config as utf-8 but in generated pdf under fonts I can see that the font used is Times New Roman with encoding ansi, and characters č and ć are replaced with c because ansi doesn't support those letters. I tried writing just the letter 'č' to pdf so I can eliminate that the problem is in database but it is replaced with something else in pdf,  also I tried using html entity for those letters but it doesn't help.

I would like to know how can I define in label options of vrt file for it to use font with custom encoding and not ansi encoding so it can display my special characters or there is another way for me to display those special characters.

Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201104/ad26f180/attachment.html>

From even.rouault at spatialys.com  Wed Nov  4 02:40:53 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 04 Nov 2020 11:40:53 +0100
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>
References: <1752606.LJUL4JdboQ@even-i700> <18238121.3TO5vI0ssJ@even-i700>
 <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>
Message-ID: <10247089.7RZAXl55qJ@even-i700>

Sean,

What GDN stands for: GDAL Dataset Name ?

> The URN or GDN version might look something like the thing below, using ?+
> and ?= [3] to identify vsi and driver option sections
> 
> gdn:curl:csv:
> example.com/foo.csv?a=1&b=2?+max_retry=5?=autodetect_type=yes&keep_geom_colu
> mns=no

The http or https protocol should be captured too.

> Bringing a little more order to how we name and address datasets was on my
> todo list at the start of the year, but then 2020 went into a spiral. I
> don't think rasterio's "zip+s3" etc approach is the best.

I see fsspec has a syntax for chaining filesystems in
https://filesystem-spec.readthedocs.io/en/latest/features.html#url-chaining

Another particularity we have in GDAL is that the dataset name might be almost 
anything. Most of the time, it is a regular file path, or some /vsi path. But 
sometimes, it can be JSON content (the GeoJSON driver accepts the content to 
be directly provided as the dataset name), or XML (VRT, WMS drivers).
We have also the subdataset syntax "HDF5:foo.hdf:my_variable"

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Wed Nov  4 06:43:52 2020
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 4 Nov 2020 07:43:52 -0700
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <10247089.7RZAXl55qJ@even-i700>
References: <1752606.LJUL4JdboQ@even-i700> <18238121.3TO5vI0ssJ@even-i700>
 <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>
 <10247089.7RZAXl55qJ@even-i700>
Message-ID: <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>

Even,

On Wed, Nov 4, 2020 at 3:40 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Sean,
>
> What GDN stands for: GDAL Dataset Name ?
>

Yes. I just made that up on the spot. Think of it as a GDAL or FOSS4G
specific namespace. Until now, GDAL has been using symbols like WFS: and
HDF5: in the global namespace, which causes problems for interoperability.


>
> > The URN or GDN version might look something like the thing below, using
> ?+
> > and ?= [3] to identify vsi and driver option sections
> >
> > gdn:curl:csv:
> >
> example.com/foo.csv?a=1&b=2?+max_retry=5?=autodetect_type=yes&keep_geom_colu
> > mns=no
>
> The http or https protocol should be captured too.
>
> > Bringing a little more order to how we name and address datasets was on
> my
> > todo list at the start of the year, but then 2020 went into a spiral. I
> > don't think rasterio's "zip+s3" etc approach is the best.
>
> I see fsspec has a syntax for chaining filesystems in
> https://filesystem-spec.readthedocs.io/en/latest/features.html#url-chaining


Yes, I recognized this as being a different approach to a similar problem
we have in GDAL: data files that can be accessed with different layers of
optional protocols.


>
>
> Another particularity we have in GDAL is that the dataset name might be
> almost
> anything. Most of the time, it is a regular file path, or some /vsi path.
> But
> sometimes, it can be JSON content (the GeoJSON driver accepts the content
> to
> be directly provided as the dataset name), or XML (VRT, WMS drivers).
> We have also the subdataset syntax "HDF5:foo.hdf:my_variable"
>

Could VRT XML and JSON be exempted? We already have a way to embed open
options in the XML.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201104/25f26c19/attachment-0001.html>

From even.rouault at spatialys.com  Wed Nov  4 07:04:37 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 04 Nov 2020 16:04:37 +0100
Subject: [gdal-dev] Reading a VRT file & overview usage
In-Reply-To: <CABADqy==uNrDhKfKjOSkz2h9JMPVRdMesDRNV5c4kCLP2Gn9vw@mail.gmail.com>
References: <CABADqymXhQ=ty6m9UkNLexL9Hg6goMdtVj1qznyfR3xRqnWqug@mail.gmail.com>
 <2544976.hIIP4EiWIH@even-i700>
 <CABADqy==uNrDhKfKjOSkz2h9JMPVRdMesDRNV5c4kCLP2Gn9vw@mail.gmail.com>
Message-ID: <1863245.aaOVjIRBtL@even-i700>

Angus,

The difference of behaviour between my test case and yours is that yours has a 
<NoDataValue> set on the VRTRasterBand, and the source COGs don't have that 
value. In this situation a key optimization used by the VRT driver is 
disabled, and there's a fallback to code that won't make use of the source 
overviews to get correct results. I imagine that could be improved, but this 
is not a 5-minute type of fix. A workaround would probably to create your COGs 
with 0 set as nodata value.

Even


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov  4 08:01:39 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 04 Nov 2020 17:01:39 +0100
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>
References: <1752606.LJUL4JdboQ@even-i700> <10247089.7RZAXl55qJ@even-i700>
 <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>
Message-ID: <4459767.mlp4P4333Y@even-i700>

> > Another particularity we have in GDAL is that the dataset name might be
> > almost
> > anything. Most of the time, it is a regular file path, or some /vsi path.
> > But
> > sometimes, it can be JSON content (the GeoJSON driver accepts the content
> > to
> > be directly provided as the dataset name), or XML (VRT, WMS drivers).
> > We have also the subdataset syntax "HDF5:foo.hdf:my_variable"
> 
> Could VRT XML and JSON be exempted? We already have a way to embed open
> options in the XML.

If the gdn: mechanism is a new possibility offered that doesn't exclude 
existing ones (otherwise that would be a pretty big breaking change), we could 
possibly exempt the odd cases I mentioned (or have some quoting/escaping rules 
to enable that payload to be seen as a file), which generally don't need a 
"permanent" way of refering to the dataset like gdn: would offer, since this 
is content often generated programatically or retrieved dynamically.

Covering subdataset would be a more important use case. Something that would 
have to be decided if the way we express subdatasets would be somehow 
standardized or if it would be a black-box string for the gdn: encapsulation. 
For a black-box approach, we would have to define some escaping/quoting rules 
to avoid any potential issue with separators of the gdn syntax. If we decide 
that the subdataset syntax is part of what is standardized by GDN that would 
be a more challenging exercice, because the subdataset syntax varies from 
driver to driver.
Depending on how we design things, that might impact between:
- just GDALOpen() generic code if GDALOpen() decodes the gdn: string to 
decompose it into 'classic' dataset names and open options
- all drivers if the gdn: string would be passed to each GDALDriver::pfnOpen() 
implementation
- intermediate situation if we decide to drop (at least for future drivers) 
per-driver subdataset syntax (which has deficiencies has the quoting rules to 
separate the filename from the non-filename component vary from driver to 
driver, and are most of the time not defined) to come up with something more 
standardized

To help brainstorming, a non-exhaustive overview of a few situations mixing 
driver prefixing, subdataset syntax and open options:

gdalinfo my.tif
gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
gdalinfo GTIFF_DIR:0:d:\my.tif
gdalinfo EEDAI:my/asset
gdalinfo EEDAI: -oo ASSET=my/asset
gdalinfo EEDAI:my/asset:band1, band2
gdalinfo EEDAI: -oo ASSET=my/asset -oo BANDS=band1,band2
gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo SUPERGRIDS_MASK=YES
gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
gdalinfo netCDF:"/vsicurl/http://example.com/my.nc":my_var
ogrinfo "PG:dbname=testdb user=foo"
ogrinfo "mySQL:testdb,user=foo"
ogrinfo OCI:warmerda/password at gdal800.dreadfest.com

GDALOpen() is not even aware that HDF5:bla means that the dataset will be 
recognized by the HDF5 driver

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From angus at myheat.ca  Wed Nov  4 12:03:22 2020
From: angus at myheat.ca (Angus Dickey)
Date: Wed, 4 Nov 2020 13:03:22 -0700
Subject: [gdal-dev] Reading a VRT file & overview usage
In-Reply-To: <1863245.aaOVjIRBtL@even-i700>
References: <CABADqymXhQ=ty6m9UkNLexL9Hg6goMdtVj1qznyfR3xRqnWqug@mail.gmail.com>
 <2544976.hIIP4EiWIH@even-i700>
 <CABADqy==uNrDhKfKjOSkz2h9JMPVRdMesDRNV5c4kCLP2Gn9vw@mail.gmail.com>
 <1863245.aaOVjIRBtL@even-i700>
Message-ID: <CABADqykXzsaUgyL1FENEaSo1eyToLw1wyAuqW1kiYfwSwFmHyw@mail.gmail.com>

Even,

Thanks for having a look at the data, I see what you mean about the NODATA
value in the COGs. They are *supposed* to have an internal NODATA value set
on the band, but they actually do not. I set NODATA with gdal_edit and the
resampling method no longer affects overview usage.

For us, this workaround is perfect because the COGs were supposed to have
NODATA set anyway. For others, maybe the solution is as simple as adding a
note to the "GDAL Virtual File Systems" page. Regardless, this will be in
the mailing list archives if anyone else runs into it.

Thanks again for your help,

Angus

On Wed, Nov 4, 2020 at 8:04 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Angus,
>
> The difference of behaviour between my test case and yours is that yours
> has a
> <NoDataValue> set on the VRTRasterBand, and the source COGs don't have
> that
> value. In this situation a key optimization used by the VRT driver is
> disabled, and there's a fallback to code that won't make use of the source
> overviews to get correct results. I imagine that could be improved, but
> this
> is not a 5-minute type of fix. A workaround would probably to create your
> COGs
> with 0 set as nodata value.
>
> Even
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201104/8bd908b4/attachment.html>

From apachemaven0 at gmail.com  Thu Nov  5 06:29:36 2020
From: apachemaven0 at gmail.com (maven apache)
Date: Thu, 5 Nov 2020 22:29:36 +0800
Subject: [gdal-dev] GDAL java binding in windows.
In-Reply-To: <CA+FxMdV6fYHEEyUtRo6MOgWzARaY43QuUvJdAfQWZGDXd-P0Nw@mail.gmail.com>
References: <CA+FxMdV6fYHEEyUtRo6MOgWzARaY43QuUvJdAfQWZGDXd-P0Nw@mail.gmail.com>
Message-ID: <CA+FxMdUayn0vWdpjMuEYAotL5xt0_n6VensjHgb6g95FRkE1bQ@mail.gmail.com>

Hi:
I tried to use gdal with java in window 10,and I installed gdal from the
pre-built binary from “https://www.gisinternals.com/“.
Then I set the required environment variables by following this topic:
https://docs.geoserver.org/stable/en/user/data/raster/gdal.html
After that, I tried to validate this in jshell:
First check the environment variables are set properly:

C:\Users\xx>echo %Path%
C:\Program Files (x86)\NetSarang\Xshell
6\;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\System32\WindowsPowerShell\v1.0\;C:\Program
Files (x86)\Windows Kits\8.1\Windows Performance
Toolkit\;C:\WINDOWS\System32\OpenSSH\;C:\Go\bin;C:\Program
Files\Pandoc\;C:\Program Files (x86)\Yarn\bin\;C:\Program
Files\Git\cmd;C:\Users\xx\AppData\Local\Microsoft\WindowsApps;D:\program\jdk_jre\jdk\bin;C:\Users\xx\AppData\Local\Programs\Fiddler;C:\Program
Files\QGIS 2.18\bin;C:\Python27;%GOPATH%\bin;C:\Users\xx\AppData\Local\Microsoft\WindowsApps;C:\Program
Files\Bandizip\;C:\Program
Files\Docker\Docker\resources\bin;C:\Users\xx\go\bin;C:\Program
Files\Docker Toolbox;C:\Users\xx\AppData\Local\Yarn\bin;D:\program\gdal-3.2-dev-mapserver\bin\gdal\java;D:\program\gdal-3.2-dev-mapserver\bin;

C:\Users\xx>echo %PROJ_LIB%
D:\program\gdal-3.2-dev-mapserver\proj6\share

C:\Users\xx>echo %GDAL_DATA%
D:\program\gdal-3.2-dev-mapserver\bin\gdal-data

Then tried to load the jni library:

C:\Users\xx>jshell
|  Welcome to JShell -- Version 11.0.8
|  For an introduction type: /help intro

jshell> System.loadLibrary("gdalalljni")
|  Exception java.lang.UnsatisfiedLinkError:
D:\program\gdal-3.2-dev-mapserver\bin\gdal\java\gdalalljni.dll: The
specified procedure could not be found
|        at ClassLoader$NativeLibrary.load0 (Native Method)
|        at ClassLoader$NativeLibrary.load (ClassLoader.java:2430)
|        at ClassLoader$NativeLibrary.loadLibrary (ClassLoader.java:2487)
|        at ClassLoader.loadLibrary0 (ClassLoader.java:2684)
|        at ClassLoader.loadLibrary (ClassLoader.java:2649)
|        at Runtime.loadLibrary0 (Runtime.java:827)
|        at System.loadLibrary (System.java:1871)
|        at (#1:1)

jshell> /exit
|  Goodbye

As shown, the jni library can not be loaded correctly.

Then reset the environment variables again in the terminal:

C:\Users\xx>SET
PATH=%PATH%;D:\program\gdal-3.2-dev-mapserver\bin\;D:\program\gdal-3.2-dev-mapserver\bin\gdal\java;

C:\Users\xx>SET PROJ_LIB=D:\program\gdal-3.2-dev-mapserver\bin\proj6\share;

C:\Users\xx>SET GDAL_DATA=D:\program\gdal-3.2-dev-mapserver\bin\gdal-data;

C:\Users\xx>jshell
|  Welcome to JShell -- Version 11.0.8
|  For an introduction type: /help intro

jshell> System.loadLibrary("gdalalljni")

jshell>

As shown, it worked.

Why do I have to reset the environment variables again ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201105/f5720ccf/attachment.html>

From even.rouault at spatialys.com  Thu Nov  5 06:39:48 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 05 Nov 2020 15:39:48 +0100
Subject: [gdal-dev] "import gdal" broken in 3.2.0: what to do ?
Message-ID: <3769540.1hvDmPGJRa@even-i700>

Hi,

As noted in https://github.com/OSGeo/gdal/issues/3149, the old way of 
importing the Python bindings with "import gdal" instead of "from osgeo import 
gdal" was accidentally broken in 3.2.0 . The old way has been officially 
deprecated for many years.

Any opinion if we should just acknowledge that removal by updating 3.2 NEWS or 
restore back the old import way (per PR https://github.com/OSGeo/gdal/pull/
3150) for 3.2.1 ? (whatever we do, at least people using 3.2.0 would be 
impacted)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From richard.greenwood at gmail.com  Thu Nov  5 07:27:52 2020
From: richard.greenwood at gmail.com (Richard Greenwood)
Date: Thu, 5 Nov 2020 08:27:52 -0700
Subject: [gdal-dev] Encoding when creating pdf
In-Reply-To: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>
References: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>
Message-ID: <CAHBySPb704joFY3piHTJ2jya4aAi6iovyKL5SgV2XkZd-3TwyA@mail.gmail.com>

Do your shapefiles include a code page file (*.cpg)? If not, maybe that
would help.

On Wed, Nov 4, 2020 at 2:57 AM Aneta Muslić <a.muslic at outlook.com> wrote:

> Hello,
>
> I am using gdal version 2.4.4 in my c# app.
> As a part of my project I am creating pdf with gdal_translate command.
> GDAL translate command is
> *"gdal_translate  --config SHAPE_ENCODING "utf-8" -of PDF -tr 0.001 0.001
> -a_srs EPSG:3765 Granice.tif Sisacko_moslavacka_zupanija3.pdf -co
> OGR_DATASOURCE=Extent.vrt".*
>
> Part of vrt file that displays labels is:
> *<OGRVRTLayer name="SHPCounties">*
> *<SrcDataSource relativeToVRT="0">MSSQL: driver={SQL Server Native Client
> 11.0};*
> *server=xxx;uid=xx;pwd=xx;database=HAPIH;*
> *Integrated Security=False;MARS_Connection=yes</SrcDataSource>*
> *<SrcLayer>SHPCounties</SrcLayer>*
> *<LayerSRS>EPSG:3765</LayerSRS>        *
> *<SrcSQL>*
> *select Geometry.STCentroid() as pointPolygonCounties,*
> *CAST(Name AS varchar(100)) COLLATE Croatian_CI_AI AS NameCollated,*
> *'LABEL(f:"Times New Roman",t:{NameCollated},c:#000000,s:40pt)' AS
> OGR_STYLE *
> *FROM SHPCounties*
> *</SrcSQL>*
> *<GeometryType>wkbPoints</GeometryType> *
> *<GeometryField name="pointPolygonCounties" />*
>
> *</OGRVRTLayer> *
>
> My labels have special characters (č and ć). I defined encoding to utf-8
> and gdal-config as utf-8 but in generated pdf under fonts I can see that
> the font used is Times New Roman with encoding ansi, and characters č and ć
> are replaced with c because ansi doesn't support those letters. I tried
> writing just the letter 'č' to pdf so I can eliminate that the problem is
> in database but it is replaced with something else in pdf,  also I tried
> using html entity for those letters but it doesn't help.
>
> I would like to know how can I define in label options of vrt file for it
> to use font with custom encoding and not ansi encoding so it can display my
> special characters or there is another way for me to display those special
> characters.
>
> Thank you.
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Richard W. Greenwood, PLS
www.greenwoodmap.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201105/9fbe53c4/attachment-0001.html>

From rothan at gmail.com  Thu Nov  5 07:47:31 2020
From: rothan at gmail.com (Andreas Roth)
Date: Thu, 5 Nov 2020 16:47:31 +0100
Subject: [gdal-dev] Spherical Mercator Projection mismatching major/minor
	axis
Message-ID: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>

Hi,

I call OSRImportFromProj4 with
"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0
+k=1.0 +units=m +nadgrids=@null +towgs84=0,0,0,0,0,0,0 +wktext +no_defs"

and with the returned handle i get the major and minor axis (
OSRGetSemiMajor/OSRGetSemiMinor). I would expect the both axis to be equal,
but they aren't.
Instead i'm getting the following result:
semi_major_axis=6378137
semi_minor_axis=6356752.314

Build on Ubuntu 20.10 (groovy; amd64) with libgdal-dev,
version 3.1.3+dfsg-1ubuntu2) and libproj-dev:amd64 with version 7.1.0-1

The full example application code:
https://pastebin.com/xf8QpVhM

Regards,
Andreas
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201105/efcdc188/attachment.html>

From kai.muehlbauer at uni-bonn.de  Thu Nov  5 06:59:17 2020
From: kai.muehlbauer at uni-bonn.de (=?UTF-8?Q?Kai_M=c3=bchlbauer?=)
Date: Thu, 5 Nov 2020 15:59:17 +0100
Subject: [gdal-dev] "import gdal" broken in 3.2.0: what to do ?
In-Reply-To: <3769540.1hvDmPGJRa@even-i700>
References: <3769540.1hvDmPGJRa@even-i700>
Message-ID: <0140968b-abd9-88bb-98d4-c6970315df9d@uni-bonn.de>

Hi,

I'm using GDAL since 2012 and one of the first things I've read is this:

https://trac.osgeo.org/gdal/wiki/GdalOgrInPython

The first mention of the deprecation of this import was added 13 years 
ago. To quote from there:

"
Additionally, there are five compatibility modules that are included but 
provide notices to state that they are deprecated and will be going 
away. If you are using GDAL 1.5 bindings, you should update your imports 
to utilize the usage above, but the following will work until at least 
GDAL 2.0.
"

Not sure, if it's worth the effort to reinstate that behaviour. People 
would have to move on anyway, sooner or later. Just my 2c.

Huge thanks to Even and all the other people involved with GDAL and 
OSGEO for providing such great tools!

Cheers,
Kai







Am 05.11.20 um 15:39 schrieb Even Rouault:
> Hi,
> 
> As noted in https://github.com/OSGeo/gdal/issues/3149, the old way of
> importing the Python bindings with "import gdal" instead of "from osgeo import
> gdal" was accidentally broken in 3.2.0 . The old way has been officially
> deprecated for many years.
> 
> Any opinion if we should just acknowledge that removal by updating 3.2 NEWS or
> restore back the old import way (per PR https://github.com/OSGeo/gdal/pull/
> 3150) for 3.2.1 ? (whatever we do, at least people using 3.2.0 would be
> impacted)
> 
> Even
> 


From jukka.rahkonen at maanmittauslaitos.fi  Fri Nov  6 03:07:43 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 6 Nov 2020 04:07:43 -0700 (MST)
Subject: [gdal-dev] Spherical Mercator Projection mismatching
 major/minor axis
In-Reply-To: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>
References: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>
Message-ID: <1604660863882-0.post@n6.nabble.com>

Hi,

This does not really belong to my knowledge area but I'll have a try anyway.

Check what you have after reading the proj string instead. Here with Python

>>> from osgeo import osr
>>> spatialRef = osr.SpatialReference()
>>> spatialRef.ImportFromProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
>>> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
>>> +towgs84=0,0,0,0,0,0,0 +wktext +no_defs")
>>> print(spatialRef)
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0
+x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs"]]
    

It means that GDAL makes a clever guess and considers that the Proj string
that you provided means EPSG:3857. You probably mean the same. And in the
EPSG database EPSG:3857 is based on WGS84 ellipsoid
https://epsg.org/crs/wkt/id/3857

 ELLIPSOID["WGS 84",6378137,298.257223563,

and that it behaves in spherical way is handled by a special conversion

CONVERSION["Popular Visualisation Pseudo-Mercator",

I am not sure what to do if you definitely want to keep the ball with
diameter of 6378137 meters but perhaps dropping +nadgrids=@null could do it.
If EPSG:3857 is what you really need then it takes less writing to import by
the EPSG code but your way gives the same result.

-Jukka Rahkonen-





Andreas Roth wrote
> Hi,
> 
> I call OSRImportFromProj4 with
> "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0
> +k=1.0 +units=m +nadgrids=@null +towgs84=0,0,0,0,0,0,0 +wktext +no_defs"
> 
> and with the returned handle i get the major and minor axis (
> OSRGetSemiMajor/OSRGetSemiMinor). I would expect the both axis to be
> equal,
> but they aren't.
> Instead i'm getting the following result:
> semi_major_axis=6378137
> semi_minor_axis=6356752.314
> 
> Build on Ubuntu 20.10 (groovy; amd64) with libgdal-dev,
> version 3.1.3+dfsg-1ubuntu2) and libproj-dev:amd64 with version 7.1.0-1
> 
> The full example application code:
> https://pastebin.com/xf8QpVhM
> 
> Regards,
> Andreas
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From tobias.wendorff at tu-dortmund.de  Fri Nov  6 03:43:39 2020
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Fri, 6 Nov 2020 12:43:39 +0100
Subject: [gdal-dev] Spherical Mercator Projection mismatching
 major/minor axis
In-Reply-To: <1604660863882-0.post@n6.nabble.com>
References: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>
 <1604660863882-0.post@n6.nabble.com>
Message-ID: <62743fff-48ce-3a5e-d361-bac9f29d49ee@tu-dortmund.de>

Am 06.11.2020 um 12:07 schrieb jratike80:
> This does not really belong to my knowledge area but I'll have a try anyway.

To add a bit of my knowledge, EPSG:3857 is the king/queen of 
unconformness (better unconform-mess):

The geographic reference is based on geographic coordinates in WGS84 
(ellipsoid), the projection is based on a sphere. The background is that 
the spherical math is way easier and it was therefor faster to render 
(and easiert to code). You don't need to solve any integrals etc.

Wikipedia describes the problem:
https://en.wikipedia.org/wiki/Web_Mercator_projection

A discussion about that is appear at least once a year in OpenStreetMap 
community, when a GIS specialist or scientist uses the data for the 
first time ;)

From Nabil.Adechoubou at validatek.com  Fri Nov  6 07:55:25 2020
From: Nabil.Adechoubou at validatek.com (Nabil Adechoubou)
Date: Fri, 6 Nov 2020 15:55:25 +0000
Subject: [gdal-dev] GDAL(Technical support for Extracting Elevations From
 Large DTED Terrain Datasets)
Message-ID: <BN8PR18MB2482DEA0964F4ABD46A17AEB97ED0@BN8PR18MB2482.namprd18.prod.outlook.com>

Greetings,

Our team decided to use GDAL in our code to support certain business requirements. Each time we do an analysis we need the elevation profile lines, our analyses run through 10,000s of such cases across a large area. Which means we need to extract these elevation profile lines 10,000s per session.
Currently, we have a partially-working solution in C# (we're using C# bindings for GDAL) but when we load several DTED files and increase their resolution we run into "OutOfMemoryExceptions". We are  "manually" extract all of the elevations out of these files into large lists in memory (10's of millions of elevations, spread over large area). How would you go about making sure that you could do this quickly and efficiently? We need technical guidance on how to support the objectives we outlined below within the GDAL/OGR framework.

Objectives:
1) We have a large set of terrain files in DTED format, we want to load these into the application
2) We want to potentially warp the terrain data (increase resolution or crop the extents of the terrain data) which they have loaded into the application
3) Once the terrain data is loaded into the application, we want to:
                                                                               * extract elevation profile lines from the terrain data (i.e., the list of elevations, in meters, between two input lat/lon coordinates).
                                                                               * extract elevation, in meters, at a single input lat/lon coordinate.

Regards,

Nabil Adechoubou
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201106/1878e694/attachment.html>

From csbruce at cubewerx.com  Fri Nov  6 10:27:04 2020
From: csbruce at cubewerx.com (Craig Bruce)
Date: Fri, 6 Nov 2020 14:27:04 -0400
Subject: [gdal-dev] Spherical Mercator Projection mismatching
 major/minor axis
In-Reply-To: <1604660863882-0.post@n6.nabble.com>
References: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>
 <1604660863882-0.post@n6.nabble.com>
Message-ID: <b7856f2a-f776-e0f0-eee4-d9da56073b2f@cubewerx.com>

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201106/29efd27c/attachment.html>

From even.rouault at spatialys.com  Fri Nov  6 11:24:22 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 06 Nov 2020 20:24:22 +0100
Subject: [gdal-dev] Spherical Mercator Projection mismatching
	major/minor axis
In-Reply-To: <b7856f2a-f776-e0f0-eee4-d9da56073b2f@cubewerx.com>
References: <CAHjV8nTTM7PFQ7rgLsy21tZAphAF8g5Zamg8K70CPMZiQsyz1A@mail.gmail.com>
 <1604660863882-0.post@n6.nabble.com>
 <b7856f2a-f776-e0f0-eee4-d9da56073b2f@cubewerx.com>
Message-ID: <5839595.iMEXY37nVm@even-i700>

Craig,

> The way I handle it is (slightly older notation):
> 
> PROJCS["WGS84 / Spherical Mercator",
>     GEOGCS["WGS84basedSpheric_GCS",
>         DATUM["WGS84basedSpheric_Datum",
>             SPHEROID["WGS84based_Sphere", 6378137, 0]],
>         PRIMEM["Greenwich", 0],
>         UNIT["degree", 0.0174532925199433]],
>     PROJECTION["Mercator"],
>     PARAMETER["latitude_of_origin", 0],
>     PARAMETER["central_meridian", 0],
>     PARAMETER["false_easting", 0],
>     PARAMETER["false_northing", 0],
>     UNIT["meter", 1],
>     AUTHORITY["EPSG", "3857"]]
> 

The above WKT using plain Mercator and a sphere definition could potentially 
result in incorrect datum transformation being done by some systems if 
transforming coordinates from a non-WGS84 based CRS to this definition 
(actually just testing it with PROJ >= 6 or GDAL <= 2.4, it rejects its 
because it doesn't know the 'Mercator' projection method. Should be 
'Mercator_1SP' for the WKT1 dialect that GDAL/PROJ speaks)

Jukka was quite correct: EPSG:3857 is defined on the WGS 84 datum, but the 
projection method to use is spherical mercator, that is forcing flattening to 
0. See https://epsg.org/crs/wkt/id/3857

> Will GDAL accept a "0" for the inverse of flattening to represent a sphere?

Yes. That's the canonical way of expressing a sphere

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From schwehr at gmail.com  Fri Nov  6 17:49:13 2020
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 6 Nov 2020 17:49:13 -0800
Subject: [gdal-dev] "import gdal" broken in 3.2.0: what to do ?
In-Reply-To: <0140968b-abd9-88bb-98d4-c6970315df9d@uni-bonn.de>
References: <3769540.1hvDmPGJRa@even-i700>
 <0140968b-abd9-88bb-98d4-c6970315df9d@uni-bonn.de>
Message-ID: <CACmBxyuNP6P06idu_w72PgaZ3WdCuyw+=7xWqbtJz8sph+Qg2g@mail.gmail.com>

+1 for dropping the old way

On Thu, Nov 5, 2020, 7:59 AM Kai Mühlbauer <kai.muehlbauer at uni-bonn.de>
wrote:

> Hi,
>
> I'm using GDAL since 2012 and one of the first things I've read is this:
>
> https://trac.osgeo.org/gdal/wiki/GdalOgrInPython
>
> The first mention of the deprecation of this import was added 13 years
> ago. To quote from there:
>
> "
> Additionally, there are five compatibility modules that are included but
> provide notices to state that they are deprecated and will be going
> away. If you are using GDAL 1.5 bindings, you should update your imports
> to utilize the usage above, but the following will work until at least
> GDAL 2.0.
> "
>
> Not sure, if it's worth the effort to reinstate that behaviour. People
> would have to move on anyway, sooner or later. Just my 2c.
>
> Huge thanks to Even and all the other people involved with GDAL and
> OSGEO for providing such great tools!
>
> Cheers,
> Kai
>
>
>
>
>
>
>
> Am 05.11.20 um 15:39 schrieb Even Rouault:
> > Hi,
> >
> > As noted in https://github.com/OSGeo/gdal/issues/3149, the old way of
> > importing the Python bindings with "import gdal" instead of "from osgeo
> import
> > gdal" was accidentally broken in 3.2.0 . The old way has been officially
> > deprecated for many years.
> >
> > Any opinion if we should just acknowledge that removal by updating 3.2
> NEWS or
> > restore back the old import way (per PR
> https://github.com/OSGeo/gdal/pull/
> > 3150) for 3.2.1 ? (whatever we do, at least people using 3.2.0 would be
> > impacted)
> >
> > Even
> >
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201106/3fb08542/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Nov  8 08:33:20 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sun, 8 Nov 2020 16:33:20 +0000
Subject: [gdal-dev] What is the purpose of -nosrcalpha in gdalwarp?
Message-ID: <81e21cab34264ad0851593e42ad4cb91@maanmittauslaitos.fi>

Hi,

I noticed this question from gis.stackexchange https://gis.stackexchange.com/questions/378557/gdalwarp-does-not-use-lanczos-resampling-on-image-with-alpha-channel/378569?noredirect=1#comment618912_378569

It seems that alpha band has some bad effect on the result of lanczos resampling and that can be avoided by using -noscralpha option. From the gdalwarp manual page:
"Prevent the alpha band of a source image to be considered as such (it will be warped as a regular band)".

The option has been added to GDAL version 2.2 but with no mention about any bug that it resolved. What is the difference between warping a band as an alpha band or as a regular band? How users are supposed to know when it is appropriate to use -nosrcalpha switch?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201108/b3b55754/attachment.html>

From even.rouault at spatialys.com  Sun Nov  8 09:35:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 08 Nov 2020 18:35:26 +0100
Subject: [gdal-dev] What is the purpose of -nosrcalpha in gdalwarp?
In-Reply-To: <81e21cab34264ad0851593e42ad4cb91@maanmittauslaitos.fi>
References: <81e21cab34264ad0851593e42ad4cb91@maanmittauslaitos.fi>
Message-ID: <3862472.SQY58gH9qt@even-i700>

On dimanche 8 novembre 2020 16:33:20 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I noticed this question from gis.stackexchange
> https://gis.stackexchange.com/questions/378557/gdalwarp-does-not-use-lanczo
> s-resampling-on-image-with-alpha-channel/378569?noredirect=1#comment618912_3
> 78569
> 
> It seems that alpha band has some bad effect on the result of lanczos
> resampling and that can be avoided by using -noscralpha option. From the
> gdalwarp manual page: "Prevent the alpha band of a source image to be
> considered as such (it will be warped as a regular band)".
> The option has been added to GDAL version 2.2 but with no mention about any
> bug that it resolved.
> What is the difference between warping a band as an
> alpha band or as a regular band? How users are supposed to know when it is
> appropriate to use -nosrcalpha switch?

I don't remember the use case unfortunately. But an alpha band is wrapped in a 
particular way with alpha blending logic. -nosrcalpha doesn't affect only the 
way the alpha band is wrapped, but how other bands are. with -nosrcalpha, 
there's no alpha blending for other bands either.

For the gis.stackexchange case, the source image looks to have wrong metadata. 
When you look at the band of the supposedly alpha band, it doesn't look at all 
like an alpha band but as a regular one. And the nodata=255 setting is an 
extra weirdness.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Nabil.Adechoubou at validatek.com  Sun Nov  8 16:50:02 2020
From: Nabil.Adechoubou at validatek.com (Nabil Adechoubou)
Date: Mon, 9 Nov 2020 00:50:02 +0000
Subject: [gdal-dev] GDAL(Technical support for Extracting Elevations
Message-ID: <BN8PR18MB2482E82DC0B77313266A67BF97EA0@BN8PR18MB2482.namprd18.prod.outlook.com>

Greetings,

Our team decided to use GDAL in our code to support certain business requirements. Each time we do an analysis we need the elevation profile lines, our analyses run through 10,000s of such cases across a large area. Which means we need to extract these elevation profile lines 10,000s per session.
Currently, we have a partially-working solution in C# (we're using C# bindings for GDAL) but when we load several DTED files and increase their resolution we run into "OutOfMemoryExceptions". We are  "manually" extract all of the elevations out of these files into large lists in memory (10's of millions of elevations, spread over large area). How would you go about making sure that you could do this quickly and efficiently? We need technical guidance on how to support the objectives we outlined below within the GDAL/OGR framework.

Objectives:
1) We have a large set of terrain files in DTED format, we want to load these into the application
2) We want to potentially warp the terrain data (increase resolution or crop the extents of the terrain data) which they have loaded into the application
3) Once the terrain data is loaded into the application, we want to:
                                                                               * extract elevation profile lines from the terrain data (i.e., the list of elevations, in meters, between two input lat/lon coordinates).
                                                                               * extract elevation, in meters, at a single input lat/lon coordinate.

Regards,


-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of gdal-dev-request at lists.osgeo.org
Sent: Friday, November 6, 2020 3:00 PM
To: gdal-dev at lists.osgeo.org
Subject: gdal-dev Digest, Vol 198, Issue 9

EXTERNAL


Send gdal-dev mailing list submissions to
        gdal-dev at lists.osgeo.org

To subscribe or unsubscribe via the World Wide Web, visit
        https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
        gdal-dev-request at lists.osgeo.org

You can reach the person managing the list at
        gdal-dev-owner at lists.osgeo.org

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Re: Spherical Mercator Projection mismatching major/minor
      axis (jratike80)
   2. Re: Spherical Mercator Projection mismatching major/minor
      axis (Tobias Wendorff)
   3. GDAL(Technical support for Extracting Elevations From Large
      DTED Terrain Datasets) (Nabil Adechoubou)
   4. Re: Spherical Mercator Projection mismatching major/minor
      axis (Craig Bruce)
   5. Re: Spherical Mercator Projection mismatching     major/minor
      axis (Even Rouault)


----------------------------------------------------------------------

Message: 1
Date: Fri, 6 Nov 2020 04:07:43 -0700 (MST)
From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Spherical Mercator Projection mismatching
        major/minor axis
Message-ID: <1604660863882-0.post at n6.nabble.com>
Content-Type: text/plain; charset=us-ascii

Hi,

This does not really belong to my knowledge area but I'll have a try anyway.

Check what you have after reading the proj string instead. Here with Python

>>> from osgeo import osr
>>> spatialRef = osr.SpatialReference()
>>> spatialRef.ImportFromProj4("+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0
>>> +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null
>>> +towgs84=0,0,0,0,0,0,0 +wktext +no_defs")
>>> print(spatialRef)
PROJCS["WGS 84 / Pseudo-Mercator",
    GEOGCS["WGS 84",
        DATUM["WGS_1984",
            SPHEROID["WGS 84",6378137,298.257223563,
                AUTHORITY["EPSG","7030"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6326"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4326"]],
    PROJECTION["Mercator_1SP"],
    PARAMETER["central_meridian",0],
    PARAMETER["scale_factor",1],
    PARAMETER["false_easting",0],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    EXTENSION["PROJ4","+proj=merc +a=6378137 +b=6378137 +lat_ts=0 +lon_0=0
+x_0=0 +y_0=0 +k=1 +units=m +nadgrids=@null +wktext +no_defs"]]


It means that GDAL makes a clever guess and considers that the Proj string
that you provided means EPSG:3857. You probably mean the same. And in the
EPSG database EPSG:3857 is based on WGS84 ellipsoid
https://epsg.org/crs/wkt/id/3857

 ELLIPSOID["WGS 84",6378137,298.257223563,

and that it behaves in spherical way is handled by a special conversion

CONVERSION["Popular Visualisation Pseudo-Mercator",

I am not sure what to do if you definitely want to keep the ball with
diameter of 6378137 meters but perhaps dropping +nadgrids=@null could do it.
If EPSG:3857 is what you really need then it takes less writing to import by
the EPSG code but your way gives the same result.

-Jukka Rahkonen-





Andreas Roth wrote
> Hi,
>
> I call OSRImportFromProj4 with
> "+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0
> +k=1.0 +units=m +nadgrids=@null +towgs84=0,0,0,0,0,0,0 +wktext +no_defs"
>
> and with the returned handle i get the major and minor axis (
> OSRGetSemiMajor/OSRGetSemiMinor). I would expect the both axis to be
> equal,
> but they aren't.
> Instead i'm getting the following result:
> semi_major_axis=6378137
> semi_minor_axis=6356752.314
>
> Build on Ubuntu 20.10 (groovy; amd64) with libgdal-dev,
> version 3.1.3+dfsg-1ubuntu2) and libproj-dev:amd64 with version 7.1.0-1
>
> The full example application code:
> https://pastebin.com/xf8QpVhM
>
> Regards,
> Andreas
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html


------------------------------

Message: 2
Date: Fri, 6 Nov 2020 12:43:39 +0100
From: Tobias Wendorff <tobias.wendorff at tu-dortmund.de>
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Spherical Mercator Projection mismatching
        major/minor axis
Message-ID: <62743fff-48ce-3a5e-d361-bac9f29d49ee at tu-dortmund.de>
Content-Type: text/plain; charset=utf-8; format=flowed

Am 06.11.2020 um 12:07 schrieb jratike80:
> This does not really belong to my knowledge area but I'll have a try anyway.

To add a bit of my knowledge, EPSG:3857 is the king/queen of
unconformness (better unconform-mess):

The geographic reference is based on geographic coordinates in WGS84
(ellipsoid), the projection is based on a sphere. The background is that
the spherical math is way easier and it was therefor faster to render
(and easiert to code). You don't need to solve any integrals etc.

Wikipedia describes the problem:
https://en.wikipedia.org/wiki/Web_Mercator_projection

A discussion about that is appear at least once a year in OpenStreetMap
community, when a GIS specialist or scientist uses the data for the
first time ;)


------------------------------

Message: 3
Date: Fri, 6 Nov 2020 15:55:25 +0000
From: Nabil Adechoubou <Nabil.Adechoubou at validatek.com>
To: "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
Cc: Vladislav Martin <Vladislav.Martin at validatek.com>
Subject: [gdal-dev] GDAL(Technical support for Extracting Elevations
        From Large DTED Terrain Datasets)
Message-ID:
        <BN8PR18MB2482DEA0964F4ABD46A17AEB97ED0 at BN8PR18MB2482.namprd18.prod.outlook.com>

Content-Type: text/plain; charset="utf-8"

Greetings,

Our team decided to use GDAL in our code to support certain business requirements. Each time we do an analysis we need the elevation profile lines, our analyses run through 10,000s of such cases across a large area. Which means we need to extract these elevation profile lines 10,000s per session.
Currently, we have a partially-working solution in C# (we're using C# bindings for GDAL) but when we load several DTED files and increase their resolution we run into "OutOfMemoryExceptions". We are  "manually" extract all of the elevations out of these files into large lists in memory (10's of millions of elevations, spread over large area). How would you go about making sure that you could do this quickly and efficiently? We need technical guidance on how to support the objectives we outlined below within the GDAL/OGR framework.

Objectives:
1) We have a large set of terrain files in DTED format, we want to load these into the application
2) We want to potentially warp the terrain data (increase resolution or crop the extents of the terrain data) which they have loaded into the application
3) Once the terrain data is loaded into the application, we want to:
                                                                               * extract elevation profile lines from the terrain data (i.e., the list of elevations, in meters, between two input lat/lon coordinates).
                                                                               * extract elevation, in meters, at a single input lat/lon coordinate.

Regards,

Nabil Adechoubou
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201106/1878e694/attachment-0001.html>

------------------------------

Message: 4
Date: Fri, 6 Nov 2020 14:27:04 -0400
From: Craig Bruce <csbruce at cubewerx.com>
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] Spherical Mercator Projection mismatching
        major/minor axis
Message-ID: <b7856f2a-f776-e0f0-eee4-d9da56073b2f at cubewerx.com>
Content-Type: text/plain; charset="utf-8"

An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201106/29efd27c/attachment-0001.html>

------------------------------

Message: 5
Date: Fri, 06 Nov 2020 20:24:22 +0100
From: Even Rouault <even.rouault at spatialys.com>
To: gdal-dev at lists.osgeo.org
Cc: Craig Bruce <csbruce at cubewerx.com>
Subject: Re: [gdal-dev] Spherical Mercator Projection mismatching
        major/minor axis
Message-ID: <5839595.iMEXY37nVm at even-i700>
Content-Type: text/plain; charset="us-ascii"

Craig,

> The way I handle it is (slightly older notation):
>
> PROJCS["WGS84 / Spherical Mercator",
>     GEOGCS["WGS84basedSpheric_GCS",
>         DATUM["WGS84basedSpheric_Datum",
>             SPHEROID["WGS84based_Sphere", 6378137, 0]],
>         PRIMEM["Greenwich", 0],
>         UNIT["degree", 0.0174532925199433]],
>     PROJECTION["Mercator"],
>     PARAMETER["latitude_of_origin", 0],
>     PARAMETER["central_meridian", 0],
>     PARAMETER["false_easting", 0],
>     PARAMETER["false_northing", 0],
>     UNIT["meter", 1],
>     AUTHORITY["EPSG", "3857"]]
>

The above WKT using plain Mercator and a sphere definition could potentially
result in incorrect datum transformation being done by some systems if
transforming coordinates from a non-WGS84 based CRS to this definition
(actually just testing it with PROJ >= 6 or GDAL <= 2.4, it rejects its
because it doesn't know the 'Mercator' projection method. Should be
'Mercator_1SP' for the WKT1 dialect that GDAL/PROJ speaks)

Jukka was quite correct: EPSG:3857 is defined on the WGS 84 datum, but the
projection method to use is spherical mercator, that is forcing flattening to
0. See https://epsg.org/crs/wkt/id/3857

> Will GDAL accept a "0" for the inverse of flattening to represent a sphere?

Yes. That's the canonical way of expressing a sphere

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com


------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

------------------------------

End of gdal-dev Digest, Vol 198, Issue 9
****************************************

From a.muslic at outlook.com  Mon Nov  9 00:26:17 2020
From: a.muslic at outlook.com (=?iso-8859-2?Q?Aneta_Musli=E6?=)
Date: Mon, 9 Nov 2020 08:26:17 +0000
Subject: [gdal-dev] Encoding when creating pdf
In-Reply-To: <CAHBySPb704joFY3piHTJ2jya4aAi6iovyKL5SgV2XkZd-3TwyA@mail.gmail.com>
References: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>,
 <CAHBySPb704joFY3piHTJ2jya4aAi6iovyKL5SgV2XkZd-3TwyA@mail.gmail.com>
Message-ID: <VI1PR03MB6253DAEE2B335BB6F3CA2B6D9EEA0@VI1PR03MB6253.eurprd03.prod.outlook.com>

Yes, it does.
The problem is that gdal uses ansi as a default encoding when given font in label, and that cannot be changed.


________________________________
From: Richard Greenwood <richard.greenwood at gmail.com>
Sent: Thursday, November 5, 2020 4:27 PM
To: Aneta Muslić <a.muslic at outlook.com>
Cc: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Encoding when creating pdf

Do your shapefiles include a code page file (*.cpg)? If not, maybe that would help.

On Wed, Nov 4, 2020 at 2:57 AM Aneta Muslić <a.muslic at outlook.com<mailto:a.muslic at outlook.com>> wrote:
Hello,

I am using gdal version 2.4.4 in my c# app.
As a part of my project I am creating pdf with gdal_translate command. GDAL translate command is
"gdal_translate  --config SHAPE_ENCODING "utf-8" -of PDF -tr 0.001 0.001 -a_srs EPSG:3765 Granice.tif Sisacko_moslavacka_zupanija3.pdf -co OGR_DATASOURCE=Extent.vrt".

Part of vrt file that displays labels is:
<OGRVRTLayer name="SHPCounties">
<SrcDataSource relativeToVRT="0">MSSQL: driver={SQL Server Native Client 11.0};
server=xxx;uid=xx;pwd=xx;database=HAPIH;
Integrated Security=False;MARS_Connection=yes</SrcDataSource>
<SrcLayer>SHPCounties</SrcLayer>
<LayerSRS>EPSG:3765</LayerSRS>
<SrcSQL>
select Geometry.STCentroid() as pointPolygonCounties,
CAST(Name AS varchar(100)) COLLATE Croatian_CI_AI AS NameCollated,
'LABEL(f:"Times New Roman",t:{NameCollated},c:#000000,s:40pt)' AS OGR_STYLE
FROM SHPCounties
</SrcSQL>
<GeometryType>wkbPoints</GeometryType>
<GeometryField name="pointPolygonCounties" />
</OGRVRTLayer>

My labels have special characters (č and ć). I defined encoding to utf-8 and gdal-config as utf-8 but in generated pdf under fonts I can see that the font used is Times New Roman with encoding ansi, and characters č and ć are replaced with c because ansi doesn't support those letters. I tried writing just the letter 'č' to pdf so I can eliminate that the problem is in database but it is replaced with something else in pdf,  also I tried using html entity for those letters but it doesn't help.

I would like to know how can I define in label options of vrt file for it to use font with custom encoding and not ansi encoding so it can display my special characters or there is another way for me to display those special characters.

Thank you.

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
Richard W. Greenwood, PLS
www.greenwoodmap.com<http://www.greenwoodmap.com>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201109/cd011116/attachment-0001.html>

From a.nieuwland at sobolt.com  Mon Nov  9 02:40:02 2020
From: a.nieuwland at sobolt.com (Arthur Nieuwland)
Date: Mon, 9 Nov 2020 11:40:02 +0100
Subject: [gdal-dev] Best way to get GPU accelerated GDAL binaries?
Message-ID: <CAFoDu4TGDP8MS3ATsp7=BUFsGBpVnRETAjPBV_NuWj=xwFws7w@mail.gmail.com>

Hello mailing list,

I am trying to use gdalwarp and gdal_translate to do manipulations on a
large raster using a vector file. The process is taking very long (a week
by my estimation), I assume because the raster is large and the vector file
complex.

For that reason I want to accelerate the calculations using GPU/OpenCL
acceleration. What is the best way to get such binaries? Is there maybe a
docker image with such binaries? Or a tgz prebuilt with CUDA/OpenCL support?

I tried compiling it myself with GDAL 2.4.2 on Ubuntu 16.04 with 9.0. While
the compilation failed, running the binaries resulted in a core dump. If
compiling is the best way, what configuration (Linux distro / CUDA version
/ ...) works well?

Lastly, does GPU acceleration help gdalwarp mask faster? The raster is
409600 by 241600 pixels, data type byte with 2 bits. The command I want to
run is:

    gdalwarp -cutline <complex gpkg> -srcnodata 3 -dstnodata 3 -co
BIGTIFF=yes -multi -co tiled=yes in.vrt out.tif

To summarize, I'd like to know:

1. Do prebuilt binaries exist with GPU acceleration enabled?
2. If I need to compile them myself, what are the best versions to do so
with?
3. Optionally, will GPU acceleration help me mask my input raster?

Thanks in advance,
Arthur Nieuwland
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201109/cc2509ad/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov  9 05:25:06 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 9 Nov 2020 13:25:06 +0000
Subject: [gdal-dev] Selecting just the geometry column with OGR SQL
Message-ID: <26a7bf2bb89f42eead55c6fe19b6ff52@maanmittauslaitos.fi>


Hi,

I believe that OGR SQL dialect adds the geometry column into SQL selection by default. Am I right with this? I volunteer to edit the documentation https://gdal.org/user/ogr_sql_dialect.html if this is the case. But what I can't understand is another side of the story, how to select just the geometry field with OGR SQL dialect from some data sources.

This command returns both time column and geometry from GML
ogrinfo -sql "select time from timetest" timetest.gml
I can select just the geometry from geometry column named as "geometryProperty" by
ogrinfo -sql "select geometryProperty from timetest" timetest.gml

The behavior is the same with SpatiaLite when I use "-dialect OGRSQL". Geometry is selected automatically but it can be selected also by name. But I cannot discover any way to select just the geometry field from shapefile. Is it because geometry column in shapefile does not have any name as this Python test seems to prove?

>>> from osgeo import ogr
>>> shp_ds = ogr.Open('timetest.shp')
>>> shp_lyr = shp_ds.GetLayer(0)
>>> shp_lyr.GetGeometryColumn()
''

OpenJUMP JML driver does not report a name for geometry column either. Is it rather an exception that drivers give names for the geometry columns? I know I can select only the geometry column with the SQLite dialect, but I am curious.

-Jukka Rahkonen-






-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201109/44a0429b/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Mon Nov  9 06:06:28 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Mon, 9 Nov 2020 11:06:28 -0300
Subject: [gdal-dev] WCS_GDAL Driver Image SubSet Request
Message-ID: <CAKTKyJK5XbHW_YzKm5FrVHZo+sy_y1TJc41njrGsqnUcsd58zA@mail.gmail.com>

Hi all,

Is it possible to define a bounding box in order to request a coverage
subset using the GDAL WCS Driver?
I have tried the code in [1]. I  am trying to get information only for the
bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
image or bbox_interest request has not been delivered. The West Longitude
reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
of the bbox_interest.
The image extent is:
<GetCoverageExtra>&amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637</GetCoverageExtra>
 Any comment on this issue will be greatly appreciated.
Thank you very much for your time in advance.
*CODE [1]:*

<WCS_GDAL>
<ServiceURL>http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;</
ServiceURL>
<CoverageName>cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020</
CoverageName>
<GetCoverageExtra>&amp;BoundingBox=-58,-11,-57.75,-10.75</GetCoverageExtra>
<CoverageOffering>
<description>Generated from GeoTIFF</description>
<name>cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020</name>
<label>CBERS-4_AWFI_170_111_21052020</label>
<lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
<pos>-58 -11</pos>
<pos>-57.75 -10.75</pos>
</lonLatEnvelope>
<keywords>
<keyword>WCS</keyword>
<keyword>GeoTIFF</keyword>
</keywords>
<domainSet>
<spatialDomain>
<Envelope srsName="EPSG:4326">
<pos>-58 -11</pos>
<pos>-57.75 -10.75</pos>
</Envelope>
<RectifiedGrid dimension="2" srsName="EPSG:4326">
<limits>
<GridEnvelope>
<low>0 0</low>
<high>0 0</high>
</GridEnvelope>
</limits>
<axisName>x</axisName>
<axisName>y</axisName>
<origin>
<pos>-58 -10.75</pos>
</origin>
<offsetVector>0.005364603321609328 0.0</offsetVector>
<offsetVector>0.0 -0.004532028600570188</offsetVector>
</RectifiedGrid>
</spatialDomain>
</domainSet>
<rangeSet>
<RangeSet>
<name>CBERS-4_AWFI_170_111_21052020</name>
<label>CBERS-4_AWFI_170_111_21052020</label>
<axisDescription>
<AxisDescription>
<name>Band</name>
<label>Band</label>
<values>
<interval>
<min>1</min>
<max>4</max>
</interval>
</values>
</AxisDescription>
</axisDescription>
</RangeSet>
</rangeSet>
<supportedCRSs>
<requestResponseCRSs>EPSG:4326</requestResponseCRSs>
</supportedCRSs>
<supportedFormats nativeFormat="GeoTIFF">
<formats>GeoTIFF</formats>
<formats>GIF</formats>
<formats>JPEG</formats>
<formats>PNG</formats>
<formats>TIFF</formats>
</supportedFormats>
<supportedInterpolations default="nearest neighbor">
<interpolationMethod>nearest neighbor</interpolationMethod>
<interpolationMethod>bilinear</interpolationMethod>
<interpolationMethod>bicubic</interpolationMethod>
</supportedInterpolations>
</CoverageOffering>
<PreferredFormat>GeoTIFF</PreferredFormat>
<BandCount>4</BandCount>
<BandType>Byte</BandType>
</WCS_GDAL>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201109/b2180b57/attachment-0001.html>

From even.rouault at spatialys.com  Mon Nov  9 07:09:45 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 09 Nov 2020 16:09:45 +0100
Subject: [gdal-dev] Selecting just the geometry column with OGR SQL
In-Reply-To: <26a7bf2bb89f42eead55c6fe19b6ff52@maanmittauslaitos.fi>
References: <26a7bf2bb89f42eead55c6fe19b6ff52@maanmittauslaitos.fi>
Message-ID: <1659214.2tRo4lr4Oo@even-i700>

Jukka,

> I believe that OGR SQL dialect adds the geometry column into SQL selection
> by default. Am I right with this? I volunteer to edit the documentation
> https://gdal.org/user/ogr_sql_dialect.html if this is the case. But what I
> can't understand is another side of the story, how to select just the
> geometry field with OGR SQL dialect from some data sources.
> 
> This command returns both time column and geometry from GML
> ogrinfo -sql "select time from timetest" timetest.gml
> I can select just the geometry from geometry column named as
> "geometryProperty" by ogrinfo -sql "select geometryProperty from timetest"
> timetest.gml
> 
> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> Geometry is selected automatically but it can be selected also by name. But
> I cannot discover any way to select just the geometry field from shapefile.
> Is it because geometry column in shapefile does not have any name as this
> Python test seems to prove?
> >>> from osgeo import ogr
> >>> shp_ds = ogr.Open('timetest.shp')
> >>> shp_lyr = shp_ds.GetLayer(0)
> >>> shp_lyr.GetGeometryColumn()
> 
> ''
> 
> OpenJUMP JML driver does not report a name for geometry column either. Is it
> rather an exception that drivers give names for the geometry columns? I
> know I can select only the geometry column with the SQLite dialect, but I
> am curious.

Indeed, in OGR SQL, if the geometry column has a non-empty name (typically for 
database drivers), you can use it to select it. When the geometry column name 
is empty, such as in the shapefile or OpenJUMP driver, you can use 
_ogr_geometry_ (with leading and trainling underscore) to select it. This is 
likely undocumented.

As far as I can see, this was introduced per
https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
to fix an issue with comparison with empty string literals (this was before 
OGR enforced the difference between single-quoted string literals and double-
quoted identifiers)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov  9 07:35:11 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 9 Nov 2020 15:35:11 +0000
Subject: [gdal-dev] Selecting just the geometry column with OGR SQL
Message-ID: <d59795ddfd994dee9f5eca836361324a@maanmittauslaitos.fi>

Even Rouault wrote: 
maanantai 9. marraskuuta 2020 17.10

> Jukka,

>> I believe that OGR SQL dialect adds the geometry column into SQL 
>> selection by default. Am I right with this? I volunteer to edit the 
>> documentation https://gdal.org/user/ogr_sql_dialect.html if this is 
>> the case. But what I can't understand is another side of the story, 
>> how to select just the geometry field with OGR SQL dialect from some data sources.
>> 
>> This command returns both time column and geometry from GML ogrinfo 
>> -sql "select time from timetest" timetest.gml I can select just the 
>> geometry from geometry column named as "geometryProperty" by ogrinfo 
>> -sql "select geometryProperty from timetest"
>> timetest.gml
>> 
>> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
>> Geometry is selected automatically but it can be selected also by 
>> name. But I cannot discover any way to select just the geometry field from shapefile.
>> Is it because geometry column in shapefile does not have any name as 
>> this Python test seems to prove?
>> >>> from osgeo import ogr
>> >>> shp_ds = ogr.Open('timetest.shp')
>> >>> shp_lyr = shp_ds.GetLayer(0)
>> >>> shp_lyr.GetGeometryColumn()
>> 
>> ''
>> 
>> OpenJUMP JML driver does not report a name for geometry column either. 
>> Is it rather an exception that drivers give names for the geometry 
>> columns? I know I can select only the geometry column with the SQLite 
>> dialect, but I am curious.

> Indeed, in OGR SQL, if the geometry column has a nonempty name (typically for 
> database drivers), you can use it to select it. When the geometry column name 
> is empty, such as in the shapefile or OpenJUMP driver, you can use 
> _ogr_geometry_ (with leading and trainling underscore) to select it. This is likely undocumented.

> As far as I can see, this was introduced per 
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> to fix an issue with comparison with empty string literals (this was before OGR enforced the
>  difference between single-quoted string literals and double- quoted identifiers)

I could not manage to guess the right syntax for Windows right ahead but solved the quiz easily 
with your double-quote hint

First trial:
ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
INFO: Open of `timetest.shp'
      using driver `ESRI Shapefile' successful.
ERROR 1: SQL Expression Parsing Error: syntax error, unexpected $undefined. Occurred around :
select _ogr_geometry_ from timetest

Second trial:
ogrinfo -sql "select \"_ogr_geometry_\" from timetest" timetest.shp 

-Jukka-

> Even

--
Spatialys - Geospatial professional services http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov  9 07:47:05 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
Subject: [gdal-dev] WCS_GDAL Driver Image SubSet Request
In-Reply-To: <CAKTKyJK5XbHW_YzKm5FrVHZo+sy_y1TJc41njrGsqnUcsd58zA@mail.gmail.com>
References: <CAKTKyJK5XbHW_YzKm5FrVHZo+sy_y1TJc41njrGsqnUcsd58zA@mail.gmail.com>
Message-ID: <1604936825138-0.post@n6.nabble.com>

Hi,

Do you want to make is somehow impossible to request data beyound the
BoundingBox that you defined in the XML file? If you just want to get data
from the rectangle that you or your users define, gdal_translate with the
regular -spat option should work out-of-the-box.

-Jukka Rahkonen- 


juliermeopensourcedeveloper wrote
> Hi all,
> 
> Is it possible to define a bounding box in order to request a coverage
> subset using the GDAL WCS Driver?
> I have tried the code in [1]. I  am trying to get information only for the
> bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
> image or bbox_interest request has not been delivered. The West Longitude
> reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
> of the bbox_interest.
> The image extent is:
> <GetCoverageExtra>
> &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
> </GetCoverageExtra>
>  Any comment on this issue will be greatly appreciated.
> Thank you very much for your time in advance.
> *CODE [1]:*
> <WCS_GDAL>
> <ServiceURL>
> http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
> </
> ServiceURL>
> <CoverageName>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </
> CoverageName>
> <GetCoverageExtra>
> &amp;BoundingBox=-58,-11,-57.75,-10.75
> </GetCoverageExtra>
> <CoverageOffering>
> <description>
> Generated from GeoTIFF
> </description>
> <name>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </lonLatEnvelope>
> <keywords>
> <keyword>
> WCS
> </keyword>
> <keyword>
> GeoTIFF
> </keyword>
> </keywords>
> <domainSet>
> <spatialDomain>
> <Envelope srsName="EPSG:4326">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </Envelope>
> <RectifiedGrid dimension="2" srsName="EPSG:4326">
> <limits>
> <GridEnvelope>
> <low>
> 0 0
> </low>
> <high>
> 0 0
> </high>
> </GridEnvelope>
> </limits>
> <axisName>
> x
> </axisName>
> <axisName>
> y
> </axisName>
> <origin>
> <pos>
> -58 -10.75
> </pos>
> </origin>
> <offsetVector>
> 0.005364603321609328 0.0
> </offsetVector>
> <offsetVector>
> 0.0 -0.004532028600570188
> </offsetVector>
> </RectifiedGrid>
> </spatialDomain>
> </domainSet>
> <rangeSet>
> <RangeSet>
> <name>
> CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <axisDescription>
> <AxisDescription>
> <name>
> Band
> </name>
> <label>
> Band
> </label>
> <values>
> <interval>
> <min>
> 1
> </min>
> <max>
> 4
> </max>
> </interval>
> </values>
> </AxisDescription>
> </axisDescription>
> </RangeSet>
> </rangeSet>
> <supportedCRSs>
> <requestResponseCRSs>
> EPSG:4326
> </requestResponseCRSs>
> </supportedCRSs>
> <supportedFormats nativeFormat="GeoTIFF">
> <formats>
> GeoTIFF
> </formats>
> <formats>
> GIF
> </formats>
> <formats>
> JPEG
> </formats>
> <formats>
> PNG
> </formats>
> <formats>
> TIFF
> </formats>
> </supportedFormats>
> <supportedInterpolations default="nearest neighbor">
> <interpolationMethod>
> nearest neighbor
> </interpolationMethod>
> <interpolationMethod>
> bilinear
> </interpolationMethod>
> <interpolationMethod>
> bicubic
> </interpolationMethod>
> </supportedInterpolations>
> </CoverageOffering>
> <PreferredFormat>
> GeoTIFF
> </PreferredFormat>
> <BandCount>
> 4
> </BandCount>
> <BandType>
> Byte
> </BandType>
> </WCS_GDAL>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From Jon.Morris at jbarisk.com  Tue Nov 10 00:12:11 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Tue, 10 Nov 2020 08:12:11 +0000
Subject: [gdal-dev] GDAL conda build
Message-ID: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

I've been trying to build a Windows conda package for GDAL 3.1.4, but am having problems with the poppler headers. I'm using the conda-forge recipe, which includes a line in the build script to detect the poppler version.

FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
  set POPPLER_MAJOR_VERSION=%%a
  set POPPLER_MINOR_VERSION=%%b
)
https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16

This doesn't seem to be working, as when we get to compiling the pdf driver, the headers are missing.

(gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc   && cd ..   || exit 1
        cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore  -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0 -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED  -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp pdfcreatefromcomposition.cpp
pdfdataset.cpp
pdfio.cpp
pdfobject.cpp
pdfcreatecopy.cpp
c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54): fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file or directory (compiling source file pdfdataset.cpp)

In pdfsdkheaders.h we can see it's the wrong poppler version that's causing the error:

#if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
#include <goo/gtypes.h>
#else
typedef unsigned char Guchar;
#endif

The installed version of poppler is 20.11.0, so I don't know why I'm getting major version set to 0 and minor version set to 23.

I'll also ask over at conda as this is most likely a conda build problem, but I thought I would also ask here if anyone has successfully built a conda package and knows how to get this recipe working.

Many thanks!

Jon


Jon Morris
Software Developer

COVID-19. During the current outbreak JBA remains open for business and we continue to deliver our services. However, we have adopted flexible/remote working as required. I will be receiving and reading email as normal but I may not always be available on the office number.


[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201110/604b3551/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Tue Nov 10 08:09:59 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Tue, 10 Nov 2020 13:09:59 -0300
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
In-Reply-To: <mailman.3.1604952001.20282.gdal-dev@lists.osgeo.org>
References: <mailman.3.1604952001.20282.gdal-dev@lists.osgeo.org>
Message-ID: <CAKTKyJK50ygcMa-15y9zbroZ7kHxYMH-Uz2WFMRTbocUSA121Q@mail.gmail.com>

Dear Jukka Rahkonen,

Thank you very much for your reply.

First of all, my apologies for my lack of knowledge about using GDAL_WCS
driver. Let me give more details about the issues I am facing.

Extract of
http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities is shown
in [1].

Regarding gdal_translate GDAL_WCS driver Image subset extract, looking at
https://gdal.org/drivers/raster/wcs.html#examples, I tried the following:

Similar to GDAL_WMTS <gdal_translate "WMTS:
http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -
of WMTS>,
I tried running:
(1)
 gdal_translate "WCS:
http://172.21.14.45:8181/geoserver/wcs?version=2.0.1&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
CBERS-4_AWFI_170_111_21052020.xml

*The response:* I did not get the xml as wmts.xml showed above

Note: Including the -of option (WCS), the outcome fails

(2)
gdal_translate "WCS:
http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
\
-spat -58 -11 -57.75 -10.7 \
CBERS-4_AWFI_170_111_21052020.xml

*The response:* There is no -spat option for gdal_translate

*gdal_translate --help*

Usage: gdal_translate [--help-general] [--long-usage]
       [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
             CInt16/CInt32/CFloat32/CFloat64}] [-strict]
       [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
       [-outsize xsize[%]|0 ysize[%]|0] [-tr xres yres]
       [-r {nearest,bilinear,cubic,cubicspline,lanczos,average,mode}]
       [-unscale] [-scale[_bn] [src_min src_max [dst_min dst_max]]]*
[-exponent[_bn] exp_val]*
       [-srcwin xoff yoff xsize ysize] [-epo] [-eco]
       [-projwin ulx uly lrx lry] [-projwin_srs srs_def]
       [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
       [-a_scale value] [-a_offset value]
       [-nogcp] [-gcp pixel line easting northing [elevation]]*
       |-colorinterp{_bn} {red|green|blue|alpha|gray|undefined}]
       |-colorinterp {red|green|blue|alpha|gray|undefined},...]
       [-mo "META-TAG=VALUE"]* [-q] [-sds]
       [-co "NAME=VALUE"]* [-stats] [-norat]
       [-oo NAME=VALUE]*
       src_dataset dst_dataset



[1] WCS GetCapabilities request

<wcs:CoverageSummary>
<ows:Title>CBERS-4_AWFI_170_111_21052020</ows:Title>
<ows:Abstract>Generated from GeoTIFF</ows:Abstract>
<ows:Keywords>
<ows:Keyword>deter-amazonia-CBERS-4_AWFI_170_111_21052020</ows:Keyword>
<ows:Keyword>WCS</ows:Keyword>
<ows:Keyword>GeoTIFF</ows:Keyword>
</ows:Keywords>
<wcs:CoverageId>deter-amazonia__CBERS-4_AWFI_170_111_21052020
</wcs:CoverageId>
<wcs:CoverageSubtype>RectifiedGridCoverage</wcs:CoverageSubtype>
<ows:WGS84BoundingBox>
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:WGS84BoundingBox>
<ows:BoundingBox crs="http://www.opengis.net/def/crs/EPSG/0/EPSG:4326">
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:BoundingBox>
</wcs:CoverageSummary>


Any comment will be very appreciated.

GDAL website <https://gdal.org/drivers/raster/wmts.html> provides examples
on how to run GDAL_WMTS driver in order to get a wmts xml file. I have
looked in https://gdal.org/drivers/raster/wcs.html and could not find an
example pointing to -spat option.  I got an -spat option
to gdal_grid
<https://gdal.org/programs/gdal_grid.html?highlight=spat#cmdoption-gdal_grid-spat>
though.

gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"
wmts.xml -of WMTS

gdal_translate "WCS:http://www.dpi.inpe.br/fipcerrado-geoserver/ows/wcs?request=GetCapabilities"
\

-oo CoverageName=deter-cerrado:CBERS-4_AWFI_161_099_13072018
CBERS-4_AWFI_161_099_13072018.xml -of WCS



On Mon, Nov 9, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org> wrote:

> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. Re: Selecting just the geometry column with OGR SQL (Even Rouault)
>    2. Re: Selecting just the geometry column with OGR SQL
>       (Rahkonen Jukka (MML))
>    3. Re: WCS_GDAL Driver Image SubSet Request (jratike80)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 09 Nov 2020 16:09:45 +0100
> From: Even Rouault <even.rouault at spatialys.com>
> To: gdal-dev at lists.osgeo.org
> Cc: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
> Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
>         SQL
> Message-ID: <1659214.2tRo4lr4Oo at even-i700>
> Content-Type: text/plain; charset="us-ascii"
>
> Jukka,
>
> > I believe that OGR SQL dialect adds the geometry column into SQL
> selection
> > by default. Am I right with this? I volunteer to edit the documentation
> > https://gdal.org/user/ogr_sql_dialect.html if this is the case. But
> what I
> > can't understand is another side of the story, how to select just the
> > geometry field with OGR SQL dialect from some data sources.
> >
> > This command returns both time column and geometry from GML
> > ogrinfo -sql "select time from timetest" timetest.gml
> > I can select just the geometry from geometry column named as
> > "geometryProperty" by ogrinfo -sql "select geometryProperty from
> timetest"
> > timetest.gml
> >
> > The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> > Geometry is selected automatically but it can be selected also by name.
> But
> > I cannot discover any way to select just the geometry field from
> shapefile.
> > Is it because geometry column in shapefile does not have any name as this
> > Python test seems to prove?
> > >>> from osgeo import ogr
> > >>> shp_ds = ogr.Open('timetest.shp')
> > >>> shp_lyr = shp_ds.GetLayer(0)
> > >>> shp_lyr.GetGeometryColumn()
> >
> > ''
> >
> > OpenJUMP JML driver does not report a name for geometry column either.
> Is it
> > rather an exception that drivers give names for the geometry columns? I
> > know I can select only the geometry column with the SQLite dialect, but I
> > am curious.
>
> Indeed, in OGR SQL, if the geometry column has a non-empty name (typically
> for
> database drivers), you can use it to select it. When the geometry column
> name
> is empty, such as in the shapefile or OpenJUMP driver, you can use
> _ogr_geometry_ (with leading and trainling underscore) to select it. This
> is
> likely undocumented.
>
> As far as I can see, this was introduced per
>
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> to fix an issue with comparison with empty string literals (this was
> before
> OGR enforced the difference between single-quoted string literals and
> double-
> quoted identifiers)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 9 Nov 2020 15:35:11 +0000
> From: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
> To: Even Rouault <even.rouault at spatialys.com>,
>         "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
>         SQL
> Message-ID: <d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi>
> Content-Type: text/plain; charset="us-ascii"
>
> Even Rouault wrote:
> maanantai 9. marraskuuta 2020 17.10
>
> > Jukka,
>
> >> I believe that OGR SQL dialect adds the geometry column into SQL
> >> selection by default. Am I right with this? I volunteer to edit the
> >> documentation https://gdal.org/user/ogr_sql_dialect.html if this is
> >> the case. But what I can't understand is another side of the story,
> >> how to select just the geometry field with OGR SQL dialect from some
> data sources.
> >>
> >> This command returns both time column and geometry from GML ogrinfo
> >> -sql "select time from timetest" timetest.gml I can select just the
> >> geometry from geometry column named as "geometryProperty" by ogrinfo
> >> -sql "select geometryProperty from timetest"
> >> timetest.gml
> >>
> >> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> >> Geometry is selected automatically but it can be selected also by
> >> name. But I cannot discover any way to select just the geometry field
> from shapefile.
> >> Is it because geometry column in shapefile does not have any name as
> >> this Python test seems to prove?
> >> >>> from osgeo import ogr
> >> >>> shp_ds = ogr.Open('timetest.shp')
> >> >>> shp_lyr = shp_ds.GetLayer(0)
> >> >>> shp_lyr.GetGeometryColumn()
> >>
> >> ''
> >>
> >> OpenJUMP JML driver does not report a name for geometry column either.
> >> Is it rather an exception that drivers give names for the geometry
> >> columns? I know I can select only the geometry column with the SQLite
> >> dialect, but I am curious.
>
> > Indeed, in OGR SQL, if the geometry column has a nonempty name
> (typically for
> > database drivers), you can use it to select it. When the geometry column
> name
> > is empty, such as in the shapefile or OpenJUMP driver, you can use
> > _ogr_geometry_ (with leading and trainling underscore) to select it.
> This is likely undocumented.
>
> > As far as I can see, this was introduced per
> >
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> > to fix an issue with comparison with empty string literals (this was
> before OGR enforced the
> >  difference between single-quoted string literals and double- quoted
> identifiers)
>
> I could not manage to guess the right syntax for Windows right ahead but
> solved the quiz easily
> with your double-quote hint
>
> First trial:
> ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
> INFO: Open of `timetest.shp'
>       using driver `ESRI Shapefile' successful.
> ERROR 1: SQL Expression Parsing Error: syntax error, unexpected
> $undefined. Occurred around :
> select _ogr_geometry_ from timetest
>
> Second trial:
> ogrinfo -sql "select \"_ogr_geometry_\" from timetest" timetest.shp
>
> -Jukka-
>
> > Even
>
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
> From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] WCS_GDAL Driver Image SubSet Request
> Message-ID: <1604936825138-0.post at n6.nabble.com>
> Content-Type: text/plain; charset=us-ascii
>
> Hi,
>
> Do you want to make is somehow impossible to request data beyound the
> BoundingBox that you defined in the XML file? If you just want to get data
> from the rectangle that you or your users define, gdal_translate with the
> regular -spat option should work out-of-the-box.
>
> -Jukka Rahkonen-
>
>
> juliermeopensourcedeveloper wrote
> > Hi all,
> >
> > Is it possible to define a bounding box in order to request a coverage
> > subset using the GDAL WCS Driver?
> > I have tried the code in [1]. I  am trying to get information only for
> the
> > bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
> > image or bbox_interest request has not been delivered. The West Longitude
> > reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
> > of the bbox_interest.
> > The image extent is:
> > <GetCoverageExtra>
> >
> &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
> > </GetCoverageExtra>
> >  Any comment on this issue will be greatly appreciated.
> > Thank you very much for your time in advance.
> > *CODE [1]:*
> > <WCS_GDAL>
> > <ServiceURL>
> > http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
> > </
> > ServiceURL>
> > <CoverageName>
> > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> > </
> > CoverageName>
> > <GetCoverageExtra>
> > &amp;BoundingBox=-58,-11,-57.75,-10.75
> > </GetCoverageExtra>
> > <CoverageOffering>
> > <description>
> > Generated from GeoTIFF
> > </description>
> > <name>
> > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> > </name>
> > <label>
> > CBERS-4_AWFI_170_111_21052020
> > </label>
> > <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
> > <pos>
> > -58 -11
> > </pos>
> > <pos>
> > -57.75 -10.75
> > </pos>
> > </lonLatEnvelope>
> > <keywords>
> > <keyword>
> > WCS
> > </keyword>
> > <keyword>
> > GeoTIFF
> > </keyword>
> > </keywords>
> > <domainSet>
> > <spatialDomain>
> > <Envelope srsName="EPSG:4326">
> > <pos>
> > -58 -11
> > </pos>
> > <pos>
> > -57.75 -10.75
> > </pos>
> > </Envelope>
> > <RectifiedGrid dimension="2" srsName="EPSG:4326">
> > <limits>
> > <GridEnvelope>
> > <low>
> > 0 0
> > </low>
> > <high>
> > 0 0
> > </high>
> > </GridEnvelope>
> > </limits>
> > <axisName>
> > x
> > </axisName>
> > <axisName>
> > y
> > </axisName>
> > <origin>
> > <pos>
> > -58 -10.75
> > </pos>
> > </origin>
> > <offsetVector>
> > 0.005364603321609328 0.0
> > </offsetVector>
> > <offsetVector>
> > 0.0 -0.004532028600570188
> > </offsetVector>
> > </RectifiedGrid>
> > </spatialDomain>
> > </domainSet>
> > <rangeSet>
> > <RangeSet>
> > <name>
> > CBERS-4_AWFI_170_111_21052020
> > </name>
> > <label>
> > CBERS-4_AWFI_170_111_21052020
> > </label>
> > <axisDescription>
> > <AxisDescription>
> > <name>
> > Band
> > </name>
> > <label>
> > Band
> > </label>
> > <values>
> > <interval>
> > <min>
> > 1
> > </min>
> > <max>
> > 4
> > </max>
> > </interval>
> > </values>
> > </AxisDescription>
> > </axisDescription>
> > </RangeSet>
> > </rangeSet>
> > <supportedCRSs>
> > <requestResponseCRSs>
> > EPSG:4326
> > </requestResponseCRSs>
> > </supportedCRSs>
> > <supportedFormats nativeFormat="GeoTIFF">
> > <formats>
> > GeoTIFF
> > </formats>
> > <formats>
> > GIF
> > </formats>
> > <formats>
> > JPEG
> > </formats>
> > <formats>
> > PNG
> > </formats>
> > <formats>
> > TIFF
> > </formats>
> > </supportedFormats>
> > <supportedInterpolations default="nearest neighbor">
> > <interpolationMethod>
> > nearest neighbor
> > </interpolationMethod>
> > <interpolationMethod>
> > bilinear
> > </interpolationMethod>
> > <interpolationMethod>
> > bicubic
> > </interpolationMethod>
> > </supportedInterpolations>
> > </CoverageOffering>
> > <PreferredFormat>
> > GeoTIFF
> > </PreferredFormat>
> > <BandCount>
> > 4
> > </BandCount>
> > <BandType>
> > Byte
> > </BandType>
> > </WCS_GDAL>
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 198, Issue 14
> *****************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201110/bde8aed6/attachment-0001.html>

From muccigrosso at icloud.com  Tue Nov 10 09:04:04 2020
From: muccigrosso at icloud.com (John Muccigrosso)
Date: Tue, 10 Nov 2020 12:04:04 -0500
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
Message-ID: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>

I've just started getting this error when I try to use ogr2ogr:

dyld: Library not loaded: /usr/local/opt/armadillo/lib/libarmadillo.9.dylib
  Referenced from: /usr/local/bin/ogr2ogr
  Reason: image not found


Presumably this is because armadillo is up to version 10 in my system:


> ll /usr/local/opt/armadillo/lib/
total 576
drwxr-xr-x   6 username  staff     192 Oct 28 09:06 .
drwxr-xr-x  10 username  staff     320 Oct 28 09:06 ..
-r--r--r--   1 username  staff  293580 Oct 28 09:06 libarmadillo.10.1.1.dylib
lrwxr-xr-x   1 username  staff      25 Oct 28 09:06 libarmadillo.10.dylib -> libarmadillo.10.1.1.dylib
lrwxr-xr-x   1 username  staff      21 Oct 28 09:06 libarmadillo.dylib -> libarmadillo.10.dylib
drwxr-xr-x   3 username  staff      96 Oct 28 09:06 pkgconfig


I've installed goal via homebrew.

Thanks for any help.

John


From sean at mapbox.com  Tue Nov 10 09:25:33 2020
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 10 Nov 2020 10:25:33 -0700
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
In-Reply-To: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>
References: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>
Message-ID: <CADPhZXz-xaBHsdab98pjYxsEreXRfxoXHS6AipsiObZ_y3zJsA@mail.gmail.com>

Hi John,

On Tue, Nov 10, 2020 at 10:14 AM John Muccigrosso <muccigrosso at icloud.com>
wrote:

> I've just started getting this error when I try to use ogr2ogr:
>
> dyld: Library not loaded: /usr/local/opt/armadillo/lib/libarmadillo.9.dylib
>   Referenced from: /usr/local/bin/ogr2ogr
>   Reason: image not found
>
>
> Presumably this is because armadillo is up to version 10 in my system:
>
>
> > ll /usr/local/opt/armadillo/lib/
> total 576
> drwxr-xr-x   6 username  staff     192 Oct 28 09:06 .
> drwxr-xr-x  10 username  staff     320 Oct 28 09:06 ..
> -r--r--r--   1 username  staff  293580 Oct 28 09:06
> libarmadillo.10.1.1.dylib
> lrwxr-xr-x   1 username  staff      25 Oct 28 09:06 libarmadillo.10.dylib
> -> libarmadillo.10.1.1.dylib
> lrwxr-xr-x   1 username  staff      21 Oct 28 09:06 libarmadillo.dylib ->
> libarmadillo.10.dylib
> drwxr-xr-x   3 username  staff      96 Oct 28 09:06 pkgconfig
>
>
> I've installed goal via homebrew.
>
> Thanks for any help.
>
> John
>

I haven't been a homebrew user in a long time, but I found some discussion
and a possible solution for you in
https://github.com/OSGeo/homebrew-osgeo4mac/issues/456#issuecomment-414220068
.

If some other homebrew package updated your armadillo library after you
installed gdal, you'll need to reinstall gdal.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201110/3c93b2f4/attachment.html>

From muccigrosso at icloud.com  Tue Nov 10 11:29:57 2020
From: muccigrosso at icloud.com (John Muccigrosso)
Date: Tue, 10 Nov 2020 14:29:57 -0500
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
Message-ID: <319E8A96-1FC1-478C-9AAF-DFC41951BEE4@icloud.com>

Sean wrote:

> If some other homebrew package updated your armadillo library after you
> installed gdal, you'll need to reinstall gdal.

A simple uninstall/reinstall of osgeo/gdal did _not_ do the trick, and all the bottles in the current .rb have the hash, so I assume they're all the same, so I'm not quite sure where to go with the post Sean suggested.

Oddly - to me anyway - the only thing I can see that uses armadillo in brew is osgeo/gdal. armadillo was updated on October 26, so perhaps that's what borked it. I'm not sure there's a way to force homebrew to use a specific version, or not upgrade beyond one.

For now, I've hacked this by creating a symlink from version 10 of armadillo to the desired version 9 filename. Ugly, but works.

John


From chris.marsh at usask.ca  Tue Nov 10 11:47:55 2020
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Tue, 10 Nov 2020 19:47:55 +0000
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
In-Reply-To: <319E8A96-1FC1-478C-9AAF-DFC41951BEE4@icloud.com>
References: <319E8A96-1FC1-478C-9AAF-DFC41951BEE4@icloud.com>
Message-ID: <19FF9465-0AA0-4DBA-8A05-45B673721B69@usask.ca>

I just checked on my machine and I have Armadillo 10.1.0 and GDAL 3.1.3 from homebrew core  and running `ogr2ogr` returns the help page correctly.

Looking at the formula, and I don't even see a dependency on Armadillo for GDAL
https://github.com/Homebrew/homebrew-core/blob/master/Formula/gdal.rb

Are you using the osgeo4mac tap? If so, then it's a problem with their build script as per this issue
https://github.com/OSGeo/homebrew-osgeo4mac/issues/1399

core has the up to date gdal and proj now, so I'm no longer sure of the benefit of using osgeo4mac; current suggested work around is to actually use the core gdal to avoid this problem
https://github.com/OSGeo/homebrew-osgeo4mac/issues/1399#issuecomment-722482161

I would remove anything installed from the osgeo4mac tap, remove the tap, install gdal core and see. 
Alternatively you are up and running with the symlink so I hope the above gives you an explanation as to the problem

Cheers
Chris

> On Nov 10, 2020, at 1:29 PM, John Muccigrosso <muccigrosso at icloud.com> wrote:
> 
> CAUTION: External to USask. Verify sender and use caution with links and attachments. Forward suspicious emails to phishing at usask.ca
> 
> 
> Sean wrote:
> 
>> If some other homebrew package updated your armadillo library after you
>> installed gdal, you'll need to reinstall gdal.
> 
> A simple uninstall/reinstall of osgeo/gdal did _not_ do the trick, and all the bottles in the current .rb have the hash, so I assume they're all the same, so I'm not quite sure where to go with the post Sean suggested.
> 
> Oddly - to me anyway - the only thing I can see that uses armadillo in brew is osgeo/gdal. armadillo was updated on October 26, so perhaps that's what borked it. I'm not sure there's a way to force homebrew to use a specific version, or not upgrade beyond one.
> 
> For now, I've hacked this by creating a symlink from version 10 of armadillo to the desired version 9 filename. Ugly, but works.
> 
> John
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From muccigrosso at icloud.com  Tue Nov 10 12:09:56 2020
From: muccigrosso at icloud.com (John Muccigrosso)
Date: Tue, 10 Nov 2020 15:09:56 -0500
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
In-Reply-To: <19FF9465-0AA0-4DBA-8A05-45B673721B69@usask.ca>
References: <319E8A96-1FC1-478C-9AAF-DFC41951BEE4@icloud.com>
 <19FF9465-0AA0-4DBA-8A05-45B673721B69@usask.ca>
Message-ID: <81628AD5-9956-469E-8772-99FF5F7D6668@icloud.com>

> On 10 Nov 2020, at 14:47 , Marsh, Chris <chris.marsh at usask.ca> wrote:
> 
> I just checked on my machine and I have Armadillo 10.1.0 and GDAL 3.1.3 from homebrew core  and running `ogr2ogr` returns the help page correctly.
> 
> Looking at the formula, and I don't even see a dependency on Armadillo for GDAL
> https://github.com/Homebrew/homebrew-core/blob/master/Formula/gdal.rb
> 
> Are you using the osgeo4mac tap? If so, then it's a problem with their build script as per this issue
> https://github.com/OSGeo/homebrew-osgeo4mac/issues/1399
> 
> core has the up to date gdal and proj now, so I'm no longer sure of the benefit of using osgeo4mac; current suggested work around is to actually use the core gdal to avoid this problem
> https://github.com/OSGeo/homebrew-osgeo4mac/issues/1399#issuecomment-722482161
> 
> I would remove anything installed from the osgeo4mac tap, remove the tap, install gdal core and see. 
> Alternatively you are up and running with the symlink so I hope the above gives you an explanation as to the problem

Chris,

Yes, I am using the osgeo4mac tap and that issue offers the symlink workaround that I used (though I hadn't seen it). I've now removed the osgeo tap and installed gdal from core and ogr2ogr is working for me.

Thanks for the help.

John


From idan at miara.com  Tue Nov 10 12:19:50 2020
From: idan at miara.com (Idan Miara)
Date: Tue, 10 Nov 2020 22:19:50 +0200
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
Message-ID: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>

Hi All,

I would like to call for discussion on RFC77 Drop Python 2 support
<https://github.com/talos-gis/gdal/blob/Branch_rfc_drop_python2/gdal/doc/source/development/rfc/rfc77_drop_python2_support.rst>
.
Please give your feedback on this PR.
<https://github.com/OSGeo/gdal/pull/3142>

Kind regards,
Idan Miara
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201110/6b10d42d/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Nov 10 13:18:30 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 10 Nov 2020 21:18:30 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
Message-ID: <e3a8035b440d422bb9663c5f6e6cdf32@maanmittauslaitos.fi>

Hi,

Sorry for the -spat that belongs to ogr2ogr. In gdal_translate it is -projwin.

The WMTS documentation is not relevant for the GDAL WCS driver. Most that they have in common is that they create a xml file for storing info about the capabilities of the service.  The WCS documentation alone should be enough for using the WCS driver, even I have to admit that I do not understand it totally, for example when it comes to cache control commands. Fortunately documentation can be improved.

Using WCS with GDAL is meant to be easy but unfortunately it seems to me that something is broken with it with some WCS services. It should be this easy to use:


  1.  Read general capabilities, including the names of the coverages. Example


gdalinfo "WCS:http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1"

The result contain the names of the subdatasets (coverages) as the WCS driver understands them

Subdatasets:
  SUBDATASET_1_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Arc_Sample
  SUBDATASET_2_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__GRAY_HR_SR_OB_DR
  SUBDATASET_3_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__HYP_HR_SR_OB_DR
  SUBDATASET_4_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__NE2_HR_LC_SR_W_DR
  SUBDATASET_5_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
  SUBDATASET_6_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__black_marble
  SUBDATASET_7_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__g30
  SUBDATASET_8_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__mosaic
  SUBDATASET_9_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sf__sfdem
  SUBDATASET_10_NAME=WCS:http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__truemarble


  1.  Select one coverage and read more metadata about that, again with gdalinfo. This step fails now with my GDAL 3.2. Here some debug info that shows that GDAL is generating a bbox/subset with lower limit = higher limit when it tries to read a small sample of the coverage. Geoserver does not accept the request and gives an error about an empty subset.

gdalinfo "WCS:http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__mosaic" --debug on
…
WCS: Requesting http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=DescribeCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&FORMAT=text/xml
HTTP: Fetch(http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=DescribeCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&FORMAT=text/xml)
HTTP: libcurl/7.70.0-DEV OpenSSL/1.1.1g zlib/1.2.3
WCS: Requesting http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long%286.3953399152693953,6.3953399152693953%29&SUBSET=Lat%2846.541601968340089,46.541601968340089%29&Format=image/tiff
HTTP: Fetch(http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long%286.3953399152693953,6.3953399152693953%29&SUBSET=Lat%2846.541601968340089,46.541601968340089%29&Format=image/tiff)
ERROR 1: HTTP error code : 404
ERROR 1: InvalidSubsetting: Empty intersection after subsetting


  1.  The third step would be to use gdal_translate with -projwin option and get coverage from the given area. Now gdal_translate is also making a probing request by min=max extents and it fails.

However, the example request on the WCS document page that reads data from the National Land Survey of Finland  works.

gdal_translate -oo CACHE=wcs_cache -oo CLEAR_CACHE -oo INTERLEAVE=PIXEL -projwin 377418 6683393.87938218 377717.879386966 6683094 -oo Subset="time(1985-01-01T00:00:00.000Z)" -outsize 60 0 "WCS:https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva" scaled.tiff

gdalinfo works as well

gdalinfo "WCS:https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva"

-Jukka Rahkonen-


Lähettäjä: 1520 gis <juliermeopensourcedeveloper at gmail.com>
Lähetetty: tiistai 10. marraskuuta 2020 18.10
Vastaanottaja: gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: gdal-dev Digest, Vol 198, Issue 14

Dear Jukka Rahkonen,

Thank you very much for your reply.

First of all, my apologies for my lack of knowledge about using GDAL_WCS driver. Let me give more details about the issues I am facing.

Extract of http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities is shown in [1].

Regarding gdal_translate GDAL_WCS driver Image subset extract, looking at https://gdal.org/drivers/raster/wcs.html#examples, I tried the following:

Similar to GDAL_WMTS <gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -of WMTS>,
I tried running:
(1)
 gdal_translate "WCS:http://172.21.14.45:8181/geoserver/wcs?version=2.0.1&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"  CBERS-4_AWFI_170_111_21052020.xml

The response: I did not get the xml as wmts.xml showed above

Note: Including the -of option (WCS), the outcome fails

(2)
gdal_translate "WCS:http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020" \
-spat -58 -11 -57.75 -10.7 \
CBERS-4_AWFI_170_111_21052020.xml

The response: There is no -spat option for gdal_translate

gdal_translate --help

Usage: gdal_translate [--help-general] [--long-usage]
       [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
             CInt16/CInt32/CFloat32/CFloat64}] [-strict]
       [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
       [-outsize xsize[%]|0 ysize[%]|0] [-tr xres yres]
       [-r {nearest,bilinear,cubic,cubicspline,lanczos,average,mode}]
       [-unscale] [-scale[_bn] [src_min src_max [dst_min dst_max]]]* [-exponent[_bn] exp_val]*
       [-srcwin xoff yoff xsize ysize] [-epo] [-eco]
       [-projwin ulx uly lrx lry] [-projwin_srs srs_def]
       [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
       [-a_scale value] [-a_offset value]
       [-nogcp] [-gcp pixel line easting northing [elevation]]*
       |-colorinterp{_bn} {red|green|blue|alpha|gray|undefined}]
       |-colorinterp {red|green|blue|alpha|gray|undefined},...]
       [-mo "META-TAG=VALUE"]* [-q] [-sds]
       [-co "NAME=VALUE"]* [-stats] [-norat]
       [-oo NAME=VALUE]*
       src_dataset dst_dataset



[1] WCS GetCapabilities request

<wcs:CoverageSummary>
<ows:Title>CBERS-4_AWFI_170_111_21052020</ows:Title>
<ows:Abstract>Generated from GeoTIFF</ows:Abstract>
<ows:Keywords>
<ows:Keyword>deter-amazonia-CBERS-4_AWFI_170_111_21052020</ows:Keyword>
<ows:Keyword>WCS</ows:Keyword>
<ows:Keyword>GeoTIFF</ows:Keyword>
</ows:Keywords>
<wcs:CoverageId>deter-amazonia__CBERS-4_AWFI_170_111_21052020</wcs:CoverageId>
<wcs:CoverageSubtype>RectifiedGridCoverage</wcs:CoverageSubtype>
<ows:WGS84BoundingBox>
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:WGS84BoundingBox>
<ows:BoundingBox crs="http://www.opengis.net/def/crs/EPSG/0/EPSG:4326">
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:BoundingBox>
</wcs:CoverageSummary>


Any comment will be very appreciated.

GDAL website<https://gdal.org/drivers/raster/wmts.html> provides examples on how to run GDAL_WMTS driver in order to get a wmts xml file. I have looked in https://gdal.org/drivers/raster/wcs.html and could not find an example pointing to -spat option.  I got an -spat option
to gdal_grid<https://gdal.org/programs/gdal_grid.html?highlight=spat#cmdoption-gdal_grid-spat> though.

gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -of WMTS

gdal_translate "WCS:http://www.dpi.inpe.br/fipcerrado-geoserver/ows/wcs?request=GetCapabilities" \

-oo CoverageName=deter-cerrado:CBERS-4_AWFI_161_099_13072018 CBERS-4_AWFI_161_099_13072018.xml -of WCS



On Mon, Nov 9, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>> wrote:
Send gdal-dev mailing list submissions to
        gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

To subscribe or unsubscribe via the World Wide Web, visit
        https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
        gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>

You can reach the person managing the list at
        gdal-dev-owner at lists.osgeo.org<mailto:gdal-dev-owner at lists.osgeo.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Re: Selecting just the geometry column with OGR SQL (Even Rouault)
   2. Re: Selecting just the geometry column with OGR SQL
      (Rahkonen Jukka (MML))
   3. Re: WCS_GDAL Driver Image SubSet Request (jratike80)


----------------------------------------------------------------------

Message: 1
Date: Mon, 09 Nov 2020 16:09:45 +0100
From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Cc: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
        SQL
Message-ID: <1659214.2tRo4lr4Oo at even-i700<mailto:1659214.2tRo4lr4Oo at even-i700>>
Content-Type: text/plain; charset="us-ascii"

Jukka,

> I believe that OGR SQL dialect adds the geometry column into SQL selection
> by default. Am I right with this? I volunteer to edit the documentation
> https://gdal.org/user/ogr_sql_dialect.html if this is the case. But what I
> can't understand is another side of the story, how to select just the
> geometry field with OGR SQL dialect from some data sources.
>
> This command returns both time column and geometry from GML
> ogrinfo -sql "select time from timetest" timetest.gml
> I can select just the geometry from geometry column named as
> "geometryProperty" by ogrinfo -sql "select geometryProperty from timetest"
> timetest.gml
>
> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> Geometry is selected automatically but it can be selected also by name. But
> I cannot discover any way to select just the geometry field from shapefile.
> Is it because geometry column in shapefile does not have any name as this
> Python test seems to prove?
> >>> from osgeo import ogr
> >>> shp_ds = ogr.Open('timetest.shp')
> >>> shp_lyr = shp_ds.GetLayer(0)
> >>> shp_lyr.GetGeometryColumn()
>
> ''
>
> OpenJUMP JML driver does not report a name for geometry column either. Is it
> rather an exception that drivers give names for the geometry columns? I
> know I can select only the geometry column with the SQLite dialect, but I
> am curious.

Indeed, in OGR SQL, if the geometry column has a non-empty name (typically for
database drivers), you can use it to select it. When the geometry column name
is empty, such as in the shapefile or OpenJUMP driver, you can use
_ogr_geometry_ (with leading and trainling underscore) to select it. This is
likely undocumented.

As far as I can see, this was introduced per
https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
to fix an issue with comparison with empty string literals (this was before
OGR enforced the difference between single-quoted string literals and double-
quoted identifiers)

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com


------------------------------

Message: 2
Date: Mon, 9 Nov 2020 15:35:11 +0000
From: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
To: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>,
        "gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
        SQL
Message-ID: <d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi<mailto:d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi>>
Content-Type: text/plain; charset="us-ascii"

Even Rouault wrote:
maanantai 9. marraskuuta 2020 17.10

> Jukka,

>> I believe that OGR SQL dialect adds the geometry column into SQL
>> selection by default. Am I right with this? I volunteer to edit the
>> documentation https://gdal.org/user/ogr_sql_dialect.html if this is
>> the case. But what I can't understand is another side of the story,
>> how to select just the geometry field with OGR SQL dialect from some data sources.
>>
>> This command returns both time column and geometry from GML ogrinfo
>> -sql "select time from timetest" timetest.gml I can select just the
>> geometry from geometry column named as "geometryProperty" by ogrinfo
>> -sql "select geometryProperty from timetest"
>> timetest.gml
>>
>> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
>> Geometry is selected automatically but it can be selected also by
>> name. But I cannot discover any way to select just the geometry field from shapefile.
>> Is it because geometry column in shapefile does not have any name as
>> this Python test seems to prove?
>> >>> from osgeo import ogr
>> >>> shp_ds = ogr.Open('timetest.shp')
>> >>> shp_lyr = shp_ds.GetLayer(0)
>> >>> shp_lyr.GetGeometryColumn()
>>
>> ''
>>
>> OpenJUMP JML driver does not report a name for geometry column either.
>> Is it rather an exception that drivers give names for the geometry
>> columns? I know I can select only the geometry column with the SQLite
>> dialect, but I am curious.

> Indeed, in OGR SQL, if the geometry column has a nonempty name (typically for
> database drivers), you can use it to select it. When the geometry column name
> is empty, such as in the shapefile or OpenJUMP driver, you can use
> _ogr_geometry_ (with leading and trainling underscore) to select it. This is likely undocumented.

> As far as I can see, this was introduced per
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> to fix an issue with comparison with empty string literals (this was before OGR enforced the
>  difference between single-quoted string literals and double- quoted identifiers)

I could not manage to guess the right syntax for Windows right ahead but solved the quiz easily
with your double-quote hint

First trial:
ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
INFO: Open of `timetest.shp'
      using driver `ESRI Shapefile' successful.
ERROR 1: SQL Expression Parsing Error: syntax error, unexpected $undefined. Occurred around :
select _ogr_geometry_ from timetest

Second trial:
ogrinfo -sql "select \"_ogr_geometry_\" from timetest" timetest.shp

-Jukka-

> Even

--
Spatialys - Geospatial professional services http://www.spatialys.com


------------------------------

Message: 3
Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] WCS_GDAL Driver Image SubSet Request
Message-ID: <1604936825138-0.post at n6.nabble.com<mailto:1604936825138-0.post at n6.nabble.com>>
Content-Type: text/plain; charset=us-ascii

Hi,

Do you want to make is somehow impossible to request data beyound the
BoundingBox that you defined in the XML file? If you just want to get data
from the rectangle that you or your users define, gdal_translate with the
regular -spat option should work out-of-the-box.

-Jukka Rahkonen-


juliermeopensourcedeveloper wrote
> Hi all,
>
> Is it possible to define a bounding box in order to request a coverage
> subset using the GDAL WCS Driver?
> I have tried the code in [1]. I  am trying to get information only for the
> bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
> image or bbox_interest request has not been delivered. The West Longitude
> reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
> of the bbox_interest.
> The image extent is:
> <GetCoverageExtra>
> &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
> </GetCoverageExtra>
>  Any comment on this issue will be greatly appreciated.
> Thank you very much for your time in advance.
> *CODE [1]:*
> <WCS_GDAL>
> <ServiceURL>
> http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
> </
> ServiceURL>
> <CoverageName>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </
> CoverageName>
> <GetCoverageExtra>
> &amp;BoundingBox=-58,-11,-57.75,-10.75
> </GetCoverageExtra>
> <CoverageOffering>
> <description>
> Generated from GeoTIFF
> </description>
> <name>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </lonLatEnvelope>
> <keywords>
> <keyword>
> WCS
> </keyword>
> <keyword>
> GeoTIFF
> </keyword>
> </keywords>
> <domainSet>
> <spatialDomain>
> <Envelope srsName="EPSG:4326">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </Envelope>
> <RectifiedGrid dimension="2" srsName="EPSG:4326">
> <limits>
> <GridEnvelope>
> <low>
> 0 0
> </low>
> <high>
> 0 0
> </high>
> </GridEnvelope>
> </limits>
> <axisName>
> x
> </axisName>
> <axisName>
> y
> </axisName>
> <origin>
> <pos>
> -58 -10.75
> </pos>
> </origin>
> <offsetVector>
> 0.005364603321609328 0.0
> </offsetVector>
> <offsetVector>
> 0.0 -0.004532028600570188
> </offsetVector>
> </RectifiedGrid>
> </spatialDomain>
> </domainSet>
> <rangeSet>
> <RangeSet>
> <name>
> CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <axisDescription>
> <AxisDescription>
> <name>
> Band
> </name>
> <label>
> Band
> </label>
> <values>
> <interval>
> <min>
> 1
> </min>
> <max>
> 4
> </max>
> </interval>
> </values>
> </AxisDescription>
> </axisDescription>
> </RangeSet>
> </rangeSet>
> <supportedCRSs>
> <requestResponseCRSs>
> EPSG:4326
> </requestResponseCRSs>
> </supportedCRSs>
> <supportedFormats nativeFormat="GeoTIFF">
> <formats>
> GeoTIFF
> </formats>
> <formats>
> GIF
> </formats>
> <formats>
> JPEG
> </formats>
> <formats>
> PNG
> </formats>
> <formats>
> TIFF
> </formats>
> </supportedFormats>
> <supportedInterpolations default="nearest neighbor">
> <interpolationMethod>
> nearest neighbor
> </interpolationMethod>
> <interpolationMethod>
> bilinear
> </interpolationMethod>
> <interpolationMethod>
> bicubic
> </interpolationMethod>
> </supportedInterpolations>
> </CoverageOffering>
> <PreferredFormat>
> GeoTIFF
> </PreferredFormat>
> <BandCount>
> 4
> </BandCount>
> <BandType>
> Byte
> </BandType>
> </WCS_GDAL>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html


------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev

------------------------------

End of gdal-dev Digest, Vol 198, Issue 14
*****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201110/d22c6805/attachment-0001.html>

From runette at gmail.com  Wed Nov 11 00:51:32 2020
From: runette at gmail.com (Paul Harwood)
Date: Wed, 11 Nov 2020 08:51:32 +0000
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
In-Reply-To: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>
References: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>
Message-ID: <CAE8nN5MZXiygGPF5yyXiPvca37iDzqxP2T9HD88nhgXjvBxdFg@mail.gmail.com>

Have you thought about just using the Conda Installation? Solves most or
all of these problems.

On Tue, 10 Nov 2020 at 17:14, John Muccigrosso <muccigrosso at icloud.com>
wrote:

> I've just started getting this error when I try to use ogr2ogr:
>
> dyld: Library not loaded: /usr/local/opt/armadillo/lib/libarmadillo.9.dylib
>   Referenced from: /usr/local/bin/ogr2ogr
>   Reason: image not found
>
>
> Presumably this is because armadillo is up to version 10 in my system:
>
>
> > ll /usr/local/opt/armadillo/lib/
> total 576
> drwxr-xr-x   6 username  staff     192 Oct 28 09:06 .
> drwxr-xr-x  10 username  staff     320 Oct 28 09:06 ..
> -r--r--r--   1 username  staff  293580 Oct 28 09:06
> libarmadillo.10.1.1.dylib
> lrwxr-xr-x   1 username  staff      25 Oct 28 09:06 libarmadillo.10.dylib
> -> libarmadillo.10.1.1.dylib
> lrwxr-xr-x   1 username  staff      21 Oct 28 09:06 libarmadillo.dylib ->
> libarmadillo.10.dylib
> drwxr-xr-x   3 username  staff      96 Oct 28 09:06 pkgconfig
>
>
> I've installed goal via homebrew.
>
> Thanks for any help.
>
> John
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/2225e7f8/attachment.html>

From runette at gmail.com  Wed Nov 11 01:17:57 2020
From: runette at gmail.com (Paul Harwood)
Date: Wed, 11 Nov 2020 09:17:57 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>

I think we can be fairly certain that gdal-feedstock works, since it has
passed in a clean container environment.

The most obvious question is - I am assuming that you are using conda build
- are you working in a clean conda env?

Create a totally new conda env, activate that and then try again.

I have very occasional noticed conda getting confused about versions in its
package cache. You can also try `conda clean --all` to clear out the
package cache.

I am also curious. Sometimes I see messages go by and I think "why". I
assume that you know your business much better than me but I do wonder what
you are going to get from building the conda recipe locally that is not
already built into the conda package? What have I missed?

I am also curious - given you are going through the effort of creating the
build - why 3.1.4 and not 3.2.0? Surely, you risk just building in a legacy
problem?



On Tue, 10 Nov 2020 at 08:12, Jon Morris <Jon.Morris at jbarisk.com> wrote:

> I've been trying to build a Windows conda package for GDAL 3.1.4, but am
> having problems with the poppler headers. I'm using the conda-forge recipe,
> which includes a line in the build script to detect the poppler version.
>
>
>
> FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
>
>   set POPPLER_MAJOR_VERSION=%%a
>
>   set POPPLER_MINOR_VERSION=%%b
>
> )
>
>
> https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16
>
>
>
> This doesn't seem to be working, as when we get to compiling the pdf
> driver, the headers are missing.
>
>
>
> (gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc   &&
> cd ..   || exit 1
>
>         cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786
> /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME
> /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore
> -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts
> -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem
> -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0
> -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED
> -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp
> pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp
> pdfcreatefromcomposition.cpp
>
> pdfdataset.cpp
>
> pdfio.cpp
>
> pdfobject.cpp
>
> pdfcreatecopy.cpp
>
> c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54):
> fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file
> or directory (compiling source file pdfdataset.cpp)
>
>
>
> In pdfsdkheaders.h we can see it's the wrong poppler version that's
> causing the error:
>
>
>
> #if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
>
> #include <goo/gtypes.h>
>
> #else
>
> typedef unsigned char Guchar;
>
> #endif
>
>
>
> The installed version of poppler is 20.11.0, so I don't know why I'm
> getting major version set to 0 and minor version set to 23.
>
>
>
> I'll also ask over at conda as this is most likely a conda build problem,
> but I thought I would also ask here if anyone has successfully built a
> conda package and knows how to get this recipe working.
>
>
>
> Many thanks!
>
>
>
> Jon
>
>
>
>
>
> *Jon Morris*
>
> Software Developer
>
>
>
> *COVID-19. During the current outbreak JBA remains open for business and
> we continue to deliver our services. However, we have adopted
> flexible/remote working as required. I will be receiving and reading email
> as normal but I may not always be available on the office number.*
>
>
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
> *T* +44 (0) 1756 799919
> www.jbarisk.com
>
> [image: Visit our website] <http://www.jbarisk.com>
> <https://www.linkedin.com/in/jon-morris-a2897b4/> [image: Follow us on
> Twitter] <https://twitter.com/jbarisk>
>
> *Find out more about us here: www.jbarisk.com <http://www.jbarisk.com/>
> and **follow us on Twitter @JBARisk <http://twitter.com/JBARisk> and
> LinkedIn
> <https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
> *
>
> The JBA Group supports the JBA Trust.
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
>
>
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, Telephone: +441756799919
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/a4ba13bb/attachment.html>

From christian at uxproductions.se  Wed Nov 11 02:19:47 2020
From: christian at uxproductions.se (=?UTF-8?Q?Christian_S=C3=B6rensen?=)
Date: Wed, 11 Nov 2020 11:19:47 +0100
Subject: [gdal-dev] Convert ESRI Shapefile to GeoJSON in memory, code in c#
Message-ID: <CAGzoYG+GBn1T+yRZYt38FZs=KU+_Lv9KyA9+QEMRh_rJ0dEcZg@mail.gmail.com>

Hi,

I'm a bit out of my depth here trying out GDAL in c#. Please help. =)

My code works fine if I output the GeoJSON to a file on disk. But I would
really not prefer having to intermittently store the result on disk just to
read it back into memory again.

It seems like all methods exposed by SWIG in c# that have something to do
with reading virtual files back into a buffer is missing?

Where is VSIGetMemFileBuffer or VSIFReadL? Python seems to have  VSIFReadL,
but not C#.

I'm doing this wrong?

Below is my code.
















































































* private FeatureCollection ImportShapeFile(IEnumerable<ImportFile> files)
      {            var tempJsonFilename = $"/vsimem/temp.json";
GdalConfiguration.ConfigureGdal();
GdalConfiguration.ConfigureOgr();            try            {
  // Copy into GDAL                foreach (var file in files)
  {                    Gdal.FileFromMemBuffer($"/vsimem/{file.Filename}",
file.Data);                }                // Load shape
var shpDriver = Ogr.GetDriverByName("ESRI Shapefile");                var
shpFile = files.First(f => f.Filename.EndsWith(".shp"));                var
shpDatasource = Ogr.Open($"/vsimem/{shpFile.Filename}", 0);
if (shpDatasource == null)                    return null;
var shpLayer = shpDatasource.GetLayerByIndex(0);                // Setup
projection transform to WGS84                var srcProjection =
shpLayer.GetSpatialRef();                var destProjection = new
SpatialReference("");                destProjection.ImportFromEPSG(4326);
              var transform = new CoordinateTransformation(srcProjection,
destProjection);                // Copy layer to geo json
var jsonDriver = Ogr.GetDriverByName("GeoJSON");                var
jsonDataSource = jsonDriver.CreateDataSource(tempJsonFilename, new string[]
{ });                var jsonLayer =
jsonDataSource.CreateLayer(shpLayer.GetName(), destProjection,
shpLayer.GetGeomType(), new string[] { });                var shpFeature =
shpLayer.GetNextFeature();                while (shpFeature != null)
        {                    // Transform geometry                    var
geometry = shpFeature.GetGeometryRef();
geometry.Transform(transform);                    // Save feature to new
layer                    jsonLayer.CreateFeature(shpFeature);
      shpFeature = shpLayer.GetNextFeature();                }
  // TODO: HERE I would like to read the information from my tempJsonFile
back into a byte array, before unlinking.                var jsonBuffer =
new byte[0];                // Close all GDAL stuff
jsonLayer.Dispose();                jsonDataSource.Dispose();
  jsonDriver.Dispose();                shpLayer.Dispose();
shpDatasource.Dispose();                shpDriver.Dispose();
// Read json from buffer                var jsonText =
Encoding.UTF8.GetString(jsonBuffer, 0, jsonBuffer.Length); ;
var json = JsonConvert.DeserializeObject<FeatureCollection>(jsonText);
          return json;            }            catch (Exception exception)
          {                throw exception;            }
finally            {                // Clear files from GDAL
Gdal.Unlink(tempJsonFilename);                foreach (var file in files)
              {
Gdal.Unlink($"/vsimem/{file.Filename}");                }            }
  }*


Best Regards
Christian

-- 

*Christian Sörensen*
*UX Productions AB*
www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/e4737718/attachment-0001.html>

From runette at gmail.com  Wed Nov 11 03:34:30 2020
From: runette at gmail.com (Paul Harwood)
Date: Wed, 11 Nov 2020 11:34:30 +0000
Subject: [gdal-dev] Convert ESRI Shapefile to GeoJSON in memory,
	code in c#
In-Reply-To: <CAGzoYG+GBn1T+yRZYt38FZs=KU+_Lv9KyA9+QEMRh_rJ0dEcZg@mail.gmail.com>
References: <CAGzoYG+GBn1T+yRZYt38FZs=KU+_Lv9KyA9+QEMRh_rJ0dEcZg@mail.gmail.com>
Message-ID: <CAE8nN5OHP++2bokvMsuV_fNMxQgRyg6qxBmOQDGnOeGMvj6Oyw@mail.gmail.com>

I have a working c# GDAL app - I might be able to help.

I am not sure I understand what you are trying to do? It looks like you are
creating a GeoJSON file from a shapefile and that actually only makes any
sense if you want to save the file?

>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> * private FeatureCollection ImportShapeFile(IEnumerable<ImportFile>
> files)        {            var tempJsonFilename = $"/vsimem/temp.json";
>         GdalConfiguration.ConfigureGdal();
> GdalConfiguration.ConfigureOgr();            try            {
>   // Copy into GDAL                foreach (var file in files)
>   {                    Gdal.FileFromMemBuffer($"/vsimem/{file.Filename}",
> file.Data);                }*
>

>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
>
> *                // Load shape                var shpDriver =
> Ogr.GetDriverByName("ESRI Shapefile");                var shpFile =
> files.First(f => f.Filename.EndsWith(".shp"));                var
> shpDatasource = Ogr.Open($"/vsimem/{shpFile.Filename}", 0);
> if (shpDatasource == null)                    return null;
> var shpLayer = shpDatasource.GetLayerByIndex(0);                // Setup
> projection transform to WGS84                var srcProjection =
> shpLayer.GetSpatialRef();                var destProjection = new
> SpatialReference("");                destProjection.ImportFromEPSG(4326);
>               var transform = new CoordinateTransformation(srcProjection,
> destProjection);                // Copy layer to geo json
> var jsonDriver = Ogr.GetDriverByName("GeoJSON");                var
> jsonDataSource = jsonDriver.CreateDataSource(tempJsonFilename, new string[]
> { });                var jsonLayer =
> jsonDataSource.CreateLayer(shpLayer.GetName(), destProjection,
> shpLayer.GetGeomType(), new string[] { });                var shpFeature =
> shpLayer.GetNextFeature();                while (shpFeature != null)
>         {                    // Transform geometry                    var
> geometry = shpFeature.GetGeometryRef();
> geometry.Transform(transform);                    // Save feature to new
> layer                    jsonLayer.CreateFeature(shpFeature);
>       shpFeature = shpLayer.GetNextFeature();                }
>   // TODO: HERE I would like to read the information from my tempJsonFile
> back into a byte array, before unlinking.                var jsonBuffer =
> new byte[0];                // Close all GDAL stuff
> jsonLayer.Dispose();                jsonDataSource.Dispose();
>   jsonDriver.Dispose();                shpLayer.Dispose();
> shpDatasource.Dispose();                shpDriver.Dispose();
> // Read json from buffer                var jsonText =
> Encoding.UTF8.GetString(jsonBuffer, 0, jsonBuffer.Length); ;
> var json = JsonConvert.DeserializeObject<FeatureCollection>(jsonText);
>           return json;            }            catch (Exception exception)
>           {                throw exception;            }
> finally            {                // Clear files from GDAL
> Gdal.Unlink(tempJsonFilename);                foreach (var file in files)
>               {
> Gdal.Unlink($"/vsimem/{file.Filename}");                }            }
>   }*
>
>
> Best Regards
> Christian
>
> --
>
> *Christian Sörensen*
> *UX Productions AB*
> www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
> P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/a77a0e10/attachment.html>

From christian at uxproductions.se  Wed Nov 11 03:42:20 2020
From: christian at uxproductions.se (=?UTF-8?Q?Christian_S=C3=B6rensen?=)
Date: Wed, 11 Nov 2020 12:42:20 +0100
Subject: [gdal-dev] Convert ESRI Shapefile to GeoJSON in memory,
	code in c#
In-Reply-To: <CAE8nN5OHP++2bokvMsuV_fNMxQgRyg6qxBmOQDGnOeGMvj6Oyw@mail.gmail.com>
References: <CAGzoYG+GBn1T+yRZYt38FZs=KU+_Lv9KyA9+QEMRh_rJ0dEcZg@mail.gmail.com>
 <CAE8nN5OHP++2bokvMsuV_fNMxQgRyg6qxBmOQDGnOeGMvj6Oyw@mail.gmail.com>
Message-ID: <CAGzoYGKgM9wsDfNYaJFH-OD3bJA9-zdDZbWBuFvUZvAhWzySLg@mail.gmail.com>

After converting to GeoJSON the next step is saving the json into a MongoDB
database. The customer I work for has chosen to store all GIS-data in
GeoJSON in a nosql database like MongoDB.

That's why I would prefer not creating a file just to get hold of the json
after importing and transforming the original data using GDAL. In the
future we're thinking of supporting more formats than ESRI Shapefile and
GeoJSON as input.

Hope this explains my question.

Den ons 11 nov. 2020 kl 12:34 skrev Paul Harwood <runette at gmail.com>:

> I have a working c# GDAL app - I might be able to help.
>
> I am not sure I understand what you are trying to do? It looks like you
> are creating a GeoJSON file from a shapefile and that actually only makes
> any sense if you want to save the file?
>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> * private FeatureCollection ImportShapeFile(IEnumerable<ImportFile>
>> files)        {            var tempJsonFilename = $"/vsimem/temp.json";
>>         GdalConfiguration.ConfigureGdal();
>> GdalConfiguration.ConfigureOgr();            try            {
>>   // Copy into GDAL                foreach (var file in files)
>>   {                    Gdal.FileFromMemBuffer($"/vsimem/{file.Filename}",
>> file.Data);                }*
>>
>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>>
>> *                // Load shape                var shpDriver =
>> Ogr.GetDriverByName("ESRI Shapefile");                var shpFile =
>> files.First(f => f.Filename.EndsWith(".shp"));                var
>> shpDatasource = Ogr.Open($"/vsimem/{shpFile.Filename}", 0);
>> if (shpDatasource == null)                    return null;
>> var shpLayer = shpDatasource.GetLayerByIndex(0);                // Setup
>> projection transform to WGS84                var srcProjection =
>> shpLayer.GetSpatialRef();                var destProjection = new
>> SpatialReference("");                destProjection.ImportFromEPSG(4326);
>>               var transform = new CoordinateTransformation(srcProjection,
>> destProjection);                // Copy layer to geo json
>> var jsonDriver = Ogr.GetDriverByName("GeoJSON");                var
>> jsonDataSource = jsonDriver.CreateDataSource(tempJsonFilename, new string[]
>> { });                var jsonLayer =
>> jsonDataSource.CreateLayer(shpLayer.GetName(), destProjection,
>> shpLayer.GetGeomType(), new string[] { });                var shpFeature =
>> shpLayer.GetNextFeature();                while (shpFeature != null)
>>         {                    // Transform geometry                    var
>> geometry = shpFeature.GetGeometryRef();
>> geometry.Transform(transform);                    // Save feature to new
>> layer                    jsonLayer.CreateFeature(shpFeature);
>>       shpFeature = shpLayer.GetNextFeature();                }
>>   // TODO: HERE I would like to read the information from my tempJsonFile
>> back into a byte array, before unlinking.                var jsonBuffer =
>> new byte[0];                // Close all GDAL stuff
>> jsonLayer.Dispose();                jsonDataSource.Dispose();
>>   jsonDriver.Dispose();                shpLayer.Dispose();
>> shpDatasource.Dispose();                shpDriver.Dispose();
>> // Read json from buffer                var jsonText =
>> Encoding.UTF8.GetString(jsonBuffer, 0, jsonBuffer.Length); ;
>> var json = JsonConvert.DeserializeObject<FeatureCollection>(jsonText);
>>           return json;            }            catch (Exception exception)
>>           {                throw exception;            }
>> finally            {                // Clear files from GDAL
>> Gdal.Unlink(tempJsonFilename);                foreach (var file in files)
>>               {
>> Gdal.Unlink($"/vsimem/{file.Filename}");                }            }
>>   }*
>>
>>
>> Best Regards
>> Christian
>>
>> --
>>
>> *Christian Sörensen*
>> *UX Productions AB*
>> www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
>> P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>

-- 

*Christian Sörensen*
*UX Productions AB*
www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/69ab5d00/attachment-0001.html>

From Jon.Morris at jbarisk.com  Wed Nov 11 05:00:26 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Wed, 11 Nov 2020 13:00:26 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
Message-ID: <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

Hi Paul,

Thanks for your reply. The only reason we're trying to build locally is to add FileGDB support - if there is a better way to add FileGDB write support to conda-forge GDAL, I'd love to hear it! The GDAL docs are very out of date when it comes to building on Windows - the "GDAL Windows Building example for Plugins" links to https://trac.osgeo.org/gdal/wiki/BuildingOnWindows.

The only reason I'm building 3.1.4 is because when I started, 3.2.0 wasn't out yet...

Thanks,

Jon

From: Paul Harwood <runette at gmail.com>
Sent: 11 November 2020 09:18
To: Jon Morris <Jon.Morris at jbarisk.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL conda build

I think we can be fairly certain that gdal-feedstock works, since it has passed in a clean container environment.

The most obvious question is - I am assuming that you are using conda build - are you working in a clean conda env?

Create a totally new conda env, activate that and then try again.

I have very occasional noticed conda getting confused about versions in its package cache. You can also try `conda clean --all` to clear out the package cache.

I am also curious. Sometimes I see messages go by and I think "why". I assume that you know your business much better than me but I do wonder what you are going to get from building the conda recipe locally that is not already built into the conda package? What have I missed?

I am also curious - given you are going through the effort of creating the build - why 3.1.4 and not 3.2.0? Surely, you risk just building in a legacy problem?


On Tue, 10 Nov 2020 at 08:12, Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
I've been trying to build a Windows conda package for GDAL 3.1.4, but am having problems with the poppler headers. I'm using the conda-forge recipe, which includes a line in the build script to detect the poppler version.

FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
  set POPPLER_MAJOR_VERSION=%%a
  set POPPLER_MINOR_VERSION=%%b
)
https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16

This doesn't seem to be working, as when we get to compiling the pdf driver, the headers are missing.

(gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc<http://makefile.vc>   && cd ..   || exit 1
        cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore  -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0 -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED  -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp pdfcreatefromcomposition.cpp
pdfdataset.cpp
pdfio.cpp
pdfobject.cpp
pdfcreatecopy.cpp
c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54): fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file or directory (compiling source file pdfdataset.cpp)

In pdfsdkheaders.h we can see it's the wrong poppler version that's causing the error:

#if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
#include <goo/gtypes.h>
#else
typedef unsigned char Guchar;
#endif

The installed version of poppler is 20.11.0, so I don't know why I'm getting major version set to 0 and minor version set to 23.

I'll also ask over at conda as this is most likely a conda build problem, but I thought I would also ask here if anyone has successfully built a conda package and knows how to get this recipe working.

Many thanks!

Jon


Jon Morris
Software Developer

COVID-19. During the current outbreak JBA remains open for business and we continue to deliver our services. However, we have adopted flexible/remote working as required. I will be receiving and reading email as normal but I may not always be available on the office number.


[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com/> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev

[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/05fd5266/attachment-0001.html>

From runette at gmail.com  Wed Nov 11 05:35:54 2020
From: runette at gmail.com (Paul Harwood)
Date: Wed, 11 Nov 2020 13:35:54 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAE8nN5NfF4eLKd7Me3=sz-WxoqbDWwMq2S==2OC642bAitcFSQ@mail.gmail.com>

The documents are horrendously out of date - I know :)

I am assuming that you have seen this and that it does not meet your reqs
https://gdal.org/drivers/vector/openfilegdb.html#vector-openfilegdb

Building with an additional driver could, I guess, easily make a difference.

I am wondering if you have tried a vanilla build first - to see if it is
all working

Personally - I would do this :

- Clone the gdal-feedstock repo onto my local machine
- cd gdal-feedstock                           // cd into the gdal-feedstock
dir
- conda create --name gdal              // the actual name does not matter
- as long as it does not exist yet
- conda activate gdal
- conda build recipe

That *should* I think work since that is more or less what conda-forge does
in the azure pipeline - but I am no special expert on that recipe.

If that works - then you are probably going to have to change the meta.yml
to include fileGDB and probably change set_bld_opts.bat to change the build
options. And then run 'conda build recipe` again.

On Wed, 11 Nov 2020 at 13:00, Jon Morris <Jon.Morris at jbarisk.com> wrote:

> Hi Paul,
>
>
>
> Thanks for your reply. The only reason we're trying to build locally is to
> add FileGDB support - if there is a better way to add FileGDB write support
> to conda-forge GDAL, I'd love to hear it! The GDAL docs are very out of
> date when it comes to building on Windows - the "GDAL Windows Building
> example for Plugins" links to
> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows.
>
>
>
> The only reason I'm building 3.1.4 is because when I started, 3.2.0 wasn't
> out yet...
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *From:* Paul Harwood <runette at gmail.com>
> *Sent:* 11 November 2020 09:18
> *To:* Jon Morris <Jon.Morris at jbarisk.com>
> *Cc:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] GDAL conda build
>
>
>
> I think we can be fairly certain that gdal-feedstock works, since it has
> passed in a clean container environment.
>
>
>
> The most obvious question is - I am assuming that you are using conda
> build - are you working in a clean conda env?
>
>
>
> Create a totally new conda env, activate that and then try again.
>
>
>
> I have very occasional noticed conda getting confused about versions in
> its package cache. You can also try `conda clean --all` to clear out the
> package cache.
>
> I am also curious. Sometimes I see messages go by and I think "why". I
> assume that you know your business much better than me but I do wonder what
> you are going to get from building the conda recipe locally that is not
> already built into the conda package? What have I missed?
>
> I am also curious - given you are going through the effort of creating the
> build - why 3.1.4 and not 3.2.0? Surely, you risk just building in a legacy
> problem?
>
>
>
> On Tue, 10 Nov 2020 at 08:12, Jon Morris <Jon.Morris at jbarisk.com> wrote:
>
> I've been trying to build a Windows conda package for GDAL 3.1.4, but am
> having problems with the poppler headers. I'm using the conda-forge recipe,
> which includes a line in the build script to detect the poppler version.
>
>
>
> FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
>
>   set POPPLER_MAJOR_VERSION=%%a
>
>   set POPPLER_MINOR_VERSION=%%b
>
> )
>
>
> https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16
>
>
>
> This doesn't seem to be working, as when we get to compiling the pdf
> driver, the headers are missing.
>
>
>
> (gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc   &&
> cd ..   || exit 1
>
>         cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786
> /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME
> /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore
> -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts
> -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem
> -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0
> -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED
> -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp
> pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp
> pdfcreatefromcomposition.cpp
>
> pdfdataset.cpp
>
> pdfio.cpp
>
> pdfobject.cpp
>
> pdfcreatecopy.cpp
>
> c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54):
> fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file
> or directory (compiling source file pdfdataset.cpp)
>
>
>
> In pdfsdkheaders.h we can see it's the wrong poppler version that's
> causing the error:
>
>
>
> #if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
>
> #include <goo/gtypes.h>
>
> #else
>
> typedef unsigned char Guchar;
>
> #endif
>
>
>
> The installed version of poppler is 20.11.0, so I don't know why I'm
> getting major version set to 0 and minor version set to 23.
>
>
>
> I'll also ask over at conda as this is most likely a conda build problem,
> but I thought I would also ask here if anyone has successfully built a
> conda package and knows how to get this recipe working.
>
>
>
> Many thanks!
>
>
>
> Jon
>
>
>
>
>
> *Jon Morris*
>
> Software Developer
>
>
>
> *COVID-19. During the current outbreak JBA remains open for business and
> we continue to deliver our services. However, we have adopted
> flexible/remote working as required. I will be receiving and reading email
> as normal but I may not always be available on the office number.*
>
>
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
> *T* +44 (0) 1756 799919
> www.jbarisk.com
>
> [image: Visit our website] <http://www.jbarisk.com/>
> <https://www.linkedin.com/in/jon-morris-a2897b4/> [image: Follow us on
> Twitter] <https://twitter.com/jbarisk>
>
> *Find out more about us here: www.jbarisk.com <http://www.jbarisk.com/>
> and **follow us on Twitter @JBARisk <http://twitter.com/JBARisk> and
> LinkedIn
> <https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
> *
>
> The JBA Group supports the JBA Trust.
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
>
>
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, Telephone: +441756799919
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/7489ec8b/attachment.html>

From runette at gmail.com  Wed Nov 11 06:27:37 2020
From: runette at gmail.com (Paul Harwood)
Date: Wed, 11 Nov 2020 14:27:37 +0000
Subject: [gdal-dev] Convert ESRI Shapefile to GeoJSON in memory,
	code in c#
In-Reply-To: <CAGzoYG+Yze949CvKRc4s+68e+oDC3we4+cR1dVc7fNP1GmVQZw@mail.gmail.com>
References: <CAGzoYG+GBn1T+yRZYt38FZs=KU+_Lv9KyA9+QEMRh_rJ0dEcZg@mail.gmail.com>
 <CAE8nN5OHP++2bokvMsuV_fNMxQgRyg6qxBmOQDGnOeGMvj6Oyw@mail.gmail.com>
 <CAE8nN5Od92YoXChkLre8jRQ2OyQkLgjaP6M_py59qFeoKmWXNw@mail.gmail.com>
 <CAGzoYG+_pFj8BPtqRcwGLyp_jcNATMoezZCPssKaa34oVTEVvg@mail.gmail.com>
 <CAE8nN5OuBN+90U5XCu9YVOTLvSbaiJj+k3kCQ9Y9v4pbAiRBhg@mail.gmail.com>
 <CAGzoYG+Yze949CvKRc4s+68e+oDC3we4+cR1dVc7fNP1GmVQZw@mail.gmail.com>
Message-ID: <CAE8nN5Ou9aneb54uN+x9Rwhxw56QPCBAtC4qvwUXbmLLT4EjNw@mail.gmail.com>

Just realised that I excluded the wider from the group accidentally - so
added them back in .

> I looked a bit more into the mongodb driver. I think I would prefer not
using GDAL for saving into the database directly. And only using GDAL for >
importing different formats and transforming between projections.

Makes sense.

I must admit - since at the end you are deserializing the GeoJSON into a
FeatureCollection object I personally would avoid all of this and just
write the features directly to the FeatureCollection object.

But ..

I found this earlier today and got the same exception as him at the
> Marshal.Copy line (the Python version uses VSIFReadL).
> https://lists.osgeo.org/pipermail/gdal-dev/2018-July/048838.html
>
> *            var bufPtr = Gdal.VSIFOpenL(outputRasterFileName, "rb"); //outputRasterFileName is now "/vsimem/file.tiff"
>             Gdal.VSIFSeekL(bufPtr, 0, 2); // seek to end
>             var size = Gdal.VSIFTellL(bufPtr);
>             Gdal.VSIFSeekL(bufPtr, 0, 0); // seek to beginning
>             Gdal.VSIFCloseL(bufPtr);
>             var data = new byte[size];
>             Marshal.Copy(bufPtr, data, 0, size);
>             Gdal.Unlink(outputRasterFileName);*
>
>
Could that be because you are closing the buffer with
`Gdal.VSIFCloseL(bufPtr)`? Why close it before you read it?

Did you get a valid pointer before closing it? What was the value of size?






>
>
>
>
>
> Den ons 11 nov. 2020 kl 14:44 skrev Paul Harwood <runette at gmail.com>:
>
>> The MongoDB driver is definitely the way to go if you can :)
>>
>> Or - since you seem to have a FeatureCollection class in the last line -
>> just right the Features directly to that?
>>
>> But if all of that fails  - I am not sure you are right about VSIFOpenL -
>> did you actually try it? It is passing a pointer to the buffer. That
>> suggest that it expects you to read from the pointer yourself - in the c#
>> code. I am not sure why you would pass a pointer from the open method and
>> then require a "read" - that is only going to return a pointer to the same
>> thing again?
>>
>> On Wed, 11 Nov 2020 at 12:36, Christian Sörensen <
>> christian at uxproductions.se> wrote:
>>
>>> I looked at VSIFOpenL, but the C# version seems to lack VSIFReadL, which
>>> is required for actually reading from the unmanaged virtual file memory
>>> after opening it.
>>>
>>> The last tip looked promising, I will have to take a look at the MongoDB
>>> driver. If it works it could be a good solution.
>>>
>>> Den ons 11 nov. 2020 kl 12:55 skrev Paul Harwood <runette at gmail.com>:
>>>
>>>> Customers! What can you say about Customers! :) Seems the worst of all
>>>> possible worlds to me - but who are we to argue :)
>>>>
>>>> However - there does appear to be `IntPtr Gdal.VSIFOpenL(utf8_path,
>>>> pszMode )`
>>>>
>>>> I have never used it - so I don't know what it does but the name does
>>>> suggest that it is what you are looking for. You would probably have to do
>>>> something like:
>>>>
>>>> I have no guarantee that this would work or provide anything you want.
>>>>
>>>> BTW -I am bit confused that at the end you then deserialize the JSON -
>>>> which would surely turn it back from a string into objects? Are you sure
>>>> you need to do this? Are you sure something like
>>>> https://gdal.org/drivers/vector/mongodbv3.html#vector-mongodbv3 won't
>>>> do the job?
>>>>
>>>> using System.Runtime.InteropServices;
>>>>
>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> * private FeatureCollection ImportShapeFile(IEnumerable<ImportFile>
>>>>>> files)        {            var tempJsonFilename = $"/vsimem/temp.json";
>>>>>>         GdalConfiguration.ConfigureGdal();
>>>>>> GdalConfiguration.ConfigureOgr();            try            {*
>>>>>>
>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> *                // Load shape                Driver shpDriver =
>>>>>> Ogr.GetDriverByName("ESRI Shapefile");                var shpFile =
>>>>>> files.First(f => f.Filename.EndsWith(".shp"));                Datasource
>>>>>> shpDatasource = Ogr.Open($"/vsimem/{shpFile.Filename}", 0);
>>>>>> if (shpDatasource == null)                    return null;
>>>>>> Layer shpLayer = shpDatasource.GetLayerByIndex(0);                // Setup
>>>>>> projection transform to WGS84                SpatialReference srcProjection
>>>>>> = shpLayer.GetSpatialRef();                SpatialReference destProjection
>>>>>> = new SpatialReference("");
>>>>>> destProjection.ImportFromEPSG(4326);                CoordinateTransform
>>>>>> transform = new CoordinateTransformation(srcProjection, destProjection);
>>>>>>             // Copy layer to geo json                Driver jsonDriver =
>>>>>> Ogr.GetDriverByName("GeoJSON");                DataSource jsonDataSource =
>>>>>> jsonDriver.CreateDataSource(tempJsonFilename, new string[] { });
>>>>>>     Layer jsonLayer = jsonDataSource.CreateLayer(shpLayer.GetName(),
>>>>>> destProjection, shpLayer.GetGeomType(), new string[] { });
>>>>>> Feature shpFeature = shpLayer.GetNextFeature();                while
>>>>>> (shpFeature != null)                {                    // Transform
>>>>>> geometry                    Geometry geometry =
>>>>>> shpFeature.GetGeometryRef();
>>>>>> geometry.Transform(transform);                    // Save feature to new
>>>>>> layer                    jsonLayer.CreateFeature(shpFeature);
>>>>>>       shpFeature = shpLayer.GetNextFeature();                }
>>>>>>  IntPtr buffer = Gdal.VSIFOpenL(tempJsonFilename, {some Mode value});*
>>>>>>
>>>>>                       string result = Marshall.PtrToStringAnsi(buffer);
>>>>
>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> *                // Close all GDAL stuff
>>>>>> jsonLayer.Dispose();                jsonDataSource.Dispose();
>>>>>>   jsonDriver.Dispose();                shpLayer.Dispose();
>>>>>> shpDatasource.Dispose();                shpDriver.Dispose();
>>>>>> // Read json from buffer                var jsonText =
>>>>>> Encoding.UTF8.GetString(jsonBuffer, 0, jsonBuffer.Length); ;
>>>>>> var json = JsonConvert.DeserializeObject<FeatureCollection>(jsonText);
>>>>>>           return json;            }            catch (Exception exception)
>>>>>>           {                throw exception;            }
>>>>>> finally            {                // Clear files from GDAL
>>>>>> Gdal.Unlink(tempJsonFilename);                foreach (var file in files)
>>>>>>               {
>>>>>> Gdal.Unlink($"/vsimem/{file.Filename}");                }            }
>>>>>>   }*
>>>>>>
>>>>>>
>>>>>> Best Regards
>>>>>> Christian
>>>>>>
>>>>>> --
>>>>>>
>>>>>> *Christian Sörensen*
>>>>>> *UX Productions AB*
>>>>>> www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77
>>>>>> 212
>>>>>> P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
>>>>>> _______________________________________________
>>>>>> gdal-dev mailing list
>>>>>> gdal-dev at lists.osgeo.org
>>>>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>>>>
>>>>>
>>>
>>> --
>>>
>>> *Christian Sörensen*
>>> *UX Productions AB*
>>> www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
>>> P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
>>>
>>
>
> --
>
> *Christian Sörensen*
> *UX Productions AB*
> www.uxproductions.se | christian at uxproductions.se | +46 (0)70 26 77 212
> P Överväg miljöpåverkan innan du skriver ut detta e-postmeddelande
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/cd3681f5/attachment-0001.html>

From KressM at eba.bund.de  Wed Nov 11 07:07:41 2020
From: KressM at eba.bund.de (=?iso-8859-1?Q?Kre=DF=2C_Marius?=)
Date: Wed, 11 Nov 2020 15:07:41 +0000
Subject: [gdal-dev] Oracle Spatial Driver: Is it possible to append features
	to a table?
Message-ID: <ac641b17b82941c38a3412ee718bf6ef@eba.bund.de>

Dear GDAL developers and users,

I want to write contour polygons into an Oracle Spatial database. Because the area is quite large, I would like to calculate them in smaller boxes and write them into the table one after the other. But as far as I can see, it is not possible to append features to a table. You can only create a new one, overwrite or truncate it. Even if I first write it into a shapefile and then try to write it in the database with ogr2ogr, it ignores the -append and -update options.

Is it correct that it doesn't work or did I miss anything? Do you know a better solution?

Thanks for your help,

Marius Kress
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/c0b5bfa2/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 11 07:19:29 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 11 Nov 2020 08:19:29 -0700 (MST)
Subject: [gdal-dev] Oracle Spatial Driver: Is it possible to append
 features to a table?
In-Reply-To: <ac641b17b82941c38a3412ee718bf6ef@eba.bund.de>
References: <ac641b17b82941c38a3412ee718bf6ef@eba.bund.de>
Message-ID: <1605107969385-0.post@n6.nabble.com>

Hi,

It should work. Write your two first ogr2ogr commands (the initial one and
first to append) as a whole but without OCI connection details. The -nln
parameter must appear in the append command if I remember right.

-Jukka Rahkonen-



Kreß, Marius wrote
> Dear GDAL developers and users,
> 
> I want to write contour polygons into an Oracle Spatial database. Because
> the area is quite large, I would like to calculate them in smaller boxes
> and write them into the table one after the other. But as far as I can
> see, it is not possible to append features to a table. You can only create
> a new one, overwrite or truncate it. Even if I first write it into a
> shapefile and then try to write it in the database with ogr2ogr, it
> ignores the -append and -update options.
> 
> Is it correct that it doesn't work or did I miss anything? Do you know a
> better solution?
> 
> Thanks for your help,
> 
> Marius Kress
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From sean at mapbox.com  Wed Nov 11 07:21:06 2020
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 11 Nov 2020 08:21:06 -0700
Subject: [gdal-dev] armadillo error with homebrew install of ogr2ogr
In-Reply-To: <CAE8nN5MZXiygGPF5yyXiPvca37iDzqxP2T9HD88nhgXjvBxdFg@mail.gmail.com>
References: <A4765768-8423-434F-B9BC-40EDAED26AC6@icloud.com>
 <CAE8nN5MZXiygGPF5yyXiPvca37iDzqxP2T9HD88nhgXjvBxdFg@mail.gmail.com>
Message-ID: <CADPhZXz07tYx0ZrQb3z=1=RT+A_OsQzBm6e4b1D-_c0zXtiToA@mail.gmail.com>

Hi Paul,

Please be careful about telling people that Conda is a panacea. It's not
true. I maintain several software projects that have conda and conda-forge
packages and I follow several conda-forge repo issue trackers, and I am
here to say that users manage to mess up their conda environments regularly.

Making a stable software distribution is hard. There is no silver bullet.
Conda is not a silver bullet. All distributions that try to provide the
latest versions of software will be semi-flaky. All robust distributions
will have versions that lag a bit. It's like a law of nature.

On Wed, Nov 11, 2020 at 1:51 AM Paul Harwood <runette at gmail.com> wrote:

> Have you thought about just using the Conda Installation? Solves most or
> all of these problems.
>
> On Tue, 10 Nov 2020 at 17:14, John Muccigrosso <muccigrosso at icloud.com>
> wrote:
>
>> I've just started getting this error when I try to use ogr2ogr:
>>
>> dyld: Library not loaded:
>> /usr/local/opt/armadillo/lib/libarmadillo.9.dylib
>>   Referenced from: /usr/local/bin/ogr2ogr
>>   Reason: image not found
>>
>>
>> Presumably this is because armadillo is up to version 10 in my system:
>>
>>
>> > ll /usr/local/opt/armadillo/lib/
>> total 576
>> drwxr-xr-x   6 username  staff     192 Oct 28 09:06 .
>> drwxr-xr-x  10 username  staff     320 Oct 28 09:06 ..
>> -r--r--r--   1 username  staff  293580 Oct 28 09:06
>> libarmadillo.10.1.1.dylib
>> lrwxr-xr-x   1 username  staff      25 Oct 28 09:06 libarmadillo.10.dylib
>> -> libarmadillo.10.1.1.dylib
>> lrwxr-xr-x   1 username  staff      21 Oct 28 09:06 libarmadillo.dylib ->
>> libarmadillo.10.dylib
>> drwxr-xr-x   3 username  staff      96 Oct 28 09:06 pkgconfig
>>
>>
>> I've installed goal via homebrew.
>>
>> Thanks for any help.
>>
>> John
>>
>

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/aa44a1fc/attachment.html>

From howard at hobu.co  Wed Nov 11 08:19:17 2020
From: howard at hobu.co (Howard Butler)
Date: Wed, 11 Nov 2020 10:19:17 -0600
Subject: [gdal-dev] GDAL t-shirts!
Message-ID: <E69260BF-26F2-409F-85AE-34539E969D62@hobu.co>

All,

Joe Morrison [1] coordinated the creation of new GDAL t-shirts with a fun update to the logo. Proceeds of the sales will be donated to OSGeo. Visit https://teespring.com/gdal <https://teespring.com/gdal> to get yourself one.

Howard

[1] https://twitter.com/mouthofmorrison/status/1326556800997527557?s=20

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/a07fe490/attachment.html>

From evert.etienne at sitemark.com  Wed Nov 11 11:32:37 2020
From: evert.etienne at sitemark.com (Evert Etienne (SITEMARK))
Date: Wed, 11 Nov 2020 19:32:37 +0000
Subject: [gdal-dev] Location change on gdalwarp reprojection
Message-ID: <305A3A72-3325-478A-9390-1146A8631DFD@sitemark.com>


Hey all,

I have some behaviour that I can’t wrap my head around. When I reproject a tif using gdalwarp, the location (as visible in QGIS or after using gdal2tiles on a map) changes. It is visible when checking the bounds using QGIS.
It is also noticeable when checking the bounds with rasterio:

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255] <----- 1
gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
repro.tif
EPSG:3857
bounds [608015.5294828439, 6272484.913981743, 609507.0864301398, 6274297.75045133]
EPSG:27573 bounds [829484.0038619096, 3748101.0103735547, 830512.7970793804, 3749330.248761157]
EPSG:3857 bounds [608015.5294828439, 6272484.913981743, 609507.0864301398, 6274297.75045133]
EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526, 48.99667806803407]  <----- 2
gdalwarp -t_srs EPSG:27573 repro.tif back.tif
back.tif
EPSG:27573
bounds [829484.0038619096, 3748101.034601565, 830512.7912119445, 3749330.2487611575]
EPSG:27573 bounds [829484.0038619096, 3748101.034601565, 830512.7912119445, 3749330.2487611575]
EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724, 6274354.58877996]
EPSG:4326 bounds [5.461280848150926, 48.98565744919683, 5.475913594925499, 48.99701306471833]  <----- 3
```

The accompanying python code is three times like the following
```
input_file = folder + 'orig.tif'
img = rasterio.open(input_file)
print('orig.tif')
print(img.crs)
print('bounds', list(warp.transform_bounds(img.crs, img.crs, *img.bounds)))
print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs, 'EPSG:27573', *img.bounds)))
print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857', *img.bounds)))
print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs, 'EPSG:4326', *img.bounds)))
```

As the arrows show, the bounds change between 1 and 2 (this is the unexpected behaviour for me). Yet they don’t change when projecting back.

I am unsure if this is a bug in GDAL, something weird with this specific EPSG or the source tif. Any further steps for investigation or ideas would be very welcome

Many thanks

Evert

From evert.etienne at sitemark.com  Wed Nov 11 11:46:18 2020
From: evert.etienne at sitemark.com (Evert Etienne (SITEMARK))
Date: Wed, 11 Nov 2020 19:46:18 +0000
Subject: [gdal-dev] Location change on gdalwarp reprojection
In-Reply-To: <305A3A72-3325-478A-9390-1146A8631DFD@sitemark.com>
References: <305A3A72-3325-478A-9390-1146A8631DFD@sitemark.com>
Message-ID: <FA793503-33FD-4C8C-838A-C239726D0321@sitemark.com>

It does not happen when just warping, but it does occur when warping to the same EPSG as can be seen in the follow logs
```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255] <----- OK
gdalwarp orig.tif justwarp.tif
justwarp.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945, 44.103402376252255] <----- SAME
gdalwarp -t_srs EPSG:27573 orig.tif noreproj.tif
noreproj.tif
EPSG:27573
bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361, 3749294.6346238866]
EPSG:27573 bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361, 3749294.6346238866]
EPSG:3857 bounds [608015.3560148155, 6272484.6841915725, 609507.2374494626, 6274297.96416575]
EPSG:4326 bounds [5.461894872874811, 48.98599094207838, 5.475296671823179, 48.99667932763942] <----- CHANGED
```

GDAL info of orig.tif:
```
Driver: GTiff/GeoTIFF
Files: orig.tif
Size is 18676, 23014
Coordinate System is:
PROJCRS["NTF (Paris) / Lambert zone III",
    BASEGEOGCRS["NTF (Paris)",
        DATUM["Nouvelle Triangulation Francaise (Paris)",
            ELLIPSOID["Clarke 1880 (IGN)",6378249.2,293.466021293627,
                LENGTHUNIT["metre",1]]],
        PRIMEM["Paris",2.5969213,
            ANGLEUNIT["grad",0.0157079632679489]],
        ID["EPSG",4807]],
    CONVERSION["unnamed",
        METHOD["Lambert Conic Conformal (1SP)",
            ID["EPSG",9801]],
        PARAMETER["Latitude of natural origin",54.4444444444445,
            ANGLEUNIT["grad",0.0157079632679489],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",0,
            ANGLEUNIT["grad",0.0157079632679489],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",0.999877499,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",600000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",3200000,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["easting",east,
            ORDER[1],
            LENGTHUNIT["metre",1]],
        AXIS["northing",north,
            ORDER[2],
            LENGTHUNIT["metre",1]],
    ID["EPSG",27573]]
Data axis to CRS axis mapping: 1,2
Origin = (828662.071093128062785,3204344.670086107682437)
Pixel Size = (0.050000000000002,-0.050000000000008)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  COMPRESSION=LZW
  INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  828662.071, 3204344.670) (  3d 7'33.28"E, 48d59'48.23"N)
Lower Left  (  828662.071, 3203193.970) (  3d 7'30.95"E, 48d59'11.01"N)
Upper Right (  829595.871, 3204344.670) (  3d 8'19.19"E, 48d59'46.98"N)
Lower Right (  829595.871, 3203193.970) (  3d 8'16.85"E, 48d59' 9.76"N)
Center      (  829128.971, 3203769.320) (  3d 7'55.07"E, 48d59'28.99"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
  Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Mask Flags: PER_DATASET ALPHA 
  Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Unit Type: metre
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
  Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Mask Flags: PER_DATASET ALPHA 
  Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Unit Type: metre
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
  Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Mask Flags: PER_DATASET ALPHA 
  Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Unit Type: metre
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
  Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720, 292x360, 146x180
  Unit Type: metre
```

> On 11 Nov 2020, at 20:32, Evert Etienne (SITEMARK) <evert.etienne at sitemark.com> wrote:
> 
> 
> Hey all,
> 
> I have some behaviour that I can’t wrap my head around. When I reproject a tif using gdalwarp, the location (as visible in QGIS or after using gdal2tiles on a map) changes. It is visible when checking the bounds using QGIS.
> It is also noticeable when checking the bounds with rasterio:
> 
> ```
> orig.tif
> EPSG:27573
> bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
> EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
> EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
> EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255] <----- 1
> gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
> repro.tif
> EPSG:3857
> bounds [608015.5294828439, 6272484.913981743, 609507.0864301398, 6274297.75045133]
> EPSG:27573 bounds [829484.0038619096, 3748101.0103735547, 830512.7970793804, 3749330.248761157]
> EPSG:3857 bounds [608015.5294828439, 6272484.913981743, 609507.0864301398, 6274297.75045133]
> EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526, 48.99667806803407]  <----- 2
> gdalwarp -t_srs EPSG:27573 repro.tif back.tif
> back.tif
> EPSG:27573
> bounds [829484.0038619096, 3748101.034601565, 830512.7912119445, 3749330.2487611575]
> EPSG:27573 bounds [829484.0038619096, 3748101.034601565, 830512.7912119445, 3749330.2487611575]
> EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724, 6274354.58877996]
> EPSG:4326 bounds [5.461280848150926, 48.98565744919683, 5.475913594925499, 48.99701306471833]  <----- 3
> ```
> 
> The accompanying python code is three times like the following
> ```
> input_file = folder + 'orig.tif'
> img = rasterio.open(input_file)
> print('orig.tif')
> print(img.crs)
> print('bounds', list(warp.transform_bounds(img.crs, img.crs, *img.bounds)))
> print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs, 'EPSG:27573', *img.bounds)))
> print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857', *img.bounds)))
> print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs, 'EPSG:4326', *img.bounds)))
> ```
> 
> As the arrows show, the bounds change between 1 and 2 (this is the unexpected behaviour for me). Yet they don’t change when projecting back.
> 
> I am unsure if this is a bug in GDAL, something weird with this specific EPSG or the source tif. Any further steps for investigation or ideas would be very welcome
> 
> Many thanks
> 
> Evert
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C4ba1c63db9e74e36d0e008d88678923c%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407199695587428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=5vBljKWRNYXuXdTYgISUX8G5imyZ40Fbwd5Ai%2FA635E%3D&amp;reserved=0


From mateusz at loskot.net  Wed Nov 11 12:11:29 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 11 Nov 2020 21:11:29 +0100
Subject: [gdal-dev] GDAL t-shirts!
In-Reply-To: <E69260BF-26F2-409F-85AE-34539E969D62@hobu.co>
References: <E69260BF-26F2-409F-85AE-34539E969D62@hobu.co>
Message-ID: <CABUeae_KSR54WLOrMKTk8wD3w6B65J6xe-jw+7FLAdZKe0dXZQ@mail.gmail.com>

On Wed, 11 Nov 2020, 17:19 Howard Butler, <howard at hobu.co> wrote:

> All,
>
> Joe Morrison [1] coordinated the creation of new GDAL t-shirts with a fun
> update to the logo. Proceeds of the sales will be donated to OSGeo. Visit
> https://teespring.com/gdal to get yourself one.
>
> Howard
>
> [1] https://twitter.com/mouthofmorrison/status/1326556800997527557?s=20
>


Awesome!
I really like the back side, brilliant idea.
Kudos!

Mateusz Loskot, mateusz at loskot.net
(Sent from mobile, may suffer from top-posting)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/12a96f86/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 11 13:38:46 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 11 Nov 2020 14:38:46 -0700 (MST)
Subject: [gdal-dev] Location change on gdalwarp reprojection
In-Reply-To: <FA793503-33FD-4C8C-838A-C239726D0321@sitemark.com>
References: <305A3A72-3325-478A-9390-1146A8631DFD@sitemark.com>
 <FA793503-33FD-4C8C-838A-C239726D0321@sitemark.com>
Message-ID: <1605130726567-0.post@n6.nabble.com>

Hi,

The bounds do not mean exactly what you think. Re-projecting a rectangular
image from EPSG:27573 into EPSG:4326 rotates the image somewhat
counter-clockwise. This image is from another context
https://www.usgs.gov/media/images/landsat-1-8-landsatlook-image-examples but
you can get the idea. The new bounds report the min-max coordinates of the
envelope that contains that rotated image. The corners of the original image
are not at the corners of the warped image. That explains why WGS 84 bounds
in EPSG:3857 are different.

The difference when you warp to EPSG:27573  may mean that the coordinate
system of the original image is not EPSG:27573, at least not for the Proj
library. What happens with command:

gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif
from_27573_into_27573.tif

-Jukka Rahkonen-




Evert Etienne (SITEMARK) wrote
> It does not happen when just warping, but it does occur when warping to
> the same EPSG as can be seen in the follow logs
> ```
> orig.tif
> EPSG:27573
> bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
> 3204344.6700861077]
> EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
> 829595.8710931281, 3204344.6700861077]
> EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
> 5481457.907968456]
> EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942,
> 44.103402376252255] <----- OK
> gdalwarp orig.tif justwarp.tif
> justwarp.tif
> EPSG:27573
> bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282,
> 3204344.6700861077]
> EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
> 829595.8710931282, 3204344.6700861077]
> EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
> 5481457.907968456]
> EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945,
> 44.103402376252255] <----- SAME
> gdalwarp -t_srs EPSG:27573 orig.tif noreproj.tif
> noreproj.tif
> EPSG:27573
> bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361,
> 3749294.6346238866]
> EPSG:27573 bounds [829527.7905651039, 3748136.6066527413,
> 830468.8074871361, 3749294.6346238866]
> EPSG:3857 bounds [608015.3560148155, 6272484.6841915725,
> 609507.2374494626, 6274297.96416575]
> EPSG:4326 bounds [5.461894872874811, 48.98599094207838, 5.475296671823179,
> 48.99667932763942] <----- CHANGED
> ```
> 
> GDAL info of orig.tif:
> ```
> Driver: GTiff/GeoTIFF
> Files: orig.tif
> Size is 18676, 23014
> Coordinate System is:
> PROJCRS["NTF (Paris) / Lambert zone III",
>     BASEGEOGCRS["NTF (Paris)",
>         DATUM["Nouvelle Triangulation Francaise (Paris)",
>             ELLIPSOID["Clarke 1880 (IGN)",6378249.2,293.466021293627,
>                 LENGTHUNIT["metre",1]]],
>         PRIMEM["Paris",2.5969213,
>             ANGLEUNIT["grad",0.0157079632679489]],
>         ID["EPSG",4807]],
>     CONVERSION["unnamed",
>         METHOD["Lambert Conic Conformal (1SP)",
>             ID["EPSG",9801]],
>         PARAMETER["Latitude of natural origin",54.4444444444445,
>             ANGLEUNIT["grad",0.0157079632679489],
>             ID["EPSG",8801]],
>         PARAMETER["Longitude of natural origin",0,
>             ANGLEUNIT["grad",0.0157079632679489],
>             ID["EPSG",8802]],
>         PARAMETER["Scale factor at natural origin",0.999877499,
>             SCALEUNIT["unity",1],
>             ID["EPSG",8805]],
>         PARAMETER["False easting",600000,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8806]],
>         PARAMETER["False northing",3200000,
>             LENGTHUNIT["metre",1],
>             ID["EPSG",8807]]],
>     CS[Cartesian,2],
>         AXIS["easting",east,
>             ORDER[1],
>             LENGTHUNIT["metre",1]],
>         AXIS["northing",north,
>             ORDER[2],
>             LENGTHUNIT["metre",1]],
>     ID["EPSG",27573]]
> Data axis to CRS axis mapping: 1,2
> Origin = (828662.071093128062785,3204344.670086107682437)
> Pixel Size = (0.050000000000002,-0.050000000000008)
> Metadata:
>   AREA_OR_POINT=Area
> Image Structure Metadata:
>   COMPRESSION=LZW
>   INTERLEAVE=PIXEL
> Corner Coordinates:
> Upper Left  (  828662.071, 3204344.670) (  3d 7'33.28"E, 48d59'48.23"N)
> Lower Left  (  828662.071, 3203193.970) (  3d 7'30.95"E, 48d59'11.01"N)
> Upper Right (  829595.871, 3204344.670) (  3d 8'19.19"E, 48d59'46.98"N)
> Lower Right (  829595.871, 3203193.970) (  3d 8'16.85"E, 48d59' 9.76"N)
> Center      (  829128.971, 3203769.320) (  3d 7'55.07"E, 48d59'28.99"N)
> Band 1 Block=256x256 Type=Byte, ColorInterp=Red
>   Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
> 292x360, 146x180
>   Mask Flags: PER_DATASET ALPHA 
>   Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
> 584x720, 292x360, 146x180
>   Unit Type: metre
> Band 2 Block=256x256 Type=Byte, ColorInterp=Green
>   Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
> 292x360, 146x180
>   Mask Flags: PER_DATASET ALPHA 
>   Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
> 584x720, 292x360, 146x180
>   Unit Type: metre
> Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
>   Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
> 292x360, 146x180
>   Mask Flags: PER_DATASET ALPHA 
>   Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
> 584x720, 292x360, 146x180
>   Unit Type: metre
> Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
>   Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
> 292x360, 146x180
>   Unit Type: metre
> ```
> 
>> On 11 Nov 2020, at 20:32, Evert Etienne (SITEMARK) &lt;

> evert.etienne@

> &gt; wrote:
>> 
>> 
>> Hey all,
>> 
>> I have some behaviour that I can’t wrap my head around. When I reproject
>> a tif using gdalwarp, the location (as visible in QGIS or after using
>> gdal2tiles on a map) changes. It is visible when checking the bounds
>> using QGIS.
>> It is also noticeable when checking the bounds with rasterio:
>> 
>> ```
>> orig.tif
>> EPSG:27573
>> bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
>> 3204344.6700861077]
>> EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
>> 829595.8710931281, 3204344.6700861077]
>> EPSG:3857 bounds [578066.9358574335, 5479808.142856716,
>> 579420.0775091586, 5481457.907968456]
>> EPSG:4326 bounds [5.192863637248721, 44.09275933293886,
>> 5.205019115521942, 44.103402376252255] <----- 1
>> gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
>> repro.tif
>> EPSG:3857
>> bounds [608015.5294828439, 6272484.913981743, 609507.0864301398,
>> 6274297.75045133]
>> EPSG:27573 bounds [829484.0038619096, 3748101.0103735547,
>> 830512.7970793804, 3749330.248761157]
>> EPSG:3857 bounds [608015.5294828439, 6272484.913981743,
>> 609507.0864301398, 6274297.75045133]
>> EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526,
>> 48.99667806803407]  <----- 2
>> gdalwarp -t_srs EPSG:27573 repro.tif back.tif
>> back.tif
>> EPSG:27573
>> bounds [829484.0038619096, 3748101.034601565, 830512.7912119445,
>> 3749330.2487611575]
>> EPSG:27573 bounds [829484.0038619096, 3748101.034601565,
>> 830512.7912119445, 3749330.2487611575]
>> EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724,
>> 6274354.58877996]
>> EPSG:4326 bounds [5.461280848150926, 48.98565744919683,
>> 5.475913594925499, 48.99701306471833]  <----- 3
>> ```
>> 
>> The accompanying python code is three times like the following
>> ```
>> input_file = folder + 'orig.tif'
>> img = rasterio.open(input_file)
>> print('orig.tif')
>> print(img.crs)
>> print('bounds', list(warp.transform_bounds(img.crs, img.crs,
>> *img.bounds)))
>> print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs,
>> 'EPSG:27573', *img.bounds)))
>> print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857',
>> *img.bounds)))
>> print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs,
>> 'EPSG:4326', *img.bounds)))
>> ```
>> 
>> As the arrows show, the bounds change between 1 and 2 (this is the
>> unexpected behaviour for me). Yet they don’t change when projecting back.
>> 
>> I am unsure if this is a bug in GDAL, something weird with this specific
>> EPSG or the source tif. Any further steps for investigation or ideas
>> would be very welcome
>> 
>> Many thanks
>> 
>> Evert
>> _______________________________________________
>> gdal-dev mailing list
>> 

> gdal-dev at .osgeo

>> https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C4ba1c63db9e74e36d0e008d88678923c%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407199695587428%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=5vBljKWRNYXuXdTYgISUX8G5imyZ40Fbwd5Ai%2FA635E%3D&amp;reserved=0
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 11 13:55:01 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Wed, 11 Nov 2020 21:55:01 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
Message-ID: <77b40009b5f046418ab7a464b50f8504@maanmittauslaitos.fi>

Hi,

Sorry, this is something that I am not familiar with. The developer of the WCS plugin probably could tell if it is at all supported to use the XML file as input like you tried. I wonder if Ari Jolma happens to follow the list. And what QGIS does is all mystery for me.

-Jukka Rahkonen-

Lähettäjä: 1520 gis <juliermeopensourcedeveloper at gmail.com>
Lähetetty: keskiviikko 11. marraskuuta 2020 16.55
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: gdal-dev Digest, Vol 198, Issue 14

Dear Jukka Rahkonen,

Thank you very much for your patience, time, and detailed information given to my questions. I appreciated it all.

In your discussion in [1], I could get the a xml sample [2].

In [3], you will get the whole image available in geoserver. And in [4], You will get the Image [3] subset.

My goal is to load [3] e [4], mainly [4] subset in QGIS, by adding a XML raster. It is important to mention that I am not interested in accessing the raster data through a WCS connection, I am actually adding a xml as a raster (Ctrl + Shift + R).

If you save the xml file in [2] or [5] and add to QGIS as raster data (Ctrl + Shift + R), you will get the image.

Now, the xml you find in [5] was created by just changing the tag values according  to your discussion in [1]. I could not find through gdal documentation how to generate this xml using gdal_translate. GDAL_WMTS driver stunningly does the job. See  gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -of WMTS.

My need is to create a xml for [4] just like the one available in [5]. I need to access the image in [4] subset using GDAL_WCS.

The command line in [6] creates a tiff image, but I am looking for the xml that when loaded to QGIS ingest the WCS service and loads the image.

I wonder If there is a xml tag to the subset available in [4]. Or if there is a command line for gdal_translate that can generate XML in 3, and most importantly, generate a xml for the subset in [4], similar to gda GDAL_WMTS driver shown above.

Sorry for the long e-mail.  I have no words to thank you for your help and consideration of my messages.

Kinds Regards

Julierme





[1] https://geoserver-users.narkive.com/2FVEaNlm/define-geoserver-bounding-box-using-gdal-s-wcs-driver

[2] XML Sample

<WCS_GDAL>
  <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;</ServiceURL>
  <CoverageName>nurc:mosaic</CoverageName>
  <GetCoverageExtra>&amp;BoundingBox=6.346,36.492,20.83,46.591</GetCoverageExtra>
</WCS_GDAL>

[3]https://demo.geo-solutions.it/geoserver/wcs?Service=WCS
&version=2.0.1
&bbox=-130.85168,20.7052,-62.0054,54.1141
&request=GetCoverage
&coverageId=nurc:Img_Sample
&format=image/png

[4] https://demo.geo-solutions.it/geoserver/wcs?service=WCS
&version=2.0.1
&request=GetCoverage
&SubsettingCRS=EPSG:4326
&coverageId=nurc:Img_Sample
&SUBSET=Long(-100,-80)&SUBSET=Lat(30,40)
&format=image/png


[5] <WCS_GDAL>
  <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;</ServiceURL>
  <CoverageName>nurc:Img_Sample</CoverageName>
  <GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
</WCS_GDAL>

[6] gdal_translate -oo CACHE=wcs_cache -oo CLEAR_CACHE -oo INTERLEAVE=PIXEL -projwin 377418 6683393.87938218 377717.879386966 6683094 -oo Subset="time(1985-01-01T00:00:00.000Z)" -outsize 60 0 "WCS:https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva" scaled.tiff

On Tue, Nov 10, 2020 at 1:23 PM Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
Hi,

Sending mail just to you because this is not a proper answer but rather some first-aid. Normally we keep the discussion on the list to other users can help, and get help by the same.

Sorry, -spat is for ogr2ogr, in gdal_translate it is -projwin. Give the bbox coordinates as in the help:
       [-projwin ulx uly lrx lry]

upper left x upper left y lower right x lower right y

Hope that you get it to work but I may look at this deeper when I have better time for that.

First step is to create the XML file. Then test is with gdalinfo, when it reports something that makes sense you can continue with gdal_translate and all the standard options that it has.

WCS 2.0 is pretty easy to use also with plain hand written http requests, read the standard for learning. I would forget older versions.

Test URL for you
https://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&CoverageId=nurc__mosaic&subset=Long(8.0,8.1)&subset=Lat(38,38.1)&format=tiff

Unfortunately the server was down earlier today, I hope it works now.

-Jukka-

Lähettäjä: 1520 gis <juliermeopensourcedeveloper at gmail.com<mailto:juliermeopensourcedeveloper at gmail.com>>
Lähetetty: tiistai 10. marraskuuta 2020 18.10
Vastaanottaja: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>; Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Aihe: Re: gdal-dev Digest, Vol 198, Issue 14

Dear Jukka Rahkonen,

Thank you very much for your reply.

First of all, my apologies for my lack of knowledge about using GDAL_WCS driver. Let me give more details about the issues I am facing.

Extract of http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities is shown in [1].

Regarding gdal_translate GDAL_WCS driver Image subset extract, looking at https://gdal.org/drivers/raster/wcs.html#examples, I tried the following:

Similar to GDAL_WMTS <gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -of WMTS>,
I tried running:
(1)
 gdal_translate "WCS:http://172.21.14.45:8181/geoserver/wcs?version=2.0.1&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"  CBERS-4_AWFI_170_111_21052020.xml

The response: I did not get the xml as wmts.xml showed above

Note: Including the -of option (WCS), the outcome fails

(2)
gdal_translate "WCS:http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020" \
-spat -58 -11 -57.75 -10.7 \
CBERS-4_AWFI_170_111_21052020.xml

The response: There is no -spat option for gdal_translate

gdal_translate --help

Usage: gdal_translate [--help-general] [--long-usage]
       [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
             CInt16/CInt32/CFloat32/CFloat64}] [-strict]
       [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
       [-outsize xsize[%]|0 ysize[%]|0] [-tr xres yres]
       [-r {nearest,bilinear,cubic,cubicspline,lanczos,average,mode}]
       [-unscale] [-scale[_bn] [src_min src_max [dst_min dst_max]]]* [-exponent[_bn] exp_val]*
       [-srcwin xoff yoff xsize ysize] [-epo] [-eco]
       [-projwin ulx uly lrx lry] [-projwin_srs srs_def]
       [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
       [-a_scale value] [-a_offset value]
       [-nogcp] [-gcp pixel line easting northing [elevation]]*
       |-colorinterp{_bn} {red|green|blue|alpha|gray|undefined}]
       |-colorinterp {red|green|blue|alpha|gray|undefined},...]
       [-mo "META-TAG=VALUE"]* [-q] [-sds]
       [-co "NAME=VALUE"]* [-stats] [-norat]
       [-oo NAME=VALUE]*
       src_dataset dst_dataset



[1] WCS GetCapabilities request

<wcs:CoverageSummary>
<ows:Title>CBERS-4_AWFI_170_111_21052020</ows:Title>
<ows:Abstract>Generated from GeoTIFF</ows:Abstract>
<ows:Keywords>
<ows:Keyword>deter-amazonia-CBERS-4_AWFI_170_111_21052020</ows:Keyword>
<ows:Keyword>WCS</ows:Keyword>
<ows:Keyword>GeoTIFF</ows:Keyword>
</ows:Keywords>
<wcs:CoverageId>deter-amazonia__CBERS-4_AWFI_170_111_21052020</wcs:CoverageId>
<wcs:CoverageSubtype>RectifiedGridCoverage</wcs:CoverageSubtype>
<ows:WGS84BoundingBox>
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:WGS84BoundingBox>
<ows:BoundingBox crs="http://www.opengis.net/def/crs/EPSG/0/EPSG:4326">
<ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
<ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
</ows:BoundingBox>
</wcs:CoverageSummary>


Any comment will be very appreciated.

GDAL website<https://gdal.org/drivers/raster/wmts.html> provides examples on how to run GDAL_WMTS driver in order to get a wmts xml file. I have looked in https://gdal.org/drivers/raster/wcs.html and could not find an example pointing to -spat option.  I got an -spat option
to gdal_grid<https://gdal.org/programs/gdal_grid.html?highlight=spat#cmdoption-gdal_grid-spat> though.

gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -of WMTS

gdal_translate "WCS:http://www.dpi.inpe.br/fipcerrado-geoserver/ows/wcs?request=GetCapabilities" \

-oo CoverageName=deter-cerrado:CBERS-4_AWFI_161_099_13072018 CBERS-4_AWFI_161_099_13072018.xml -of WCS



On Mon, Nov 9, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>> wrote:
Send gdal-dev mailing list submissions to
        gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

To subscribe or unsubscribe via the World Wide Web, visit
        https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
        gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>

You can reach the person managing the list at
        gdal-dev-owner at lists.osgeo.org<mailto:gdal-dev-owner at lists.osgeo.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. Re: Selecting just the geometry column with OGR SQL (Even Rouault)
   2. Re: Selecting just the geometry column with OGR SQL
      (Rahkonen Jukka (MML))
   3. Re: WCS_GDAL Driver Image SubSet Request (jratike80)


----------------------------------------------------------------------

Message: 1
Date: Mon, 09 Nov 2020 16:09:45 +0100
From: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Cc: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
        SQL
Message-ID: <1659214.2tRo4lr4Oo at even-i700<mailto:1659214.2tRo4lr4Oo at even-i700>>
Content-Type: text/plain; charset="us-ascii"

Jukka,

> I believe that OGR SQL dialect adds the geometry column into SQL selection
> by default. Am I right with this? I volunteer to edit the documentation
> https://gdal.org/user/ogr_sql_dialect.html if this is the case. But what I
> can't understand is another side of the story, how to select just the
> geometry field with OGR SQL dialect from some data sources.
>
> This command returns both time column and geometry from GML
> ogrinfo -sql "select time from timetest" timetest.gml
> I can select just the geometry from geometry column named as
> "geometryProperty" by ogrinfo -sql "select geometryProperty from timetest"
> timetest.gml
>
> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> Geometry is selected automatically but it can be selected also by name. But
> I cannot discover any way to select just the geometry field from shapefile.
> Is it because geometry column in shapefile does not have any name as this
> Python test seems to prove?
> >>> from osgeo import ogr
> >>> shp_ds = ogr.Open('timetest.shp')
> >>> shp_lyr = shp_ds.GetLayer(0)
> >>> shp_lyr.GetGeometryColumn()
>
> ''
>
> OpenJUMP JML driver does not report a name for geometry column either. Is it
> rather an exception that drivers give names for the geometry columns? I
> know I can select only the geometry column with the SQLite dialect, but I
> am curious.

Indeed, in OGR SQL, if the geometry column has a non-empty name (typically for
database drivers), you can use it to select it. When the geometry column name
is empty, such as in the shapefile or OpenJUMP driver, you can use
_ogr_geometry_ (with leading and trainling underscore) to select it. This is
likely undocumented.

As far as I can see, this was introduced per
https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
to fix an issue with comparison with empty string literals (this was before
OGR enforced the difference between single-quoted string literals and double-
quoted identifiers)

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com


------------------------------

Message: 2
Date: Mon, 9 Nov 2020 15:35:11 +0000
From: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
To: Even Rouault <even.rouault at spatialys.com<mailto:even.rouault at spatialys.com>>,
        "gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>>
Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
        SQL
Message-ID: <d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi<mailto:d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi>>
Content-Type: text/plain; charset="us-ascii"

Even Rouault wrote:
maanantai 9. marraskuuta 2020 17.10

> Jukka,

>> I believe that OGR SQL dialect adds the geometry column into SQL
>> selection by default. Am I right with this? I volunteer to edit the
>> documentation https://gdal.org/user/ogr_sql_dialect.html if this is
>> the case. But what I can't understand is another side of the story,
>> how to select just the geometry field with OGR SQL dialect from some data sources.
>>
>> This command returns both time column and geometry from GML ogrinfo
>> -sql "select time from timetest" timetest.gml I can select just the
>> geometry from geometry column named as "geometryProperty" by ogrinfo
>> -sql "select geometryProperty from timetest"
>> timetest.gml
>>
>> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
>> Geometry is selected automatically but it can be selected also by
>> name. But I cannot discover any way to select just the geometry field from shapefile.
>> Is it because geometry column in shapefile does not have any name as
>> this Python test seems to prove?
>> >>> from osgeo import ogr
>> >>> shp_ds = ogr.Open('timetest.shp')
>> >>> shp_lyr = shp_ds.GetLayer(0)
>> >>> shp_lyr.GetGeometryColumn()
>>
>> ''
>>
>> OpenJUMP JML driver does not report a name for geometry column either.
>> Is it rather an exception that drivers give names for the geometry
>> columns? I know I can select only the geometry column with the SQLite
>> dialect, but I am curious.

> Indeed, in OGR SQL, if the geometry column has a nonempty name (typically for
> database drivers), you can use it to select it. When the geometry column name
> is empty, such as in the shapefile or OpenJUMP driver, you can use
> _ogr_geometry_ (with leading and trainling underscore) to select it. This is likely undocumented.

> As far as I can see, this was introduced per
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> to fix an issue with comparison with empty string literals (this was before OGR enforced the
>  difference between single-quoted string literals and double- quoted identifiers)

I could not manage to guess the right syntax for Windows right ahead but solved the quiz easily
with your double-quote hint

First trial:
ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
INFO: Open of `timetest.shp'
      using driver `ESRI Shapefile' successful.
ERROR 1: SQL Expression Parsing Error: syntax error, unexpected $undefined. Occurred around :
select _ogr_geometry_ from timetest

Second trial:
ogrinfo -sql "select \"_ogr_geometry_\" from timetest" timetest.shp

-Jukka-

> Even

--
Spatialys - Geospatial professional services http://www.spatialys.com


------------------------------

Message: 3
Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] WCS_GDAL Driver Image SubSet Request
Message-ID: <1604936825138-0.post at n6.nabble.com<mailto:1604936825138-0.post at n6.nabble.com>>
Content-Type: text/plain; charset=us-ascii

Hi,

Do you want to make is somehow impossible to request data beyound the
BoundingBox that you defined in the XML file? If you just want to get data
from the rectangle that you or your users define, gdal_translate with the
regular -spat option should work out-of-the-box.

-Jukka Rahkonen-


juliermeopensourcedeveloper wrote
> Hi all,
>
> Is it possible to define a bounding box in order to request a coverage
> subset using the GDAL WCS Driver?
> I have tried the code in [1]. I  am trying to get information only for the
> bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
> image or bbox_interest request has not been delivered. The West Longitude
> reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
> of the bbox_interest.
> The image extent is:
> <GetCoverageExtra>
> &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
> </GetCoverageExtra>
>  Any comment on this issue will be greatly appreciated.
> Thank you very much for your time in advance.
> *CODE [1]:*
> <WCS_GDAL>
> <ServiceURL>
> http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
> </
> ServiceURL>
> <CoverageName>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </
> CoverageName>
> <GetCoverageExtra>
> &amp;BoundingBox=-58,-11,-57.75,-10.75
> </GetCoverageExtra>
> <CoverageOffering>
> <description>
> Generated from GeoTIFF
> </description>
> <name>
> cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </lonLatEnvelope>
> <keywords>
> <keyword>
> WCS
> </keyword>
> <keyword>
> GeoTIFF
> </keyword>
> </keywords>
> <domainSet>
> <spatialDomain>
> <Envelope srsName="EPSG:4326">
> <pos>
> -58 -11
> </pos>
> <pos>
> -57.75 -10.75
> </pos>
> </Envelope>
> <RectifiedGrid dimension="2" srsName="EPSG:4326">
> <limits>
> <GridEnvelope>
> <low>
> 0 0
> </low>
> <high>
> 0 0
> </high>
> </GridEnvelope>
> </limits>
> <axisName>
> x
> </axisName>
> <axisName>
> y
> </axisName>
> <origin>
> <pos>
> -58 -10.75
> </pos>
> </origin>
> <offsetVector>
> 0.005364603321609328 0.0
> </offsetVector>
> <offsetVector>
> 0.0 -0.004532028600570188
> </offsetVector>
> </RectifiedGrid>
> </spatialDomain>
> </domainSet>
> <rangeSet>
> <RangeSet>
> <name>
> CBERS-4_AWFI_170_111_21052020
> </name>
> <label>
> CBERS-4_AWFI_170_111_21052020
> </label>
> <axisDescription>
> <AxisDescription>
> <name>
> Band
> </name>
> <label>
> Band
> </label>
> <values>
> <interval>
> <min>
> 1
> </min>
> <max>
> 4
> </max>
> </interval>
> </values>
> </AxisDescription>
> </axisDescription>
> </RangeSet>
> </rangeSet>
> <supportedCRSs>
> <requestResponseCRSs>
> EPSG:4326
> </requestResponseCRSs>
> </supportedCRSs>
> <supportedFormats nativeFormat="GeoTIFF">
> <formats>
> GeoTIFF
> </formats>
> <formats>
> GIF
> </formats>
> <formats>
> JPEG
> </formats>
> <formats>
> PNG
> </formats>
> <formats>
> TIFF
> </formats>
> </supportedFormats>
> <supportedInterpolations default="nearest neighbor">
> <interpolationMethod>
> nearest neighbor
> </interpolationMethod>
> <interpolationMethod>
> bilinear
> </interpolationMethod>
> <interpolationMethod>
> bicubic
> </interpolationMethod>
> </supportedInterpolations>
> </CoverageOffering>
> <PreferredFormat>
> GeoTIFF
> </PreferredFormat>
> <BandCount>
> 4
> </BandCount>
> <BandType>
> Byte
> </BandType>
> </WCS_GDAL>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html


------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev

------------------------------

End of gdal-dev Digest, Vol 198, Issue 14
*****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201111/dbefba9b/attachment-0001.html>

From ari.jolma at gmail.com  Wed Nov 11 21:51:37 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Thu, 12 Nov 2020 07:51:37 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
In-Reply-To: <77b40009b5f046418ab7a464b50f8504@maanmittauslaitos.fi>
References: <77b40009b5f046418ab7a464b50f8504@maanmittauslaitos.fi>
Message-ID: <698802d1-4c34-aae9-c5db-21578ed2eacc@gmail.com>

It's already some time I worked with the WCS driver and then most of the 
time went into wondering the small differences between servers.

With https://demo.geo-solutions.it/geoserver/wcs I can do this workflow:

1) gdalinfo "WCS:https://demo.geo-solutions.it/geoserver/wcs"

..takes some time as it makes calls and then it stores into 
$HOME/.gdal/wcs_cache/
(note the version added to the URL)

- an entry into db: 
KfSWH=https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1
- two files: KfSWH.xml and KfSWH.aux.xml, the first is the capabilities 
XML, the 2nd is GDAL aux XML

and prints gdalinfo output, which contains for example the subdatasets.
You'll get the same output, but faster, if you issue the above command again

 From the subdataset list I can now pick one coverage.

2) gdalinfo 
"WCS:https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample"

.. takes again some time as it makes calls and then it stores new data 
into the cache

- 
cJLrY=https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
- three files: cJLrY.xml, cJLrY.xml.aux.xml, cJLrY.DC.xml, the first is 
the WCS_GDAL XML

and prints

ERROR 1: HTTP error code : 404
ERROR 1: InvalidSubsetting: Empty intersection after subsetting

so it probably needs some special switches, which are described in the 
documentation.

Best,

Ari

Rahkonen Jukka (MML) kirjoitti 11.11.2020 klo 23.55:
>
> Hi,
>
> Sorry, this is something that I am not familiar with. The developer of 
> the WCS plugin probably could tell if it is at all supported to use 
> the XML file as input like you tried. I wonder if Ari Jolma happens to 
> follow the list. And what QGIS does is all mystery for me.
>
> -Jukka Rahkonen-
>
> *Lähettäjä:* 1520 gis <juliermeopensourcedeveloper at gmail.com>
> *Lähetetty:* keskiviikko 11. marraskuuta 2020 16.55
> *Vastaanottaja:* Rahkonen Jukka (MML) 
> <jukka.rahkonen at maanmittauslaitos.fi>
> *Aihe:* Re: gdal-dev Digest, Vol 198, Issue 14
>
> Dear Jukka Rahkonen,
>
> Thank you very much for your patience, time, and detailed information 
> given to my questions. I appreciated it all.
>
> In your discussion in [1], I could get the a xml sample [2].
>
> In [3], you will get the whole image available in geoserver. And in 
> [4], You will get the Image [3] subset.
>
> My goal is to load [3] e [4], mainly [4] subset in QGIS, by adding a 
> XML raster. It is important to mention that I am not interested in 
> accessing the raster data through a WCS connection, I am 
> actually adding a xml as a raster (Ctrl + Shift + R).
>
> If you save the xml file in [2] or [5] and add to QGIS as raster data 
> (Ctrl + Shift + R), you will get the image.
>
> Now, the xml you find in [5] was created by just changing the tag 
> values according  to your discussion in [1]. I could not find through 
> gdal documentation how to generate this xml using gdal_translate. 
> GDAL_WMTS driver stunningly does the job. See 
> //gdal_translate"WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"wmts*.*xml*-*ofWMTS.
>
> My need is to create a xml for [4] just like the one available in [5]. 
> I need to access the image in [4] subset using GDAL_WCS.
>
> The command line in [6] creates a tiff image, but I am looking for the 
> xml that when loaded to QGIS ingest the WCS service and loads the image.
>
> I wonder If there is a xml tag to the subset available in [4]. Or if 
> there is a command line for gdal_translate that can generate XML in 3, 
> and most importantly, generate a xml for the subset in [4], similar to 
> gda GDAL_WMTS driver shown above.
>
> Sorry for the long e-mail.  I have no words to thank you for your help 
> and consideration of my messages.
>
> Kinds Regards
>
> Julierme
>
> [1] 
> https://geoserver-users.narkive.com/2FVEaNlm/define-geoserver-bounding-box-using-gdal-s-wcs-driver
>
> [2] XML Sample
>
> <WCS_GDAL>
>   
> <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;</ServiceURL>
>   <CoverageName>nurc:mosaic</CoverageName>
> <GetCoverageExtra>&amp;BoundingBox=6.346,36.492,20.83,46.591</GetCoverageExtra>
> </WCS_GDAL>
>
> [3]https://demo.geo-solutions.it/geoserver/wcs?Service=WCS
>
> &version=2.0.1
>
> &bbox=-130.85168,20.7052,-62.0054,54.1141
>
> &request=GetCoverage
>
> &coverageId=nurc:Img_Sample
>
> &format=image/png
>
> [4] https://demo.geo-solutions.it/geoserver/wcs?service=WCS 
> <https://demo.geo-solutions.it/geoserver/wcs?service=WCS>
>
> &version=2.0.1
> &request=GetCoverage
> &SubsettingCRS=EPSG:4326
> &coverageId=nurc:Img_Sample
> &SUBSET=Long(-100,-80)&SUBSET=Lat(30,40)
> &format=image/png
>
> [5] <WCS_GDAL>
>
>   
> <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;</ServiceURL>
>   <CoverageName>nurc:Img_Sample</CoverageName>
> <GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
> </WCS_GDAL>
>
> [6] gdal_translate -oo CACHE=wcs_cache -oo CLEAR_CACHE -oo 
> INTERLEAVE=PIXEL -projwin 377418 6683393.87938218 377717.879386966 
> 6683094 -oo Subset="time(1985-01-01T00:00:00.000Z)" -outsize 60 0 
> "WCS:https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva" 
> scaled.tiff
>
> On Tue, Nov 10, 2020 at 1:23 PM Rahkonen Jukka (MML) 
> <jukka.rahkonen at maanmittauslaitos.fi 
> <mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
>
>     Hi,
>
>     Sending mail just to you because this is not a proper answer but
>     rather some first-aid. Normally we keep the discussion on the list
>     to other users can help, and get help by the same.
>
>     Sorry, -spat is for ogr2ogr, in gdal_translate it is -projwin.
>     Give the bbox coordinates as in the help:
>
>            [-projwin ulx uly lrx lry]
>
>     upper left x upper left y lower right x lower right y
>
>     Hope that you get it to work but I may look at this deeper when I
>     have better time for that.
>
>     First step is to create the XML file. Then test is with gdalinfo,
>     when it reports something that makes sense you can continue with
>     gdal_translate and all the standard options that it has.
>
>     WCS 2.0 is pretty easy to use also with plain hand written http
>     requests, read the standard for learning. I would forget older
>     versions.
>
>     Test URL for you
>     https://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&CoverageId=nurc__mosaic&subset=Long(8.0,8.1)&subset=Lat(38,38.1)&format=tiff
>
>     Unfortunately the server was down earlier today, I hope it works now.
>
>     -Jukka-
>
>     *Lähettäjä:* 1520 gis <juliermeopensourcedeveloper at gmail.com
>     <mailto:juliermeopensourcedeveloper at gmail.com>>
>     *Lähetetty:* tiistai 10. marraskuuta 2020 18.10
>     *Vastaanottaja:* gdal-dev at lists.osgeo.org
>     <mailto:gdal-dev at lists.osgeo.org>; Rahkonen Jukka (MML)
>     <jukka.rahkonen at maanmittauslaitos.fi
>     <mailto:jukka.rahkonen at maanmittauslaitos.fi>>
>     *Aihe:* Re: gdal-dev Digest, Vol 198, Issue 14
>
>     Dear Jukka Rahkonen,
>
>     Thank you very much for your reply.
>
>     First of all, my apologies for my lack of knowledge about using
>     GDAL_WCS driver. Let me give more details about the issues I am
>     facing.
>
>     Extract of
>     http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities
>     is shown in [1].
>
>     Regarding gdal_translate GDAL_WCS driver Image subset extract,
>     looking at https://gdal.org/drivers/raster/wcs.html#examples, I
>     tried the following:
>
>     Similar to GDAL_WMTS
>     <gdal_translate"WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"wmts*.*xml*-*ofWMTS>,
>
>     I tried running:
>
>     (1)
>
>      gdal_translate
>     "WCS:http://172.21.14.45:8181/geoserver/wcs?version=2.0.1&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
>     CBERS-4_AWFI_170_111_21052020.xml
>
>     *The response:* I did not get the xml as wmts.xml showed above
>
>     Note: Including the -of option (WCS), the outcome fails
>
>     (2)
>
>     gdal_translate
>     "WCS:http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
>     \
>     -spat -58 -11 -57.75 -10.7 \
>     CBERS-4_AWFI_170_111_21052020.xml
>
>     *The response:* There is no -spat option for gdal_translate
>
>     *gdal_translate --help*
>
>     Usage: gdal_translate [--help-general] [--long-usage]
>            [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>                  CInt16/CInt32/CFloat32/CFloat64}] [-strict]
>            [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
>            [-outsize xsize[%]|0 ysize[%]|0] [-tr xres yres]
>            [-r {nearest,bilinear,cubic,cubicspline,lanczos,average,mode}]
>            [-unscale] [-scale[_bn] [src_min src_max [dst_min
>     dst_max]]]* [-exponent[_bn] exp_val]*
>            [-srcwin xoff yoff xsize ysize] [-epo] [-eco]
>            [-projwin ulx uly lrx lry] [-projwin_srs srs_def]
>            [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
>            [-a_scale value] [-a_offset value]
>            [-nogcp] [-gcp pixel line easting northing [elevation]]*
>            |-colorinterp{_bn} {red|green|blue|alpha|gray|undefined}]
>            |-colorinterp {red|green|blue|alpha|gray|undefined},...]
>            [-mo "META-TAG=VALUE"]* [-q] [-sds]
>            [-co "NAME=VALUE"]* [-stats] [-norat]
>            [-oo NAME=VALUE]*
>            src_dataset dst_dataset
>
>     [1] WCS GetCapabilities request
>
>     <wcs:CoverageSummary>
>
>     <ows:Title>CBERS-4_AWFI_170_111_21052020</ows:Title>
>
>     <ows:Abstract>Generated from GeoTIFF</ows:Abstract>
>
>     <ows:Keywords>
>
>     <ows:Keyword>deter-amazonia-CBERS-4_AWFI_170_111_21052020</ows:Keyword>
>
>     <ows:Keyword>WCS</ows:Keyword>
>
>     <ows:Keyword>GeoTIFF</ows:Keyword>
>
>     </ows:Keywords>
>
>     <wcs:CoverageId>deter-amazonia__CBERS-4_AWFI_170_111_21052020</wcs:CoverageId>
>
>     <wcs:CoverageSubtype>RectifiedGridCoverage</wcs:CoverageSubtype>
>
>     <ows:WGS84BoundingBox>
>
>     <ows:LowerCorner>-63.280290728152664
>     -13.794296142085976</ows:LowerCorner>
>
>     <ows:UpperCorner>-53.624004749255874
>     -5.636644661059637</ows:UpperCorner>
>
>     </ows:WGS84BoundingBox>
>
>     <ows:BoundingBox crs="http://www.opengis.net/def/crs/EPSG/0/EPSG:4326">
>
>     <ows:LowerCorner>-63.280290728152664
>     -13.794296142085976</ows:LowerCorner>
>
>     <ows:UpperCorner>-53.624004749255874
>     -5.636644661059637</ows:UpperCorner>
>
>     </ows:BoundingBox>
>
>     </wcs:CoverageSummary>
>
>     Any comment will be very appreciated.
>
>     GDAL website <https://gdal.org/drivers/raster/wmts.html> provides
>     examples on how to run GDAL_WMTS driver in order to get a wmts xml
>     file. I have looked in https://gdal.org/drivers/raster/wcs.html
>     and could not find an example pointing to -spat option.  I got an
>     -spat option
>
>     togdal_grid
>     <https://gdal.org/programs/gdal_grid.html?highlight=spat#cmdoption-gdal_grid-spat>
>     though.
>
>     gdal_translate
>     "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"wmts*.*xml
>     *-*of WMTS
>
>     gdal_translate
>     "WCS:http://www.dpi.inpe.br/fipcerrado-geoserver/ows/wcs?request=GetCapabilities"
>     \
>
>     -oo CoverageName=deter-cerrado:CBERS-4_AWFI_161_099_13072018
>     CBERS-4_AWFI_161_099_13072018.xml -of WCS
>
>     On Mon, Nov 9, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org
>     <mailto:gdal-dev-request at lists.osgeo.org>> wrote:
>
>         Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>
>         To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>         or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>         <mailto:gdal-dev-request at lists.osgeo.org>
>
>         You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>         <mailto:gdal-dev-owner at lists.osgeo.org>
>
>         When replying, please edit your Subject line so it is more
>         specific
>         than "Re: Contents of gdal-dev digest..."
>
>
>         Today's Topics:
>
>            1. Re: Selecting just the geometry column with OGR SQL
>         (Even Rouault)
>            2. Re: Selecting just the geometry column with OGR SQL
>               (Rahkonen Jukka (MML))
>            3. Re: WCS_GDAL Driver Image SubSet Request (jratike80)
>
>
>         ----------------------------------------------------------------------
>
>         Message: 1
>         Date: Mon, 09 Nov 2020 16:09:45 +0100
>         From: Even Rouault <even.rouault at spatialys.com
>         <mailto:even.rouault at spatialys.com>>
>         To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>         Cc: "Rahkonen Jukka (MML)"
>         <jukka.rahkonen at maanmittauslaitos.fi
>         <mailto:jukka.rahkonen at maanmittauslaitos.fi>>
>         Subject: Re: [gdal-dev] Selecting just the geometry column
>         with OGR
>                 SQL
>         Message-ID: <1659214.2tRo4lr4Oo at even-i700
>         <mailto:1659214.2tRo4lr4Oo at even-i700>>
>         Content-Type: text/plain; charset="us-ascii"
>
>         Jukka,
>
>         > I believe that OGR SQL dialect adds the geometry column into
>         SQL selection
>         > by default. Am I right with this? I volunteer to edit the
>         documentation
>         > https://gdal.org/user/ogr_sql_dialect.html if this is the
>         case. But what I
>         > can't understand is another side of the story, how to select
>         just the
>         > geometry field with OGR SQL dialect from some data sources.
>         >
>         > This command returns both time column and geometry from GML
>         > ogrinfo -sql "select time from timetest" timetest.gml
>         > I can select just the geometry from geometry column named as
>         > "geometryProperty" by ogrinfo -sql "select geometryProperty
>         from timetest"
>         > timetest.gml
>         >
>         > The behavior is the same with SpatiaLite when I use
>         "-dialect OGRSQL".
>         > Geometry is selected automatically but it can be selected
>         also by name. But
>         > I cannot discover any way to select just the geometry field
>         from shapefile.
>         > Is it because geometry column in shapefile does not have any
>         name as this
>         > Python test seems to prove?
>         > >>> from osgeo import ogr
>         > >>> shp_ds = ogr.Open('timetest.shp')
>         > >>> shp_lyr = shp_ds.GetLayer(0)
>         > >>> shp_lyr.GetGeometryColumn()
>         >
>         > ''
>         >
>         > OpenJUMP JML driver does not report a name for geometry
>         column either. Is it
>         > rather an exception that drivers give names for the geometry
>         columns? I
>         > know I can select only the geometry column with the SQLite
>         dialect, but I
>         > am curious.
>
>         Indeed, in OGR SQL, if the geometry column has a non-empty
>         name (typically for
>         database drivers), you can use it to select it. When the
>         geometry column name
>         is empty, such as in the shapefile or OpenJUMP driver, you can
>         use
>         _ogr_geometry_ (with leading and trainling underscore) to
>         select it. This is
>         likely undocumented.
>
>         As far as I can see, this was introduced per
>         https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
>         to fix an issue with comparison with empty string literals
>         (this was before
>         OGR enforced the difference between single-quoted string
>         literals and double-
>         quoted identifiers)
>
>         Even
>
>         -- 
>         Spatialys - Geospatial professional services
>         http://www.spatialys.com
>
>
>         ------------------------------
>
>         Message: 2
>         Date: Mon, 9 Nov 2020 15:35:11 +0000
>         From: "Rahkonen Jukka (MML)"
>         <jukka.rahkonen at maanmittauslaitos.fi
>         <mailto:jukka.rahkonen at maanmittauslaitos.fi>>
>         To: Even Rouault <even.rouault at spatialys.com
>         <mailto:even.rouault at spatialys.com>>,
>                 "gdal-dev at lists.osgeo.org
>         <mailto:gdal-dev at lists.osgeo.org>" <gdal-dev at lists.osgeo.org
>         <mailto:gdal-dev at lists.osgeo.org>>
>         Subject: Re: [gdal-dev] Selecting just the geometry column
>         with OGR
>                 SQL
>         Message-ID:
>         <d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi
>         <mailto:d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi>>
>         Content-Type: text/plain; charset="us-ascii"
>
>         Even Rouault wrote:
>         maanantai 9. marraskuuta 2020 17.10
>
>         > Jukka,
>
>         >> I believe that OGR SQL dialect adds the geometry column
>         into SQL
>         >> selection by default. Am I right with this? I volunteer to
>         edit the
>         >> documentation https://gdal.org/user/ogr_sql_dialect.html
>         <https://gdal.org/user/ogr_sql_dialect.html> if this is
>         >> the case. But what I can't understand is another side of
>         the story,
>         >> how to select just the geometry field with OGR SQL dialect
>         from some data sources.
>         >>
>         >> This command returns both time column and geometry from GML
>         ogrinfo
>         >> -sql "select time from timetest" timetest.gml I can select
>         just the
>         >> geometry from geometry column named as "geometryProperty"
>         by ogrinfo
>         >> -sql "select geometryProperty from timetest"
>         >> timetest.gml
>         >>
>         >> The behavior is the same with SpatiaLite when I use
>         "-dialect OGRSQL".
>         >> Geometry is selected automatically but it can be selected
>         also by
>         >> name. But I cannot discover any way to select just the
>         geometry field from shapefile.
>         >> Is it because geometry column in shapefile does not have
>         any name as
>         >> this Python test seems to prove?
>         >> >>> from osgeo import ogr
>         >> >>> shp_ds = ogr.Open('timetest.shp')
>         >> >>> shp_lyr = shp_ds.GetLayer(0)
>         >> >>> shp_lyr.GetGeometryColumn()
>         >>
>         >> ''
>         >>
>         >> OpenJUMP JML driver does not report a name for geometry
>         column either.
>         >> Is it rather an exception that drivers give names for the
>         geometry
>         >> columns? I know I can select only the geometry column with
>         the SQLite
>         >> dialect, but I am curious.
>
>         > Indeed, in OGR SQL, if the geometry column has a nonempty
>         name (typically for
>         > database drivers), you can use it to select it. When the
>         geometry column name
>         > is empty, such as in the shapefile or OpenJUMP driver, you
>         can use
>         > _ogr_geometry_ (with leading and trainling underscore) to
>         select it. This is likely undocumented.
>
>         > As far as I can see, this was introduced per
>         >
>         https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
>         > to fix an issue with comparison with empty string literals
>         (this was before OGR enforced the
>         >  difference between single-quoted string literals and
>         double- quoted identifiers)
>
>         I could not manage to guess the right syntax for Windows right
>         ahead but solved the quiz easily
>         with your double-quote hint
>
>         First trial:
>         ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
>         INFO: Open of `timetest.shp'
>               using driver `ESRI Shapefile' successful.
>         ERROR 1: SQL Expression Parsing Error: syntax error,
>         unexpected $undefined. Occurred around :
>         select _ogr_geometry_ from timetest
>
>         Second trial:
>         ogrinfo -sql "select \"_ogr_geometry_\" from timetest"
>         timetest.shp
>
>         -Jukka-
>
>         > Even
>
>         --
>         Spatialys - Geospatial professional services
>         http://www.spatialys.com <http://www.spatialys.com>
>
>
>         ------------------------------
>
>         Message: 3
>         Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
>         From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi
>         <mailto:jukka.rahkonen at maanmittauslaitos.fi>>
>         To: gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>         Subject: Re: [gdal-dev] WCS_GDAL Driver Image SubSet Request
>         Message-ID: <1604936825138-0.post at n6.nabble.com
>         <mailto:1604936825138-0.post at n6.nabble.com>>
>         Content-Type: text/plain; charset=us-ascii
>
>         Hi,
>
>         Do you want to make is somehow impossible to request data
>         beyound the
>         BoundingBox that you defined in the XML file? If you just want
>         to get data
>         from the rectangle that you or your users define,
>         gdal_translate with the
>         regular -spat option should work out-of-the-box.
>
>         -Jukka Rahkonen-
>
>
>         juliermeopensourcedeveloper wrote
>         > Hi all,
>         >
>         > Is it possible to define a bounding box in order to request
>         a coverage
>         > subset using the GDAL WCS Driver?
>         > I have tried the code in [1]. I  am trying to get
>         information only for the
>         > bbox_interest=( -58,-11,-57.75,-10.75) as shown below,
>         however the subset
>         > image or bbox_interest request has not been delivered. The
>         West Longitude
>         > reaches -50.17 and The Lower Latitude reaches -18.92 which
>         are limits out
>         > of the bbox_interest.
>         > The image extent is:
>         > <GetCoverageExtra>
>         >
>         &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
>         > </GetCoverageExtra>
>         >  Any comment on this issue will be greatly appreciated.
>         > Thank you very much for your time in advance.
>         > *CODE [1]:*
>         > <WCS_GDAL>
>         > <ServiceURL>
>         > http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
>         > </
>         > ServiceURL>
>         > <CoverageName>
>         > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
>         > </
>         > CoverageName>
>         > <GetCoverageExtra>
>         > &amp;BoundingBox=-58,-11,-57.75,-10.75
>         > </GetCoverageExtra>
>         > <CoverageOffering>
>         > <description>
>         > Generated from GeoTIFF
>         > </description>
>         > <name>
>         > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
>         > </name>
>         > <label>
>         > CBERS-4_AWFI_170_111_21052020
>         > </label>
>         > <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
>         > <pos>
>         > -58 -11
>         > </pos>
>         > <pos>
>         > -57.75 -10.75
>         > </pos>
>         > </lonLatEnvelope>
>         > <keywords>
>         > <keyword>
>         > WCS
>         > </keyword>
>         > <keyword>
>         > GeoTIFF
>         > </keyword>
>         > </keywords>
>         > <domainSet>
>         > <spatialDomain>
>         > <Envelope srsName="EPSG:4326">
>         > <pos>
>         > -58 -11
>         > </pos>
>         > <pos>
>         > -57.75 -10.75
>         > </pos>
>         > </Envelope>
>         > <RectifiedGrid dimension="2" srsName="EPSG:4326">
>         > <limits>
>         > <GridEnvelope>
>         > <low>
>         > 0 0
>         > </low>
>         > <high>
>         > 0 0
>         > </high>
>         > </GridEnvelope>
>         > </limits>
>         > <axisName>
>         > x
>         > </axisName>
>         > <axisName>
>         > y
>         > </axisName>
>         > <origin>
>         > <pos>
>         > -58 -10.75
>         > </pos>
>         > </origin>
>         > <offsetVector>
>         > 0.005364603321609328 0.0
>         > </offsetVector>
>         > <offsetVector>
>         > 0.0 -0.004532028600570188
>         > </offsetVector>
>         > </RectifiedGrid>
>         > </spatialDomain>
>         > </domainSet>
>         > <rangeSet>
>         > <RangeSet>
>         > <name>
>         > CBERS-4_AWFI_170_111_21052020
>         > </name>
>         > <label>
>         > CBERS-4_AWFI_170_111_21052020
>         > </label>
>         > <axisDescription>
>         > <AxisDescription>
>         > <name>
>         > Band
>         > </name>
>         > <label>
>         > Band
>         > </label>
>         > <values>
>         > <interval>
>         > <min>
>         > 1
>         > </min>
>         > <max>
>         > 4
>         > </max>
>         > </interval>
>         > </values>
>         > </AxisDescription>
>         > </axisDescription>
>         > </RangeSet>
>         > </rangeSet>
>         > <supportedCRSs>
>         > <requestResponseCRSs>
>         > EPSG:4326
>         > </requestResponseCRSs>
>         > </supportedCRSs>
>         > <supportedFormats nativeFormat="GeoTIFF">
>         > <formats>
>         > GeoTIFF
>         > </formats>
>         > <formats>
>         > GIF
>         > </formats>
>         > <formats>
>         > JPEG
>         > </formats>
>         > <formats>
>         > PNG
>         > </formats>
>         > <formats>
>         > TIFF
>         > </formats>
>         > </supportedFormats>
>         > <supportedInterpolations default="nearest neighbor">
>         > <interpolationMethod>
>         > nearest neighbor
>         > </interpolationMethod>
>         > <interpolationMethod>
>         > bilinear
>         > </interpolationMethod>
>         > <interpolationMethod>
>         > bicubic
>         > </interpolationMethod>
>         > </supportedInterpolations>
>         > </CoverageOffering>
>         > <PreferredFormat>
>         > GeoTIFF
>         > </PreferredFormat>
>         > <BandCount>
>         > 4
>         > </BandCount>
>         > <BandType>
>         > Byte
>         > </BandType>
>         > </WCS_GDAL>
>         > _______________________________________________
>         > gdal-dev mailing list
>
>         > gdal-dev at .osgeo <mailto:gdal-dev at .osgeo>
>
>         > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
>         --
>         Sent from:
>         http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
>         ------------------------------
>
>         Subject: Digest Footer
>
>         _______________________________________________
>         gdal-dev mailing list
>         gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>         ------------------------------
>
>         End of gdal-dev Digest, Vol 198, Issue 14
>         *****************************************
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201112/efb4eed8/attachment-0001.html>

From evert.etienne at sitemark.com  Thu Nov 12 00:02:41 2020
From: evert.etienne at sitemark.com (Evert Etienne (SITEMARK))
Date: Thu, 12 Nov 2020 08:02:41 +0000
Subject: [gdal-dev] Location change on gdalwarp reprojection
In-Reply-To: <1605130726567-0.post@n6.nabble.com>
References: <305A3A72-3325-478A-9390-1146A8631DFD@sitemark.com>
 <FA793503-33FD-4C8C-838A-C239726D0321@sitemark.com>
 <1605130726567-0.post@n6.nabble.com>
Message-ID: <9E3110F1-3AD8-40BC-94F5-E9CDB51B63E1@sitemark.com>

Hi

Thanks for your response Jukka!

Your first explanation about the bounds make sense, but shouldn’t they still be in the same area (overlapping)?

When specifying the source epsg as EPSG:27573, there is indeed no changes anymore as visible in the following logs:
(Am I correct for thinking this is actually just equivalent to overwriting the CRS included in the tif?)

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255]
gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif from_27573_into_27573.tif
from_27573_into_27573.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945, 44.103402376252255]
```

So you’re suggesting the included CRS in orig.tif does not match EPSG:27573 perfectly then? Would this be a mismatch in the WKT string then?

I am still a bit lost how this would cause that in QGIS the orig.tif and repro.tif show up in a totally different location where orig.tif is where I would expect it to be.
And as well why rasterio reads the CRS as being EPSG:27573 (see logs), but that might be a separate issue?

Many thanks

On 11 Nov 2020, at 22:38, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

Hi,

The bounds do not mean exactly what you think. Re-projecting a rectangular
image from EPSG:27573 into EPSG:4326 rotates the image somewhat
counter-clockwise. This image is from another context
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.usgs.gov%2Fmedia%2Fimages%2Flandsat-1-8-landsatlook-image-examples&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=IIj2gHAu18%2Fd%2F%2BJyxHQxutxFg%2F0cqzNwSgIhNkEyNF8%3D&amp;reserved=0 but
you can get the idea. The new bounds report the min-max coordinates of the
envelope that contains that rotated image. The corners of the original image
are not at the corners of the warped image. That explains why WGS 84 bounds
in EPSG:3857 are different.

The difference when you warp to EPSG:27573  may mean that the coordinate
system of the original image is not EPSG:27573, at least not for the Proj
library. What happens with command:

gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif
from_27573_into_27573.tif

-Jukka Rahkonen-




Evert Etienne (SITEMARK) wrote
It does not happen when just warping, but it does occur when warping to
the same EPSG as can be seen in the follow logs
```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942,
44.103402376252255] <----- OK
gdalwarp orig.tif justwarp.tif
justwarp.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945,
44.103402376252255] <----- SAME
gdalwarp -t_srs EPSG:27573 orig.tif noreproj.tif
noreproj.tif
EPSG:27573
bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361,
3749294.6346238866]
EPSG:27573 bounds [829527.7905651039, 3748136.6066527413,
830468.8074871361, 3749294.6346238866]
EPSG:3857 bounds [608015.3560148155, 6272484.6841915725,
609507.2374494626, 6274297.96416575]
EPSG:4326 bounds [5.461894872874811, 48.98599094207838, 5.475296671823179,
48.99667932763942] <----- CHANGED
```

GDAL info of orig.tif:
```
Driver: GTiff/GeoTIFF
Files: orig.tif
Size is 18676, 23014
Coordinate System is:
PROJCRS["NTF (Paris) / Lambert zone III",
   BASEGEOGCRS["NTF (Paris)",
       DATUM["Nouvelle Triangulation Francaise (Paris)",
           ELLIPSOID["Clarke 1880 (IGN)",6378249.2,293.466021293627,
               LENGTHUNIT["metre",1]]],
       PRIMEM["Paris",2.5969213,
           ANGLEUNIT["grad",0.0157079632679489]],
       ID["EPSG",4807]],
   CONVERSION["unnamed",
       METHOD["Lambert Conic Conformal (1SP)",
           ID["EPSG",9801]],
       PARAMETER["Latitude of natural origin",54.4444444444445,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8801]],
       PARAMETER["Longitude of natural origin",0,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8802]],
       PARAMETER["Scale factor at natural origin",0.999877499,
           SCALEUNIT["unity",1],
           ID["EPSG",8805]],
       PARAMETER["False easting",600000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8806]],
       PARAMETER["False northing",3200000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8807]]],
   CS[Cartesian,2],
       AXIS["easting",east,
           ORDER[1],
           LENGTHUNIT["metre",1]],
       AXIS["northing",north,
           ORDER[2],
           LENGTHUNIT["metre",1]],
   ID["EPSG",27573]]
Data axis to CRS axis mapping: 1,2
Origin = (828662.071093128062785,3204344.670086107682437)
Pixel Size = (0.050000000000002,-0.050000000000008)
Metadata:
 AREA_OR_POINT=Area
Image Structure Metadata:
 COMPRESSION=LZW
 INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  828662.071, 3204344.670) (  3d 7'33.28"E, 48d59'48.23"N)
Lower Left  (  828662.071, 3203193.970) (  3d 7'30.95"E, 48d59'11.01"N)
Upper Right (  829595.871, 3204344.670) (  3d 8'19.19"E, 48d59'46.98"N)
Lower Right (  829595.871, 3203193.970) (  3d 8'16.85"E, 48d59' 9.76"N)
Center      (  829128.971, 3203769.320) (  3d 7'55.07"E, 48d59'28.99"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Unit Type: metre
```

On 11 Nov 2020, at 20:32, Evert Etienne (SITEMARK) &lt;

evert.etienne@

&gt; wrote:


Hey all,

I have some behaviour that I can’t wrap my head around. When I reproject
a tif using gdalwarp, the location (as visible in QGIS or after using
gdal2tiles on a map) changes. It is visible when checking the bounds
using QGIS.
It is also noticeable when checking the bounds with rasterio:

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716,
579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886,
5.205019115521942, 44.103402376252255] <----- 1
gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
repro.tif
EPSG:3857
bounds [608015.5294828439, 6272484.913981743, 609507.0864301398,
6274297.75045133]
EPSG:27573 bounds [829484.0038619096, 3748101.0103735547,
830512.7970793804, 3749330.248761157]
EPSG:3857 bounds [608015.5294828439, 6272484.913981743,
609507.0864301398, 6274297.75045133]
EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526,
48.99667806803407]  <----- 2
gdalwarp -t_srs EPSG:27573 repro.tif back.tif
back.tif
EPSG:27573
bounds [829484.0038619096, 3748101.034601565, 830512.7912119445,
3749330.2487611575]
EPSG:27573 bounds [829484.0038619096, 3748101.034601565,
830512.7912119445, 3749330.2487611575]
EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724,
6274354.58877996]
EPSG:4326 bounds [5.461280848150926, 48.98565744919683,
5.475913594925499, 48.99701306471833]  <----- 3
```

The accompanying python code is three times like the following
```
input_file = folder + 'orig.tif'
img = rasterio.open(input_file)
print('orig.tif')
print(img.crs)
print('bounds', list(warp.transform_bounds(img.crs, img.crs,
*img.bounds)))
print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs,
'EPSG:27573', *img.bounds)))
print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857',
*img.bounds)))
print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs,
'EPSG:4326', *img.bounds)))
```

As the arrows show, the bounds change between 1 and 2 (this is the
unexpected behaviour for me). Yet they don’t change when projecting back.

I am unsure if this is a bug in GDAL, something weird with this specific
EPSG or the source tif. Any further steps for investigation or ideas
would be very welcome

Many thanks

Evert
_______________________________________________
gdal-dev mailing list


gdal-dev at .osgeo

https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0

_______________________________________________
gdal-dev mailing list

gdal-dev at .osgeo

https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0





--
Sent from: https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fosgeo-org.1560.x6.nabble.com%2FGDAL-Dev-f3742093.html&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=3FP%2Fo4GIWEzFS9CUz0cjEVbT02XPgKCoTnI%2F6EC%2Bhzw%3D&amp;reserved=0
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201112/173e148d/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 12 00:39:42 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 12 Nov 2020 08:39:42 +0000
Subject: [gdal-dev] Location change on gdalwarp reprojection
Message-ID: <726a3831adf8419283d1df3e0ec79c3a@maanmittauslaitos.fi>

Hi,

Yes, envelopes should grow every time when the raster is rotated, but they should overlap. If they move like they do in your case, something seems to go wrong. I can only say that obviously Proj is seeing some difference between the projection that is stored into your GeoTIFF and what it thinks that EPSG:27573 means. By comparing the WKT text from your mail with the printout of “projinfo epsg:27573” (with Proj version 6.3.2) I can see these differences:

Image
--------
CONVERSION["unnamed",
PARAMETER["Latitude of natural origin",54.4444444444445,

Proj
-----
CONVERSION["Lambert zone III",
PARAMETER["Latitude of natural origin",49,

Experts on the French coordinate systems and Proj may continue from this, I fear I can’t help more than this. And you are right that using “-s_srs” in gdalwarp overrides the projection that is stored into GeoTIFF tags. If the result is good you can use that as a workaround. It is also possible to update the geotiff tags with “gdal_edit -a_srs epsg:27573” but before that you should be sure that it is the right thing to do.

-Jukka Rahkonen-

Lähettäjä: Evert Etienne (SITEMARK) <evert.etienne at sitemark.com>
Lähetetty: torstai 12. marraskuuta 2020 10.00
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: [gdal-dev] Location change on gdalwarp reprojection

Hi

Thanks for your response Jukka!

Your first explanation about the bounds make sense, but shouldn’t they still be in the same area (overlapping)?

When specifying the source epsg as EPSG:27573, there is indeed no changes anymore as visible in the following logs:
(Am I correct for thinking this is actually just equivalent to overwriting the CRS included in the tif?)

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255]
gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif from_27573_into_27573.tif
from_27573_into_27573.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945, 44.103402376252255]
```

So you’re suggesting the included CRS in orig.tif does not match EPSG:27573 perfectly then? Would this be a mismatch in the WKT string then?


I am still a bit lost how this would cause that in QGIS the orig.tif and repro.tif show up in a totally different location where orig.tif is where I would expect it to be.
And as well why rasterio reads the CRS as being EPSG:27573 (see logs), but that might be a separate issue?


Many thanks



On 11 Nov 2020, at 22:38, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

Hi,

The bounds do not mean exactly what you think. Re-projecting a rectangular
image from EPSG:27573 into EPSG:4326 rotates the image somewhat
counter-clockwise. This image is from another context
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.usgs.gov%2Fmedia%2Fimages%2Flandsat-1-8-landsatlook-image-examples&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=IIj2gHAu18%2Fd%2F%2BJyxHQxutxFg%2F0cqzNwSgIhNkEyNF8%3D&amp;reserved=0 but
you can get the idea. The new bounds report the min-max coordinates of the
envelope that contains that rotated image. The corners of the original image
are not at the corners of the warped image. That explains why WGS 84 bounds
in EPSG:3857 are different.

The difference when you warp to EPSG:27573  may mean that the coordinate
system of the original image is not EPSG:27573, at least not for the Proj
library. What happens with command:

gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif
from_27573_into_27573.tif

-Jukka Rahkonen-




Evert Etienne (SITEMARK) wrote

It does not happen when just warping, but it does occur when warping to
the same EPSG as can be seen in the follow logs
```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942,
44.103402376252255] <----- OK
gdalwarp orig.tif justwarp.tif
justwarp.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945,
44.103402376252255] <----- SAME
gdalwarp -t_srs EPSG:27573 orig.tif noreproj.tif
noreproj.tif
EPSG:27573
bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361,
3749294.6346238866]
EPSG:27573 bounds [829527.7905651039, 3748136.6066527413,
830468.8074871361, 3749294.6346238866]
EPSG:3857 bounds [608015.3560148155, 6272484.6841915725,
609507.2374494626, 6274297.96416575]
EPSG:4326 bounds [5.461894872874811, 48.98599094207838, 5.475296671823179,
48.99667932763942] <----- CHANGED
```

GDAL info of orig.tif:
```
Driver: GTiff/GeoTIFF
Files: orig.tif
Size is 18676, 23014
Coordinate System is:
PROJCRS["NTF (Paris) / Lambert zone III",
   BASEGEOGCRS["NTF (Paris)",
       DATUM["Nouvelle Triangulation Francaise (Paris)",
           ELLIPSOID["Clarke 1880 (IGN)",6378249.2,293.466021293627,
               LENGTHUNIT["metre",1]]],
       PRIMEM["Paris",2.5969213,
           ANGLEUNIT["grad",0.0157079632679489]],
       ID["EPSG",4807]],
   CONVERSION["unnamed",
       METHOD["Lambert Conic Conformal (1SP)",
           ID["EPSG",9801]],
       PARAMETER["Latitude of natural origin",54.4444444444445,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8801]],
       PARAMETER["Longitude of natural origin",0,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8802]],
       PARAMETER["Scale factor at natural origin",0.999877499,
           SCALEUNIT["unity",1],
           ID["EPSG",8805]],
       PARAMETER["False easting",600000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8806]],
       PARAMETER["False northing",3200000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8807]]],
   CS[Cartesian,2],
       AXIS["easting",east,
           ORDER[1],
           LENGTHUNIT["metre",1]],
       AXIS["northing",north,
           ORDER[2],
           LENGTHUNIT["metre",1]],
   ID["EPSG",27573]]
Data axis to CRS axis mapping: 1,2
Origin = (828662.071093128062785,3204344.670086107682437)
Pixel Size = (0.050000000000002,-0.050000000000008)
Metadata:
 AREA_OR_POINT=Area
Image Structure Metadata:
 COMPRESSION=LZW
 INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  828662.071, 3204344.670) (  3d 7'33.28"E, 48d59'48.23"N)
Lower Left  (  828662.071, 3203193.970) (  3d 7'30.95"E, 48d59'11.01"N)
Upper Right (  829595.871, 3204344.670) (  3d 8'19.19"E, 48d59'46.98"N)
Lower Right (  829595.871, 3203193.970) (  3d 8'16.85"E, 48d59' 9.76"N)
Center      (  829128.971, 3203769.320) (  3d 7'55.07"E, 48d59'28.99"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Unit Type: metre
```


On 11 Nov 2020, at 20:32, Evert Etienne (SITEMARK) &lt;


evert.etienne@


&gt; wrote:



Hey all,

I have some behaviour that I can’t wrap my head around. When I reproject
a tif using gdalwarp, the location (as visible in QGIS or after using
gdal2tiles on a map) changes. It is visible when checking the bounds
using QGIS.
It is also noticeable when checking the bounds with rasterio:

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716,
579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886,
5.205019115521942, 44.103402376252255] <----- 1
gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
repro.tif
EPSG:3857
bounds [608015.5294828439, 6272484.913981743, 609507.0864301398,
6274297.75045133]
EPSG:27573 bounds [829484.0038619096, 3748101.0103735547,
830512.7970793804, 3749330.248761157]
EPSG:3857 bounds [608015.5294828439, 6272484.913981743,
609507.0864301398, 6274297.75045133]
EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526,
48.99667806803407]  <----- 2
gdalwarp -t_srs EPSG:27573 repro.tif back.tif
back.tif
EPSG:27573
bounds [829484.0038619096, 3748101.034601565, 830512.7912119445,
3749330.2487611575]
EPSG:27573 bounds [829484.0038619096, 3748101.034601565,
830512.7912119445, 3749330.2487611575]
EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724,
6274354.58877996]
EPSG:4326 bounds [5.461280848150926, 48.98565744919683,
5.475913594925499, 48.99701306471833]  <----- 3
```

The accompanying python code is three times like the following
```
input_file = folder + 'orig.tif'
img = rasterio.open(input_file)
print('orig.tif')
print(img.crs)
print('bounds', list(warp.transform_bounds(img.crs, img.crs,
*img.bounds)))
print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs,
'EPSG:27573', *img.bounds)))
print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857',
*img.bounds)))
print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs,
'EPSG:4326', *img.bounds)))
```

As the arrows show, the bounds change between 1 and 2 (this is the
unexpected behaviour for me). Yet they don’t change when projecting back.

I am unsure if this is a bug in GDAL, something weird with this specific
EPSG or the source tif. Any further steps for investigation or ideas
would be very welcome

Many thanks

Evert
_______________________________________________
gdal-dev mailing list


gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>


https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0

_______________________________________________
gdal-dev mailing list


gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>


https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0





--
Sent from: https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fosgeo-org.1560.x6.nabble.com%2FGDAL-Dev-f3742093.html&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=3FP%2Fo4GIWEzFS9CUz0cjEVbT02XPgKCoTnI%2F6EC%2Bhzw%3D&amp;reserved=0
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201112/43b6ef96/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 12 01:16:56 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 12 Nov 2020 02:16:56 -0700 (MST)
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
In-Reply-To: <698802d1-4c34-aae9-c5db-21578ed2eacc@gmail.com>
References: <CAKTKyJK50ygcMa-15y9zbroZ7kHxYMH-Uz2WFMRTbocUSA121Q@mail.gmail.com>
 <77b40009b5f046418ab7a464b50f8504@maanmittauslaitos.fi>
 <698802d1-4c34-aae9-c5db-21578ed2eacc@gmail.com>
Message-ID: <1605172616302-0.post@n6.nabble.com>

Hi Ari,

I fear that user cannot control this with the switches. This is the reason
for the error:

```
WCS: Requesting
http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long(6.3953399152693953,6.3953399152693953)&SUBSET=Lat(46.541601968340089,46.541601968340089)&Format=image/tiff

```

Thus GDAL creates subsets with lower limit = upper limit which makes the
bbox into a point. That it probably not intentional. I think it is done with
the code that begins from
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/wcs/wcsdataset.cpp#L562

If theory interests, there has been discussions within the OGC WCS group
about the validity of such request. It may be that the server should expand
the bbox and send tiff with one pixel as an output. If the subsets were
written for slicing
SUBSET=Long(6.3953399152693953)
&SUBSET=Lat(46.541601968340089)
then tiff as outputformat is not possible because image has always  two
dimensions but here 0 dimensionality (point) is requested. But this is a
sidepath because I believe that the WCS driver wants to read a small area
from WCS as a sample, not just one pixel.

-Jukka-


Ari Jolma-2 wrote
> 2) gdalinfo 
> "WCS:https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample"
> 
> .. takes again some time as it makes calls and then it stores new data 
> into the cache
> 
> - 
> cJLrY=https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> - three files: cJLrY.xml, cJLrY.xml.aux.xml, cJLrY.DC.xml, the first is 
> the WCS_GDAL XML
> 
> and prints
> 
> ERROR 1: HTTP error code : 404
> ERROR 1: InvalidSubsetting: Empty intersection after subsetting
> 
> so it probably needs some special switches, which are described in the 
> documentation.
> 
> Best,
> 
> Ari





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From evert.etienne at sitemark.com  Thu Nov 12 02:48:21 2020
From: evert.etienne at sitemark.com (Evert Etienne (SITEMARK))
Date: Thu, 12 Nov 2020 10:48:21 +0000
Subject: [gdal-dev] Location change on gdalwarp reprojection
In-Reply-To: <726a3831adf8419283d1df3e0ec79c3a@maanmittauslaitos.fi>
References: <726a3831adf8419283d1df3e0ec79c3a@maanmittauslaitos.fi>
Message-ID: <CF97E055-B75D-4F39-BE24-356AA60CDCC4@sitemark.com>

Hi all,

Many thanks for your help Jukka, much appreciated!

What you are saying is indeed very probably the cause. When using gdal_edit, the tif indeed remains on the location I expect it to be, after reprojecting and tiling.

So this might actually also show bugs/weird behaviour in both QGIS and rasterio?
- QGIS displaying the original file on the correct location -> it probably looks at the EPSG and not the full (kinda-off) WKT string then, correct? Should this be reported?
- Rasterio reporting the EPSG as well wrongly, not sure if this is a confidence issue and if this should be reported as well?

The issue is solved for me with this workaround, but if anyone on this list believes I should raise the above points somewhere else, let me know and I can take this up.

Greetings

On 12 Nov 2020, at 09:39, Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

Hi,

Yes, envelopes should grow every time when the raster is rotated, but they should overlap. If they move like they do in your case, something seems to go wrong. I can only say that obviously Proj is seeing some difference between the projection that is stored into your GeoTIFF and what it thinks that EPSG:27573 means. By comparing the WKT text from your mail with the printout of “projinfo epsg:27573” (with Proj version 6.3.2) I can see these differences:

Image
--------
CONVERSION["unnamed",
PARAMETER["Latitude of natural origin",54.4444444444445,

Proj
-----
CONVERSION["Lambert zone III",
PARAMETER["Latitude of natural origin",49,

Experts on the French coordinate systems and Proj may continue from this, I fear I can’t help more than this. And you are right that using “-s_srs” in gdalwarp overrides the projection that is stored into GeoTIFF tags. If the result is good you can use that as a workaround. It is also possible to update the geotiff tags with “gdal_edit -a_srs epsg:27573” but before that you should be sure that it is the right thing to do.

-Jukka Rahkonen-

Lähettäjä: Evert Etienne (SITEMARK) <evert.etienne at sitemark.com<mailto:evert.etienne at sitemark.com>>
Lähetetty: torstai 12. marraskuuta 2020 10.00
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Aihe: Re: [gdal-dev] Location change on gdalwarp reprojection

Hi

Thanks for your response Jukka!

Your first explanation about the bounds make sense, but shouldn’t they still be in the same area (overlapping)?

When specifying the source epsg as EPSG:27573, there is indeed no changes anymore as visible in the following logs:
(Am I correct for thinking this is actually just equivalent to overwriting the CRS included in the tif?)

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942, 44.103402376252255]
gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif from_27573_into_27573.tif
from_27573_into_27573.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945, 44.103402376252255]
```

So you’re suggesting the included CRS in orig.tif does not match EPSG:27573 perfectly then? Would this be a mismatch in the WKT string then?


I am still a bit lost how this would cause that in QGIS the orig.tif and repro.tif show up in a totally different location where orig.tif is where I would expect it to be.
And as well why rasterio reads the CRS as being EPSG:27573 (see logs), but that might be a separate issue?


Many thanks



On 11 Nov 2020, at 22:38, jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:

Hi,

The bounds do not mean exactly what you think. Re-projecting a rectangular
image from EPSG:27573 into EPSG:4326 rotates the image somewhat
counter-clockwise. This image is from another context
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.usgs.gov%2Fmedia%2Fimages%2Flandsat-1-8-landsatlook-image-examples&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=IIj2gHAu18%2Fd%2F%2BJyxHQxutxFg%2F0cqzNwSgIhNkEyNF8%3D&amp;reserved=0<https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.usgs.gov%2Fmedia%2Fimages%2Flandsat-1-8-landsatlook-image-examples&data=04%7C01%7Cevert.etienne%40sitemark.com%7Cfeaf0ee3588b4e52d2b408d886e68280%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407671880779985%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=wLYFUkTxcVuEAQ39eI0pG4ZDMvv8%2FCFilZOrrPBGymY%3D&reserved=0> but
you can get the idea. The new bounds report the min-max coordinates of the
envelope that contains that rotated image. The corners of the original image
are not at the corners of the warped image. That explains why WGS 84 bounds
in EPSG:3857 are different.

The difference when you warp to EPSG:27573  may mean that the coordinate
system of the original image is not EPSG:27573, at least not for the Proj
library. What happens with command:

gdalwarp -s_srs EPSG:27573 -t_srs EPSG:27573 orig.tif
from_27573_into_27573.tif

-Jukka Rahkonen-




Evert Etienne (SITEMARK) wrote

It does not happen when just warping, but it does occur when warping to
the same EPSG as can be seen in the follow logs
```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521942,
44.103402376252255] <----- OK
gdalwarp orig.tif justwarp.tif
justwarp.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931282,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931282, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716, 579420.0775091586,
5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886, 5.205019115521945,
44.103402376252255] <----- SAME
gdalwarp -t_srs EPSG:27573 orig.tif noreproj.tif
noreproj.tif
EPSG:27573
bounds [829527.7905651039, 3748136.6066527413, 830468.8074871361,
3749294.6346238866]
EPSG:27573 bounds [829527.7905651039, 3748136.6066527413,
830468.8074871361, 3749294.6346238866]
EPSG:3857 bounds [608015.3560148155, 6272484.6841915725,
609507.2374494626, 6274297.96416575]
EPSG:4326 bounds [5.461894872874811, 48.98599094207838, 5.475296671823179,
48.99667932763942] <----- CHANGED
```

GDAL info of orig.tif:
```
Driver: GTiff/GeoTIFF
Files: orig.tif
Size is 18676, 23014
Coordinate System is:
PROJCRS["NTF (Paris) / Lambert zone III",
   BASEGEOGCRS["NTF (Paris)",
       DATUM["Nouvelle Triangulation Francaise (Paris)",
           ELLIPSOID["Clarke 1880 (IGN)",6378249.2,293.466021293627,
               LENGTHUNIT["metre",1]]],
       PRIMEM["Paris",2.5969213,
           ANGLEUNIT["grad",0.0157079632679489]],
       ID["EPSG",4807]],
   CONVERSION["unnamed",
       METHOD["Lambert Conic Conformal (1SP)",
           ID["EPSG",9801]],
       PARAMETER["Latitude of natural origin",54.4444444444445,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8801]],
       PARAMETER["Longitude of natural origin",0,
           ANGLEUNIT["grad",0.0157079632679489],
           ID["EPSG",8802]],
       PARAMETER["Scale factor at natural origin",0.999877499,
           SCALEUNIT["unity",1],
           ID["EPSG",8805]],
       PARAMETER["False easting",600000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8806]],
       PARAMETER["False northing",3200000,
           LENGTHUNIT["metre",1],
           ID["EPSG",8807]]],
   CS[Cartesian,2],
       AXIS["easting",east,
           ORDER[1],
           LENGTHUNIT["metre",1]],
       AXIS["northing",north,
           ORDER[2],
           LENGTHUNIT["metre",1]],
   ID["EPSG",27573]]
Data axis to CRS axis mapping: 1,2
Origin = (828662.071093128062785,3204344.670086107682437)
Pixel Size = (0.050000000000002,-0.050000000000008)
Metadata:
 AREA_OR_POINT=Area
Image Structure Metadata:
 COMPRESSION=LZW
 INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  (  828662.071, 3204344.670) (  3d 7'33.28"E, 48d59'48.23"N)
Lower Left  (  828662.071, 3203193.970) (  3d 7'30.95"E, 48d59'11.01"N)
Upper Right (  829595.871, 3204344.670) (  3d 8'19.19"E, 48d59'46.98"N)
Lower Right (  829595.871, 3203193.970) (  3d 8'16.85"E, 48d59' 9.76"N)
Center      (  829128.971, 3203769.320) (  3d 7'55.07"E, 48d59'28.99"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Mask Flags: PER_DATASET ALPHA
 Overviews of mask band: 9338x11507, 4669x5754, 2335x2877, 1168x1439,
584x720, 292x360, 146x180
 Unit Type: metre
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
 Overviews: 9338x11507, 4669x5754, 2335x2877, 1168x1439, 584x720,
292x360, 146x180
 Unit Type: metre
```


On 11 Nov 2020, at 20:32, Evert Etienne (SITEMARK) &lt;


evert.etienne@


&gt; wrote:



Hey all,

I have some behaviour that I can’t wrap my head around. When I reproject
a tif using gdalwarp, the location (as visible in QGIS or after using
gdal2tiles on a map) changes. It is visible when checking the bounds
using QGIS.
It is also noticeable when checking the bounds with rasterio:

```
orig.tif
EPSG:27573
bounds [828662.0710931281, 3203193.9700861075, 829595.8710931281,
3204344.6700861077]
EPSG:27573 bounds [828662.0710931281, 3203193.9700861075,
829595.8710931281, 3204344.6700861077]
EPSG:3857 bounds [578066.9358574335, 5479808.142856716,
579420.0775091586, 5481457.907968456]
EPSG:4326 bounds [5.192863637248721, 44.09275933293886,
5.205019115521942, 44.103402376252255] <----- 1
gdalwarp -t_srs EPSG:3857 orig.tif repro.tif
repro.tif
EPSG:3857
bounds [608015.5294828439, 6272484.913981743, 609507.0864301398,
6274297.75045133]
EPSG:27573 bounds [829484.0038619096, 3748101.0103735547,
830512.7970793804, 3749330.248761157]
EPSG:3857 bounds [608015.5294828439, 6272484.913981743,
609507.0864301398, 6274297.75045133]
EPSG:4326 bounds [5.46189643116462, 48.98599229672266, 5.475295315193526,
48.99667806803407]  <----- 2
gdalwarp -t_srs EPSG:27573 repro.tif back.tif
back.tif
EPSG:27573
bounds [829484.0038619096, 3748101.034601565, 830512.7912119445,
3749330.2487611575]
EPSG:27573 bounds [829484.0038619096, 3748101.034601565,
830512.7912119445, 3749330.2487611575]
EPSG:3857 bounds [607947.003095218, 6272428.113526381, 609575.9130150724,
6274354.58877996]
EPSG:4326 bounds [5.461280848150926, 48.98565744919683,
5.475913594925499, 48.99701306471833]  <----- 3
```

The accompanying python code is three times like the following
```
input_file = folder + 'orig.tif'
img = rasterio.open(input_file)
print('orig.tif')
print(img.crs)
print('bounds', list(warp.transform_bounds(img.crs, img.crs,
*img.bounds)))
print('EPSG:27573 bounds',list(warp.transform_bounds(img.crs,
'EPSG:27573', *img.bounds)))
print('EPSG:3857 bounds',list(warp.transform_bounds(img.crs, 'EPSG:3857',
*img.bounds)))
print('EPSG:4326 bounds', list(warp.transform_bounds(img.crs,
'EPSG:4326', *img.bounds)))
```

As the arrows show, the bounds change between 1 and 2 (this is the
unexpected behaviour for me). Yet they don’t change when projecting back.

I am unsure if this is a bug in GDAL, something weird with this specific
EPSG or the source tif. Any further steps for investigation or ideas
would be very welcome

Many thanks

Evert
_______________________________________________
gdal-dev mailing list


gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>


https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0<https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=04%7C01%7Cevert.etienne%40sitemark.com%7Cfeaf0ee3588b4e52d2b408d886e68280%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407671880789981%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=GN7KZj2sVcynjI0PY9hLgKo3gY60ivKbne4HAs1kTtY%3D&reserved=0>

_______________________________________________
gdal-dev mailing list


gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>


https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0<https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=04%7C01%7Cevert.etienne%40sitemark.com%7Cfeaf0ee3588b4e52d2b408d886e68280%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407671880789981%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=GN7KZj2sVcynjI0PY9hLgKo3gY60ivKbne4HAs1kTtY%3D&reserved=0>





--
Sent from: https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fosgeo-org.1560.x6.nabble.com%2FGDAL-Dev-f3742093.html&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=3FP%2Fo4GIWEzFS9CUz0cjEVbT02XPgKCoTnI%2F6EC%2Bhzw%3D&amp;reserved=0<https://eur03.safelinks.protection.outlook.com/?url=http%3A%2F%2Fosgeo-org.1560.x6.nabble.com%2FGDAL-Dev-f3742093.html&data=04%7C01%7Cevert.etienne%40sitemark.com%7Cfeaf0ee3588b4e52d2b408d886e68280%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407671880799978%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=J1bgclpj07UjPCNxgrKT5YFXE1rEyr7LUaeHBlNMx30%3D&reserved=0>
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&amp;data=04%7C01%7Cevert.etienne%40sitemark.com%7C3300bad68a154491a2d308d8868a300f%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407275358259724%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&amp;sdata=WcvmUQ4g9%2FEBwzFxF4d4vWX3OlQwQmVvyNUAVCvrj4A%3D&amp;reserved=0<https://eur03.safelinks.protection.outlook.com/?url=https%3A%2F%2Flists.osgeo.org%2Fmailman%2Flistinfo%2Fgdal-dev&data=04%7C01%7Cevert.etienne%40sitemark.com%7Cfeaf0ee3588b4e52d2b408d886e68280%7Cfc89adff07ac47008853b7b7e906068e%7C0%7C0%7C637407671880799978%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C1000&sdata=yVbmyGYQELLIeKqcepWFSvuSoSlrC9KRTW8%2BDIaN0t4%3D&reserved=0>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201112/270d1db2/attachment-0001.html>

From matthew.f.cechini at nasa.gov  Thu Nov 12 07:04:49 2020
From: matthew.f.cechini at nasa.gov (Cechini, Matthew F. (GSFC-423.0)[Science Systems & Applications, Inc.])
Date: Thu, 12 Nov 2020 15:04:49 +0000
Subject: [gdal-dev] [EXTERNAL]  GDAL t-shirts!
In-Reply-To: <E69260BF-26F2-409F-85AE-34539E969D62@hobu.co>
References: <E69260BF-26F2-409F-85AE-34539E969D62@hobu.co>
Message-ID: <C58FE99C-EB7A-4172-AF65-443C3E510ADB@nasa.gov>

This is excellent, and I especially appreciate the back!  Sure would be nice if there was a non-hoodie long sleeve option.

Thanks,
Matt
.................................................................
Matthew Cechini
Contractor, Science Systems and Applications, Inc.
NASA GIBS Systems/Software Engineer
410.205.6272

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> on behalf of Howard Butler <howard at hobu.co>
Date: Wednesday, November 11, 2020 at 11:20 AM
To: gdal dev <gdal-dev at lists.osgeo.org>
Subject: [EXTERNAL] [gdal-dev] GDAL t-shirts!

All,

Joe Morrison [1] coordinated the creation of new GDAL t-shirts with a fun update to the logo. Proceeds of the sales will be donated to OSGeo. Visit https://teespring.com/gdal<https://urldefense.proofpoint.com/v2/url?u=https-3A__teespring.com_gdal&d=DwMFAg&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=OipIn4BZYBcdlsutC4b_bGavezJwpYfx1lCdvhPIEUg&m=3EzPB4AJ2DWGvDTZe5tSVrDdTl5z-N-Tcuc6AHOLeS4&s=McL38hgIVhoC5W7vMdtYiMdCLxRZt1Sou7Rt2rID7J4&e=> to get yourself one.

Howard

[1] https://twitter.com/mouthofmorrison/status/1326556800997527557?s=20<https://urldefense.proofpoint.com/v2/url?u=https-3A__twitter.com_mouthofmorrison_status_1326556800997527557-3Fs-3D20&d=DwMFAg&c=ApwzowJNAKKw3xye91w7BE1XMRKi2LN9kiMk5Csz9Zk&r=OipIn4BZYBcdlsutC4b_bGavezJwpYfx1lCdvhPIEUg&m=3EzPB4AJ2DWGvDTZe5tSVrDdTl5z-N-Tcuc6AHOLeS4&s=fSY7w13u256yzSCjduvn-pQXOqPkln9FAMYrQddZU4E&e=>

[Image removed by sender. Image][Image removed by sender. Image][Image removed by sender. Image]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201112/9bc96e7d/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 12 23:48:03 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 13 Nov 2020 07:48:03 +0000
Subject: [gdal-dev] Oracle Spatial Driver: Is it possible to append
 features to a table?
Message-ID: <bbf1ba3975fe4070966b58751102f6b9@maanmittauslaitos.fi>

Hi,

It have not been using Oracle lately but yesterday I installed the free XE version with default values on Windows. Then I made the following simple test (I apologize all the DB admins I have been working with).

ogr2ogr OCI:system/password test.shp
ogr2ogr -update -append OCI:system/password test.shp -nln test

Ogr2ogr is adding new features into the table without errors. I also tried with "-nln test_test" and it worked as well.

If I run the command again without the -append option the error I get is 
ERROR 1: Layer test already exists, and -append not specified. Consider using -append, or -overwrite.

Quite different message. Because you get an Oracle error ERROR 1: ORA-00955 I guess that it means that
1) GDAL does not know that the table already exists and
2) therefore it tries to create a new table.

It may be that your Oracle user does not have all required rights. Does ogrinfo list the table isophone_test? Did you read the few errors that you got when you fired the first ogr2ogr command (sometimes they are meaningful)? Does your user have rights to insert and update also the spatial metadata tables in Oracle? Run the -append command again by adding "--debug on" into the command and you will see what SQL statements GDAL creates. Here is what one of my tests produced. You can test the SQL commands with SQLPlus and it may tell you what rights are missing.

OCI: From 'Oracle Database 18c Express Edition Release 18.0.0.0.0 - Production' :
OCI: Version:18
OCI: Release:0
OCI: Prepare(ALTER SESSION SET NLS_DATE_FORMAT='YYYY/MM/DD'         NLS_TIME_FORMAT='HH24:MI:SS' NLS_TIME_TZ_FORMAT='HH24:MI:SS TZHTZM'         NLS_TIMESTAMP_FORMAT='YYYY/MM/DD HH24:MI:SS'         NLS_TIMESTAMP_TZ_FORMAT='YYYY/MM/DD HH24:MI:SS TZHTZM'         NLS_NUMERIC_CHARACTERS = '. ')
OCI: Prepare(SELECT TABLE_NAME, OWNER FROM ALL_SDO_GEOM_METADATA)
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
GDAL: GDALOpen(OCI:system/ollikok90, this=000001618B8C0B20) succeeds as OCI.
OCI: Prepare(INSERT /*+ APPEND */ INTO "TIME_TEST"("OGR_FID","ORA_GEOMETRY","aika","attr","column") VALUES ( :fid , :geometry,  :field_0,  :field_1,  :field_2) )
OCI: Prepare(SELECT MAX("OGR_FID") FROM "TIME_TEST")
GDALVectorTranslate: 3 features written in layer 'TIME_TEST'
Shape: 3 features read on layer 'timetest'.
GDAL: GDALClose(timetest.shp, this=000001618B8A4540)
OCI: Flushing 3 features on layer TIME_TEST
OCI: Prepare(select min(case when r=1 then sdo_lb else null end) minx, min(case when r=2 then sdo_lb else null end) miny, min(case when r=1 then sdo_ub else null end) maxx, min(case when r=2 then sdo_ub else null end) maxy from (SELECT d.sdo_dimname, d.sdo_lb, sdo_ub, sdo_tolerance, rownum r FROM ALL_SDO_GEOM_METADATA m, table(m.diminfo) d where m.table_name = UPPER('TIME_TEST') and m.COLUMN_NAME = UPPER('ORA_GEOMETRY') ) )

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de> 
Lähetetty: torstai 12. marraskuuta 2020 18.40
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

I realized that I understood your first mail wrong. I read "Write your commands..." as "write them in the console" and wondered how this should work. But you meant "write them in the email", right? That makes more sense.

The first command is:
ogr2ogr OCI:(connection) "D:\(path)\isophone_6611.shp" -nln isophone_test This throws a few errors, but still works.

Then the next command would be: 
ogr2ogr -update -append OCI:(connection) "D:\(path)\isophone_6612.shp" -nln isophone_test This throws similar errors to the one above, but one more:
ERROR 1: ORA-00955: Es gibt bereits ein Objekt mit diesem Namen [which means: There is already an object with that name]  in CREATE TABLE "ISOPHONE_TEST" ( OGR_FID INTEGER PRIMARY KEY, ORA_GEOMETRY MDSYS.SDO_GEOMETRY )

That’s why I said it seems like the -update and -append options are ignored.

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Gesendet: Mittwoch, 11. November 2020 16:58
An: Kreß, Marius <KressM at eba.bund.de>
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

You wrote

" Even if I first write it into a shapefile and then try to write it in the  database with ogr2ogr, it ignores the -append and -update options."

This ogr2ogr command is what I meant with the second command. The first one is the ogr2ogr command that you used when you created the Oracle table and inserted the first batch of data into it.

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de>
Lähetetty: keskiviikko 11. marraskuuta 2020 17.53
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi Jukka,

thank you very much for your reply! But unfortunately I don't understand what you mean. Could you maybe give me an example what the first two commands might look like?

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von jratike80
Gesendet: Mittwoch, 11. November 2020 16:19
An: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

It should work. Write your two first ogr2ogr commands (the initial one and first to append) as a whole but without OCI connection details. The -nln parameter must appear in the append command if I remember right.

-Jukka Rahkonen-



Kreß, Marius wrote
> Dear GDAL developers and users,
> 
> I want to write contour polygons into an Oracle Spatial database. 
> Because the area is quite large, I would like to calculate them in 
> smaller boxes and write them into the table one after the other. But 
> as far as I can see, it is not possible to append features to a table.
> You can only create a new one, overwrite or truncate it. Even if I 
> first write it into a shapefile and then try to write it in the 
> database with ogr2ogr, it ignores the -append and -update options.
> 
> Is it correct that it doesn't work or did I miss anything? Do you know 
> a better solution?
> 
> Thanks for your help,
> 
> Marius Kress
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev

From Jon.Morris at jbarisk.com  Fri Nov 13 00:29:29 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Fri, 13 Nov 2020 08:29:29 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <CAE8nN5NfF4eLKd7Me3=sz-WxoqbDWwMq2S==2OC642bAitcFSQ@mail.gmail.com>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5NfF4eLKd7Me3=sz-WxoqbDWwMq2S==2OC642bAitcFSQ@mail.gmail.com>
Message-ID: <LO2P123MB1933DBFB9CF7454274C419AB82E60@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

Hi Paul,

You are right - we need FileGDB write support, so openfilegdb is not suitable for us. I can't believe it is this difficult to be able to write FileGDB on Windows (our linux wheels work perfectly), there must be a better way.

I have tried to modify the conda-forge recipe to include FileGDB and have almost got it working, so I think I'll persist with that for now.
(I also tried https://github.com/osgeo-forge/libgdal-filegdb-feedstock, which looked promising, but kept getting build errors).

If I'm missing something and anyone has better ideas, please let me know.

Thanks,

Jon

From: Paul Harwood <runette at gmail.com>
Sent: 11 November 2020 13:36
To: Jon Morris <Jon.Morris at jbarisk.com>
Cc: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL conda build

The documents are horrendously out of date - I know :)

I am assuming that you have seen this and that it does not meet your reqs
https://gdal.org/drivers/vector/openfilegdb.html#vector-openfilegdb

Building with an additional driver could, I guess, easily make a difference.

I am wondering if you have tried a vanilla build first - to see if it is all working

Personally - I would do this :

- Clone the gdal-feedstock repo onto my local machine
- cd gdal-feedstock                           // cd into the gdal-feedstock dir
- conda create --name gdal              // the actual name does not matter - as long as it does not exist yet
- conda activate gdal
- conda build recipe

That *should* I think work since that is more or less what conda-forge does in the azure pipeline - but I am no special expert on that recipe.

If that works - then you are probably going to have to change the meta.yml to include fileGDB and probably change set_bld_opts.bat to change the build options. And then run 'conda build recipe` again.

On Wed, 11 Nov 2020 at 13:00, Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
Hi Paul,

Thanks for your reply. The only reason we're trying to build locally is to add FileGDB support - if there is a better way to add FileGDB write support to conda-forge GDAL, I'd love to hear it! The GDAL docs are very out of date when it comes to building on Windows - the "GDAL Windows Building example for Plugins" links to https://trac.osgeo.org/gdal/wiki/BuildingOnWindows.

The only reason I'm building 3.1.4 is because when I started, 3.2.0 wasn't out yet...

Thanks,

Jon

From: Paul Harwood <runette at gmail.com<mailto:runette at gmail.com>>
Sent: 11 November 2020 09:18
To: Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>>
Cc: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GDAL conda build

I think we can be fairly certain that gdal-feedstock works, since it has passed in a clean container environment.

The most obvious question is - I am assuming that you are using conda build - are you working in a clean conda env?

Create a totally new conda env, activate that and then try again.

I have very occasional noticed conda getting confused about versions in its package cache. You can also try `conda clean --all` to clear out the package cache.

I am also curious. Sometimes I see messages go by and I think "why". I assume that you know your business much better than me but I do wonder what you are going to get from building the conda recipe locally that is not already built into the conda package? What have I missed?

I am also curious - given you are going through the effort of creating the build - why 3.1.4 and not 3.2.0? Surely, you risk just building in a legacy problem?

On Tue, 10 Nov 2020 at 08:12, Jon Morris <Jon.Morris at jbarisk.com<mailto:Jon.Morris at jbarisk.com>> wrote:
I've been trying to build a Windows conda package for GDAL 3.1.4, but am having problems with the poppler headers. I'm using the conda-forge recipe, which includes a line in the build script to detect the poppler version.

FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
  set POPPLER_MAJOR_VERSION=%%a
  set POPPLER_MINOR_VERSION=%%b
)
https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16

This doesn't seem to be working, as when we get to compiling the pdf driver, the headers are missing.

(gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc<http://makefile.vc>   && cd ..   || exit 1
        cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786 /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore  -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0 -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED  -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp pdfcreatefromcomposition.cpp
pdfdataset.cpp
pdfio.cpp
pdfobject.cpp
pdfcreatecopy.cpp
c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54): fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file or directory (compiling source file pdfdataset.cpp)

In pdfsdkheaders.h we can see it's the wrong poppler version that's causing the error:

#if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
#include <goo/gtypes.h>
#else
typedef unsigned char Guchar;
#endif

The installed version of poppler is 20.11.0, so I don't know why I'm getting major version set to 0 and minor version set to 23.

I'll also ask over at conda as this is most likely a conda build problem, but I thought I would also ask here if anyone has successfully built a conda package and knows how to get this recipe working.

Many thanks!

Jon


Jon Morris
Software Developer

COVID-19. During the current outbreak JBA remains open for business and we continue to deliver our services. However, we have adopted flexible/remote working as required. I will be receiving and reading email as normal but I may not always be available on the office number.


[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com/> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev

[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201113/d494ae37/attachment-0001.html>

From runette at gmail.com  Fri Nov 13 00:45:59 2020
From: runette at gmail.com (Paul Harwood)
Date: Fri, 13 Nov 2020 08:45:59 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933DBFB9CF7454274C419AB82E60@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5NfF4eLKd7Me3=sz-WxoqbDWwMq2S==2OC642bAitcFSQ@mail.gmail.com>
 <LO2P123MB1933DBFB9CF7454274C419AB82E60@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAE8nN5OGK6Z7dEGT5mFVc-k2pAmcfz1a-vnUbHS6q0ZYXseaaw@mail.gmail.com>

Sounds good - I would love to know the recipe when you get it working:)

I have no idea who osgeo-forge are?

On Fri, 13 Nov 2020 at 08:29, Jon Morris <Jon.Morris at jbarisk.com> wrote:

> Hi Paul,
>
>
>
> You are right - we need FileGDB write support, so openfilegdb is not
> suitable for us. I can't believe it is this difficult to be able to write
> FileGDB on Windows (our linux wheels work perfectly), there must be a
> better way.
>
>
>
> I have tried to modify the conda-forge recipe to include FileGDB and have
> almost got it working, so I think I'll persist with that for now.
>
> (I also tried https://github.com/osgeo-forge/libgdal-filegdb-feedstock,
> which looked promising, but kept getting build errors).
>
>
>
> If I'm missing something and anyone has better ideas, please let me know.
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *From:* Paul Harwood <runette at gmail.com>
> *Sent:* 11 November 2020 13:36
> *To:* Jon Morris <Jon.Morris at jbarisk.com>
> *Cc:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] GDAL conda build
>
>
>
> The documents are horrendously out of date - I know :)
>
> I am assuming that you have seen this and that it does not meet your reqs
> https://gdal.org/drivers/vector/openfilegdb.html#vector-openfilegdb
>
>
>
> Building with an additional driver could, I guess, easily make a
> difference.
>
> I am wondering if you have tried a vanilla build first - to see if it is
> all working
>
> Personally - I would do this :
>
> - Clone the gdal-feedstock repo onto my local machine
>
> - cd gdal-feedstock                           // cd into the
> gdal-feedstock dir
> - conda create --name gdal              // the actual name does not matter
> - as long as it does not exist yet
>
> - conda activate gdal
>
> - conda build recipe
>
>
> That *should* I think work since that is more or less what conda-forge
> does in the azure pipeline - but I am no special expert on that recipe.
>
> If that works - then you are probably going to have to change the meta.yml
> to include fileGDB and probably change set_bld_opts.bat to change the build
> options. And then run 'conda build recipe` again.
>
>
>
> On Wed, 11 Nov 2020 at 13:00, Jon Morris <Jon.Morris at jbarisk.com> wrote:
>
> Hi Paul,
>
>
>
> Thanks for your reply. The only reason we're trying to build locally is to
> add FileGDB support - if there is a better way to add FileGDB write support
> to conda-forge GDAL, I'd love to hear it! The GDAL docs are very out of
> date when it comes to building on Windows - the "GDAL Windows Building
> example for Plugins" links to
> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows.
>
>
>
> The only reason I'm building 3.1.4 is because when I started, 3.2.0 wasn't
> out yet...
>
>
>
> Thanks,
>
>
>
> Jon
>
>
>
> *From:* Paul Harwood <runette at gmail.com>
> *Sent:* 11 November 2020 09:18
> *To:* Jon Morris <Jon.Morris at jbarisk.com>
> *Cc:* gdal-dev at lists.osgeo.org
> *Subject:* Re: [gdal-dev] GDAL conda build
>
>
>
> I think we can be fairly certain that gdal-feedstock works, since it has
> passed in a clean container environment.
>
>
>
> The most obvious question is - I am assuming that you are using conda
> build - are you working in a clean conda env?
>
>
>
> Create a totally new conda env, activate that and then try again.
>
>
>
> I have very occasional noticed conda getting confused about versions in
> its package cache. You can also try `conda clean --all` to clear out the
> package cache.
>
> I am also curious. Sometimes I see messages go by and I think "why". I
> assume that you know your business much better than me but I do wonder what
> you are going to get from building the conda recipe locally that is not
> already built into the conda package? What have I missed?
>
> I am also curious - given you are going through the effort of creating the
> build - why 3.1.4 and not 3.2.0? Surely, you risk just building in a legacy
> problem?
>
>
>
> On Tue, 10 Nov 2020 at 08:12, Jon Morris <Jon.Morris at jbarisk.com> wrote:
>
> I've been trying to build a Windows conda package for GDAL 3.1.4, but am
> having problems with the poppler headers. I'm using the conda-forge recipe,
> which includes a line in the build script to detect the poppler version.
>
>
>
> FOR /F "tokens=1,2 delims=." %%a IN ("%poppler%") DO (
>
>   set POPPLER_MAJOR_VERSION=%%a
>
>   set POPPLER_MINOR_VERSION=%%b
>
> )
>
>
> https://github.com/conda-forge/gdal-feedstock/commit/320e66064c1288d582a3cadd8b573c863af654d6#diff-6f4a4b77035617ba53fd8a4d15347c44bb89f09d8086a0ffc1a5fca230ae2ed5R16
>
>
>
> This doesn't seem to be working, as when we get to compiling the pdf
> driver, the headers are missing.
>
>
>
> (gdal314) %SRC_DIR%\frmts>cd pdf   && nmake /nologo /f makefile.vc   &&
> cd ..   || exit 1
>
>         cl   /nologo /MP4 /MD /EHsc /Ox /FC /D_CRT_SECURE_NO_DEPRECATE
> /D_CRT_NONSTDC_NO_DEPRECATE /DNDEBUG /W4 /wd4127 /wd4251 /wd4275 /wd4786
> /wd4100 /wd4245 /wd4206 /wd4351 /wd4611  /DHAVE_SSE_AT_COMPILE_TIME
> /DHAVE_SSSE3_AT_COMPILE_TIME -I..\..\port -I..\..\ogr -I..\..\gcore
> -I..\..\alg -I..\..\ogr\ogrsf_frmts  -I..\..\gnm -I..\..\gnm\gnm_frmts
> -I..\..\apps /DHAVE_AVX_AT_COMPILE_TIME -I..\vrt -I..\mem
> -I..\..\ogr\ogrsf_frmts\mem  -DPOPPLER_MAJOR_VERSION=0
> -DPOPPLER_MINOR_VERSION=23 -DHAVE_POPPLER    -DGNM_ENABLED
> -DGDAL_COMPILATION -DNOMINMAX /c pdfdataset.cpp pdfio.cpp pdfobject.cpp
> pdfcreatecopy.cpp ogrpdflayer.cpp pdfwritabledataset.cpp pdfreadvectors.cpp
> pdfcreatefromcomposition.cpp
>
> pdfdataset.cpp
>
> pdfio.cpp
>
> pdfobject.cpp
>
> pdfcreatecopy.cpp
>
> c:\bin\anaconda3\conda-bld\gdal_1604943770331\work\frmts\pdf\pdfsdk_headers.h(54):
> fatal error C1083: Cannot open include file: 'goo/gtypes.h': No such file
> or directory (compiling source file pdfdataset.cpp)
>
>
>
> In pdfsdkheaders.h we can see it's the wrong poppler version that's
> causing the error:
>
>
>
> #if !(POPPLER_MAJOR_VERSION >= 1 || POPPLER_MINOR_VERSION >= 73)
>
> #include <goo/gtypes.h>
>
> #else
>
> typedef unsigned char Guchar;
>
> #endif
>
>
>
> The installed version of poppler is 20.11.0, so I don't know why I'm
> getting major version set to 0 and minor version set to 23.
>
>
>
> I'll also ask over at conda as this is most likely a conda build problem,
> but I thought I would also ask here if anyone has successfully built a
> conda package and knows how to get this recipe working.
>
>
>
> Many thanks!
>
>
>
> Jon
>
>
>
>
>
> *Jon Morris*
>
> Software Developer
>
>
>
> *COVID-19. During the current outbreak JBA remains open for business and
> we continue to deliver our services. However, we have adopted
> flexible/remote working as required. I will be receiving and reading email
> as normal but I may not always be available on the office number.*
>
>
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
> *T* +44 (0) 1756 799919
> www.jbarisk.com
>
> [image: Visit our website] <http://www.jbarisk.com/>
> <https://www.linkedin.com/in/jon-morris-a2897b4/> [image: Follow us on
> Twitter] <https://twitter.com/jbarisk>
>
> *Find out more about us here: www.jbarisk.com <http://www.jbarisk.com/>
> and **follow us on Twitter @JBARisk <http://twitter.com/JBARisk> and
> LinkedIn
> <https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
> *
>
> The JBA Group supports the JBA Trust.
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
>
>
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, Telephone: +441756799919
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
> [image: JBA COVID-19 statement]
> <https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201113/7da5fd98/attachment-0001.html>

From ari.jolma at gmail.com  Fri Nov 13 00:55:53 2020
From: ari.jolma at gmail.com (Ari Jolma)
Date: Fri, 13 Nov 2020 10:55:53 +0200
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
In-Reply-To: <1605172616302-0.post@n6.nabble.com>
References: <CAKTKyJK50ygcMa-15y9zbroZ7kHxYMH-Uz2WFMRTbocUSA121Q@mail.gmail.com>
 <77b40009b5f046418ab7a464b50f8504@maanmittauslaitos.fi>
 <698802d1-4c34-aae9-c5db-21578ed2eacc@gmail.com>
 <1605172616302-0.post@n6.nabble.com>
Message-ID: <0169ee66-c3ba-59db-f757-7bc6e60cc05d@gmail.com>

jratike80 kirjoitti 12.11.2020 klo 11.16:
> Hi Ari,
>
> I fear that user cannot control this with the switches. This is the reason
> for the error:


Yes, looks a bit like the logic for getting a small piece of the data 
that GDAL does fails in this case. I can take a look once I have time.

Ari


>
> ```
> WCS: Requesting
> http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long(6.3953399152693953,6.3953399152693953)&SUBSET=Lat(46.541601968340089,46.541601968340089)&Format=image/tiff
>
> ```
>
> Thus GDAL creates subsets with lower limit = upper limit which makes the
> bbox into a point. That it probably not intentional. I think it is done with
> the code that begins from
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/wcs/wcsdataset.cpp#L562
>
> If theory interests, there has been discussions within the OGC WCS group
> about the validity of such request. It may be that the server should expand
> the bbox and send tiff with one pixel as an output. If the subsets were
> written for slicing
> SUBSET=Long(6.3953399152693953)
> &SUBSET=Lat(46.541601968340089)
> then tiff as outputformat is not possible because image has always  two
> dimensions but here 0 dimensionality (point) is requested. But this is a
> sidepath because I believe that the WCS driver wants to read a small area
> from WCS as a sample, not just one pixel.
>
> -Jukka-
>
>
> Ari Jolma-2 wrote
>> 2) gdalinfo
>> "WCS:https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample"
>>
>> .. takes again some time as it makes calls and then it stores new data
>> into the cache
>>
>> -
>> cJLrY=https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
>> - three files: cJLrY.xml, cJLrY.xml.aux.xml, cJLrY.DC.xml, the first is
>> the WCS_GDAL XML
>>
>> and prints
>>
>> ERROR 1: HTTP error code : 404
>> ERROR 1: InvalidSubsetting: Empty intersection after subsetting
>>
>> so it probably needs some special switches, which are described in the
>> documentation.
>>
>> Best,
>>
>> Ari
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From KressM at eba.bund.de  Fri Nov 13 09:57:30 2020
From: KressM at eba.bund.de (=?Windows-1252?Q?Kre=DF=2C_Marius?=)
Date: Fri, 13 Nov 2020 17:57:30 +0000
Subject: [gdal-dev] Oracle Spatial Driver: Is it possible to append
 features to a table?
In-Reply-To: <bbf1ba3975fe4070966b58751102f6b9@maanmittauslaitos.fi>
References: <bbf1ba3975fe4070966b58751102f6b9@maanmittauslaitos.fi>
Message-ID: <b22f00843ebe42bd892710d7c4fd2b04@eba.bund.de>

Hi,

As it often is with this things, it was actually pretty simple: I included the table name in the connection. It seems that this confused the program. But when I did it like you, with just username, password and server, it worked.

Thanks for your help,
Marius Kress
________________________________
Von: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Gesendet: Freitag, 13. November 2020 08:48:03
An: Kreß, Marius
Cc: 'gdal-dev at lists.osgeo.org'
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

It have not been using Oracle lately but yesterday I installed the free XE version with default values on Windows. Then I made the following simple test (I apologize all the DB admins I have been working with).

ogr2ogr OCI:system/password test.shp
ogr2ogr -update -append OCI:system/password test.shp -nln test

Ogr2ogr is adding new features into the table without errors. I also tried with "-nln test_test" and it worked as well.

If I run the command again without the -append option the error I get is
ERROR 1: Layer test already exists, and -append not specified. Consider using -append, or -overwrite.

Quite different message. Because you get an Oracle error ERROR 1: ORA-00955 I guess that it means that
1) GDAL does not know that the table already exists and
2) therefore it tries to create a new table.

It may be that your Oracle user does not have all required rights. Does ogrinfo list the table isophone_test? Did you read the few errors that you got when you fired the first ogr2ogr command (sometimes they are meaningful)? Does your user have rights to insert and update also the spatial metadata tables in Oracle? Run the -append command again by adding "--debug on" into the command and you will see what SQL statements GDAL creates. Here is what one of my tests produced. You can test the SQL commands with SQLPlus and it may tell you what rights are missing.

OCI: From 'Oracle Database 18c Express Edition Release 18.0.0.0.0 - Production' :
OCI: Version:18
OCI: Release:0
OCI: Prepare(ALTER SESSION SET NLS_DATE_FORMAT='YYYY/MM/DD'         NLS_TIME_FORMAT='HH24:MI:SS' NLS_TIME_TZ_FORMAT='HH24:MI:SS TZHTZM'         NLS_TIMESTAMP_FORMAT='YYYY/MM/DD HH24:MI:SS'         NLS_TIMESTAMP_TZ_FORMAT='YYYY/MM/DD HH24:MI:SS TZHTZM'         NLS_NUMERIC_CHARACTERS = '. ')
OCI: Prepare(SELECT TABLE_NAME, OWNER FROM ALL_SDO_GEOM_METADATA)
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
GDAL: GDALOpen(OCI:system/ollikok90, this=000001618B8C0B20) succeeds as OCI.
OCI: Prepare(INSERT /*+ APPEND */ INTO "TIME_TEST"("OGR_FID","ORA_GEOMETRY","aika","attr","column") VALUES ( :fid , :geometry,  :field_0,  :field_1,  :field_2) )
OCI: Prepare(SELECT MAX("OGR_FID") FROM "TIME_TEST")
GDALVectorTranslate: 3 features written in layer 'TIME_TEST'
Shape: 3 features read on layer 'timetest'.
GDAL: GDALClose(timetest.shp, this=000001618B8A4540)
OCI: Flushing 3 features on layer TIME_TEST
OCI: Prepare(select min(case when r=1 then sdo_lb else null end) minx, min(case when r=2 then sdo_lb else null end) miny, min(case when r=1 then sdo_ub else null end) maxx, min(case when r=2 then sdo_ub else null end) maxy from (SELECT d.sdo_dimname, d.sdo_lb, sdo_ub, sdo_tolerance, rownum r FROM ALL_SDO_GEOM_METADATA m, table(m.diminfo) d where m.table_name = UPPER('TIME_TEST') and m.COLUMN_NAME = UPPER('ORA_GEOMETRY') ) )

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de>
Lähetetty: torstai 12. marraskuuta 2020 18.40
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

I realized that I understood your first mail wrong. I read "Write your commands..." as "write them in the console" and wondered how this should work. But you meant "write them in the email", right? That makes more sense.

The first command is:
ogr2ogr OCI:(connection) "D:\(path)\isophone_6611.shp" -nln isophone_test This throws a few errors, but still works.

Then the next command would be:
ogr2ogr -update -append OCI:(connection) "D:\(path)\isophone_6612.shp" -nln isophone_test This throws similar errors to the one above, but one more:
ERROR 1: ORA-00955: Es gibt bereits ein Objekt mit diesem Namen [which means: There is already an object with that name]  in CREATE TABLE "ISOPHONE_TEST" ( OGR_FID INTEGER PRIMARY KEY, ORA_GEOMETRY MDSYS.SDO_GEOMETRY )

That’s why I said it seems like the -update and -append options are ignored.

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Gesendet: Mittwoch, 11. November 2020 16:58
An: Kreß, Marius <KressM at eba.bund.de>
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

You wrote

" Even if I first write it into a shapefile and then try to write it in the  database with ogr2ogr, it ignores the -append and -update options."

This ogr2ogr command is what I meant with the second command. The first one is the ogr2ogr command that you used when you created the Oracle table and inserted the first batch of data into it.

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de>
Lähetetty: keskiviikko 11. marraskuuta 2020 17.53
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi Jukka,

thank you very much for your reply! But unfortunately I don't understand what you mean. Could you maybe give me an example what the first two commands might look like?

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org> Im Auftrag von jratike80
Gesendet: Mittwoch, 11. November 2020 16:19
An: gdal-dev at lists.osgeo.org
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

It should work. Write your two first ogr2ogr commands (the initial one and first to append) as a whole but without OCI connection details. The -nln parameter must appear in the append command if I remember right.

-Jukka Rahkonen-



Kreß, Marius wrote
> Dear GDAL developers and users,
>
> I want to write contour polygons into an Oracle Spatial database.
> Because the area is quite large, I would like to calculate them in
> smaller boxes and write them into the table one after the other. But
> as far as I can see, it is not possible to append features to a table.
> You can only create a new one, overwrite or truncate it. Even if I
> first write it into a shapefile and then try to write it in the
> database with ogr2ogr, it ignores the -append and -update options.
>
> Is it correct that it doesn't work or did I miss anything? Do you know
> a better solution?
>
> Thanks for your help,
>
> Marius Kress
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201113/5204d190/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Nov 14 00:40:11 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Sat, 14 Nov 2020 08:40:11 +0000
Subject: [gdal-dev] Oracle Spatial Driver: Is it possible to append
 features to a table?
Message-ID: <6c3585f9da9f4e60bf9626775f1acece@maanmittauslaitos.fi>

Hi,

Good that it works for you now. Myself I do not get an error from these either:

ogr2ogr -append OCI:system/password:TEST test.shp

ogr2ogr -append OCI:system/password:TEST test.shp -nln test

The Oracle default to use uppercase names affects the connection string but I could not manage to get your original error by playing with upper/lower case in various places of the command.

-Jukka-

Lähettäjä: Kreß, Marius <KressM at eba.bund.de>
Lähetetty: perjantai 13. marraskuuta 2020 19.58
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: 'gdal-dev at lists.osgeo.org' <gdal-dev at lists.osgeo.org>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

As it often is with this things, it was actually pretty simple: I included the table name in the connection. It seems that this confused the program. But when I did it like you, with just username, password and server, it worked.

Thanks for your help,
Marius Kress
________________________________
Von: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Gesendet: Freitag, 13. November 2020 08:48:03
An: Kreß, Marius
Cc: 'gdal-dev at lists.osgeo.org'
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

It have not been using Oracle lately but yesterday I installed the free XE version with default values on Windows. Then I made the following simple test (I apologize all the DB admins I have been working with).

ogr2ogr OCI:system/password test.shp
ogr2ogr -update -append OCI:system/password test.shp -nln test

Ogr2ogr is adding new features into the table without errors. I also tried with "-nln test_test" and it worked as well.

If I run the command again without the -append option the error I get is
ERROR 1: Layer test already exists, and -append not specified. Consider using -append, or -overwrite.

Quite different message. Because you get an Oracle error ERROR 1: ORA-00955 I guess that it means that
1) GDAL does not know that the table already exists and
2) therefore it tries to create a new table.

It may be that your Oracle user does not have all required rights. Does ogrinfo list the table isophone_test? Did you read the few errors that you got when you fired the first ogr2ogr command (sometimes they are meaningful)? Does your user have rights to insert and update also the spatial metadata tables in Oracle? Run the -append command again by adding "--debug on" into the command and you will see what SQL statements GDAL creates. Here is what one of my tests produced. You can test the SQL commands with SQLPlus and it may tell you what rights are missing.

OCI: From 'Oracle Database 18c Express Edition Release 18.0.0.0.0 - Production' :
OCI: Version:18
OCI: Release:0
OCI: Prepare(ALTER SESSION SET NLS_DATE_FORMAT='YYYY/MM/DD'         NLS_TIME_FORMAT='HH24:MI:SS' NLS_TIME_TZ_FORMAT='HH24:MI:SS TZHTZM'         NLS_TIMESTAMP_FORMAT='YYYY/MM/DD HH24:MI:SS'         NLS_TIMESTAMP_TZ_FORMAT='YYYY/MM/DD HH24:MI:SS TZHTZM'         NLS_NUMERIC_CHARACTERS = '. ')
OCI: Prepare(SELECT TABLE_NAME, OWNER FROM ALL_SDO_GEOM_METADATA)
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
OCI: Prepare(SELECT COLUMN_NAME, DATA_DEFAULT
FROM user_tab_columns
WHERE DATA_DEFAULT IS NOT NULL AND TABLE_NAME = UPPER(:table_name))
OCI: Prepare(SELECT COUNT(*)
FROM USER_SDO_GEOM_METADATA u, TABLE(u.diminfo) t
WHERE u.table_name = :table_name
  AND u.column_name = :geometry_name)
OCI: Prepare(select m.SDO_LAYER_GTYPE from user_sdo_index_metadata m, user_sdo_index_info i where i.index_name = m.sdo_index_name and i.table_name = upper(:table_name))
OCI: Prepare(SELECT SRID FROM ALL_SDO_GEOM_METADATA WHERE TABLE_NAME = UPPER(:table_name) AND COLUMN_NAME = UPPER(:geometry_name))
GDAL: GDALOpen(OCI:system/ollikok90, this=000001618B8C0B20) succeeds as OCI.
OCI: Prepare(INSERT /*+ APPEND */ INTO "TIME_TEST"("OGR_FID","ORA_GEOMETRY","aika","attr","column") VALUES ( :fid , :geometry,  :field_0,  :field_1,  :field_2) )
OCI: Prepare(SELECT MAX("OGR_FID") FROM "TIME_TEST")
GDALVectorTranslate: 3 features written in layer 'TIME_TEST'
Shape: 3 features read on layer 'timetest'.
GDAL: GDALClose(timetest.shp, this=000001618B8A4540)
OCI: Flushing 3 features on layer TIME_TEST
OCI: Prepare(select min(case when r=1 then sdo_lb else null end) minx, min(case when r=2 then sdo_lb else null end) miny, min(case when r=1 then sdo_ub else null end) maxx, min(case when r=2 then sdo_ub else null end) maxy from (SELECT d.sdo_dimname, d.sdo_lb, sdo_ub, sdo_tolerance, rownum r FROM ALL_SDO_GEOM_METADATA m, table(m.diminfo) d where m.table_name = UPPER('TIME_TEST') and m.COLUMN_NAME = UPPER('ORA_GEOMETRY') ) )

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de<mailto:KressM at eba.bund.de>>
Lähetetty: torstai 12. marraskuuta 2020 18.40
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

I realized that I understood your first mail wrong. I read "Write your commands..." as "write them in the console" and wondered how this should work. But you meant "write them in the email", right? That makes more sense.

The first command is:
ogr2ogr OCI:(connection) "D:\(path)\isophone_6611.shp" -nln isophone_test This throws a few errors, but still works.

Then the next command would be:
ogr2ogr -update -append OCI:(connection) "D:\(path)\isophone_6612.shp" -nln isophone_test This throws similar errors to the one above, but one more:
ERROR 1: ORA-00955: Es gibt bereits ein Objekt mit diesem Namen [which means: There is already an object with that name]  in CREATE TABLE "ISOPHONE_TEST" ( OGR_FID INTEGER PRIMARY KEY, ORA_GEOMETRY MDSYS.SDO_GEOMETRY )

That's why I said it seems like the -update and -append options are ignored.

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Gesendet: Mittwoch, 11. November 2020 16:58
An: Kreß, Marius <KressM at eba.bund.de<mailto:KressM at eba.bund.de>>
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

You wrote

" Even if I first write it into a shapefile and then try to write it in the  database with ogr2ogr, it ignores the -append and -update options."

This ogr2ogr command is what I meant with the second command. The first one is the ogr2ogr command that you used when you created the Oracle table and inserted the first batch of data into it.

-Jukka Rahkonen-

-----Alkuperäinen viesti-----
Lähettäjä: Kreß, Marius <KressM at eba.bund.de<mailto:KressM at eba.bund.de>>
Lähetetty: keskiviikko 11. marraskuuta 2020 17.53
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Aihe: AW: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi Jukka,

thank you very much for your reply! But unfortunately I don't understand what you mean. Could you maybe give me an example what the first two commands might look like?

Best regards,
Marius Kress

-----Ursprüngliche Nachricht-----
Von: gdal-dev <gdal-dev-bounces at lists.osgeo.org<mailto:gdal-dev-bounces at lists.osgeo.org>> Im Auftrag von jratike80
Gesendet: Mittwoch, 11. November 2020 16:19
An: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Betreff: Re: [gdal-dev] Oracle Spatial Driver: Is it possible to append features to a table?

Hi,

It should work. Write your two first ogr2ogr commands (the initial one and first to append) as a whole but without OCI connection details. The -nln parameter must appear in the append command if I remember right.

-Jukka Rahkonen-



Kreß, Marius wrote
> Dear GDAL developers and users,
>
> I want to write contour polygons into an Oracle Spatial database.
> Because the area is quite large, I would like to calculate them in
> smaller boxes and write them into the table one after the other. But
> as far as I can see, it is not possible to append features to a table.
> You can only create a new one, overwrite or truncate it. Even if I
> first write it into a shapefile and then try to write it in the
> database with ogr2ogr, it ignores the -append and -update options.
>
> Is it correct that it doesn't work or did I miss anything? Do you know
> a better solution?
>
> Thanks for your help,
>
> Marius Kress
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201114/ec8b1751/attachment.html>

From even.rouault at spatialys.com  Sun Nov 15 06:39:36 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 15 Nov 2020 15:39:36 +0100
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
Message-ID: <1962786.iPBX4NNV7Y@even-i700>

Hi,

any comment on this before we put it to vote ?

Even

> Hi All,
> 
> I would like to call for discussion on RFC77 Drop Python 2 support
> <https://github.com/talos-gis/gdal/blob/Branch_rfc_drop_python2/gdal/doc/sou
> rce/development/rfc/rfc77_drop_python2_support.rst> .
> Please give your feedback on this PR.
> <https://github.com/OSGeo/gdal/pull/3142>
> 
> Kind regards,
> Idan Miara


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jgr at osgeopt.pt  Sun Nov 15 09:27:39 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Sun, 15 Nov 2020 17:27:39 +0000
Subject: [gdal-dev] Encoding when creating pdf
In-Reply-To: <VI1PR03MB6253DAEE2B335BB6F3CA2B6D9EEA0@VI1PR03MB6253.eurprd03.prod.outlook.com>
References: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>
 <CAHBySPb704joFY3piHTJ2jya4aAi6iovyKL5SgV2XkZd-3TwyA@mail.gmail.com>
 <VI1PR03MB6253DAEE2B335BB6F3CA2B6D9EEA0@VI1PR03MB6253.eurprd03.prod.outlook.com>
Message-ID: <658e710d-df32-d1ed-7612-9f22f94183c7@osgeopt.pt>

Hi Aneta,

I didn't try on the command line. But I've tried with QGIS (QGIS uses
GDAl to generate PDFs).

I was able to create a PDF with accent characters everywhere. Check the
attached PDF.

I've used a layer name with accents; I've used a label with accents.
I've also used as attribute field name with accents and the value with
accents. The label is displayed properly on the feature.

I'm using GDAL 3.3.0dev, compiled with --with-poppler. I would recommend
a more recent version of GDAL (ver. >= 3.1.0).

Regards,

Jorge

Às 08:26 de 09/11/20, Aneta Muslić escreveu:
> Yes, it does.
> The problem is that gdal uses ansi as a default encoding when given font
> in label, and that cannot be changed.
> 
> 
> ------------------------------------------------------------------------
> *From:* Richard Greenwood <richard.greenwood at gmail.com>
> *Sent:* Thursday, November 5, 2020 4:27 PM
> *To:* Aneta Muslić <a.muslic at outlook.com>
> *Cc:* gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
> *Subject:* Re: [gdal-dev] Encoding when creating pdf
>  
> Do your shapefiles include a code page file (*.cpg)? If not, maybe that
> would help.
> 
> On Wed, Nov 4, 2020 at 2:57 AM Aneta Muslić <a.muslic at outlook.com
> <mailto:a.muslic at outlook.com>> wrote:
> 
>     Hello,
> 
>     I am using gdal version 2.4.4 in my c# app.
>     As a part of my project I am creating pdf with gdal_translate
>     command. GDAL translate command is 
>     /"gdal_translate  --config SHAPE_ENCODING "utf-8" -of PDF -tr 0.001
>     0.001 -a_srs EPSG:3765 Granice.tif Sisacko_moslavacka_zupanija3.pdf
>     -co OGR_DATASOURCE=Extent.vrt"./
>     /
>     /
>     Part of vrt file that displays labels is:
>     /<OGRVRTLayer name="SHPCounties">/
>     /<SrcDataSource relativeToVRT="0">MSSQL: driver={SQL Server Native
>     Client 11.0};/
>     /server=xxx;uid=xx;pwd=xx;database=HAPIH;/
>     /Integrated Security=False;MARS_Connection=yes</SrcDataSource>/
>     /<SrcLayer>SHPCounties</SrcLayer>/
>     /<LayerSRS>EPSG:3765</LayerSRS>        /
>     /<SrcSQL>/
>     /select Geometry.STCentroid() as pointPolygonCounties,/
>     /CAST(Name AS varchar(100)) COLLATE Croatian_CI_AI AS NameCollated,/
>     /'LABEL(f:"Times New Roman",t:{NameCollated},c:#000000,s:40pt)' AS
>     OGR_STYLE /
>     /FROM SHPCounties/
>     /</SrcSQL>/
>     /<GeometryType>wkbPoints</GeometryType> /
>     /<GeometryField name="pointPolygonCounties" />/
>     /</OGRVRTLayer>
>     /
> 
>     My labels have special characters (č and ć). I defined encoding to
>     utf-8 and gdal-config as utf-8 but in generated pdf under fonts I
>     can see that the font used is Times New Roman with encoding ansi,
>     and characters č and ć are replaced with c because ansi doesn't
>     support those letters. I tried writing just the letter 'č' to pdf so
>     I can eliminate that the problem is in database but it is replaced
>     with something else in pdf,  also I tried using html entity for
>     those letters but it doesn't help.
> 
>     I would like to know how can I define in label options of vrt file
>     for it to use font with custom encoding and not ansi encoding so it
>     can display my special characters or there is another way for me to
>     display those special characters. 
> 
>     Thank you.
> 
>     _______________________________________________
>     gdal-dev mailing list
>     gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>     https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> 
> -- 
> Richard W. Greenwood, PLS
> www.greenwoodmap.com <http://www.greenwoodmap.com>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.pdf
Type: application/pdf
Size: 23537 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201115/f3fc0b2a/attachment-0001.pdf>

From even.rouault at spatialys.com  Sun Nov 15 14:50:46 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 15 Nov 2020 23:50:46 +0100
Subject: [gdal-dev] Encoding when creating pdf
In-Reply-To: <658e710d-df32-d1ed-7612-9f22f94183c7@osgeopt.pt>
References: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>
 <VI1PR03MB6253DAEE2B335BB6F3CA2B6D9EEA0@VI1PR03MB6253.eurprd03.prod.outlook.com>
 <658e710d-df32-d1ed-7612-9f22f94183c7@osgeopt.pt>
Message-ID: <2110088.6ttHFWA7Nh@even-i700>

Aneta,

https://gdal.org/drivers/vector/pdf.html#vector-pdf mentions that LABEL 
strings are limitted to ASCII

Jorge,

the fact that it renders fine with QGIS is that the rendering of labels is 
done by QGIS through its own rendering engine with a PDF output. It then uses 
the GDAL PDF driver to assemble the rendering of the different layers with a 
layer tree, and add the georeferencing. It doesn't use the basic in-built GDAL 
PDF vector rendering capabilities.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jmckenna at gatewaygeomatics.com  Mon Nov 16 04:54:26 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Mon, 16 Nov 2020 08:54:26 -0400
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>

On 2020-11-11 9:00 a.m., Jon Morris wrote:
> Hi Paul,
> 
> Thanks for your reply. The only reason we're trying to build locally is 
> to add FileGDB support - if there is a better way to add FileGDB write 
> support to conda-forge GDAL, I'd love to hear it! The GDAL docs are very 
> out of date when it comes to building on Windows - the "GDAL Windows 
> Building example for Plugins" links to 
> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows 
> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
> 

Hi Jon,

For 10+ years we maintained the FileGDB build steps for Windows etc at 
https://trac.osgeo.org/gdal/wiki/FileGDB

In general, as a person compiling GDAL, you should bookmark the 
priceless "BuildHints" wiki page, see the "External Library" section 
where various driver compile howtos are listed, at
https://trac.osgeo.org/gdal/wiki/BuildHints

(you can see how for users compiling drivers that a wiki is a lifeline, 
recording build steps that may be 5 years old and 'stale', yet 
containing valuable information to the user)

Please consider recording your steps as well, for other users, as you 
travel down this path.

Thanks!

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
co-founder of FOSS4G
http://gatewaygeo.com/







From sean at mapbox.com  Mon Nov 16 07:01:12 2020
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 16 Nov 2020 08:01:12 -0700
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <1962786.iPBX4NNV7Y@even-i700>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
 <1962786.iPBX4NNV7Y@even-i700>
Message-ID: <CADPhZXxuoLix3HS8tDD5fAtNnwC692m0WWe3CjcadV=v8MP8jQ@mail.gmail.com>

Hi Even,

On Sun, Nov 15, 2020 at 7:39 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> any comment on this before we put it to vote ?
>
> Even
>
> > Hi All,
> >
> > I would like to call for discussion on RFC77 Drop Python 2 support
> > <
> https://github.com/talos-gis/gdal/blob/Branch_rfc_drop_python2/gdal/doc/sou
> > rce/development/rfc/rfc77_drop_python2_support.rst> .
> > Please give your feedback on this PR.
> > <https://github.com/OSGeo/gdal/pull/3142>
> >
> > Kind regards,
> > Idan Miara


It makes sense to me. I'm not aware of GDAL needing any features of Python
3.7, so 3.6 sounds good.

Since the project hasn't dropped support for a Python version in a long
time, maybe there should be a plan to warn in code and make announcements
on OSGeo lists? It's only a suggestion. I don't insist.

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201116/2e2511d6/attachment.html>

From even.rouault at spatialys.com  Mon Nov 16 07:13:31 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 16 Nov 2020 16:13:31 +0100
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <CADPhZXxuoLix3HS8tDD5fAtNnwC692m0WWe3CjcadV=v8MP8jQ@mail.gmail.com>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
 <1962786.iPBX4NNV7Y@even-i700>
 <CADPhZXxuoLix3HS8tDD5fAtNnwC692m0WWe3CjcadV=v8MP8jQ@mail.gmail.com>
Message-ID: <5036545.8Ig9jSVNDo@even-i700>

Sean,

> It makes sense to me. I'm not aware of GDAL needing any features of Python
> 3.7, so 3.6 sounds good.
> 
> Since the project hasn't dropped support for a Python version in a long
> time, maybe there should be a plan to warn in code

Idan has a pull request in https://github.com/OSGeo/gdal/pull/3165 adding a 
deprecation warning if running a Python version that is known to be 
unsupported in the the next GDAL version. We should merge this in the 3.2 
branch too for 3.2.1

> and make announcements on OSGeo lists?

Would indeed makes sense to announce that in the release notes of 3.2.1 too

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jgr at osgeopt.pt  Mon Nov 16 16:30:47 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Tue, 17 Nov 2020 00:30:47 +0000
Subject: [gdal-dev] Encoding when creating pdf
In-Reply-To: <2110088.6ttHFWA7Nh@even-i700>
References: <VI1PR03MB62539D5DFCFEF2F335B8659F9EEF0@VI1PR03MB6253.eurprd03.prod.outlook.com>
 <VI1PR03MB6253DAEE2B335BB6F3CA2B6D9EEA0@VI1PR03MB6253.eurprd03.prod.outlook.com>
 <658e710d-df32-d1ed-7612-9f22f94183c7@osgeopt.pt>
 <2110088.6ttHFWA7Nh@even-i700>
Message-ID: <81975982-0171-5ca4-5615-ecbeb53f40be@osgeopt.pt>

Hi Even,

Thank you for the explanation (and for correcting me).

Aneta,

You can try QGIS as a possible workaround. You can use the Atlas feature
(GUI based) or write a small PyQGIS script, if you want to run it on a
headless server, on the command line.

Regards,

Jorge

Às 22:50 de 15/11/20, Even Rouault escreveu:
> Aneta,
> 
> https://gdal.org/drivers/vector/pdf.html#vector-pdf mentions that LABEL 
> strings are limitted to ASCII
> 
> Jorge,
> 
> the fact that it renders fine with QGIS is that the rendering of labels is 
> done by QGIS through its own rendering engine with a PDF output. It then uses 
> the GDAL PDF driver to assemble the rendering of the different layers with a 
> layer tree, and add the georeferencing. It doesn't use the basic in-built GDAL 
> PDF vector rendering capabilities.
> 
> Even
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/

From sean at mapbox.com  Mon Nov 16 19:55:53 2020
From: sean at mapbox.com (Sean Gillies)
Date: Mon, 16 Nov 2020 20:55:53 -0700
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <4459767.mlp4P4333Y@even-i700>
References: <1752606.LJUL4JdboQ@even-i700> <10247089.7RZAXl55qJ@even-i700>
 <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>
 <4459767.mlp4P4333Y@even-i700>
Message-ID: <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>

Hi Even,

On Wed, Nov 4, 2020 at 9:01 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> > > Another particularity we have in GDAL is that the dataset name might be
> > > almost
> > > anything. Most of the time, it is a regular file path, or some /vsi
> path.
> > > But
> > > sometimes, it can be JSON content (the GeoJSON driver accepts the
> content
> > > to
> > > be directly provided as the dataset name), or XML (VRT, WMS drivers).
> > > We have also the subdataset syntax "HDF5:foo.hdf:my_variable"
> >
> > Could VRT XML and JSON be exempted? We already have a way to embed open
> > options in the XML.
>
> If the gdn: mechanism is a new possibility offered that doesn't exclude
> existing ones (otherwise that would be a pretty big breaking change), we
> could
> possibly exempt the odd cases I mentioned (or have some quoting/escaping
> rules
> to enable that payload to be seen as a file), which generally don't need a
> "permanent" way of refering to the dataset like gdn: would offer, since
> this
> is content often generated programatically or retrieved dynamically.
>
> Covering subdataset would be a more important use case. Something that
> would
> have to be decided if the way we express subdatasets would be somehow
> standardized or if it would be a black-box string for the gdn:
> encapsulation.
> For a black-box approach, we would have to define some escaping/quoting
> rules
> to avoid any potential issue with separators of the gdn syntax. If we
> decide
> that the subdataset syntax is part of what is standardized by GDN that
> would
> be a more challenging exercice, because the subdataset syntax varies from
> driver to driver.
>

The variation of subdataset syntax among drivers is a bug, let's try to fix
this.

It seems to me that the internet way to address subdatasets would be to use
a # URL fragment. But since most of our formats and the servers that serve
files of these formats are not aware, we may have to come up with something
different. We may need to consider making subdatasets a layer opening
option?

pending on how we design things, that might impact between:
> - just GDALOpen() generic code if GDALOpen() decodes the gdn: string to
> decompose it into 'classic' dataset names and open options
> - all drivers if the gdn: string would be passed to each
> GDALDriver::pfnOpen()
> implementation
> - intermediate situation if we decide to drop (at least for future
> drivers)
> per-driver subdataset syntax (which has deficiencies has the quoting rules
> to
> separate the filename from the non-filename component vary from driver to
> driver, and are most of the time not defined) to come up with something
> more
> standardized
>
> To help brainstorming, a non-exhaustive overview of a few situations
> mixing
> driver prefixing, subdataset syntax and open options:
>
> gdalinfo my.tif
>

Yes. We have to handle bare paths to local dataset files.


> gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
>

Ideally this would be baked into the format, but, yes, I think we've got a
bead on dataset open options.


> gdalinfo GTIFF_DIR:0:d:\my.tif
>

WTF is this? :)


> gdalinfo EEDAI:my/asset
> gdalinfo EEDAI: -oo ASSET=my/asset
> gdalinfo EEDAI:my/asset:band1, band2
> gdalinfo EEDAI: -oo ASSET=my/asset -oo BANDS=band1,band2
>

Never seen these.


> gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
>

DRIVER:"file":something

Right. This will require some work because of multiple colons. Though I've
never seen BAG driver data in the wild. Is this a real live format?


> gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo SUPERGRIDS_MASK=YES
> gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
>

HDF5 driver, filename using Windows drive, and UNC path within it. This is
marginal, right?


> gdalinfo netCDF:"/vsicurl/http://example.com/my.nc":my_var
>

This looks less complicated than some of the examples above.


> ogrinfo "PG:dbname=testdb user=foo"
> ogrinfo "mySQL:testdb,user=foo"
>

These seem like they could be driver specific, but generalized key-value
parameters.


> ogrinfo OCI:warmerda/password at gdal800.dreadfest.com


Wat?


> GDALOpen() is not even aware that HDF5:bla means that the dataset will be
> recognized by the HDF5 driver
>
>
Wait what?

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201116/71b3c4e4/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Nov 17 01:57:29 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 17 Nov 2020 02:57:29 -0700 (MST)
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>
References: <1752606.LJUL4JdboQ@even-i700>
 <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>
 <18238121.3TO5vI0ssJ@even-i700>
 <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>
 <10247089.7RZAXl55qJ@even-i700>
 <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>
 <4459767.mlp4P4333Y@even-i700>
 <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>
Message-ID: <1605607049515-0.post@n6.nabble.com>

Hi,

I have done some helpdesk work within the GDAL community and I know well
that the open options and config options are confusing. I also know that
they exists for a reason but simplified and uniform way to use them would be
nice.

Some comments on comments:

>> gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
>>

> Ideally this would be baked into the format, but, yes, I think we've got a
> bead on dataset open options.

I don't know how it could be baked into the format. The option gives user an
option to override wrong GeoTIFF georeferencing with wordfile, for example.

>> gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
>>

> DRIVER:"file":something

> Right. This will require some work because of multiple colons. Though I've
> never seen BAG driver data in the wild. Is this a real live format?

As far as I know BAG is the hdf of bathymetry and widely used in that
context.

>> gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo SUPERGRIDS_MASK=YES
>> gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
>>

> HDF5 driver, filename using Windows drive, and UNC path within it. This is
> marginal, right?

The part beginning with // is not UNC path but the name of the subdataset
within hdf5 file https://gdal.org/drivers/raster/hdf5.html. Not more
marginal than HDF5 itself.

>> ogrinfo OCI:warmerda/password at .dreadfest

>Wat?

Text has just been formatted into email link because of the @ sign that
belongs to the Oracle connection string "username" / "password" @ "the name
of the Oracle database as it appears in the tnsnames.ora file". Let's see if
formatting happens again when I send this from Nabble:

OCI:warmerda/password at gdal800.dreadfest.com abc.shp

-Jukka Rahkonen-




Sean Gillies-3 wrote
> Hi Even,
> 
> On Wed, Nov 4, 2020 at 9:01 AM Even Rouault &lt;

> even.rouault@

> &gt;
> wrote:
> 
>> > > Another particularity we have in GDAL is that the dataset name might
>> be
>> > > almost
>> > > anything. Most of the time, it is a regular file path, or some /vsi
>> path.
>> > > But
>> > > sometimes, it can be JSON content (the GeoJSON driver accepts the
>> content
>> > > to
>> > > be directly provided as the dataset name), or XML (VRT, WMS drivers).
>> > > We have also the subdataset syntax "HDF5:foo.hdf:my_variable"
>> >
>> > Could VRT XML and JSON be exempted? We already have a way to embed open
>> > options in the XML.
>>
>> If the gdn: mechanism is a new possibility offered that doesn't exclude
>> existing ones (otherwise that would be a pretty big breaking change), we
>> could
>> possibly exempt the odd cases I mentioned (or have some quoting/escaping
>> rules
>> to enable that payload to be seen as a file), which generally don't need
>> a
>> "permanent" way of refering to the dataset like gdn: would offer, since
>> this
>> is content often generated programatically or retrieved dynamically.
>>
>> Covering subdataset would be a more important use case. Something that
>> would
>> have to be decided if the way we express subdatasets would be somehow
>> standardized or if it would be a black-box string for the gdn:
>> encapsulation.
>> For a black-box approach, we would have to define some escaping/quoting
>> rules
>> to avoid any potential issue with separators of the gdn syntax. If we
>> decide
>> that the subdataset syntax is part of what is standardized by GDN that
>> would
>> be a more challenging exercice, because the subdataset syntax varies from
>> driver to driver.
>>
> 
> The variation of subdataset syntax among drivers is a bug, let's try to
> fix
> this.
> 
> It seems to me that the internet way to address subdatasets would be to
> use
> a # URL fragment. But since most of our formats and the servers that serve
> files of these formats are not aware, we may have to come up with
> something
> different. We may need to consider making subdatasets a layer opening
> option?
> 
> pending on how we design things, that might impact between:
>> - just GDALOpen() generic code if GDALOpen() decodes the gdn: string to
>> decompose it into 'classic' dataset names and open options
>> - all drivers if the gdn: string would be passed to each
>> GDALDriver::pfnOpen()
>> implementation
>> - intermediate situation if we decide to drop (at least for future
>> drivers)
>> per-driver subdataset syntax (which has deficiencies has the quoting
>> rules
>> to
>> separate the filename from the non-filename component vary from driver to
>> driver, and are most of the time not defined) to come up with something
>> more
>> standardized
>>
>> To help brainstorming, a non-exhaustive overview of a few situations
>> mixing
>> driver prefixing, subdataset syntax and open options:
>>
>> gdalinfo my.tif
>>
> 
> Yes. We have to handle bare paths to local dataset files.
> 
> 
>> gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
>>
> 
> Ideally this would be baked into the format, but, yes, I think we've got a
> bead on dataset open options.
> 
> 
>> gdalinfo GTIFF_DIR:0:d:\my.tif
>>
> 
> WTF is this? :)
> 
> 
>> gdalinfo EEDAI:my/asset
>> gdalinfo EEDAI: -oo ASSET=my/asset
>> gdalinfo EEDAI:my/asset:band1, band2
>> gdalinfo EEDAI: -oo ASSET=my/asset -oo BANDS=band1,band2
>>
> 
> Never seen these.
> 
> 
>> gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
>>
> 
> DRIVER:"file":something
> 
> Right. This will require some work because of multiple colons. Though I've
> never seen BAG driver data in the wild. Is this a real live format?
> 
> 
>> gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo SUPERGRIDS_MASK=YES
>> gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
>>
> 
> HDF5 driver, filename using Windows drive, and UNC path within it. This is
> marginal, right?
> 
> 
>> gdalinfo netCDF:"/vsicurl/http://example.com/my.nc":my_var
>>
> 
> This looks less complicated than some of the examples above.
> 
> 
>> ogrinfo "PG:dbname=testdb user=foo"
>> ogrinfo "mySQL:testdb,user=foo"
>>
> 
> These seem like they could be driver specific, but generalized key-value
> parameters.
> 
> 
>> ogrinfo OCI:warmerda/

> password at .dreadfest

> 
> 
> Wat?
> 
> 
>> GDALOpen() is not even aware that HDF5:bla means that the dataset will be
>> recognized by the HDF5 driver
>>
>>
> Wait what?
> 
> -- 
> Sean Gillies
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Tue Nov 17 03:21:03 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2020 12:21:03 +0100
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>
References: <1752606.LJUL4JdboQ@even-i700> <4459767.mlp4P4333Y@even-i700>
 <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>
Message-ID: <21426988.fFPmoX8iEK@even-i700>

> The variation of subdataset syntax among drivers is a bug, let's try to fix
> this.
> 
> It seems to me that the internet way to address subdatasets would be to use
> a # URL fragment. But since most of our formats and the servers that serve
> files of these formats are not aware, we may have to come up with something
> different. We may need to consider making subdatasets a layer opening
> option?

Hum, I'm a bit confused. Isn't the purpose to have a single string covering 
subdataset specification and open options ?

Because you could potentially have use cases where you open a "container" 
dataset with its name and open options (not selecting a particular subdataset) 
and the GetMetadata("SUBDATASETS") should return potentially a GDN that would 
have the same open options but also additions foreach specific subdataset.

Let's say "gdalinfo my.hdf5 -oo FOO=BAR" would return a list of subdatasets:
gdn:HDF5:my.hdf5+encoding_FOO=BAR+encoding_VARIABLE=temperature
gdn:HDF5:my.hdf5+encoding_FOO=BAR+encoding_VARIABLE=pressure


Some additions to Jukka's answer:

> > gdalinfo GTIFF_DIR:0:d:\my.tif
> 
> WTF is this? :)

https://gdal.org/drivers/raster/gtiff.html :
"""
Multi-page TIFF files are exposed as subdatasets. On opening, a subdataset 
name is GTIFF_DIR:{index}:filename.tif, where {index} starts at 1.
"""
(ok, so my example was wrong :-) should have benn GTIFF_DIR:1:d:\my.tif)

> 
> > gdalinfo EEDAI:my/asset
> > gdalinfo EEDAI: -oo ASSET=my/asset
> > gdalinfo EEDAI:my/asset:band1, band2
> > gdalinfo EEDAI: -oo ASSET=my/asset -oo BANDS=band1,band2
> 
> Never seen these.

Cf https://gdal.org/drivers/raster/eedai.html

This driver shows a case where we handle both worlds. The specification of a 
dataset can be in the dataset name ("EEDAI:my/asset") or as a dataset name 
("EEDAI:") + open options (ASSET=my/asset). This was my attempt to use open 
options as a way of having more explictness on how to specify the subparts of 
a subdataset, but perhaps this wasn't a good idea. But this is a case where 
the border between what is the dataset/subdataset name and what is an open 
option is fuzzy. "gdalinfo EEDAI:" without any option will not work: you can't 
reasonably list all datasets hosted on Earth Engine...

But in some circumstances (when all bands don’t have the same georeferencing, 
resolution, CRS or image dimensions), whatever you open with  dataset name 
("EEDAI:my/asset") or as a dataset name ("EEDAI:") + open options (ASSET=my/
asset), you may get a list of subdatasets

> > GDALOpen() is not even aware that HDF5:bla means that the dataset will be
> > recognized by the HDF5 driver
> 
> Wait what?

GDALOpen() just iterates over drivers and passes the dataset name and open 
options to them until one says "yes, that's for me". The use of 
"DRIVER_NAME:bla" is mostly a convention, but in no way a core mechanism. If 
you use DRIVER_NAME:bla fo a driver that doesn't recognize the DRIVER_NAME: 
prefix, that won't work.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Jon.Morris at jbarisk.com  Tue Nov 17 03:33:01 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Tue, 17 Nov 2020 11:33:01 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
Message-ID: <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

Hi Jeff,

I don't feel I know enough about the process to start to update that page, as there is quite a lot of work to do!

In the end the recipe at https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me, with a couple of minor tweaks to remove some warnings from the log. Updating it to v3.2.0 was also straightforward, only the version and md5 need to be updated. Once this is built, the libgdal-filegdb package can be installed to an environment containing conda-forge GDAL and you now have full FileGDB write support.

Thanks,

Jon

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
Sent: 16 November 2020 12:54
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL conda build

On 2020-11-11 9:00 a.m., Jon Morris wrote:
> Hi Paul,
>
> Thanks for your reply. The only reason we're trying to build locally
> is to add FileGDB support - if there is a better way to add FileGDB
> write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
> are very out of date when it comes to building on Windows - the "GDAL
> Windows Building example for Plugins" links to
> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
>

Hi Jon,

For 10+ years we maintained the FileGDB build steps for Windows etc at
https://trac.osgeo.org/gdal/wiki/FileGDB

In general, as a person compiling GDAL, you should bookmark the
priceless "BuildHints" wiki page, see the "External Library" section
where various driver compile howtos are listed, at
https://trac.osgeo.org/gdal/wiki/BuildHints

(you can see how for users compiling drivers that a wiki is a lifeline,
recording build steps that may be 5 years old and 'stale', yet
containing valuable information to the user)

Please consider recording your steps as well, for other users, as you
travel down this path.

Thanks!

-jeff


--
Jeff McKenna
MapServer Consulting and Training Services
co-founder of FOSS4G
http://gatewaygeo.com/






_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919



From runette at gmail.com  Tue Nov 17 03:44:01 2020
From: runette at gmail.com (Paul Harwood)
Date: Tue, 17 Nov 2020 11:44:01 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
 <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <CAE8nN5O8x0yhEbDaYmyjnycaGHrA5s7KGXGjP0eg0uxgg1XvhA@mail.gmail.com>

Does anyone know the background behind "osgeo-forge"?

On Tue, 17 Nov 2020 at 11:33, Jon Morris <Jon.Morris at jbarisk.com> wrote:

> Hi Jeff,
>
> I don't feel I know enough about the process to start to update that page,
> as there is quite a lot of work to do!
>
> In the end the recipe at
> https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me,
> with a couple of minor tweaks to remove some warnings from the log.
> Updating it to v3.2.0 was also straightforward, only the version and md5
> need to be updated. Once this is built, the libgdal-filegdb package can be
> installed to an environment containing conda-forge GDAL and you now have
> full FileGDB write support.
>
> Thanks,
>
> Jon
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff
> McKenna
> Sent: 16 November 2020 12:54
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL conda build
>
> On 2020-11-11 9:00 a.m., Jon Morris wrote:
> > Hi Paul,
> >
> > Thanks for your reply. The only reason we're trying to build locally
> > is to add FileGDB support - if there is a better way to add FileGDB
> > write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
> > are very out of date when it comes to building on Windows - the "GDAL
> > Windows Building example for Plugins" links to
> > https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
> > <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
> >
>
> Hi Jon,
>
> For 10+ years we maintained the FileGDB build steps for Windows etc at
> https://trac.osgeo.org/gdal/wiki/FileGDB
>
> In general, as a person compiling GDAL, you should bookmark the
> priceless "BuildHints" wiki page, see the "External Library" section
> where various driver compile howtos are listed, at
> https://trac.osgeo.org/gdal/wiki/BuildHints
>
> (you can see how for users compiling drivers that a wiki is a lifeline,
> recording build steps that may be 5 years old and 'stale', yet
> containing valuable information to the user)
>
> Please consider recording your steps as well, for other users, as you
> travel down this path.
>
> Thanks!
>
> -jeff
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> co-founder of FOSS4G
> http://gatewaygeo.com/
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [JBA COVID-19 statement]<
> https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf
> >
> T +44 (0) 1756 799919
> www.jbarisk.com<http://www.jbarisk.com>
>
> [Visit our website]<http://www.jbarisk.com> [
> http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <
> https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <
> https://twitter.com/jbarisk>
> Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and
> follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<
> https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT
> >
>
> The JBA Group supports the JBA Trust.
>
> All JBA Risk Management's email messages contain confidential information
> and are intended only for the individual(s) named. If you are not the named
> addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this
> email by mistake and delete this email from your system.
>
>
> JBA Risk Management Limited is registered in England, company number
> 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North
> Yorkshire, BD23 3FD, Telephone: +441756799919
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201117/816b46bb/attachment.html>

From jmckenna at gatewaygeomatics.com  Tue Nov 17 05:58:24 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 17 Nov 2020 09:58:24 -0400
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
 <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <15978e91-a378-8ee9-7009-f9e16008e506@gatewaygeomatics.com>

Hi Jon,

You can press edit and add a section with all of your own notes 
(everything you have written here in your emails to the list) to the 
bottom of that page, so that way you avoid the thinking of 'i must 
update the entire wiki page'.  (no exclamation point needed)

thanks,

-jeff


-- 
Jeff McKenna
MapServer Consulting and Training Services
co-founder of FOSS4G
http://gatewaygeo.com/




On 2020-11-17 7:33 a.m., Jon Morris wrote:
> Hi Jeff,
> 
> I don't feel I know enough about the process to start to update that page, as there is quite a lot of work to do!
> 
> In the end the recipe at https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me, with a couple of minor tweaks to remove some warnings from the log. Updating it to v3.2.0 was also straightforward, only the version and md5 need to be updated. Once this is built, the libgdal-filegdb package can be installed to an environment containing conda-forge GDAL and you now have full FileGDB write support.
> 
> Thanks,
> 
> Jon
> 
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
> Sent: 16 November 2020 12:54
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL conda build
> 
> On 2020-11-11 9:00 a.m., Jon Morris wrote:
>> Hi Paul,
>>
>> Thanks for your reply. The only reason we're trying to build locally
>> is to add FileGDB support - if there is a better way to add FileGDB
>> write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
>> are very out of date when it comes to building on Windows - the "GDAL
>> Windows Building example for Plugins" links to
>> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
>> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
>>
> 
> Hi Jon,
> 
> For 10+ years we maintained the FileGDB build steps for Windows etc at
> https://trac.osgeo.org/gdal/wiki/FileGDB
> 
> In general, as a person compiling GDAL, you should bookmark the
> priceless "BuildHints" wiki page, see the "External Library" section
> where various driver compile howtos are listed, at
> https://trac.osgeo.org/gdal/wiki/BuildHints
> 
> (you can see how for users compiling drivers that a wiki is a lifeline,
> recording build steps that may be 5 years old and 'stale', yet
> containing valuable information to the user)
> 
> Please consider recording your steps as well, for other users, as you
> travel down this path.
> 
> Thanks!
> 
> -jeff
> 
> 
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> co-founder of FOSS4G
> http://gatewaygeo.com/
> 
> 
> 
> 
> 
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
> T +44 (0) 1756 799919
> www.jbarisk.com<http://www.jbarisk.com>
> 
> [Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
> Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
> 
> The JBA Group supports the JBA Trust.
> 
> All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
> 
> 
> JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919
> 
> 


From daniel.mellergardh at gmail.com  Tue Nov 17 06:01:07 2020
From: daniel.mellergardh at gmail.com (=?UTF-8?Q?Daniel_Mellerg=C3=A5rd?=)
Date: Tue, 17 Nov 2020 14:01:07 +0000
Subject: [gdal-dev] GDAL 3.1.2: PROJ_DEBUG
Message-ID: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>

Hi,

Is setting the environment variable PROJ_DEBUG=3 supposed to work when
using GDAL3.1.2? Running for example gdalsrsinfo with that environment
variable set has no effect, but running projinfo (from proj 6.3.2) does.

I assume this has something to do with different "contexts" in Proj?

Also, by programmatically using proj_log_level, I can see that the log
level has been picked up by Proj in the default context.

BR,
Daniel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201117/ae25aee3/attachment.html>

From daniel.mellergardh at gmail.com  Tue Nov 17 06:04:06 2020
From: daniel.mellergardh at gmail.com (=?UTF-8?Q?Daniel_Mellerg=C3=A5rd?=)
Date: Tue, 17 Nov 2020 14:04:06 +0000
Subject: [gdal-dev] GDAL 3.1.2: PROJ_DEBUG
In-Reply-To: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
References: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
Message-ID: <CAKJvoS0_dxiedLcZ_VQ3dq39tGPOK73+LSEj=LovHY6H6R_byg@mail.gmail.com>

I was a bit eager to hit send... The GDAL version I am using is 3.0.4.

Den tis 17 nov. 2020 kl 14:01 skrev Daniel Mellergård <
daniel.mellergardh at gmail.com>:

> Hi,
>
> Is setting the environment variable PROJ_DEBUG=3 supposed to work when
> using GDAL3.1.2? Running for example gdalsrsinfo with that environment
> variable set has no effect, but running projinfo (from proj 6.3.2) does.
>
> I assume this has something to do with different "contexts" in Proj?
>
> Also, by programmatically using proj_log_level, I can see that the log
> level has been picked up by Proj in the default context.
>
> BR,
> Daniel
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201117/27e0bf26/attachment.html>

From Jon.Morris at jbarisk.com  Tue Nov 17 06:06:47 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Tue, 17 Nov 2020 14:06:47 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <15978e91-a378-8ee9-7009-f9e16008e506@gatewaygeomatics.com>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
 <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <15978e91-a378-8ee9-7009-f9e16008e506@gatewaygeomatics.com>
Message-ID: <LO2P123MB1933683613FC15667A16E26682E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

Hi Jeff,

No problem, I can do that. Does it need to be approved, or do people just keep editing until we're all happy with it?

Thanks,

Jon

-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
Sent: 17 November 2020 13:58
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL conda build

Hi Jon,

You can press edit and add a section with all of your own notes (everything you have written here in your emails to the list) to the bottom of that page, so that way you avoid the thinking of 'i must update the entire wiki page'.  (no exclamation point needed)

thanks,

-jeff


--
Jeff McKenna
MapServer Consulting and Training Services co-founder of FOSS4G http://gatewaygeo.com/




On 2020-11-17 7:33 a.m., Jon Morris wrote:
> Hi Jeff,
>
> I don't feel I know enough about the process to start to update that page, as there is quite a lot of work to do!
>
> In the end the recipe at https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me, with a couple of minor tweaks to remove some warnings from the log. Updating it to v3.2.0 was also straightforward, only the version and md5 need to be updated. Once this is built, the libgdal-filegdb package can be installed to an environment containing conda-forge GDAL and you now have full FileGDB write support.
>
> Thanks,
>
> Jon
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
> Sent: 16 November 2020 12:54
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL conda build
>
> On 2020-11-11 9:00 a.m., Jon Morris wrote:
>> Hi Paul,
>>
>> Thanks for your reply. The only reason we're trying to build locally
>> is to add FileGDB support - if there is a better way to add FileGDB
>> write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
>> are very out of date when it comes to building on Windows - the "GDAL
>> Windows Building example for Plugins" links to
>> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
>> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
>>
>
> Hi Jon,
>
> For 10+ years we maintained the FileGDB build steps for Windows etc at
> https://trac.osgeo.org/gdal/wiki/FileGDB
>
> In general, as a person compiling GDAL, you should bookmark the
> priceless "BuildHints" wiki page, see the "External Library" section
> where various driver compile howtos are listed, at
> https://trac.osgeo.org/gdal/wiki/BuildHints
>
> (you can see how for users compiling drivers that a wiki is a lifeline,
> recording build steps that may be 5 years old and 'stale', yet
> containing valuable information to the user)
>
> Please consider recording your steps as well, for other users, as you
> travel down this path.
>
> Thanks!
>
> -jeff
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services
> co-founder of FOSS4G
> http://gatewaygeo.com/
>
>
>
>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
> T +44 (0) 1756 799919
> www.jbarisk.com<http://www.jbarisk.com>
>
> [Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
> Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
>
> The JBA Group supports the JBA Trust.
>
> All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
> Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
>
>
> JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919
>
>

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

From daniel.mellergardh at gmail.com  Tue Nov 17 06:08:02 2020
From: daniel.mellergardh at gmail.com (=?UTF-8?Q?Daniel_Mellerg=C3=A5rd?=)
Date: Tue, 17 Nov 2020 14:08:02 +0000
Subject: [gdal-dev] GDAL 3.1.2: PROJ_DEBUG
In-Reply-To: <CAKJvoS0_dxiedLcZ_VQ3dq39tGPOK73+LSEj=LovHY6H6R_byg@mail.gmail.com>
References: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
 <CAKJvoS0_dxiedLcZ_VQ3dq39tGPOK73+LSEj=LovHY6H6R_byg@mail.gmail.com>
Message-ID: <CAKJvoS2wEEYXVmxyLnC4xGujjP8+Ukju3CDY36DJ+izHxuTzPA@mail.gmail.com>

At the same time, can I assume OSRSetPROJSearchPaths to work as expected,
or is there any similar issue?



Den tis 17 nov. 2020 kl 14:04 skrev Daniel Mellergård <
daniel.mellergardh at gmail.com>:

> I was a bit eager to hit send... The GDAL version I am using is 3.0.4.
>
> Den tis 17 nov. 2020 kl 14:01 skrev Daniel Mellergård <
> daniel.mellergardh at gmail.com>:
>
>> Hi,
>>
>> Is setting the environment variable PROJ_DEBUG=3 supposed to work when
>> using GDAL3.1.2? Running for example gdalsrsinfo with that environment
>> variable set has no effect, but running projinfo (from proj 6.3.2) does.
>>
>> I assume this has something to do with different "contexts" in Proj?
>>
>> Also, by programmatically using proj_log_level, I can see that the log
>> level has been picked up by Proj in the default context.
>>
>> BR,
>> Daniel
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201117/93268dc4/attachment.html>

From jmckenna at gatewaygeomatics.com  Tue Nov 17 06:10:43 2020
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Tue, 17 Nov 2020 10:10:43 -0400
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <LO2P123MB1933683613FC15667A16E26682E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
 <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <15978e91-a378-8ee9-7009-f9e16008e506@gatewaygeomatics.com>
 <LO2P123MB1933683613FC15667A16E26682E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <3669835d-de21-826d-9bd4-9c29b32f77d6@gatewaygeomatics.com>

Hi Jon,

No approval/funnel through one person for edits, you can just add your 
notes there, so others can follow them someday (and avoid list archive 
searching).  Over time maybe someone updates or enhances your notes, or 
not, that's how the wiki thrives.

Thanks for taking the time to do this, most do not (now I could use the 
exclamation mark here, ha)  :)

-jeff




-- 
Jeff McKenna
MapServer Consulting and Training Services
co-founder of FOSS4G
http://gatewaygeo.com/



On 2020-11-17 10:06 a.m., Jon Morris wrote:
> Hi Jeff,
> 
> No problem, I can do that. Does it need to be approved, or do people just keep editing until we're all happy with it?
> 
> Thanks,
> 
> Jon
> 
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
> Sent: 17 November 2020 13:58
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL conda build
> 
> Hi Jon,
> 
> You can press edit and add a section with all of your own notes (everything you have written here in your emails to the list) to the bottom of that page, so that way you avoid the thinking of 'i must update the entire wiki page'.  (no exclamation point needed)
> 
> thanks,
> 
> -jeff
> 
> 
> --
> Jeff McKenna
> MapServer Consulting and Training Services co-founder of FOSS4G http://gatewaygeo.com/
> 
> 
> 
> 
> On 2020-11-17 7:33 a.m., Jon Morris wrote:
>> Hi Jeff,
>>
>> I don't feel I know enough about the process to start to update that page, as there is quite a lot of work to do!
>>
>> In the end the recipe at https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me, with a couple of minor tweaks to remove some warnings from the log. Updating it to v3.2.0 was also straightforward, only the version and md5 need to be updated. Once this is built, the libgdal-filegdb package can be installed to an environment containing conda-forge GDAL and you now have full FileGDB write support.
>>
>> Thanks,
>>
>> Jon
>>
>> -----Original Message-----
>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
>> Sent: 16 November 2020 12:54
>> To: gdal-dev at lists.osgeo.org
>> Subject: Re: [gdal-dev] GDAL conda build
>>
>> On 2020-11-11 9:00 a.m., Jon Morris wrote:
>>> Hi Paul,
>>>
>>> Thanks for your reply. The only reason we're trying to build locally
>>> is to add FileGDB support - if there is a better way to add FileGDB
>>> write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
>>> are very out of date when it comes to building on Windows - the "GDAL
>>> Windows Building example for Plugins" links to
>>> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
>>> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
>>>
>>
>> Hi Jon,
>>
>> For 10+ years we maintained the FileGDB build steps for Windows etc at
>> https://trac.osgeo.org/gdal/wiki/FileGDB
>>
>> In general, as a person compiling GDAL, you should bookmark the
>> priceless "BuildHints" wiki page, see the "External Library" section
>> where various driver compile howtos are listed, at
>> https://trac.osgeo.org/gdal/wiki/BuildHints
>>
>> (you can see how for users compiling drivers that a wiki is a lifeline,
>> recording build steps that may be 5 years old and 'stale', yet
>> containing valuable information to the user)
>>
>> Please consider recording your steps as well, for other users, as you
>> travel down this path.
>>
>> Thanks!
>>
>> -jeff
>>
>>
>> --
>> Jeff McKenna
>> MapServer Consulting and Training Services
>> co-founder of FOSS4G
>> http://gatewaygeo.com/
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>> T +44 (0) 1756 799919
>> www.jbarisk.com<http://www.jbarisk.com>
>>
>> [Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
>> Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
>>
>> The JBA Group supports the JBA Trust.
>>
>> All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
>> Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
>>
>>
>> JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919
>>
>>
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
> 


From even.rouault at spatialys.com  Tue Nov 17 10:40:19 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 17 Nov 2020 19:40:19 +0100
Subject: [gdal-dev] GDAL 3.1.2: PROJ_DEBUG
In-Reply-To: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
References: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
Message-ID: <9193904.sJQrgf7Yb9@even-i700>

On mardi 17 novembre 2020 14:01:07 CET Daniel Mellergård wrote:
> Hi,
> 
> Is setting the environment variable PROJ_DEBUG=3 supposed to work when
> using GDAL3.1.2? Running for example gdalsrsinfo with that environment
> variable set has no effect, but running projinfo (from proj 6.3.2) does.

As PROJ logging goes through GDAL one, you also need to enable CPL_DEBUG=ON 
(or CPL_DEBUG=PROJ to restrict to PROJ traces)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From howard at hobu.co  Tue Nov 17 13:09:50 2020
From: howard at hobu.co (Howard Butler)
Date: Tue, 17 Nov 2020 15:09:50 -0600
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <1962786.iPBX4NNV7Y@even-i700>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
 <1962786.iPBX4NNV7Y@even-i700>
Message-ID: <C83935C9-7BBD-4C16-A18C-8CC2803139E4@hobu.co>

LGTM. Thanks for the RFC and PRs.

Can I convince Idan to also write an RFC to move all of the swig-generated bindings out of the main tree and into their own project? :)

I'm half-serious, and I know this would represent real disruption. I also know Even is not so enthused about such an effort, but GDAL's bindings packaging is a distribution anti-pattern in just about every language supported at this point. The bindings that are not actually used can either fall away or acquire an active maintainer, and the opportunity for the bindings to evolve at a pace that at least keeps up with language-specific coming and goings would be possible. 

Howard




> On Nov 15, 2020, at 8:39 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> any comment on this before we put it to vote ?
> 
> Even
> 
>> Hi All,
>> 
>> I would like to call for discussion on RFC77 Drop Python 2 support
>> <https://github.com/talos-gis/gdal/blob/Branch_rfc_drop_python2/gdal/doc/sou
>> rce/development/rfc/rfc77_drop_python2_support.rst> .
>> Please give your feedback on this PR.
>> <https://github.com/OSGeo/gdal/pull/3142>
>> 
>> Kind regards,
>> Idan Miara
> 
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


From sean at mapbox.com  Tue Nov 17 16:24:08 2020
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 17 Nov 2020 17:24:08 -0700
Subject: [gdal-dev] Passing open options along dataset name in a string ?
In-Reply-To: <1605607049515-0.post@n6.nabble.com>
References: <1752606.LJUL4JdboQ@even-i700>
 <CADPhZXz7mN4qFYYjdfJkv7LF0rSf+afR_c9dsatXWZ13DhiYtw@mail.gmail.com>
 <18238121.3TO5vI0ssJ@even-i700>
 <CADPhZXyNo+GSHUm=2_Om=7LV-aO-4TWgUDYrjY49052H7MppOg@mail.gmail.com>
 <10247089.7RZAXl55qJ@even-i700>
 <CADPhZXxW_7RrZGunwL+D6-x=Se8xHpOctfFtekYio_V=01JT3Q@mail.gmail.com>
 <4459767.mlp4P4333Y@even-i700>
 <CADPhZXz1PoZnYC+a50vYbRmjS-_P+zZ2JvM1T7Kv16SaWohw+Q@mail.gmail.com>
 <1605607049515-0.post@n6.nabble.com>
Message-ID: <CADPhZXynMVAY3o7CJN-E95jBxCLi-iX24iu8z0EMxpO5q+aWFw@mail.gmail.com>

Hi Jukka,

On Tue, Nov 17, 2020 at 2:57 AM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> I have done some helpdesk work within the GDAL community and I know well
> that the open options and config options are confusing. I also know that
> they exists for a reason but simplified and uniform way to use them would
> be
> nice.
>

I'm glad to read that you're interested! I believe there is tension between
simple and uniform and we'll need wide input to find a good balance.

I've been using QGIS today for the first time in a while and I think that
application could benefit from this as well. A "URL" for datasets could
remove some of the complexity of QGIS dialog boxes for creating or
configuring connections.


> Some comments on comments:
>
> >> gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
> >>
>
> > Ideally this would be baked into the format, but, yes, I think we've got
> a
> > bead on dataset open options.
>
> I don't know how it could be baked into the format. The option gives user
> an
> option to override wrong GeoTIFF georeferencing with wordfile, for example.
>

Yes.


> >> gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
> >>
>
> > DRIVER:"file":something
>
> > Right. This will require some work because of multiple colons. Though
> I've
> > never seen BAG driver data in the wild. Is this a real live format?
>
> As far as I know BAG is the hdf of bathymetry and widely used in that
> context.
>
> >> gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo
> SUPERGRIDS_MASK=YES
> >> gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
> >>
>
> > HDF5 driver, filename using Windows drive, and UNC path within it. This
> is
> > marginal, right?
>
> The part beginning with // is not UNC path but the name of the subdataset
> within hdf5 file https://gdal.org/drivers/raster/hdf5.html. Not more
> marginal than HDF5 itself.
>
>
Thank you for explaining.


> >> ogrinfo OCI:warmerda/password at .dreadfest
>
> >Wat?
>
> Text has just been formatted into email link because of the @ sign that
> belongs to the Oracle connection string "username" / "password" @ "the name
> of the Oracle database as it appears in the tnsnames.ora file". Let's see
> if
> formatting happens again when I send this from Nabble:
>
> OCI:warmerda/password at gdal800.dreadfest.com abc.shp
>

Thanks.


> -Jukka Rahkonen-
>
>
>
>
> Sean Gillies-3 wrote
> > Hi Even,
> >
> > On Wed, Nov 4, 2020 at 9:01 AM Even Rouault &lt;
>
> > even.rouault@
>
> > &gt;
> > wrote:
> >
> >> > > Another particularity we have in GDAL is that the dataset name might
> >> be
> >> > > almost
> >> > > anything. Most of the time, it is a regular file path, or some /vsi
> >> path.
> >> > > But
> >> > > sometimes, it can be JSON content (the GeoJSON driver accepts the
> >> content
> >> > > to
> >> > > be directly provided as the dataset name), or XML (VRT, WMS
> drivers).
> >> > > We have also the subdataset syntax "HDF5:foo.hdf:my_variable"
> >> >
> >> > Could VRT XML and JSON be exempted? We already have a way to embed
> open
> >> > options in the XML.
> >>
> >> If the gdn: mechanism is a new possibility offered that doesn't exclude
> >> existing ones (otherwise that would be a pretty big breaking change), we
> >> could
> >> possibly exempt the odd cases I mentioned (or have some quoting/escaping
> >> rules
> >> to enable that payload to be seen as a file), which generally don't need
> >> a
> >> "permanent" way of refering to the dataset like gdn: would offer, since
> >> this
> >> is content often generated programatically or retrieved dynamically.
> >>
> >> Covering subdataset would be a more important use case. Something that
> >> would
> >> have to be decided if the way we express subdatasets would be somehow
> >> standardized or if it would be a black-box string for the gdn:
> >> encapsulation.
> >> For a black-box approach, we would have to define some escaping/quoting
> >> rules
> >> to avoid any potential issue with separators of the gdn syntax. If we
> >> decide
> >> that the subdataset syntax is part of what is standardized by GDN that
> >> would
> >> be a more challenging exercice, because the subdataset syntax varies
> from
> >> driver to driver.
> >>
> >
> > The variation of subdataset syntax among drivers is a bug, let's try to
> > fix
> > this.
> >
> > It seems to me that the internet way to address subdatasets would be to
> > use
> > a # URL fragment. But since most of our formats and the servers that
> serve
> > files of these formats are not aware, we may have to come up with
> > something
> > different. We may need to consider making subdatasets a layer opening
> > option?
> >
> > pending on how we design things, that might impact between:
> >> - just GDALOpen() generic code if GDALOpen() decodes the gdn: string to
> >> decompose it into 'classic' dataset names and open options
> >> - all drivers if the gdn: string would be passed to each
> >> GDALDriver::pfnOpen()
> >> implementation
> >> - intermediate situation if we decide to drop (at least for future
> >> drivers)
> >> per-driver subdataset syntax (which has deficiencies has the quoting
> >> rules
> >> to
> >> separate the filename from the non-filename component vary from driver
> to
> >> driver, and are most of the time not defined) to come up with something
> >> more
> >> standardized
> >>
> >> To help brainstorming, a non-exhaustive overview of a few situations
> >> mixing
> >> driver prefixing, subdataset syntax and open options:
> >>
> >> gdalinfo my.tif
> >>
> >
> > Yes. We have to handle bare paths to local dataset files.
> >
> >
> >> gdalinfo my.tif -oo GEOREF_SOURCES=WORLDFILE,PAM
> >>
> >
> > Ideally this would be baked into the format, but, yes, I think we've got
> a
> > bead on dataset open options.
> >
> >
> >> gdalinfo GTIFF_DIR:0:d:\my.tif
> >>
> >
> > WTF is this? :)
> >
> >
> >> gdalinfo EEDAI:my/asset
> >> gdalinfo EEDAI: -oo ASSET=my/asset
> >> gdalinfo EEDAI:my/asset:band1, band2
> >> gdalinfo EEDAI: -oo ASSET=my/asset -oo BANDS=band1,band2
> >>
> >
> > Never seen these.
> >
> >
> >> gdalinfo BAG:"data/test_vr.bag":supergrid:0:1
> >>
> >
> > DRIVER:"file":something
> >
> > Right. This will require some work because of multiple colons. Though
> I've
> > never seen BAG driver data in the wild. Is this a real live format?
> >
> >
> >> gdalinfo data/test_vr.bag -oo MODE=RESAMPLED_GRID -oo
> SUPERGRIDS_MASK=YES
> >> gdalinfo HDF5:"d:\foo.he5"://HDFEOS/SWATHS/foo/bar
> >>
> >
> > HDF5 driver, filename using Windows drive, and UNC path within it. This
> is
> > marginal, right?
> >
> >
> >> gdalinfo netCDF:"/vsicurl/http://example.com/my.nc":my_var
> >>
> >
> > This looks less complicated than some of the examples above.
> >
> >
> >> ogrinfo "PG:dbname=testdb user=foo"
> >> ogrinfo "mySQL:testdb,user=foo"
> >>
> >
> > These seem like they could be driver specific, but generalized key-value
> > parameters.
> >
> >
> >> ogrinfo OCI:warmerda/
>
> > password at .dreadfest
>
> >
> >
> > Wat?
> >
> >
> >> GDALOpen() is not even aware that HDF5:bla means that the dataset will
> be
> >> recognized by the HDF5 driver
> >>
> >>
> > Wait what?
> >
> > --
> > Sean Gillies
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201117/c344b98f/attachment.html>

From daniel.mellergardh at gmail.com  Wed Nov 18 04:18:17 2020
From: daniel.mellergardh at gmail.com (=?UTF-8?Q?Daniel_Mellerg=C3=A5rd?=)
Date: Wed, 18 Nov 2020 12:18:17 +0000
Subject: [gdal-dev] GDAL 3.1.2: PROJ_DEBUG
In-Reply-To: <9193904.sJQrgf7Yb9@even-i700>
References: <CAKJvoS1uTz+UgH6EzKAVjOHURs_D=UaQY2qYViPLMMF3eG7Usw@mail.gmail.com>
 <9193904.sJQrgf7Yb9@even-i700>
Message-ID: <CAKJvoS271syFjFZdktxEkumrKW_GjOr9E21v_UrEWGHwej0LwQ@mail.gmail.com>

Thanks!

Den tis 17 nov. 2020 kl 18:40 skrev Even Rouault <even.rouault at spatialys.com
>:

> On mardi 17 novembre 2020 14:01:07 CET Daniel Mellergård wrote:
> > Hi,
> >
> > Is setting the environment variable PROJ_DEBUG=3 supposed to work when
> > using GDAL3.1.2? Running for example gdalsrsinfo with that environment
> > variable set has no effect, but running projinfo (from proj 6.3.2) does.
>
> As PROJ logging goes through GDAL one, you also need to enable
> CPL_DEBUG=ON
> (or CPL_DEBUG=PROJ to restrict to PROJ traces)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201118/e87edc1e/attachment-0001.html>

From momtchil at momtchev.com  Wed Nov 18 05:38:30 2020
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Wed, 18 Nov 2020 14:38:30 +0100
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <5036545.8Ig9jSVNDo@even-i700>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
 <1962786.iPBX4NNV7Y@even-i700>
 <CADPhZXxuoLix3HS8tDD5fAtNnwC692m0WWe3CjcadV=v8MP8jQ@mail.gmail.com>
 <5036545.8Ig9jSVNDo@even-i700>
Message-ID: <98548cf0-99cd-2f14-42ea-97cc6305b596@momtchev.com>


     Hello,


It seems that you have already decided, but just for your information, 
there is this page:

https://python3statement.org/

Maybe you can add GDAL too

2020 will be the year that most major packages will start dropping 
Python 2 support. 2018 was the year that most major distributions 
switched their default interpreters to Python 3.

On 16/11/2020 16:13, Even Rouault wrote:
> Sean,
>
>> It makes sense to me. I'm not aware of GDAL needing any features of Python
>> 3.7, so 3.6 sounds good.
>>
>> Since the project hasn't dropped support for a Python version in a long
>> time, maybe there should be a plan to warn in code
> Idan has a pull request in https://github.com/OSGeo/gdal/pull/3165 adding a
> deprecation warning if running a Python version that is known to be
> unsupported in the the next GDAL version. We should merge this in the 3.2
> branch too for 3.2.1
>
>> and make announcements on OSGeo lists?
> Would indeed makes sense to announce that in the release notes of 3.2.1 too
>
> Even
>
-- 
Momtchil Momtchev <momtchil at momtchev.com>


From jgr at osgeopt.pt  Thu Nov 19 08:11:37 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Thu, 19 Nov 2020 16:11:37 +0000
Subject: [gdal-dev] Geometry column name: Field 'OGR_GEOMETRY' not found in
	source layer
Message-ID: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>

Hi devs,

To get only the geometry column from a shapefile, I can do:

ogrinfo cidade.shp -sql "select OGR_GEOMETRY from cidade"

But this column name is not allowed in the -select option on ogr2ogr:

ogr2ogr -overwrite -skipfailures -update PG:service=estarreja cidade.shp
-select OGR_GEOMETRY

ERROR 1: Field 'OGR_GEOMETRY' not found in source layer.

Shouldn't OGR_GEOMETRY be allowed in -select?

Regards,

Jorge
-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/

From Jon.Morris at jbarisk.com  Thu Nov 19 09:06:37 2020
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Thu, 19 Nov 2020 17:06:37 +0000
Subject: [gdal-dev] GDAL conda build
In-Reply-To: <3669835d-de21-826d-9bd4-9c29b32f77d6@gatewaygeomatics.com>
References: <LO2P123MB1933C95C77822DCA0601EDB582E90@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <CAE8nN5M8K-YUC_P=0jVcxp=JS=c+UbVrHExU5Bn_+S-JN7XEsA@mail.gmail.com>
 <LO2P123MB1933909B982DE7A78387D34682E80@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <23195a7b-686e-3b67-4999-da88d2397d42@gatewaygeomatics.com>
 <LO2P123MB1933B166AACED1E57ADD737B82E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <15978e91-a378-8ee9-7009-f9e16008e506@gatewaygeomatics.com>
 <LO2P123MB1933683613FC15667A16E26682E20@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>
 <3669835d-de21-826d-9bd4-9c29b32f77d6@gatewaygeomatics.com>
Message-ID: <LO2P123MB193305608AB5BB36806748F882E00@LO2P123MB1933.GBRP123.PROD.OUTLOOK.COM>

Hi Jeff,

I've updated the wiki, adding a couple of sections about compiling GDAL 2.3+ (requires VC14+) and providing links to the conda recipes that I used. I hope they are useful to anyone else that needs FileGDB write support on Windows.
https://trac.osgeo.org/gdal/wiki/FileGDB

Thanks,

Jon


-----Original Message-----
From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
Sent: 17 November 2020 14:11
To: gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] GDAL conda build

Hi Jon,

No approval/funnel through one person for edits, you can just add your notes there, so others can follow them someday (and avoid list archive searching).  Over time maybe someone updates or enhances your notes, or not, that's how the wiki thrives.

Thanks for taking the time to do this, most do not (now I could use the exclamation mark here, ha)  :)

-jeff




--
Jeff McKenna
MapServer Consulting and Training Services co-founder of FOSS4G http://gatewaygeo.com/



On 2020-11-17 10:06 a.m., Jon Morris wrote:
> Hi Jeff,
>
> No problem, I can do that. Does it need to be approved, or do people just keep editing until we're all happy with it?
>
> Thanks,
>
> Jon
>
> -----Original Message-----
> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
> Sent: 17 November 2020 13:58
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL conda build
>
> Hi Jon,
>
> You can press edit and add a section with all of your own notes (everything you have written here in your emails to the list) to the bottom of that page, so that way you avoid the thinking of 'i must update the entire wiki page'.  (no exclamation point needed)
>
> thanks,
>
> -jeff
>
>
> --
> Jeff McKenna
> MapServer Consulting and Training Services co-founder of FOSS4G http://gatewaygeo.com/
>
>
>
>
> On 2020-11-17 7:33 a.m., Jon Morris wrote:
>> Hi Jeff,
>>
>> I don't feel I know enough about the process to start to update that page, as there is quite a lot of work to do!
>>
>> In the end the recipe at https://github.com/osgeo-forge/libgdal-filegdb-feedstock worked for me, with a couple of minor tweaks to remove some warnings from the log. Updating it to v3.2.0 was also straightforward, only the version and md5 need to be updated. Once this is built, the libgdal-filegdb package can be installed to an environment containing conda-forge GDAL and you now have full FileGDB write support.
>>
>> Thanks,
>>
>> Jon
>>
>> -----Original Message-----
>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Jeff McKenna
>> Sent: 16 November 2020 12:54
>> To: gdal-dev at lists.osgeo.org
>> Subject: Re: [gdal-dev] GDAL conda build
>>
>> On 2020-11-11 9:00 a.m., Jon Morris wrote:
>>> Hi Paul,
>>>
>>> Thanks for your reply. The only reason we're trying to build locally
>>> is to add FileGDB support - if there is a better way to add FileGDB
>>> write support to conda-forge GDAL, I'd love to hear it! The GDAL docs
>>> are very out of date when it comes to building on Windows - the "GDAL
>>> Windows Building example for Plugins" links to
>>> https://trac.osgeo.org/gdal/wiki/BuildingOnWindows
>>> <https://trac.osgeo.org/gdal/wiki/BuildingOnWindows>.
>>>
>>
>> Hi Jon,
>>
>> For 10+ years we maintained the FileGDB build steps for Windows etc at
>> https://trac.osgeo.org/gdal/wiki/FileGDB
>>
>> In general, as a person compiling GDAL, you should bookmark the
>> priceless "BuildHints" wiki page, see the "External Library" section
>> where various driver compile howtos are listed, at
>> https://trac.osgeo.org/gdal/wiki/BuildHints
>>
>> (you can see how for users compiling drivers that a wiki is a lifeline,
>> recording build steps that may be 5 years old and 'stale', yet
>> containing valuable information to the user)
>>
>> Please consider recording your steps as well, for other users, as you
>> travel down this path.
>>
>> Thanks!
>>
>> -jeff
>>
>>
>> --
>> Jeff McKenna
>> MapServer Consulting and Training Services
>> co-founder of FOSS4G
>> http://gatewaygeo.com/
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>> T +44 (0) 1756 799919
>> www.jbarisk.com<http://www.jbarisk.com>
>>
>> [Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
>> Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>
>>
>> The JBA Group supports the JBA Trust.
>>
>> All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
>> Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.
>>
>>
>> JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919
>>
>>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> [JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>
>

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org
https://lists.osgeo.org/mailman/listinfo/gdal-dev
[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

From even.rouault at spatialys.com  Thu Nov 19 10:27:49 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 19 Nov 2020 19:27:49 +0100
Subject: [gdal-dev] Geometry column name: Field 'OGR_GEOMETRY' not found
	in source layer
In-Reply-To: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>
References: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>
Message-ID: <2630222.OOPYzerPXk@even-i700>

Jorge,

> To get only the geometry column from a shapefile, I can do:
> 
> ogrinfo cidade.shp -sql "select OGR_GEOMETRY from cidade"

This is a bit a misnomer: OGR_GEOMETRY is a special keyword to get the 
geometry *type* of a geometry ("POLYGON", "POINT", "LINESTRING"), not the 
geometry itself. For that, for format such as shapefile which don't have a 
named geometry column, you must use the "_OGR_GEOMETRY_" (quoted with double 
quotes as starting with underscore)

> But this column name is not allowed in the -select option on ogr2ogr:
> 
> ogr2ogr -overwrite -skipfailures -update PG:service=estarreja cidade.shp
> -select OGR_GEOMETRY

you can use -sql here as well

Could perhaps make sense to support the special "_ogr_geometry_" field here 
too

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jgr at osgeopt.pt  Thu Nov 19 14:36:05 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Thu, 19 Nov 2020 22:36:05 +0000
Subject: [gdal-dev] Geometry column name: Field 'OGR_GEOMETRY' not found
 in source layer
In-Reply-To: <2630222.OOPYzerPXk@even-i700>
References: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>
 <2630222.OOPYzerPXk@even-i700>
Message-ID: <3d40abae-d7fd-31d5-606c-92ab2c4be803@osgeopt.pt>

Hi Even,

Thanks for the feedback. The difference you mentioned is well understood
with the example:

-sql 'select OGR_GEOMETRY, "_OGR_GEOMETRY_" from layer'

I get exactly what is expected from both fields:

POLYGON | POLYGON(...)
POLYGON | POLYGON(...)

It would be nice to allow "_OGR_GEOMETRY_" in ogr2ogr -select, but the
usage of -sql works.

To make the usage of this "_OGR_GEOMETRY_" more clear, may I add an
example to https://gdal.org/programs/ogrinfo.html?

I think this is not well documented. The only reference I used [1] is
not accurate anymore. It says:

"the special field names “OGR_GEOMETRY” and “OGR_STYLE” will be
interpreted to refer to the geometry and style values of a feature".

Regards,

Jorge

[1]
https://gdal.org/development/rfc/rfc29_desired_fields.html?highlight=ogr_geometry


Às 18:27 de 19/11/20, Even Rouault escreveu:
> Jorge,
> 
>> To get only the geometry column from a shapefile, I can do:
>>
>> ogrinfo cidade.shp -sql "select OGR_GEOMETRY from cidade"
> 
> This is a bit a misnomer: OGR_GEOMETRY is a special keyword to get the 
> geometry *type* of a geometry ("POLYGON", "POINT", "LINESTRING"), not the 
> geometry itself. For that, for format such as shapefile which don't have a 
> named geometry column, you must use the "_OGR_GEOMETRY_" (quoted with double 
> quotes as starting with underscore)
> 
>> But this column name is not allowed in the -select option on ogr2ogr:
>>
>> ogr2ogr -overwrite -skipfailures -update PG:service=estarreja cidade.shp
>> -select OGR_GEOMETRY
> 
> you can use -sql here as well
> 
> Could perhaps make sense to support the special "_ogr_geometry_" field here 
> too
> 
> Even
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/

From jgr at osgeopt.pt  Thu Nov 19 15:42:59 2020
From: jgr at osgeopt.pt (Jorge Gustavo Rocha)
Date: Thu, 19 Nov 2020 23:42:59 +0000
Subject: [gdal-dev] Geometry column name: Field 'OGR_GEOMETRY' not found
 in source layer
In-Reply-To: <3d40abae-d7fd-31d5-606c-92ab2c4be803@osgeopt.pt>
References: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>
 <2630222.OOPYzerPXk@even-i700>
 <3d40abae-d7fd-31d5-606c-92ab2c4be803@osgeopt.pt>
Message-ID: <44f73c0e-7f28-a892-9a80-c4d043f17f10@osgeopt.pt>

Hi,

Only now, based on Even's answer, I was able to find the proper
documentation. My fault! I was searching using uppercase and git grep
"_OGR_GEOMETRY_" was returning nothing.

Just an update regarding the documentation:

1) OGR_GEOMETRY is well documented at
https://gdal.org/user/ogr_sql_dialect.html#ogr-geometry

2) "_OGR_GEOMETRY_" is also pretty well documented in the same document,
at https://gdal.org/user/ogr_sql_dialect.html#geometry-field

3) As an alternative for all drivers, GEOMETRY field, used in SQL SQLite
dialect, is well documented at
https://gdal.org/user/sql_sqlite_dialect.html#geometry-field

Regards,

Jorge

Às 22:36 de 19/11/20, Jorge Gustavo Rocha escreveu:
> Hi Even,
> 
> Thanks for the feedback. The difference you mentioned is well understood
> with the example:
> 
> -sql 'select OGR_GEOMETRY, "_OGR_GEOMETRY_" from layer'
> 
> I get exactly what is expected from both fields:
> 
> POLYGON | POLYGON(...)
> POLYGON | POLYGON(...)
> 
> It would be nice to allow "_OGR_GEOMETRY_" in ogr2ogr -select, but the
> usage of -sql works.
> 
> To make the usage of this "_OGR_GEOMETRY_" more clear, may I add an
> example to https://gdal.org/programs/ogrinfo.html?
> 
> I think this is not well documented. The only reference I used [1] is
> not accurate anymore. It says:
> 
> "the special field names “OGR_GEOMETRY” and “OGR_STYLE” will be
> interpreted to refer to the geometry and style values of a feature".
> 
> Regards,
> 
> Jorge
> 
> [1]
> https://gdal.org/development/rfc/rfc29_desired_fields.html?highlight=ogr_geometry
> 
> 
> Às 18:27 de 19/11/20, Even Rouault escreveu:
>> Jorge,
>>
>>> To get only the geometry column from a shapefile, I can do:
>>>
>>> ogrinfo cidade.shp -sql "select OGR_GEOMETRY from cidade"
>>
>> This is a bit a misnomer: OGR_GEOMETRY is a special keyword to get the 
>> geometry *type* of a geometry ("POLYGON", "POINT", "LINESTRING"), not the 
>> geometry itself. For that, for format such as shapefile which don't have a 
>> named geometry column, you must use the "_OGR_GEOMETRY_" (quoted with double 
>> quotes as starting with underscore)
>>
>>> But this column name is not allowed in the -select option on ogr2ogr:
>>>
>>> ogr2ogr -overwrite -skipfailures -update PG:service=estarreja cidade.shp
>>> -select OGR_GEOMETRY
>>
>> you can use -sql here as well
>>
>> Could perhaps make sense to support the special "_ogr_geometry_" field here 
>> too
>>
>> Even
>>
> 

-- 
OSGeo Portugal
NIF: 509588190
email: geral at osgeopt.pt
https://www.osgeopt.pt/

Próximo evento: SASIG 2017, 20 a 22 de novembro, Porto
Mais informações: http://osgeopt.pt/sasig2017/

From even.rouault at spatialys.com  Thu Nov 19 16:02:06 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Nov 2020 01:02:06 +0100
Subject: [gdal-dev] Geometry column name: Field 'OGR_GEOMETRY' not found
	in source layer
In-Reply-To: <44f73c0e-7f28-a892-9a80-c4d043f17f10@osgeopt.pt>
References: <29360cd5-1301-7ab5-bd0b-693064428fd9@osgeopt.pt>
 <3d40abae-d7fd-31d5-606c-92ab2c4be803@osgeopt.pt>
 <44f73c0e-7f28-a892-9a80-c4d043f17f10@osgeopt.pt>
Message-ID: <1884955.L1gPqXcel5@even-i700>

On jeudi 19 novembre 2020 23:42:59 CET Jorge Gustavo Rocha wrote:
> Hi,
> 
> Only now, based on Even's answer, I was able to find the proper
> documentation. My fault! I was searching using uppercase and git grep
> "_OGR_GEOMETRY_" was returning nothing.
> 
> Just an update regarding the documentation:
> 
> 1) OGR_GEOMETRY is well documented at
> https://gdal.org/user/ogr_sql_dialect.html#ogr-geometry
> 
> 2) "_OGR_GEOMETRY_" is also pretty well documented in the same document,
> at https://gdal.org/user/ogr_sql_dialect.html#geometry-field

Jukka added that one just a few days ago

> 3) As an alternative for all drivers, GEOMETRY field, used in SQL SQLite
> dialect, is well documented at
> https://gdal.org/user/sql_sqlite_dialect.html#geometry-field

I've added in
https://gdal.org/programs/ogrinfo.html#cmdoption-ogrinfo-dialect
an hyperlink to the 2 above pages. Similarly for ogr2ogr

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nazitkk1375 at gmail.com  Fri Nov 20 05:44:16 2020
From: nazitkk1375 at gmail.com (Nazanin tavakoli)
Date: Fri, 20 Nov 2020 17:14:16 +0330
Subject: [gdal-dev] Convert HDF format to Netcdf
Message-ID: <CAPBJ=OzncdZVjXj9Dc70cHXOgon1R4QJ_v1kLX5DXkfvniSh_w@mail.gmail.com>

Hello,
Could anybody help me with this question? I am new to GDAL and I want to
know that how can I convert the HDF file of the MODIS satellite to NETCDF.
I would appreciate it if you answer my questions.
Thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/15e0b896/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Fri Nov 20 05:54:00 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Fri, 20 Nov 2020 10:54:00 -0300
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 14
In-Reply-To: <e3a8035b440d422bb9663c5f6e6cdf32@maanmittauslaitos.fi>
References: <e3a8035b440d422bb9663c5f6e6cdf32@maanmittauslaitos.fi>
Message-ID: <CAKTKyJKMbT4nzq19ZR6axg7wvn1YsmLDoHQqcN82WfcmT48kRg@mail.gmail.com>

Dear all,

I would like to open this discussion here about creating a xml/ raster wcs
ingest using gdal_translate.
My 2 goals are:
1 - get a xml like in [1] by running command line similar do gdal_wmts
driver in [2]

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
" wcs.xml -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -of WCS


2 - get a xml / raster subset

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
" wcs.xml -projwin -100 40 -80 30 -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -projwin -100 40 -80 30 -of WCS

If the solution I am trying to get can not be possible through
gdal_translate, would someone have a xml sample  like [1], but with raster
subset ingest, instead the whole image content.

I appreciated your time in advance.

Kind regards

Julierme

[1] <WCS_GDAL>
  <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
;</ServiceURL>
  <CoverageName>nurc:Img_Sample</CoverageName>

<GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
</WCS_GDAL>

[2] gdal_translate "WMTS:
http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -
of WMTS.




On Tue, Nov 10, 2020 at 6:18 PM Rahkonen Jukka (MML) <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
>
>
> Sorry for the -spat that belongs to ogr2ogr. In gdal_translate it is
> -projwin.
>
>
>
> The WMTS documentation is not relevant for the GDAL WCS driver. Most that
> they have in common is that they create a xml file for storing info about
> the capabilities of the service.  The WCS documentation alone should be
> enough for using the WCS driver, even I have to admit that I do not
> understand it totally, for example when it comes to cache control commands.
> Fortunately documentation can be improved.
>
>
>
> Using WCS with GDAL is meant to be easy but unfortunately it seems to me
> that something is broken with it with some WCS services. It should be this
> easy to use:
>
>
>
>    1. Read general capabilities, including the names of the coverages.
>    Example
>
>
>
> gdalinfo "WCS:http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1"
>
>
>
> The result contain the names of the subdatasets (coverages) as the WCS
> driver understands them
>
> Subdatasets:
>
>   SUBDATASET_1_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Arc_Sample
>
>   SUBDATASET_2_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__GRAY_HR_SR_OB_DR
>
>   SUBDATASET_3_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__HYP_HR_SR_OB_DR
>
>   SUBDATASET_4_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sde__NE2_HR_LC_SR_W_DR
>
>   SUBDATASET_5_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
>
>   SUBDATASET_6_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__black_marble
>
>   SUBDATASET_7_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__g30
>
>   SUBDATASET_8_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__mosaic
>
>   SUBDATASET_9_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sf__sfdem
>
>   SUBDATASET_10_NAME=WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=geosolutions__truemarble
>
>
>
>    1. Select one coverage and read more metadata about that, again with
>    gdalinfo. This step fails now with my GDAL 3.2. Here some debug info that
>    shows that GDAL is generating a bbox/subset with lower limit = higher limit
>    when it tries to read a small sample of the coverage. Geoserver does not
>    accept the request and gives an error about an empty subset.
>
>
>
> gdalinfo "WCS:
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__mosaic"
> --debug on
>
> …
>
> WCS: Requesting
> http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=DescribeCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&FORMAT=text/xml
>
> HTTP: Fetch(
> http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=DescribeCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&FORMAT=text/xml
> )
>
> HTTP: libcurl/7.70.0-DEV OpenSSL/1.1.1g zlib/1.2.3
>
> WCS: Requesting
> http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long%286.3953399152693953,6.3953399152693953%29&SUBSET=Lat%2846.541601968340089,46.541601968340089%29&Format=image/tiff
>
> HTTP: Fetch(
> http://demo.geo-solutions.it/geoserver/wcs?SERVICE=WCS&REQUEST=GetCoverage&VERSION=2.0.1&COVERAGEID=nurc__mosaic&SUBSET=Long%286.3953399152693953,6.3953399152693953%29&SUBSET=Lat%2846.541601968340089,46.541601968340089%29&Format=image/tiff
> )
>
> ERROR 1: HTTP error code : 404
>
> ERROR 1: InvalidSubsetting: Empty intersection after subsetting
>
>
>
>    1. The third step would be to use gdal_translate with -projwin option
>    and get coverage from the given area. Now gdal_translate is also making a
>    probing request by min=max extents and it fails.
>
>
>
> However, the example request on the WCS document page that reads data from
> the National Land Survey of Finland  works.
>
>
>
> gdal_translate -oo CACHE=wcs_cache -oo CLEAR_CACHE -oo INTERLEAVE=PIXEL
> -projwin 377418 6683393.87938218 377717.879386966 6683094 -oo
> Subset="time(1985-01-01T00:00:00.000Z)" -outsize 60 0 "WCS:
> https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva"
> scaled.tiff
>
>
>
> gdalinfo works as well
>
> gdalinfo "WCS:
> https://beta-karttakuva.maanmittauslaitos.fi/wcs/service/ows?version=2.0.1&coverage=ortokuva__ortokuva
> "
>
>
>
> -Jukka Rahkonen-
>
>
>
>
>
> *Lähettäjä:* 1520 gis <juliermeopensourcedeveloper at gmail.com>
> *Lähetetty:* tiistai 10. marraskuuta 2020 18.10
> *Vastaanottaja:* gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <
> jukka.rahkonen at maanmittauslaitos.fi>
> *Aihe:* Re: gdal-dev Digest, Vol 198, Issue 14
>
>
>
> Dear Jukka Rahkonen,
>
>
>
> Thank you very much for your reply.
>
>
>
> First of all, my apologies for my lack of knowledge about using GDAL_WCS
> driver. Let me give more details about the issues I am facing.
>
>
>
> Extract of
> http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities is
> shown in [1].
>
>
>
> Regarding gdal_translate GDAL_WCS driver Image subset extract, looking at
> https://gdal.org/drivers/raster/wcs.html#examples, I tried the following:
>
>
>
> Similar to GDAL_WMTS <gdal_translate "WMTS:
> http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts*.*
> xml *-*of WMTS>,
>
> I tried running:
>
> (1)
>
>  gdal_translate "WCS:
> http://172.21.14.45:8181/geoserver/wcs?version=2.0.1&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
> CBERS-4_AWFI_170_111_21052020.xml
>
>
>
> *The response:* I did not get the xml as wmts.xml showed above
>
>
>
> Note: Including the -of option (WCS), the outcome fails
>
>
>
> (2)
>
> gdal_translate "WCS:
> http://172.21.14.45:8181/geoserver/ows/wcs?request=GetCapabilities&coverage=deter-amazonia__CBERS-4_AWFI_170_111_21052020"
> \
> -spat -58 -11 -57.75 -10.7 \
> CBERS-4_AWFI_170_111_21052020.xml
>
>
>
> *The response:* There is no -spat option for gdal_translate
>
>
>
> *gdal_translate --help*
>
>
>
> Usage: gdal_translate [--help-general] [--long-usage]
>        [-ot {Byte/Int16/UInt16/UInt32/Int32/Float32/Float64/
>              CInt16/CInt32/CFloat32/CFloat64}] [-strict]
>        [-of format] [-b band] [-mask band] [-expand {gray|rgb|rgba}]
>        [-outsize xsize[%]|0 ysize[%]|0] [-tr xres yres]
>        [-r {nearest,bilinear,cubic,cubicspline,lanczos,average,mode}]
>        [-unscale] [-scale[_bn] [src_min src_max [dst_min dst_max]]]*
> [-exponent[_bn] exp_val]*
>        [-srcwin xoff yoff xsize ysize] [-epo] [-eco]
>        [-projwin ulx uly lrx lry] [-projwin_srs srs_def]
>        [-a_srs srs_def] [-a_ullr ulx uly lrx lry] [-a_nodata value]
>        [-a_scale value] [-a_offset value]
>        [-nogcp] [-gcp pixel line easting northing [elevation]]*
>        |-colorinterp{_bn} {red|green|blue|alpha|gray|undefined}]
>        |-colorinterp {red|green|blue|alpha|gray|undefined},...]
>        [-mo "META-TAG=VALUE"]* [-q] [-sds]
>        [-co "NAME=VALUE"]* [-stats] [-norat]
>        [-oo NAME=VALUE]*
>        src_dataset dst_dataset
>
>
>
>
>
>
>
> [1] WCS GetCapabilities request
>
>
>
> <wcs:CoverageSummary>
>
> <ows:Title>CBERS-4_AWFI_170_111_21052020</ows:Title>
>
> <ows:Abstract>Generated from GeoTIFF</ows:Abstract>
>
> <ows:Keywords>
>
> <ows:Keyword>deter-amazonia-CBERS-4_AWFI_170_111_21052020</ows:Keyword>
>
> <ows:Keyword>WCS</ows:Keyword>
>
> <ows:Keyword>GeoTIFF</ows:Keyword>
>
> </ows:Keywords>
>
> <wcs:CoverageId>deter-amazonia__CBERS-4_AWFI_170_111_21052020
> </wcs:CoverageId>
>
> <wcs:CoverageSubtype>RectifiedGridCoverage</wcs:CoverageSubtype>
>
> <ows:WGS84BoundingBox>
>
> <ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
>
> <ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
>
> </ows:WGS84BoundingBox>
>
> <ows:BoundingBox crs="http://www.opengis.net/def/crs/EPSG/0/EPSG:4326">
>
> <ows:LowerCorner>-63.280290728152664 -13.794296142085976</ows:LowerCorner>
>
> <ows:UpperCorner>-53.624004749255874 -5.636644661059637</ows:UpperCorner>
>
> </ows:BoundingBox>
>
> </wcs:CoverageSummary>
>
>
>
>
>
> Any comment will be very appreciated.
>
>
>
> GDAL website <https://gdal.org/drivers/raster/wmts.html> provides
> examples on how to run GDAL_WMTS driver in order to get a wmts xml file. I
> have looked in https://gdal.org/drivers/raster/wcs.html and could not
> find an example pointing to -spat option.  I got an -spat option
>
> to gdal_grid
> <https://gdal.org/programs/gdal_grid.html?highlight=spat#cmdoption-gdal_grid-spat>
> though.
>
> gdal_translate "WMTS:http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts*.*xml *-*of WMTS
>
> gdal_translate "WCS:http://www.dpi.inpe.br/fipcerrado-geoserver/ows/wcs?request=GetCapabilities" \
>
> -oo CoverageName=deter-cerrado:CBERS-4_AWFI_161_099_13072018 CBERS-4_AWFI_161_099_13072018.xml -of WCS
>
>
>
>
>
> On Mon, Nov 9, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org> wrote:
>
> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. Re: Selecting just the geometry column with OGR SQL (Even Rouault)
>    2. Re: Selecting just the geometry column with OGR SQL
>       (Rahkonen Jukka (MML))
>    3. Re: WCS_GDAL Driver Image SubSet Request (jratike80)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 09 Nov 2020 16:09:45 +0100
> From: Even Rouault <even.rouault at spatialys.com>
> To: gdal-dev at lists.osgeo.org
> Cc: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
> Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
>         SQL
> Message-ID: <1659214.2tRo4lr4Oo at even-i700>
> Content-Type: text/plain; charset="us-ascii"
>
> Jukka,
>
> > I believe that OGR SQL dialect adds the geometry column into SQL
> selection
> > by default. Am I right with this? I volunteer to edit the documentation
> > https://gdal.org/user/ogr_sql_dialect.html if this is the case. But
> what I
> > can't understand is another side of the story, how to select just the
> > geometry field with OGR SQL dialect from some data sources.
> >
> > This command returns both time column and geometry from GML
> > ogrinfo -sql "select time from timetest" timetest.gml
> > I can select just the geometry from geometry column named as
> > "geometryProperty" by ogrinfo -sql "select geometryProperty from
> timetest"
> > timetest.gml
> >
> > The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> > Geometry is selected automatically but it can be selected also by name.
> But
> > I cannot discover any way to select just the geometry field from
> shapefile.
> > Is it because geometry column in shapefile does not have any name as this
> > Python test seems to prove?
> > >>> from osgeo import ogr
> > >>> shp_ds = ogr.Open('timetest.shp')
> > >>> shp_lyr = shp_ds.GetLayer(0)
> > >>> shp_lyr.GetGeometryColumn()
> >
> > ''
> >
> > OpenJUMP JML driver does not report a name for geometry column either.
> Is it
> > rather an exception that drivers give names for the geometry columns? I
> > know I can select only the geometry column with the SQLite dialect, but I
> > am curious.
>
> Indeed, in OGR SQL, if the geometry column has a non-empty name (typically
> for
> database drivers), you can use it to select it. When the geometry column
> name
> is empty, such as in the shapefile or OpenJUMP driver, you can use
> _ogr_geometry_ (with leading and trainling underscore) to select it. This
> is
> likely undocumented.
>
> As far as I can see, this was introduced per
>
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> to fix an issue with comparison with empty string literals (this was
> before
> OGR enforced the difference between single-quoted string literals and
> double-
> quoted identifiers)
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 9 Nov 2020 15:35:11 +0000
> From: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
> To: Even Rouault <even.rouault at spatialys.com>,
>         "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] Selecting just the geometry column with OGR
>         SQL
> Message-ID: <d59795ddfd994dee9f5eca836361324a at maanmittauslaitos.fi>
> Content-Type: text/plain; charset="us-ascii"
>
> Even Rouault wrote:
> maanantai 9. marraskuuta 2020 17.10
>
> > Jukka,
>
> >> I believe that OGR SQL dialect adds the geometry column into SQL
> >> selection by default. Am I right with this? I volunteer to edit the
> >> documentation https://gdal.org/user/ogr_sql_dialect.html if this is
> >> the case. But what I can't understand is another side of the story,
> >> how to select just the geometry field with OGR SQL dialect from some
> data sources.
> >>
> >> This command returns both time column and geometry from GML ogrinfo
> >> -sql "select time from timetest" timetest.gml I can select just the
> >> geometry from geometry column named as "geometryProperty" by ogrinfo
> >> -sql "select geometryProperty from timetest"
> >> timetest.gml
> >>
> >> The behavior is the same with SpatiaLite when I use "-dialect OGRSQL".
> >> Geometry is selected automatically but it can be selected also by
> >> name. But I cannot discover any way to select just the geometry field
> from shapefile.
> >> Is it because geometry column in shapefile does not have any name as
> >> this Python test seems to prove?
> >> >>> from osgeo import ogr
> >> >>> shp_ds = ogr.Open('timetest.shp')
> >> >>> shp_lyr = shp_ds.GetLayer(0)
> >> >>> shp_lyr.GetGeometryColumn()
> >>
> >> ''
> >>
> >> OpenJUMP JML driver does not report a name for geometry column either.
> >> Is it rather an exception that drivers give names for the geometry
> >> columns? I know I can select only the geometry column with the SQLite
> >> dialect, but I am curious.
>
> > Indeed, in OGR SQL, if the geometry column has a nonempty name
> (typically for
> > database drivers), you can use it to select it. When the geometry column
> name
> > is empty, such as in the shapefile or OpenJUMP driver, you can use
> > _ogr_geometry_ (with leading and trainling underscore) to select it.
> This is likely undocumented.
>
> > As far as I can see, this was introduced per
> >
> https://github.com/OSGeo/gdal/commit/1519dcb00bd7802d2f701114f0e1cb9b524a547f
> > to fix an issue with comparison with empty string literals (this was
> before OGR enforced the
> >  difference between single-quoted string literals and double- quoted
> identifiers)
>
> I could not manage to guess the right syntax for Windows right ahead but
> solved the quiz easily
> with your double-quote hint
>
> First trial:
> ogrinfo -sql "select _ogr_geometry_ from timetest" timetest.shp
> INFO: Open of `timetest.shp'
>       using driver `ESRI Shapefile' successful.
> ERROR 1: SQL Expression Parsing Error: syntax error, unexpected
> $undefined. Occurred around :
> select _ogr_geometry_ from timetest
>
> Second trial:
> ogrinfo -sql "select \"_ogr_geometry_\" from timetest" timetest.shp
>
> -Jukka-
>
> > Even
>
> --
> Spatialys - Geospatial professional services http://www.spatialys.com
>
>
> ------------------------------
>
> Message: 3
> Date: Mon, 9 Nov 2020 08:47:05 -0700 (MST)
> From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] WCS_GDAL Driver Image SubSet Request
> Message-ID: <1604936825138-0.post at n6.nabble.com>
> Content-Type: text/plain; charset=us-ascii
>
> Hi,
>
> Do you want to make is somehow impossible to request data beyound the
> BoundingBox that you defined in the XML file? If you just want to get data
> from the rectangle that you or your users define, gdal_translate with the
> regular -spat option should work out-of-the-box.
>
> -Jukka Rahkonen-
>
>
> juliermeopensourcedeveloper wrote
> > Hi all,
> >
> > Is it possible to define a bounding box in order to request a coverage
> > subset using the GDAL WCS Driver?
> > I have tried the code in [1]. I  am trying to get information only for
> the
> > bbox_interest=( -58,-11,-57.75,-10.75) as shown below, however the subset
> > image or bbox_interest request has not been delivered. The West Longitude
> > reaches -50.17 and The Lower Latitude reaches -18.92 which are limits out
> > of the bbox_interest.
> > The image extent is:
> > <GetCoverageExtra>
> >
> &amp;BoundingBox=-63.280290728152664,-13.794296142085976,-53.624004749255874,-5.636644661059637
> > </GetCoverageExtra>
> >  Any comment on this issue will be greatly appreciated.
> > Thank you very much for your time in advance.
> > *CODE [1]:*
> > <WCS_GDAL>
> > <ServiceURL>
> > http://172.21.14.45:6060/geoserver/wcs?version=1.0.0&amp;
> > </
> > ServiceURL>
> > <CoverageName>
> > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> > </
> > CoverageName>
> > <GetCoverageExtra>
> > &amp;BoundingBox=-58,-11,-57.75,-10.75
> > </GetCoverageExtra>
> > <CoverageOffering>
> > <description>
> > Generated from GeoTIFF
> > </description>
> > <name>
> > cbers_deter_amazonia:CBERS-4_AWFI_170_111_21052020
> > </name>
> > <label>
> > CBERS-4_AWFI_170_111_21052020
> > </label>
> > <lonLatEnvelope srsName="urn:ogc:def:crs:OGC:1.3:CRS84">
> > <pos>
> > -58 -11
> > </pos>
> > <pos>
> > -57.75 -10.75
> > </pos>
> > </lonLatEnvelope>
> > <keywords>
> > <keyword>
> > WCS
> > </keyword>
> > <keyword>
> > GeoTIFF
> > </keyword>
> > </keywords>
> > <domainSet>
> > <spatialDomain>
> > <Envelope srsName="EPSG:4326">
> > <pos>
> > -58 -11
> > </pos>
> > <pos>
> > -57.75 -10.75
> > </pos>
> > </Envelope>
> > <RectifiedGrid dimension="2" srsName="EPSG:4326">
> > <limits>
> > <GridEnvelope>
> > <low>
> > 0 0
> > </low>
> > <high>
> > 0 0
> > </high>
> > </GridEnvelope>
> > </limits>
> > <axisName>
> > x
> > </axisName>
> > <axisName>
> > y
> > </axisName>
> > <origin>
> > <pos>
> > -58 -10.75
> > </pos>
> > </origin>
> > <offsetVector>
> > 0.005364603321609328 0.0
> > </offsetVector>
> > <offsetVector>
> > 0.0 -0.004532028600570188
> > </offsetVector>
> > </RectifiedGrid>
> > </spatialDomain>
> > </domainSet>
> > <rangeSet>
> > <RangeSet>
> > <name>
> > CBERS-4_AWFI_170_111_21052020
> > </name>
> > <label>
> > CBERS-4_AWFI_170_111_21052020
> > </label>
> > <axisDescription>
> > <AxisDescription>
> > <name>
> > Band
> > </name>
> > <label>
> > Band
> > </label>
> > <values>
> > <interval>
> > <min>
> > 1
> > </min>
> > <max>
> > 4
> > </max>
> > </interval>
> > </values>
> > </AxisDescription>
> > </axisDescription>
> > </RangeSet>
> > </rangeSet>
> > <supportedCRSs>
> > <requestResponseCRSs>
> > EPSG:4326
> > </requestResponseCRSs>
> > </supportedCRSs>
> > <supportedFormats nativeFormat="GeoTIFF">
> > <formats>
> > GeoTIFF
> > </formats>
> > <formats>
> > GIF
> > </formats>
> > <formats>
> > JPEG
> > </formats>
> > <formats>
> > PNG
> > </formats>
> > <formats>
> > TIFF
> > </formats>
> > </supportedFormats>
> > <supportedInterpolations default="nearest neighbor">
> > <interpolationMethod>
> > nearest neighbor
> > </interpolationMethod>
> > <interpolationMethod>
> > bilinear
> > </interpolationMethod>
> > <interpolationMethod>
> > bicubic
> > </interpolationMethod>
> > </supportedInterpolations>
> > </CoverageOffering>
> > <PreferredFormat>
> > GeoTIFF
> > </PreferredFormat>
> > <BandCount>
> > 4
> > </BandCount>
> > <BandType>
> > Byte
> > </BandType>
> > </WCS_GDAL>
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 198, Issue 14
> *****************************************
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/193e6990/attachment-0001.html>

From dmiller at JFTI.com  Fri Nov 20 06:28:13 2020
From: dmiller at JFTI.com (Miller, Doug)
Date: Fri, 20 Nov 2020 14:28:13 +0000
Subject: [gdal-dev] Mapbox Vector Tiles Driver
Message-ID: <cba84e485acf450f85b312467ff04a4d@JFTI.com>

How does the Mapbox Vector Tiles Driver take into account styles (i.e. style.json) when reading?

From even.rouault at spatialys.com  Fri Nov 20 07:14:37 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Nov 2020 16:14:37 +0100
Subject: [gdal-dev] Migration of Travis-CI jobs to GitHub actions & Python
 >= 3.6
Message-ID: <18264233.C7t24f1zXA@even-i700>

Hi,

I've worked this week on migrating most of our Travis-CI jobs to GitHub 
actions.

Travis-CI future doesn't seem very promising IMHO, due to the way they behave 
commercially. They have recently changed their conditions, mostly for people 
using their free offer, but that affects even GDAL despite OSGeo having a paid 
subscription to them. After next June, we won't be able to get the 
same quality of service we have currently without paying at least 3 times more 
(and maybe much more), or we'd have to choose an offer with less concurrent 
workers (5 instead of 10 currently).

So I've moved Travis CI configs to github actions (dropping a few no longer 
relevant ones). The builds are now done in standard Docker images (Ubuntu 
ones) instead of the one provided by the CI provider, so it should make it 
easier to move to another CI if/when GHA will try to monetize us, and more 
importantly it's much easier to replicate a CI job locally for debugging.

For example to run the ubuntu:18.04 job, from the top of a GDAL worktree (use 
a dedicated git worktree since that will modify your tree in the host 
environment)

docker run --rm -it --privileged=true -e WORK_DIR="$PWD" -v $PWD:$PWD \
	-v /var/run/docker.sock:/var/run/docker.sock \
	ubuntu:18.04 /bin/bash

and inside the container:
$WORK_DIR/github/workflows/ubuntu_18.04/start.sh

(that one needs priviledged docker, since it run docker containers inside 
docker)

The only remaining Travis-CI job is the s390x one, that has no equivalent in 
GHA. OSGeo might perhaps just subscribe to the base 1-concurrent job tier to 
keep that one.

When moving & updating the jobs, I've also updated to Python >= 3.6 for, 
hopefully, all targets that didn't meet this yet. So we should be good to go 
for RFC 77

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Nov 20 08:24:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 20 Nov 2020 17:24:26 +0100
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor of
 Python 3.6
Message-ID: <11181981.oemj7CW2LR@even-i700>

Hi,

given the positive feedback of the discussion phase, and since our CI is now 
ready for it, I motion to adopt

RFC 77: Drop Python 2 support in favor of Python 3.6
https://github.com/OSGeo/gdal/pull/3142

Starting with my +1

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From howard at hobu.co  Fri Nov 20 08:25:23 2020
From: howard at hobu.co (Howard Butler)
Date: Fri, 20 Nov 2020 10:25:23 -0600
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor
 of Python 3.6
In-Reply-To: <11181981.oemj7CW2LR@even-i700>
References: <11181981.oemj7CW2LR@even-i700>
Message-ID: <19311FCB-349F-4C03-B6D9-D0A2F5A12267@hobu.co>



> On Nov 20, 2020, at 10:24 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> given the positive feedback of the discussion phase, and since our CI is now 
> ready for it, I motion to adopt
> 
> RFC 77: Drop Python 2 support in favor of Python 3.6
> https://github.com/OSGeo/gdal/pull/3142
> 
> Starting with my +1

+2

Howard

From howard at hobu.co  Fri Nov 20 08:29:32 2020
From: howard at hobu.co (Howard Butler)
Date: Fri, 20 Nov 2020 10:29:32 -0600
Subject: [gdal-dev] Migration of Travis-CI jobs to GitHub actions &
 Python >= 3.6
In-Reply-To: <18264233.C7t24f1zXA@even-i700>
References: <18264233.C7t24f1zXA@even-i700>
Message-ID: <A85D6768-D96A-47BD-88A6-8C830445AF8B@hobu.co>



> On Nov 20, 2020, at 9:14 AM, Even Rouault <even.rouault at spatialys.com> wrote:
> 
> Hi,
> 
> I've worked this week on migrating most of our Travis-CI jobs to GitHub 
> actions.
> 

Thank you. 

Github Actions is better in some ways and worse in others in comparison to Travis CI, but one thing it does very well is allow the CI to be everyone's responsibility. When you fork the repository, you can run GHAs in your fork, update them as necessary, and manage them like any other piece of code infrastructure in the project. This property improves the project's CI bus number, and I hope GDAL takes advantage of that.

Howard




From schwehr at gmail.com  Fri Nov 20 08:45:21 2020
From: schwehr at gmail.com (Kurt Schwehr)
Date: Fri, 20 Nov 2020 08:45:21 -0800
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor
 of Python 3.6
In-Reply-To: <19311FCB-349F-4C03-B6D9-D0A2F5A12267@hobu.co>
References: <11181981.oemj7CW2LR@even-i700>
 <19311FCB-349F-4C03-B6D9-D0A2F5A12267@hobu.co>
Message-ID: <CACmBxyvk+6Q0qAWTRogv4YXjx4-5K-pWFR0eWtaVczkb2cWxKw@mail.gmail.com>

+1 KurtS

On Fri, Nov 20, 2020, 8:25 AM Howard Butler <howard at hobu.co> wrote:

>
>
> > On Nov 20, 2020, at 10:24 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Hi,
> >
> > given the positive feedback of the discussion phase, and since our CI is
> now
> > ready for it, I motion to adopt
> >
> > RFC 77: Drop Python 2 support in favor of Python 3.6
> > https://github.com/OSGeo/gdal/pull/3142
> >
> > Starting with my +1
>
> +2
>
> Howard
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/f23c4183/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Fri Nov 20 12:18:30 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Fri, 20 Nov 2020 17:18:30 -0300
Subject: [gdal-dev] GDAL_WCS Driver and gdal_translate
Message-ID: <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=54wc8f1nnh5fZ7REm7A@mail.gmail.com>

Dear all,

I would like to open this discussion here about creating a xml/ raster wcs
ingest using gdal_translate.
My 2 goals are:
1 - get a xml like in [1] by running command line similar do gdal_wmts
driver in [2]

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
<http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample>
" wcs.xml -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -of WCS


2 - get a xml / raster subset

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
<http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample>
" wcs.xml -projwin -100 40 -80 30 -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -projwin -100 40 -80 30 -of WCS

If the solution I am trying to get can not be possible through
gdal_translate, would someone have an xml sample like in [1] to share, but
with raster subset ingest, instead the whole image content?

I appreciated your time in advance.

Kind regards

Julierme

[1] <WCS_GDAL>
  <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
;</ServiceURL>
  <CoverageName>nurc:Img_Sample</CoverageName>

<GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
</WCS_GDAL>

[2] gdal_translate "WMTS:
http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -
of WMTS.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/ca9ab931/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sat Nov 21 02:47:58 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sat, 21 Nov 2020 03:47:58 -0700 (MST)
Subject: [gdal-dev] GDAL_WCS Driver and gdal_translate
In-Reply-To: <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=54wc8f1nnh5fZ7REm7A@mail.gmail.com>
References: <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=54wc8f1nnh5fZ7REm7A@mail.gmail.com>
Message-ID: <1605955678597-0.post@n6.nabble.com>

Hi,

Just a note to remind that earlier in thread "gdal-dev Digest, Vol 198,
Issue 14" it was noticed that the GDAL WCS driver most probably has a bug
and certain WCS coverages from Geoserver do not work. It seems to be related
with the native CRS EPSG:4326. So if you test now with Geoserver, don't test
with nurc__Img_Sample or other coverages which are in EPSG:4326.

I know this does not answer your question, sorry.

-Jukka Rahkonen-


juliermeopensourcedeveloper wrote
> Dear all,
> 
> I would like to open this discussion here about creating a xml/ raster wcs
> ingest using gdal_translate.
> My 2 goals are:
> 1 - get a xml like in [1] by running command line similar do gdal_wmts
> driver in [2]
> 
> gdal_translate "WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> &lt;http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt;
> " wcs.xml -of WCS
> 
> *OR*
> 
> gdal_translate "WCS:
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -of WCS
> 
> 
> 2 - get a xml / raster subset
> 
> gdal_translate "WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> &lt;http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt;
> " wcs.xml -projwin -100 40 -80 30 -of WCS
> 
> *OR*
> 
> gdal_translate "WCS:
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -projwin -100 40 -80 30 -of WCS
> 
> If the solution I am trying to get can not be possible through
> gdal_translate, would someone have an xml sample like in [1] to share, but
> with raster subset ingest, instead the whole image content?
> 
> I appreciated your time in advance.
> 
> Kind regards
> 
> Julierme
> 
> [1] 
> <WCS_GDAL>
>   
> <ServiceURL>
> https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> ;
> </ServiceURL>
>   
> <CoverageName>
> nurc:Img_Sample
> </CoverageName>
> 
> <GetCoverageExtra>
> &amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141
> </GetCoverageExtra>
> </WCS_GDAL>
> [2] gdal_translate "WMTS:
> http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml
> -
> of WMTS.
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From cvfrank at gmail.com  Sat Nov 21 06:59:01 2020
From: cvfrank at gmail.com (Franco Amato)
Date: Sat, 21 Nov 2020 09:59:01 -0500
Subject: [gdal-dev] Automatic labels placement
Message-ID: <CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw@mail.gmail.com>

Good morning gdal members,
I would know if you know any automatic labels placement library. I tried
with PAL library located here (http://pal.heig-vd.ch) but it's too complex
to use with GDAL data.

Any suggestions are really appreciated.

Thank you,
Franco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c0a10346/attachment.html>

From nazitkk1375 at gmail.com  Sat Nov 21 07:17:18 2020
From: nazitkk1375 at gmail.com (Nazanin tavakoli)
Date: Sat, 21 Nov 2020 18:47:18 +0330
Subject: [gdal-dev] resampling netcdf data
Message-ID: <CAPBJ=OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ@mail.gmail.com>

Hello,
I want to change the resolution of my data whose resolution is 0.0416
degrees (1/24th) resolution and I want to convert it to 0.5 degrees. I have
already used this code but I have some errors. Could you please help me?
gdal_translate -of netCDF -tr 0.5 0.5 WS.nc
<https://www.youtube.com/redirect?redir_token=QUFFLUhqa0hCWkdnLUttTmVYbzh4UGFIeW9RQTBxa2piUXxBQ3Jtc0trMTVQTV9YMVVrZWVzb2xXVjh1LVBCQ2ZoT3FoTzNKYjQ2NndBcmIxQVd2TkM3NXU3dUVjQ2FtMXFkOWdRSi1vdTVISnd6UEpsZWRDRVlLSDlzZDJlcGdqdlU5S0xyOXhXSlFSajliMG1URkhrWi1iMA%3D%3D&event=comments&q=http%3A%2F%2Fws.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy>
WS_1.nc
<https://www.youtube.com/redirect?redir_token=QUFFLUhqbEYxWEQxZzZpbVZSNGk2RjZHUnVUdEVNNEpZd3xBQ3Jtc0ttNzZDcUdxdUN6QU5vc1lKVmdULVFqLWo1WDdjendJbXJwcm03a3R2bWN6dnRlaWM1bENzUXhFNnp2NlN6b2x6Q0V3X21ueFdBNm5HVmQzaEVsZ0FKWGNZNEZSSk9GdDdmbVFwY2JKX1RuUjk0TTJTUQ%3D%3D&event=comments&q=http%3A%2F%2F1.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy>
Warning 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid
argument".
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute Input file size is
8640, 4320 0Warning 1: Recode from UTF-8 to CP_ACP failed with the error:
"Invalid argument". ...10...20...30...40...50...60...70...80...90..Warning
1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid argument".
.100 - done.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c8ee3be9/attachment.html>

From idan at miara.com  Sun Nov 22 05:36:29 2020
From: idan at miara.com (Idan Miara)
Date: Sun, 22 Nov 2020 15:36:29 +0200
Subject: [gdal-dev] Call for discussion on RFC77 Drop Python 2 support
In-Reply-To: <C83935C9-7BBD-4C16-A18C-8CC2803139E4@hobu.co>
References: <CAEDrt3_mrKrO3rZE=J93OrkabsMOHY0K3SqrQCfE0NuDRcFpOA@mail.gmail.com>
 <1962786.iPBX4NNV7Y@even-i700> <C83935C9-7BBD-4C16-A18C-8CC2803139E4@hobu.co>
Message-ID: <CAEDrt39U_VQmP20wFkttshkcr52gA=tJjBSXc=GTmfkzUz5NKw@mail.gmail.com>

Hi Howard,

Thanks for your comments!
I have some PRs that I work on and I want to get merged before I can
consider promoting other efforts :)
(and I really hope this RFC would pass so I won't need to backport them to
Python2 in order to get them merged...)

Idan

On Tue, 17 Nov 2020, 23:09 Howard Butler, <howard at hobu.co> wrote:

> LGTM. Thanks for the RFC and PRs.
>
> Can I convince Idan to also write an RFC to move all of the swig-generated
> bindings out of the main tree and into their own project? :)
>
> I'm half-serious, and I know this would represent real disruption. I also
> know Even is not so enthused about such an effort, but GDAL's bindings
> packaging is a distribution anti-pattern in just about every language
> supported at this point. The bindings that are not actually used can either
> fall away or acquire an active maintainer, and the opportunity for the
> bindings to evolve at a pace that at least keeps up with language-specific
> coming and goings would be possible.
>
> Howard
>
>
>
>
> > On Nov 15, 2020, at 8:39 AM, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > Hi,
> >
> > any comment on this before we put it to vote ?
> >
> > Even
> >
> >> Hi All,
> >>
> >> I would like to call for discussion on RFC77 Drop Python 2 support
> >> <
> https://github.com/talos-gis/gdal/blob/Branch_rfc_drop_python2/gdal/doc/sou
> >> rce/development/rfc/rfc77_drop_python2_support.rst> .
> >> Please give your feedback on this PR.
> >> <https://github.com/OSGeo/gdal/pull/3142>
> >>
> >> Kind regards,
> >> Idan Miara
> >
> >
> > --
> > Spatialys - Geospatial professional services
> > http://www.spatialys.com
> > _______________________________________________
> > gdal-dev mailing list
> > gdal-dev at lists.osgeo.org
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201122/1ce8c507/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Sun Nov 22 13:18:54 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Sun, 22 Nov 2020 14:18:54 -0700 (MST)
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor
 of Python 3.6
In-Reply-To: <11181981.oemj7CW2LR@even-i700>
References: <11181981.oemj7CW2LR@even-i700>
Message-ID: <1606079934443-0.post@n6.nabble.com>

+1

-Jukka Rahkonen-


Even Rouault-2 wrote
> Hi,
> 
> given the positive feedback of the discussion phase, and since our CI is
> now 
> ready for it, I motion to adopt
> 
> RFC 77: Drop Python 2 support in favor of Python 3.6
> https://github.com/OSGeo/gdal/pull/3142
> 
> Starting with my +1
> 
> Even





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ravitejakrishna.w at zohocorp.com  Mon Nov 23 00:32:24 2020
From: ravitejakrishna.w at zohocorp.com (Wuyyuru Ravi Teja Krishna)
Date: Mon, 23 Nov 2020 14:02:24 +0530
Subject: [gdal-dev] ogr2ogr is not working for a geojson file
Message-ID: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>

Hi team,

? ? ? I am using ogr2ogr with java bindings for conversion of a geojson file to a csv file, But I am getting an error as specified below.

ERROR 10: Pointer 'panMap' is NULL in 'OGR_F_SetFrom'.



Unable to translate feature 0 from layer map_sample

Terminating translation prematurely after failed

translation of layer map_sample (use -skipfailures to skip errors)



ogr2ogr is invoked as below



java -cp :gdal.jar -Djava.library.path=libs/ ogr2ogr "-s_srs" "CRS:84" "-t_srs" "CRS:84" "-f" "CSV" proplesscsv.csv map_sample.geojson? "-lco" "GEOMETRY=AS_WKT"

I have also attached the sample file I was working with this mail. Kindly help me in this conversion failure.


Thanks & Regards,

Ravi Teja
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/4e19e0a8/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: map_sample.geojson
Type: application/octet-stream
Size: 647 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/4e19e0a8/attachment.obj>

From philippe.ghesquiere at airbus.com  Mon Nov 23 02:29:53 2020
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Mon, 23 Nov 2020 03:29:53 -0700 (MST)
Subject: [gdal-dev] GPKG and antimeridian
Message-ID: <1606127393102-0.post@n6.nabble.com>

Dear all,

I would like to manage an image which spans over the antimeridian in GPKG
format.
After reading some information in the GDAL forum, I did a few tests and I
have some questions.
First of all, I divided my image MyImage.tif (CRS = EPSG:4326) into 2
sub-images :
1) MyImageEast.tif, which spans [+179.0? ; +180.0?]
2) MyImageWest.tif, which spans [-180.0? ; -179.0?]

Thus, both images lay in the [-180.0? ; +180?] intervalle.

1st test

I created a "single raste_table" GPKG image, based on a VRT image :


It does work. However, the output image is HUGE: all the empty tiles within
[-179.0? ; +179.0?] are created.
* Is there a way to tell gdal_translate not to create those useless tiles ?
* does GPKG format supports "missing tiles" in such case ?

2nd test:

I created a two-step GPKG, using the "APPEND_SUBDATASET":


This GPKG is fine. However, it may be difficult to deal with 2 sub-datasets
in our use-cases.
* Would it be possible to update an already existing subdataset ?
* Are there other ways to deal with images over the antimeridian?




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Nov 23 04:58:16 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2020 13:58:16 +0100
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <1606127393102-0.post@n6.nabble.com>
References: <1606127393102-0.post@n6.nabble.com>
Message-ID: <2551378.T6VW3h4rfh@even-i700>

Hello,

> I created a "single raste_table" GPKG image, based on a VRT image :
> 
> 
> It does work. However, the output image is HUGE: all the empty tiles within
> [-179.0? ; +179.0?] are created.
> * Is there a way to tell gdal_translate not to create those useless tiles ?
> * does GPKG format supports "missing tiles" in such case ?

If the input image for the GPKG driver is RGBA, and the alpha channel is at 
constant at 0 for a tile, then the tile is omitted.

> 
> 2nd test:
> 
> I created a two-step GPKG, using the "APPEND_SUBDATASET":
> 
> 
> This GPKG is fine. However, it may be difficult to deal with 2 sub-datasets
> in our use-cases.
> * Would it be possible to update an already existing subdataset ?

You can also just do:

gdalwarp MyImageEast.tif MyImageWest.tif out.gpkg

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From juliermeopensourcedeveloper at gmail.com  Mon Nov 23 06:01:12 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Mon, 23 Nov 2020 11:01:12 -0300
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 45
In-Reply-To: <mailman.3.1605988801.31071.gdal-dev@lists.osgeo.org>
References: <mailman.3.1605988801.31071.gdal-dev@lists.osgeo.org>
Message-ID: <CAKTKyJ+qoDDQaQ+Hh7X1tRN=swb04Vp3W++PtQTbbMP2PUKdsA@mail.gmail.com>

Dear Rahkonen Jukka,

I will consider your warnings about using GDAL_WCS with GeoServer.  It
seems that what I am trying to do is not possible, but it will be something
interesting to achieve through GDAL_WCS. In many cases, the user has access
to wcs geoservices and he may be interested in loading some specific
coverages (full coverage and subsets) in QGIS using an XML just like
GDAL_WMTS driver. Some institutions make WCS capabilities available, but
wmts. And this is my situation, I have a remote / external geoserver with
wcs capabilities available, but wmts.

It could be something interesting to be implemented in the future.

Thank you very much for your time and consideration of my messages.

Kind regards

Julierme


On Sat, Nov 21, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org> wrote:

> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. GDAL_WCS Driver and gdal_translate (1520 gis)
>    2. Re: GDAL_WCS Driver and gdal_translate (jratike80)
>    3. Automatic labels placement (Franco Amato)
>    4. resampling netcdf data (Nazanin tavakoli)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 20 Nov 2020 17:18:30 -0300
> From: 1520 gis <juliermeopensourcedeveloper at gmail.com>
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] GDAL_WCS Driver and gdal_translate
> Message-ID:
>         <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=
> 54wc8f1nnh5fZ7REm7A at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Dear all,
>
> I would like to open this discussion here about creating a xml/ raster wcs
> ingest using gdal_translate.
> My 2 goals are:
> 1 - get a xml like in [1] by running command line similar do gdal_wmts
> driver in [2]
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> <
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> >
> " wcs.xml -of WCS
>
> *OR*
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -of WCS
>
>
> 2 - get a xml / raster subset
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> <
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> >
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> *OR*
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> If the solution I am trying to get can not be possible through
> gdal_translate, would someone have an xml sample like in [1] to share, but
> with raster subset ingest, instead the whole image content?
>
> I appreciated your time in advance.
>
> Kind regards
>
> Julierme
>
> [1] <WCS_GDAL>
>   <ServiceURL>
> https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> ;</ServiceURL>
>   <CoverageName>nurc:Img_Sample</CoverageName>
>
>
> <GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
> </WCS_GDAL>
>
> [2] gdal_translate "WMTS:
> http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml
> -
> of WMTS.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/ca9ab931/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 2
> Date: Sat, 21 Nov 2020 03:47:58 -0700 (MST)
> From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] GDAL_WCS Driver and gdal_translate
> Message-ID: <1605955678597-0.post at n6.nabble.com>
> Content-Type: text/plain; charset=us-ascii
>
> Hi,
>
> Just a note to remind that earlier in thread "gdal-dev Digest, Vol 198,
> Issue 14" it was noticed that the GDAL WCS driver most probably has a bug
> and certain WCS coverages from Geoserver do not work. It seems to be
> related
> with the native CRS EPSG:4326. So if you test now with Geoserver, don't
> test
> with nurc__Img_Sample or other coverages which are in EPSG:4326.
>
> I know this does not answer your question, sorry.
>
> -Jukka Rahkonen-
>
>
> juliermeopensourcedeveloper wrote
> > Dear all,
> >
> > I would like to open this discussion here about creating a xml/ raster
> wcs
> > ingest using gdal_translate.
> > My 2 goals are:
> > 1 - get a xml like in [1] by running command line similar do gdal_wmts
> > driver in [2]
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> > &lt;
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt
> ;
> > " wcs.xml -of WCS
> >
> > *OR*
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> > " wcs.xml -of WCS
> >
> >
> > 2 - get a xml / raster subset
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> > &lt;
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt
> ;
> > " wcs.xml -projwin -100 40 -80 30 -of WCS
> >
> > *OR*
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> > " wcs.xml -projwin -100 40 -80 30 -of WCS
> >
> > If the solution I am trying to get can not be possible through
> > gdal_translate, would someone have an xml sample like in [1] to share,
> but
> > with raster subset ingest, instead the whole image content?
> >
> > I appreciated your time in advance.
> >
> > Kind regards
> >
> > Julierme
> >
> > [1]
> > <WCS_GDAL>
> >
> > <ServiceURL>
> > https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> > ;
> > </ServiceURL>
> >
> > <CoverageName>
> > nurc:Img_Sample
> > </CoverageName>
> >
> > <GetCoverageExtra>
> > &amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141
> > </GetCoverageExtra>
> > </WCS_GDAL>
> > [2] gdal_translate "WMTS:
> > http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"
> wmts.xml
> > -
> > of WMTS.
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
> ------------------------------
>
> Message: 3
> Date: Sat, 21 Nov 2020 09:59:01 -0500
> From: Franco Amato <cvfrank at gmail.com>
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] Automatic labels placement
> Message-ID:
>         <
> CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Good morning gdal members,
> I would know if you know any automatic labels placement library. I tried
> with PAL library located here (http://pal.heig-vd.ch) but it's too complex
> to use with GDAL data.
>
> Any suggestions are really appreciated.
>
> Thank you,
> Franco
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c0a10346/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 4
> Date: Sat, 21 Nov 2020 18:47:18 +0330
> From: Nazanin tavakoli <nazitkk1375 at gmail.com>
> To: gdal-dev at lists.osgeo.org
> Subject: [gdal-dev] resampling netcdf data
> Message-ID:
>         <CAPBJ=
> OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ at mail.gmail.com>
> Content-Type: text/plain; charset="utf-8"
>
> Hello,
> I want to change the resolution of my data whose resolution is 0.0416
> degrees (1/24th) resolution and I want to convert it to 0.5 degrees. I have
> already used this code but I have some errors. Could you please help me?
> gdal_translate -of netCDF -tr 0.5 0.5 WS.nc
> <
> https://www.youtube.com/redirect?redir_token=QUFFLUhqa0hCWkdnLUttTmVYbzh4UGFIeW9RQTBxa2piUXxBQ3Jtc0trMTVQTV9YMVVrZWVzb2xXVjh1LVBCQ2ZoT3FoTzNKYjQ2NndBcmIxQVd2TkM3NXU3dUVjQ2FtMXFkOWdRSi1vdTVISnd6UEpsZWRDRVlLSDlzZDJlcGdqdlU5S0xyOXhXSlFSajliMG1URkhrWi1iMA%3D%3D&event=comments&q=http%3A%2F%2Fws.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy
> >
> WS_1.nc
> <
> https://www.youtube.com/redirect?redir_token=QUFFLUhqbEYxWEQxZzZpbVZSNGk2RjZHUnVUdEVNNEpZd3xBQ3Jtc0ttNzZDcUdxdUN6QU5vc1lKVmdULVFqLWo1WDdjendJbXJwcm03a3R2bWN6dnRlaWM1bENzUXhFNnp2NlN6b2x6Q0V3X21ueFdBNm5HVmQzaEVsZ0FKWGNZNEZSSk9GdDdmbVFwY2JKX1RuUjk0TTJTUQ%3D%3D&event=comments&q=http%3A%2F%2F1.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy
> >
> Warning 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid
> argument".
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute Input file size is
> 8640, 4320 0Warning 1: Recode from UTF-8 to CP_ACP failed with the error:
> "Invalid argument". ...10...20...30...40...50...60...70...80...90..Warning
> 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid argument".
> .100 - done.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c8ee3be9/attachment-0001.html
> >
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 198, Issue 45
> *****************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/15989bdd/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 23 06:07:36 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Mon, 23 Nov 2020 07:07:36 -0700 (MST)
Subject: [gdal-dev] ogr2ogr is not working for a geojson file
In-Reply-To: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>
References: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>
Message-ID: <1606140456215-0.post@n6.nabble.com>

Hi,

I don't know that Java stuff but at least there does not seem to be anything
wrong with your data nor  ogr2ogr. Your command runs without errors on
Windows and ogr2ogr binary (GDAL version 3.2).

-Jukka Rahkonen- 



Ravi Teja Krishna Wuyyuru wrote
> Hi team,
> 
> ? ? ? I am using ogr2ogr with java bindings for conversion of a geojson
> file to a csv file, But I am getting an error as specified below.
> 
> ERROR 10: Pointer 'panMap' is NULL in 'OGR_F_SetFrom'.
> 
> 
> 
> Unable to translate feature 0 from layer map_sample
> 
> Terminating translation prematurely after failed
> 
> translation of layer map_sample (use -skipfailures to skip errors)
> 
> 
> 
> ogr2ogr is invoked as below
> 
> 
> 
> java -cp :gdal.jar -Djava.library.path=libs/ ogr2ogr "-s_srs" "CRS:84"
> "-t_srs" "CRS:84" "-f" "CSV" proplesscsv.csv map_sample.geojson? "-lco"
> "GEOMETRY=AS_WKT"
> 
> I have also attached the sample file I was working with this mail. Kindly
> help me in this conversion failure.
> 
> 
> Thanks & Regards,
> 
> Ravi Teja
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> 
> map_sample.geojson (647 bytes)
> &lt;http://osgeo-org.1560.x6.nabble.com/attachment/5450537/0/map_sample.geojson&gt;





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 23 07:08:24 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Mon, 23 Nov 2020 15:08:24 +0000
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 45
Message-ID: <e0cc3137e9e24df7a00b7261384ccb0d@maanmittauslaitos.fi>

Hi,

Hi,

I do not know how QGIS deals with this, but how about using VRT? It is XML and you can use it with GDAL tools. Try

Step 1.
gdal_translate -of vrt WCS:"http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sf__sfdem" wcs.vrt

Step 2.
gdal_translate -of GTiff -outsize 200 200 -projwin 589980.000 4928010.000 590980.000 4918010.000 wcs.vrt converted_from_wcs_vrt.tif

This VRT file did not work with my QGIS but a VRT created for my local Geoserver works. Steps to follow

gdal_translate -of VRT WCS:"localhost:8080/geoserver/wcs?version=2.0.1&service=WCS&coverage=sf__sfdem" localwcs.vrt

QGIS opens localwcs.vrt. The VRT file is referencing another XML file that is created by the WCS driver, in my case
<SourceFilename relativeToVRT="0">C:\Users\JRAHKONEN\.gdal\wcs_cache\DokaJ.xml</SourceFilename>

QGIS was not able to open C:\Users\JRAHKONEN\.gdal\wcs_cache\DokaJ.xml directly but I did not spend much time for finding out why not.

So if you want to continue the game:

  1.  create vrt with gdal_translate
  2.  check what xml file it is reading
  3.  move the xml file away from the WCS cache directory
  4.  edit the vrt file and update the reference into the XML file
  5.  Try with GDAL tools and QGIS.

I am not at all sure if QGIS can use the WCS-VRT layer in a way that makes sense. I suggest to test with your own Geoserver and follow what kind of requests QGIS creates.

Good luck.

-Jukka Rahkonen-


-Jukka Rahkonen-



L?hett?j?: 1520 gis <juliermeopensourcedeveloper at gmail.com>
L?hetetty: maanantai 23. marraskuuta 2020 16.01
Vastaanottaja: gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Aihe: Re: gdal-dev Digest, Vol 198, Issue 45

Dear Rahkonen Jukka,

I will consider your warnings about using GDAL_WCS with GeoServer.  It seems that what I am trying to do is not possible, but it will be something interesting to achieve through GDAL_WCS. In many cases, the user has access to wcs geoservices and he may be interested in loading some specific coverages (full coverage and subsets) in QGIS using an XML just like GDAL_WMTS driver. Some institutions make WCS capabilities available, but wmts. And this is my situation, I have a remote / external geoserver with wcs capabilities available, but wmts.

It could be something interesting to be implemented in the future.

Thank you very much for your time and consideration of my messages.

Kind regards

Julierme


On Sat, Nov 21, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>> wrote:
Send gdal-dev mailing list submissions to
        gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>

To subscribe or unsubscribe via the World Wide Web, visit
        https://lists.osgeo.org/mailman/listinfo/gdal-dev
or, via email, send a message with subject or body 'help' to
        gdal-dev-request at lists.osgeo.org<mailto:gdal-dev-request at lists.osgeo.org>

You can reach the person managing the list at
        gdal-dev-owner at lists.osgeo.org<mailto:gdal-dev-owner at lists.osgeo.org>

When replying, please edit your Subject line so it is more specific
than "Re: Contents of gdal-dev digest..."


Today's Topics:

   1. GDAL_WCS Driver and gdal_translate (1520 gis)
   2. Re: GDAL_WCS Driver and gdal_translate (jratike80)
   3. Automatic labels placement (Franco Amato)
   4. resampling netcdf data (Nazanin tavakoli)


----------------------------------------------------------------------

Message: 1
Date: Fri, 20 Nov 2020 17:18:30 -0300
From: 1520 gis <juliermeopensourcedeveloper at gmail.com<mailto:juliermeopensourcedeveloper at gmail.com>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] GDAL_WCS Driver and gdal_translate
Message-ID:
        <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=54wc8f1nnh5fZ7REm7A at mail.gmail.com<mailto:54wc8f1nnh5fZ7REm7A at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Dear all,

I would like to open this discussion here about creating a xml/ raster wcs
ingest using gdal_translate.
My 2 goals are:
1 - get a xml like in [1] by running command line similar do gdal_wmts
driver in [2]

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
<http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample>
" wcs.xml -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -of WCS


2 - get a xml / raster subset

gdal_translate "WCS:
http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
<http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample>
" wcs.xml -projwin -100 40 -80 30 -of WCS

*OR*

gdal_translate "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
" wcs.xml -projwin -100 40 -80 30 -of WCS

If the solution I am trying to get can not be possible through
gdal_translate, would someone have an xml sample like in [1] to share, but
with raster subset ingest, instead the whole image content?

I appreciated your time in advance.

Kind regards

Julierme

[1] <WCS_GDAL>
  <ServiceURL>https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
;</ServiceURL>
  <CoverageName>nurc:Img_Sample</CoverageName>

<GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
</WCS_GDAL>

[2] gdal_translate "WMTS:
http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml -
of WMTS.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/ca9ab931/attachment-0001.html>

------------------------------

Message: 2
Date: Sat, 21 Nov 2020 03:47:58 -0700 (MST)
From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] GDAL_WCS Driver and gdal_translate
Message-ID: <1605955678597-0.post at n6.nabble.com<mailto:1605955678597-0.post at n6.nabble.com>>
Content-Type: text/plain; charset=us-ascii

Hi,

Just a note to remind that earlier in thread "gdal-dev Digest, Vol 198,
Issue 14" it was noticed that the GDAL WCS driver most probably has a bug
and certain WCS coverages from Geoserver do not work. It seems to be related
with the native CRS EPSG:4326. So if you test now with Geoserver, don't test
with nurc__Img_Sample or other coverages which are in EPSG:4326.

I know this does not answer your question, sorry.

-Jukka Rahkonen-


juliermeopensourcedeveloper wrote
> Dear all,
>
> I would like to open this discussion here about creating a xml/ raster wcs
> ingest using gdal_translate.
> My 2 goals are:
> 1 - get a xml like in [1] by running command line similar do gdal_wmts
> driver in [2]
>
> gdal_translate "WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> &lt;http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt;
> " wcs.xml -of WCS
>
> *OR*
>
> gdal_translate "WCS:
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -of WCS
>
>
> 2 - get a xml / raster subset
>
> gdal_translate "WCS:
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> &lt;http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt;
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> *OR*
>
> gdal_translate "WCS:
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> If the solution I am trying to get can not be possible through
> gdal_translate, would someone have an xml sample like in [1] to share, but
> with raster subset ingest, instead the whole image content?
>
> I appreciated your time in advance.
>
> Kind regards
>
> Julierme
>
> [1]
> <WCS_GDAL>
>
> <ServiceURL>
> https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> ;
> </ServiceURL>
>
> <CoverageName>
> nurc:Img_Sample
> </CoverageName>
>
> <GetCoverageExtra>
> &amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141
> </GetCoverageExtra>
> </WCS_GDAL>
> [2] gdal_translate "WMTS:
> http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml
> -
> of WMTS.
>
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html


------------------------------

Message: 3
Date: Sat, 21 Nov 2020 09:59:01 -0500
From: Franco Amato <cvfrank at gmail.com<mailto:cvfrank at gmail.com>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] Automatic labels placement
Message-ID:
        <CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw at mail.gmail.com<mailto:CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Good morning gdal members,
I would know if you know any automatic labels placement library. I tried
with PAL library located here (http://pal.heig-vd.ch) but it's too complex
to use with GDAL data.

Any suggestions are really appreciated.

Thank you,
Franco
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c0a10346/attachment-0001.html>

------------------------------

Message: 4
Date: Sat, 21 Nov 2020 18:47:18 +0330
From: Nazanin tavakoli <nazitkk1375 at gmail.com<mailto:nazitkk1375 at gmail.com>>
To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Subject: [gdal-dev] resampling netcdf data
Message-ID:
        <CAPBJ=OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ at mail.gmail.com<mailto:OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ at mail.gmail.com>>
Content-Type: text/plain; charset="utf-8"

Hello,
I want to change the resolution of my data whose resolution is 0.0416
degrees (1/24th) resolution and I want to convert it to 0.5 degrees. I have
already used this code but I have some errors. Could you please help me?
gdal_translate -of netCDF -tr 0.5 0.5 WS.nc
<https://www.youtube.com/redirect?redir_token=QUFFLUhqa0hCWkdnLUttTmVYbzh4UGFIeW9RQTBxa2piUXxBQ3Jtc0trMTVQTV9YMVVrZWVzb2xXVjh1LVBCQ2ZoT3FoTzNKYjQ2NndBcmIxQVd2TkM3NXU3dUVjQ2FtMXFkOWdRSi1vdTVISnd6UEpsZWRDRVlLSDlzZDJlcGdqdlU5S0xyOXhXSlFSajliMG1URkhrWi1iMA%3D%3D&event=comments&q=http%3A%2F%2Fws.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy>
WS_1.nc
<https://www.youtube.com/redirect?redir_token=QUFFLUhqbEYxWEQxZzZpbVZSNGk2RjZHUnVUdEVNNEpZd3xBQ3Jtc0ttNzZDcUdxdUN6QU5vc1lKVmdULVFqLWo1WDdjendJbXJwcm03a3R2bWN6dnRlaWM1bENzUXhFNnp2NlN6b2x6Q0V3X21ueFdBNm5HVmQzaEVsZ0FKWGNZNEZSSk9GdDdmbVFwY2JKX1RuUjk0TTJTUQ%3D%3D&event=comments&q=http%3A%2F%2F1.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy>
Warning 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid
argument".
Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute Input file size is
8640, 4320 0Warning 1: Recode from UTF-8 to CP_ACP failed with the error:
"Invalid argument". ...10...20...30...40...50...60...70...80...90..Warning
1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid argument".
.100 - done.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c8ee3be9/attachment-0001.html>

------------------------------

Subject: Digest Footer

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


------------------------------

End of gdal-dev Digest, Vol 198, Issue 45
*****************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/24144386/attachment-0001.html>

From philippe.ghesquiere at airbus.com  Mon Nov 23 08:14:26 2020
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Mon, 23 Nov 2020 09:14:26 -0700 (MST)
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <2551378.T6VW3h4rfh@even-i700>
References: <1606127393102-0.post@n6.nabble.com> <2551378.T6VW3h4rfh@even-i700>
Message-ID: <1606148066052-0.post@n6.nabble.com>

Even, 
Your last suggestion (gdalwarp) sounds quite interesting.
I still don't know how to manage the different GPKG options (e.g.
TILING_SCHEME)

I tried to use *"-co"* option:


I also tried to use *"-doo"* option. 
PROMPT> gdalwarp -of GPKG -co TILING_SCHEME=InspireCRS84Quad MyImageEast.tif
MyImageWest.tif out.gpkg
Warning 6: driver GPKG does not support open option TILING_SCHEME
Creating output file that is 6409301P x 1277L.
Processing UANTIM_wgs84NEGATIF_ouest.tif [1/2] :
0...10...20...30...40...50...60...70...80...90...100 - done.
Processing UANTIM_wgs84_est.tif [2/2] :
0...10...20...30...40...50...60...70...80...90...100 - done.
PROMPT>

This last option has no effect.

How can I tell gdalwarp about the GPKG creation options I want ?





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Mon Nov 23 08:41:26 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2020 17:41:26 +0100
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <1606148066052-0.post@n6.nabble.com>
References: <1606127393102-0.post@n6.nabble.com>
 <2551378.T6VW3h4rfh@even-i700> <1606148066052-0.post@n6.nabble.com>
Message-ID: <3066170.5K1y0WTdYQ@even-i700>

On lundi 23 novembre 2020 09:14:26 CET Bugbuster wrote:
> Even,
> Your last suggestion (gdalwarp) sounds quite interesting.
> I still don't know how to manage the different GPKG options (e.g.
> TILING_SCHEME)

TILING_SCHEME is a bit particular as a creation option in the GPKG driver. You 
can pass it with -co

In gdal_translate mode, it will automatically do the "right thing", that is 
reprojecting to the expected target CRS and picking up an appropriate zoom 
level.

In gdalwarp mode, you must help the driver a bit by also specifying the 
correct target SRS -t_srs EPSG:4326 , and you also must specify a target 
resolution with -tr that matches exactly one of the zoom levels of the tiling 
scheme. The COG driver has the needed magic for that but that involves making 
gdalwarp and the driver to be aware of each other, which hasn't been done for 
the GPKG driver.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From momtchil at momtchev.com  Mon Nov 23 11:50:19 2020
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Mon, 23 Nov 2020 20:50:19 +0100
Subject: [gdal-dev] vsimem files
Message-ID: <7673936b-efab-b284-517f-07d27866c1a1@momtchev.com>


 ??? Hello,

I am adding support for working with *vsimem* files from JS buffers to 
*node-gdal-next *and I have a couple of questions.

  * There is an example for working with *vsimem* files at
    https://gdal.org/api/cpl.html#_CPPv424VSIInstallMemFileHandlerv - it
    says that a *VSIFile* handle is to be immediately closed with
    *VSIFClose* after obtaining it. For me it I get a segfault if I do
    this, but works perfectly if I do not.
  * It seems that I am supposed to call *VSIInstallMemFileHandler*
    before using vsimem files, but they seem to work anyway. So, my
    question is do I need to call it and is there any downside to
    calling it if I am not using vsimem files (ie can I call it all the
    time)?


-- 
Momtchil Momtchev <momtchil at momtchev.com>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/538364e8/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Mon Nov 23 12:00:53 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Mon, 23 Nov 2020 17:00:53 -0300
Subject: [gdal-dev] gdal-dev Digest, Vol 198, Issue 48
In-Reply-To: <mailman.726.1606144110.26371.gdal-dev@lists.osgeo.org>
References: <mailman.726.1606144110.26371.gdal-dev@lists.osgeo.org>
Message-ID: <CAKTKyJL1+g5LHt6cTD9OM3G-cTX-SfYKsGth_vw0t-N6aeCL0A@mail.gmail.com>

Dear Rahkonen Jukka,

GDAL VRT is definitely a solution for my question. The XML is readable by
QGIS.

I appreciated your time and help.

Many many many thanks

Thank you so much.



On Mon, Nov 23, 2020 at 12:09 PM <gdal-dev-request at lists.osgeo.org> wrote:

> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. Re: ogr2ogr is not working for a geojson file (jratike80)
>    2. Re: gdal-dev Digest, Vol 198, Issue 45 (Rahkonen Jukka (MML))
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Mon, 23 Nov 2020 07:07:36 -0700 (MST)
> From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
> To: gdal-dev at lists.osgeo.org
> Subject: Re: [gdal-dev] ogr2ogr is not working for a geojson file
> Message-ID: <1606140456215-0.post at n6.nabble.com>
> Content-Type: text/plain; charset=UTF-8
>
> Hi,
>
> I don't know that Java stuff but at least there does not seem to be
> anything
> wrong with your data nor  ogr2ogr. Your command runs without errors on
> Windows and ogr2ogr binary (GDAL version 3.2).
>
> -Jukka Rahkonen-
>
>
>
> Ravi Teja Krishna Wuyyuru wrote
> > Hi team,
> >
> > ? ? ? I am using ogr2ogr with java bindings for conversion of a geojson
> > file to a csv file, But I am getting an error as specified below.
> >
> > ERROR 10: Pointer 'panMap' is NULL in 'OGR_F_SetFrom'.
> >
> >
> >
> > Unable to translate feature 0 from layer map_sample
> >
> > Terminating translation prematurely after failed
> >
> > translation of layer map_sample (use -skipfailures to skip errors)
> >
> >
> >
> > ogr2ogr is invoked as below
> >
> >
> >
> > java -cp :gdal.jar -Djava.library.path=libs/ ogr2ogr "-s_srs" "CRS:84"
> > "-t_srs" "CRS:84" "-f" "CSV" proplesscsv.csv map_sample.geojson? "-lco"
> > "GEOMETRY=AS_WKT"
> >
> > I have also attached the sample file I was working with this mail. Kindly
> > help me in this conversion failure.
> >
> >
> > Thanks & Regards,
> >
> > Ravi Teja
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
> >
> >
> > map_sample.geojson (647 bytes)
> > &lt;
> http://osgeo-org.1560.x6.nabble.com/attachment/5450537/0/map_sample.geojson&gt
> ;
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
> ------------------------------
>
> Message: 2
> Date: Mon, 23 Nov 2020 15:08:24 +0000
> From: "Rahkonen Jukka (MML)" <jukka.rahkonen at maanmittauslaitos.fi>
> To: 1520 gis <juliermeopensourcedeveloper at gmail.com>,
>         "gdal-dev at lists.osgeo.org" <gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] gdal-dev Digest, Vol 198, Issue 45
> Message-ID: <e0cc3137e9e24df7a00b7261384ccb0d at maanmittauslaitos.fi>
> Content-Type: text/plain; charset="utf-8"
>
> Hi,
>
> Hi,
>
> I do not know how QGIS deals with this, but how about using VRT? It is XML
> and you can use it with GDAL tools. Try
>
> Step 1.
> gdal_translate -of vrt WCS:"
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=sf__sfdem"
> wcs.vrt
>
> Step 2.
> gdal_translate -of GTiff -outsize 200 200 -projwin 589980.000 4928010.000
> 590980.000 4918010.000 wcs.vrt converted_from_wcs_vrt.tif
>
> This VRT file did not work with my QGIS but a VRT created for my local
> Geoserver works. Steps to follow
>
> gdal_translate -of VRT
> WCS:"localhost:8080/geoserver/wcs?version=2.0.1&service=WCS&coverage=sf__sfdem"
> localwcs.vrt
>
> QGIS opens localwcs.vrt. The VRT file is referencing another XML file that
> is created by the WCS driver, in my case
> <SourceFilename
> relativeToVRT="0">C:\Users\JRAHKONEN\.gdal\wcs_cache\DokaJ.xml</SourceFilename>
>
> QGIS was not able to open C:\Users\JRAHKONEN\.gdal\wcs_cache\DokaJ.xml
> directly but I did not spend much time for finding out why not.
>
> So if you want to continue the game:
>
>   1.  create vrt with gdal_translate
>   2.  check what xml file it is reading
>   3.  move the xml file away from the WCS cache directory
>   4.  edit the vrt file and update the reference into the XML file
>   5.  Try with GDAL tools and QGIS.
>
> I am not at all sure if QGIS can use the WCS-VRT layer in a way that makes
> sense. I suggest to test with your own Geoserver and follow what kind of
> requests QGIS creates.
>
> Good luck.
>
> -Jukka Rahkonen-
>
>
> -Jukka Rahkonen-
>
>
>
> L?hett?j?: 1520 gis <juliermeopensourcedeveloper at gmail.com>
> L?hetetty: maanantai 23. marraskuuta 2020 16.01
> Vastaanottaja: gdal-dev at lists.osgeo.org; Rahkonen Jukka (MML) <
> jukka.rahkonen at maanmittauslaitos.fi>
> Aihe: Re: gdal-dev Digest, Vol 198, Issue 45
>
> Dear Rahkonen Jukka,
>
> I will consider your warnings about using GDAL_WCS with GeoServer.  It
> seems that what I am trying to do is not possible, but it will be something
> interesting to achieve through GDAL_WCS. In many cases, the user has access
> to wcs geoservices and he may be interested in loading some specific
> coverages (full coverage and subsets) in QGIS using an XML just like
> GDAL_WMTS driver. Some institutions make WCS capabilities available, but
> wmts. And this is my situation, I have a remote / external geoserver with
> wcs capabilities available, but wmts.
>
> It could be something interesting to be implemented in the future.
>
> Thank you very much for your time and consideration of my messages.
>
> Kind regards
>
> Julierme
>
>
> On Sat, Nov 21, 2020 at 5:00 PM <gdal-dev-request at lists.osgeo.org<mailto:
> gdal-dev-request at lists.osgeo.org>> wrote:
> Send gdal-dev mailing list submissions to
>         gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         https://lists.osgeo.org/mailman/listinfo/gdal-dev
> or, via email, send a message with subject or body 'help' to
>         gdal-dev-request at lists.osgeo.org<mailto:
> gdal-dev-request at lists.osgeo.org>
>
> You can reach the person managing the list at
>         gdal-dev-owner at lists.osgeo.org<mailto:
> gdal-dev-owner at lists.osgeo.org>
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of gdal-dev digest..."
>
>
> Today's Topics:
>
>    1. GDAL_WCS Driver and gdal_translate (1520 gis)
>    2. Re: GDAL_WCS Driver and gdal_translate (jratike80)
>    3. Automatic labels placement (Franco Amato)
>    4. resampling netcdf data (Nazanin tavakoli)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Fri, 20 Nov 2020 17:18:30 -0300
> From: 1520 gis <juliermeopensourcedeveloper at gmail.com<mailto:
> juliermeopensourcedeveloper at gmail.com>>
> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] GDAL_WCS Driver and gdal_translate
> Message-ID:
>         <CAKTKyJKpbfvZnXhM60FDF_T-0wFFpW=
> 54wc8f1nnh5fZ7REm7A at mail.gmail.com<mailto:
> 54wc8f1nnh5fZ7REm7A at mail.gmail.com>>
> Content-Type: text/plain; charset="utf-8"
>
> Dear all,
>
> I would like to open this discussion here about creating a xml/ raster wcs
> ingest using gdal_translate.
> My 2 goals are:
> 1 - get a xml like in [1] by running command line similar do gdal_wmts
> driver in [2]
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> <
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> >
> " wcs.xml -of WCS
>
> *OR*
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -of WCS
>
>
> 2 - get a xml / raster subset
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> <
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> >
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> *OR*
>
> gdal_translate "WCS:
>
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> " wcs.xml -projwin -100 40 -80 30 -of WCS
>
> If the solution I am trying to get can not be possible through
> gdal_translate, would someone have an xml sample like in [1] to share, but
> with raster subset ingest, instead the whole image content?
>
> I appreciated your time in advance.
>
> Kind regards
>
> Julierme
>
> [1] <WCS_GDAL>
>   <ServiceURL>
> https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> ;</ServiceURL>
>   <CoverageName>nurc:Img_Sample</CoverageName>
>
>
> <GetCoverageExtra>&amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141</GetCoverageExtra>
> </WCS_GDAL>
>
> [2] gdal_translate "WMTS:
> http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb" wmts.xml
> -
> of WMTS.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201120/ca9ab931/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 2
> Date: Sat, 21 Nov 2020 03:47:58 -0700 (MST)
> From: jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:
> jukka.rahkonen at maanmittauslaitos.fi>>
> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> Subject: Re: [gdal-dev] GDAL_WCS Driver and gdal_translate
> Message-ID: <1605955678597-0.post at n6.nabble.com<mailto:
> 1605955678597-0.post at n6.nabble.com>>
> Content-Type: text/plain; charset=us-ascii
>
> Hi,
>
> Just a note to remind that earlier in thread "gdal-dev Digest, Vol 198,
> Issue 14" it was noticed that the GDAL WCS driver most probably has a bug
> and certain WCS coverages from Geoserver do not work. It seems to be
> related
> with the native CRS EPSG:4326. So if you test now with Geoserver, don't
> test
> with nurc__Img_Sample or other coverages which are in EPSG:4326.
>
> I know this does not answer your question, sorry.
>
> -Jukka Rahkonen-
>
>
> juliermeopensourcedeveloper wrote
> > Dear all,
> >
> > I would like to open this discussion here about creating a xml/ raster
> wcs
> > ingest using gdal_translate.
> > My 2 goals are:
> > 1 - get a xml like in [1] by running command line similar do gdal_wmts
> > driver in [2]
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> > &lt;
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt
> ;
> > " wcs.xml -of WCS
> >
> > *OR*
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> > " wcs.xml -of WCS
> >
> >
> > 2 - get a xml / raster subset
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it:80/geoserver/wcs?version=2.0.1&coverage=nurc__Img_Sample
> > &lt;
> http://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp;coverage=nurc__Img_Sample&gt
> ;
> > " wcs.xml -projwin -100 40 -80 30 -of WCS
> >
> > *OR*
> >
> > gdal_translate "WCS:
> >
> http://demo.geo-solutions.it/geoserver/ows?service=WCS&request=getCapabilities,layer=nurc__Img_Sample
> > " wcs.xml -projwin -100 40 -80 30 -of WCS
> >
> > If the solution I am trying to get can not be possible through
> > gdal_translate, would someone have an xml sample like in [1] to share,
> but
> > with raster subset ingest, instead the whole image content?
> >
> > I appreciated your time in advance.
> >
> > Kind regards
> >
> > Julierme
> >
> > [1]
> > <WCS_GDAL>
> >
> > <ServiceURL>
> > https://demo.geo-solutions.it/geoserver/wcs?version=2.0.1&amp
> > ;
> > </ServiceURL>
> >
> > <CoverageName>
> > nurc:Img_Sample
> > </CoverageName>
> >
> > <GetCoverageExtra>
> > &amp;BoundingBox=-130.85168,20.7052,-62.0054,54.1141
> > </GetCoverageExtra>
> > </WCS_GDAL>
> > [2] gdal_translate "WMTS:
> > http://maps.wien.gv.at/wmts/1.0.0/WMTSCapabilities.xml,layer=lb"
> wmts.xml
> > -
> > of WMTS.
> >
> > _______________________________________________
> > gdal-dev mailing list
>
> > gdal-dev at .osgeo<mailto:gdal-dev at .osgeo>
>
> > https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
>
>
> ------------------------------
>
> Message: 3
> Date: Sat, 21 Nov 2020 09:59:01 -0500
> From: Franco Amato <cvfrank at gmail.com<mailto:cvfrank at gmail.com>>
> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] Automatic labels placement
> Message-ID:
>         <
> CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw at mail.gmail.com<mailto:
> CADAAwMcJMh6hS6HM1WKgjYKMJZXetgqYWRSOkfRw3e1LuCg2iw at mail.gmail.com>>
> Content-Type: text/plain; charset="utf-8"
>
> Good morning gdal members,
> I would know if you know any automatic labels placement library. I tried
> with PAL library located here (http://pal.heig-vd.ch) but it's too complex
> to use with GDAL data.
>
> Any suggestions are really appreciated.
>
> Thank you,
> Franco
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c0a10346/attachment-0001.html
> >
>
> ------------------------------
>
> Message: 4
> Date: Sat, 21 Nov 2020 18:47:18 +0330
> From: Nazanin tavakoli <nazitkk1375 at gmail.com<mailto:nazitkk1375 at gmail.com
> >>
> To: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> Subject: [gdal-dev] resampling netcdf data
> Message-ID:
>         <CAPBJ=
> OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ at mail.gmail.com<mailto:
> OxvAJgetPVmJ9hKx8nF9wE9xW3BXtFtzJPcZNfTk4xcwQ at mail.gmail.com>>
> Content-Type: text/plain; charset="utf-8"
>
> Hello,
> I want to change the resolution of my data whose resolution is 0.0416
> degrees (1/24th) resolution and I want to convert it to 0.5 degrees. I have
> already used this code but I have some errors. Could you please help me?
> gdal_translate -of netCDF -tr 0.5 0.5 WS.nc
> <
> https://www.youtube.com/redirect?redir_token=QUFFLUhqa0hCWkdnLUttTmVYbzh4UGFIeW9RQTBxa2piUXxBQ3Jtc0trMTVQTV9YMVVrZWVzb2xXVjh1LVBCQ2ZoT3FoTzNKYjQ2NndBcmIxQVd2TkM3NXU3dUVjQ2FtMXFkOWdRSi1vdTVISnd6UEpsZWRDRVlLSDlzZDJlcGdqdlU5S0xyOXhXSlFSajliMG1URkhrWi1iMA%3D%3D&event=comments&q=http%3A%2F%2Fws.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy
> >
> WS_1.nc
> <
> https://www.youtube.com/redirect?redir_token=QUFFLUhqbEYxWEQxZzZpbVZSNGk2RjZHUnVUdEVNNEpZd3xBQ3Jtc0ttNzZDcUdxdUN6QU5vc1lKVmdULVFqLWo1WDdjendJbXJwcm03a3R2bWN6dnRlaWM1bENzUXhFNnp2NlN6b2x6Q0V3X21ueFdBNm5HVmQzaEVsZ0FKWGNZNEZSSk9GdDdmbVFwY2JKX1RuUjk0TTJTUQ%3D%3D&event=comments&q=http%3A%2F%2F1.nc%2F&stzid=UgynaQQEp5-9sVSWQqp4AaABAg.9GHKHEPqQ8_9GKO25Kpqfy
> >
> Warning 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid
> argument".
> Warning 1: No UNIDATA NC_GLOBAL:Conventions attribute Input file size is
> 8640, 4320 0Warning 1: Recode from UTF-8 to CP_ACP failed with the error:
> "Invalid argument". ...10...20...30...40...50...60...70...80...90..Warning
> 1: Recode from UTF-8 to CP_ACP failed with the error: "Invalid argument".
> .100 - done.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201121/c8ee3be9/attachment-0001.html
> >
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 198, Issue 45
> *****************************************
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/24144386/attachment.html
> >
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> ------------------------------
>
> End of gdal-dev Digest, Vol 198, Issue 48
> *****************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201123/8d11229d/attachment-0001.html>

From even.rouault at spatialys.com  Mon Nov 23 12:08:13 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 23 Nov 2020 21:08:13 +0100
Subject: [gdal-dev] vsimem files
In-Reply-To: <7673936b-efab-b284-517f-07d27866c1a1@momtchev.com>
References: <7673936b-efab-b284-517f-07d27866c1a1@momtchev.com>
Message-ID: <3271531.pWqp0aZTyu@even-i700>

Hi,

> I am adding support for working with *vsimem* files from JS buffers to
> *node-gdal-next *and I have a couple of questions.
> 
>   * There is an example for working with *vsimem* files at
>     https://gdal.org/api/cpl.html#_CPPv424VSIInstallMemFileHandlerv - it
>     says that a *VSIFile* handle is to be immediately closed with
>     *VSIFClose* after obtaining it. For me it I get a segfault if I do
>     this, but works perfectly if I do not.

You should investigate that further. If you don't VSIFCloseL (note the L 
suffix) the file, you'll get a file handle leak

>   * It seems that I am supposed to call *VSIInstallMemFileHandler*
>     before using vsimem files, but they seem to work anyway. So, my
>     question is do I need to call it and is there any downside to
>     calling it if I am not using vsimem files (ie can I call it all the
>     time)?

VSIInstallMemFileHandler() is called automatically the first time you access a 
file. No need to explicitly call it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jr at halo3.net  Tue Nov 24 03:20:59 2020
From: jr at halo3.net (James Russo)
Date: Tue, 24 Nov 2020 06:20:59 -0500
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
Message-ID: <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>

Good Evening,

GIS novice here. I have a GEOTiff that I'm trying to create tiles from
which crosses the 180. It's a FAA sectional chart from the US used for
aviation. If I slice off anything west of the 180, I can generate the tiles
and they look good. If I don't the area of the tiles is super large and the
resulting tile set is very pixelated.

The source file is located here in zip form (
https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)

I've tried some of the solutions that specify to use the CONFIG_LONG
option, but that doesn't seem to be impacting anything. The only solution I
have come up with is to cut off the area which crosses the 180 which yields
good results.

I've included below the commands I've been using.  I'm looking for any
suggestions/guidance. I realize this is somewhat of a common problem. Even
MapTiler had the problem, but they have sent an updated version which
supposedly fixes it, but I can't afford that solution at this point so I'd
like to stick to GDAL if possible.

Thanks,

-jr


--- snip --

gdal_translate \
    -expand rgb \
    -strict \
    -co TILED=YES \
    -co COMPRESS=LZW \
    -co BIGTIFF=YES \
    alaska.tif alaska_expanded_rgb.vrt

gdalwarp \
       -overwrite                  \
       -cutline "Alaska_Wall_Planning_Chart.shp"       \
       -crop_to_cutline            \
       -cblend 10                  \
       -r lanczos                  \
       -dstalpha                   \
       -co ALPHA=YES               \
       -co TILED=YES               \
       -multi                      \
       -wo NUM_THREADS=ALL_CPUS    \
       -wm 1024                    \
       --config GDAL_CACHEMAX 1024 \
       "alaska_expanded_rgb.vrt"   \
       "alaska_clipped.vrt"

gdalwarp \
        -t_srs EPSG:3857            \
        -te -19497422 6016546 -13438444 11497579 \
        -r lanczos                  \
        -overwrite                  \
        -multi                      \
        -wo NUM_THREADS=ALL_CPUS    \
        -wm 1024                    \
        --config GDAL_CACHEMAX 1024 \
        -co TILED=YES               \
        "alaska_clipped.vrt" \
        "alaska_warped.vrt"

gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet alaska_warped.vrt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201124/5890ff67/attachment.html>

From ravitejakrishna.w at zohocorp.com  Tue Nov 24 06:11:08 2020
From: ravitejakrishna.w at zohocorp.com (Wuyyuru Ravi Teja Krishna)
Date: Tue, 24 Nov 2020 19:41:08 +0530
Subject: [gdal-dev] ogr2ogr is not working for a geojson file
In-Reply-To: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>
References: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>
Message-ID: <175fa980752.e7ee57da40960.7409736446478527702@zohocorp.com>

Hi,?



? ? ? I have tried converting the file in Centos and Macos but I am facing an error as said below. I have analyzed and found that the issue occurs only when there is no properties data in geojson file. I have generated jars and library files using the java bindings of gdal. Is there any dependency that i might have missed cause this issue occurs only for these type of files (i.e with no properties data). Can someone help me in solving this error.


Thanks & Regards,

Ravi Teja






---- On Mon, 23 Nov 2020 14:02:24 +0530 Wuyyuru Ravi Teja Krishna <ravitejakrishna.w at zohocorp.com> wrote ----


Hi team,

? ? ? I am using ogr2ogr with java bindings for conversion of a geojson file to a csv file, But I am getting an error as specified below.

ERROR 10: Pointer 'panMap' is NULL in 'OGR_F_SetFrom'.



Unable to translate feature 0 from layer map_sample

Terminating translation prematurely after failed

translation of layer map_sample (use -skipfailures to skip errors)



ogr2ogr is invoked as below



java -cp :gdal.jar -Djava.library.path=libs/ ogr2ogr "-s_srs" "CRS:84" "-t_srs" "CRS:84" "-f" "CSV" proplesscsv.csv map_sample.geojson? "-lco" "GEOMETRY=AS_WKT"

I have also attached the sample file I was working with this mail. Kindly help me in this conversion failure.


Thanks & Regards,

Ravi Teja
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201124/8c45633f/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Nov 24 07:07:20 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 24 Nov 2020 08:07:20 -0700 (MST)
Subject: [gdal-dev] ogr2ogr is not working for a geojson file
In-Reply-To: <175fa980752.e7ee57da40960.7409736446478527702@zohocorp.com>
References: <175f43b8a43.12119a12e25353.8327270048582227627@zohocorp.com>
 <175fa980752.e7ee57da40960.7409736446478527702@zohocorp.com>
Message-ID: <1606230440409-0.post@n6.nabble.com>

Hi,

What is your GDAL version (current is 3.2)? Do you get the same error with
ogr2ogr command line without launching it from Java?

-Jukka Rahkonen-


Ravi Teja Krishna Wuyyuru wrote
> Hi,?
> 
> 
> 
> ? ? ? I have tried converting the file in Centos and Macos but I am facing
> an error as said below. I have analyzed and found that the issue occurs
> only when there is no properties data in geojson file. I have generated
> jars and library files using the java bindings of gdal. Is there any
> dependency that i might have missed cause this issue occurs only for these
> type of files (i.e with no properties data). Can someone help me in
> solving this error.
> 
> 
> Thanks & Regards,
> 
> Ravi Teja
> 
> 
> 
> 
> 
> 
> ---- On Mon, 23 Nov 2020 14:02:24 +0530 Wuyyuru Ravi Teja Krishna &lt;

> ravitejakrishna.w@

> &gt; wrote ----
> 
> 
> Hi team,
> 
> ? ? ? I am using ogr2ogr with java bindings for conversion of a geojson
> file to a csv file, But I am getting an error as specified below.
> 
> ERROR 10: Pointer 'panMap' is NULL in 'OGR_F_SetFrom'.
> 
> 
> 
> Unable to translate feature 0 from layer map_sample
> 
> Terminating translation prematurely after failed
> 
> translation of layer map_sample (use -skipfailures to skip errors)
> 
> 
> 
> ogr2ogr is invoked as below
> 
> 
> 
> java -cp :gdal.jar -Djava.library.path=libs/ ogr2ogr "-s_srs" "CRS:84"
> "-t_srs" "CRS:84" "-f" "CSV" proplesscsv.csv map_sample.geojson? "-lco"
> "GEOMETRY=AS_WKT"
> 
> I have also attached the sample file I was working with this mail. Kindly
> help me in this conversion failure.
> 
> 
> Thanks & Regards,
> 
> Ravi Teja
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From philippe.ghesquiere at airbus.com  Tue Nov 24 07:53:59 2020
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Tue, 24 Nov 2020 08:53:59 -0700 (MST)
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <3066170.5K1y0WTdYQ@even-i700>
References: <1606127393102-0.post@n6.nabble.com>
 <2551378.T6VW3h4rfh@even-i700> <1606148066052-0.post@n6.nabble.com>
 <3066170.5K1y0WTdYQ@even-i700>
Message-ID: <1606233239838-0.post@n6.nabble.com>

Sorry my previous message is a bit screwed up (part of the message has been
lost)

1) gdalwarp using *"-co"* options yield to errors, even with -tr and -t_srs
options
PROMPT> gdalwarp -overwrite -of GPKG -co TILING_SCHEME=InspireCRS84Quad -co
ZOOM_LEVEL_STRATEGY=AUTO -tr 0.000056168363154 0.000056168363154 -t_srs
EPSG:4326 MyImageEast.tif MyImageWest.tif out.gpkg
Creating output file that is 1901P x 1277L.
ERROR 6: Could not find an appropriate zoom level of InspireCRS84Quad tiling
scheme that matches raster pixel size
ERROR 1: Raster table out not correctly initialized due to missing call to
SetGeoTransform()
PROMPT>

2) gdalwarp using *"-doo"* options
These options are ignored : I obtain exactly the same image with or without
them.
In this case, the GPKG image is not compliant to any tle scheme : it spans
[+170? ; +190?].

3) As you say, gdal_translate automatically does the "right thing". Which is
quite nice.
As I mentioned in my 1st message, I created my GPKG in two steps :
3.1) create a VRT
gdalbuildvrt MyImage.vrt MyImageEast.tif MyImageWest.tif
This image has no data in the intervalle [-179? ; +179?]

3.2) Translate it to GPKG
gdal_translate -of GPKG -co TILING_SCHEME=InspireCRS84Quad -co
ZOOM_LEVEL_STRATEGY=AUTO MyImage.vrt MyImage.gpkg
In this translation, GDAL creates non-existant tiles between [-179? ;
+179?], resulting in a huge image.
Does it sound all right to you ?



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Tue Nov 24 08:36:35 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 24 Nov 2020 17:36:35 +0100
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <1606233239838-0.post@n6.nabble.com>
References: <1606127393102-0.post@n6.nabble.com>
 <3066170.5K1y0WTdYQ@even-i700> <1606233239838-0.post@n6.nabble.com>
Message-ID: <12667716.eyS3E5hBbg@even-i700>

Philippe,

> 1) gdalwarp using *"-co"* options yield to errors, even with -tr and -t_srs
> options
> PROMPT> gdalwarp -overwrite -of GPKG -co TILING_SCHEME=InspireCRS84Quad -co
> ZOOM_LEVEL_STRATEGY=AUTO -tr 0.000056168363154 0.000056168363154 -t_srs
> EPSG:4326 MyImageEast.tif MyImageWest.tif out.gpkg
> Creating output file that is 1901P x 1277L.
> ERROR 6: Could not find an appropriate zoom level of InspireCRS84Quad tiling
> scheme that matches raster pixel size
> ERROR 1: Raster table out not correctly initialized due to missing call to
> SetGeoTransform()

Yes this resolution isn't compatible with a known zoom level of 
InspireCRS84Quad. The resolution at zoom level 0 is 0.703125, so only
0.703125 / 2^n is allowed.

> 2) gdalwarp using *"-doo"* options
> These options are ignored : I obtain exactly the same image with or without
> them.

Yes, TILING_SCHEME is not an open option. The tiling scheme must be dediced at 
creation time, not update time of an existing dataset.

> 3) As you say, gdal_translate automatically does the "right thing". Which is
> quite nice.
> As I mentioned in my 1st message, I created my GPKG in two steps :
> 3.1) create a VRT
> gdalbuildvrt MyImage.vrt MyImageEast.tif MyImageWest.tif
> This image has no data in the intervalle [-179? ; +179?]
> 
> 3.2) Translate it to GPKG
> gdal_translate -of GPKG -co TILING_SCHEME=InspireCRS84Quad -co
> ZOOM_LEVEL_STRATEGY=AUTO MyImage.vrt MyImage.gpkg
> In this translation, GDAL creates non-existant tiles between [-179? ;
> +179?], resulting in a huge image.

You should make sure your .vrt has an alpha band (use the -addalpha option of 
gdalbuildvrt for example). This is the key for the GPKG driver to detect blank 
tiles.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From andrew.hardin5+gdaldev at gmail.com  Tue Nov 24 15:32:14 2020
From: andrew.hardin5+gdaldev at gmail.com (Andrew Hardin)
Date: Tue, 24 Nov 2020 16:32:14 -0700
Subject: [gdal-dev] Improving NITF SICD support
Message-ID: <CACoapQ=BWFjG70uQL5bE2eDjbvFL-9m-E1i8kLGn8ckyrptvQA@mail.gmail.com>

Hi all,

I'd like to improve derived dataset support for SICD files. Here's one of
the example files I'm working with:

https://six-library.s3.amazonaws.com/sicd_example_1_PFA_RE32F_IM32F_HH.nitf

This SICD file is a two-band NITF with an XML DES tacked onto the end. The
two bands are {inphase, quadrature} and together they represent complex
data. However, because they're in two separate bands, gdalinfo doesn't
report any of the standard DERIVED_SUBDATASET functions for the complex
data.

The desired end-state is to have standard DERIVED_SUBDATASET functions
available for two-band complex data NITFs.  One implementation option(?)
would be to write a new driver for SICD that's a specialized wrapper around
a NITF dataset, but that feels heavy handed.

Any suggestions for how to go about this?

Thanks,
Andrew
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201124/d85a9dce/attachment.html>

From even.rouault at spatialys.com  Wed Nov 25 00:28:29 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 09:28:29 +0100
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor
 of Python 3.6
In-Reply-To: <11181981.oemj7CW2LR@even-i700>
References: <11181981.oemj7CW2LR@even-i700>
Message-ID: <2684026.UjVCFj7JQ4@even-i700>

Hi,

> RFC 77: Drop Python 2 support in favor of Python 3.6
> https://github.com/OSGeo/gdal/pull/3142
> 
> Starting with my +1

This motion is passed with +1 from PSC members HowardB, KurtS, JukkaR and 
myself

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Nov 25 00:40:59 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 09:40:59 +0100
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
Message-ID: <2972936.QL4LCFhekh@even-i700>

Hi,

As required by OSGeo for its projects [1] and some institutions that want to 
interact with us, I've prepared in https://github.com/OSGeo/gdal/pull/3219 a 
pull request adding the Contributor Covenant v2.0 [2] as the code of conduct 
for the project.

The only part I modified is the template "be reported to the community leaders 
responsible for enforcement at  [INSERT CONTACT METHOD]" customized as "be
reported to the community leaders responsible for enforcement at the
OSGeo Code of Conduct reporting private email (conduct-report at osgeo.org) and/
or at a member of the GDAL Project Steering Committee
(refer to https://gdal.org/community.html#project-steering-committee)."

Opinions ?

Even

[1] https://www.osgeo.org/resources/osgeo-code-of-conduct/
[2] https://www.contributor-covenant.org/version/2/0/code_of_conduct

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From b.phamhuu at jacobs-university.de  Wed Nov 25 01:12:42 2020
From: b.phamhuu at jacobs-university.de (Bang Pham Huu)
Date: Wed, 25 Nov 2020 10:12:42 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
Message-ID: <bf33777f-6f6e-e6c3-07c7-8c482b0097d4@jacobs-university.de>

Hello,

I have a DGM 10m tiff file (translated from xyz file: e.g:
dgm10_32572_6020_1_sh.xyz - example: https://pastebin.com/40xSNqm4) in
EPSG:25832 CRS with this gdalinfo as below.

I tried to warp it to EPSG:4326 but I got error.

Do I miss something?

Thanks,

gdalwarp test.tif -t_srs EPSG:4326 test1.tif
ERROR 1: latitude or longitude exceeded limits
ERROR 1: Too many points (441 out of 441) failed to transform,
unable to compute output bounds.

?gdalinfo test.tif
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 100, 100
Coordinate System is:
PROJCS["ETRS89 / UTM zone 32N",
??? GEOGCS["ETRS89",
??????? DATUM["European_Terrestrial_Reference_System_1989",
??????????? SPHEROID["GRS 1980",6378137,298.2572221010002,
??????????????? AUTHORITY["EPSG","7019"]],
??????????? AUTHORITY["EPSG","6258"]],
??????? PRIMEM["Greenwich",0],
??????? UNIT["degree",0.0174532925199433],
??????? AUTHORITY["EPSG","4258"]],
??? PROJECTION["Transverse_Mercator"],
??? PARAMETER["latitude_of_origin",0],
??? PARAMETER["central_meridian",9],
??? PARAMETER["scale_factor",0.9996],
??? PARAMETER["false_easting",500000],
??? PARAMETER["false_northing",0],
??? UNIT["metre",1,
??????? AUTHORITY["EPSG","9001"]],
??? AUTHORITY["EPSG","25832"]]
Origin = (32573000.000000000000000,6019990.000000000000000)
Pixel Size = (10.000000000000000,-10.000000000000000)
Metadata:
? AREA_OR_POINT=Area
Image Structure Metadata:
? INTERLEAVE=BAND
Corner Coordinates:
Upper Left? (32573000.000, 6019990.000) (174d17' 8.00"W,Invalid angle)
Lower Left? (32573000.000, 6018990.000) (114d59' 0.99"W,Invalid angle)
Upper Right (32574000.000, 6019990.000) (109d46'37.15"W,Invalid angle)
Lower Right (32574000.000, 6018990.000) ( 43d35'46.10"W,Invalid angle)
Center????? (32573500.000, 6019490.000) (102d39' 0.67"W,Invalid angle)
Band 1 Block=100x20 Type=Float32, ColorInterp=Gray
? NoData Value=-9999


From a09550 at gmail.com  Wed Nov 25 01:17:47 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Wed, 25 Nov 2020 10:17:47 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
Message-ID: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>

Hello,

I have a DGM 10m tiff file (translated from xyz file:
e.g:dgm10_32572_6020_1_sh.xyz - example:
https://pastebin.com/40xSNqm4) in
EPSG:25832 CRS with this gdalinfo as below.

I tried to warp it to EPSG:4326 but I got error.

Do I miss something?

Thanks,

gdalwarp test.tif -t_srs EPSG:4326 test1.tif
ERROR 1: latitude or longitude exceeded limits
ERROR 1: Too many points (441 out of 441) failed to transform,
unable to compute output bounds.

 gdalinfo test.tif
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 100, 100
Coordinate System is:
PROJCS["ETRS89 / UTM zone 32N",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["GRS 1980",6378137,298.2572221010002,
                AUTHORITY["EPSG","7019"]],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433],
        AUTHORITY["EPSG","4258"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AUTHORITY["EPSG","25832"]]
Origin = (32573000.000000000000000,6019990.000000000000000)
Pixel Size = (10.000000000000000,-10.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (32573000.000, 6019990.000) (174d17' 8.00"W,Invalid angle)
Lower Left  (32573000.000, 6018990.000) (114d59' 0.99"W,Invalid angle)
Upper Right (32574000.000, 6019990.000) (109d46'37.15"W,Invalid angle)
Lower Right (32574000.000, 6018990.000) ( 43d35'46.10"W,Invalid angle)
Center      (32573500.000, 6019490.000) (102d39' 0.67"W,Invalid angle)
Band 1 Block=100x20 Type=Float32, ColorInterp=Gray
  NoData Value=-9999
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/12ed561f/attachment.html>

From tobias.wendorff at tu-dortmund.de  Wed Nov 25 01:55:27 2020
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Wed, 25 Nov 2020 10:55:27 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
Message-ID: <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>

Am 25.11.2020 um 10:17 schrieb Pham Huu Bang:
> Corner Coordinates:
> Upper Left? (32573000.000, 6019990.000) (174d17' 8.00"W,Invalid angle)
> Lower Left? (32573000.000, 6018990.000) (114d59' 0.99"W,Invalid angle)
> Upper Right (32574000.000, 6019990.000) (109d46'37.15"W,Invalid angle)
> Lower Right (32574000.000, 6018990.000) ( 43d35'46.10"W,Invalid angle)
> Center????? (32573500.000, 6019490.000) (102d39' 0.67"W,Invalid angle)
> Band 1 Block=100x20 Type=Float32, ColorInterp=Gray
>  ? NoData Value=-9999

That's not EPSG:25832. It's EPSG:4647.

xx359666.704;5651728.683 -> EPSG:25832
32359666.704;5651728.683 -> EPSG:4647

From philippe.ghesquiere at airbus.com  Wed Nov 25 01:57:56 2020
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Wed, 25 Nov 2020 02:57:56 -0700 (MST)
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <12667716.eyS3E5hBbg@even-i700>
References: <1606127393102-0.post@n6.nabble.com>
 <2551378.T6VW3h4rfh@even-i700> <1606148066052-0.post@n6.nabble.com>
 <3066170.5K1y0WTdYQ@even-i700> <1606233239838-0.post@n6.nabble.com>
 <12667716.eyS3E5hBbg@even-i700>
Message-ID: <1606298276294-0.post@n6.nabble.com>

Hi Even,

I am getting closer !
I added the -addalpha to the VRT image. 
gdalbuildvrt -addalpha MyImage.vrt MyImageEast.tif MyImageWest.tif 

1) The final GPKG is much better with the *default* parameters :
gdal_translate -of GPKG MyImage.vrt MyImage.gpkg

The output GPKG image only contains the relevant pixel information.

2) If I want to use a standard scheme (e.g. InspireCRS84Quad),
gdal_translate still creates the transparent tiles:
gdal_translate -of GPKG -co TILING_SCHEME=InspireCRS84Quad -co
ZOOM_LEVEL_STRATEGY=AUTO MyImage.vrt MyImage.gpkg


I turned the debug mode on. 
There are calls to GDALWarpKernel(). If I understand the  GPKG format
description <https://gdal.org/drivers/raster/gpkg.html>   well, this is due
to the fact that my East and West TIFF images are not exactly aligned with
the InspireCRS84Quad grid.

Furthermore, I don't understand the line :
WARP: SetAlphaMax: AlphaMax not set

Is there anything to add to the gdal_translate command, so that the
"transparent information" is not ignored?

Here is a debug dump:
GDAL: GDALOpen(MyImage.vrt, this=00000000004E2730) succeeds as VRT.
Input file size is 6409301, 1277
GDAL: QuietDelete(UANTIM.vrt.gpkg) invoking Delete()
GDAL: GDALDefaultOverviews::OverviewScan()
GDAL: Computing area of interest: -180, 47.9316, 180, 48.0033
OGRCT: Wrap source at 2.69241e-05.
OGRCT: Wrap target at 2.69241e-05.
OGRCT: Wrap source at 2.69241e-05.
OGRCT: Wrap target at 2.69241e-05.
GDAL: Computing area of interest: -180, 47.9316, 180, 48.0033
OGRCT: Wrap source at 2.69241e-05.
OGRCT: Wrap target at 2.69241e-05.
WARP: SetAlphaMax: AlphaMax not set.
WARP: SetAlphaMax: AlphaMax not set.
GDAL: GDAL_CACHEMAX = 403 MB
GDAL: GDALOpen(UANTIM_wgs84NEGATIF_ouest.tif, this=000000000316DBF0)
succeeds as GTiff.
GDAL: GDALWarpKernel()::GWKBilinearNoMasksOrDstDensityOnlyByte()
Src=0,0,1371x1277 Dst=0,0,1792x1671
0GDAL: GDALWarpKernel()::GWKRealCase() Src=1368,0,1567x1277
Dst=1792,0,2048x1671
GDAL: GDALWarpKernel()::GWKRealCase() Src=2932,0,1568x1277
Dst=3840,0,2048x1671





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From a09550 at gmail.com  Wed Nov 25 02:00:42 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Wed, 25 Nov 2020 11:00:42 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
Message-ID: <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>

Hi Tobias,

If I set to EPSG:4647, I cannot warp it either:

 gdal_translate -a_srs EPSG:4647 test.tif test1.tif
Input file size is 100, 100
0...10...20...30...40...50...60...70...80...90...100 - done.

gdalinfo test1.tif
Driver: GTiff/GeoTIFF
Files: test1.tif
Size is 100, 100
Coordinate System is:
LOCAL_CS["ETRS89 / UTM zone 32N (zE-N)",
    GEOGCS["ETRS89",
        DATUM["unknown",
            SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    AUTHORITY["EPSG","4647"],
    UNIT["metre",1]]
Origin = (32573000.000000000000000,6019990.000000000000000)
Pixel Size = (10.000000000000000,-10.000000000000000)
Metadata:
  AREA_OR_POINT=Area
Image Structure Metadata:
  INTERLEAVE=BAND
Corner Coordinates:
Upper Left  (32573000.000, 6019990.000)
Lower Left  (32573000.000, 6018990.000)
Upper Right (32574000.000, 6019990.000)
Lower Right (32574000.000, 6018990.000)
Center      (32573500.000, 6019490.000)
Band 1 Block=100x20 Type=Float32, ColorInterp=Gray
  NoData Value=-9999

gdalwarp test1.tif -t_srs EPSG:4326 test2.tif
ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.

On Wed, 25 Nov 2020 at 10:55, Tobias Wendorff <
tobias.wendorff at tu-dortmund.de> wrote:

> Am 25.11.2020 um 10:17 schrieb Pham Huu Bang:
> > Corner Coordinates:
> > Upper Left  (32573000.000, 6019990.000) (174d17' 8.00"W,Invalid angle)
> > Lower Left  (32573000.000, 6018990.000) (114d59' 0.99"W,Invalid angle)
> > Upper Right (32574000.000, 6019990.000) (109d46'37.15"W,Invalid angle)
> > Lower Right (32574000.000, 6018990.000) ( 43d35'46.10"W,Invalid angle)
> > Center      (32573500.000, 6019490.000) (102d39' 0.67"W,Invalid angle)
> > Band 1 Block=100x20 Type=Float32, ColorInterp=Gray
> >    NoData Value=-9999
>
> That's not EPSG:25832. It's EPSG:4647.
>
> xx359666.704;5651728.683 -> EPSG:25832
> 32359666.704;5651728.683 -> EPSG:4647
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/f42addbc/attachment.html>

From tobias.wendorff at tu-dortmund.de  Wed Nov 25 02:10:54 2020
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Wed, 25 Nov 2020 11:10:54 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
Message-ID: <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>

Am 25.11.2020 um 11:00 schrieb Pham Huu Bang:
> ERROR 1: No PROJ.4 translation for source SRS, coordinate
> transformation initialization has failed.

Can you share your data?

From a09550 at gmail.com  Wed Nov 25 02:13:58 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Wed, 25 Nov 2020 11:13:58 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
 <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
Message-ID: <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>

The tiff file you can download from https://files.fm/f/5ttjhyh9p
The xyz file I already shared in the beginning:
https://pastebin.com/40xSNqm4

Thanks,


On Wed, 25 Nov 2020 at 11:10, Tobias Wendorff <
tobias.wendorff at tu-dortmund.de> wrote:

> Am 25.11.2020 um 11:00 schrieb Pham Huu Bang:
> > ERROR 1: No PROJ.4 translation for source SRS, coordinate
> > transformation initialization has failed.
>
> Can you share your data?
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/7f8db56a/attachment.html>

From even.rouault at spatialys.com  Wed Nov 25 02:31:49 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 11:31:49 +0100
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <1606298276294-0.post@n6.nabble.com>
References: <1606127393102-0.post@n6.nabble.com>
 <12667716.eyS3E5hBbg@even-i700> <1606298276294-0.post@n6.nabble.com>
Message-ID: <8300089.Z6B91iCA39@even-i700>

> I turned the debug mode on.
> There are calls to GDALWarpKernel().

You'll always get calls to GDALWarpKernel() with gdal_translate
-of GPKG -co TILING_SCHEME

> Furthermore, I don't understand the line :
> WARP: SetAlphaMax: AlphaMax not set

You can ignore it. AlphaMax is set when the number of bits of the bands
is not 8, 16, etc. but an intermediate value like 12.

> Is there anything to add to the gdal_translate command, so that the
> "transparent information" is not ignored?

>From a quick test, this works as expected for me:

gdalbuildvrt -addalpha tmp.vrt ../autotest/gdrivers/data/small_world.tif
# set everything to transparent
gdal_translate tmp.vrt tmp2.vrt -scale_4 0 255 0 0 
gdal_translate tmp2.vrt out.gpkg -co TILING_SCHEME=InspireCRS84Quad 
ogrinfo out.gpkg -sql "select count(*) from out" -al -q
==> returns 0

But the generation might be slow on a large VRT, since the warping will be 
less smart then gdal_translate in the non TILING_SCHEME mode which skips 
quickly zones of the VRT without sources, whereas the warping will process 
them but at the end the GPKG driver will not write those transparent tiles.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 25 02:57:05 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 25 Nov 2020 03:57:05 -0700 (MST)
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
 <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
 <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
Message-ID: <1606301825438-0.post@n6.nabble.com>

Hi,

What you have wrong is the input coordinate system, not the output as you
tested.
Compare https://epsg.org/crs/wkt/id/25832 with
https://epsg.org/crs/wkt/id/4647 and notice the difference in false easting.

Now run gdalwarp right

gdalwarp -s_srs epsg:4647 -t_srs epsg:4326 test_00.tif test_4326.tif
Creating output file that is 125P x 73L.
Processing test_00.tif [1/1] : 0Using internal nodata values (e.g. -9999)
for image test_00.tif.
Copying nodata values from source test_00.tif to destination test_4326.tif.
...10...20...30...40...50...60...70...80...90...100 - done.

-Jukka Rahkonen-


yuchan wrote
> The tiff file you can download from https://files.fm/f/5ttjhyh9p
> The xyz file I already shared in the beginning:
> https://pastebin.com/40xSNqm4
> 
> Thanks,
> 
> 
> On Wed, 25 Nov 2020 at 11:10, Tobias Wendorff <

> tobias.wendorff@

>> wrote:
> 
>> Am 25.11.2020 um 11:00 schrieb Pham Huu Bang:
>> > ERROR 1: No PROJ.4 translation for source SRS, coordinate
>> > transformation initialization has failed.
>>
>> Can you share your data?
>>
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From tobias.wendorff at tu-dortmund.de  Wed Nov 25 02:57:08 2020
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Wed, 25 Nov 2020 11:57:08 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
 <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
 <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
Message-ID: <8020cb71-49fd-43c0-bd76-dd9fe7f7b819@tu-dortmund.de>


Am 25.11.2020 um 11:13 schrieb Pham Huu Bang:
> The tiff file you can download from https://files.fm/f/5ttjhyh9p 
> <https://files.fm/f/5ttjhyh9p>
> The xyz file I already shared in the beginning: 
> https://pastebin.com/40xSNqm4 <https://pastebin.com/40xSNqm4>

Thanks. This really is EPSG:4647 and shows a part of the city Kiel in 
Germany (the central station is in the south of the extent).

From jukka.rahkonen at maanmittauslaitos.fi  Wed Nov 25 03:05:18 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Wed, 25 Nov 2020 04:05:18 -0700 (MST)
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <1606301825438-0.post@n6.nabble.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
 <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
 <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
 <1606301825438-0.post@n6.nabble.com>
Message-ID: <1606302318033-0.post@n6.nabble.com>

Hi again,

Sorry, I did not read properly what you did. That should work and it does
work for me with GDAL 3.2. I use a copy of your test.tif as "test_00.tif".


gdal_translate -a_srs epsg:4647 test_00.tif test_000.tif
Input file size is 100, 100
0...10...20...30...40...50...60...70...80...90...100 - done.

gdalwarp -t_srs epsg:4326 test_000.tif test_4326_2.tif
Creating output file that is 125P x 73L.
Processing test_000.tif [1/1] : 0Using internal nodata values (e.g. -9999)
for image test_000.tif.
Copying nodata values from source test_000.tif to destination
test_4326_2.tif.
...10...20...30...40...50...60...70...80...90...100 - done.


-Jukka-


jratike80 wrote
> Hi,
> 
> What you have wrong is the input coordinate system, not the output as you
> tested.





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From a09550 at gmail.com  Wed Nov 25 03:44:52 2020
From: a09550 at gmail.com (Pham Huu Bang)
Date: Wed, 25 Nov 2020 12:44:52 +0100
Subject: [gdal-dev] gdalwarp from EPSG:25832 to EPSG:4326 with error
 latitude or longitude exceeded limits?
In-Reply-To: <1606302318033-0.post@n6.nabble.com>
References: <CAJGa3-nr7zRRqbfN3LEaZ2BZx+nnMjWH7UAKEa=kYApmOVLncA@mail.gmail.com>
 <8f9ef449-9dca-8f56-aa49-15feda1f555f@tu-dortmund.de>
 <CAJGa3-=7zBEG8yEGx8eqPycQK9tabxPDuNk3CmdGgY0Q6FekGw@mail.gmail.com>
 <66a12077-6ae6-716d-f8a6-65ac033e14b5@tu-dortmund.de>
 <CAJGa3-=vHAhpp_yZDPb11gJcyRat2pb0_8YbMiHJk-sEUiOkmw@mail.gmail.com>
 <1606301825438-0.post@n6.nabble.com> <1606302318033-0.post@n6.nabble.com>
Message-ID: <CAJGa3-kANz8hFCaDPTn_bLVkEYcufYfx6JE3Q19mcZ06ApoDCw@mail.gmail.com>

Thank to Jukka,

so the problem was with my gdal 1.11.4 on Centos 7.
When I translated it to EPSG:4647, it doesn't contain proper WKT for EPSG,
e.g:

Coordinate System is:
LOCAL_CS["ETRS89 / UTM zone 32N (zE-N)",
    GEOGCS["ETRS89",
        DATUM["unknown",
            SPHEROID["unretrievable - using WGS84",6378137,298.257223563]],
        PRIMEM["Greenwich",0],
        UNIT["degree",0.0174532925199433]],
    AUTHORITY["EPSG","4647"],
    UNIT["metre",1]]

compared to output from GDAL 2.2.4 on Ubuntu 18.04:

Coordinate System is:
PROJCS["ETRS89 / UTM zone 32N (zE-N)",
    GEOGCS["ETRS89",
        DATUM["European_Terrestrial_Reference_System_1989",
            SPHEROID["GRS 1980",6378137,298.257222101,
                AUTHORITY["EPSG","7019"]],
            TOWGS84[0,0,0,0,0,0,0],
            AUTHORITY["EPSG","6258"]],
        PRIMEM["Greenwich",0,
            AUTHORITY["EPSG","8901"]],
        UNIT["degree",0.0174532925199433,
            AUTHORITY["EPSG","9122"]],
        AUTHORITY["EPSG","4258"]],
    PROJECTION["Transverse_Mercator"],
    PARAMETER["latitude_of_origin",0],
    PARAMETER["central_meridian",9],
    PARAMETER["scale_factor",0.9996],
    PARAMETER["false_easting",32500000],
    PARAMETER["false_northing",0],
    UNIT["metre",1,
        AUTHORITY["EPSG","9001"]],
    AXIS["Easting",EAST],
    AXIS["Northing",NORTH],
    AUTHORITY["EPSG","4647"]]

With gdal 1.11.4, I cannot warp it to EPSG:4326 with error:

ERROR 1: No PROJ.4 translation for source SRS, coordinate
transformation initialization has failed.

and it works with gdal 2.2.4 for gdalwarp.



On Wed, 25 Nov 2020 at 12:05, jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
wrote:

> Hi again,
>
> Sorry, I did not read properly what you did. That should work and it does
> work for me with GDAL 3.2. I use a copy of your test.tif as "test_00.tif".
>
>
> gdal_translate -a_srs epsg:4647 test_00.tif test_000.tif
> Input file size is 100, 100
> 0...10...20...30...40...50...60...70...80...90...100 - done.
>
> gdalwarp -t_srs epsg:4326 test_000.tif test_4326_2.tif
> Creating output file that is 125P x 73L.
> Processing test_000.tif [1/1] : 0Using internal nodata values (e.g. -9999)
> for image test_000.tif.
> Copying nodata values from source test_000.tif to destination
> test_4326_2.tif.
> ...10...20...30...40...50...60...70...80...90...100 - done.
>
>
> -Jukka-
>
>
> jratike80 wrote
> > Hi,
> >
> > What you have wrong is the input coordinate system, not the output as you
> > tested.
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/3b368dc8/attachment-0001.html>

From mps2806 at gmail.com  Wed Nov 25 03:54:37 2020
From: mps2806 at gmail.com (Marcela P)
Date: Wed, 25 Nov 2020 12:54:37 +0100
Subject: [gdal-dev] Hello it is my first mail about gdal and macOS
Message-ID: <CAFRWbh24Lz99ni0YoPzC=5qN_rMpmoCi4rVW27+xJWaqEMzi0w@mail.gmail.com>

Hi, my name is Mar,
I need help about how to work gdal in macOS.
I have got several problems with gdal in qgis and I am attempting to set it
on pycharm. I am a newbie and I don?t know how to look for help on it.
Could you help me?
Thanks in advance

Mar
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/0c8ab58c/attachment.html>

From philippe.ghesquiere at airbus.com  Wed Nov 25 04:36:44 2020
From: philippe.ghesquiere at airbus.com (Bugbuster)
Date: Wed, 25 Nov 2020 05:36:44 -0700 (MST)
Subject: [gdal-dev] GPKG and antimeridian
In-Reply-To: <8300089.Z6B91iCA39@even-i700>
References: <1606127393102-0.post@n6.nabble.com>
 <2551378.T6VW3h4rfh@even-i700> <1606148066052-0.post@n6.nabble.com>
 <3066170.5K1y0WTdYQ@even-i700> <1606233239838-0.post@n6.nabble.com>
 <12667716.eyS3E5hBbg@even-i700> <1606298276294-0.post@n6.nabble.com>
 <8300089.Z6B91iCA39@even-i700>
Message-ID: <1606307804799-0.post@n6.nabble.com>

Hi Even,

just to conclude :-)
Yes, you were right (as usual !):
Using "gdalbuildvrt -addalpha" along with "gdal_translate -co
TILING_SCHEME=xxx" does the job.

I just needed to be *very* patient:
1) gdal_translate takes a long time: more than an hour.
Without "-co TILING_SCHEME=xxx" option, it takes less than 30 seconds
2) there is a temporary xx.db file which grows a lot (up to 15 GB)
3) by the end, my GPKG file is less than 1MB and all the temporary files are
destroyed.

So far so good, although my use-case is not very efficient.



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From gdt at lexort.com  Wed Nov 25 05:53:03 2020
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 25 Nov 2020 08:53:03 -0500
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <2972936.QL4LCFhekh@even-i700> (Even Rouault's message of "Wed,
 25 Nov 2020 09:40:59 +0100")
References: <2972936.QL4LCFhekh@even-i700>
Message-ID: <rmiim9tk0g0.fsf@s1.lexort.com>


> As required by OSGeo for its projects [1] and some institutions that want to 
> interact with us, I've prepared in https://github.com/OSGeo/gdal/pull/3219 a 
> pull request adding the Contributor Covenant v2.0 [2] as the code of conduct 
> for the project.

I am not following the logic here.  OSGeo has a code of conduct, and
requires that all projects use it.  It therefore seems contrary to OSGeo
policy to use a different COC.  So it would seem that it is only
necessary to note that gdal follows the OSGeo code of conduct and have a
link someplace.

I much prefer the OSGeo COC to the one you have proposed instead.  In
particular ("Diversity Statement") talks about being welcoming to all
rather than having a large but finite list of non-discrimination reasons
which notably leaves out political views and being a veteran.  While I
strongly support being courteous to everyone, these codes can veer into
a political statement particularly when they include and exclude
particular groups by having a list.  I feel that OSGeo's avoids that,
and the Contributor Covenant not as well.

So I don't understand why you are proposing this, and what problem it is
solving, vs the current situation of the OSGeo COC being in effect.
But as usual I could well be missing something.

For now, I'm opposed, and prefer to just add a line in README.md

See [the standard OSGeo Code of Conduct](https://www.osgeo.org/resources/osgeo-code-of-conduct/).
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/80ce2487/attachment.sig>

From mateusz at loskot.net  Wed Nov 25 06:04:42 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 25 Nov 2020 15:04:42 +0100
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <rmiim9tk0g0.fsf@s1.lexort.com>
References: <2972936.QL4LCFhekh@even-i700> <rmiim9tk0g0.fsf@s1.lexort.com>
Message-ID: <CABUeae9kuArhkp_znprNRHbc+8EpaLLsFEGhDcL9-sBNe5OLTQ@mail.gmail.com>

On Wed, 25 Nov 2020, 14:53 Greg Troxel, <gdt at lexort.com> wrote:

>
> > As required by OSGeo for its projects [1] and some institutions that
> want to
> > interact with us, I've prepared in
> https://github.com/OSGeo/gdal/pull/3219 a
> > pull request adding the Contributor Covenant v2.0 [2] as the code of
> conduct
> > for the project.
>
> I much prefer the OSGeo COC to the one you have proposed instead.  In
> particular ("Diversity Statement") talks about being welcoming to all
> rather than having a large but finite list of non-discrimination reasons
>

+1

which notably leaves out political views and being a veteran.  While I
> strongly support being courteous to everyone, these codes can veer into
> a political statement particularly when they include and exclude
> particular groups by having a list.


+1

I feel that OSGeo's avoids that,
> and the Contributor Covenant not as well.
>

+1

For now, I'm opposed, and prefer to just add a line in README.md
>
> See [the standard OSGeo Code of Conduct](
> https://www.osgeo.org/resources/osgeo-code-of-conduct/).
>

+1

-- 
Mateusz Loskot, mateusz at loskot.net
(Sent from mobile, may suffer from top-posting)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/4ef588de/attachment.html>

From even.rouault at spatialys.com  Wed Nov 25 06:13:04 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 15:13:04 +0100
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <rmiim9tk0g0.fsf@s1.lexort.com>
References: <2972936.QL4LCFhekh@even-i700> <rmiim9tk0g0.fsf@s1.lexort.com>
Message-ID: <267739121.9dE5TOdy3X@even-i700>

Greg,

> I am not following the logic here.  OSGeo has a code of conduct, and
> requires that all projects use it.

I was a bit confused because there are 2 pages:
- https://www.osgeo.org/code_of_conduct/
- https://www.osgeo.org/resources/osgeo-code-of-conduct/

I actually started reading the former that would tend to point OSGeo projects 
to use Contributor Covenant. Maybe one of those 2 pages is outdated.

Honestly I don't really care about which CoC we select. We just need (a 
somewhat reasonable) one, and above all, not create a new one.

> For now, I'm opposed, and prefer to just add a line in README.md
> 
> See [the standard OSGeo Code of
> Conduct](https://www.osgeo.org/resources/osgeo-code-of-conduct/).

I had considered that too and would be fine with it.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From gdt at lexort.com  Wed Nov 25 06:18:27 2020
From: gdt at lexort.com (Greg Troxel)
Date: Wed, 25 Nov 2020 09:18:27 -0500
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <267739121.9dE5TOdy3X@even-i700> (Even Rouault's message of "Wed, 
 25 Nov 2020 15:13:04 +0100")
References: <2972936.QL4LCFhekh@even-i700> <rmiim9tk0g0.fsf@s1.lexort.com>
 <267739121.9dE5TOdy3X@even-i700>
Message-ID: <rmimtz5ikp8.fsf@s1.lexort.com>


Even Rouault <even.rouault at spatialys.com> writes:

> Greg,
>
>> I am not following the logic here.  OSGeo has a code of conduct, and
>> requires that all projects use it.
>
> I was a bit confused because there are 2 pages:
> - https://www.osgeo.org/code_of_conduct/
> - https://www.osgeo.org/resources/osgeo-code-of-conduct/
>
> I actually started reading the former that would tend to point OSGeo projects 
> to use Contributor Covenant. Maybe one of those 2 pages is outdated.

I think what's going on is that the OSGeo Code of Conduct was adopted a
while ago and there is a new rule about using a different one.

> Honestly I don't really care about which CoC we select. We just need (a 
> somewhat reasonable) one, and above all, not create a new one.

Basically agreed.

>> For now, I'm opposed, and prefer to just add a line in README.md
>> 
>> See [the standard OSGeo Code of
>> Conduct](https://www.osgeo.org/resources/osgeo-code-of-conduct/).
>
> I had considered that too and would be fine with it.

Thanks - we'll see what others say.
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 194 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/381b9ea0/attachment.sig>

From even.rouault at spatialys.com  Wed Nov 25 07:04:58 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 16:04:58 +0100
Subject: [gdal-dev] Improving NITF SICD support
In-Reply-To: <CACoapQ=BWFjG70uQL5bE2eDjbvFL-9m-E1i8kLGn8ckyrptvQA@mail.gmail.com>
References: <CACoapQ=BWFjG70uQL5bE2eDjbvFL-9m-E1i8kLGn8ckyrptvQA@mail.gmail.com>
Message-ID: <3909577.A3nahi8QdU@even-i700>

On mardi 24 novembre 2020 16:32:14 CET Andrew Hardin wrote:
> Hi all,
> 
> I'd like to improve derived dataset support for SICD files. Here's one of
> the example files I'm working with:
> 
> https://six-library.s3.amazonaws.com/sicd_example_1_PFA_RE32F_IM32F_HH.nitf
> 
> This SICD file is a two-band NITF with an XML DES tacked onto the end. The
> two bands are {inphase, quadrature} and together they represent complex
> data. However, because they're in two separate bands, gdalinfo doesn't
> report any of the standard DERIVED_SUBDATASET functions for the complex
> data.
> 
> The desired end-state is to have standard DERIVED_SUBDATASET functions
> available for two-band complex data NITFs.  One implementation option(?)
> would be to write a new driver for SICD that's a specialized wrapper around
> a NITF dataset, but that feels heavy handed.
> 
> Any suggestions for how to go about this?

Too bad the producer doesn't use the native way of NITF to encode complex 
numbers (PVTYPE=C)

One way of solving this could be to use the "complex" pixel function of the 
VRT driver :
https://gdal.org/drivers/raster/vrt.html#default-pixel-functions

If SICD production is big enough to justify something more streamlined, you 
could as you suggest add at the end of the Open() method of the NITF driver 
some logic that would return a wrapping dataset that would do the assembly of 
the 2 components when a SICD product is detected, automating the on-the-fly 
creation of the above mentionned VRT.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Wed Nov 25 07:34:54 2020
From: mateusz at loskot.net (Mateusz Loskot)
Date: Wed, 25 Nov 2020 16:34:54 +0100
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <267739121.9dE5TOdy3X@even-i700>
References: <2972936.QL4LCFhekh@even-i700> <rmiim9tk0g0.fsf@s1.lexort.com>
 <267739121.9dE5TOdy3X@even-i700>
Message-ID: <CABUeae_gFZbxti1Xy1Tv11u5zg=rLmRF3FOrRPa9CtG0A71WMg@mail.gmail.com>

On Wed, 25 Nov 2020 at 15:13, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Honestly I don't really care about which CoC we select. We just need (a
> somewhat reasonable) one, and above all, not create a new one.

Yes, let's use the OSGeo's.

Although it's a pity that we, as a civilisation, need a written CoC at all.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From howard at hobu.co  Wed Nov 25 07:36:03 2020
From: howard at hobu.co (Howard Butler)
Date: Wed, 25 Nov 2020 09:36:03 -0600
Subject: [gdal-dev] Adopting Contributor Covenant v2.0 as code of conduct
In-Reply-To: <CABUeae_gFZbxti1Xy1Tv11u5zg=rLmRF3FOrRPa9CtG0A71WMg@mail.gmail.com>
References: <2972936.QL4LCFhekh@even-i700> <rmiim9tk0g0.fsf@s1.lexort.com>
 <267739121.9dE5TOdy3X@even-i700>
 <CABUeae_gFZbxti1Xy1Tv11u5zg=rLmRF3FOrRPa9CtG0A71WMg@mail.gmail.com>
Message-ID: <87952F4B-8E89-45F6-A8BF-C1D8B393883F@hobu.co>



> On Nov 25, 2020, at 9:34 AM, Mateusz Loskot <mateusz at loskot.net> wrote:
> 
> On Wed, 25 Nov 2020 at 15:13, Even Rouault <even.rouault at spatialys.com> wrote:
>> 
>> Honestly I don't really care about which CoC we select. We just need (a
>> somewhat reasonable) one, and above all, not create a new one.
> 
> Yes, let's use the OSGeo's.

Agree.

I would add that the notification portion should direct people to contact OSGeo instead of any PSC members in the event that the PSC is the entity violating the CoC. This will also ensure that action is taken in regard to a notice rather than a PSC member simply stuffing it.

Howard


From even.rouault at spatialys.com  Wed Nov 25 07:50:39 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 16:50:39 +0100
Subject: [gdal-dev] Using OSGeo's code of conduct for GDAL one (was Re:
 Adopting Contributor Covenant v2.0 as code of conduct)
In-Reply-To: <87952F4B-8E89-45F6-A8BF-C1D8B393883F@hobu.co>
References: <2972936.QL4LCFhekh@even-i700>
 <CABUeae_gFZbxti1Xy1Tv11u5zg=rLmRF3FOrRPa9CtG0A71WMg@mail.gmail.com>
 <87952F4B-8E89-45F6-A8BF-C1D8B393883F@hobu.co>
Message-ID: <2298658.Z5tXJbWsrQ@even-i700>

On mercredi 25 novembre 2020 09:36:03 CET Howard Butler wrote:
> > On Nov 25, 2020, at 9:34 AM, Mateusz Loskot <mateusz at loskot.net> wrote:
> > 
> > On Wed, 25 Nov 2020 at 15:13, Even Rouault <even.rouault at spatialys.com> 
wrote:
> >> Honestly I don't really care about which CoC we select. We just need (a
> >> somewhat reasonable) one, and above all, not create a new one.
> > 
> > Yes, let's use the OSGeo's.
> 
> Agree.

OK, so https://github.com/OSGeo/gdal/pull/3226

> I would add that the notification portion should direct people to contact
> OSGeo instead of any PSC members in the event that the PSC is the entity
> violating the CoC. This will also ensure that action is taken in regard to
> a notice rather than a PSC member simply stuffing it.

I haven't added anything specifically for that: the OSGeo's CoC page contains 
the instructions.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From chris.marsh at usask.ca  Wed Nov 25 07:51:26 2020
From: chris.marsh at usask.ca (Chris Marsh)
Date: Wed, 25 Nov 2020 09:51:26 -0600
Subject: [gdal-dev] Hello it is my first mail about gdal and macOS
In-Reply-To: <CAFRWbh24Lz99ni0YoPzC=5qN_rMpmoCi4rVW27+xJWaqEMzi0w@mail.gmail.com>
References: <CAFRWbh24Lz99ni0YoPzC=5qN_rMpmoCi4rVW27+xJWaqEMzi0w@mail.gmail.com>
Message-ID: <CAFgDerGv6qgpF6ZrLxHHBC6dKpnqHyizN2a8SHiFp7M78fy=sQ@mail.gmail.com>

Hi Mar,
I'm not totally clear what you're trying to do.
It seems that you're trying to use QGis on MacOS and there is some problem
with GDAL?

PyCharm is a Python IDE whereas gdal is a C++ library. PyCharm will not
help you compile gdal
If you are wanting to compile gdal, the linux instructions are generally
pretty close to what you need on MacOS
https://trac.osgeo.org/gdal/wiki/BuildingOnUnix

This list is more centred on the development of gdal, and I do not think
you'll find what you need here. I know the gdal+Qgis on macos can be
fiddly, I have found the QGIS installer from here
https://qgis.org/en/site/forusers/download.html
to work well, but you might also want to check out qgis from homebrew (
https://brew.sh/) which also takes care of the gdal installation for you
https://formulae.brew.sh/cask/qgis

but if that still doesn't work for you I would post to the QGis mailing
list with a more specific problem + question so they can better help you.
https://qgis.org/en/site/forusers/support.html


Cheers
Chris


On Wed, Nov 25, 2020 at 5:54 AM Marcela P <mps2806 at gmail.com> wrote:

> CAUTION: External to USask. Verify sender and use caution with links and
> attachments. Forward suspicious emails to phishing at usask.ca
>
> Hi, my name is Mar,
> I need help about how to work gdal in macOS.
> I have got several problems with gdal in qgis and I am attempting to set
> it on pycharm. I am a newbie and I don?t know how to look for help on it.
> Could you help me?
> Thanks in advance
>
> Mar
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/2fce2cb6/attachment.html>

From lubomir.bucek at eox.at  Wed Nov 25 10:53:38 2020
From: lubomir.bucek at eox.at (Bucek, Lubomir)
Date: Wed, 25 Nov 2020 19:53:38 +0100
Subject: [gdal-dev] JPEG 2000 change geotransform via Python bindinds Gdal
 3.2.0
Message-ID: <CAMXYFOh-AGJgv1TPRNbdZTQ+UG+knD4S_PrjdG1vTLMdttA9eA@mail.gmail.com>

Dear all,
I did not want to file the following question as an issue, as I am not sure
if I am just not missing anything in configuration, so putting it as a
question here:

I am trying to change the geotransform of a JPEG2000 file and then save
back the content via Python bindings on Ubuntu 20.04 - gdal 3.2.0 (based on
osgeo/gdal:ubuntu-full-latest -
sha256:6a82b53f12945a3ba8ac168a7488d1cf5ecb351020f67c88abc6691275a70b68)

Following code:
ds = gdal.Open(input_filename, gdal.GA_Update)
ulx, xres, xskew, uly, yskew, yres = ds.GetGeoTransform()
... do something with geotransform
ds.SetGeoTransform(geotransform_new)
del ds
Throws me into this exception "USE_SRC_CODESTREAM=YES specified, but no
codestream found":
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/openjpeg/openjpegdataset.cpp#L3718-L3722

How does this creationOption by default being False according to
https://gdal.org/drivers/raster/jp2openjpeg.html#creation-options come into
play while opening and saving an already existing file?
Using a workaround by saving the ds to a .vrt by gdal.Warp('output.vrt',ds)
works fine for me. I was just curious if I can disable the
USE_SRC_CODESTREAM after opening the JPEG2000 anyhow?

Thank you,
Best regards,


-- 
*Lubomir Bucek*

Geospatial IT Engineer

EOX IT Services GmbH
1090 Vienna, Thurngasse 8/4, Austria
T +43 (0) 660 369 7514, lubomir.bucek at eox.at <gerhard.triebnig at eox.at>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/61fcff22/attachment.html>

From even.rouault at spatialys.com  Wed Nov 25 11:45:40 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 25 Nov 2020 20:45:40 +0100
Subject: [gdal-dev] JPEG 2000 change geotransform via Python bindinds
 Gdal 3.2.0
In-Reply-To: <CAMXYFOh-AGJgv1TPRNbdZTQ+UG+knD4S_PrjdG1vTLMdttA9eA@mail.gmail.com>
References: <CAMXYFOh-AGJgv1TPRNbdZTQ+UG+knD4S_PrjdG1vTLMdttA9eA@mail.gmail.com>
Message-ID: <4318490.qlnOFU96Eq@even-i700>

On mercredi 25 novembre 2020 19:53:38 CET Bucek, Lubomir wrote:
> Dear all,
> I did not want to file the following question as an issue, as I am not sure
> if I am just not missing anything in configuration, so putting it as a
> question here:
> 
> I am trying to change the geotransform of a JPEG2000 file and then save
> back the content via Python bindings on Ubuntu 20.04 - gdal 3.2.0 (based on
> osgeo/gdal:ubuntu-full-latest -
> sha256:6a82b53f12945a3ba8ac168a7488d1cf5ecb351020f67c88abc6691275a70b68)
> 
> Following code:
> ds = gdal.Open(input_filename, gdal.GA_Update)
> ulx, xres, xskew, uly, yskew, yres = ds.GetGeoTransform()
> ... do something with geotransform
> ds.SetGeoTransform(geotransform_new)
> del ds
> Throws me into this exception "USE_SRC_CODESTREAM=YES specified, but no
> codestream found":
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/openjpeg/openjpegdatase
> t.cpp#L3718-L3722
> 
> How does this creationOption by default being False according to
> https://gdal.org/drivers/raster/jp2openjpeg.html#creation-options come into
> play while opening and saving an already existing file?

When updating in place a file, USE_SRC_CODESTREAM=YES is set internally at
https://github.com/OSGeo/gdal/blob/master/gdal/frmts/openjpeg/
openjpegdataset.cpp#L1457
to cause the generation of a new file, reusing the code stream, but just 
modifying the other JP2 boxes.
I'm not sure why this doesn't work for you. Perhaps something with the 
particular image you edit.

But I doubt this is what you want to do anyway. Updating the geotransform will 
just change the transform and not change any pixel value.
So gdal.Warp() is probably more what you want to do indeed.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From lubomir.bucek at eox.at  Wed Nov 25 12:08:21 2020
From: lubomir.bucek at eox.at (Bucek, Lubomir)
Date: Wed, 25 Nov 2020 21:08:21 +0100
Subject: [gdal-dev] JPEG 2000 change geotransform via Python bindinds
 Gdal 3.2.0
In-Reply-To: <4318490.qlnOFU96Eq@even-i700>
References: <CAMXYFOh-AGJgv1TPRNbdZTQ+UG+knD4S_PrjdG1vTLMdttA9eA@mail.gmail.com>
 <4318490.qlnOFU96Eq@even-i700>
Message-ID: <CAMXYFOjqgP0tHk=hn-9CN0Rr1qKwR+f8V_tKzyQhPirWEsKRAg@mail.gmail.com>

Dear Even,
thank you for the quick response and explanation.
Ok, I think the file was the culprit then. I will try tomorrow with a few
other from the Pleiades PH1A batch to test.
In this case, it was what I wanted to do, because I am warping into
resulting COG in the later step of the processing pipeline, so I wanted to
save the corrected geotransform information in place.

Best,

On Wed, 25 Nov 2020 at 20:45, Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 25 novembre 2020 19:53:38 CET Bucek, Lubomir wrote:
> > Dear all,
> > I did not want to file the following question as an issue, as I am not
> sure
> > if I am just not missing anything in configuration, so putting it as a
> > question here:
> >
> > I am trying to change the geotransform of a JPEG2000 file and then save
> > back the content via Python bindings on Ubuntu 20.04 - gdal 3.2.0 (based
> on
> > osgeo/gdal:ubuntu-full-latest -
> > sha256:6a82b53f12945a3ba8ac168a7488d1cf5ecb351020f67c88abc6691275a70b68)
> >
> > Following code:
> > ds = gdal.Open(input_filename, gdal.GA_Update)
> > ulx, xres, xskew, uly, yskew, yres = ds.GetGeoTransform()
> > ... do something with geotransform
> > ds.SetGeoTransform(geotransform_new)
> > del ds
> > Throws me into this exception "USE_SRC_CODESTREAM=YES specified, but no
> > codestream found":
> >
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/openjpeg/openjpegdatase
> > t.cpp#L3718-L3722
> >
> > How does this creationOption by default being False according to
> > https://gdal.org/drivers/raster/jp2openjpeg.html#creation-options come
> into
> > play while opening and saving an already existing file?
>
> When updating in place a file, USE_SRC_CODESTREAM=YES is set internally at
> https://github.com/OSGeo/gdal/blob/master/gdal/frmts/openjpeg/
> openjpegdataset.cpp#L1457
> to cause the generation of a new file, reusing the code stream, but just
> modifying the other JP2 boxes.
> I'm not sure why this doesn't work for you. Perhaps something with the
> particular image you edit.
>
> But I doubt this is what you want to do anyway. Updating the geotransform
> will
> just change the transform and not change any pixel value.
> So gdal.Warp() is probably more what you want to do indeed.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
*Lubomir Bucek*

Geospatial IT Engineer

EOX IT Services GmbH
1090 Vienna, Thurngasse 8/4, Austria
T +43 (0) 660 369 7514, lubomir.bucek at eox.at <gerhard.triebnig at eox.at>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/e1d0e92a/attachment.html>

From brian.asp.net at gmail.com  Wed Nov 25 13:30:23 2020
From: brian.asp.net at gmail.com (BrianVance)
Date: Wed, 25 Nov 2020 14:30:23 -0700 (MST)
Subject: [gdal-dev] Encoding issue in Linux Container for OGR/GDAL
Message-ID: <1606339823366-0.post@n6.nabble.com>

Hi,
   I'm using C# to read a .gdb file. We run this code in docker through a
Linux container. 

We are having an encoding issue with a function in OGR that read the string
value from a field.

item.*GetFieldAsString*(field_name);

The GetFieldAsString returns the proper string when its run from an Windows
environment but when run from a Linux Docker Container it returns us wrong
characters like M?. 

We have a lot of French Characters in our file like Qu?bec which don't
render properly when run on Linux.

Can anyone suggest a way to fix this?

Regards,
Brian 




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From dmorissette at mapgears.com  Wed Nov 25 13:49:46 2020
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Wed, 25 Nov 2020 16:49:46 -0500
Subject: [gdal-dev] Motion: adopt RFC 77 Drop Python 2 support in favor
 of Python 3.6
In-Reply-To: <2684026.UjVCFj7JQ4@even-i700>
References: <11181981.oemj7CW2LR@even-i700> <2684026.UjVCFj7JQ4@even-i700>
Message-ID: <ddbc19cb-27ac-312e-d6ba-2bbd8b81c813@mapgears.com>

And I add my belated +1.

Daniel


On 2020-11-25 03:28, Even Rouault wrote:
> Hi,
> 
>> RFC 77: Drop Python 2 support in favor of Python 3.6
>> https://github.com/OSGeo/gdal/pull/3142
>>
>> Starting with my +1
> 
> This motion is passed with +1 from PSC members HowardB, KurtS, JukkaR and
> myself
> 
> Even
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From jr at halo3.net  Wed Nov 25 18:42:08 2020
From: jr at halo3.net (James Russo)
Date: Wed, 25 Nov 2020 21:42:08 -0500
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
In-Reply-To: <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
References: <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
Message-ID: <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>

Good Evening,

I'm just following up on this question from a few days ago with some more
information and the script I am using which reproduces this issue.

The example results can be found here at the s3 links below and are all
generated from the same original GeoTIFF. The only difference is that on
one of them I slice off all data left of the 180, the other one the map is
left complete. The html files are set to the same example point and zoom
level to show how that without slicing the file, the image quality is very
poor. The one thing I notice is that if I include the 180 meridian, the
number of tiles generated is far larger (46k vs 8k).

Bad Results:

http://halo3.net/alaska_tiles_no_slice/leaflet.html

Good Results:

http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html


Below is the script I use to generate both tile sets. It will automatically
download, unzip and process the input file I am using producing the same
results shown at the links above.

I'd appreciate any insight into the issue and how I might be able to get it
resolved? I'm still quite a novice at all this GIS stuff, but it has been a
fun experience so far.

Thanks,

-jr


---snip---
#!/bin/bash

wget -SN https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip
&& unzip -xo AK_WallPlan_2.zip
mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
gdal_translate  -expand rgb  -strict  -co TILED=YES -co COMPRESS=LZW  -co
BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo
NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES
alaska_expanded_rgb.vrt alaska_warped.vrt
gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r
lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config
GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
rm -rf alaska_tiles_no_slice
rm -rf alaska_tiles_sliced_at_180
gdalinfo alaska_warped.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
alaska_warped.vrt alaska_tiles_no_slice
gdalinfo alaska_warped_sliced_at_180.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180

---snip---









On Tue, Nov 24, 2020 at 6:20 AM James Russo <jr at halo3.net> wrote:

> Good Evening,
>
> GIS novice here. I have a GEOTiff that I'm trying to create tiles from
> which crosses the 180. It's a FAA sectional chart from the US used for
> aviation. If I slice off anything west of the 180, I can generate the tiles
> and they look good. If I don't the area of the tiles is super large and the
> resulting tile set is very pixelated.
>
> The source file is located here in zip form (
> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)
>
> I've tried some of the solutions that specify to use the CONFIG_LONG
> option, but that doesn't seem to be impacting anything. The only solution I
> have come up with is to cut off the area which crosses the 180 which yields
> good results.
>
> I've included below the commands I've been using.  I'm looking for any
> suggestions/guidance. I realize this is somewhat of a common problem. Even
> MapTiler had the problem, but they have sent an updated version which
> supposedly fixes it, but I can't afford that solution at this point so I'd
> like to stick to GDAL if possible.
>
> Thanks,
>
> -jr
>
>
> --- snip --
>
> gdal_translate \
>     -expand rgb \
>     -strict \
>     -co TILED=YES \
>     -co COMPRESS=LZW \
>     -co BIGTIFF=YES \
>     alaska.tif alaska_expanded_rgb.vrt
>
> gdalwarp \
>        -overwrite                  \
>        -cutline "Alaska_Wall_Planning_Chart.shp"       \
>        -crop_to_cutline            \
>        -cblend 10                  \
>        -r lanczos                  \
>        -dstalpha                   \
>        -co ALPHA=YES               \
>        -co TILED=YES               \
>        -multi                      \
>        -wo NUM_THREADS=ALL_CPUS    \
>        -wm 1024                    \
>        --config GDAL_CACHEMAX 1024 \
>        "alaska_expanded_rgb.vrt"   \
>        "alaska_clipped.vrt"
>
> gdalwarp \
>         -t_srs EPSG:3857            \
>         -te -19497422 6016546 -13438444 11497579 \
>         -r lanczos                  \
>         -overwrite                  \
>         -multi                      \
>         -wo NUM_THREADS=ALL_CPUS    \
>         -wm 1024                    \
>         --config GDAL_CACHEMAX 1024 \
>         -co TILED=YES               \
>         "alaska_clipped.vrt" \
>         "alaska_warped.vrt"
>
> gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet alaska_warped.vrt
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201125/4b9af5d0/attachment-0001.html>

From even.rouault at spatialys.com  Thu Nov 26 06:45:40 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Nov 2020 15:45:40 +0100
Subject: [gdal-dev] Broken PDF support due to Ubuntu 16.04 and 18.04
 security updates
Message-ID: <2179939.jfQG61z4eH@even-i700>

Hi,

FYI, the latest security updates on the Poppler library in Ubuntu 16.04 and 
18.04 break GDAL PDF output.
See https://github.com/OSGeo/gdal/pull/3235 for a workaround installing the 
previous functional versions.
Issue reported upstream at 
https://bugs.launchpad.net/ubuntu/+source/poppler/+bug/1905741

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Nov 26 06:54:43 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Nov 2020 15:54:43 +0100
Subject: [gdal-dev] Broken PDF support due to Ubuntu 16.04 and 18.04
 security updates
In-Reply-To: <2179939.jfQG61z4eH@even-i700>
References: <2179939.jfQG61z4eH@even-i700>
Message-ID: <4167853.NTCHNxf7lW@even-i700>

On jeudi 26 novembre 2020 15:45:40 CET Even Rouault wrote:
> Hi,
> 
> FYI, the latest security updates on the Poppler library in Ubuntu 16.04 and
> 18.04 break GDAL PDF output.

Sorry, the above was badly formulated: it actually breaks *reading* raster 
content from a PDF (like gdal_translate in.pdf out.tif). Generating PDF still 
works apparently.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jr at halo3.net  Thu Nov 26 07:01:48 2020
From: jr at halo3.net (James Russo)
Date: Thu, 26 Nov 2020 10:01:48 -0500
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
In-Reply-To: <0b8264d1c2e364a8ce0aa3aeed08732f@blixtmail.se>
References: <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
 <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>
 <0b8264d1c2e364a8ce0aa3aeed08732f@blixtmail.se>
Message-ID: <CAMo+_BWHKRx=094hWg-WcQxdQ9EqR9hctt6YGauk6k3xCtZwJQ@mail.gmail.com>

Lars,

Sorry! My apologies. Despite double checking, there was a copy and paste
error in the script. The second gdalwarp with the -te was outputting to the
same path as the no sliced version. Corrected script below. I appreciate
you looking into this with me!

*additionally, My original reply directly to you also included a typo. This
script should be good!

-jr

---snip---
#!/bin/bash

wget -SN https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip &&
unzip -xo AK_WallPlan_2.zip
mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
gdal_translate  -expand rgb  -strict  -co TILED=YES -co COMPRESS=LZW  -co
BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo
NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES
alaska_expanded_rgb.vrt alaska_warped.vrt
gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r
lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config
GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt
alaska_warped_sliced_at_180.vrt
rm -rf alaska_tiles_no_slice
rm -rf alaska_tiles_sliced_at_180
gdalinfo alaska_warped.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
alaska_warped.vrt alaska_tiles_no_slice
gdalinfo alaska_warped_sliced_at_180.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180

---snip---

On Thu, Nov 26, 2020 at 9:55 AM <lars.schylberg at blixtmail.se> wrote:

> Hi,
>
> I tried to reproduce your experiment. It seems like the command that
> produces "alaska_warped_sliced_at_180.vrt" is missing in your script.
> I guess that step could be vital to understand what is going on.
>
> Best regards
>
> /Lars Schylberg
>
> 26 november 2020 kl. 03:42, "James Russo" <jr at halo3.net
> <jr at halo3.net?to=%22James%20Russo%22%20%3Cjr at halo3.net%3E>> skrev:
>
> Good Evening,
> I'm just following up on this question from a few days ago with some more
> information and the script I am using which reproduces this issue.
> The example results can be found here at the s3 links below and are all
> generated from the same original GeoTIFF. The only difference is that on
> one of them I slice off all data left of the 180, the other one the map is
> left complete. The html files are set to the same example point and zoom
> level to show how that without slicing the file, the image quality is very
> poor. The one thing I notice is that if I include the 180 meridian, the
> number of tiles generated is far larger (46k vs 8k).
> Bad Results:
>
> http://halo3.net/alaska_tiles_no_slice/leaflet.html
>
> Good Results:
>
> http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html
>
> Below is the script I use to generate both tile sets. It will
> automatically download, unzip and process the input file I am using
> producing the same results shown at the links above.
> I'd appreciate any insight into the issue and how I might be able to get
> it resolved? I'm still quite a novice at all this GIS stuff, but it has
> been a fun experience so far.
> Thanks,
> -jr
> ---snip---
> #!/bin/bash
> wget -SN
> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip &&
> unzip -xo AK_WallPlan_2.zip
> mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
> gdal_translate -expand rgb -strict -co TILED=YES -co COMPRESS=LZW -co
> BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
> gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo
> NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES
> alaska_expanded_rgb.vrt alaska_warped.vrt
> gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r
> lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config
> GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
> rm -rf alaska_tiles_no_slice
> rm -rf alaska_tiles_sliced_at_180
> gdalinfo alaska_warped.vrt
> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
> alaska_warped.vrt alaska_tiles_no_slice
> gdalinfo alaska_warped_sliced_at_180.vrt
> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
> alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180
> ---snip---
> On Tue, Nov 24, 2020 at 6:20 AM James Russo <jr at halo3.net> wrote:
>
> Good Evening,
> GIS novice here. I have a GEOTiff that I'm trying to create tiles from
> which crosses the 180. It's a FAA sectional chart from the US used for
> aviation. If I slice off anything west of the 180, I can generate the tiles
> and they look good. If I don't the area of the tiles is super large and the
> resulting tile set is very pixelated.
> The source file is located here in zip form (
> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)
> I've tried some of the solutions that specify to use the CONFIG_LONG
> option, but that doesn't seem to be impacting anything. The only solution I
> have come up with is to cut off the area which crosses the 180 which yields
> good results.
> I've included below the commands I've been using. I'm looking for any
> suggestions/guidance. I realize this is somewhat of a common problem. Even
> MapTiler had the problem, but they have sent an updated version which
> supposedly fixes it, but I can't afford that solution at this point so I'd
> like to stick to GDAL if possible.
> Thanks,
> -jr
> --- snip --
> gdal_translate \
> -expand rgb \
> -strict \
> -co TILED=YES \
> -co COMPRESS=LZW \
> -co BIGTIFF=YES \
> alaska.tif alaska_expanded_rgb.vrt
>
> gdalwarp \
> -overwrite \
> -cutline "Alaska_Wall_Planning_Chart.shp" \
> -crop_to_cutline \
> -cblend 10 \
> -r lanczos \
> -dstalpha \
> -co ALPHA=YES \
> -co TILED=YES \
> -multi \
> -wo NUM_THREADS=ALL_CPUS \
> -wm 1024 \
> --config GDAL_CACHEMAX 1024 \
> "alaska_expanded_rgb.vrt" \
> "alaska_clipped.vrt"
>
> gdalwarp \
> -t_srs EPSG:3857 \
> -te -19497422 6016546 -13438444 11497579 \
> -r lanczos \
> -overwrite \
> -multi \
> -wo NUM_THREADS=ALL_CPUS \
> -wm 1024 \
> --config GDAL_CACHEMAX 1024 \
> -co TILED=YES \
> "alaska_clipped.vrt" \
> "alaska_warped.vrt"
> gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet alaska_warped.vrt
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201126/3024ebbe/attachment.html>

From lars.schylberg at blixtmail.se  Thu Nov 26 06:55:48 2020
From: lars.schylberg at blixtmail.se (lars.schylberg at blixtmail.se)
Date: Thu, 26 Nov 2020 14:55:48 +0000
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
In-Reply-To: <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>
References: <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>
 <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
Message-ID: <0b8264d1c2e364a8ce0aa3aeed08732f@blixtmail.se>

Hi,

I tried to reproduce your experiment. It seems like the command that produces "alaska_warped_sliced_at_180.vrt" is missing in your script.
I guess that step could be vital to understand what is going on.

Best regards

/Lars Schylberg

26 november 2020 kl. 03:42, "James Russo" <jr at halo3.net (mailto:jr at halo3.net?to=%22James%20Russo%22%20<jr at halo3.net>)> skrev:
Good Evening, 
I'm just following up on this question from a few days ago with some more information and the script I am using which reproduces this issue. 
The example results can be found here at the s3 links below and are all generated from the same original GeoTIFF. The only difference is that on one of them I slice off all data left of the 180, the other one the map is left complete. The html files are set to the same example point and zoom level to show how that without slicing the file, the image quality is very poor. The one thing I notice is that if I include the 180 meridian, the number of tiles generated is far larger (46k vs 8k). 
Bad Results:  
http://halo3.net/alaska_tiles_no_slice/leaflet.html (http://halo3.net/alaska_tiles_no_slice/leaflet.html) 
Good Results: 
http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html (http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html) 
Below is the script I use to generate both tile sets. It will automatically download, unzip and process the input file I am using producing the same results shown at the links above. 
I'd appreciate any insight into the issue and how I might be able to get it resolved? I'm still quite a novice at all this GIS stuff, but it has been a fun experience so far. 
Thanks, 
-jr 
---snip--- 
#!/bin/bash 
wget -SN https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip) && unzip -xo AK_WallPlan_2.zip 
mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
gdal_translate -expand rgb -strict -co TILED=YES -co COMPRESS=LZW -co BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
rm -rf alaska_tiles_no_slice
rm -rf alaska_tiles_sliced_at_180
gdalinfo alaska_warped.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped.vrt alaska_tiles_no_slice
gdalinfo alaska_warped_sliced_at_180.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180 
---snip--- 
 On Tue, Nov 24, 2020 at 6:20 AM James Russo <jr at halo3.net (mailto:jr at halo3.net)> wrote: Good Evening,
GIS novice here. I have a GEOTiff that I'm trying to create tiles from which crosses the 180. It's a FAA sectional chart from the US used for aviation. If I slice off anything west of the 180, I can generate the tiles and they look good. If I don't the area of the tiles is super large and the resulting tile set is very pixelated. 
The source file is located here in zip form (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)) 
I've tried some of the solutions that specify to use the CONFIG_LONG option, but that doesn't seem to be impacting anything. The only solution I have come up with is to cut off the area which crosses the 180 which yields good results. 
I've included below the commands I've been using. I'm looking for any suggestions/guidance. I realize this is somewhat of a common problem. Even MapTiler had the problem, but they have sent an updated version which supposedly fixes it, but I can't afford that solution at this point so I'd like to stick to GDAL if possible. 
Thanks, 
-jr 
--- snip -- 
gdal_translate  
-expand rgb 
-strict 
-co TILED=YES 
-co COMPRESS=LZW 
-co BIGTIFF=YES 
alaska.tif alaska_expanded_rgb.vrt

gdalwarp 
-overwrite 
-cutline "Alaska_Wall_Planning_Chart.shp" 
-crop_to_cutline 
-cblend 10 
-r lanczos 
-dstalpha 
-co ALPHA=YES 
-co TILED=YES 
-multi 
-wo NUM_THREADS=ALL_CPUS 
-wm 1024 
--config GDAL_CACHEMAX 1024 
"alaska_expanded_rgb.vrt" 
"alaska_clipped.vrt"

gdalwarp 
-t_srs EPSG:3857 
-te -19497422 6016546 -13438444 11497579 
-r lanczos 
-overwrite 
-multi 
-wo NUM_THREADS=ALL_CPUS 
-wm 1024 
--config GDAL_CACHEMAX 1024 
-co TILED=YES 
"alaska_clipped.vrt" 
"alaska_warped.vrt" 
gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet alaska_warped.vrt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201126/83681c0d/attachment-0001.html>

From idan at miara.com  Thu Nov 26 08:49:31 2020
From: idan at miara.com (Idan Miara)
Date: Thu, 26 Nov 2020 18:49:31 +0200
Subject: [gdal-dev] warp srs: xyz format point cloud
Message-ID: <CAEDrt3_0oCVMMhJw-APqW+xgfyKmAKVSHkp2s7XXkxzJE=PF4g@mail.gmail.com>

Hi all,

I have a UTM raster that I want to warp translate to xyz format and
transform the coordinates to EPSG:4326, I could use:
`gdalwarp -of xyz -t_srs EPSG:4326 utm.tif 4326.xyz`

But surely I get a 4326 grid, so my data points were altered to fit the new
grid.
I could write a function that iterates over the pixels and translates each
point, but is there a more elegant way to transform coordinates without
forcing the target srs grid?

Kind regards,
Idan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201126/8914c326/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Nov 26 09:35:58 2020
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 26 Nov 2020 10:35:58 -0700 (MST)
Subject: [gdal-dev] warp srs: xyz format point cloud
In-Reply-To: <CAEDrt3_0oCVMMhJw-APqW+xgfyKmAKVSHkp2s7XXkxzJE=PF4g@mail.gmail.com>
References: <CAEDrt3_0oCVMMhJw-APqW+xgfyKmAKVSHkp2s7XXkxzJE=PF4g@mail.gmail.com>
Message-ID: <1606412158225-0.post@n6.nabble.com>

Hi,

Because you are changing from the raster world into vector world I would it
somehow
- convert raster in native CRS into xyz
- write a vector VRT file for converting xyz data into points
- re-project the point dataset with ogr2ogr

Converting data into PostGIS raster could be more elegant and allows to live
between the two worlds in a flexible way.

-Jukka Rahkonen-



Idan Miara wrote
> Hi all,
> 
> I have a UTM raster that I want to warp translate to xyz format and
> transform the coordinates to EPSG:4326, I could use:
> `gdalwarp -of xyz -t_srs EPSG:4326 utm.tif 4326.xyz`
> 
> But surely I get a 4326 grid, so my data points were altered to fit the
> new
> grid.
> I could write a function that iterates over the pixels and translates each
> point, but is there a more elegant way to transform coordinates without
> forcing the target srs grid?
> 
> Kind regards,
> Idan
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Nov 26 14:02:14 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 26 Nov 2020 23:02:14 +0100
Subject: [gdal-dev] Broken PDF support due to Ubuntu 16.04 and 18.04
 security updates [SOLVED]
In-Reply-To: <2179939.jfQG61z4eH@even-i700>
References: <2179939.jfQG61z4eH@even-i700>
Message-ID: <12655229.y9hUpGoUU9@even-i700>

On jeudi 26 novembre 2020 15:45:40 CET Even Rouault wrote:
> Hi,
> 
> FYI, the latest security updates on the Poppler library in Ubuntu 16.04 and
> 18.04 break GDAL PDF output.
> See https://github.com/OSGeo/gdal/pull/3235 for a workaround installing the
> previous functional versions.
> Issue reported upstream at
> https://bugs.launchpad.net/ubuntu/+source/poppler/+bug/1905741

The issue has been promptly fixed upstream and fixed packages are now 
available.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Daniel.Evans at jbarisk.com  Fri Nov 27 07:13:14 2020
From: Daniel.Evans at jbarisk.com (Daniel Evans)
Date: Fri, 27 Nov 2020 15:13:14 +0000
Subject: [gdal-dev] Should a custom error handler (in Python) clear the last
 error?
Message-ID: <CWLP123MB2946A6F3E623F194C9A5D3AE95F80@CWLP123MB2946.GBRP123.PROD.OUTLOOK.COM>

Hello,

In the Python bindings, after calling `gdal.UseExceptions()` trying something like an out-of-range raster read will raise an error like:

[ ... traceback ... ]
  File "/home/jbanorthwest.co.uk/danielevans/venvs/farmcat3/lib64/python3.6/site-packages/osgeo/gdal_array.py", line 246, in _RaiseException
    raise RuntimeError(gdal.GetLastErrorMsg())
RuntimeErrorRuntimeError: /data/gfm/maps/FLRF_Q100.vrt, band 1: Access window out of range in RasterIO().  Requested
(1,123456789) of size 1x1 on raster of 1296001x507215.


It is possible to set a custom error handler to determine how log messages should be recorded. For example, to silence all logging:

gdal.SetErrorHandler('CPLQuietErrorHandler')

Or to point to a custom Python error handling function:

gdal.SetErrorHandler(self.log)



This does not affect the act exceptions being raised. However, GDAL no longer shows the last error message:

  File "/home/jbanorthwest.co.uk/danielevans/venvs/farmcat3/lib64/python3.6/site-packages/osgeo/gdal_array.py", line 246, in _RaiseException
    raise RuntimeError(gdal.GetLastErrorMsg())
RuntimeError

This implies that `gdal.GetLastErrorMsg()` is returning nothing, i.e. that the last error has been cleared. However, this seems to be at odds with the C++ documentation for the CPLError() function, which states that:


Regardless of how application error handlers or the default error handler choose to handle an error, the error number, and message will be stored for recovery with CPLGetLastErrorNo()<https://gdal.org/doxygen/cpl__error_8h.html#a4a583fe987b8f1a7b2468805578fa8d4> and CPLGetLastErrorMsg()<https://gdal.org/doxygen/cpl__error_8h.html#a7f71ade3bb0a0e9e45802975ec59ff5e>.
https://gdal.org/doxygen/cpl__error_8h.html#afda4d86428c1c533449ae6a69cdf430d


Is the error message being cleared incorrectly?


Dr Daniel Evans
Software Developer


[JBA COVID-19 statement]<https://www.jbagroup.co.uk/sites/www.jbagroup.co.uk/files/documents/15-030%20JBA%20Business%20Continuity%20Briefing%20-%20Latest.pdf>

T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png]  [Follow us on Twitter] <https://twitter.com/jbarisk>

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201127/88dff911/attachment.html>

From juliermeopensourcedeveloper at gmail.com  Fri Nov 27 10:14:20 2020
From: juliermeopensourcedeveloper at gmail.com (1520 gis)
Date: Fri, 27 Nov 2020 15:14:20 -0300
Subject: [gdal-dev] Grep gdalinfo subdataset
Message-ID: <CAKTKyJJBBFH+rrRZApN79NsKk1Na-ZFR=gZTLxZ1W4UB+V4Xqw@mail.gmail.com>

Hi all,

I am trying to grep the SUBDATASET_X_NAME in gdalinfo.
I only need the WCS:url

If I grep the subdataset [1], the string slice "SUBDATASET_5_NAME" comes
together. I would like to know if I can get only WCS:url by using any
gdalinfo options.

I tried running [2] , but no success. Is there any gdalinfo option which
response is the same as in [1]?

Thank you very much for your time in advance.

Kind regards
Julierme


[1]
gdalinfo "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&version=2.0.1&request=GetCapabilities
" | grep 'nurc__Img_Sample'

[2]

gdalinfo -sd nurc__Img_Sample "WCS:
http://demo.geo-solutions.it/geoserver/ows?service=WCS&version=2.0.1&request=GetCapabilities
"
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201127/b60a44b5/attachment.html>

From bin.zhang at whu.edu.cn  Fri Nov 27 23:33:15 2020
From: bin.zhang at whu.edu.cn (=?UTF-8?B?5byg5paM?=)
Date: Sat, 28 Nov 2020 15:33:15 +0800 (GMT+08:00)
Subject: [gdal-dev] gdal unresolved external symbol
 for"GDALFindAssociatedFile" and "GDALWriteRPBFile"
Message-ID: <34150569.13f19.1760dc52ec7.Coremail.bin.zhang@whu.edu.cn>

Hi,
  I'm using GDAL 3.2.0 from http://www.gisinternals.com/. When I build my own program, it can not link successfully.
  Here is my code:

"
#include <iostream>
#include "gdal_priv.h"
#include "gdal_mdreader.h"

int main() {

    std::string pszFilename = R"(E:\datasets\MAR\18MAR10060250-P2AS-012787451020_01_P001.TIF)";

    GDALDataset* poDataset;
    GDALAllRegister();
    poDataset = (GDALDataset*)GDALOpen(pszFilename.c_str(), GA_ReadOnly);

    CPLString m_osRPBSourceFilename = GDALFindAssociatedFile(pszFilename.c_str(), "RPB", nullptr, 0);
    char** papszRPCMD = poDataset->GetMetadata("RPC");
    if (papszRPCMD != nullptr) {
        GDALWriteRPBFile( pszFilename.c_str(), papszRPCMD );
    }

    return 0;
}
"

  The building logs is the following:
"
E:\Software\jetbrains\CLion\bin\cmake\win\bin\cmake.exe --build E:\code\cpp\gdal_test\cmake-build-debug --target gdal_test
Scanning dependencies of target gdal_test
[ 50%] Building CXX object CMakeFiles/gdal_test.dir/main.cpp.obj
main.cpp
[100%] Linking CXX executable gdal_test.exe
LINK Pass 1: command "C:\PROGRA~2\MICROS~3\2019\COMMUN~1\VC\Tools\MSVC\1428~1.293\bin\Hostx64\x64\link.exe /nologo @CMakeFiles\gdal_test.dir\objects1.rsp /out:gdal_test.exe /implib:gdal_test.lib /pdb:E:\code\cpp\gdal_test\cmake-build-debug\gdal_test.pdb /version:0.0 /machine:x64 /debug /INCREMENTAL /subsystem:console E:\Software\3rdLib\gdal_binaries\lib\gdal_i.lib kernel32.lib user32.lib gdi32.lib winspool.lib shell32.lib ole32.lib oleaut32.lib uuid.lib comdlg32.lib advapi32.lib /MANIFEST /MANIFESTFILE:CMakeFiles\gdal_test.dir/intermediate.manifest CMakeFiles\gdal_test.dir/manifest.res" failed (exit code 1120) with the following output:
main.cpp.obj : error LNK2019: ????????? "class CPLString __cdecl GDALFindAssociatedFile(char const *,char const *,char const * const *,int)" (?GDALFindAssociatedFile@@YA?AVCPLString@@PEBD0PEBQEBDH at Z)??? main ???????
main.cpp.obj : error LNK2019: ????????? "enum CPLErr __cdecl GDALWriteRPBFile(char const *,char * *)" (?GDALWriteRPBFile@@YA?AW4CPLErr@@PEBDPEAPEAD at Z)??? main ???????
gdal_test.exe : fatal error LNK1120: 2 ??????????
NMAKE : fatal error U1077: ?E:\Software\jetbrains\CLion\bin\cmake\win\bin\cmake.exe?: ?????0xffffffff?
Stop.
NMAKE : fatal error U1077: ?"C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.28.29333\bin\HostX64\x64\nmake.exe"?: ?????0x2?
Stop.
NMAKE : fatal error U1077: ?"C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.28.29333\bin\HostX64\x64\nmake.exe"?: ?????0x2?
Stop.
NMAKE : fatal error U1077: ?"C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\VC\Tools\MSVC\14.28.29333\bin\HostX64\x64\nmake.exe"?: ?????0x2?
Stop.
"

From jr at halo3.net  Sat Nov 28 07:44:14 2020
From: jr at halo3.net (James Russo)
Date: Sat, 28 Nov 2020 10:44:14 -0500
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
In-Reply-To: <CAMo+_BWHKRx=094hWg-WcQxdQ9EqR9hctt6YGauk6k3xCtZwJQ@mail.gmail.com>
References: <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
 <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>
 <0b8264d1c2e364a8ce0aa3aeed08732f@blixtmail.se>
 <CAMo+_BWHKRx=094hWg-WcQxdQ9EqR9hctt6YGauk6k3xCtZwJQ@mail.gmail.com>
Message-ID: <CAMo+_BWnisb0JLQsY6fPWUBX-7cnbHg+4C9UwBaBcqA5Yx_yUQ@mail.gmail.com>

Good Morning,

I have a stackoverflow on this issue if anyone can give some info. It turns
out that if you force the resolution in the warp, the resulting file does
look good.

https://gis.stackexchange.com/questions/380002/issue-creating-tiles-from-geotiff-which-crosses-the-180th-meridian/

On Thu, Nov 26, 2020 at 10:01 AM James Russo <jr at halo3.net> wrote:

> Lars,
>
> Sorry! My apologies. Despite double checking, there was a copy and paste
> error in the script. The second gdalwarp with the -te was outputting to the
> same path as the no sliced version. Corrected script below. I appreciate
> you looking into this with me!
>
> *additionally, My original reply directly to you also included a typo.
> This script should be good!
>
> -jr
>
> ---snip---
> #!/bin/bash
>
> wget -SN
> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip &&
> unzip -xo AK_WallPlan_2.zip
> mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
> gdal_translate  -expand rgb  -strict  -co TILED=YES -co COMPRESS=LZW  -co
> BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
> gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo
> NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES
> alaska_expanded_rgb.vrt alaska_warped.vrt
> gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r
> lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config
> GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt
> alaska_warped_sliced_at_180.vrt
> rm -rf alaska_tiles_no_slice
> rm -rf alaska_tiles_sliced_at_180
> gdalinfo alaska_warped.vrt
> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
> alaska_warped.vrt alaska_tiles_no_slice
> gdalinfo alaska_warped_sliced_at_180.vrt
> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
> alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180
>
> ---snip---
>
> On Thu, Nov 26, 2020 at 9:55 AM <lars.schylberg at blixtmail.se> wrote:
>
>> Hi,
>>
>> I tried to reproduce your experiment. It seems like the command that
>> produces "alaska_warped_sliced_at_180.vrt" is missing in your script.
>> I guess that step could be vital to understand what is going on.
>>
>> Best regards
>>
>> /Lars Schylberg
>>
>> 26 november 2020 kl. 03:42, "James Russo" <jr at halo3.net
>> <jr at halo3.net?to=%22James%20Russo%22%20%3Cjr at halo3.net%3E>> skrev:
>>
>> Good Evening,
>> I'm just following up on this question from a few days ago with some more
>> information and the script I am using which reproduces this issue.
>> The example results can be found here at the s3 links below and are all
>> generated from the same original GeoTIFF. The only difference is that on
>> one of them I slice off all data left of the 180, the other one the map is
>> left complete. The html files are set to the same example point and zoom
>> level to show how that without slicing the file, the image quality is very
>> poor. The one thing I notice is that if I include the 180 meridian, the
>> number of tiles generated is far larger (46k vs 8k).
>> Bad Results:
>>
>> http://halo3.net/alaska_tiles_no_slice/leaflet.html
>>
>> Good Results:
>>
>> http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html
>>
>> Below is the script I use to generate both tile sets. It will
>> automatically download, unzip and process the input file I am using
>> producing the same results shown at the links above.
>> I'd appreciate any insight into the issue and how I might be able to get
>> it resolved? I'm still quite a novice at all this GIS stuff, but it has
>> been a fun experience so far.
>> Thanks,
>> -jr
>> ---snip---
>> #!/bin/bash
>> wget -SN
>> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip &&
>> unzip -xo AK_WallPlan_2.zip
>> mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
>> gdal_translate -expand rgb -strict -co TILED=YES -co COMPRESS=LZW -co
>> BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
>> gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo
>> NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES
>> alaska_expanded_rgb.vrt alaska_warped.vrt
>> gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r
>> lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config
>> GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
>> rm -rf alaska_tiles_no_slice
>> rm -rf alaska_tiles_sliced_at_180
>> gdalinfo alaska_warped.vrt
>> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
>> alaska_warped.vrt alaska_tiles_no_slice
>> gdalinfo alaska_warped_sliced_at_180.vrt
>> time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet
>> alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180
>> ---snip---
>> On Tue, Nov 24, 2020 at 6:20 AM James Russo <jr at halo3.net> wrote:
>>
>> Good Evening,
>> GIS novice here. I have a GEOTiff that I'm trying to create tiles from
>> which crosses the 180. It's a FAA sectional chart from the US used for
>> aviation. If I slice off anything west of the 180, I can generate the tiles
>> and they look good. If I don't the area of the tiles is super large and the
>> resulting tile set is very pixelated.
>> The source file is located here in zip form (
>> https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)
>> I've tried some of the solutions that specify to use the CONFIG_LONG
>> option, but that doesn't seem to be impacting anything. The only solution I
>> have come up with is to cut off the area which crosses the 180 which yields
>> good results.
>> I've included below the commands I've been using. I'm looking for any
>> suggestions/guidance. I realize this is somewhat of a common problem. Even
>> MapTiler had the problem, but they have sent an updated version which
>> supposedly fixes it, but I can't afford that solution at this point so I'd
>> like to stick to GDAL if possible.
>> Thanks,
>> -jr
>> --- snip --
>> gdal_translate \
>> -expand rgb \
>> -strict \
>> -co TILED=YES \
>> -co COMPRESS=LZW \
>> -co BIGTIFF=YES \
>> alaska.tif alaska_expanded_rgb.vrt
>>
>> gdalwarp \
>> -overwrite \
>> -cutline "Alaska_Wall_Planning_Chart.shp" \
>> -crop_to_cutline \
>> -cblend 10 \
>> -r lanczos \
>> -dstalpha \
>> -co ALPHA=YES \
>> -co TILED=YES \
>> -multi \
>> -wo NUM_THREADS=ALL_CPUS \
>> -wm 1024 \
>> --config GDAL_CACHEMAX 1024 \
>> "alaska_expanded_rgb.vrt" \
>> "alaska_clipped.vrt"
>>
>> gdalwarp \
>> -t_srs EPSG:3857 \
>> -te -19497422 6016546 -13438444 11497579 \
>> -r lanczos \
>> -overwrite \
>> -multi \
>> -wo NUM_THREADS=ALL_CPUS \
>> -wm 1024 \
>> --config GDAL_CACHEMAX 1024 \
>> -co TILED=YES \
>> "alaska_clipped.vrt" \
>> "alaska_warped.vrt"
>> gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet
>> alaska_warped.vrt
>>
>>
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201128/7349b241/attachment.html>

From lars.schylberg at blixtmail.se  Sat Nov 28 12:14:10 2020
From: lars.schylberg at blixtmail.se (lars.schylberg at blixtmail.se)
Date: Sat, 28 Nov 2020 20:14:10 +0000
Subject: [gdal-dev] gdal2tiles with GeoTIFF which crosses antimeridian?
In-Reply-To: <CAMo+_BWnisb0JLQsY6fPWUBX-7cnbHg+4C9UwBaBcqA5Yx_yUQ@mail.gmail.com>
References: <CAMo+_BWnisb0JLQsY6fPWUBX-7cnbHg+4C9UwBaBcqA5Yx_yUQ@mail.gmail.com>
 <CAMo+_BXhEcNTQfw_+HchMMop-yA=arJUnBTgmzLUHHQnZpjjTQ@mail.gmail.com>
 <CAMo+_BX5FfMe+2VTQGDnuoBA3FgFewkfaqA23qNx+WW5mmB1vg@mail.gmail.com>
 <0b8264d1c2e364a8ce0aa3aeed08732f@blixtmail.se>
 <CAMo+_BWHKRx=094hWg-WcQxdQ9EqR9hctt6YGauk6k3xCtZwJQ@mail.gmail.com>
Message-ID: <c14bf5858bf7951632220294ee47265e@blixtmail.se>

Good Evening,

If You want to get rid of the white areas you do -dstalpha in the penultimate gdalwarp step.
That setting is to get all the areas outside to be transparent when You warp.

gdalwarp -t_srs EPSG:3857 -overwrite -multi -wo NUM_THREADS=ALL_CPUS -dstalpha -wm 1024 -tr 169 169 --config GDAL_CACHEMAX 1024 -co TILED=YES temp.vrt rgb.tif

I was thinking about another method to shift the image yesterday based on this idea:
https://github.com/OSGeo/gdal/issues/1182 ( (https://github.com/OSGeo/gdal/issues/1182)Evens last comment).
But my experiments didn't work out, to shift Web Mercator (3857). But I guess the computation should be less if that worked.

/Lars S.
28 november 2020 kl. 16:44, "James Russo" <jr at halo3.net (mailto:jr at halo3.net?to=%22James%20Russo%22%20<jr at halo3.net>)> skrev:
Good Morning, 
I have a stackoverflow on this issue if anyone can give some info. It turns out that if you force the resolution in the warp, the resulting file does look good.
https://gis.stackexchange.com/questions/380002/issue-creating-tiles-from-geotiff-which-crosses-the-180th-meridian/ (https://gis.stackexchange.com/questions/380002/issue-creating-tiles-from-geotiff-which-crosses-the-180th-meridian/)  
 On Thu, Nov 26, 2020 at 10:01 AM James Russo <jr at halo3.net (mailto:jr at halo3.net)> wrote:   
Lars,
Sorry! My apologies. Despite double checking, there was a copy and paste error in the script. The second gdalwarp with the -te was outputting to the same path as the no sliced version. Corrected script below. I appreciate you looking into this with me! 
*additionally, My original reply directly to you also included a typo. This script should be good! 
-jr
---snip--- 
#!/bin/bash 
wget -SN https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip) && unzip -xo AK_WallPlan_2.zip  
 mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
gdal_translate -expand rgb -strict -co TILED=YES -co COMPRESS=LZW -co BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped_sliced_at_180.vrt
rm -rf alaska_tiles_no_slice
rm -rf alaska_tiles_sliced_at_180
gdalinfo alaska_warped.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped.vrt alaska_tiles_no_slice
gdalinfo alaska_warped_sliced_at_180.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180  
---snip---     
 On Thu, Nov 26, 2020 at 9:55 AM <lars.schylberg at blixtmail.se (mailto:lars.schylberg at blixtmail.se)> wrote: 
Hi,

I tried to reproduce your experiment. It seems like the command that produces "alaska_warped_sliced_at_180.vrt" is missing in your script.
I guess that step could be vital to understand what is going on.

Best regards

/Lars Schylberg

26 november 2020 kl. 03:42, "James Russo" <jr at halo3.net (mailto:jr at halo3.net?to=%22James%20Russo%22%20%3Cjr at halo3.net%3E)> skrev:
Good Evening, 
I'm just following up on this question from a few days ago with some more information and the script I am using which reproduces this issue. 
The example results can be found here at the s3 links below and are all generated from the same original GeoTIFF. The only difference is that on one of them I slice off all data left of the 180, the other one the map is left complete. The html files are set to the same example point and zoom level to show how that without slicing the file, the image quality is very poor. The one thing I notice is that if I include the 180 meridian, the number of tiles generated is far larger (46k vs 8k). 
Bad Results:  
http://halo3.net/alaska_tiles_no_slice/leaflet.html (http://halo3.net/alaska_tiles_no_slice/leaflet.html) 
Good Results: 
http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html (http://halo3.net/alaska_tiles_sliced_at_180/leaflet.html) 
Below is the script I use to generate both tile sets. It will automatically download, unzip and process the input file I am using producing the same results shown at the links above. 
I'd appreciate any insight into the issue and how I might be able to get it resolved? I'm still quite a novice at all this GIS stuff, but it has been a fun experience so far. 
Thanks, 
-jr 
---snip--- 
#!/bin/bash 
wget -SN https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip) && unzip -xo AK_WallPlan_2.zip 
mv "Alaska Wall Planning Chart 2.tif" Alaska_Wall_Planning_Chart_2.tif
gdal_translate -expand rgb -strict -co TILED=YES -co COMPRESS=LZW -co BIGTIFF=YES Alaska_Wall_Planning_Chart_2.tif alaska_expanded_rgb.vrt
gdalwarp -t_srs EPSG:3857 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
gdalwarp -t_srs EPSG:3857 -te -19979999 6016546 -13438444 11497579 -r lanczos -overwrite -multi -wo NUM_THREADS=ALL_CPUS -wm 1024 --config GDAL_CACHEMAX 1024 -co TILED=YES alaska_expanded_rgb.vrt alaska_warped.vrt
rm -rf alaska_tiles_no_slice
rm -rf alaska_tiles_sliced_at_180
gdalinfo alaska_warped.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped.vrt alaska_tiles_no_slice
gdalinfo alaska_warped_sliced_at_180.vrt
time gdal2tiles.py -vvv -z 0-9 --processes=16 -r lanczos -w leaflet alaska_warped_sliced_at_180.vrt alaska_tiles_sliced_at_180 
---snip--- 
 On Tue, Nov 24, 2020 at 6:20 AM James Russo <jr at halo3.net (mailto:jr at halo3.net)> wrote: Good Evening,
GIS novice here. I have a GEOTiff that I'm trying to create tiles from which crosses the 180. It's a FAA sectional chart from the US used for aviation. If I slice off anything west of the 180, I can generate the tiles and they look good. If I don't the area of the tiles is super large and the resulting tile set is very pixelated. 
The source file is located here in zip form (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip (https://aeronav.faa.gov/content/aeronav/Planning/AK_WallPlan_2.zip)) 
I've tried some of the solutions that specify to use the CONFIG_LONG option, but that doesn't seem to be impacting anything. The only solution I have come up with is to cut off the area which crosses the 180 which yields good results. 
I've included below the commands I've been using. I'm looking for any suggestions/guidance. I realize this is somewhat of a common problem. Even MapTiler had the problem, but they have sent an updated version which supposedly fixes it, but I can't afford that solution at this point so I'd like to stick to GDAL if possible. 
Thanks, 
-jr 
--- snip -- 
gdal_translate  
-expand rgb 
-strict 
-co TILED=YES 
-co COMPRESS=LZW 
-co BIGTIFF=YES 
alaska.tif alaska_expanded_rgb.vrt

gdalwarp 
-overwrite 
-cutline "Alaska_Wall_Planning_Chart.shp" 
-crop_to_cutline 
-cblend 10 
-r lanczos 
-dstalpha 
-co ALPHA=YES 
-co TILED=YES 
-multi 
-wo NUM_THREADS=ALL_CPUS 
-wm 1024 
--config GDAL_CACHEMAX 1024 
"alaska_expanded_rgb.vrt" 
"alaska_clipped.vrt"

gdalwarp 
-t_srs EPSG:3857 
-te -19497422 6016546 -13438444 11497579 
-r lanczos 
-overwrite 
-multi 
-wo NUM_THREADS=ALL_CPUS 
-wm 1024 
--config GDAL_CACHEMAX 1024 
-co TILED=YES 
"alaska_clipped.vrt" 
"alaska_warped.vrt" 
gdal2tiles.py -z 0-8 --processes=16 -r lanczos -w leaflet alaska_warped.vrt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201128/c5fb57fc/attachment.html>

From runette at gmail.com  Sun Nov 29 14:45:59 2020
From: runette at gmail.com (Paul Harwood)
Date: Sun, 29 Nov 2020 22:45:59 +0000
Subject: [gdal-dev] NMEA files
Message-ID: <CAE8nN5ME2+scUkFBD8Geo6o1WCkqk99+3ZPPVdSqxsgk8e7VtQ@mail.gmail.com>

Hi

I am asking just in case someone has solved this problem already.

Does anyone know of a way to load NMEA format GPS data as OGR points in
GDAL?

Thanks

Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201129/5eebe9bb/attachment.html>

From even.rouault at spatialys.com  Sun Nov 29 15:16:20 2020
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 30 Nov 2020 00:16:20 +0100
Subject: [gdal-dev] NMEA files
In-Reply-To: <CAE8nN5ME2+scUkFBD8Geo6o1WCkqk99+3ZPPVdSqxsgk8e7VtQ@mail.gmail.com>
References: <CAE8nN5ME2+scUkFBD8Geo6o1WCkqk99+3ZPPVdSqxsgk8e7VtQ@mail.gmail.com>
Message-ID: <1885360.LsO2MV3loU@even-i700>

On dimanche 29 novembre 2020 22:45:59 CET Paul Harwood wrote:
> Hi
> 
> I am asking just in case someone has solved this problem already.
> 
> Does anyone know of a way to load NMEA format GPS data as OGR points in
> GDAL?

Yes, through the GPSBabel driver
( https://gdal.org/drivers/vector/gpsbabel.html ) provided the gpsbabel 
executable is accessible through the PATH.

$ echo '$GPGGA,194546.127,5231.525,N,01323.391,E,1,12,1.0,0.0,M,0.0,M,,*6E
$GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
$GPRMC,194546.127,A,5231.525,N,01323.391,E,2372.1,093.7,200220,000.0,W*40
$GPGGA,194547.127,5231.456,N,01324.467,E,1,12,1.0,0.0,M,0.0,M,,*63
$GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
$GPRMC,194547.127,A,5231.456,N,01324.467,E,3968.7,122.8,200220,000.0,W*4F
$GPGGA,194548.127,5230.657,N,01325.713,E,1,12,1.0,0.0,M,0.0,M,,*6F
$GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
$GPRMC,194548.127,A,5230.657,N,01325.713,E,3968.7,122.8,200220,000.0,W*43' > 
test.nmea

$ ogrinfo test.nmea
INFO: Open of `test.nmea'
      using driver `GPSBabel' successful.
1: tracks (Multi Line String)
2: track_points (Point)


Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From runette at gmail.com  Mon Nov 30 01:57:39 2020
From: runette at gmail.com (Paul Harwood)
Date: Mon, 30 Nov 2020 09:57:39 +0000
Subject: [gdal-dev] NMEA files
In-Reply-To: <1885360.LsO2MV3loU@even-i700>
References: <CAE8nN5ME2+scUkFBD8Geo6o1WCkqk99+3ZPPVdSqxsgk8e7VtQ@mail.gmail.com>
 <1885360.LsO2MV3loU@even-i700>
Message-ID: <CAE8nN5M__tt27HaRW+g1O5oOR8jK9wM-_fiKKZEs7RHZ1GVNiQ@mail.gmail.com>

cool. Thanks to both of you.

On Sun, 29 Nov 2020 at 23:16, Even Rouault <even.rouault at spatialys.com>
wrote:

> On dimanche 29 novembre 2020 22:45:59 CET Paul Harwood wrote:
> > Hi
> >
> > I am asking just in case someone has solved this problem already.
> >
> > Does anyone know of a way to load NMEA format GPS data as OGR points in
> > GDAL?
>
> Yes, through the GPSBabel driver
> ( https://gdal.org/drivers/vector/gpsbabel.html ) provided the gpsbabel
> executable is accessible through the PATH.
>
> $ echo '$GPGGA,194546.127,5231.525,N,01323.391,E,1,12,1.0,0.0,M,0.0,M,,*6E
> $GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
> $GPRMC,194546.127,A,5231.525,N,01323.391,E,2372.1,093.7,200220,000.0,W*40
> $GPGGA,194547.127,5231.456,N,01324.467,E,1,12,1.0,0.0,M,0.0,M,,*63
> $GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
> $GPRMC,194547.127,A,5231.456,N,01324.467,E,3968.7,122.8,200220,000.0,W*4F
> $GPGGA,194548.127,5230.657,N,01325.713,E,1,12,1.0,0.0,M,0.0,M,,*6F
> $GPGSA,A,3,01,02,03,04,05,06,07,08,09,10,11,12,1.0,1.0,1.0*30
> $GPRMC,194548.127,A,5230.657,N,01325.713,E,3968.7,122.8,200220,000.0,W*43'
> >
> test.nmea
>
> $ ogrinfo test.nmea
> INFO: Open of `test.nmea'
>       using driver `GPSBabel' successful.
> 1: tracks (Multi Line String)
> 2: track_points (Point)
>
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201130/dfbdedf6/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Mon Nov 30 23:44:06 2020
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Tue, 1 Dec 2020 07:44:06 +0000
Subject: [gdal-dev] New STACTA driver and gdal2tiles
Message-ID: <4a1e16d5aea74869a73912f1dfefbb6d@maanmittauslaitos.fi>

Hi,

I noticed that a new STACTA driver appeared with https://github.com/OSGeo/gdal/pull/3227. Probably gdal2tiles could be made to create a catalog json file like https://github.com/OSGeo/gdal/pull/3227/files#diff-f1b9f20b0e955285ddcebb0153367a254d3d0126a784e52b9ae36dba0eab023c and then the directory of files that gdal2tiles creates could be opened simply with the STACTA driver in only the "href" in "asset_templetes" points to correct place.  Am I right?

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20201201/0c7073e2/attachment.html>

