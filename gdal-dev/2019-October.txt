From javier at panoimagen.com  Tue Oct  1 08:54:37 2019
From: javier at panoimagen.com (Javier Becerra Elcinto)
Date: Tue, 1 Oct 2019 17:54:37 +0200
Subject: [gdal-dev] Issue decoding some jp2 files with rasterio/JP2OpenJPEG
Message-ID: <9fe94f83-67b1-3777-14a9-9d57e28cb7b4@panoimagen.com>

Hi,

Yesterday I submitted an issue at rasterio github's repository 
(https://github.com/mapbox/rasterio/issues/1790) regarding an error 
message while decoding some jpeg 2000 files. You can check there for the 
full details, the main part of the error message is:

|ERROR 1: skip: segment too long (2563) with max (687) for codeblock 0 
(p=1301, b=0, r=7, c=0) ERROR 1: Failed to decode. ERROR 1: Failed to 
decode tile 1/1 ERROR 1: opj_decode() failed ||ERROR 1: ov185090_201700_c025u89x10c24n.jp2, band 1: IReadBlock failed 
at X offset 0, Y offset 0: opj_decode() failed|
||

sgillies suggested me to post on this list, to see if someone has 
already found this issue. If you can take a look, in the issue 
description there is a link with two 'offending' jp2 files and one that 
is working properly for me.

As stated on the issue, a QGis 3.6.2 install on Windows opens these 
files properly, although there are 3 jpeg2000 drivers listed when I run 
'gdalinfo --formats' on that machine (vs only the JP2OpenJPEG driver 
only for the failing rasterio code).

Thanks for your time!

Regards,

Javier
-- 

Javier Becerra Elcinto

/Dr. Ing. de Telecomunicación/

/Director Técnico/

*PANOimagen, s.l.*

*Dirección:*

	

Calle Baltasar Gracián Nº13 - Oficina 3

	

26006 Logroño, La Rioja (Spain)

*Teléfono:*

	

+34 941 01 99 88 móvil:+34 680 257 524

*Web:*

	

www.panoimagen.com <http://www.panoimagen.com/> 
*e-mail:*javier at panoimagen.com <mailto:javier at panoimagen.com>


<https://twitter.com/panoimagen?lang=es> facebook 
<https://www.facebook.com/panoimagen/> 
<https://es.linkedin.com/company/panoimagen> github 
<https://github.com/PANOimagen>

	


	

De acuerdo con lo establecido por el Reglamento (UE) 2016/679, en 
materia de Protección de datos, le informamos que el Responsable del 
Tratamiento de sus datos es PANOIMAGEN, S.L. Utilizamos sus datos para 
prestarle los servicios que nos ha solicitado así como enviarle 
comunicaciones profesionales que sean de su interés.  Legitimados en el 
interés legítimo del responsable. No se cederán sus datos a terceros 
salvo obligación legal. Así mismo, le informamos que tiene derecho a 
acceder, rectificar y suprimir los datos, así como otros derechos, 
indicados en la información adicional, que puede ejercer en 
info at panoimagen.com <mailto:info at panoimagen.com>Este mensaje y sus 
archivos adjuntos van dirigidos exclusivamente a su destinatario, 
pudiendo contener información confidencial sometida a secreto 
profesional. No está permitida su reproducción o distribución sin 
nuestra autorización expresa. Si usted no es el destinatario final por 
favor elimínelo e infórmenos por esta vía.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: goeohnelnleekkbb.png
Type: image/png
Size: 13626 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0006.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: cbeiefcimflgieid.png
Type: image/png
Size: 2722 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0007.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dkmphcejkmofllck.png
Type: image/png
Size: 2428 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0008.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: honcgjecjfhhdlcj.png
Type: image/png
Size: 2539 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0009.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: bjobdnibgbeolifi.png
Type: image/png
Size: 989 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0010.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: dliaeehjjdngnmni.png
Type: image/png
Size: 16863 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/44f33ab7/attachment-0011.png>

From even.rouault at spatialys.com  Tue Oct  1 13:10:25 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 01 Oct 2019 22:10:25 +0200
Subject: [gdal-dev] Issue decoding some jp2 files with
	rasterio/JP2OpenJPEG
In-Reply-To: <9fe94f83-67b1-3777-14a9-9d57e28cb7b4@panoimagen.com>
References: <9fe94f83-67b1-3777-14a9-9d57e28cb7b4@panoimagen.com>
Message-ID: <1996460.U9IO6tX8FN@even-i700>

On mardi 1 octobre 2019 17:54:37 CEST Javier Becerra Elcinto wrote:
> Hi,
> 
> Yesterday I submitted an issue at rasterio github's repository
> (https://github.com/mapbox/rasterio/issues/1790) regarding an error
> message while decoding some jpeg 2000 files. You can check there for the
> 
> full details, the main part of the error message is:
> |ERROR 1: skip: segment too long (2563) with max (687) for codeblock 0
> 
> (p=1301, b=0, r=7, c=0) 

The above error comes directly from the openjpeg library. This is a openjpeg 
defect. I can reproduce it with latest version. Should be reported at
https://github.com/uclouvain/openjpeg/

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From brandon.biggs at ski.org  Tue Oct  1 14:52:58 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Tue, 1 Oct 2019 21:52:58 +0000
Subject: [gdal-dev] Getting Polygon Vectors Out of a dwg File?
Message-ID: <MWHPR1601MB12139D83EA91CC3B55821B21F39D0@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,

I am wondering how I can get polygon vectors out of a dwg file? Geojson is the easiest format for me to use, but I just need the data in something I can open that's not a picture so I can perform collision detection on the polygons. (apparently autocad is unable to export into any open formats).

I would prefer to use one of the existing applications to do a simple conversion from dwg to geojson, but I'm having trouble understanding the command line arguments and what application I need.

Since I want vector data, ogr2ogr<https://gdal.org/programs/ogr2ogr.html#ogr2ogr> looks like the application that I need.

The problem is I am not seeing any output file name in the argument list. I see update, append, and overwrite.

For the input file, I am only seeing dst_datasource_name, which I take to be my input. Dwg file.

Can someone please let me know what I am missing and if there is something else I should be reading?

Thank you,


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191001/8acc3c04/attachment.html>

From andrew at aitchison.me.uk  Tue Oct  1 23:53:37 2019
From: andrew at aitchison.me.uk (Andrew C Aitchison)
Date: Wed, 2 Oct 2019 07:53:37 +0100 (BST)
Subject: [gdal-dev] Getting Polygon Vectors Out of a dwg File?
In-Reply-To: <MWHPR1601MB12139D83EA91CC3B55821B21F39D0@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB12139D83EA91CC3B55821B21F39D0@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <alpine.DEB.2.21.1910020750080.12599@warden.aitchison.me.uk>

On Tue, 1 Oct 2019, Brandon Biggs wrote:

> Since I want vector data,
> ogr2ogr<https://gdal.org/programs/ogr2ogr.html#ogr2ogr> looks like
> the application that I need.
>
> The problem is I am not seeing any output file name in the argument
> list. I see update, append, and overwrite.
>
> For the input file, I am only seeing dst_datasource_name, which I
> take to be my input. Dwg file.
>
> Can someone please let me know what I am missing and if there is
> something else I should be reading?

THe synopsis reads:

ogr2ogr [--help-general] [-skipfailures] [-append] [-update]
         [-select field_list] [-where restricted_where|\@filename]
         [-progress] [-sql <sql statement>|\@filename] [-dialect dialect]
         [-preserve_fid] [-fid FID] [-limit nb_features]
         [-spat xmin ymin xmax ymax] [-spat_srs srs_def] [-geomfield field]
         [-a_srs srs_def] [-t_srs srs_def] [-s_srs srs_def] [-ct string]
         [-f format_name] [-overwrite] [[-dsco NAME=VALUE] ...]
         dst_datasource_name src_datasource_name
         [-lco NAME=VALUE] [-nln name]
         [-nlt type|PROMOTE_TO_MULTI|CONVERT_TO_LINEAR|CONVERT_TO_CURVE]
         [-dim XY|XYZ|XYM|XYZM|2|3|layer_dim] [layer [layer ...]]

the line "dst_datasource_name src_datasource_name" indicates that you
specify the destination filename and then the source filename
(note the order).

-- 
Andrew C. Aitchison					Kendal, UK
 			andrew at aitchison.me.uk

From morten at breiner.dk  Thu Oct  3 01:10:00 2019
From: morten at breiner.dk (Morten Breiner)
Date: Thu, 3 Oct 2019 10:10:00 +0200
Subject: [gdal-dev] GDAL 3.0 Nuget packages...
Message-ID: <816d2ea5-ae51-13c7-dea0-e760e1543830@breiner.dk>

Hi,

Currently, I am using GDAL 2.4.2 for some c# development in Visual Studio.

I have installed the nuget packages found under 
https://www.nuget.org/packages/GDAL/2.4.2 (many thanks to all involved 
in maintaining those).

 From the download statistics 
(https://www.nuget.org/stats/packages/GDAL?groupby=Version), I can see 
that some attempt to support GDAL 3.0 has been made, but the packages 
have been unlisted unfortunately.

Does any of you know if a release of nuget packages for GDAL 3.0 has 
been scheduled or as an alternative, if recommended GDAL 3.0 packages 
for c# can be downloaded elsewhere?

Many thanks in advance for clarifying answers.

BR
-Morten Breiner

From mateusz at loskot.net  Thu Oct  3 01:33:24 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 3 Oct 2019 10:33:24 +0200
Subject: [gdal-dev] GDAL 3.0 Nuget packages...
In-Reply-To: <816d2ea5-ae51-13c7-dea0-e760e1543830@breiner.dk>
References: <816d2ea5-ae51-13c7-dea0-e760e1543830@breiner.dk>
Message-ID: <CABUeae-rUd4F1_YZqkmwyaJuO62JjhXpOqPUo_4tr+qOukb2aQ@mail.gmail.com>

On Thu, 3 Oct 2019 at 10:26, Morten Breiner <morten at breiner.dk> wrote:
>
>  From the download statistics
> (https://www.nuget.org/stats/packages/GDAL?groupby=Version), I can see
> that some attempt to support GDAL 3.0 has been made, but the packages
> have been unlisted unfortunately.
>
> Does any of you know if a release of nuget packages for GDAL 3.0 has
> been scheduled

Those are not official GDAL packages but third-party publications.
You will need to "Contact owners" at https://www.nuget.org/packages/GDAL/

> or as an alternative, if recommended GDAL 3.0 packages
> for c# can be downloaded elsewhere?

Check binaries and SDKs regularly published by Tamas,
maintainer of C# bindings, at https://www.gisinternals.com

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From szekerest at gmail.com  Thu Oct  3 06:49:23 2019
From: szekerest at gmail.com (Tamas Szekeres)
Date: Thu, 3 Oct 2019 15:49:23 +0200
Subject: [gdal-dev] GDAL 3.0 Nuget packages...
In-Reply-To: <816d2ea5-ae51-13c7-dea0-e760e1543830@breiner.dk>
References: <816d2ea5-ae51-13c7-dea0-e760e1543830@breiner.dk>
Message-ID: <CACALY+QRbOKddQyPXGbaf-eUeNNOPKRLBpvP6ZME6YiUhW7ofg@mail.gmail.com>

Hi Morten,

There have been problems with the GDAL 3.0 nuget versions, that's why that
was unlisted.
Specifically, the way how proj6 would want to find proj.db is not
satisfactory regarding to the C# applications.
I'm still working on a solution.

Best regards,

Tamas




Morten Breiner <morten at breiner.dk> ezt írta (időpont: 2019. okt. 3., Cs,
10:26):

> Hi,
>
> Currently, I am using GDAL 2.4.2 for some c# development in Visual Studio.
>
> I have installed the nuget packages found under
> https://www.nuget.org/packages/GDAL/2.4.2 (many thanks to all involved
> in maintaining those).
>
>  From the download statistics
> (https://www.nuget.org/stats/packages/GDAL?groupby=Version), I can see
> that some attempt to support GDAL 3.0 has been made, but the packages
> have been unlisted unfortunately.
>
> Does any of you know if a release of nuget packages for GDAL 3.0 has
> been scheduled or as an alternative, if recommended GDAL 3.0 packages
> for c# can be downloaded elsewhere?
>
> Many thanks in advance for clarifying answers.
>
> BR
> -Morten Breiner
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/ba52e43e/attachment.html>

From sean at mapbox.com  Thu Oct  3 09:14:45 2019
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 3 Oct 2019 10:14:45 -0600
Subject: [gdal-dev] Clarification on what is not addressed by GDALFlushCache
Message-ID: <CADPhZXwDA8i_U45cPqRAdcWjFyfH7jzXvO_VPbpQ3W6sLL5wrg@mail.gmail.com>

In the comments above FlushCache() in gcore/gdaldataset.cpp it is said:

 * Using this method does not prevent use from calling GDALClose()
 * to properly close a dataset and ensure that important data not addressed
 * by FlushCache() is written in the file.

What exactly is the important data that is not addressed? Does it vary by
format and driver?

Thanks!

-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/95dcfcdd/attachment.html>

From even.rouault at spatialys.com  Thu Oct  3 10:04:23 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 03 Oct 2019 19:04:23 +0200
Subject: [gdal-dev] Clarification on what is not addressed by
	GDALFlushCache
In-Reply-To: <CADPhZXwDA8i_U45cPqRAdcWjFyfH7jzXvO_VPbpQ3W6sLL5wrg@mail.gmail.com>
References: <CADPhZXwDA8i_U45cPqRAdcWjFyfH7jzXvO_VPbpQ3W6sLL5wrg@mail.gmail.com>
Message-ID: <1742909.atRMgI486a@even-i700>

On jeudi 3 octobre 2019 10:14:45 CEST Sean Gillies wrote:
> In the comments above FlushCache() in gcore/gdaldataset.cpp it is said:
> 
>  * Using this method does not prevent use from calling GDALClose()
>  * to properly close a dataset and ensure that important data not addressed
>  * by FlushCache() is written in the file.

> Does it vary by
> format and driver?

Of course, wouldn't be fun otherwise. For some formats, it might result in a 
completely consistent dataset, and in others, in something that can't be 
opened at all. So what is does, beyond evicting 'dirty' blocks from the cahce, 
is mostly an implementation detail.

> What exactly is the important data that is not addressed?

In the case of GeoTIFF, FlushCache() will for example ensure that all tile/
strip data is flushed to disk, but the TileByteCount/TileOffset index arrays 
are not updated, and os a file that was just created, they will be at their 
zero default value, making the dataset appear to be empty to a reader that 
would try to open it at that point.

If generating a large dataset, you can for example call FlushCache() at 
regular intervals to make sure that there is sufficiently space on the storage 
device (but the global block cache will also flush when it is saturated). This 
might be a way of avoiding the memory to reach the GDAL_CACHEMAX threshold. 
But this can also result in suboptimal behaviour if you call it at 
inappropriate point. For example if you write to a JPEG-compressed tiled TIFF, 
and your write pattern is row per row, then flushing before you reach a row 
number that is multiple of the tile height, will flush partially written 
blocks (their top will contain real data, and the bottom zeroes). So those 
blocks will be later decompressed and recompressed, causing unnecessary 
quality loss.

FlushCache() is automatically called by dataset destructor, so my tip would 
be: "do not use FlushCache() unless you know you need it"

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From pwillis at aslenv.com  Thu Oct  3 10:21:58 2019
From: pwillis at aslenv.com (Peter Willis)
Date: Thu, 3 Oct 2019 10:21:58 -0700
Subject: [gdal-dev] What Statistics Are Returned By
	GDAL.Dataset.GetRasterBand(...).GetStatistics(...) ?
Message-ID: <001b01d57a0f$107e04d0$317a0e70$@aslenv.com>

Hello,

I am using osgeo.gdal  python module  to load and get stats from image
bands.

While working with the, python, 'GetStatistics(...)' function I noticed that
the returned values seemed a bit off.
A snippet of code is shown below.

I compared the statistics returned in python by the function to band
statistics in ENVI image processing package for the same input file.
The results are shown below.

I am wondering if I am missing information regarding some key data filtering
feature in GDAL GetStatistics.
What statistics are GDAL returning?


#####################################
## PYTHON CODE
#####################################

src_ds = gdal.Open(image_path )
 
for bnd in range(1, src_ds.RasterCount+1 ):
    item = {}
    print("[ GETTING BAND ]: ", bnd)
    srcband=None
    srcband = src_ds.GetRasterBand(bnd)
    if srcband is None:
        continue
    
    bnddata=srcband.ReadAsArray()
    
    stats = srcband.GetStatistics( 0, 1 )
    if stats is None:
        continue
    else:
        print('put the values in a dictionary')
        ##GDAL stats##
        #item['min'] = stats[0]
        #item['max'] = stats[1]
        #item['mean'] = stats[2]
        #item['stdev'] = stats[3]
        
        ##numpy array stats##
        #item['min'] = bnddata.min()
        #item['max'] = bnddata.max()
        #item['mean'] = bnddata.mean()
        #item['stdev'] = bnddata.std()

###################################
#END PYTHON CODE
###################################


/*..........................................................................
............................................................................
..*/

ENVI Statistics test returns these vales for each channel

Channel    Min            Max           Mean        Stdev
Band 1      0.000000  0.441641  0.135938  0.095007
Band 2      0.000000  0.477772  0.134556  0.096385
Band 3      0.000000  0.512614  0.143145  0.108702
Band 4      0.000000  0.574203  0.159381  0.128212
Band 5      0.000000  1.286870  0.190917  0.159562
Band 6      0.000000  1.368695  0.218191  0.191100
Band 7      0.000000  1.208142  0.179098  0.158407

/*..........................................................................
............................................................................
..*/

GDAL GetStatistics in Python 3.0 Returns

[
{'min': 0.10543035715818, 'max': 0.35029646754265, 'mean': 0.19733288299107,
'stdev': 0.03141020073449}, 
{'min': 0.087364979088306, 'max': 0.36481207609177, 'mean':
0.19531263034662, 'stdev': 0.040193729911813}, 
{'min': 0.066563792526722, 'max': 0.40562310814857, 'mean':
0.20773722116063, 'stdev': 0.060965329408999}, 
{'min': 0.057971999049187, 'max': 0.49459338188171, 'mean':
0.23126556845189, 'stdev': 0.084854378172706}, 
{'min': 0.052771702408791, 'max': 0.57949388027191, 'mean':
0.27695694029464, 'stdev': 0.11419731959916}, 
{'min': 0.033055797219276, 'max': 0.67045384645462, 'mean':
0.31645853188616, 'stdev': 0.14756091787453}
]


/*..........................................................................
............................................................................
..*/

Using NumPy Stats Functions in Python 3.0
np.min()
np.max()
np.mean()
np.std()

Return the following values after converting the previous GDAL bands to
'NumPy.Array' and using the NumPy functions
(Values look similar to ENVI)
[
{'min': 0.0, 'max': 0.44164082, 'mean': 0.13593808, 'stdev': 0.09500719}, 
{'min': 0.0, 'max': 0.47777158, 'mean': 0.13455594, 'stdev': 0.09638489}, 
{'min': 0.0, 'max': 0.51261353, 'mean': 0.14314489, 'stdev': 0.108702265}, 
{'min': 0.0, 'max': 0.57420313, 'mean': 0.15938139, 'stdev': 0.12821245}, 
{'min': 0.0, 'max': 1.2868699, 'mean': 0.19091722, 'stdev': 0.15956147}, 
{'min': 0.0, 'max': 1.3686954, 'mean': 0.21819061, 'stdev': 0.1911003}
]




From even.rouault at spatialys.com  Thu Oct  3 11:31:51 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 03 Oct 2019 20:31:51 +0200
Subject: [gdal-dev] What Statistics Are Returned By
	GDAL.Dataset.GetRasterBand(...).GetStatistics(...) ?
In-Reply-To: <001b01d57a0f$107e04d0$317a0e70$@aslenv.com>
References: <001b01d57a0f$107e04d0$317a0e70$@aslenv.com>
Message-ID: <1591716.Xq8x9CAYvL@even-i700>

On jeudi 3 octobre 2019 10:21:58 CEST Peter Willis wrote:
> Hello,
> 
> I am using osgeo.gdal  python module  to load and get stats from image
> bands.
> 
> While working with the, python, 'GetStatistics(...)' function I noticed that
> the returned values seemed a bit off.
> A snippet of code is shown below.

GDAL statistics take into account the nodata value (more exactly pixel whose 
value equals the nodata value are ignored from the statistics). That might 
explain the differences regarding the min, if 0 was the nodata value. But you 
also get differences for the max value

Can you paste the output of gdalinfo on such a file ?

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Matt.Wilkie at gov.yk.ca  Thu Oct  3 16:01:01 2019
From: Matt.Wilkie at gov.yk.ca (Matt.Wilkie at gov.yk.ca)
Date: Thu, 3 Oct 2019 23:01:01 +0000
Subject: [gdal-dev] vrt guidance: 31 band classified raster
Message-ID: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>

Hello gdal-dev, it's been a long time!  I'm happy to be digging into raster data building again for a change, but could use some nudges in the right direction(s).

A few weeks ago Nasa released Landsat-derived Annual Dominant Land Cover Across ABoVE Core Domain, 1984-2014<https://daac.ornl.gov/ABOVE/guides/Annual_Landcover_ABoVE.html>.

It's composed of 175 geotiff images, with each file containing 31 bands which in turn correspond to a single year in the 1984-2014 period. Each band is 8bit unsigned integer with values from 1 to 15 and 255 as nodata. Each integer value corresponds to a class such as "Evergreen Forest", "Herbaceous", "Water" and so on.

I've been successful in manually building a VRT file using Category element for the classes and ColorTable entry for a palette - but only for a single band.

My question is: how to properly apply this to all bands? Do I need duplicate category and colortable elements to every single VRTRasterBand element or is there a smart way to define it once and then refer to it like a variable?  Am I even approaching this the right way?

It was quite a bit of work to get this far and I'm not looking forward to doing this 30 more times.

Sample vrt and simplified source is attached.

Matt Wilkie
Geomatics Analyst
Environment | Information Management & Technology
T 867-667-8133 | Yukon.ca<http://yukon.ca/>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/2773f392/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: scratch.0.tif
Type: image/tiff
Size: 35454 bytes
Desc: scratch.0.tif
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/2773f392/attachment-0001.tif>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: scratch_manually_built.vrt
Type: application/octet-stream
Size: 20347 bytes
Desc: scratch_manually_built.vrt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/2773f392/attachment-0001.obj>

From Matt.Wilkie at gov.yk.ca  Thu Oct  3 16:03:05 2019
From: Matt.Wilkie at gov.yk.ca (Matt.Wilkie at gov.yk.ca)
Date: Thu, 3 Oct 2019 23:03:05 +0000
Subject: [gdal-dev] vrt guidance: 31 band classified raster
Message-ID: <c3496b527fe24e9f8a3dead414a8e7c6@app-exch1.gov.yk.ca>

> It was quite a bit of work to get this far and I'm not looking forward to doing this 30 more times.

On this point, discovery of the day is Easy XML Editor<https://www.edit-xml.com/editor.htm> which allows editing some attributes as if in a spreadsheet. It's alleviated much difficulty, but is still finicky.

-Matt
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191003/5415448f/attachment.html>

From stephenwoodbridge37 at gmail.com  Thu Oct  3 16:43:55 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 3 Oct 2019 19:43:55 -0400
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
Message-ID: <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>

Matt,

Have you tried create a cascading VRT, where the first VRT composites 
all the GTiff files into a single virtual raster and then reference the 
composite in another VRT that assigns colortable. I think this should 
work nicely.

-Steve W

On 10/3/2019 7:01 PM, Matt.Wilkie at gov.yk.ca wrote:
>
> Hello gdal-dev, it's been a long time!  I'm happy to be digging into 
> raster data building again for a change, but could use some nudges in 
> the right direction(s).
>
> A few weeks ago Nasa released Landsat-derived Annual Dominant Land 
> Cover Across ABoVE Core Domain, 1984-2014 
> <https://daac.ornl.gov/ABOVE/guides/Annual_Landcover_ABoVE.html>.
>
> It’s composed of 175 geotiff images, with each file containing 31 
> bands which in turn correspond to a single year in the 1984-2014 
> period. Each band is 8bit unsigned integer with values from 1 to 15 
> and 255 as nodata. Each integer value corresponds to a class such as 
> “Evergreen Forest”, “Herbaceous”, “Water” and so on.
>
> I’ve been successful in manually building a VRT file using Category 
> element for the classes and ColorTable entry for a palette – but only 
> for a single band.
>
> My question is: how to properly apply this to all bands? Do I need 
> duplicate category and colortable elements to every single 
> VRTRasterBand element or is there a smart way to define it once and 
> then refer to it like a variable?  Am I even approaching this the 
> right way?
>
> It was quite a bit of work to get this far and I’m not looking forward 
> to doing this 30 more times.
>
> Sample vrt and simplified source is attached.
>
> *Matt Wilkie*
>
> Geomatics Analyst
>
> Environment | Information Management & Technology
>
> T 867-667-8133 | Yukon.ca <http://yukon.ca/>
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct  3 23:52:51 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 4 Oct 2019 06:52:51 +0000
Subject: [gdal-dev] Is it generally possible to write multipart result into
 zip with ogr2ogr?
Message-ID: <1f5fdaa78d7745f39202239ad5ff8d81@C119S212VM042.msvyvi.vaha.local>

Hi,

The shapefile documentation declares "Starting with GDAL 3.1, the driver can also support reading, creating and editing .shz files (ZIP files containing the .shp, .shx, .dbf and other side-car files of a single layer) and .shp.zip files (ZIP files contains one or several layers)" but is it possible somehow to write any multipart response (like MapInfo MIF/tab) directly into zip file with ogr2ogr?
-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191004/bb273790/attachment.html>

From even.rouault at spatialys.com  Fri Oct  4 02:32:13 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 04 Oct 2019 11:32:13 +0200
Subject: [gdal-dev] Is it generally possible to write multipart result
	into zip with ogr2ogr?
In-Reply-To: <1f5fdaa78d7745f39202239ad5ff8d81@C119S212VM042.msvyvi.vaha.local>
References: <1f5fdaa78d7745f39202239ad5ff8d81@C119S212VM042.msvyvi.vaha.local>
Message-ID: <10832546.NZzW9brXNa@even-i700>

On vendredi 4 octobre 2019 06:52:51 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> The shapefile documentation declares "Starting with GDAL 3.1, the driver can
> also support reading, creating and editing .shz files (ZIP files containing
> the .shp, .shx, .dbf and other side-car files of a single layer) and
> .shp.zip files (ZIP files contains one or several layers)" but is it
> possible somehow to write any multipart response (like MapInfo MIF/tab)
> directly into zip file with ogr2ogr?

No, the shapefile driver has specific code to deal with that (basically with 
temporary files that are zipped at the end)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From moritz.porst at gmx.de  Fri Oct  4 03:38:08 2019
From: moritz.porst at gmx.de (Moritz Porst)
Date: Fri, 4 Oct 2019 12:38:08 +0200
Subject: [gdal-dev] gcc 8.3.0 cross compile of gdal v1.11.5
Message-ID: <d96ecc36-6502-5a1a-0513-fd097d31a5df@gmx.de>

Hello,

*Build system, target and environment:*
I am encountering an issue when attempting to cross compile gdal v
1.11.5 using an SDK generated by the yocto build system which features
gcc v 8.3. I have used the SDK before to build other libraries, thus I
do not believe the problem is with the sdk. My build machine runs an
Ubuntu 16.04 64bit. My target is an x86 intel atom machine running a
custom OS built from the yocto build system.

(lines prepended by $ are commands)
*Compiler:*
After sourcing the SDK I get the following outputs:
$ gcc --version        //system compiler
gcc (Ubuntu 5.4.0-6ubuntu1~16.04.11) 5.4.0 20160609
$ $CC --version        // SDK compiler
x86_64-poky-linux-gcc (GCC) 8.3.0
$ $CXX --version        // SDK c++ compiler
x86_64-poky-linux-g++ (GCC) 8.3.0

*Configure, build and error:*
I configure gdal using:
$ ./configure --host=i686-pc-linux
--prefix=/home/moritz/Programmierung/gdallibs
--with-sysroot=/home/moritz/sdk/sysroots/corei7-64-poky-linux
(Not really sure about the host, but seemed fairly general to me)

After configuration I start the build:
$ make -j8

The build fails (it doesn't tell me in the end though). The following
error appears (it repeats for HAVE_FLOAT_32, HAVE_FLOAT_64 [...],
HAVE_FLOAT_32X [...] :

libtool: compile:  x86_64-poky-linux-g++ -m64 -march=nehalem
-mtune=generic -mfpmath=sse -msse4.2
--sysroot=/home/moritz/sdk/sysroots/corei7-64-poky-linux -O2 -pipe -g
-feliminate-unused-debug-types -DHAVE_SSE_AT_COMPILE_TIME -Wall
-I/home/moritz/Programmierung/GDAL/gdal/port
-I/home/moritz/Programmierung/GDAL/gdal/gcore
-I/home/moritz/Programmierung/GDAL/gdal/alg
-I/home/moritz/Programmierung/GDAL/gdal/ogr
-I/home/moritz/Programmierung/GDAL/gdal/ogr/ogrsf_frmts -DOGR_ENABLED
-I/home/moritz/Programmierung/GDAL/gdal/port -c ntv2dataset.cpp  -fPIC
-DPIC -o ../o/.libs/ntv2dataset.o
In file included from
/home/moritz/sdk/sysroots/corei7-64-poky-linux/usr/include/c++/8.3.0/cstdlib:75,
                  from
/home/moritz/sdk/sysroots/corei7-64-poky-linux/usr/include/c++/8.3.0/ext/string_conversions.h:41,
                  from
/home/moritz/sdk/sysroots/corei7-64-poky-linux/usr/include/c++/8.3.0/bits/basic_string.h:6400,
                  from
/home/moritz/sdk/sysroots/corei7-64-poky-linux/usr/include/c++/8.3.0/string:52,
                  from gmlutils.h:34,
                  from gmlutils.cpp:30:
_/home/moritz/sdk/sysroots/corei7-64-poky-linux/usr/include/stdlib.h:133:35:
error: missing binary operator before token "("__
__ #if __HAVE_FLOAT16 && __GLIBC_USE (IEC_60559_TYPES_EXT)_

The only thing I was able to find about this was the following mail
conversation, hinting at a cmake problem. However I did not recognise
any cmake in the gdal build process:
https://patchwork.openembedded.org/patch/154233/  (see the 3rd answer
from Mikko Rappeli)

I also get several -Wpoison-system-directories warnings because the
compiler is still executed with the -I/usr/include flag. As far as I can
see however the SDK include files are preferred.

I repeated above steps, only leaving out to source the SDK. This build
(then using systems gcc v 5.4.0) succeeded. Since both my build system
and my target system are x86_64 I was actually able to put the built
executable to my target system and execute them. However this is a)
dirty and b) would not work if my target was e.g. an ARM system. Thus I
would like to solve this issue and be able to compile with the proper
compiler. However since I don't know gdal I require some help here.

Any help is appreciated

Best regards
Moritz

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191004/84af2227/attachment-0001.html>

From uwe.schmitz at bezreg-koeln.nrw.de  Fri Oct  4 04:19:39 2019
From: uwe.schmitz at bezreg-koeln.nrw.de (Schmitz, Uwe)
Date: Fri, 4 Oct 2019 11:19:39 +0000
Subject: [gdal-dev] Specifying output format gives wrong result
In-Reply-To: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9729473@vbrk21mx02.bezreg-koeln.nrw.de>
References: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9729473@vbrk21mx02.bezreg-koeln.nrw.de>
Message-ID: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9750433@vbrk21mx02.bezreg-koeln.nrw.de>

Folks,

no idea or interest in this issue?
Or are there problems with the download?
I can send them via pm if desired.

Best wishes
Uwe

>-----Ursprüngliche Nachricht-----
>Von: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] Im Auftrag von
>Schmitz, Uwe
>Gesendet: Montag, 2. September 2019 12:25
>An: gdal-dev at lists.osgeo.org
>Betreff: [gdal-dev] Specifying output format gives wrong result
>
>Folks,
>
>I try to filter a dem (456664_40m.tif) with the help of
>a .vrt (456664gf.vrt) to get 456664gf.tif. The result is incorrect.
>It looks like it's slightly pushed together vertically in the middle of
>the dataset. Please look at 456664gf.tif, compare it to the
>original 456664_40m.tif and you see what I mean.
>
>The command is simple:
>> gdal-config --version
>2.4.0
>> gdal_translate -ot Float32 -of GTiff 456664gf.vrt 456664gf.tif
>
>Now the surprising: if I omit the "-of Float32" argument,
>the result looks ok. It may be of interest that former versions
>(2.1.x/2.2.x don't remember exactly) didn't have this
>problem.
>
>I uploaded the aforementioned files (zip archive) here:
>http://www.keepandshare.com/doc12/view.php?id=249308&da=y
>
>Thanks in advance
>Uwe
>
>_______________________________________________
>gdal-dev mailing list
>gdal-dev at lists.osgeo.org
>https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Fri Oct  4 04:55:55 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 04 Oct 2019 13:55:55 +0200
Subject: [gdal-dev] Specifying output format gives wrong result
In-Reply-To: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9750433@vbrk21mx02.bezreg-koeln.nrw.de>
References: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9729473@vbrk21mx02.bezreg-koeln.nrw.de>
 <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9750433@vbrk21mx02.bezreg-koeln.nrw.de>
Message-ID: <392551246.1H1aThfSJJ@even-i700>

On vendredi 4 octobre 2019 11:19:39 CEST Schmitz, Uwe wrote:
> Folks,
> 
> no idea or interest in this issue?

Or perhaps just that volunteer time is limited.

I just had a look to the issue, which I could reproduce. Fix just pushed to 
master, 3.0 and 2.4 branches

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From uwe.schmitz at bezreg-koeln.nrw.de  Fri Oct  4 05:09:36 2019
From: uwe.schmitz at bezreg-koeln.nrw.de (Schmitz, Uwe)
Date: Fri, 4 Oct 2019 12:09:36 +0000
Subject: [gdal-dev] Specifying output format gives wrong result
In-Reply-To: <392551246.1H1aThfSJJ@even-i700>
References: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9729473@vbrk21mx02.bezreg-koeln.nrw.de>
 <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9750433@vbrk21mx02.bezreg-koeln.nrw.de>
 <392551246.1H1aThfSJJ@even-i700>
Message-ID: <1A8DF958A1AA1E46BDDB48C08CB0DD0001E9750476@vbrk21mx02.bezreg-koeln.nrw.de>

Even,

thank you very much and excuse my impatience ;-)

Best wishes
Uwe

>-----Ursprüngliche Nachricht-----
>Von: Even Rouault [mailto:even.rouault at spatialys.com]
>Gesendet: Freitag, 4. Oktober 2019 13:56
>An: gdal-dev at lists.osgeo.org
>Cc: Schmitz, Uwe
>Betreff: Re: [gdal-dev] Specifying output format gives wrong result
>
>On vendredi 4 octobre 2019 11:19:39 CEST Schmitz, Uwe wrote:
>> Folks,
>>
>> no idea or interest in this issue?
>
>Or perhaps just that volunteer time is limited.
>
>I just had a look to the issue, which I could reproduce. Fix just pushed to
>master, 3.0 and 2.4 branches
>
>Even
>
>--
>Spatialys - Geospatial professional services
>http://www.spatialys.com

From matt.wilkie at gov.yk.ca  Fri Oct  4 08:25:49 2019
From: matt.wilkie at gov.yk.ca (mhw-at-yg)
Date: Fri, 4 Oct 2019 08:25:49 -0700 (MST)
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
 <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>
Message-ID: <1570202749389-0.post@n6.nabble.com>

> Have you tried create a cascading VRT, where the first VRT composites 
> all the GTiff files into a single virtual raster and then reference the 
> composite in another VRT that assigns colortable.

Hmm, I hadn't thought about cascading; didn't know that was possible. I'd
still need 31 vrt's though right? 1 for each band.  

-Matt




--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Fri Oct  4 08:30:58 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 04 Oct 2019 17:30:58 +0200
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <1570202749389-0.post@n6.nabble.com>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
 <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>
 <1570202749389-0.post@n6.nabble.com>
Message-ID: <1723536.Pkt9tOGTJF@even-i700>

On vendredi 4 octobre 2019 08:25:49 CEST mhw-at-yg wrote:
> > Have you tried create a cascading VRT, where the first VRT composites
> > all the GTiff files into a single virtual raster and then reference the
> > composite in another VRT that assigns colortable.
> 
> Hmm, I hadn't thought about cascading; didn't know that was possible. I'd
> still need 31 vrt's though right? 1 for each band.

I don't see VRT cascading of any help here, from what I've understood of your 
use case. I think you have no other choice than replicating <Category> and 
<ColorTable> in all <VRTRasterBand>

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matt.wilkie at gov.yk.ca  Fri Oct  4 12:44:18 2019
From: matt.wilkie at gov.yk.ca (mhw-at-yg)
Date: Fri, 4 Oct 2019 12:44:18 -0700 (MST)
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <1723536.Pkt9tOGTJF@even-i700>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
 <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>
 <1570202749389-0.post@n6.nabble.com> <1723536.Pkt9tOGTJF@even-i700>
Message-ID: <1570218258673-0.post@n6.nabble.com>

> I don't see VRT cascading of any help here, from what I've understood of
your 
> use case. I think you have no other choice than replicating <Category> and 
> <ColorTable> in all <VRTRasterBand>

Ok. Thanks for confirming my understanding.

Next question: It appears that <Category> <ColorTable> are order-of-index
based. Meaning that: if "Evergreen" is first element in the category list it
is matched to the first element in the color list. So there is no way in vrt
to specify a lookup table of style "name == pixel_value" like the below?

  Pixel_Value       Category      
 ------------- ------------------ 
            1   Evergreen Forest  
            2   Deciduous Forest  
          ...                     
           14   Barren            
           15   Water   


I've worked around this by inserting an "n/a" category and 0,0,0 colour
table as first line in each. Without that in qgis and arcmap everything is
shifted by one and 'Deciduous' is assigned to pixel value 1 and 'Water' to
14.

-Matt





-----
-Matt
--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Fri Oct  4 12:53:37 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 04 Oct 2019 21:53:37 +0200
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <1570218258673-0.post@n6.nabble.com>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
 <1723536.Pkt9tOGTJF@even-i700> <1570218258673-0.post@n6.nabble.com>
Message-ID: <4050663.NBetZK85Kq@even-i700>

On vendredi 4 octobre 2019 12:44:18 CEST mhw-at-yg wrote:
> > I don't see VRT cascading of any help here, from what I've understood of
> 
> your
> 
> > use case. I think you have no other choice than replicating <Category> and
> > <ColorTable> in all <VRTRasterBand>
> 
> Ok. Thanks for confirming my understanding.
> 
> Next question: It appears that <Category> <ColorTable> are order-of-index
> based. Meaning that: if "Evergreen" is first element in the category list it
> is matched to the first element in the color list. So there is no way in
> vrt to specify a lookup table of style "name == pixel_value" like the
> below?
> 
>   Pixel_Value       Category
>  ------------- ------------------
>             1   Evergreen Forest
>             2   Deciduous Forest
>           ...
>            14   Barren
>            15   Water
> 
> 
> I've worked around this by inserting an "n/a" category and 0,0,0 colour
> table as first line in each. Without that in qgis and arcmap everything is
> shifted by one and 'Deciduous' is assigned to pixel value 1 and 'Water' to
> 14.
> 

You could also potentially use a raster attribute table. See 
GDALRasterAttributeTable in https://gdal.org/drivers/raster/vrt.html
The documentation is a bit loose.
The values for Type and Usage match the enumerations at
https://github.com/OSGeo/gdal/blob/master/gdal/gcore/gdal.h#L1189

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matt.wilkie at gov.yk.ca  Fri Oct  4 15:36:43 2019
From: matt.wilkie at gov.yk.ca (mhw-at-yg)
Date: Fri, 4 Oct 2019 15:36:43 -0700 (MST)
Subject: [gdal-dev] vrt guidance: 31 band classified raster
In-Reply-To: <4050663.NBetZK85Kq@even-i700>
References: <d9b3510d4b1a451ab583a54c5ca2747d@app-exch1.gov.yk.ca>
 <b9da4318-0550-4c34-3cde-56f6142c4a97@gmail.com>
 <1570202749389-0.post@n6.nabble.com> <1723536.Pkt9tOGTJF@even-i700>
 <1570218258673-0.post@n6.nabble.com> <4050663.NBetZK85Kq@even-i700>
Message-ID: <1570228603540-0.post@n6.nabble.com>

> You could also potentially use a raster attribute table. See
> GDALRasterAttributeTable in https://gdal.org/drivers/raster/vrt.html

Yeah, loose is right. ;-)  This is what I think I've puzzled out:

<http://osgeo-org.1560.x6.nabble.com/file/t192661/2019-10-04_15_29_23-Book1_-_Excel.png> 



would be expressed as:




Type 2 means it's a string (GFT_String)
Usage 2 means this is the name of the class (GFU_Name)

Type 0 means a non-decimal number (GFT_Integer)
Usage 5 means use for pixels matching this value from the intersecting row
(GFU_MinMax)

Am I on the right track?

-Matt



-----
-Matt
--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From bdecarne at gmail.com  Tue Oct  8 01:43:16 2019
From: bdecarne at gmail.com (=?UTF-8?Q?Blaise_de_Carn=C3=A9?=)
Date: Tue, 8 Oct 2019 10:43:16 +0200
Subject: [gdal-dev] Read-write random access not supported for /vsizip
Message-ID: <CAAbtqUiymmp0-3uVDN6HVN64z-XPgoY28PJdtc7TJ3qo94x4Lg@mail.gmail.com>

Hi there !

(GDAL 2.4.2)

I try to access a distant zipped shapefile, with depth in zip :
http://atom.geo-ide.developpement-durable.gouv.fr/atomArchive/GetResource?id=df7fcd18-3d01-4cff-83db-a8281d25d630&dataType=dataset

ogrinfo /vsizip/{/vsicurl/
http://atom.geo-ide.developpement-durable.gouv.fr/atomArchive/GetResource\?id\=df7fcd18-3d01-4cff-83db-a8281d25d630\&dataType\=dataset}/dataset

Gives me that error :

ERROR 1: Read-write random access not supported for /vsizip

Have a nice day !
-- 
*Blaise*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/2bda7c31/attachment.html>

From omar.alvarez at cinfo.es  Tue Oct  8 01:44:48 2019
From: omar.alvarez at cinfo.es (=?UTF-8?Q?Omar_=C3=81lvarez?=)
Date: Tue, 8 Oct 2019 10:44:48 +0200
Subject: [gdal-dev] GDALDataset::RasterIO error when using negative
	nLineSpace
Message-ID: <CAKrV3-kPW4szfu7CQw5KQqb-vY=cSV6qMoY2pj2JzEjopeuvVA@mail.gmail.com>

Hi,

I'm trying to read an RGB image using GDAL. I have got it working, but my
image is upside down. This is the code I am using for that:

CPLErr err = geotiffDataset->RasterIO(
            GF_Write,
            0, 0,
            _image->s(), _image->t(),
            (void *)(_image->data()),
            _image->s(), _image->t(),
            cvtGLtoGDALType(_image),
            3, NULL,
            _image->getPixelSizeInBits() / CHAR_BIT ,
_image->getRowStepInBytes(), _image->getPixelSizeInBits() / 3 / CHAR_BIT
        );

But, if I try to use negative nLineSpace to flip it vertically:

 CPLErr err = geotiffDataset->RasterIO(
            GF_Write,
            0, 0,
            _image->s(), _image->t(),
            (void *)((char *)_image->data() + _image->getImageSizeInBytes()
- _image->getRowStepInBytes()),
            _image->s(), _image->t(),
            cvtGLtoGDALType(_image),
            3, NULL,
            _image->getPixelSizeInBits() / CHAR_BIT ,
-_image->getRowStepInBytes(), _image->getPixelSizeInBits() / 3 / CHAR_BIT
        );

I get a segfault.

Image is 1024x1024x3 and GDT_Float32. Anyone has any idea if I made a
mistake? Am I going about this wrong?

Thanks to everybody in advance.

Cheers,

Omar.

-- 
[image: logo cinfo]
<https://cinfo.es/?utm_source=mailing&utm_medium=logo&utm_campaign=trafico-generico&utm_content=index>
Luis Omar Álvarez MuresAI Software Development Coordinator

omar.alvarez at cinfo.es | +34 881 015 512
Edificio CITIC 2 - Antonio Insua Rivas, 56 - 15008 A Coruña (ES) (ver mapa
<https://goo.gl/maps/KbSUu5Pz9KArD8cD8>)
https://www.cinfo.es

CONFIDENCIALIDAD Y PROTECCIÓN DE DATOS

Este envío es *privado y confidencial*, estando destinado únicamente a la
persona a la que ha sido enviado. Si usted no es el destinatario al que ha
sido remitido, no puede copiar la información, distribuirla ni emprender
con ella ningún tipo de acción. Si cree que lo ha recibido por error, por
favor, *notifíquelo al remitente y proceda a su eliminación*.

*Información Básica de Protección de Datos. Responsable:* CINFO CONTENIDOS
INFORMATIVOS ESPECIALIZADOS, S.L. (B15757941) C/Antonio Insua Rivas
56,15008 Coruña.*Finalidad:* Inicio o mantenimiento de la relación
profesional. Envío de información, respuesta a consultas y contactos
genéricos. *Legitimación:* Consentimiento del interesado. *Destinatarios:*
No se cederán datos a terceros salvo obligación legal. *Derechos:* Tiene
derecho de acceso, oposición, limitación, supresión, oposición y
portabilidad de sus datos, mediante carta a la dirección postal indicada o
enviando un email a gdpr at cinfo.es. *Si no quiere recibir envíos comerciales
escriba a: gdpr at cinfo.es <gdpr at cinfo.es> Para más información sobre el uso
de los datos, visite:* https://www.cinfo.es/es/politica-privacidad/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/3a9e4db5/attachment.html>

From even.rouault at spatialys.com  Tue Oct  8 02:56:52 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 08 Oct 2019 11:56:52 +0200
Subject: [gdal-dev] Read-write random access not supported for /vsizip
In-Reply-To: <CAAbtqUiymmp0-3uVDN6HVN64z-XPgoY28PJdtc7TJ3qo94x4Lg@mail.gmail.com>
References: <CAAbtqUiymmp0-3uVDN6HVN64z-XPgoY28PJdtc7TJ3qo94x4Lg@mail.gmail.com>
Message-ID: <2477688.7zqYV80jRQ@even-i700>

On mardi 8 octobre 2019 10:43:16 CEST Blaise de Carné wrote:
> Hi there !
> 
> (GDAL 2.4.2)
> 
> I try to access a distant zipped shapefile, with depth in zip :
> http://atom.geo-ide.developpement-durable.gouv.fr/atomArchive/GetResource?id
> =df7fcd18-3d01-4cff-83db-a8281d25d630&dataType=dataset
> 
> ogrinfo /vsizip/{/vsicurl/
> http://atom.geo-ide.developpement-durable.gouv.fr/atomArchive/GetResource\?i
> d\=df7fcd18-3d01-4cff-83db-a8281d25d630\&dataType\=dataset}/dataset
> 
> Gives me that error :
> 
> ERROR 1: Read-write random access not supported for /vsizip

ogrinfo tries first in read-write mode and then in read-only mode. But the 
first error emitted is the one that matters:

$ ogrinfo -ro "/vsizip/{/vsicurl/http://atom.geo-ide.developpement-durable.gouv.fr/atomArchive/GetResource?id=df7fcd18-3d01-4cff-83db-a8281d25d630&dataType=dataset}/dataset"
ERROR 1: Range downloading not supported by this server!
ERROR 1: Range downloading not supported by this server!

So that means you cannot get partial reads in this zip file. It must be first 
locally downloaded (likely because it isn't a static ressource on server side 
and the server has to generate it on-demand)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Tue Oct  8 03:49:33 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 08 Oct 2019 12:49:33 +0200
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
Message-ID: <4214955.OWyxbvXDcp@even-i700>

Hi,

This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one "data 
pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS 
(Large File Storage) from
1 GB of storage + 1 GB /month of bandwith
to
50 GB of storage + 50 GB/month of bandwidth

This is within our yearly 5000 USD budget, for which we have already spent 
4107.60 USD for Travis-CI

The first & main beneficiary of this GitHub LFS extension will actually be the 
proj-datumgrid repository, that has just reached the bandwidth quota:
https://github.com/OSGeo/proj-datumgrid/issues/57

~~~~~~

My vote: +1

Even

[1]
https://help.github.com/en/articles/about-billing-for-git-large-file-storage

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mateusz at loskot.net  Tue Oct  8 04:17:07 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Tue, 8 Oct 2019 13:17:07 +0200
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <4214955.OWyxbvXDcp@even-i700>
References: <4214955.OWyxbvXDcp@even-i700>
Message-ID: <CABUeae8pwiEn9vjhp3EkMQWfy-O-hsBo1X8uuD+i9=CeT_-gfQ@mail.gmail.com>

On Tue, 8 Oct 2019 at 12:49, Even Rouault <even.rouault at spatialys.com> wrote:
>
> This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one "data
> pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> (Large File Storage) from
> 1 GB of storage + 1 GB /month of bandwith
> to
> 50 GB of storage + 50 GB/month of bandwidth
>
> My vote: +1

+1


p.s. For those who have no experience with LFS and may be wondering,
enabling LFS will only affect *new* files added to storage and any existing
binary or large files will not automatically move from Git storage to Git LFS.
Unless, Git history is rewritten.

Best regards,
-- 
Mateusz Loskot, http://mateusz.loskot.net

From howard at hobu.co  Tue Oct  8 05:53:41 2019
From: howard at hobu.co (Howard Butler)
Date: Tue, 8 Oct 2019 07:53:41 -0500
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <CABUeae8pwiEn9vjhp3EkMQWfy-O-hsBo1X8uuD+i9=CeT_-gfQ@mail.gmail.com>
References: <4214955.OWyxbvXDcp@even-i700>
 <CABUeae8pwiEn9vjhp3EkMQWfy-O-hsBo1X8uuD+i9=CeT_-gfQ@mail.gmail.com>
Message-ID: <CAKyBbG7TVMT=7oXQSLh6g6qiqq8TK23jLaQJnzC02NfBhSUExQ@mail.gmail.com>

On Tue, Oct 8, 2019 at 6:17 AM Mateusz Loskot <mateusz at loskot.net> wrote:

> On Tue, 8 Oct 2019 at 12:49, Even Rouault <even.rouault at spatialys.com>
> wrote:
> >
> > This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one
> "data
> > pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> > (Large File Storage) from
> > 1 GB of storage + 1 GB /month of bandwith
> > to
> > 50 GB of storage + 50 GB/month of bandwidth
> >
> > My vote: +1
>
> +1
>
>
> p.s. For those who have no experience with LFS and may be wondering,
> enabling LFS will only affect *new* files added to storage and any existing
> binary or large files will not automatically move from Git storage to Git
> LFS.
> Unless, Git history is rewritten.
>

+1

Howard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/c1e1eb5f/attachment-0001.html>

From dmorissette at mapgears.com  Tue Oct  8 06:15:09 2019
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Tue, 8 Oct 2019 09:15:09 -0400
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <4214955.OWyxbvXDcp@even-i700>
References: <4214955.OWyxbvXDcp@even-i700>
Message-ID: <67deb121-774d-9b87-37cb-9327d02aac67@mapgears.com>

+1

Daniel


On 2019-10-08 06:49, Even Rouault wrote:
> Hi,
> 
> This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one "data
> pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> (Large File Storage) from
> 1 GB of storage + 1 GB /month of bandwith
> to
> 50 GB of storage + 50 GB/month of bandwidth
> 
> This is within our yearly 5000 USD budget, for which we have already spent
> 4107.60 USD for Travis-CI
> 
> The first & main beneficiary of this GitHub LFS extension will actually be the
> proj-datumgrid repository, that has just reached the bandwidth quota:
> https://github.com/OSGeo/proj-datumgrid/issues/57
> 
> ~~~~~~
> 
> My vote: +1
> 
> Even
> 
> [1]
> https://help.github.com/en/articles/about-billing-for-git-large-file-storage
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From schwehr at gmail.com  Tue Oct  8 06:54:56 2019
From: schwehr at gmail.com (Kurt Schwehr)
Date: Tue, 8 Oct 2019 06:54:56 -0700
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <67deb121-774d-9b87-37cb-9327d02aac67@mapgears.com>
References: <4214955.OWyxbvXDcp@even-i700>
 <67deb121-774d-9b87-37cb-9327d02aac67@mapgears.com>
Message-ID: <CACmBxyubD_fJq8MPzpfrV6j+TYdNdfJXKS2wk9in0n0gxNNHrw@mail.gmail.com>

+1 Kurt

On Tue, Oct 8, 2019, 6:22 AM Daniel Morissette <dmorissette at mapgears.com>
wrote:

> +1
>
> Daniel
>
>
> On 2019-10-08 06:49, Even Rouault wrote:
> > Hi,
> >
> > This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one
> "data
> > pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> > (Large File Storage) from
> > 1 GB of storage + 1 GB /month of bandwith
> > to
> > 50 GB of storage + 50 GB/month of bandwidth
> >
> > This is within our yearly 5000 USD budget, for which we have already
> spent
> > 4107.60 USD for Travis-CI
> >
> > The first & main beneficiary of this GitHub LFS extension will actually
> be the
> > proj-datumgrid repository, that has just reached the bandwidth quota:
> > https://github.com/OSGeo/proj-datumgrid/issues/57
> >
> > ~~~~~~
> >
> > My vote: +1
> >
> > Even
> >
> > [1]
> >
> https://help.github.com/en/articles/about-billing-for-git-large-file-storage
> >
>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/f1f3083f/attachment.html>

From warmerdam at pobox.com  Tue Oct  8 07:25:04 2019
From: warmerdam at pobox.com (Frank Warmerdam)
Date: Tue, 8 Oct 2019 10:25:04 -0400
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <4214955.OWyxbvXDcp@even-i700>
References: <4214955.OWyxbvXDcp@even-i700>
Message-ID: <CA+YzLBe+LQmSrH+fbYgAh3t1VO7XZhrKiadAVapW_tsh9+j8YA@mail.gmail.com>

+1 Frank

On Tue, Oct 8, 2019 at 6:49 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one
> "data
> pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> (Large File Storage) from
> 1 GB of storage + 1 GB /month of bandwith
> to
> 50 GB of storage + 50 GB/month of bandwidth
>
> This is within our yearly 5000 USD budget, for which we have already spent
> 4107.60 USD for Travis-CI
>
> The first & main beneficiary of this GitHub LFS extension will actually be
> the
> proj-datumgrid repository, that has just reached the bandwidth quota:
> https://github.com/OSGeo/proj-datumgrid/issues/57
>
> ~~~~~~
>
> My vote: +1
>
> Even
>
> [1]
>
> https://help.github.com/en/articles/about-billing-for-git-large-file-storage
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
---------------------------------------+--------------------------------------
I set the clouds in motion - turn up   | Frank Warmerdam,
warmerdam at pobox.com
light and sound - activate the windows |
and watch the world go round - Rush    | Geospatial Software Developer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/ffd6e8cb/attachment.html>

From ravitejakrishna.w at zohocorp.com  Tue Oct  8 07:17:13 2019
From: ravitejakrishna.w at zohocorp.com (Ravi Teja Krishna Wuyyuru)
Date: Tue, 08 Oct 2019 19:47:13 +0530
Subject: [gdal-dev] procedure for .kml to .xlsx conversion with geometry
	included
Message-ID: <16dabbb2d86.112f23f4713485.5471038748803768010@zohocorp.com>

Hello GDAL Team,


We would like to use ogr2ogr file format conversion in our product using java bindings. I have read in gdal website that for xlsx conversion there is no geometry support but may use ogr vrt capabilities for that.

can you please elaborate the procedure i need to follow so i can convert .kml files directly to .xlsx format which has geometry included.

Note: i have already built gdal with expat support so upon trying to convert from .kml to .xlsx iam getting file which misses Geometry Column.


Thanks in advance.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191008/0999bbee/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Oct  8 23:56:27 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 8 Oct 2019 23:56:27 -0700 (MST)
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <4214955.OWyxbvXDcp@even-i700>
References: <4214955.OWyxbvXDcp@even-i700>
Message-ID: <1570604187609-0.post@n6.nabble.com>

+1

-Jukka-


Even Rouault-2 wrote
> Hi,
> 
> This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one
> "data 
> pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS 
> (Large File Storage) from
> 1 GB of storage + 1 GB /month of bandwith
> to
> 50 GB of storage + 50 GB/month of bandwidth
> 
> This is within our yearly 5000 USD budget, for which we have already spent 
> 4107.60 USD for Travis-CI
> 
> The first & main beneficiary of this GitHub LFS extension will actually be
> the 
> proj-datumgrid repository, that has just reached the bandwidth quota:
> https://github.com/OSGeo/proj-datumgrid/issues/57
> 
> ~~~~~~
> 
> My vote: +1
> 
> Even
> 
> [1]
> https://help.github.com/en/articles/about-billing-for-git-large-file-storage
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From battisti at actgate.com  Wed Oct  9 06:10:16 2019
From: battisti at actgate.com (Andrea Battisti)
Date: Wed, 9 Oct 2019 15:10:16 +0200
Subject: [gdal-dev]  problem with interpolation on GDAL RasterIO ?
Message-ID: <4d2193a6-929a-f6fc-c3f4-97b94d9420f8@actgate.com>

Hi all,


I think I found a glitch in how bilinear interpolation is applied when 
reading a sub block of a dataset.

I have put together few lines of code to help showing the issue (see 
below) in case any one can help me on this. (tested on GDAL 2.4.2).

The region being read has values in ~ -2800..-2300 range, and there is a 
no_data block with value -340282265508890445205022487695511781376.

Now if I do not apply any interpolation, I get the expected range of 
values back (not masking nodata here for simplicity), eg:

computed min, max: -340282265508890445205022487695511781376.000000, 
-2360.786377

While if I enable _bilinear_ interpolation, I get:
computed min, max: -340282265508890445205022487695511781376.000000, 0.000000

A whole block within the nodata area is set to 0 while should just stay 
as nodata (eg -340282265508890445205022487695511781376) and the maximum 
should stay around -2360.


To add some fun, I tried to extract the same block using 
'gdal_translate' utility, both with and without interpolation, and in 
that case I get consistent results:

gdal_translate -srcwin 0 9880 2525 4442  -outsize 704 400 
NAC_DTM_APOLLO17_3.TIF -r near nsub_n.tif
gdalinfo -mm nsub_n.tif
--> Computed Min/Max=-2867.847,-2360.786

gdal_translate -srcwin 0 9880 2525 4442  -outsize 704 400 
NAC_DTM_APOLLO17_3.TIF -r bilinear nsub_bl.tif
gdalinfo -mm nsub_bl.tif
--> Computed Min/Max=-2867.411,-2360.956

I am not familiar enough with the GDAL internals to dig more but I guess 
gdal_translate might add more care for edge cases.


The dataset that is referenced is an elevation model and can be 
downloaded from:
http://lroc.sese.asu.edu/data/LRO-L-LROC-5-RDR-V1.0/LROLRC_2001/DATA/SDP/NAC_DTM/APOLLO17_3/NAC_DTM_APOLLO17_3.TIF


Thanks in advance!
Andrea

==================================

#define SNC 2525
#define SNR 4442
#define XOFF 0
#define YOFF 9880

int main() {

         GDALRasterIOExtraArg psExtraArg;
         GDALDatasetH hDataset;
         GDALDriverH hDriver;
         CPLErr err;
         double *buf, bmin, bmax;
         void *bp;
         unsigned int i;

         printf( "GDAL rasterio test\n"  );

         GDALAllRegister();
         hDataset = GDALOpenShared( "NAC_DTM_APOLLO17_3.TIF", GA_ReadOnly );
         hDriver = GDALGetDatasetDriver( hDataset );

         printf( "Driver: %s - %s\n", GDALGetDriverShortName( hDriver ), 
GDALGetDriverLongName( hDriver )  );
         printf( "b,r,c: %d, %d, %d\n", GDALGetRasterCount( hDataset ), 
GDALGetRasterYSize( hDataset ), GDALGetRasterXSize( hDataset ) );

         // read sub region
         buf = malloc( BNC * BNR * sizeof(double) );
         bp = (void *)buf;


         // use interpolation while reading
         INIT_RASTERIO_EXTRA_ARG(psExtraArg);
         psExtraArg.eResampleAlg = GRIORA_NearestNeighbour; // 
GRIORA_NearestNeighbour | GRIORA_Bilinear

         err = GDALDatasetRasterIOEx(
                 hDataset,
                 GF_Read, // GDALRWFlag eRWFlag,
                 XOFF, // int nDSXOff,
                 YOFF, // int nDSYOff,
                 SNC, // int nDSXSize,
                 SNR, // int nDSYSize,
                 bp, // void *pBuffer,
                 BNC, // int nBXSize,
                 BNR, // int nBYSize,
                 GDT_Float64, // GDALDataType eBDataType,
                 1, // int nBandCount,
                 NULL, // int *panBandCount,
                 0, // GSpacing nPixelSpace,
                 0, // GSpacing nLineSpace,
                 0, // GSpacing nBandSpace,
                 &psExtraArg // GDALRasterIOExtraArg *psExtraArg
         );

         bmin = 1e50;
         bmax = -bmin;
         for (i=0; i < (BNC*BNR); ++i) {
                 if (buf[i] > bmax) bmax = buf[i];
                 if (buf[i] < bmin) bmin = buf[i];
         }
         printf( "computed min, max: %f, %f\n", bmin, bmax );

         GDALClose(hDataset);

         return 0;
}


==================================



-- 
Andrea Battisti
Computer Science Engineer

From Kathleen.A.McLane at erdc.dren.mil  Wed Oct  9 11:28:40 2019
From: Kathleen.A.McLane at erdc.dren.mil (McLane, Kathleen A ERDC-RDE-GRL-VA CIV)
Date: Wed, 9 Oct 2019 18:28:40 +0000
Subject: [gdal-dev] gdaltransform question
Message-ID: <6BD0F4C4D0E40F41877197F8AA83789B4C5EB7B0@MS-EX1VKS.erdc.dren.mil>

Hello,

I'm using gdaltransform to transform points from one datum to WGS84. In version 2.2.3 and 2.4.0 of GDAL, when I convert a point I receive a transformed latitude, longitude, and a new height value. In versions 2.4.1 and 3.0.1, when I convert a point I receive a transformed latitude and longitude but height always equals 0. Attached are examples of the height value issue. Is this a GDAL error, or am I doing something wrong?

Thank you,

Kathleen 



-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: BOOGDAL223.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191009/9b03c60f/attachment.txt>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: BOOGDAL241.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191009/9b03c60f/attachment-0001.txt>

From even.rouault at spatialys.com  Wed Oct  9 11:40:26 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 09 Oct 2019 20:40:26 +0200
Subject: [gdal-dev] gdaltransform question
In-Reply-To: <6BD0F4C4D0E40F41877197F8AA83789B4C5EB7B0@MS-EX1VKS.erdc.dren.mil>
References: <6BD0F4C4D0E40F41877197F8AA83789B4C5EB7B0@MS-EX1VKS.erdc.dren.mil>
Message-ID: <7483683.itddvSnoc0@even-i700>

On mercredi 9 octobre 2019 18:28:40 CEST McLane, Kathleen A ERDC-RDE-GRL-VA 
CIV wrote:
> Hello,
> 
> I'm using gdaltransform to transform points from one datum to WGS84. In
> version 2.2.3 and 2.4.0 of GDAL, when I convert a point I receive a
> transformed latitude, longitude, and a new height value. In versions 2.4.1
> and 3.0.1, when I convert a point I receive a transformed latitude and
> longitude but height always equals 0. Attached are examples of the height
> value issue. Is this a GDAL error, or am I doing something wrong?

Your examples show more a difference at the PROJ level, but indeed there have 
been changes in PROJ 6 where doing a transformation between geographic CRS 
only cause 2D corrections to be applied, as this is what is recommended by 
EPSG. If you want corrections on ellipsoidal heights as well, you have to 
operate in the geocentric coordinate domain.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Wed Oct  9 16:51:47 2019
From: sean at mapbox.com (Sean Gillies)
Date: Wed, 9 Oct 2019 17:51:47 -0600
Subject: [gdal-dev] Clarification on what is not addressed by
	GDALFlushCache
In-Reply-To: <1742909.atRMgI486a@even-i700>
References: <CADPhZXwDA8i_U45cPqRAdcWjFyfH7jzXvO_VPbpQ3W6sLL5wrg@mail.gmail.com>
 <1742909.atRMgI486a@even-i700>
Message-ID: <CADPhZXyi0n8DdJs49PmixAbhhFQrm-rQKEP6zqn7m3iHFpTDiQ@mail.gmail.com>

Thanks, Even. I've flushed out rasterio's usage of FlushCache.

On Thu, Oct 3, 2019 at 11:04 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On jeudi 3 octobre 2019 10:14:45 CEST Sean Gillies wrote:
> > In the comments above FlushCache() in gcore/gdaldataset.cpp it is said:
> >
> >  * Using this method does not prevent use from calling GDALClose()
> >  * to properly close a dataset and ensure that important data not
> addressed
> >  * by FlushCache() is written in the file.
>
> > Does it vary by
> > format and driver?
>
> Of course, wouldn't be fun otherwise. For some formats, it might result in
> a
> completely consistent dataset, and in others, in something that can't be
> opened at all. So what is does, beyond evicting 'dirty' blocks from the
> cahce,
> is mostly an implementation detail.
>
> > What exactly is the important data that is not addressed?
>
> In the case of GeoTIFF, FlushCache() will for example ensure that all tile/
> strip data is flushed to disk, but the TileByteCount/TileOffset index
> arrays
> are not updated, and os a file that was just created, they will be at
> their
> zero default value, making the dataset appear to be empty to a reader that
> would try to open it at that point.
>
> If generating a large dataset, you can for example call FlushCache() at
> regular intervals to make sure that there is sufficiently space on the
> storage
> device (but the global block cache will also flush when it is saturated).
> This
> might be a way of avoiding the memory to reach the GDAL_CACHEMAX
> threshold.
> But this can also result in suboptimal behaviour if you call it at
> inappropriate point. For example if you write to a JPEG-compressed tiled
> TIFF,
> and your write pattern is row per row, then flushing before you reach a
> row
> number that is multiple of the tile height, will flush partially written
> blocks (their top will contain real data, and the bottom zeroes). So those
> blocks will be later decompressed and recompressed, causing unnecessary
> quality loss.
>
> FlushCache() is automatically called by dataset destructor, so my tip
> would
> be: "do not use FlushCache() unless you know you need it"
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191009/5acbe6f3/attachment.html>

From even.rouault at spatialys.com  Thu Oct 10 05:48:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 10 Oct 2019 14:48:28 +0200
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <CABUeae8pwiEn9vjhp3EkMQWfy-O-hsBo1X8uuD+i9=CeT_-gfQ@mail.gmail.com>
References: <4214955.OWyxbvXDcp@even-i700>
 <CABUeae8pwiEn9vjhp3EkMQWfy-O-hsBo1X8uuD+i9=CeT_-gfQ@mail.gmail.com>
Message-ID: <2956880.5m5fGtBQYA@even-i700>

Hi

This motion is adopted with +1 from PSC members EvenR, ateuszl, HowardB, 
DanielM, KurtS, FrankW and JukkaR

Even

> On Tue, 8 Oct 2019 at 12:49, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one
> > "data
> > pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> > (Large File Storage) from
> > 1 GB of storage + 1 GB /month of bandwith
> > to
> > 50 GB of storage + 50 GB/month of bandwidth
> > 
> > My vote: +1
> 
> +1
> 
> 
> p.s. For those who have no experience with LFS and may be wondering,
> enabling LFS will only affect *new* files added to storage and any existing
> binary or large files will not automatically move from Git storage to Git
> LFS. Unless, Git history is rewritten.
> 
> Best regards,


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From are131 at psu.edu  Thu Oct 10 12:09:15 2019
From: are131 at psu.edu (Edson, Adam Robert)
Date: Thu, 10 Oct 2019 19:09:15 +0000
Subject: [gdal-dev] python GDAL issue
Message-ID: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>

I am trying to parse a TRE in a NITF following the spec found here (https://nsgreg.nga.mil/doc/view?i=4829&month=10&day=10&year=2019). Specifically, I am having trouble with the BANDSB TRE with the EXISTENCE_MASK field. It is supposed to be an unsigned int that can be used as bit flags for data following after it. I am currently getting garbage at this location from the gdal.getMetadata('TRE') call. Any help would be appreciated.

Adam

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191010/3937e871/attachment.html>

From bradh at frogmouth.net  Thu Oct 10 13:47:47 2019
From: bradh at frogmouth.net (Brad Hards)
Date: Fri, 11 Oct 2019 07:47:47 +1100
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>
Message-ID: <00a401d57fab$f9b63220$ed229660$@frogmouth.net>

Can you make the NITF file available? Can you at least post the relevant
part of the BANDSB TRE from the file?

 

Brad

 

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Edson, Adam
Robert
Sent: Friday, 11 October 2019 6:09 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] python GDAL issue

 

I am trying to parse a TRE in a NITF following the spec found here
(https://nsgreg.nga.mil/doc/view?i=4829
<https://nsgreg.nga.mil/doc/view?i=4829&month=10&day=10&year=2019>
&month=10&day=10&year=2019). Specifically, I am having trouble with the
BANDSB TRE with the EXISTENCE_MASK field. It is supposed to be an unsigned
int that can be used as bit flags for data following after it. I am
currently getting garbage at this location from the gdal.getMetadata('TRE')
call. Any help would be appreciated.

 

Adam

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191011/bdab4ed1/attachment.html>

From mladen-g at distributel.net  Thu Oct 10 14:43:47 2019
From: mladen-g at distributel.net (mladen-g at distributel.net)
Date: Thu, 10 Oct 2019 21:43:47 +0000
Subject: [gdal-dev] C# bindings for (fast) reproject, resample,
	and send to DB
Message-ID: <20191010214347.Horde.tu3oL2hZrOsX4ZFI7489R0S@webmail.distributel.net>


Hello,

I've been using GDAL for a while, but I am still a newbie to the API.   
I see there are some experts on this group, so apologies if I'm asking  
something simple (my searches did not reveal the answers I was looking  
for).

Here is my problem:

I need to take an input raster, split into areas of various sizes,  
resample each area into a 256x256 tile, reproject to EPSG:4326 and  
send the resulting pixels to a DB.

GDAL is perfect for this, but I am using the C# bindings and I'm not  
sure what is the most performant way to do it.

I used the following two references to create something that works,  
but I am wondering if it can be improved:
https://gis.stackexchange.com/questions/297831/using-gdalwarp-with-c-bindings
https://lists.osgeo.org/pipermail/gdal-dev/2017-February/046046.html

How I do it right now:

1)  Copy the input grid to RAM disk for fast access
2)  Invoke Gdal.wrapper_GDALWarpDestName() for reprojection,  
resampling, and output to a /vsimem/ memory-mapped file
3)  Read the memory-mapped file into a Dataset (returned by  
wrapper_GDALWarpDestName())
4)  Write the Dataset values to DB

What I would like to know:

1)  To skip the /vsimem file creation, how can I use  
Gdal.wrapper_GDALWarpDestDs() instead of -DestName?  It requires a  
dataset as a parameter, but I am not sure how to initialize it  
correctly.  I've tried Gdal.GetDriverByName("VRT").Create(...) and  
.GetDriverByName("MEM").Create(...), but all the values end up being 0  
when I pass the dataset to wrapper_GDALWarpDestDs()?

2)  Is there a more direct, efficient way to do what I'm doing?  Here  
is the relevant code

<snip>
using (Dataset rasterInput = Gdal.Open(inputRasterPath, Access.GA_ReadOnly))
{
   IntPtr[] ptr = {Dataset.getCPtr(inputRasterPath).Handle};
   GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
...
    var dss = new  
SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false,  
null);
..
    foreach (var tileExtent in overlappingTileExtents) // tileExtent  
just contains minX/minY/maxX/maxY
    {
    ...

       string vsiMemFilePath =  
$"/vsimem/{destinationTableName}#{extentName}#tile{indexNumber}.vrt";
       string[] options = {
                                 "-of", "VRT",
                                 "-srcnodata", "99999.9",
                                 "-dstnodata", "99999.9",
                                 "-ot", "Float32",
                                 "-t_srs", "EPSG:4326",
                                 "-r", "average"),
                                 "-te", tileExtent.xmin.ToString(),  
tileExtent.ymin.ToString(), tileExtent.xmax.ToString(),  
tileExtent.ymax.ToString(),
                                 "-ts", "256", "256"
                             };

        using (Dataset ds =  
Gdal.wrapper_GDALWarpDestName(vsiMemFilePath, 1, dss, new  
GDALWarpAppOptions(options), null, null))
        {
...
          //read the geotransform + first band and write each pixel  
lat/long + value to the DB
...
        }

     Gdal.Unlink(vsiMemFilePath)

....

Regards,
Mladen


From jmckenna at gatewaygeomatics.com  Thu Oct 10 15:17:32 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Thu, 10 Oct 2019 19:17:32 -0300
Subject: [gdal-dev] Motion: spend 60 USD / year for extended GitHub LFS
In-Reply-To: <4214955.OWyxbvXDcp@even-i700>
References: <4214955.OWyxbvXDcp@even-i700>
Message-ID: <03697945-507e-be60-3389-45dc264b8b07@gatewaygeomatics.com>

+1 jeff



On 2019-10-08 7:49 AM, Even Rouault wrote:
> Hi,
> 
> This motion is to spend 5 USD/month * 12 = 60 USD annually to buy one "data
> pack" ([1]) to extend the quota of the OSGeo GitHub organization for LFS
> (Large File Storage) from
> 1 GB of storage + 1 GB /month of bandwith
> to
> 50 GB of storage + 50 GB/month of bandwidth
> 
> This is within our yearly 5000 USD budget, for which we have already spent
> 4107.60 USD for Travis-CI
> 
> The first & main beneficiary of this GitHub LFS extension will actually be the
> proj-datumgrid repository, that has just reached the bandwidth quota:
> https://github.com/OSGeo/proj-datumgrid/issues/57
> 
> ~~~~~~
> 
> My vote: +1
> 
> Even
> 
> [1]
> https://help.github.com/en/articles/about-billing-for-git-large-file-storage
> 

From geospatialsolutions at gmail.com  Thu Oct 10 15:41:18 2019
From: geospatialsolutions at gmail.com (Geospatial Information Technology Solutions)
Date: Thu, 10 Oct 2019 18:41:18 -0400
Subject: [gdal-dev] C# bindings for (fast) reproject, resample,
 and send to DB
In-Reply-To: <20191010214347.Horde.tu3oL2hZrOsX4ZFI7489R0S@webmail.distributel.net>
References: <20191010214347.Horde.tu3oL2hZrOsX4ZFI7489R0S@webmail.distributel.net>
Message-ID: <CADx88nRgRZYsWqpJYGe4zhUJ_1=TGOu1xSn=OYFtdJmg8dOxKQ@mail.gmail.com>

Why not build an OGC gpkg GEOPACKAGE it supports 4326 tiles
you can extract the tile_data blob if you need to


On Thu, Oct 10, 2019, 5:51 PM <mladen-g at distributel.net> wrote:

>
> Hello,
>
> I've been using GDAL for a while, but I am still a newbie to the API.
> I see there are some experts on this group, so apologies if I'm asking
> something simple (my searches did not reveal the answers I was looking
> for).
>
> Here is my problem:
>
> I need to take an input raster, split into areas of various sizes,
> resample each area into a 256x256 tile, reproject to EPSG:4326 and
> send the resulting pixels to a DB.
>
> GDAL is perfect for this, but I am using the C# bindings and I'm not
> sure what is the most performant way to do it.
>
> I used the following two references to create something that works,
> but I am wondering if it can be improved:
>
> https://gis.stackexchange.com/questions/297831/using-gdalwarp-with-c-bindings
> https://lists.osgeo.org/pipermail/gdal-dev/2017-February/046046.html
>
> How I do it right now:
>
> 1)  Copy the input grid to RAM disk for fast access
> 2)  Invoke Gdal.wrapper_GDALWarpDestName() for reprojection,
> resampling, and output to a /vsimem/ memory-mapped file
> 3)  Read the memory-mapped file into a Dataset (returned by
> wrapper_GDALWarpDestName())
> 4)  Write the Dataset values to DB
>
> What I would like to know:
>
> 1)  To skip the /vsimem file creation, how can I use
> Gdal.wrapper_GDALWarpDestDs() instead of -DestName?  It requires a
> dataset as a parameter, but I am not sure how to initialize it
> correctly.  I've tried Gdal.GetDriverByName("VRT").Create(...) and
> .GetDriverByName("MEM").Create(...), but all the values end up being 0
> when I pass the dataset to wrapper_GDALWarpDestDs()?
>
> 2)  Is there a more direct, efficient way to do what I'm doing?  Here
> is the relevant code
>
> <snip>
> using (Dataset rasterInput = Gdal.Open(inputRasterPath,
> Access.GA_ReadOnly))
> {
>    IntPtr[] ptr = {Dataset.getCPtr(inputRasterPath).Handle};
>    GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
> ...
>     var dss = new
> SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false,
> null);
> ..
>     foreach (var tileExtent in overlappingTileExtents) // tileExtent
> just contains minX/minY/maxX/maxY
>     {
>     ...
>
>        string vsiMemFilePath =
> $"/vsimem/{destinationTableName}#{extentName}#tile{indexNumber}.vrt";
>        string[] options = {
>                                  "-of", "VRT",
>                                  "-srcnodata", "99999.9",
>                                  "-dstnodata", "99999.9",
>                                  "-ot", "Float32",
>                                  "-t_srs", "EPSG:4326",
>                                  "-r", "average"),
>                                  "-te", tileExtent.xmin.ToString(),
> tileExtent.ymin.ToString(), tileExtent.xmax.ToString(),
> tileExtent.ymax.ToString(),
>                                  "-ts", "256", "256"
>                              };
>
>         using (Dataset ds =
> Gdal.wrapper_GDALWarpDestName(vsiMemFilePath, 1, dss, new
> GDALWarpAppOptions(options), null, null))
>         {
> ...
>           //read the geotransform + first band and write each pixel
> lat/long + value to the DB
> ...
>         }
>
>      Gdal.Unlink(vsiMemFilePath)
>
> ....
>
> Regards,
> Mladen
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191010/b92a6021/attachment-0001.html>

From simon.eves at omnisci.com  Thu Oct 10 16:17:41 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Thu, 10 Oct 2019 16:17:41 -0700
Subject: [gdal-dev] ogr2ogr to convert one CSV row of MULTIPOLYGON to many
	CSV rows of POLYGON
Message-ID: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>

Dear List,

I need to do this super-urgently

I am trying to use ogr2ogr -explodecollections but it does nothing.

I don't seem to be able to install GDAL for Python (it fails to compile the
wrapper)

I will write a command-line tool in C++ if I have to, but I'd really rather
not.

Anyone have the magic incantation, please?

Simon

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191010/d4c5649e/attachment.html>

From alansnow21 at gmail.com  Thu Oct 10 18:57:16 2019
From: alansnow21 at gmail.com (Alan Snow)
Date: Thu, 10 Oct 2019 20:57:16 -0500
Subject: [gdal-dev] ogr2ogr to convert one CSV row of MULTIPOLYGON to
 many CSV rows of POLYGON
In-Reply-To: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
References: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
Message-ID: <CAGybdFS_2iyL1D0jCDwgKE_5cdkBctJhnZAM_7fcxh_QAKc+aQ@mail.gmail.com>

You could try geopandas. It has an explode method that looks like it does
what you want.
https://github.com/geopandas/geopandas/blob/a3170ecbf76fc91188cd67c93c123c5fa27e9c95/geopandas/geodataframe.py#L659

On Thu, Oct 10, 2019, 6:17 PM Simon Eves <simon.eves at omnisci.com> wrote:

> Dear List,
>
> I need to do this super-urgently
>
> I am trying to use ogr2ogr -explodecollections but it does nothing.
>
> I don't seem to be able to install GDAL for Python (it fails to compile
> the wrapper)
>
> I will write a command-line tool in C++ if I have to, but I'd really
> rather not.
>
> Anyone have the magic incantation, please?
>
> Simon
>
> --
> <http://www.omnisci.com/>
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
>
>
> Email: simon.eves at omnisci.com | Cell:  415.902.1996
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191010/750f43df/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 11 01:08:17 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 11 Oct 2019 01:08:17 -0700 (MST)
Subject: [gdal-dev] ogr2ogr to convert one CSV row of MULTIPOLYGON to
 many CSV rows of POLYGON
In-Reply-To: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
References: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
Message-ID: <1570781297134-0.post@n6.nabble.com>

Hi,

Please provide some test data and explain in details what did you try.
Spending some time for making an answerable question would certainly be the
best way for getting fast and usable help.

-Jukka Rahkonen-



Simon Eves wrote
> Dear List,
> 
> I need to do this super-urgently
> 
> I am trying to use ogr2ogr -explodecollections but it does nothing.
> 
> I don't seem to be able to install GDAL for Python (it fails to compile
> the
> wrapper)
> 
> I will write a command-line tool in C++ if I have to, but I'd really
> rather
> not.
> 
> Anyone have the magic incantation, please?
> 
> Simon
> 
> -- 
> &lt;http://www.omnisci.com/&gt;
> Simon Eves
> Senior Graphics Engineer, Rendering Group
> 100 Montgomery St (5th Floor), San Francisco, CA 94104, USA
> 
> 
> Email: 

> simon.eves@

>  | Cell:  415.902.1996
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 11 06:09:31 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 11 Oct 2019 06:09:31 -0700 (MST)
Subject: [gdal-dev] ogr2ogr to convert one CSV row of MULTIPOLYGON to
 many CSV rows of POLYGON
In-Reply-To: <1570781297134-0.post@n6.nabble.com>
References: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
 <1570781297134-0.post@n6.nabble.com>
Message-ID: <1570799371684-0.post@n6.nabble.com>

Here is a partial solution or workaround

Take this as input

id,wkt
1,"MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681
635, 895 588, 632 432, 681 635 )))"

Run this 
ogr2ogr -f csv -lco geometry=as_wkt -explodecollections wkt_expl.csv wkt.csv

Get this result

WKT,id,wkt
"POLYGON ((296 643,623 660,531 484,349 507,296 643))","1","MULTIPOLYGON (((
296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681 635, 895 588, 632
432, 681 635 )))"
"POLYGON ((681 635,895 588,632 432,681 635))","1","MULTIPOLYGON ((( 296 643,
623 660, 531 484, 349 507, 296 643 )), (( 681 635, 895 588, 632 432, 681 635
)))"

So, the original multigeometry is included in both lines but an additional
WKT columns contains the exploded polygons. Without -lco geometry=as_wkt
just the the multipolygon geometry is written into both lines.

id,wkt
"1","MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681
635, 895 588, 632 432, 681 635 )))"
"1","MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681
635, 895 588, 632 432, 681 635 )))"


So something happened but not exactly what I would have guessed. Use case is
a bit special but perhaps this is buggy behavior.

-Jukka Rahkonen-



jratike80 wrote
> Hi,
> 
> Please provide some test data and explain in details what did you try.
> Spending some time for making an answerable question would certainly be
> the
> best way for getting fast and usable help.
> 
> -Jukka Rahkonen-





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From are131 at psu.edu  Fri Oct 11 06:39:19 2019
From: are131 at psu.edu (Edson, Adam Robert)
Date: Fri, 11 Oct 2019 13:39:19 +0000
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
Message-ID: <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>

I can't make the NITF file available, however the relevant portion of the BANDSB TRE should look like (with the type following in parentheses):

        RAD_QUANTITY      = 'SPECTRAL RADIANCE       '  (BCS-A)
        RAD_QUANTITY_UNIT = 'S'                                      (BCS-A)
        SCALE_FACTOR      = '8.0000000E+01'     ( IEEE-754 32-bit float)
        ADDITIVE_FACTOR   = '0.0000000E+00'  ( IEEE-754 32-bit float)
        ROW_GSD           = '0030.00'                                     (BCS-N)
        ROW_GSD_UNIT      = 'M'                                          (BCS-A)
        COL_GSD           = '0030.00'                                       (BCS-N)
        COL_GSD_UNIT      = 'M'                                            (BCS-A)
        SPT_RESP_ROW      = '-------'                                     (BCS-N)
        SPT_RESP_UNIT_ROW = 'M'                                     (BCS-A)
        SPT_RESP_COL      = '-------'                                       (BCS-N)
        SPT_RESP_UNIT_COL = 'M'                                       (BCS-A)
        DATA_FLD_1        = '                                                '(unsigned integer)
        EXISTENCE_MASK    = '2306867200'                    (unsigned integer)
        RAD_ADJ_SURF      = 'DETECTOR                '              (BCS-A)


________________________________
From: Brad Hards <bradh at frogmouth.net>
Sent: Thursday, October 10, 2019 4:47 PM
To: Edson, Adam Robert <are131 at psu.edu>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: RE: [gdal-dev] python GDAL issue


Can you make the NITF file available? Can you at least post the relevant part of the BANDSB TRE from the file?



Brad



From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Edson, Adam Robert
Sent: Friday, 11 October 2019 6:09 AM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] python GDAL issue



I am trying to parse a TRE in a NITF following the spec found here (https://nsgreg.nga.mil/doc/view?i=4829&month=10&day=10&year=2019<https://nam01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fnsgreg.nga.mil%2Fdoc%2Fview%3Fi%3D4829%26month%3D10%26day%3D10%26year%3D2019&data=02%7C01%7Care131%40psu.edu%7C6e7b7d4bbfff4e39787508d74dc32079%7C7cf48d453ddb4389a9c1c115526eb52e%7C0%7C1%7C637063372780065649&sdata=m7L1GEbwkDX5fdJxaCeya4zP5Dg34luNAYUdqA6tx%2Bo%3D&reserved=0>). Specifically, I am having trouble with the BANDSB TRE with the EXISTENCE_MASK field. It is supposed to be an unsigned int that can be used as bit flags for data following after it. I am currently getting garbage at this location from the gdal.getMetadata('TRE') call. Any help would be appreciated.



Adam


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191011/421fc659/attachment-0001.html>

From bradh at frogmouth.net  Fri Oct 11 22:51:54 2019
From: bradh at frogmouth.net (Brad Hards)
Date: Sat, 12 Oct 2019 16:51:54 +1100
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>
Message-ID: <00e501d580c1$27299e20$757cda60$@frogmouth.net>

GDAL's NITF encoding doesn't appear to have BANDSB yet:
https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml

 

It would definitely help to see how that file encodes it. Can you open the
NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some
length value), and copy out the following 0nnnn characters?

 

Brad

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191012/da0d2cd6/attachment.html>

From sethg at geographika.co.uk  Sat Oct 12 08:49:22 2019
From: sethg at geographika.co.uk (Seth G)
Date: Sat, 12 Oct 2019 17:49:22 +0200
Subject: [gdal-dev] CSV headers with extra comma
Message-ID: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>

Hi list,

I came across a minor issue in MapServer, but it is GDAL related. 
The following command (using a shapefile from MapServer's msautotest) with a single field:

ogr2ogr -f csv my.csv bdry_counpy2.shp -select CTY_NAME

Produces the following:

CTY_NAME,
Lake of the Woods

Note the extra comma in the field header. If more than one field is selected then there is no additional comma. 

Should I log this as an issue on GitHub?

Seth

--
web:http://geographika.co.uk
twitter: @geographika

From sethg at geographika.co.uk  Sat Oct 12 09:06:40 2019
From: sethg at geographika.co.uk (Seth G)
Date: Sat, 12 Oct 2019 18:06:40 +0200
Subject: [gdal-dev] CSV headers with extra comma
In-Reply-To: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>
References: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>
Message-ID: <133567c5-57f9-4901-9a9e-ff512ea1af59@www.fastmail.com>

Forgot to add - using Windows builds of GDAL 3.0.1, released 2019/06/28. 

--
web:http://geographika.co.uk
twitter: @geographika

On Sat, Oct 12, 2019, at 5:49 PM, Seth G wrote:
> Hi list,
> 
> I came across a minor issue in MapServer, but it is GDAL related. 
> The following command (using a shapefile from MapServer's msautotest) 
> with a single field:
> 
> ogr2ogr -f csv my.csv bdry_counpy2.shp -select CTY_NAME
> 
> Produces the following:
> 
> CTY_NAME,
> Lake of the Woods
> 
> Note the extra comma in the field header. If more than one field is 
> selected then there is no additional comma. 
> 
> Should I log this as an issue on GitHub?
> 
> Seth
> 
> --
> web:http://geographika.co.uk
> twitter: @geographika
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From even.rouault at spatialys.com  Sat Oct 12 09:20:48 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 12 Oct 2019 18:20:48 +0200
Subject: [gdal-dev] CSV headers with extra comma
In-Reply-To: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>
References: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>
Message-ID: <12277049.5Ax2EVfcja@even-i700>

On samedi 12 octobre 2019 17:49:22 CEST Seth G wrote:
> Hi list,
> 
> I came across a minor issue in MapServer, but it is GDAL related.
> The following command (using a shapefile from MapServer's msautotest) with a
> single field:
> 
> ogr2ogr -f csv my.csv bdry_counpy2.shp -select CTY_NAME
> 
> Produces the following:
> 
> CTY_NAME,
> Lake of the Woods
> 
> Note the extra comma in the field header. If more than one field is selected
> then there is no additional comma.
> 
> Should I log this as an issue on GitHub?

Seth,

This is a intended hack. The OGR CSV reader will not accept CSV files whose 
header line doesn't contain a field separator, hence the write side adds this 
extra column.
That said the historical limitation of the reader not to accept headers with 
one field  should probably be changed. So yes might be worth filing an issue

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sethg at geographika.co.uk  Sat Oct 12 14:38:54 2019
From: sethg at geographika.co.uk (Seth G)
Date: Sat, 12 Oct 2019 23:38:54 +0200
Subject: [gdal-dev] CSV headers with extra comma
In-Reply-To: <12277049.5Ax2EVfcja@even-i700>
References: <d0878271-8692-42c4-bea3-bf0837ebe5d5@www.fastmail.com>
 <12277049.5Ax2EVfcja@even-i700>
Message-ID: <5bb4ef52-3912-4fb3-8a38-b02ec75bbd32@www.fastmail.com>

Thanks for the clarification Even. 
Issue opened at https://github.com/OSGeo/gdal/issues/1929 so will hopefully appear if someone searches for this again in the future. 

Seth

On Sat, Oct 12, 2019, at 6:20 PM, Even Rouault wrote:
> On samedi 12 octobre 2019 17:49:22 CEST Seth G wrote:
> > Hi list,
> > 
> > I came across a minor issue in MapServer, but it is GDAL related.
> > The following command (using a shapefile from MapServer's msautotest) with a
> > single field:
> > 
> > ogr2ogr -f csv my.csv bdry_counpy2.shp -select CTY_NAME
> > 
> > Produces the following:
> > 
> > CTY_NAME,
> > Lake of the Woods
> > 
> > Note the extra comma in the field header. If more than one field is selected
> > then there is no additional comma.
> > 
> > Should I log this as an issue on GitHub?
> 
> Seth,
> 
> This is a intended hack. The OGR CSV reader will not accept CSV files whose 
> header line doesn't contain a field separator, hence the write side adds this 
> extra column.
> That said the historical limitation of the reader not to accept headers with 
> one field  should probably be changed. So yes might be worth filing an issue
> 
> Even
> 
> -- 
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>

From are131 at psu.edu  Mon Oct 14 04:01:45 2019
From: are131 at psu.edu (Edson, Adam Robert)
Date: Mon, 14 Oct 2019 11:01:45 +0000
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <00e501d580c1$27299e20$757cda60$@frogmouth.net>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
Message-ID: <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>

I am working on adding BANDSB and the other TREs listed in the SNIP document.

I am not sure what you are asking for.
However, here is the output from gdal.getMetadata('TRE') for the relevant portion of the BANDSB TRE

SPECTRAL RADIANCE       SB\\0\\0\\0\\0\\0\\00030.00M0030.00M-------M-------M
                                               \\0\\0DETECTOR                \x7fU

This is the section from the radiometric_quantity field to wave_length_unit field.

Thanks!
Adam

________________________________
From: Brad Hards <bradh at frogmouth.net>
Sent: Saturday, October 12, 2019 1:51 AM
To: Edson, Adam Robert <are131 at psu.edu>; gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: RE: [gdal-dev] python GDAL issue


GDAL’s NITF encoding doesn’t appear to have BANDSB yet: https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml



It would definitely help to see how that file encodes it. Can you open the NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some length value), and copy out the following 0nnnn characters?



Brad


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191014/e17fdefc/attachment.html>

From simon.eves at omnisci.com  Mon Oct 14 09:15:00 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Mon, 14 Oct 2019 09:15:00 -0700
Subject: [gdal-dev] ogr2ogr to convert one CSV row of MULTIPOLYGON to
 many CSV rows of POLYGON
In-Reply-To: <1570799371684-0.post@n6.nabble.com>
References: <CAJf0KTTOEsqrR=ZaKBTkCqXZgfCw5hM+y8CaG_7PKX+LybVqBw@mail.gmail.com>
 <1570781297134-0.post@n6.nabble.com> <1570799371684-0.post@n6.nabble.com>
Message-ID: <CAJf0KTTwPs80pAe4P=6Bc28b1wa+jv9zHO_3r=QPQ8wmCJq-nw@mail.gmail.com>

Thanks for that, Jukka, and sorry for the vagueness of my original post...
I was under a very tight deadline to finish something on Thursday before
being away for a long weekend.

I got the same result as you without the -lco option. The output file just
contained the same MULTIPOLYGONS, although the file was not identical (I
presume due to precision of some of the numbers).

Adding that option, however, still doesn't create a third column, at least
not with my file, which I also neglected to say is very wide (hundreds of
thousands of small POLYGONs in each MULTIPOLYGON).

The file is private data, so I can't post it, I'm afraid.

In the end, I wrote a script to just read in the file as text and chop up
the lines, basically splitting on ")),((".

I'll have a play with geopandas too.

SE


On Fri, Oct 11, 2019 at 6:09 AM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Here is a partial solution or workaround
>
> Take this as input
>
> id,wkt
> 1,"MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681
> 635, 895 588, 632 432, 681 635 )))"
>
> Run this
> ogr2ogr -f csv -lco geometry=as_wkt -explodecollections wkt_expl.csv
> wkt.csv
>
> Get this result
>
> WKT,id,wkt
> "POLYGON ((296 643,623 660,531 484,349 507,296 643))","1","MULTIPOLYGON (((
> 296 643, 623 660, 531 484, 349 507, 296 643 )), (( 681 635, 895 588, 632
> 432, 681 635 )))"
> "POLYGON ((681 635,895 588,632 432,681 635))","1","MULTIPOLYGON ((( 296
> 643,
> 623 660, 531 484, 349 507, 296 643 )), (( 681 635, 895 588, 632 432, 681
> 635
> )))"
>
> So, the original multigeometry is included in both lines but an additional
> WKT columns contains the exploded polygons. Without -lco geometry=as_wkt
> just the the multipolygon geometry is written into both lines.
>
> id,wkt
> "1","MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), ((
> 681
> 635, 895 588, 632 432, 681 635 )))"
> "1","MULTIPOLYGON ((( 296 643, 623 660, 531 484, 349 507, 296 643 )), ((
> 681
> 635, 895 588, 632 432, 681 635 )))"
>
>
> So something happened but not exactly what I would have guessed. Use case
> is
> a bit special but perhaps this is buggy behavior.
>
> -Jukka Rahkonen-
>
>
>
> jratike80 wrote
> > Hi,
> >
> > Please provide some test data and explain in details what did you try.
> > Spending some time for making an answerable question would certainly be
> > the
> > best way for getting fast and usable help.
> >
> > -Jukka Rahkonen-
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191014/7fb9a096/attachment.html>

From rjllane at gmail.com  Mon Oct 14 12:23:58 2019
From: rjllane at gmail.com (Richard Lane)
Date: Tue, 15 Oct 2019 06:23:58 +1100
Subject: [gdal-dev] Syntax for translation to ERMapper Raster with options
Message-ID: <CAPPQrLqdB8ghFnZVL_ZYFUHY==sscmeyUCxeK4qocYtwgOqifg@mail.gmail.com>

I am trying to convert some SRTM raster data from Arc/Info ASCII Grid
format to ERMapper ERS grid format and program gdal_translate is not doing
what I was hoping that it would do. I imagine that I have the wrong syntax.
Any help would be greatly appreciated.

The default output when I used the following command was a
Signed32BitInteger grid with no projection, datum or units information.

gdal_translate -of ERS cut_s30e090.asc cut_s30e090.ers

To specify output as Signed16BitInteger with Projection = GEODETIC, Datum =
GDA94, and Units = Degrees, I issued the following command

gdal_translate -of ERS -co “PROJ=GEODETIC” -co “DATUM=GDA94” -co
“UNITS=Degrees” -ot Int16 -projwin_srs EPSG:4283 cut_s30e120.asc
cut_s30e120.ers

What am I doing wrong? I am very new to GDAL, so my errors could be very,
very basic, but I came up with the above by reading the documentation as
carefully as I could.

Thank-you ... Richard
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/f8897c86/attachment.html>

From bradh at frogmouth.net  Mon Oct 14 15:16:40 2019
From: bradh at frogmouth.net (Brad Hards)
Date: Tue, 15 Oct 2019 09:16:40 +1100
Subject: [gdal-dev] python GDAL issue
In-Reply-To: <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>
References: <CH2PR02MB6165C157FAD7C2C17A28573F93940@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00a401d57fab$f9b63220$ed229660$@frogmouth.net>
 <CH2PR02MB616574E752B2ADF3A6C9D09193970@CH2PR02MB6165.namprd02.prod.outlook.com>,
 <00e501d580c1$27299e20$757cda60$@frogmouth.net>
 <CH2PR02MB6165C6D7D92DA48F1E8BDB9193900@CH2PR02MB6165.namprd02.prod.outlook.com>
Message-ID: <00e901d582dd$0e5e44e0$2b1acea0$@frogmouth.net>

I think the problem is that there isn't any real way to handle the IEEE-754
(or raw int/uint bitmask) in GDAL at the moment. 

 

Working through the part you've posted:

S is the unit quantity

 

The part that looks like:

B\\0\\0\\0

is therefore the SCALE FACTOR, which is really IEEE 754-2008 binary encoded,
and the existing TRE XML definition and parsing code doesn't handle that
case AFAICT.

 

This part is the ROW_GSD and COL_GSD + units:

0030.00

M

0030.00

M

 

In that case, I think there is a missing value in the TRE (because there has
to be four bytes, and there are only three shown in your sample, which I
assume is the test data that NGA derived from LANDSAT 8).

 

I've also been looking at handling "weird" TREs better (on and off for a
while). I have a Java implementation that shares the XML definition, and the
plan is to add two new types to the field definition:

        <xs:attribute name="type" use="optional">

            <xs:simpleType>

                <xs:restriction base="xs:string">

                    <xs:enumeration value="string"/>

                    <xs:enumeration value="integer"/>

                    <xs:enumeration value="real"/>

                    <xs:enumeration value="UINT"/>

                    <xs:enumeration value="IEEE754"/>

                </xs:restriction>

            </xs:simpleType>

        </xs:attribute>

 

(where UINT and IEEE754 values are new, and are binary encoded instead of
string encoded).

 

Happy to collaborate on this if you're interested.

 

Brad

 

 

From: Edson, Adam Robert <are131 at psu.edu> 
Sent: Monday, 14 October 2019 10:02 PM
To: Brad Hards <bradh at frogmouth.net>; gdal-dev at lists.osgeo.org
Subject: Re: [gdal-dev] python GDAL issue

 

I am working on adding BANDSB and the other TREs listed in the SNIP
document.

 

I am not sure what you are asking for.

However, here is the output from gdal.getMetadata('TRE') for the relevant
portion of the BANDSB TRE

SPECTRAL RADIANCE       SB\\0\\0\\0\\0\\0\\00030.00M0030.00M-------M-------M

                                               \\0\\0DETECTOR
<file://0//0DETECTOR>                 \x7fU

This is the section from the radiometric_quantity field to wave_length_unit
field.

 

Thanks!

Adam

 

  _____  

From: Brad Hards <bradh at frogmouth.net <mailto:bradh at frogmouth.net> >
Sent: Saturday, October 12, 2019 1:51 AM
To: Edson, Adam Robert <are131 at psu.edu <mailto:are131 at psu.edu> >;
gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
<gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org> >
Subject: RE: [gdal-dev] python GDAL issue 

 

GDAL's NITF encoding doesn't appear to have BANDSB yet:
https://github.com/OSGeo/gdal/blob/master/gdal/data/nitf_spec.xml

 

It would definitely help to see how that file encodes it. Can you open the
NITF file, find the part that starts with BANDSB0nnnn (where 0nnnn is some
length value), and copy out the following 0nnnn characters?

 

Brad

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/2a7c3930/attachment-0001.html>

From giohappy at gmail.com  Tue Oct 15 03:57:16 2019
From: giohappy at gmail.com (G. Allegri)
Date: Tue, 15 Oct 2019 12:57:16 +0200
Subject: [gdal-dev] gdal_contour attribute field not populated for polygons
	outputs
Message-ID: <CAB4g1=wa9C7EvCubWPGEH+M2Up6d0Bm7GHruUyfvuXGUQhX+tw@mail.gmail.com>

Dear list,
I'm using gdal_contour with a single band (float) raster. It works as
expected for the default linestring outputs but when I set the "-p" option
the attribute field is created but it's empty.

This is the command I run:

>gdal_contour -b 1 -a val -i 10.0 -p -f "ESRI Shapefile" <raster_path>.tif
<out_path>.shp

Is this a known issue or am I doing something wrong?
Thanks,
Giovanni
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/68bf9190/attachment.html>

From even.rouault at spatialys.com  Tue Oct 15 04:02:31 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 15 Oct 2019 13:02:31 +0200
Subject: [gdal-dev] gdal_contour attribute field not populated for
	polygons outputs
In-Reply-To: <CAB4g1=wa9C7EvCubWPGEH+M2Up6d0Bm7GHruUyfvuXGUQhX+tw@mail.gmail.com>
References: <CAB4g1=wa9C7EvCubWPGEH+M2Up6d0Bm7GHruUyfvuXGUQhX+tw@mail.gmail.com>
Message-ID: <3479836.cTlkArd8Wr@even-i700>

On mardi 15 octobre 2019 12:57:16 CEST G. Allegri wrote:
> Dear list,
> I'm using gdal_contour with a single band (float) raster. It works as
> expected for the default linestring outputs but when I set the "-p" option
> the attribute field is created but it's empty.
> 
> This is the command I run:
> >gdal_contour -b 1 -a val -i 10.0 -p -f "ESRI Shapefile" <raster_path>.tif
> 
> <out_path>.shp
> 
> Is this a known issue or am I doing something wrong?

https://gdal.org/programs/gdal_contour.html :

"""

-a <name>
    Provides a name for the attribute in which to put the elevation. If not 
provided no elevation attribute is attached. Ignored in polygonal contouring 
(-p) mode.
"""

Use -amin / -amax

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From giohappy at gmail.com  Tue Oct 15 05:28:23 2019
From: giohappy at gmail.com (G. Allegri)
Date: Tue, 15 Oct 2019 14:28:23 +0200
Subject: [gdal-dev] gdal_contour attribute field not populated for
 polygons outputs
In-Reply-To: <3479836.cTlkArd8Wr@even-i700>
References: <CAB4g1=wa9C7EvCubWPGEH+M2Up6d0Bm7GHruUyfvuXGUQhX+tw@mail.gmail.com>
 <3479836.cTlkArd8Wr@even-i700>
Message-ID: <CAB4g1=x+MORSnjgSKvsnyOK+H1Sgnb9sqSKKJo93UG3b9i+ppA@mail.gmail.com>

Thanks a lor Even, I missed that line ;)
Works perfectly with -amin / -amax

Giovanni

Il giorno mar 15 ott 2019 alle ore 13:02 Even Rouault <
even.rouault at spatialys.com> ha scritto:

> On mardi 15 octobre 2019 12:57:16 CEST G. Allegri wrote:
> > Dear list,
> > I'm using gdal_contour with a single band (float) raster. It works as
> > expected for the default linestring outputs but when I set the "-p"
> option
> > the attribute field is created but it's empty.
> >
> > This is the command I run:
> > >gdal_contour -b 1 -a val -i 10.0 -p -f "ESRI Shapefile"
> <raster_path>.tif
> >
> > <out_path>.shp
> >
> > Is this a known issue or am I doing something wrong?
>
> https://gdal.org/programs/gdal_contour.html :
>
> """
>
> -a <name>
>     Provides a name for the attribute in which to put the elevation. If
> not
> provided no elevation attribute is attached. Ignored in polygonal
> contouring
> (-p) mode.
> """
>
> Use -amin / -amax
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/912edabf/attachment.html>

From brandon.biggs at ski.org  Tue Oct 15 14:00:36 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Tue, 15 Oct 2019 21:00:36 +0000
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
Message-ID: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,

I'm wondering how to build custom packages to use in my Conda installation?

In particular, I would like a GWD driver for ogr2ogr.

I would like the AutoCAD DWG driver<https://gdal.org/drivers/vector/dwg.html>, but it looks as if it is not built in my installation.

It looks as if I will need to edit the make file and run a custom build to get the driver. I searched the docs and Github for building instructions, but don't see any.

The instructions for "hand editing" the GNUmakefile don't say what to change, and I'm not exactly sure where "paths" is and what to do with it. The fact I'm supposed to build the driver as a plugin gives me hope though that I can find the built plugin somewhere and just insert it into some plugins folder in my Conda build.

What would be the best steps from here?

Thank you,


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/6120638e/attachment.html>

From alansnow21 at gmail.com  Tue Oct 15 17:06:15 2019
From: alansnow21 at gmail.com (Alan Snow)
Date: Tue, 15 Oct 2019 19:06:15 -0500
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>

Hi Brandon.

I would recommend opening up an issue on the conda-forge feedstock:
https://github.com/conda-forge/gdal-feedstock

Best,
Alan

On Tue, Oct 15, 2019 at 4:00 PM Brandon Biggs <brandon.biggs at ski.org> wrote:

> Hello,
>
> I'm wondering how to build custom packages to use in my Conda installation?
>
> In particular, I would like a GWD driver for ogr2ogr.
>
> I would like the AutoCAD DWG driver
> <https://gdal.org/drivers/vector/dwg.html>, but it looks as if it is not
> built in my installation.
>
> It looks as if I will need to edit the make file and run a custom build to
> get the driver. I searched the docs and Github for building instructions,
> but don't see any.
>
> The instructions for "hand editing" the GNUmakefile don't say what to
> change, and I'm not exactly sure where "paths" is and what to do with it.
> The fact I'm supposed to build the driver as a plugin gives me hope though
> that I can find the built plugin somewhere and just insert it into some
> plugins folder in my Conda build.
>
> What would be the best steps from here?
>
> Thank you,
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Alan Snow
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/77a517ae/attachment.html>

From brandon.biggs at ski.org  Tue Oct 15 17:29:12 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 00:29:12 +0000
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>,
 <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>
Message-ID: <MWHPR1601MB12139EEB236DC4B727FA380BF3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,
I opened an issue:
https://github.com/conda-forge/gdal-feedstock/issues/339

Please let me know if there is something else I can do.
Thank you,


Brandon Biggs<https://www.ski.org/users/brandon-biggs>
Engineer

Smith-Kettlewell Eye Research Institute
Office: 415-345-2130
Cell: 650-833-9394

________________________________
From: Alan Snow <alansnow21 at gmail.com>
Sent: Tuesday, October 15, 2019 5:06 PM
To: Brandon Biggs <brandon.biggs at ski.org>
Cc: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Subject: Re: [gdal-dev] Adding The DWG Driver to ogr2ogr?

Hi Brandon.

I would recommend opening up an issue on the conda-forge feedstock: https://github.com/conda-forge/gdal-feedstock

Best,
Alan

On Tue, Oct 15, 2019 at 4:00 PM Brandon Biggs <brandon.biggs at ski.org<mailto:brandon.biggs at ski.org>> wrote:

Hello,

I'm wondering how to build custom packages to use in my Conda installation?

In particular, I would like a GWD driver for ogr2ogr.

I would like the AutoCAD DWG driver<https://gdal.org/drivers/vector/dwg.html>, but it looks as if it is not built in my installation.

It looks as if I will need to edit the make file and run a custom build to get the driver. I searched the docs and Github for building instructions, but don't see any.

The instructions for "hand editing" the GNUmakefile don't say what to change, and I'm not exactly sure where "paths" is and what to do with it. The fact I'm supposed to build the driver as a plugin gives me hope though that I can find the built plugin somewhere and just insert it into some plugins folder in my Conda build.

What would be the best steps from here?

Thank you,


_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev


--
Alan Snow
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/f6920196/attachment-0001.html>

From brandon.biggs at ski.org  Tue Oct 15 18:12:48 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 01:12:48 +0000
Subject: [gdal-dev] Converting 3D Polygons to 2D Polygons?
Message-ID: <MWHPR1601MB1213EA7F3C6F9C7894DC7824F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,

Is there some way to convert 3D objects to 2D polygons using ogr2ogr?

I have a large file with lots of polygons with 0 as the z coordinate. So the point would look like [1,2,0].

I would like it to be: [1,2].

Thanks,


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/69faf461/attachment.html>

From eadam at co.lincoln.or.us  Tue Oct 15 19:14:10 2019
From: eadam at co.lincoln.or.us (Eli Adam)
Date: Tue, 15 Oct 2019 19:14:10 -0700
Subject: [gdal-dev] Converting 3D Polygons to 2D Polygons?
In-Reply-To: <MWHPR1601MB1213EA7F3C6F9C7894DC7824F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB1213EA7F3C6F9C7894DC7824F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <CACqBkM9Fp_vVn=bBmcRiK-1aPCPqWAuOxSWoKzz2OQb2s0QZbA@mail.gmail.com>

On Tue, Oct 15, 2019 at 6:12 PM Brandon Biggs <brandon.biggs at ski.org> wrote:

> Hello,
>
> Is there some way to convert 3D objects to 2D polygons using ogr2ogr?
>
>
Did you already try, -dim XY

More details here,
https://gdal.org/programs/ogr2ogr.html#ogr2ogr

What happened if you tried -dim XY?

Best regards, Eli

I have a large file with lots of polygons with 0 as the z coordinate. So
> the point would look like [1,2,0].
>
> I would like it to be: [1,2].
>
> Thanks,
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191015/79294943/attachment.html>

From even.rouault at spatialys.com  Wed Oct 16 01:02:43 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Oct 2019 10:02:43 +0200
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>
Message-ID: <6605604.KP0pPkQKHn@even-i700>

On mardi 15 octobre 2019 19:06:15 CEST Alan Snow wrote:
> Hi Brandon.
> 
> I would recommend opening up an issue on the conda-forge feedstock:
> https://github.com/conda-forge/gdal-feedstock

Do you realize that the DWG driver requires a proprietary (& non-gratis) SDK ?

The alternative is the CAD driver (https://gdal.org/drivers/raster/cad.html) 
but it probably doesn't support everything of the DWG one

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From alansnow21 at gmail.com  Wed Oct 16 05:29:20 2019
From: alansnow21 at gmail.com (Alan Snow)
Date: Wed, 16 Oct 2019 07:29:20 -0500
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <6605604.KP0pPkQKHn@even-i700>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>
 <6605604.KP0pPkQKHn@even-i700>
Message-ID: <CAGybdFRUBdhSBTj_LRMR35xjeMjYbOh=pCDqODibRv_sNN9rfw@mail.gmail.com>

Ah, then that definitely won't work with conda-forge. Thanks for
pointing that out.

On Wed, Oct 16, 2019, 3:02 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mardi 15 octobre 2019 19:06:15 CEST Alan Snow wrote:
> > Hi Brandon.
> >
> > I would recommend opening up an issue on the conda-forge feedstock:
> > https://github.com/conda-forge/gdal-feedstock
>
> Do you realize that the DWG driver requires a proprietary (& non-gratis)
> SDK ?
>
> The alternative is the CAD driver (
> https://gdal.org/drivers/raster/cad.html)
> but it probably doesn't support everything of the DWG one
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/a97b9de9/attachment.html>

From mladen-g at distributel.net  Wed Oct 16 06:41:01 2019
From: mladen-g at distributel.net (mladen-g at distributel.net)
Date: Wed, 16 Oct 2019 13:41:01 +0000
Subject: [gdal-dev] C# bindings for (fast) reproject, resample,
 and send to DB
In-Reply-To: <CADx88nRgRZYsWqpJYGe4zhUJ_1=TGOu1xSn=OYFtdJmg8dOxKQ@mail.gmail.com>
References: <20191010214347.Horde.tu3oL2hZrOsX4ZFI7489R0S@webmail.distributel.net>
 <CADx88nRgRZYsWqpJYGe4zhUJ_1=TGOu1xSn=OYFtdJmg8dOxKQ@mail.gmail.com>
Message-ID: <20191016134101.Horde.yPhS_XmLzuZGrv8CK4EheDV@webmail.distributel.net>

  Hello,

Can you be more specific about what steps you are suggesting I take,  
and how that would improve performance?
Are you saying that gdalwarp-ing to gpkg is more performant than  
writing to VRT?

I looked at the geopackage docs and it seems that all results are  
encoded as ARGB, so in the case where I do not have Float32 rasters, I  
think I would have some inefficiency.  Also I guess I would have to  
specify PNG as the output, since I would have information loss with  
JPG?  In general I don't understand it enough to try, it would help if  
you could expand a bit.

What I have tried so far:

1)  Retrieve the dataset using "Gdal.wrapper_GDALWarpDestName(...)"  
(which works correctly):

Dataset ds = Gdal.wrapper_GDALWarpDestName(memFilename, 1, dss, new  
GDALWarpAppOptions(options), null, null);

2)  Retrieve the projection, GeoTransform, and GCPs (GCPs were null)

string projection = ds.GetProjection();
...
double[] geoTransform = new double[6];
ds.GetGeoTransform(resultGeoTransform);
...
GCP[] resGcps = ds.GetGCPs();

3)  Retrieve the width and height of band 1 of "ds"

Band band = ds.GetRasterBand(1);
int xSize = band.XSize;
int ySize = band.YSize;

4)  Create a new dataset with 1 band of the same width & height as  
retrieved in #3 (x size and y size were both 256, I just entered the  
literals here).

Dataset newData = Gdal.GetDriverByName("VRT").Create(memFilename, 256,  
256, 1, DataType.GDT_Float32, null);

5)  Set the projection and Geotransform as retrieved in #2, which seem  
to be the only two settable attributes (except GCPs which were null in  
the original)

newData.SetProjection(projection);
                    
var newGeoTransform = new double[6];
newGeoTransform[0] =geoTransform[0];
newGeoTransform[1] = geoTransform[1];
newGeoTransform[3] = geoTransform[3];
newGeoTransform[5] = geoTransform[5];
newData.SetGeoTransform(newGeoTransform);

6)  Use this dataset as the input to Gdal.wrapper_GDALWarpDestDS(...):

int status = Gdal.wrapper_GDALWarpDestDS(newData, 1, dss, new  
GDALWarpAppOptions(options), null, null);

This gave me a result of all null values :/

Not sure where I am going wrong?

Quoting Geospatial Information Technology Solutions  
<geospatialsolutions at gmail.com>:

> Why not build an OGC gpkg GEOPACKAGE it supports 4326 tiles        
> you can extract the tile_data blob if you need to
>         
>
>      On Thu, Oct 10, 2019, 5:51 PM <mladen-g at distributel.net> wrote:
>
>> Hello,
>>
>> I've been using GDAL for a while, but I am still a newbie to the API.   
>> I see there are some experts on this group, so apologies if I'm asking 
>> something simple (my searches did not reveal the answers I was looking 
>> for).
>>
>> Here is my problem:
>>
>> I need to take an input raster, split into areas of various sizes, 
>> resample each area into a 256x256 tile, reproject to EPSG:4326 and 
>> send the resulting pixels to a DB.
>>
>> GDAL is perfect for this, but I am using the C# bindings and I'm not 
>> sure what is the most performant way to do it.
>>
>> I used the following two references to create something that works, 
>> but I am wondering if it can be improved:
>> https://gis.stackexchange.com/questions/297831/using-gdalwarp-with-c-bindings
>> https://lists.osgeo.org/pipermail/gdal-dev/2017-February/046046.html
>>
>> How I do it right now:
>>
>> 1)  Copy the input grid to RAM disk for fast access
>> 2)  Invoke Gdal.wrapper_GDALWarpDestName() for reprojection, 
>> resampling, and output to a /vsimem/ memory-mapped file
>> 3)  Read the memory-mapped file into a Dataset (returned by 
>> wrapper_GDALWarpDestName())
>> 4)  Write the Dataset values to DB
>>
>> What I would like to know:
>>
>> 1)  To skip the /vsimem file creation, how can I use 
>> Gdal.wrapper_GDALWarpDestDs() instead of -DestName?  It requires a 
>> dataset as a parameter, but I am not sure how to initialize it 
>> correctly.  I've tried Gdal.GetDriverByName("VRT").Create(...) and 
>> .GetDriverByName("MEM").Create(...), but all the values end up being 0 
>> when I pass the dataset to wrapper_GDALWarpDestDs()?
>>
>> 2)  Is there a more direct, efficient way to do what I'm doing?  Here 
>> is the relevant code
>>
>> <snip>
>> using (Dataset rasterInput = Gdal.Open(inputRasterPath, Access.GA_ReadOnly))
>> {
>>    IntPtr[] ptr = {Dataset.getCPtr(inputRasterPath).Handle};
>>    GCHandle gcHandle = GCHandle.Alloc(ptr, GCHandleType.Pinned);
>> ...
>>     var dss = new 
>> SWIGTYPE_p_p_GDALDatasetShadow(gcHandle.AddrOfPinnedObject(), false, 
>> null);
>> ..
>>     foreach (var tileExtent in overlappingTileExtents) // tileExtent 
>> just contains minX/minY/maxX/maxY
>>     {
>>     ...
>>
>>        string vsiMemFilePath = 
>> $"/vsimem/{destinationTableName}#{extentName}#tile{indexNumber}.vrt";
>>        string[] options = {
>>                                  "-of", "VRT",
>>                                  "-srcnodata", "99999.9",
>>                                  "-dstnodata", "99999.9",
>>                                  "-ot", "Float32",
>>                                  "-t_srs", "EPSG:4326",
>>                                  "-r", "average"),
>>                                  "-te", tileExtent.xmin.ToString(), 
>> tileExtent.ymin.ToString(), tileExtent.xmax.ToString(), 
>> tileExtent.ymax.ToString(),
>>                                  "-ts", "256", "256"
>>                              };
>>
>>         using (Dataset ds = 
>> Gdal.wrapper_GDALWarpDestName(vsiMemFilePath, 1, dss, new 
>> GDALWarpAppOptions(options), null, null))
>>         {
>> ...
>>           //read the geotransform + first band and write each pixel 
>> lat/long + value to the DB
>> ...
>>         }
>>
>>      Gdal.Unlink(vsiMemFilePath)
>>
>> ....
>>
>> Regards,
>> Mladen
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/4e581aee/attachment-0001.html>

From cpaulik at vandersat.com  Wed Oct 16 08:20:55 2019
From: cpaulik at vandersat.com (Christoph Paulik)
Date: Wed, 16 Oct 2019 17:20:55 +0200
Subject: [gdal-dev] 503 Errors when accessing Public Datasets on Google
 Cloud Storage with automatic auth
Message-ID: <CAHtCBnhf2fUNTYqWp1WAVMfCFsOgRT9pe2F7x5SyqyOBAf0Pcg@mail.gmail.com>

Hi,

When doing a few requests to the Sentinel 2 bucket of Google (
https://cloud.google.com/storage/docs/public-datasets/sentinel-2) we have
been getting 503 Responses when using the automatic authentication. See the
end of this email for the full output.

This behavior goes away when using e.g. the
GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY authentication method.

The Service account this machine is running with has "Full Access to All
Cloud APIs"

Not sure if this is a gdal problem or actually a google internal issue
since accessing our own buckets works fine.

Best,
Christoph

Output:
export CPL_DEBUG=ON
gdalinfo
/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2

HTTP: Fetch(
http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token
)
HTTP: libcurl/7.65.3 OpenSSL/1.1.1c zlib/1.2.5 libssh2/1.8.2
HTTP: GDAL was built against curl 7.64.1, but is running against 7.65.3.
HTTP: These HTTP headers were set: Metadata-Flavor: Google
GOA2: Refresh Token Response:
{"access_token":"REMOVED IN EMAIL","expires_in":2877,"token_type":"Bearer"}
GOA2: Access Token : 'REMOVED IN EMAIL'
GS: Using GCE inherited permissions
GS: <html><head><meta http-equiv="content-type" content="text/html;
charset=utf-8"/><title>Sorry...</title><style> body { font-family: verdana,
arial, sans-serif; background-color: #fff; color: #000;
}</style></head><body><div><table><tr><td><b><font face=sans-serif
size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
color=#fbbc05>o</font><font color=#4285f4>g</font><font
color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
width: 50%"><div style="border-bottom: 1px solid
#dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
sending automated queries. To protect our users, we can't process your
request right now.</p></div><div style="margin-left: 4em;">See <a href="
https://support.google.com/websearch/answer/86640">Google Help</a> for more
information.<br/><br/></div><div style="text-align: center; border-top: 1px
solid #dfdfdf;"><a href="https://www.google.com">Google
Home</a></div></body></html>
VSICURL: GetFileSize(
https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2)=0
 response_code=503
GS: <html><head><meta http-equiv="content-type" content="text/html;
charset=utf-8"/><title>Sorry...</title><style> body { font-family: verdana,
arial, sans-serif; background-color: #fff; color: #000;
}</style></head><body><div><table><tr><td><b><font face=sans-serif
size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
color=#fbbc05>o</font><font color=#4285f4>g</font><font
color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
width: 50%"><div style="border-bottom: 1px solid
#dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
sending automated queries. To protect our users, we can't process your
request right now.</p></div><div style="margin-left: 4em;">See <a href="
https://support.google.com/websearch/answer/86640">Google Help</a> for more
information.<br/><br/></div><div style="text-align: center; border-top: 1px
solid #dfdfdf;"><a href="https://www.google.com">Google
Home</a></div></body></html>
ERROR 11: HTTP response code: 503
gdalinfo failed - unable to open
'/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2'.


-- 
*Christoph Paulik* // Head of Infrastructure
VanderSat // Satellite observed water data. Globally. Daily.
Wilhelminastraat 43a, 2011 VK, Haarlem (NL), The Netherlands
<https://maps.google.com/?q=Wilhelminastraat+43a,+2011+VK,+Haarlem+(NL),+The+Netherlands&entry=gmail&source=g>
*M*  +31 6 18271928 *W*  www.vandersat.com

--------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/70a6fc0c/attachment.html>

From even.rouault at spatialys.com  Wed Oct 16 08:31:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Oct 2019 17:31:53 +0200
Subject: [gdal-dev] 503 Errors when accessing Public Datasets on Google
	Cloud Storage with automatic auth
In-Reply-To: <CAHtCBnhf2fUNTYqWp1WAVMfCFsOgRT9pe2F7x5SyqyOBAf0Pcg@mail.gmail.com>
References: <CAHtCBnhf2fUNTYqWp1WAVMfCFsOgRT9pe2F7x5SyqyOBAf0Pcg@mail.gmail.com>
Message-ID: <1845885.oxxl9COrMj@even-i700>

Hi,

did you try with Google gsutil tool ?

Anyway as it is a public resource that doesn't require any signing, you could 
just use

/vsicurl/https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/
NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/
L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2

Even

> Hi,
> 
> When doing a few requests to the Sentinel 2 bucket of Google (
> https://cloud.google.com/storage/docs/public-datasets/sentinel-2) we have
> been getting 503 Responses when using the automatic authentication. See the
> end of this email for the full output.
> 
> This behavior goes away when using e.g. the
> GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY authentication method.
> 
> The Service account this machine is running with has "Full Access to All
> Cloud APIs"
> 
> Not sure if this is a gdal problem or actually a google internal issue
> since accessing our own buckets works fine.
> 
> Best,
> Christoph
> 
> Output:
> export CPL_DEBUG=ON
> gdalinfo
> /vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N
> 0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T11
> 2511/IMG_DATA/T29TNE_20170719T112119_B01.jp2
> 
> HTTP: Fetch(
> http://metadata.google.internal/computeMetadata/v1/instance/service-accounts
> /default/token )
> HTTP: libcurl/7.65.3 OpenSSL/1.1.1c zlib/1.2.5 libssh2/1.8.2
> HTTP: GDAL was built against curl 7.64.1, but is running against 7.65.3.
> HTTP: These HTTP headers were set: Metadata-Flavor: Google
> GOA2: Refresh Token Response:
> {"access_token":"REMOVED IN EMAIL","expires_in":2877,"token_type":"Bearer"}
> GOA2: Access Token : 'REMOVED IN EMAIL'
> GS: Using GCE inherited permissions
> GS: <html><head><meta http-equiv="content-type" content="text/html;
> charset=utf-8"/><title>Sorry...</title><style> body { font-family: verdana,
> arial, sans-serif; background-color: #fff; color: #000;
> }</style></head><body><div><table><tr><td><b><font face=sans-serif
> size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
> color=#fbbc05>o</font><font color=#4285f4>g</font><font
> color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
> style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
> width: 50%"><div style="border-bottom: 1px solid
> #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
> 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
> sending automated queries. To protect our users, we can't process your
> request right now.</p></div><div style="margin-left: 4em;">See <a href="
> https://support.google.com/websearch/answer/86640">Google Help</a> for more
> information.<br/><br/></div><div style="text-align: center; border-top: 1px
> solid #dfdfdf;"><a href="https://www.google.com">Google
> Home</a></div></body></html>
> VSICURL: GetFileSize(
> https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_
> MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T2
> 9TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2)=0
> response_code=503
> GS: <html><head><meta http-equiv="content-type" content="text/html;
> charset=utf-8"/><title>Sorry...</title><style> body { font-family: verdana,
> arial, sans-serif; background-color: #fff; color: #000;
> }</style></head><body><div><table><tr><td><b><font face=sans-serif
> size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
> color=#fbbc05>o</font><font color=#4285f4>g</font><font
> color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
> style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
> width: 50%"><div style="border-bottom: 1px solid
> #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
> 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
> sending automated queries. To protect our users, we can't process your
> request right now.</p></div><div style="margin-left: 4em;">See <a href="
> https://support.google.com/websearch/answer/86640">Google Help</a> for more
> information.<br/><br/></div><div style="text-align: center; border-top: 1px
> solid #dfdfdf;"><a href="https://www.google.com">Google
> Home</a></div></body></html>
> ERROR 11: HTTP response code: 503
> gdalinfo failed - unable to open
> '/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_
> N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T1
> 12511/IMG_DATA/T29TNE_20170719T112119_B01.jp2'.


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From cpaulik at vandersat.com  Wed Oct 16 08:38:29 2019
From: cpaulik at vandersat.com (Christoph Paulik)
Date: Wed, 16 Oct 2019 17:38:29 +0200
Subject: [gdal-dev] 503 Errors when accessing Public Datasets on Google
 Cloud Storage with automatic auth
In-Reply-To: <1845885.oxxl9COrMj@even-i700>
References: <CAHtCBnhf2fUNTYqWp1WAVMfCFsOgRT9pe2F7x5SyqyOBAf0Pcg@mail.gmail.com>
 <1845885.oxxl9COrMj@even-i700>
Message-ID: <CAHtCBngg==sjXeq3rwTdE5TX9_cAqrvDDxmz=KQo0hTLXKJdhw@mail.gmail.com>

Hi,

The thing is that one request works fine in any case.
But google seems to rate limit on the public bucket in the following cases:

- no authentication (/vsicurl/ driver)
- authentication with automatic detection by gdal that it is running on a
GCE VM.

but not when using the explicit authentication with
GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY

Christoph


On Wed, 16 Oct 2019 at 17:31, Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> did you try with Google gsutil tool ?
>
> Anyway as it is a public resource that doesn't require any signing, you
> could
> just use
>
> /vsicurl/
> https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/
>
> NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/
> L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2
> <https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2>
>
> Even
>
> > Hi,
> >
> > When doing a few requests to the Sentinel 2 bucket of Google (
> > https://cloud.google.com/storage/docs/public-datasets/sentinel-2) we
> have
> > been getting 503 Responses when using the automatic authentication. See
> the
> > end of this email for the full output.
> >
> > This behavior goes away when using e.g. the
> > GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY authentication method.
> >
> > The Service account this machine is running with has "Full Access to All
> > Cloud APIs"
> >
> > Not sure if this is a gdal problem or actually a google internal issue
> > since accessing our own buckets works fine.
> >
> > Best,
> > Christoph
> >
> > Output:
> > export CPL_DEBUG=ON
> > gdalinfo
> >
> /vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N
> >
> 0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T11
> > 2511/IMG_DATA/T29TNE_20170719T112119_B01.jp2
> >
> > HTTP: Fetch(
> >
> http://metadata.google.internal/computeMetadata/v1/instance/service-accounts
> > /default/token )
> > HTTP: libcurl/7.65.3 OpenSSL/1.1.1c zlib/1.2.5 libssh2/1.8.2
> > HTTP: GDAL was built against curl 7.64.1, but is running against 7.65.3.
> > HTTP: These HTTP headers were set: Metadata-Flavor: Google
> > GOA2: Refresh Token Response:
> > {"access_token":"REMOVED IN
> EMAIL","expires_in":2877,"token_type":"Bearer"}
> > GOA2: Access Token : 'REMOVED IN EMAIL'
> > GS: Using GCE inherited permissions
> > GS: <html><head><meta http-equiv="content-type" content="text/html;
> > charset=utf-8"/><title>Sorry...</title><style> body { font-family:
> verdana,
> > arial, sans-serif; background-color: #fff; color: #000;
> > }</style></head><body><div><table><tr><td><b><font face=sans-serif
> > size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
> > color=#fbbc05>o</font><font color=#4285f4>g</font><font
> > color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
> > style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
> > width: 50%"><div style="border-bottom: 1px solid
> > #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
> > 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
> > sending automated queries. To protect our users, we can't process your
> > request right now.</p></div><div style="margin-left: 4em;">See <a href="
> > https://support.google.com/websearch/answer/86640">Google Help</a> for
> more
> > information.<br/><br/></div><div style="text-align: center; border-top:
> 1px
> > solid #dfdfdf;"><a href="https://www.google.com">Google
> > Home</a></div></body></html>
> > VSICURL: GetFileSize(
> >
> https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_
> >
> MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T2
> > 9TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2)=0
> > response_code=503
> > GS: <html><head><meta http-equiv="content-type" content="text/html;
> > charset=utf-8"/><title>Sorry...</title><style> body { font-family:
> verdana,
> > arial, sans-serif; background-color: #fff; color: #000;
> > }</style></head><body><div><table><tr><td><b><font face=sans-serif
> > size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
> > color=#fbbc05>o</font><font color=#4285f4>g</font><font
> > color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
> > style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
> > width: 50%"><div style="border-bottom: 1px solid
> > #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
> > 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
> > sending automated queries. To protect our users, we can't process your
> > request right now.</p></div><div style="margin-left: 4em;">See <a href="
> > https://support.google.com/websearch/answer/86640">Google Help</a> for
> more
> > information.<br/><br/></div><div style="text-align: center; border-top:
> 1px
> > solid #dfdfdf;"><a href="https://www.google.com">Google
> > Home</a></div></body></html>
> > ERROR 11: HTTP response code: 503
> > gdalinfo failed - unable to open
> >
> '/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_
> >
> N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T1
> > 12511/IMG_DATA/T29TNE_20170719T112119_B01.jp2'.
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
*Christoph Paulik* // Head of Infrastructure
VanderSat // Satellite observed water data. Globally. Daily.
Wilhelminastraat 43a, 2011 VK, Haarlem (NL), The Netherlands
<https://maps.google.com/?q=Wilhelminastraat+43a,+2011+VK,+Haarlem+(NL),+The+Netherlands&entry=gmail&source=g>
*M*  +31 6 18271928 *W*  www.vandersat.com

--------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/efb31994/attachment-0001.html>

From brandon.biggs at ski.org  Wed Oct 16 08:43:26 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 15:43:26 +0000
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <6605604.KP0pPkQKHn@even-i700>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <CAGybdFS2oqV58ABd_FE37257qBd=pKfpqbBFh_ak-ZXZb8f=Mw@mail.gmail.com>,
 <6605604.KP0pPkQKHn@even-i700>
Message-ID: <MWHPR1601MB1213193F6660877DE98AE925F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello Even,
It makes sense that the driver is proprietary, but the documentation page:
https://gdal.org/drivers/vector/dwg.html
AutoCAD DWG — GDAL documentation<https://gdal.org/drivers/vector/dwg.html>
DWG_INLINE_BLOCKS¶. The default behavior is for block references to be expanded with the geometry of the block they reference. However, if the DWG_INLINE_BLOCKS configuration option is set to the value FALSE, then the behavior is different as described here.
gdal.org
makes no mention of this fact.
Sadly, I am working with some clients who only use dwg, and I need the data in json, and autoCad doesn't use GDAL, so can't export to json.
The work-around I have found is to ask the client to export the file as dxf, but it has been extremely difficult to get them to give me dxf files, and I don't know if the dxf is trimming information.
I would rather pay for a driver to convert gdal files to json than pay for autoCad, especially since autoCad would only be used to convert files.

What is the process for including the gdal driver in the build? Is there a newbie tutorial on how to build gdal from source?
Thank you,



Brandon Biggs<https://www.ski.org/users/brandon-biggs>
Engineer

Smith-Kettlewell Eye Research Institute
Office: 415-345-2130
Cell: 650-833-9394

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, October 16, 2019 1:02 AM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Cc: Alan Snow <alansnow21 at gmail.com>; Brandon Biggs <brandon.biggs at ski.org>
Subject: Re: [gdal-dev] Adding The DWG Driver to ogr2ogr?

On mardi 15 octobre 2019 19:06:15 CEST Alan Snow wrote:
> Hi Brandon.
>
> I would recommend opening up an issue on the conda-forge feedstock:
> https://github.com/conda-forge/gdal-feedstock

Do you realize that the DWG driver requires a proprietary (& non-gratis) SDK ?

The alternative is the CAD driver (https://gdal.org/drivers/raster/cad.html)
but it probably doesn't support everything of the DWG one

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/167718f9/attachment.html>

From even.rouault at spatialys.com  Wed Oct 16 08:55:11 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Oct 2019 17:55:11 +0200
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <MWHPR1601MB1213193F6660877DE98AE925F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <6605604.KP0pPkQKHn@even-i700>
 <MWHPR1601MB1213193F6660877DE98AE925F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <2395408.Cp46OYL3Yy@even-i700>

On mercredi 16 octobre 2019 15:43:26 CEST Brandon Biggs wrote:
> Hello Even,
> It makes sense that the driver is proprietary, but the documentation page:
> https://gdal.org/drivers/vector/dwg.html
> makes no mention of this fact.

It does. This is the first sentence: "OGR supports reading most versions of 
AutoCAD DWG when built with the Open Design Alliance Teiga library."
Feel free to submit a PR to make it clearer (the doc of the DGNv8 driver
https://gdal.org/drivers/vector/dgnv8.html is perhaps a bit clearer)

> What is the process for including the gdal driver in the build? Is there a
> newbie tutorial on how to build gdal from source? Thank you,

The comment about building being ad-hoc is probably outdated. This is not so 
bad, at least on Linux

>From what I've available there:

For Linux
./configure --with-teigha=/path/to/Teigha_lnxX64_5.3dll

For Windows, you need to tweak with the TD_ variables in nmake.opt
The instructions seems a bit outdated. I believe I tried on Windows, but don't 
have that config available anymore.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From brandon.biggs at ski.org  Wed Oct 16 09:34:22 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 16:34:22 +0000
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <2395408.Cp46OYL3Yy@even-i700>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <6605604.KP0pPkQKHn@even-i700>
 <MWHPR1601MB1213193F6660877DE98AE925F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>,
 <2395408.Cp46OYL3Yy@even-i700>
Message-ID: <MWHPR1601MB12131202539D7704FC44E293F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,
When you say "built against the Open Design Alliance Teiga library", what does that mean? Do they have their own dll that needs to be included, or do they have their own set of tools that need to be used to build gdal from source?
Is there a tutorial on how to build gdal from source?
I found:
https://www.opendesign.com/guestfiles/oda_file_converter
ODA File Converter | Open Design Alliance<https://www.opendesign.com/guestfiles/oda_file_converter>
ODA File Converter. ODA File Converter application features a graphical interface and a command-line interface, and accepts the following inputs:
www.opendesign.com

Which converts from dwg to dxf, then gdal can convert dxf to whatever I need.
Thanks,


Brandon Biggs<https://www.ski.org/users/brandon-biggs>
Engineer

Smith-Kettlewell Eye Research Institute
Office: 415-345-2130
Cell: 650-833-9394

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, October 16, 2019 8:55 AM
To: Brandon Biggs <brandon.biggs at ski.org>
Cc: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>; Alan Snow <alansnow21 at gmail.com>
Subject: Re: [gdal-dev] Adding The DWG Driver to ogr2ogr?

On mercredi 16 octobre 2019 15:43:26 CEST Brandon Biggs wrote:
> Hello Even,
> It makes sense that the driver is proprietary, but the documentation page:
> https://gdal.org/drivers/vector/dwg.html
> makes no mention of this fact.

It does. This is the first sentence: "OGR supports reading most versions of
AutoCAD DWG when built with the Open Design Alliance Teiga library."
Feel free to submit a PR to make it clearer (the doc of the DGNv8 driver
https://gdal.org/drivers/vector/dgnv8.html is perhaps a bit clearer)

> What is the process for including the gdal driver in the build? Is there a
> newbie tutorial on how to build gdal from source? Thank you,

The comment about building being ad-hoc is probably outdated. This is not so
bad, at least on Linux

>From what I've available there:

For Linux
./configure --with-teigha=/path/to/Teigha_lnxX64_5.3dll

For Windows, you need to tweak with the TD_ variables in nmake.opt
The instructions seems a bit outdated. I believe I tried on Windows, but don't
have that config available anymore.

Even

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/5e8a9f29/attachment-0001.html>

From simon.eves at omnisci.com  Wed Oct 16 13:26:20 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Wed, 16 Oct 2019 13:26:20 -0700
Subject: [gdal-dev] 3.1 release?
Message-ID: <CAJf0KTToFZPMSMx6Gge2qSpKvABr_gsxX0Y7ZZ5v4N-ha4D3-w@mail.gmail.com>

Just wondering about the timescale of this, please?

We want to move to 3.x, but if 3.1 is imminent, we will wait for it.

-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/4d89e31c/attachment.html>

From brandon.biggs at ski.org  Wed Oct 16 14:29:41 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 21:29:41 +0000
Subject: [gdal-dev] Filtering Null Coordinates and rounding coordinates
	Using ogr2ogr?
Message-ID: <MWHPR1601MB121374485A2B1647E1D54495F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,

I have two questions with ogr2ogr:

How do I remove features that have a null geometry?

I tried:

-where "\"geometry\" != null"

But got the error:

ERROR 1: "geometry" not recognised as an available field.

ERROR 1: SetAttributeFilter("geometry" != null) on layer 'entities' failed.



Here is the output in geojson without this filter that I want to remove:

{ "type": "Feature", "properties": { "Layer": "Table et accessoire", "SubClasses": "AcDbEntity:AcDbBlockReference", "EntityHandle": "1972C" }, "geometry": null }

Note that during conversion, I get an error " Warning 1: Block Bloc truss 16X16X8 does not exist", so this may be that error, but I did have:

-skipfailures=true

Set, so I'm not sure why it would still be there if that is the error.



Second, my coordinates are in inches, and I would like them to be in meters. Is there some way where I can convert and maybe round the result to meters? I currently have:



{ "type": "Feature", "properties": { "Layer": "01_Grid-rigging", "SubClasses": "AcDbEntity:AcDbMText", "EntityHandle": "15F4", "Text": "1" }, "geometry": { "type": "Point", "coordinates": [ 4295.092091614642413, 4656.968211681276443, 0.0 ] } },



And would like:



{ "type": "Feature", "properties": { "Layer": "01_Grid-rigging", "SubClasses": "AcDbEntity:AcDbMText", "EntityHandle": "15F4", "Text": "1" }, "geometry": { "type": "Point", "coordinates": [ 109.1, 118.29, 0.0 ] } }



I'm wondering if -spat_srs or -a_srs would do this if I passed some kind of WKT definition?

I would like to divide coordinates by 39.37 and round to the 2nd decimal place.

Thank you,




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/38b2bcbc/attachment.html>

From even.rouault at spatialys.com  Wed Oct 16 14:45:10 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Oct 2019 23:45:10 +0200
Subject: [gdal-dev] 3.1 release?
In-Reply-To: <CAJf0KTToFZPMSMx6Gge2qSpKvABr_gsxX0Y7ZZ5v4N-ha4D3-w@mail.gmail.com>
References: <CAJf0KTToFZPMSMx6Gge2qSpKvABr_gsxX0Y7ZZ5v4N-ha4D3-w@mail.gmail.com>
Message-ID: <3197491.2F0SleeD9Y@even-i700>

On mercredi 16 octobre 2019 13:26:20 CEST Simon Eves wrote:
> Just wondering about the timescale of this, please?

probably May next year

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct 16 14:54:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 16 Oct 2019 23:54:17 +0200
Subject: [gdal-dev] Filtering Null Coordinates and rounding coordinates
	Using ogr2ogr?
In-Reply-To: <MWHPR1601MB121374485A2B1647E1D54495F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB121374485A2B1647E1D54495F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <1929436.HaRYU2BgRL@even-i700>

On mercredi 16 octobre 2019 21:29:41 CEST Brandon Biggs wrote:
> Hello,
> 
> I have two questions with ogr2ogr:
> 
> How do I remove features that have a null geometry?
> 
> I tried:
> 
> -where "\"geometry\" != null"

-where "OGR_GEOMETRY is not null"

--> https://gdal.org/user/ogr_sql_dialect.html#special-fields

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From simon.eves at omnisci.com  Wed Oct 16 15:10:55 2019
From: simon.eves at omnisci.com (Simon Eves)
Date: Wed, 16 Oct 2019 15:10:55 -0700
Subject: [gdal-dev] 3.1 release?
In-Reply-To: <3197491.2F0SleeD9Y@even-i700>
References: <CAJf0KTToFZPMSMx6Gge2qSpKvABr_gsxX0Y7ZZ5v4N-ha4D3-w@mail.gmail.com>
 <3197491.2F0SleeD9Y@even-i700>
Message-ID: <CAJf0KTQ=jH-6u=tkGAcCc-jceqRgnz1yWhTSOxT4AF9qi4qz2w@mail.gmail.com>

Oh, OK. Not sure where I got the idea it was imminent. We'll go with 3.0.1.
Thank you!

On Wed, Oct 16, 2019 at 2:45 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 16 octobre 2019 13:26:20 CEST Simon Eves wrote:
> > Just wondering about the timescale of this, please?
>
> probably May next year
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
<http://www.omnisci.com/>
Simon Eves
Senior Graphics Engineer, Rendering Group
100 Montgomery St (5th Floor), San Francisco, CA 94104, USA


Email: simon.eves at omnisci.com | Cell:  415.902.1996
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/7e827b43/attachment-0001.html>

From brandon.biggs at ski.org  Wed Oct 16 15:14:56 2019
From: brandon.biggs at ski.org (Brandon Biggs)
Date: Wed, 16 Oct 2019 22:14:56 +0000
Subject: [gdal-dev] Filtering Null Coordinates and rounding coordinates
 Using ogr2ogr?
In-Reply-To: <1929436.HaRYU2BgRL@even-i700>
References: <MWHPR1601MB121374485A2B1647E1D54495F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>,
 <1929436.HaRYU2BgRL@even-i700>
Message-ID: <MWHPR1601MB121387435EDC0B360A30AABCF3920@MWHPR1601MB1213.namprd16.prod.outlook.com>

Hello,
This doesn't seem to work. Thank you for the SQL link.
I am wondering if these warnings have anything to do with the null geometries?

Warning 1: Block Bloc truss 16X16X8 does not exist
Warning 1: Block Bloc TRUSS CUBE 16X16 does not exist

Does anyone know what may cause these errors and if they may be causing the empty geometries? Also, why would -skipfailures=true not skip these warnings?
Thank you,


Brandon Biggs<https://www.ski.org/users/brandon-biggs>
Engineer

Smith-Kettlewell Eye Research Institute
Office: 415-345-2130
Cell: 650-833-9394

________________________________
From: Even Rouault <even.rouault at spatialys.com>
Sent: Wednesday, October 16, 2019 2:54 PM
To: gdal-dev at lists.osgeo.org <gdal-dev at lists.osgeo.org>
Cc: Brandon Biggs <brandon.biggs at ski.org>
Subject: Re: [gdal-dev] Filtering Null Coordinates and rounding coordinates Using ogr2ogr?

On mercredi 16 octobre 2019 21:29:41 CEST Brandon Biggs wrote:
> Hello,
>
> I have two questions with ogr2ogr:
>
> How do I remove features that have a null geometry?
>
> I tried:
>
> -where "\"geometry\" != null"

-where "OGR_GEOMETRY is not null"

--> https://gdal.org/user/ogr_sql_dialect.html#special-fields

--
Spatialys - Geospatial professional services
http://www.spatialys.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191016/df83cf9b/attachment.html>

From paul.malm at lfv.se  Thu Oct 17 00:19:56 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Thu, 17 Oct 2019 07:19:56 +0000
Subject: [gdal-dev] ogr2ogr for windows
Message-ID: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>

Hi List!
I'm looking for ogr2ogr for Windows with "FileGDB" (R/W) and "aeronavFAA" included is there a place where I can download it?

I've tried:
C:\>pip install C\Downloads\GDAL-3.0.1-cp38-cp38-win_amd64.whl
And get this error message:
ERROR: GDAL-3.0.1-cp38-cp38-win_amd64.whl is not a supported wheel on this platform.
On the other hand, I don't know anything about Python. And I don't have Visual Studio.
Kind regards,
Paul
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191017/1e081868/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 17 02:37:37 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 17 Oct 2019 02:37:37 -0700 (MST)
Subject: [gdal-dev] Filtering Null Coordinates and rounding coordinates
 Using ogr2ogr?
In-Reply-To: <MWHPR1601MB121387435EDC0B360A30AABCF3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB121374485A2B1647E1D54495F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <1929436.HaRYU2BgRL@even-i700>
 <MWHPR1601MB121387435EDC0B360A30AABCF3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <1571305057580-0.post@n6.nabble.com>

Works for me. Here is my test data, copy and save as "empty.jml"

<?xml version='1.0' encoding='UTF-8'?>
<JCSDataFile xmlns:gml="http://www.opengis.net/gml"
xmlns:xsi="http://www.w3.org/2000/10/XMLSchema-instance" >
<JCSGMLInputTemplate>
<CollectionElement>featureCollection</CollectionElement>
<FeatureElement>feature</FeatureElement>
<GeometryElement>geometry</GeometryElement>
<CRSElement>boundedBy</CRSElement>
<ColumnDefinitions>
</ColumnDefinitions>
</JCSGMLInputTemplate>

<featureCollection>
  <gml:boundedBy>
    <gml:Box>
      <gml:coordinates decimal="." cs="," ts=" ">380.00,320.00
380.00,320.00</gml:coordinates>
    </gml:Box>
  </gml:boundedBy>
  <feature>
    <geometry>
      <gml:Point>
        <gml:coordinates>
          380.0,320.0 
        </gml:coordinates>
      </gml:Point>
    </geometry>
  </feature>
  <feature>
    <geometry>
      <gml:Point>
      </gml:Point>
    </geometry>
  </feature>
</featureCollection>
</JCSDataFile>

The commands to run

List all geometries, including empty ones:
ogrinfo empty.jml -al

Filter out empty geometries with OGR SQL dialect:
ogrinfo -where "OGR_GEOMETRY is not null" empty.jml -al

Filter out empty geometries with SQLite SQL dialect:
ogrinfo -dialect SQLite -sql "select * from empty where geometry is not
null" empty.jml

Filter out empty geometries and scale coordinates with SQLite SQL dialect:
ogrinfo -dialect SQLite -sql "select ScaleCoordinates(geometry,0.0254) from
empty where geometry is not null" empty.jml

Changing the decimal precision does not seem be simple with SpatiaLite so
you must do it with org2ogr. Use -dsco COORDINATE_PRECISION=2 as documented
in https://gdal.org/drivers/vector/geojson.html.

ogr2ogr -f geojson -dialect SQLite -sql "select
ScaleCoordinates(geometry,0.0254) from empty where geometry is not null"
round.json -lco coordinate_precision=2 empty.jml

Did I pass the test?

Recommended reading
http://www.gaia-gis.it/gaia-sins/spatialite-sql-latest.html

-Jukka Rahkonen-







Brandon Biggs wrote
> Hello,
> This doesn't seem to work. Thank you for the SQL link.
> I am wondering if these warnings have anything to do with the null
> geometries?





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From stephenknox73 at gmail.com  Thu Oct 17 06:07:54 2019
From: stephenknox73 at gmail.com (Stephen Knox)
Date: Thu, 17 Oct 2019 14:07:54 +0100
Subject: [gdal-dev] ogr2ogr for windows
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>
Message-ID: <CAFkojsZJQvn3FkX5k63D9pquGaGHcov1mV633zSNUeUVVW=A5g@mail.gmail.com>

You probably need to install osgeo4w (https://trac.osgeo.org/osgeo4w/)

On Thu, Oct 17, 2019 at 8:30 AM <paul.malm at lfv.se> wrote:

> Hi List!
>
> I’m looking for ogr2ogr for Windows with "FileGDB" (R/W) and “aeronavFAA“
> included is there a place where I can download it?
>
>
>
> I’ve tried:
>
> C:\>pip install C\Downloads\GDAL-3.0.1-cp38-cp38-win_amd64.whl
>
> And get this error message:
>
> ERROR: GDAL-3.0.1-cp38-cp38-win_amd64.whl is not a supported wheel on this
> platform.
>
> On the other hand, I don’t know anything about Python. And I don’t have
> Visual Studio.
>
> Kind regards,
>
> Paul
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191017/38c8a60d/attachment.html>

From stephenknox73 at gmail.com  Thu Oct 17 06:11:45 2019
From: stephenknox73 at gmail.com (Stephen Knox)
Date: Thu, 17 Oct 2019 14:11:45 +0100
Subject: [gdal-dev] GIS Stack Exchange questions - delete geopackage layer
Message-ID: <CAFkojsY1EL=DrxDA8dTdoD_vL1scDwh-bE6yAnukqfnoG-E__A@mail.gmail.com>

I've got a couple of questions here - I know this is not an official
support channel, but wondered if anyone could take a look, particularly at
the first one, which I will reproduce here. Thanks in advance.

https://gis.stackexchange.com/questions/339011/gdal-delete-geopackage-layer

This seems like it ought to be straightforward:

from osgeo import gdal
gpkg =
gdal.OpenEx('path_to_gpk',gdal.OF_VERBOSE_ERROR,allowed_drivers=['GPKG'])
error = gpkg.DeleteLayer(0)
After running this error is always a OGRERR_FAILURE. The geopackage has
been created by QGIS so I would have thought should be standard.

Can't see any way to debug further into the GDAL calls apart from a GDB
session, which I might try later.

-----------------------------------------------------------
https://gis.stackexchange.com/questions/338190/specify-open-options-in-datasource
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191017/4f314ea7/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 17 06:24:53 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 17 Oct 2019 06:24:53 -0700 (MST)
Subject: [gdal-dev] GIS Stack Exchange questions - delete geopackage
 layer
In-Reply-To: <CAFkojsY1EL=DrxDA8dTdoD_vL1scDwh-bE6yAnukqfnoG-E__A@mail.gmail.com>
References: <CAFkojsY1EL=DrxDA8dTdoD_vL1scDwh-bE6yAnukqfnoG-E__A@mail.gmail.com>
Message-ID: <1571318693994-0.post@n6.nabble.com>

Hi,

Actually this is the official GDAL support channel so no need to be sorry.

While I am sure that DeleteLayer works when used correctly there is also
another option to execute SQL “DROP TABLE layer_name” as documented in
https://gdal.org/drivers/vector/gpkg.html.

-Jukka Rahkonen-



Stephen Knox wrote
> I've got a couple of questions here - I know this is not an official
> support channel, but wondered if anyone could take a look, particularly at
> the first one, which I will reproduce here. Thanks in advance.
> 
> https://gis.stackexchange.com/questions/339011/gdal-delete-geopackage-layer
> 
> This seems like it ought to be straightforward:
> 
> from osgeo import gdal
> gpkg =
> gdal.OpenEx('path_to_gpk',gdal.OF_VERBOSE_ERROR,allowed_drivers=['GPKG'])
> error = gpkg.DeleteLayer(0)
> After running this error is always a OGRERR_FAILURE. The geopackage has
> been created by QGIS so I would have thought should be standard.
> 
> Can't see any way to debug further into the GDAL calls apart from a GDB
> session, which I might try later.
> 
> -----------------------------------------------------------
> https://gis.stackexchange.com/questions/338190/specify-open-options-in-datasource
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From battisti at actgate.com  Thu Oct 17 07:18:32 2019
From: battisti at actgate.com (Andrea Battisti)
Date: Thu, 17 Oct 2019 16:18:32 +0200
Subject: [gdal-dev]  problem with interpolation on GDAL RasterIO ?
In-Reply-To: <4d2193a6-929a-f6fc-c3f4-97b94d9420f8@actgate.com>
References: <4d2193a6-929a-f6fc-c3f4-97b94d9420f8@actgate.com>
Message-ID: <6b5bed1b-e43f-78d0-fde2-a85cf0ca01df@actgate.com>



Il 09/10/19 15:10, Andrea Battisti ha scritto:
> Hi all,
> 
> 
> I think I found a glitch in how bilinear interpolation is applied when 
> reading a sub block of a dataset.


Hi,

I was able to nail down the issue described in my previous message.

Looks like it is happening here:
https://github.com/OSGeo/gdal/blob/master/gdal/gcore/rasterio.cpp#L1228

If my understanding is correct, when the data type of the output buffer 
and the type of the input differ (eg Float64 vs Float32), that 
GDALCopyWords call writes to the wrong buffer (pData, instead of 
pTempBuffer).
That gets overwritten by random stuff when the pData buffer is then 
filled from the temporary MEM dataset at line 1289.

The problem is not visible if the type of input/output buffer are the 
same, as in that case pData is used anyway as output.


Given that, I tried to re-purpose that GDALCopyWords call as:

	GDALCopyWords(
		&fNoDataValue, GDT_Float32, 0,
		static_cast<GByte*>(pDataMem) +
		nLSMem * (j + nDstYOff) +
                 nDstXOff * nPSMem,
                 eDTMem, static_cast<int>(nPSMem),
                 nDstXCount);

in order to make it use the right buffer even when the input/output data 
types differ.

That fixes my use case and I think it makes sense in general, but I 
would really appreciate a quick review on this as there might be other 
places to update as well.

I have created an issue here:
https://github.com/OSGeo/gdal/issues/1941

What is the best way to go forward with this?


Thanks,
-- 
Andrea Battisti
Computer Science Engineer

From paul.malm at lfv.se  Fri Oct 18 01:06:05 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Fri, 18 Oct 2019 08:06:05 +0000
Subject: [gdal-dev] ogr2ogr for windows
In-Reply-To: <CAFkojsZJQvn3FkX5k63D9pquGaGHcov1mV633zSNUeUVVW=A5g@mail.gmail.com>
References: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>
 <CAFkojsZJQvn3FkX5k63D9pquGaGHcov1mV633zSNUeUVVW=A5g@mail.gmail.com>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE4E1BB@xw-exch03.lfv.se>

Thanks,
I tried that but nothing happens when I execute the installation file. I don’t get any connection And a empty list appears where I can add new URLs?
Kind regards,
Paul

Från: Stephen Knox [mailto:stephenknox73 at gmail.com]
Skickat: den 17 oktober 2019 15:08
Till: Malm, Paul (Operations AIM)
Kopia: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr for windows

You probably need to install osgeo4w (https://trac.osgeo.org/osgeo4w/)

On Thu, Oct 17, 2019 at 8:30 AM <paul.malm at lfv.se<mailto:paul.malm at lfv.se>> wrote:
Hi List!
I’m looking for ogr2ogr for Windows with "FileGDB" (R/W) and “aeronavFAA“ included is there a place where I can download it?

I’ve tried:
C:\>pip install C\Downloads\GDAL-3.0.1-cp38-cp38-win_amd64.whl
And get this error message:
ERROR: GDAL-3.0.1-cp38-cp38-win_amd64.whl is not a supported wheel on this platform.
On the other hand, I don’t know anything about Python. And I don’t have Visual Studio.
Kind regards,
Paul
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191018/b08aaf27/attachment.html>

From cpaulik at vandersat.com  Fri Oct 18 01:22:25 2019
From: cpaulik at vandersat.com (Christoph Paulik)
Date: Fri, 18 Oct 2019 10:22:25 +0200
Subject: [gdal-dev] 503 Errors when accessing Public Datasets on Google
 Cloud Storage with automatic auth
In-Reply-To: <CAHtCBngg==sjXeq3rwTdE5TX9_cAqrvDDxmz=KQo0hTLXKJdhw@mail.gmail.com>
References: <CAHtCBnhf2fUNTYqWp1WAVMfCFsOgRT9pe2F7x5SyqyOBAf0Pcg@mail.gmail.com>
 <1845885.oxxl9COrMj@even-i700>
 <CAHtCBngg==sjXeq3rwTdE5TX9_cAqrvDDxmz=KQo0hTLXKJdhw@mail.gmail.com>
Message-ID: <CAHtCBng1dZgP=za1T5e8dhjnKg1pg-qXxp=oMm8LRS31ZwWSdQ@mail.gmail.com>

Hi,

I'm in contact with google about the problem. It might be a problem on
their side.

But during testing I discovered something else which I found unusual.
Maybe I understand the meaning of the GDAL_DISABLE_READDIR_ON_OPEN variable
incorrectly but I still wanted to double check.

Using:

#!/bin/bash
export GS_ACCESS_KEY_ID=<OUR_KEY>
export GS_SECRET_ACCESS_KEY=<OUR_KEY>
export GDAL_DISABLE_READDIR_ON_OPEN=TRUE
export CPL_DEBUG=ON

gdalinfo
/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2

Tries to open tons of files like e.g.
https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/HDR_20170719T112119_B01.txt

The other to settings FALSE and EMPTY_DIR still try to open some auxiliary
files. But not as many.

In this case it seems that setting GDAL_DISABLE_READDIR_ON_OPEN=TRUE is by
far the slowest option.
Is this expected?

Thanks,
Christoph




On Wed, 16 Oct 2019 at 17:38, Christoph Paulik <cpaulik at vandersat.com>
wrote:

> Hi,
>
> The thing is that one request works fine in any case.
> But google seems to rate limit on the public bucket in the following cases:
>
> - no authentication (/vsicurl/ driver)
> - authentication with automatic detection by gdal that it is running on a
> GCE VM.
>
> but not when using the explicit authentication with
> GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY
>
> Christoph
>
>
> On Wed, 16 Oct 2019 at 17:31, Even Rouault <even.rouault at spatialys.com>
> wrote:
>
>> Hi,
>>
>> did you try with Google gsutil tool ?
>>
>> Anyway as it is a public resource that doesn't require any signing, you
>> could
>> just use
>>
>> /vsicurl/
>> https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/
>>
>> NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/
>> L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2
>> <https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2>
>>
>> Even
>>
>> > Hi,
>> >
>> > When doing a few requests to the Sentinel 2 bucket of Google (
>> > https://cloud.google.com/storage/docs/public-datasets/sentinel-2) we
>> have
>> > been getting 503 Responses when using the automatic authentication. See
>> the
>> > end of this email for the full output.
>> >
>> > This behavior goes away when using e.g. the
>> > GS_ACCESS_KEY_ID/GS_SECRET_ACCESS_KEY authentication method.
>> >
>> > The Service account this machine is running with has "Full Access to All
>> > Cloud APIs"
>> >
>> > Not sure if this is a gdal problem or actually a google internal issue
>> > since accessing our own buckets works fine.
>> >
>> > Best,
>> > Christoph
>> >
>> > Output:
>> > export CPL_DEBUG=ON
>> > gdalinfo
>> >
>> /vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_N
>> >
>> 0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T11
>> > 2511/IMG_DATA/T29TNE_20170719T112119_B01.jp2
>> >
>> > HTTP: Fetch(
>> >
>> http://metadata.google.internal/computeMetadata/v1/instance/service-accounts
>> > /default/token )
>> > HTTP: libcurl/7.65.3 OpenSSL/1.1.1c zlib/1.2.5 libssh2/1.8.2
>> > HTTP: GDAL was built against curl 7.64.1, but is running against 7.65.3.
>> > HTTP: These HTTP headers were set: Metadata-Flavor: Google
>> > GOA2: Refresh Token Response:
>> > {"access_token":"REMOVED IN
>> EMAIL","expires_in":2877,"token_type":"Bearer"}
>> > GOA2: Access Token : 'REMOVED IN EMAIL'
>> > GS: Using GCE inherited permissions
>> > GS: <html><head><meta http-equiv="content-type" content="text/html;
>> > charset=utf-8"/><title>Sorry...</title><style> body { font-family:
>> verdana,
>> > arial, sans-serif; background-color: #fff; color: #000;
>> > }</style></head><body><div><table><tr><td><b><font face=sans-serif
>> > size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
>> > color=#fbbc05>o</font><font color=#4285f4>g</font><font
>> > color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
>> > style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
>> > width: 50%"><div style="border-bottom: 1px solid
>> > #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
>> > 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
>> > sending automated queries. To protect our users, we can't process your
>> > request right now.</p></div><div style="margin-left: 4em;">See <a href="
>> > https://support.google.com/websearch/answer/86640">Google Help</a> for
>> more
>> > information.<br/><br/></div><div style="text-align: center; border-top:
>> 1px
>> > solid #dfdfdf;"><a href="https://www.google.com">Google
>> > Home</a></div></body></html>
>> > VSICURL: GetFileSize(
>> >
>> https://storage.googleapis.com/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_
>> >
>> MSIL1C_20170719T112119_N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T2
>> > 9TNE_A001922_20170719T112511/IMG_DATA/T29TNE_20170719T112119_B01.jp2)=0
>> > response_code=503
>> > GS: <html><head><meta http-equiv="content-type" content="text/html;
>> > charset=utf-8"/><title>Sorry...</title><style> body { font-family:
>> verdana,
>> > arial, sans-serif; background-color: #fff; color: #000;
>> > }</style></head><body><div><table><tr><td><b><font face=sans-serif
>> > size=10><font color=#4285f4>G</font><font color=#ea4335>o</font><font
>> > color=#fbbc05>o</font><font color=#4285f4>g</font><font
>> > color=#34a853>l</font><font color=#ea4335>e</font></font></b></td><td
>> > style="text-align: left; vertical-align: bottom; padding-bottom: 15px;
>> > width: 50%"><div style="border-bottom: 1px solid
>> > #dfdfdf;">Sorry...</div></td></tr></table></div><div style="margin-left:
>> > 4em;"><h1>We're sorry...</h1><p>... but your computer or network may be
>> > sending automated queries. To protect our users, we can't process your
>> > request right now.</p></div><div style="margin-left: 4em;">See <a href="
>> > https://support.google.com/websearch/answer/86640">Google Help</a> for
>> more
>> > information.<br/><br/></div><div style="text-align: center; border-top:
>> 1px
>> > solid #dfdfdf;"><a href="https://www.google.com">Google
>> > Home</a></div></body></html>
>> > ERROR 11: HTTP response code: 503
>> > gdalinfo failed - unable to open
>> >
>> '/vsigs/gcp-public-data-sentinel-2/tiles/29/T/NE/S2B_MSIL1C_20170719T112119_
>> >
>> N0205_R037_T29TNE_20170719T112511.SAFE/GRANULE/L1C_T29TNE_A001922_20170719T1
>> > 12511/IMG_DATA/T29TNE_20170719T112119_B01.jp2'.
>>
>>
>> --
>> Spatialys - Geospatial professional services
>> http://www.spatialys.com
>>
>
>
> --
> *Christoph Paulik* // Head of Infrastructure
> VanderSat // Satellite observed water data. Globally. Daily.
> Wilhelminastraat 43a, 2011 VK, Haarlem (NL), The Netherlands
> <https://maps.google.com/?q=Wilhelminastraat+43a,+2011+VK,+Haarlem+(NL),+The+Netherlands&entry=gmail&source=g>
> *M*  +31 6 18271928 *W*  www.vandersat.com
>
>
> --------------------------------------------------------------------------------------
>


-- 
*Christoph Paulik* // Head of Infrastructure
VanderSat // Satellite observed water data. Globally. Daily.
Wilhelminastraat 43a, 2011 VK, Haarlem (NL), The Netherlands
<https://maps.google.com/?q=Wilhelminastraat+43a,+2011+VK,+Haarlem+(NL),+The+Netherlands&entry=gmail&source=g>
*M*  +31 6 18271928 *W*  www.vandersat.com

--------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191018/e8eff342/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 18 03:49:36 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Fri, 18 Oct 2019 03:49:36 -0700 (MST)
Subject: [gdal-dev] ogr2ogr for windows
In-Reply-To: <785199B14156764C8EB14EF96CEDC44EE4E1BB@xw-exch03.lfv.se>
References: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>
 <CAFkojsZJQvn3FkX5k63D9pquGaGHcov1mV633zSNUeUVVW=A5g@mail.gmail.com>
 <785199B14156764C8EB14EF96CEDC44EE4E1BB@xw-exch03.lfv.se>
Message-ID: <1571395776901-0.post@n6.nabble.com>

Hi,

You may be behind a proxy server and you must use the Advanced Install
altertative which shows you a box to feed the proxy url. However, you can't
install driver https://gdal.org/drivers/vector/filegdb.html with OSGeo4W.
Perhaps it is due to license requirements because that driver requires File
GDB API SDK from ESRI
http://appsforms.esri.com/products/download/#File_Geodatabase_API_1.3.

The other driver that you wished comes with the OSGeo4W and also with the
binaries from gisinternals.com

ogrinfo --formats |find "FAA"
  AeronavFAA -vector- (rov): Aeronav FAA

It may be that you need to hire somebody to make you a special Windows build
with the ESRI fgdb. I have managed to do that through this mailing list
sometimes and at reasonable price.


-Jukka Rahkonen-


paul.malm wrote
> Thanks,
> I tried that but nothing happens when I execute the installation file. I
> don’t get any connection And a empty list appears where I can add new
> URLs?
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From stephenknox73 at gmail.com  Fri Oct 18 04:46:41 2019
From: stephenknox73 at gmail.com (Stephen Knox)
Date: Fri, 18 Oct 2019 12:46:41 +0100
Subject: [gdal-dev] ogr2ogr for windows
In-Reply-To: <1571395776901-0.post@n6.nabble.com>
References: <785199B14156764C8EB14EF96CEDC44EE4DA63@xw-exch03.lfv.se>
 <CAFkojsZJQvn3FkX5k63D9pquGaGHcov1mV633zSNUeUVVW=A5g@mail.gmail.com>
 <785199B14156764C8EB14EF96CEDC44EE4E1BB@xw-exch03.lfv.se>
 <1571395776901-0.post@n6.nabble.com>
Message-ID: <CAFkojsZ_YwHPkJcZBj17H4CVK_ymid1-GjFVe=dtiAN1HnzJKw@mail.gmail.com>

I think you can install the ESRI FileGDB from OSGeo4W:

http://download.osgeo.org/osgeo4w/x86/versions.html - see gdal-filegdb

On Fri, Oct 18, 2019 at 11:49 AM jratike80 <
jukka.rahkonen at maanmittauslaitos.fi> wrote:

> Hi,
>
> You may be behind a proxy server and you must use the Advanced Install
> altertative which shows you a box to feed the proxy url. However, you can't
> install driver https://gdal.org/drivers/vector/filegdb.html with OSGeo4W.
> Perhaps it is due to license requirements because that driver requires File
> GDB API SDK from ESRI
> http://appsforms.esri.com/products/download/#File_Geodatabase_API_1.3.
>
> The other driver that you wished comes with the OSGeo4W and also with the
> binaries from gisinternals.com
>
> ogrinfo --formats |find "FAA"
>   AeronavFAA -vector- (rov): Aeronav FAA
>
> It may be that you need to hire somebody to make you a special Windows
> build
> with the ESRI fgdb. I have managed to do that through this mailing list
> sometimes and at reasonable price.
>
>
> -Jukka Rahkonen-
>
>
> paul.malm wrote
> > Thanks,
> > I tried that but nothing happens when I execute the installation file. I
> > don’t get any connection And a empty list appears where I can add new
> > URLs?
> > Kind regards,
> > Paul
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191018/6a4b2e13/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 18 05:02:40 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 18 Oct 2019 12:02:40 +0000
Subject: [gdal-dev] ogr2ogr for windows
Message-ID: <53f4861b10d342beb2d8a2061d37c524@C119S212VM042.msvyvi.vaha.local>

Thanks Stephen,

You are right, it is available in OSGeo4W and installs nicely

  ogrinfo --formats |find "GDB"
  FileGDB -vector- (rw+): ESRI FileGDB
  OpenFileGDB -vector- (rov): ESRI FileGDB

-Jukka-

Lähettäjä: Stephen Knox <stephenknox73 at gmail.com>
Lähetetty: perjantai 18. lokakuuta 2019 14.47
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] ogr2ogr for windows

I think you can install the ESRI FileGDB from OSGeo4W:

http://download.osgeo.org/osgeo4w/x86/versions.html - see gdal-filegdb

On Fri, Oct 18, 2019 at 11:49 AM jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
Hi,

You may be behind a proxy server and you must use the Advanced Install
altertative which shows you a box to feed the proxy url. However, you can't
install driver https://gdal.org/drivers/vector/filegdb.html with OSGeo4W.
Perhaps it is due to license requirements because that driver requires File
GDB API SDK from ESRI
http://appsforms.esri.com/products/download/#File_Geodatabase_API_1.3.

The other driver that you wished comes with the OSGeo4W and also with the
binaries from gisinternals.com<http://gisinternals.com>

ogrinfo --formats |find "FAA"
  AeronavFAA -vector- (rov): Aeronav FAA

It may be that you need to hire somebody to make you a special Windows build
with the ESRI fgdb. I have managed to do that through this mailing list
sometimes and at reasonable price.


-Jukka Rahkonen-


paul.malm wrote
> Thanks,
> I tried that but nothing happens when I execute the installation file. I
> don’t get any connection And a empty list appears where I can add new
> URLs?
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191018/ef2cd76d/attachment.html>

From even.rouault at spatialys.com  Sat Oct 19 11:04:56 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sat, 19 Oct 2019 20:04:56 +0200
Subject: [gdal-dev] Schedule for next bugfix release
Message-ID: <3159508.i6lGq9tlEk@even-i700>

Hi,

I'll probably cut a GDAL 3.0.2RC1 on the 28th this month. Not sure if I'll do 
a 2.4.3 for this round or defer that for a next time (are there people still 
needing those 2.4.x releases?)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sebastic at xs4all.nl  Sat Oct 19 11:20:32 2019
From: sebastic at xs4all.nl (Sebastiaan Couwenberg)
Date: Sat, 19 Oct 2019 20:20:32 +0200
Subject: [gdal-dev] Schedule for next bugfix release
In-Reply-To: <3159508.i6lGq9tlEk@even-i700>
References: <3159508.i6lGq9tlEk@even-i700>
Message-ID: <59118277-d7f9-f37a-72c0-708bf898b523@xs4all.nl>

On 10/19/19 8:04 PM, Even Rouault wrote:
> Not sure if I'll do 
> a 2.4.3 for this round or defer that for a next time (are there people still 
> needing those 2.4.x releases?)

Yes, please.

It's good to make the fix for CVE-2019-17545 more widely available to
those unable to upgrade to 3.x yet.

Kind Regards,

Bas

-- 
 GPG Key ID: 4096R/6750F10AE88D4AF1
Fingerprint: 8182 DE41 7056 408D 6146  50D1 6750 F10A E88D 4AF1

From caboe at sdfe.dk  Sun Oct 20 09:45:38 2019
From: caboe at sdfe.dk (=?iso-8859-1?Q?Casper_B=F8rgesen?=)
Date: Sun, 20 Oct 2019 16:45:38 +0000
Subject: [gdal-dev] How to use GDAL from Nuget in C#?
Message-ID: <8b5b435d3ade43ac9bb39bd26cf82f32@sdfe.dk>

Hi!

I have created a C# WPF (.NET Framework 4.6.1) application in Visual Studio 2017 and installed latest stable GDAL 2.4.2 from Nuget.

In the App.xaml I have added the GDAL configuration call:

protected override void OnStartup(StartupEventArgs e)
{
    base.OnStartup(e);

    GdalConfiguration.ConfigureGdal();
}

When I build the application I get the following error:

"error CS0103: The name 'GdalConfiguration' does not exist in the current context"

I can find the GdalConfiguration.cs file in the subfolder "obj\Debug\NuGet\15f0ca2b5ecbe407152208e918cf2c4389b630a2\GDAL\2.4.2" and pressing F12 on "GdalConfiguration.ConfigureGdal()" opens up that specific file.

Do I have to do anything else to be able to use GDAL in my application? And whats the difference between GDAL and GDAL.Native available from Nuget?

Regards, Casper
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191020/d653bfdd/attachment.html>

From jmckenna at gatewaygeomatics.com  Sun Oct 20 10:30:58 2019
From: jmckenna at gatewaygeomatics.com (Jeff McKenna)
Date: Sun, 20 Oct 2019 14:30:58 -0300
Subject: [gdal-dev] Documenting build requirements (e.g. ODBC)
In-Reply-To: <1660509.EYkVnefIB9@even-i700>
References: <CABUeae8QErHhABrvZQFQ8MsSVK9_aJ0BWVYRReAXZ8Q+=v8s0w@mail.gmail.com>
 <1660509.EYkVnefIB9@even-i700>
Message-ID: <ee6b53ea-d890-177e-b4ab-917ff6b4abd4@gatewaygeomatics.com>

> On lundi 30 septembre 2019 11:21:16 CEST Mateusz Loskot wrote:
>> Hi,
>>
>> I'm a bit lost where build requirements are supposed
>> to be documented now. They used to be described
>> on the Wiki, e.g. https://trac.osgeo.org/gdal/wiki/BuildingOnUnix
>> or driver-specific ones https://trac.osgeo.org/gdal/wiki/ECW
> 

(late response, sorry)

The wiki worked really well for that, and over the years we compiled 
quite a list of build steps for drivers and platforms 
(https://trac.osgeo.org/gdal/wiki/BuildHints).  I'd suggest we continue 
to use the wiki method (meaning now we transition to the Github wiki), 
so we don't have any funnels where someone needs to approve or 
disapprove of a change to the official website or repository.

The argument sometimes used against a wiki is that it is not managed, 
but this is exactly why the Buildhints wiki was allowed to thrive.

There of course will still be one hurdle, requiring to have a Github 
account, but besides that the wiki should thrive there for years to come.

-jeff


From mateusz at loskot.net  Sun Oct 20 13:27:18 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Sun, 20 Oct 2019 22:27:18 +0200
Subject: [gdal-dev] Documenting build requirements (e.g. ODBC)
In-Reply-To: <ee6b53ea-d890-177e-b4ab-917ff6b4abd4@gatewaygeomatics.com>
References: <CABUeae8QErHhABrvZQFQ8MsSVK9_aJ0BWVYRReAXZ8Q+=v8s0w@mail.gmail.com>
 <1660509.EYkVnefIB9@even-i700>
 <ee6b53ea-d890-177e-b4ab-917ff6b4abd4@gatewaygeomatics.com>
Message-ID: <CABUeae-DPOmX+2RU7+PFoO+HTx=7aou7FHXLbUw0q=BiYGpMQQ@mail.gmail.com>

On Sun, 20 Oct 2019 at 19:31, Jeff McKenna
<jmckenna at gatewaygeomatics.com> wrote:
> > On lundi 30 septembre 2019 11:21:16 CEST Mateusz Loskot wrote:
> >>
> >> I'm a bit lost where build requirements are supposed
> >> to be documented now. They used to be described
> >> on the Wiki, e.g. https://trac.osgeo.org/gdal/wiki/BuildingOnUnix
> >> or driver-specific ones https://trac.osgeo.org/gdal/wiki/ECW
> >
>
> The wiki worked really well for that, and over the years we compiled
> quite a list of build steps for drivers and platforms
> (https://trac.osgeo.org/gdal/wiki/BuildHints).  I'd suggest we continue
> to use the wiki method (meaning now we transition to the Github wiki),
> so we don't have any funnels where someone needs to approve or
> disapprove of a change to the official website or repository.

I don't have anything against the wiki but a wiki is supposed to be
complementary to existing docs.

Even suggested to recover the "Compiled by default" column
from the table in the old docs. On reflection, I don't think that
will solve problem I'm calling in this thread - what are the build
requirements of GDAL and features in GDAL.

IMO, there should be

https://gdal.org/building/
https://gdal.org/building/requirements
https://gdal.org/building/unix
https://gdal.org/building/windows

where https://gdal.org/building/requirements  lists common dependencies
similarly to https://pdal.io/development/compilation/dependencies.html

e.g. it lists ODBC and describes briefly that it is required by drivers A, B, C,
that on Unix one can use unixODBC or iODBC; that on Windows it comes
with native Windows SDK.
Similarly for libcurl, proj, and any other general purpose dependency of GDAL.

> The argument sometimes used against a wiki is that it is not managed,
> but this is exactly why the Buildhints wiki was allowed to thrive.

Official build procedure with requirements listed is  one thing.
Build hints, workarounds and troubleshooting is a different thing.
IMO, the former should be reviewed, curated and up to date
while the latter is a perfect fit for community-written wiki
that can rot...

> There of course will still be one hurdle, requiring to have a Github
> account, but besides that the wiki should thrive there for years to come.

Similar hurdle (requirement of an account) applies to OSGeo infrastructure.

Best regards,
--
Mateusz Loskot, http://mateusz.loskot.net

From robert.coup at koordinates.com  Mon Oct 21 00:57:41 2019
From: robert.coup at koordinates.com (Robert Coup)
Date: Mon, 21 Oct 2019 08:57:41 +0100
Subject: [gdal-dev] Adding The DWG Driver to ogr2ogr?
In-Reply-To: <MWHPR1601MB12131202539D7704FC44E293F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
References: <MWHPR1601MB1213E4F8956703B0A3B5049CF3930@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <6605604.KP0pPkQKHn@even-i700>
 <MWHPR1601MB1213193F6660877DE98AE925F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
 <2395408.Cp46OYL3Yy@even-i700>
 <MWHPR1601MB12131202539D7704FC44E293F3920@MWHPR1601MB1213.namprd16.prod.outlook.com>
Message-ID: <CAFLLRpJmcS=fz7JFN1FZ-HTWC49-=9_=yDeRL_cinqt-NFR5sA@mail.gmail.com>

HI Brandon,

On Wed, 16 Oct 2019 at 17:34, Brandon Biggs <brandon.biggs at ski.org> wrote:

> When you say "built against the Open Design Alliance Teiga library", what
> does that mean? Do they have their own dll that needs to be included, or do
> they have their own set of tools that need to be used to build gdal from
> source?
>

The ODA Teigha library is distributed as a mix of source and pre-compiled
binary components. When you build GDAL with the --with-teigha= flag, it'll
find the parts it needs. Note that you need the components for the
compiler/platform/architecture you are using (eg. gcc4.8 + linux + x64),
which constrains your choices somewhat to those they distribute.

My impression is there aren't that many users of the Teigha+GDAL
integration, so there may be some build configuration changes required to
match newer Teigha releases (eg. the last relevant changes on the GDAL side
were in 2017).


> Is there a tutorial on how to build gdal from source?
>

Start here: https://trac.osgeo.org/gdal/wiki/BuildHints


> I found:
> https://www.opendesign.com/guestfiles/oda_file_converter
> Which converts from dwg to dxf, then gdal can convert dxf to whatever I
> need.
>

You can certainly try it, and if it works for you that might be easier.
Though there may be some differences — DWG has a lot of complexities.

Cheers,

Rob :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191021/c9759311/attachment.html>

From battisti at actgate.com  Mon Oct 21 06:25:08 2019
From: battisti at actgate.com (Andrea Battisti)
Date: Mon, 21 Oct 2019 15:25:08 +0200
Subject: [gdal-dev] Schedule for next bugfix release
In-Reply-To: <59118277-d7f9-f37a-72c0-708bf898b523@xs4all.nl>
References: <3159508.i6lGq9tlEk@even-i700>
 <59118277-d7f9-f37a-72c0-708bf898b523@xs4all.nl>
Message-ID: <81677a63-65e2-78c1-2206-086464413301@actgate.com>



Il 19/10/19 20:20, Sebastiaan Couwenberg ha scritto:
> On 10/19/19 8:04 PM, Even Rouault wrote:
>> Not sure if I'll do
>> a 2.4.3 for this round or defer that for a next time (are there people still
>> needing those 2.4.x releases?)
> 
> Yes, please.


I would certainly appreciate a 2.4.x release as well!

Andrea

From felix.horvat at ocell.aero  Mon Oct 21 07:28:15 2019
From: felix.horvat at ocell.aero (FelixH)
Date: Mon, 21 Oct 2019 07:28:15 -0700 (MST)
Subject: [gdal-dev] gdaladdo taking very long time to build overviews
 for large extent mosaic.
In-Reply-To: <308304781.jEyKFYfJS9@even-i700>
References: <CAL9U1WuT8X-U8FWievL_xkG2atMUa6eAgtppOncsumO1jBbBvg@mail.gmail.com>
 <308304781.jEyKFYfJS9@even-i700>
Message-ID: <1571668095204-0.post@n6.nabble.com>

Are there any plans to fix the context switching issues with libtiff? This
seems to be a quite important issue, given that the key feature of gdaladdo
is only really usable with a workaround or by waiting for a very long time.

Cheers,
Felix



--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From osgeo.mailinglist at gmail.com  Mon Oct 21 09:08:36 2019
From: osgeo.mailinglist at gmail.com (Thomas Gratier)
Date: Mon, 21 Oct 2019 18:08:36 +0200
Subject: [gdal-dev] Documenting build requirements (e.g. ODBC)
In-Reply-To: <CABUeae-DPOmX+2RU7+PFoO+HTx=7aou7FHXLbUw0q=BiYGpMQQ@mail.gmail.com>
References: <CABUeae8QErHhABrvZQFQ8MsSVK9_aJ0BWVYRReAXZ8Q+=v8s0w@mail.gmail.com>
 <1660509.EYkVnefIB9@even-i700>
 <ee6b53ea-d890-177e-b4ab-917ff6b4abd4@gatewaygeomatics.com>
 <CABUeae-DPOmX+2RU7+PFoO+HTx=7aou7FHXLbUw0q=BiYGpMQQ@mail.gmail.com>
Message-ID: <CACPZzQ0WHU-e0jhw3pbWC4K4T9jxoAOek1trDN8i-r-yOteXgA@mail.gmail.com>

Hi,

In my opinion, although there are not explanations, Travis build files are
a good help to sort out building issues dependencies.
https://github.com/OSGeo/gdal/tree/master/gdal/ci/travis
Mentioning them somewhere could help


Regards

Thomas Gratier

Le dim. 20 oct. 2019 à 22:27, Mateusz Loskot <mateusz at loskot.net> a écrit :

> On Sun, 20 Oct 2019 at 19:31, Jeff McKenna
> <jmckenna at gatewaygeomatics.com> wrote:
> > > On lundi 30 septembre 2019 11:21:16 CEST Mateusz Loskot wrote:
> > >>
> > >> I'm a bit lost where build requirements are supposed
> > >> to be documented now. They used to be described
> > >> on the Wiki, e.g. https://trac.osgeo.org/gdal/wiki/BuildingOnUnix
> > >> or driver-specific ones https://trac.osgeo.org/gdal/wiki/ECW
> > >
> >
> > The wiki worked really well for that, and over the years we compiled
> > quite a list of build steps for drivers and platforms
> > (https://trac.osgeo.org/gdal/wiki/BuildHints).  I'd suggest we continue
> > to use the wiki method (meaning now we transition to the Github wiki),
> > so we don't have any funnels where someone needs to approve or
> > disapprove of a change to the official website or repository.
>
> I don't have anything against the wiki but a wiki is supposed to be
> complementary to existing docs.
>
> Even suggested to recover the "Compiled by default" column
> from the table in the old docs. On reflection, I don't think that
> will solve problem I'm calling in this thread - what are the build
> requirements of GDAL and features in GDAL.
>
> IMO, there should be
>
> https://gdal.org/building/
> https://gdal.org/building/requirements
> https://gdal.org/building/unix
> https://gdal.org/building/windows
>
> where https://gdal.org/building/requirements  lists common dependencies
> similarly to https://pdal.io/development/compilation/dependencies.html
>
> e.g. it lists ODBC and describes briefly that it is required by drivers A,
> B, C,
> that on Unix one can use unixODBC or iODBC; that on Windows it comes
> with native Windows SDK.
> Similarly for libcurl, proj, and any other general purpose dependency of
> GDAL.
>
> > The argument sometimes used against a wiki is that it is not managed,
> > but this is exactly why the Buildhints wiki was allowed to thrive.
>
> Official build procedure with requirements listed is  one thing.
> Build hints, workarounds and troubleshooting is a different thing.
> IMO, the former should be reviewed, curated and up to date
> while the latter is a perfect fit for community-written wiki
> that can rot...
>
> > There of course will still be one hurdle, requiring to have a Github
> > account, but besides that the wiki should thrive there for years to come.
>
> Similar hurdle (requirement of an account) applies to OSGeo infrastructure.
>
> Best regards,
> --
> Mateusz Loskot, http://mateusz.loskot.net
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191021/aa9c27e9/attachment-0001.html>

From even.rouault at spatialys.com  Mon Oct 21 12:39:53 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 21 Oct 2019 21:39:53 +0200
Subject: [gdal-dev] gdaladdo taking very long time to build overviews
	for large extent mosaic.
In-Reply-To: <1571668095204-0.post@n6.nabble.com>
References: <CAL9U1WuT8X-U8FWievL_xkG2atMUa6eAgtppOncsumO1jBbBvg@mail.gmail.com>
 <308304781.jEyKFYfJS9@even-i700> <1571668095204-0.post@n6.nabble.com>
Message-ID: <6471715.fa2U7DOQmy@even-i700>

On lundi 21 octobre 2019 07:28:15 CEST FelixH wrote:
> Are there any plans to fix the context switching issues with libtiff?

This has been fixed in libtiff and GDAL master in June.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From momtchil at momtchev.com  Tue Oct 22 03:07:28 2019
From: momtchil at momtchev.com (Momtchil Momtchev)
Date: Tue, 22 Oct 2019 12:07:28 +0200
Subject: [gdal-dev] experimental GDAL 3 packages for Debian stable
Message-ID: <4a925289-24d8-1dde-f940-63bb87f2bbbe@momtchev.com>

     Hello,


I have set up a Debian 10 repository with a merge of the official Debian 
packages from sid and GDAL 3 compiled directly from the git master. 
These are highly experimental but seem to work for me. They include 
proj6, ogdi4 and libgeotiff5, all based on the official Debian packages 
from sid. They have different names from the base packages, so 
installing the runtime only of proj6 and gdal26 along proj4 and gdal24 
should be possible. The -dev packages are mutually exclusive.

GDAL in Debian 10 is broken for my usage because of a new artificial 
memory constraint in the GeoJSON driver that is fixed on master, so I am 
willing to maintain these until Debian catches up. Once there is a new 
official release, be it 3.0.2 or 3.1, I will rebuild them and I will 
probably stop there.

If anyone is interested in rebuilding these packages for Ubuntu 19.04, I 
have left the Dockerfiles.

The repository can be found at https://deb.meteo.guru/ , any comments 
are welcome


-- 
Momtchil Momtchev <momtchil at momtchev.com>


From Bryan at bryanfields.net  Tue Oct 22 17:03:30 2019
From: Bryan at bryanfields.net (Bryan Fields)
Date: Tue, 22 Oct 2019 20:03:30 -0400
Subject: [gdal-dev] converting AAIGrid to SRTM
Message-ID: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>

Greetings,

I have a need for corrected version 4 of the 3 arc second SRTM data.  This is
only available as a AAIGrid format for some reason, not SRTM HGT.

I've pulled the 30x30 degree tiles from here in AAIGrid:
http://srtm.csi.cgiar.org/srtmdata/

gdal_translate requires the input file to match the resolution of the SRTM
output, which is 1201 x 1201 with 1 overlap pixel.

So I broke the 30x30 into 1201 x 1201 AAIGrid files first:

gdal_retile.py -of AAIGrid -v  -ps 1201 1201 -overlap 1 -v -csv csv.csv
-targetDir out cut_n00w090.asc

Then to the out/ directory, and use gdal_translate:

gdal_translate -of SRTMHGT  cut_n00w090_01_01.asc output.hgt

This appears to work and gives a warning of:
Warning 1: Expected output filename is N29W090.HGT

Question 1:
Is there a way to have it auto name the output file?  I'd assume if it knows
what it's suppose to be named, there should be a flag to automatically name it
that.  I can't find that, and need it to convert several thousand of these files.

Question 2:
Is my re-tiling correct and method correct to convert to SRTM 3 arc second HGT
files?

Is there a better way to do any of this?  I did search the archives and was
unable to find much else as the SRTM doesn't look that popular of a format to
process.
-- 
Bryan Fields

727-409-1194 - Voice
http://bryanfields.net

From stephenwoodbridge37 at gmail.com  Wed Oct 23 10:41:45 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Wed, 23 Oct 2019 13:41:45 -0400
Subject: [gdal-dev] Question on converting netCDF to GTiff
Message-ID: <72edb825-a773-36bb-dce1-c6673a934c00@gmail.com>

Hi,

I have a netCDF grid of Float32 values that I want to convert to GTiff 
with Int16 values. The min/max values will support this without scaling, 
but I'm not sure what will happen to the NODATA value = 
9.96920996838686905e+36.

Ideally, I would like to set it to something like 32000 but not sure how 
to do that.

I've gotten as far as:

gdal_translate -of GTiff -co TILED=YES -ot Int16 -a_srs EPSG:4326
GEBCO_2019.nc  gebco_2019.tif

Which runs and looks ok except NODATA is set the same and that value 
clearly will not fit in an Int16. Now it is possible that the grid 
doesn't actually have any nodata cells set and only has the value 
defined but I'm not sure how to check if that is the case.

Any thoughts appreciated.

Thanks,
   -Steve W


$ gdalinfo GEBCO_2019.nc -stats
Driver: netCDF/Network Common Data Format
Files: GEBCO_2019.nc
Size is 86400, 43200
Coordinate System is `'
Origin = (-180.000000000000000,90.000000000000000)
Pixel Size = (0.004166666666667,-0.004166666666667)
Metadata:
   elevation#long_name=Elevation relative to sea level
   elevation#sdn_parameter_name=Sea floor height (above mean sea level) 
{bathymetric height}
   elevation#sdn_parameter_urn=SDN:P01::ALATZZ01
   elevation#sdn_uom_name=Metres
   elevation#sdn_uom_urn=SDN:P06::ULAA
   elevation#standard_name=height_above_reference_ellipsoid
   elevation#units=m
   lat#axis=Y
   lat#long_name=latitude
   lat#sdn_parameter_name=Latitude north
   lat#sdn_parameter_urn=SDN:P01::ALATZZ01
   lat#sdn_uom_name=Degrees north
   lat#sdn_uom_urn=SDN:P06::DEGN
   lat#standard_name=latitude
   lat#units=degrees_north
   lon#axis=X
   lon#long_name=longitude
   lon#sdn_parameter_name=Longitude east
   lon#sdn_parameter_urn=SDN:P01::ALONZZ01
   lon#sdn_uom_name=Degrees east
   lon#sdn_uom_urn=SDN:P06::DEGE
   lon#standard_name=longitude
   lon#units=degrees_east
   NC_GLOBAL#comment=The data in the GEBCO_2019 Grid should not be used 
for navigation or any purpose relating to safety at sea.
   NC_GLOBAL#Conventions=CF-1.6
   NC_GLOBAL#history=Information on the development of the data set and 
the source data sets included in the grid can be found in the data set 
documentation available from https://www.gebco.net
   NC_GLOBAL#institution=On behalf of the General Bathymetric Chart of 
the Oceans (GEBCO), the data are held at the British Oceanographic Data 
Centre (BODC).
   NC_GLOBAL#node_offset=1
   NC_GLOBAL#references=DOI: 10.5285/836f016a-33be-6ddc-e053-6c86abc0788e
   NC_GLOBAL#source=The GEBCO_2019 Grid is the latest global bathymetric 
product released by the General Bathymetric Chart of the Oceans (GEBCO) 
and has been developed through the Nippon Foundation-GEBCO Seabed 2030 
Project. This is a collaborative project between the Nippon Foundation 
of Japan and GEBCO. The Seabed 2030 Project aims to bring together all 
available bathymetric data to produce the definitive map of the world 
ocean floor and make it available to all.
   NC_GLOBAL#title=The GEBCO_2019 Grid - a continuous terrain model for 
oceans and land at 15 arc-second intervals
Corner Coordinates:
Upper Left  (-180.0000000,  90.0000000)
Lower Left  (-180.0000000, -90.0000000)
Upper Right ( 180.0000000,  90.0000000)
Lower Right ( 180.0000000, -90.0000000)
Center      (   0.0000000,   0.0000000)
Band 1 Block=86400x1 Type=Float32, ColorInterp=Undefined
   Minimum=-10880.588, Maximum=8613.156, Mean=-1895.032, StdDev=2656.923
   NoData Value=9.96920996838686905e+36
   Unit Type: m
   Metadata:
     long_name=Elevation relative to sea level
     NETCDF_VARNAME=elevation
     sdn_parameter_name=Sea floor height (above mean sea level) 
{bathymetric height}
     sdn_parameter_urn=SDN:P01::ALATZZ01
     sdn_uom_name=Metres
     sdn_uom_urn=SDN:P06::ULAA
     standard_name=height_above_reference_ellipsoid
     STATISTICS_MAXIMUM=8613.15625
     STATISTICS_MEAN=-1895.0320141561
     STATISTICS_MINIMUM=-10880.587890625
     STATISTICS_STDDEV=2656.9226774517
     units=m


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Wed Oct 23 10:54:16 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Oct 2019 19:54:16 +0200
Subject: [gdal-dev] Question on converting netCDF to GTiff
In-Reply-To: <72edb825-a773-36bb-dce1-c6673a934c00@gmail.com>
References: <72edb825-a773-36bb-dce1-c6673a934c00@gmail.com>
Message-ID: <2198478.DrAEzhFfKH@even-i700>

On mercredi 23 octobre 2019 13:41:45 CEST Stephen Woodbridge wrote:
> Hi,
> 
> I have a netCDF grid of Float32 values that I want to convert to GTiff
> with Int16 values. The min/max values will support this without scaling,
> but I'm not sure what will happen to the NODATA value =
> 9.96920996838686905e+36.
> 
> Ideally, I would like to set it to something like 32000 but not sure how
> to do that.
> 
> I've gotten as far as:
> 
> gdal_translate -of GTiff -co TILED=YES -ot Int16 -a_srs EPSG:4326
> GEBCO_2019.nc  gebco_2019.tif
> 
> Which runs and looks ok except NODATA is set the same and that value
> clearly will not fit in an Int16. Now it is possible that the grid
> doesn't actually have any nodata cells set and only has the value
> defined but I'm not sure how to check if that is the case.

To check if there are cells set to NODATA, with recent enough GDAL (3.0 I 
think), with gdalinfo -stats, you'll see a STATISTICS_VALID_PERCENT item. If 
it is not 100, then there are nodata cells.

To do nodata value remapping, use gdalwarp -srcnodata XX -dstnodata YY

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stephenwoodbridge37 at gmail.com  Wed Oct 23 12:15:19 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Wed, 23 Oct 2019 15:15:19 -0400
Subject: [gdal-dev] Question on converting netCDF to GTiff
In-Reply-To: <2198478.DrAEzhFfKH@even-i700>
References: <72edb825-a773-36bb-dce1-c6673a934c00@gmail.com>
 <2198478.DrAEzhFfKH@even-i700>
Message-ID: <76c79838-1a5c-7ee8-a19c-335883820781@gmail.com>

On 10/23/2019 1:54 PM, Even Rouault wrote:
> On mercredi 23 octobre 2019 13:41:45 CEST Stephen Woodbridge wrote:
>> Hi,
>>
>> I have a netCDF grid of Float32 values that I want to convert to GTiff
>> with Int16 values. The min/max values will support this without scaling,
>> but I'm not sure what will happen to the NODATA value =
>> 9.96920996838686905e+36.
>>
>> Ideally, I would like to set it to something like 32000 but not sure how
>> to do that.
>>
>> I've gotten as far as:
>>
>> gdal_translate -of GTiff -co TILED=YES -ot Int16 -a_srs EPSG:4326
>> GEBCO_2019.nc  gebco_2019.tif
>>
>> Which runs and looks ok except NODATA is set the same and that value
>> clearly will not fit in an Int16. Now it is possible that the grid
>> doesn't actually have any nodata cells set and only has the value
>> defined but I'm not sure how to check if that is the case.
> To check if there are cells set to NODATA, with recent enough GDAL (3.0 I
> think), with gdalinfo -stats, you'll see a STATISTICS_VALID_PERCENT item. If
> it is not 100, then there are nodata cells.
>
> To do nodata value remapping, use gdalwarp -srcnodata XX -dstnodata YY
>
> Even
>
Thanks gdalwarp does the job nicely.

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From even.rouault at spatialys.com  Wed Oct 23 12:43:47 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Oct 2019 21:43:47 +0200
Subject: [gdal-dev] converting AAIGrid to SRTM
In-Reply-To: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
References: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
Message-ID: <1945055.do5xzePDXr@even-i700>

> Question 1:
> Is there a way to have it auto name the output file?  I'd assume if it knows
> what it's suppose to be named, there should be a flag to automatically name
> it that.  I can't find that, and need it to convert several thousand of
> these files.

Such an option doesn't exist, but it shouldn't be hard to implement if you 
want to submit a pull request for that. I'd suggest to trigger that mode if 
the output filename provided is actually a directory name ("." being a valid 
name).

> 
> Question 2:
> Is my re-tiling correct and method correct to convert to SRTM 3 arc second
> HGT files?

Looks good

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From palmerjnz at gmail.com  Wed Oct 23 12:50:31 2019
From: palmerjnz at gmail.com (Jeremy Palmer)
Date: Thu, 24 Oct 2019 06:50:31 +1100
Subject: [gdal-dev] OGR Python API to Load Esri JSON
Message-ID: <CAA5WJYk0oOyq_C771xoDeHT3vjLFJPTWoDXa81iY0+rJgyKQqw@mail.gmail.com>

Hi All,

Is there a OGR Python API to load Esri JSON into an OGR geometry object,
much like CreateGeometryFromJson? I’ve seen the arcgis2geojson library but
wanted to avoid that dependency.

Cheers,
Jeremy
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191024/33fac2ab/attachment.html>

From even.rouault at spatialys.com  Wed Oct 23 13:10:26 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 23 Oct 2019 22:10:26 +0200
Subject: [gdal-dev] OGR Python API to Load Esri JSON
In-Reply-To: <CAA5WJYk0oOyq_C771xoDeHT3vjLFJPTWoDXa81iY0+rJgyKQqw@mail.gmail.com>
References: <CAA5WJYk0oOyq_C771xoDeHT3vjLFJPTWoDXa81iY0+rJgyKQqw@mail.gmail.com>
Message-ID: <29117812.e6EuxSCDHQ@even-i700>

Hi Jeremy,
> 
> Is there a OGR Python API to load Esri JSON into an OGR geometry object,
> much like CreateGeometryFromJson?

If you update to latest master, yes:
https://github.com/OSGeo/gdal/commit/5dadb24e3b9a1364ad3792ca63cd9312925b8601

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From nyall.dawson at gmail.com  Wed Oct 23 21:19:15 2019
From: nyall.dawson at gmail.com (Nyall Dawson)
Date: Thu, 24 Oct 2019 14:19:15 +1000
Subject: [gdal-dev] OGR Python API to Load Esri JSON
In-Reply-To: <29117812.e6EuxSCDHQ@even-i700>
References: <CAA5WJYk0oOyq_C771xoDeHT3vjLFJPTWoDXa81iY0+rJgyKQqw@mail.gmail.com>
 <29117812.e6EuxSCDHQ@even-i700>
Message-ID: <CAB28AshZACxX1yXT885eHjn_JomzBsrXT+duCVT9wbHRo8oYbQ@mail.gmail.com>

On Thu, 24 Oct 2019 at 06:10, Even Rouault <even.rouault at spatialys.com> wrote:
>
> Hi Jeremy,
> >
> > Is there a OGR Python API to load Esri JSON into an OGR geometry object,
> > much like CreateGeometryFromJson?
>
> If you update to latest master, yes:
> https://github.com/OSGeo/gdal/commit/5dadb24e3b9a1364ad3792ca63cd9312925b8601

I don't suppose the reverse function is available, is it?

Nyall

From even.rouault at spatialys.com  Thu Oct 24 01:50:08 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Oct 2019 10:50:08 +0200
Subject: [gdal-dev] OGR Python API to Load Esri JSON
In-Reply-To: <CAB28AshZACxX1yXT885eHjn_JomzBsrXT+duCVT9wbHRo8oYbQ@mail.gmail.com>
References: <CAA5WJYk0oOyq_C771xoDeHT3vjLFJPTWoDXa81iY0+rJgyKQqw@mail.gmail.com>
 <29117812.e6EuxSCDHQ@even-i700>
 <CAB28AshZACxX1yXT885eHjn_JomzBsrXT+duCVT9wbHRo8oYbQ@mail.gmail.com>
Message-ID: <22148803.ABL23BrvJK@even-i700>

On jeudi 24 octobre 2019 14:19:15 CEST Nyall Dawson wrote:
> On Thu, 24 Oct 2019 at 06:10, Even Rouault <even.rouault at spatialys.com> 
wrote:
> > Hi Jeremy,
> > 
> > > Is there a OGR Python API to load Esri JSON into an OGR geometry object,
> > > much like CreateGeometryFromJson?
> > 
> > If you update to latest master, yes:
> > https://github.com/OSGeo/gdal/commit/5dadb24e3b9a1364ad3792ca63cd9312925b8
> > 601
> I don't suppose the reverse function is available, is it?

No, ESRI Json is read-only

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From stephenwoodbridge37 at gmail.com  Thu Oct 24 07:38:05 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 24 Oct 2019 10:38:05 -0400
Subject: [gdal-dev] Problems with masking while create a color-relief from a
	DEM
Message-ID: <a1584319-9aba-1483-6f73-bb21c8cc4e34@gmail.com>

Hi,

I have a collection of region netCDF DEM files that overlap and have a 
nodata=-nan. I have been able to convert them to color-relief using 
gdaldem but somewhere in the processing chain I seem to be loosing the 
nodata/mask/alpha info and the nodata in the color-relief is opaque, ie: 
where the DEMs overlap and there is nodata the later image blocks out 
the earlier image rather than being transparent.

Running: GDAL 2.2.2, released 2017/09/15 on Ubuntu xenial

Processing is like:

gdalwarp -s_srs EPSG:4269 -t_srs EPSG:4326 -srcnodata \-nan -dstnodata 
30000 -ot Int16 -of GTiff -co TILED=YES crm_vol1.nc crm_vol1.nc.tif

and I have tried variants like:

-srcnodata -32768 or  -- I get a lot of -32768 in the conversion to Int16
-dstnodata 30000      -- let gdal sense the nodata value
instead of -srcnodata \-nan -dstnodata 30000

gdaldem color-relief crm_vol1.nc.tif ../dem-colors.txt 
crm_vol1.nc.colored.tif -of GTiff -co TILED=YES -alpha

also run without -alpha

Anyway, I have 10 region DEMs and then I combine them in a VRT like

buildvrt color-relief.vrt *.colored.tif

Then I serve that via mapserver. I get the same image if I just do:

gdal_translate -of PNG color-relief.vrt test.png

-Steve

woodbri at u19589217:~/work/bathymetry/coastal-relief$ gdalwarp -s_srs 
EPSG:4269 -t_srs EPSG:4326 -srcnodata -32768 -ot Int16 -of GTiff -co 
TILED=YES crm_vol1.nc crm_vol1.nc.tif
Creating output file that is 19201P x 9601L.
Processing input file crm_vol1.nc.
Copying nodata values from source crm_vol1.nc to destination 
crm_vol1.nc.tif.
0...10...20...30...40...50...60...70...80...90...100 - done.

woodbri at u19589217:~/work/bathymetry/coastal-relief$ gdalinfo crm_vol1.nc.tif
Driver: GTiff/GeoTIFF
Files: crm_vol1.nc.tif
Size is 19201, 9601
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-80.000416666666666,48.000416666666666)
Pixel Size = (0.000833333333333,-0.000833333333333)
Metadata:
   AREA_OR_POINT=Area
   NC_GLOBAL#Conventions=CF-1.4
   NC_GLOBAL#geospatial_lat_max=48
   NC_GLOBAL#geospatial_lat_min=40
   NC_GLOBAL#geospatial_lat_resolution=0.000833
   NC_GLOBAL#geospatial_lat_units=degrees_north
   NC_GLOBAL#geospatial_lon_max=-64
   NC_GLOBAL#geospatial_lon_min=-80
   NC_GLOBAL#geospatial_lon_resolution=0.000833
   NC_GLOBAL#geospatial_lon_units=degrees_east
   NC_GLOBAL#GMT_version=4.5.1 [64-bit]
   NC_GLOBAL#history=xyz2grd -R-80/-64/40/48 -I3c -Gcrm_v1.grd
   NC_GLOBAL#title=crm_v1.grd
   x#actual_range={-80,-64}
   x#long_name=x
   x#units=degrees_east
   x#_CoordinateAxisType=Lon
   y#actual_range={40,48}
   y#long_name=y
   y#units=degrees_north
   y#_CoordinateAxisType=Lat
   z#actual_range={-2754.39990234375,1903}
   z#long_name=z
   z#positive=up
   z#units=meters
   z#_FillValue=-nan
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -80.0004167,  48.0004167) ( 80d 0' 1.50"W, 48d 0' 1.50"N)
Lower Left  ( -80.0004167,  39.9995833) ( 80d 0' 1.50"W, 39d59'58.50"N)
Upper Right ( -63.9995833,  48.0004167) ( 63d59'58.50"W, 48d 0' 1.50"N)
Lower Right ( -63.9995833,  39.9995833) ( 63d59'58.50"W, 39d59'58.50"N)
Center      ( -72.0000000,  44.0000000) ( 72d 0' 0.00"W, 44d 0' 0.00"N)
Band 1 Block=256x256 Type=Int16, ColorInterp=Gray
   NoData Value=-32768
   Unit Type: meters
   Metadata:
     actual_range={-2754.39990234375,1903}
     long_name=z
     NETCDF_VARNAME=z
     positive=up
     units=meters
     _FillValue=-nan
woodbri at u19589217:~/work/bathymetry/coastal-relief$ gdalinfo 
crm_vol1.nc.tif -hist
Driver: GTiff/GeoTIFF
Files: crm_vol1.nc.tif
Size is 19201, 9601
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-80.000416666666666,48.000416666666666)
Pixel Size = (0.000833333333333,-0.000833333333333)
Metadata:
   AREA_OR_POINT=Area
   NC_GLOBAL#Conventions=CF-1.4
   NC_GLOBAL#geospatial_lat_max=48
   NC_GLOBAL#geospatial_lat_min=40
   NC_GLOBAL#geospatial_lat_resolution=0.000833
   NC_GLOBAL#geospatial_lat_units=degrees_north
   NC_GLOBAL#geospatial_lon_max=-64
   NC_GLOBAL#geospatial_lon_min=-80
   NC_GLOBAL#geospatial_lon_resolution=0.000833
   NC_GLOBAL#geospatial_lon_units=degrees_east
   NC_GLOBAL#GMT_version=4.5.1 [64-bit]
   NC_GLOBAL#history=xyz2grd -R-80/-64/40/48 -I3c -Gcrm_v1.grd
   NC_GLOBAL#title=crm_v1.grd
   x#actual_range={-80,-64}
   x#long_name=x
   x#units=degrees_east
   x#_CoordinateAxisType=Lon
   y#actual_range={40,48}
   y#long_name=y
   y#units=degrees_north
   y#_CoordinateAxisType=Lat
   z#actual_range={-2754.39990234375,1903}
   z#long_name=z
   z#positive=up
   z#units=meters
   z#_FillValue=-nan
Image Structure Metadata:
   INTERLEAVE=BAND
Corner Coordinates:
Upper Left  ( -80.0004167,  48.0004167) ( 80d 0' 1.50"W, 48d 0' 1.50"N)
Lower Left  ( -80.0004167,  39.9995833) ( 80d 0' 1.50"W, 39d59'58.50"N)
Upper Right ( -63.9995833,  48.0004167) ( 63d59'58.50"W, 48d 0' 1.50"N)
Lower Right ( -63.9995833,  39.9995833) ( 63d59'58.50"W, 39d59'58.50"N)
Center      ( -72.0000000,  44.0000000) ( 72d 0' 0.00"W, 44d 0' 0.00"N)
Band 1 Block=256x256 Type=Int16, ColorInterp=Gray
0...10...20...30...40...50...60...70...80...90...100 - done.
   256 buckets from -1548.44 to 1236.44:
   1032801 10127 10364 9826 8535 9227 9176 9188 9233 9661 9292 9087 8590 
8923 8716 8643 8752 8632 8605 8640 8632 8115 8654 8446 8493 8250 8373 
8216 7855 7159 7887 8094 8269 8038 7691 7646 7487 6743 7396 7245 7156 
7369 7399 7333 7411 6859 7542 7438 7484 7584 7557 7523 7540 7106 7489 
7336 7393 7450 7318 7227 7256 6996 6339 6970 6984 6885 6761 6704 6749 
6854 6182 6893 7015 6997 7050 7033 7072 7146 6557 7236 7199 7306 7225 
7292 7202 7381 6799 7529 7525 7594 7626 7772 7839 8021 8247 7609 8582 
8873 9051 9084 9400 9614 9786 8956 9907 10163 10466 10868 25910 36376 
43063 62233 63701 68806 77172 95784 121102 144946 220779 318701 515996 
677511 807570 1106919 1266071 1331148 1213751 936387 838275 844343 
825124 892606 953963 1537850 1781357 2018853 2341719 2388359 2391318 
1998359 1485291 1168051 1480774 992742 734483 1554927 916946 1682915 
640711 831701 1804228 628642 689638 2080653 751301 761486 2303932 701017 
874713 1876341 611201 1753845 742827 644273 1610207 667418 643178 
1548112 738446 633336 1679225 781684 812290 1696296 752769 1770805 
804989 657425 1618410 666493 621947 1310715 575474 583199 1122012 442866 
500235 835458 395728 726215 376469 325665 598716 263472 269859 501338 
242752 233613 413525 192132 196579 276488 127191 209752 151081 101450 
164848 82122 77595 117805 60015 63534 93537 50029 45890 60427 36654 
52001 26321 27558 38248 20918 20783 27515 19528 16649 23961 14802 11928 
16105 9934 12701 7403 7403 9233 5869 5788 8036 5499 5402 7403 4318 3344 
3911 2413 2190 2400 1574 2032 1115 1219 1520 1129 1193 1670 13783
   NoData Value=-32768
   Unit Type: meters
   Metadata:
     actual_range={-2754.39990234375,1903}
     long_name=z
     NETCDF_VARNAME=z
     positive=up
     STATISTICS_MAXIMUM=1231
     STATISTICS_MEAN=109.57123697519
     STATISTICS_MINIMUM=-1543
     STATISTICS_STDDEV=306.33492576621
     units=meters
     _FillValue=-nan

### Because the MINIMUM is -1543, this seems to point to the fact that 
-32768 is NODATA and the fact that when I run gdalwarp without 
'-srcnodata -32768' I get lots of -32768 values.

woodbri at u19589217:~/work/bathymetry/coastal-relief$ gdaldem color-relief 
crm_vol1.nc.tif ../dem-colors.txt test.tif -of GTiff -co TILED=YES -alpha
0...10...20...30...40...50...60...70...80...90...100 - done.
woodbri at u19589217:~/work/bathymetry/coastal-relief$ gdalinfo test.tif -hist
Driver: GTiff/GeoTIFF
Files: test.tif
Size is 19201, 9601
Coordinate System is:
GEOGCS["WGS 84",
     DATUM["WGS_1984",
         SPHEROID["WGS 84",6378137,298.257223563,
             AUTHORITY["EPSG","7030"]],
         AUTHORITY["EPSG","6326"]],
     PRIMEM["Greenwich",0],
     UNIT["degree",0.0174532925199433],
     AUTHORITY["EPSG","4326"]]
Origin = (-80.000416666666666,48.000416666666666)
Pixel Size = (0.000833333333333,-0.000833333333333)
Metadata:
   AREA_OR_POINT=Area
Image Structure Metadata:
   INTERLEAVE=PIXEL
Corner Coordinates:
Upper Left  ( -80.0004167,  48.0004167) ( 80d 0' 1.50"W, 48d 0' 1.50"N)
Lower Left  ( -80.0004167,  39.9995833) ( 80d 0' 1.50"W, 39d59'58.50"N)
Upper Right ( -63.9995833,  48.0004167) ( 63d59'58.50"W, 48d 0' 1.50"N)
Lower Right ( -63.9995833,  39.9995833) ( 63d59'58.50"W, 39d59'58.50"N)
Center      ( -72.0000000,  44.0000000) ( 72d 0' 0.00"W, 44d 0' 0.00"N)
Band 1 Block=256x256 Type=Byte, ColorInterp=Red
0...10...20...30...40...50...60...70...80...90...100 - done.
   256 buckets from -0.5 to 255.5:
   1447178 10259 11314 10054 10772 10116 10544 9874 10197 9474 10108 
9290 9192 9863 9320 10114 9503 10258 9596 10439 9769 10544 9893 9916 
10560 10083 10932 10307 11109 10578 11584 96844185 12419 12063 12287 
13541 13146 14316 13427 15026 14692 41339 54152 94778 89113 105552 
150343 189234 344217 608083 1007554 1252249 1834367 1796592 1566353 
686026 301844 319297 303284 294902 379814 297508 322741 326623 336581 
329518 456173 453383 583398 672362 603596 648066 875983 704772 796500 
873236 988435 932029 1081958 429972 0 0 209878 0 0 214570 0 0 206080 0 0 
215590 0 0 215942 0 0 1720831 3150361 3246722 3064822 3436119 3887445 
3286771 3015137 3019139 2916134 3079190 3375360 3137205 2818227 2558566 
2000431 1603370 1613223 1145531 865690 889479 503867 356019 486292 
212496 150386 324876 88236 64546 254783 39922 28669 209142 9333 10523 
188291 9848 5991 178231 3127 3533 171542 1778 2262 175583 2259 162793 
1408 871 164088 793 574 164099 727 974 169365 621 314 163860 284 221 
156479 200 363 148526 269 162 141005 102 192 132298 103 135 67 74 30 
122259 26 13 27 19 35 117867 21 7 6 1 115547 0 0 0 0 0 107718 0 0 0 0 0 
112217 0 0 0 0 0 116080 0 0 0 0 0 111385 0 0 0 0 112290 0 0 0 0 0 114605 
0 0 0 0 0 105392 0 0 0 0 0 108539 0 0 0 0 0 106181 0 0 0 0 107507 0 0 0 
0 0 102755 0 0 0 0 0 277539 876651
   Mask Flags: PER_DATASET ALPHA
Band 2 Block=256x256 Type=Byte, ColorInterp=Green
0...10...20...30...40...50...60...70...80...90...100 - done.
   256 buckets from -0.5 to 255.5:
   96833026 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 16 75 140 198 287 351 463 
524 637 683 835 876 1042 1076 1262 1266 1479 1498 1734 1894 2796 3613 
4713 4577 5138 5103 5706 5922 6683 6545 7788 7180 7669 8267 8555 7904 
9326 8920 10054 10109 12815 16648 17934 19054 23674 25061 26778 26027 
26804 34992 32866 32562 43008 49196 47848 43750 44507 43656 40371 40416 
39964 44200 37127 31420 28558 28264 28802 29065 26773 28180 26803 25375 
25099 26237 24635 23969 22921 24354 22041 21337 21322 22293 21793 15775 
10959 11285 10050 10754 10768 10584 9803 10191 904269 29616405 23517792 
22170 17868 15376 12718 13571 13277 12571 12643 11803 11759 10839 11603 
11998 11691 10959 11469 11559 11952 11230 12674 12969 13392 12755 13993 
14430 14599 13888 15503 32779 54749 84164 93114 108783 132694 193903 
316919 613006 919712 1278482 1828546 1914933 1483630 688489 158311 
223793 157739 161558 231034 144417 146459 229560 152079 859370 149766 
155239 247609 162400 252425 168272 162655 253183 176214 193639 334935 
253686 448160 329813 342549 453365 301196 451433 531653 345269 515629 
361455 386660 621607 428993 731571 489340 480048 663541 426752 443646 
429972 209878 214570 206080 327481 215942 218188 219973 223583 220948 
215852 214423 218337 222402 216418 210014 198017 191032 179768 172689 
168699 173849 161326 257454 163315 168811 163531 156177 148272 140825 
132120 0 122228 0 117845 0 115547 0 107718 0 112217 89065 116080 111385 
0 112290 0 114605 0 105392 0 108539 0 106181 0 107507 0 102755 0 94252
   Mask Flags: PER_DATASET ALPHA
Band 3 Block=256x256 Type=Byte, ColorInterp=Blue
0...10...20...30...40...50...60...70...80...90...100 - done.
   256 buckets from -0.5 to 255.5:
   565598 1189840 1852045 1101516 1893780 964720 1860454 869243 1023955 
2192352 972005 2518135 906493 2242864 794478 2002472 855945 1744142 
880240 873707 1717830 907306 1865819 927191 1972323 956931 2027450 
945921 1804008 865933 760223 1414197 737480 1270138 608891 1005960 
500073 845304 401791 680128 375937 367795 531651 300975 467826 238508 
333763 178881 276561 136576 192569 106542 103761 123087 76043 96939979 
61754 74426 46899 58403 36738 45492 24866 25100 32757 22670 29581 17198 
18888 12718 13473 9939 15877 16568 15695 11355 5653 5054 3646 3353 3361 
2198 1523 1141 1143 1154 1272 785 507 387 426 514 438 287 255 174 247 
158 95 51 26 39 47 34 17 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 637177 0 
0 0 0 0 127583 0 0 0 0 0 111891 0 0 0 0 0 94222 0 0 0 0 0 89065 0 0 0 0 
0 94252 0 102755 107507 0 106208 108720 382 105982 832 115710 113619 
1681 113287 118262 2606 141130 52191 162197 171295 58364 178118 185143 
64851 197988 209270 374620 235787 242807 250349 270923 446129 288564 
299692 314081 336078 481240 229485 236272 232700 229178 452198 239022 
236573 235649 233818 438902 233923 257743 1385197 2477781 2111821 
1882477 1880794 1768442 1983066 2599410 3104590 2887397 1006087 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
   Mask Flags: PER_DATASET ALPHA
Band 4 Block=256x256 Type=Byte, ColorInterp=Alpha
0...10...20...30...40...50...60...70...80...90...100 - done.
   256 buckets from -0.5 to 255.5:
   0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
0 0 0 0 184348801

### All pixels have alpha 255 set. Size is 19201, 9601 = 184348801

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 24 10:42:23 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Thu, 24 Oct 2019 17:42:23 +0000
Subject: [gdal-dev] Open option for vectors in the cloud
Message-ID: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>

Hi,

I was experimenting with accessing some vector files through http (same data as FlatGeoBuffers, GeoPackage, and shapefile). The file size in each format was about 850 MB and the amount of data was about 240000 linestrings. I made ogrinfo request with spatial filter that selects one feature and cheched the number of http requests and amount of requested data.

FlatGeoBuffers
19 http requests
33046509 bytes read

GeoPackage
19 http requests
303085 bytes read

shapefile
52 http requests
1425356 bytes read

I try to add the debug log as an attachment but if it does not go through to the mailing list I can explain that in each case most requests and most transferred bytes for used for reading the spatial index. If somebody really finds a use case for reading vector data from the web it seems obvious that having a possibility to cache and re-use the spatial index would be very beneficial. I can imagine that with shapefile it would mean  downloading the .qix file, with GeoPackage reading the contents of the rtree index table, and with FlatGeoBuffers probably extracting the Static packed Hilbert R-tree index.

In my test I had Apache server running on localhost, and at least the speed of GeoPackage gave quite a good feeling.

-Jukka Rahkonen-

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191024/2a76f839/attachment-0001.html>
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Vectors_through_http_debug.txt
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191024/2a76f839/attachment-0001.txt>

From even.rouault at spatialys.com  Thu Oct 24 11:05:00 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 24 Oct 2019 20:05:00 +0200
Subject: [gdal-dev] Open option for vectors in the cloud
In-Reply-To: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
References: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
Message-ID: <2524372.SVzQUXFDd3@even-i700>

On jeudi 24 octobre 2019 17:42:23 CEST Rahkonen Jukka (MML) wrote:
> Hi,
> 
> I was experimenting with accessing some vector files through http (same data
> as FlatGeoBuffers, GeoPackage, and shapefile). The file size in each format
> was about 850 MB and the amount of data was about 240000 linestrings. I
> made ogrinfo request with spatial filter that selects one feature and
> cheched the number of http requests and amount of requested data.
> 
> FlatGeoBuffers
> 19 http requests
> 33046509 bytes read

Looking at the debug log, FlatGeoBuf currently loads the whole index-of-
features array( "Reading feature offsets index" ), which accounts for 32.7 MB 
of the above 33 MB. This could probably be avoided by only loading the offsets 
of the selected features. The shapefile driver a few years ago had the same 
issue and this was fixed by initializing the offset array to zeroes, and load 
on demand the offsets when needed.

> If somebody
> really finds a use case for reading vector data from the web it seems
> obvious that having a possibility to cache and re-use the spatial index
> would be very beneficial. I can imagine that with shapefile it would mean 
> downloading the .qix file, with GeoPackage reading the contents of the
> rtree index table, and with FlatGeoBuffers probably extracting the Static
> packed Hilbert R-tree index.

A general caching logic in /vsicurl/ would be preferable (although the 
download of the 'data' part of files might potentially evict the indexes, but 
having a dedicated logic in each driver to tell which files / region of the 
files should be cached would be a bit annoying). Basically doing a HEAD 
request on the file to get its last update date, and have a local cache of 
downloaded pieces would be a more general solution.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Bryan at bryanfields.net  Thu Oct 24 15:41:28 2019
From: Bryan at bryanfields.net (Bryan Fields)
Date: Thu, 24 Oct 2019 18:41:28 -0400
Subject: [gdal-dev] converting AAIGrid to SRTM
In-Reply-To: <1945055.do5xzePDXr@even-i700>
References: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
 <1945055.do5xzePDXr@even-i700>
Message-ID: <7ff085d6-16c9-c5ea-3b4e-763049b177f7@bryanfields.net>

On 10/23/19 3:43 PM, Even Rouault wrote:
>> Question 1:
>> Is there a way to have it auto name the output file?  I'd assume if it knows
>> what it's suppose to be named, there should be a flag to automatically name
>> it that.  I can't find that, and need it to convert several thousand of
>> these files.
> Such an option doesn't exist, but it shouldn't be hard to implement if you 
> want to submit a pull request for that. I'd suggest to trigger that mode if 
> the output filename provided is actually a directory name ("." being a valid 
> name).

I'd love to, but I'm not much of a programmer.  Typically I'll code up a
crappy script and then have one our my friends actually code up something that
works.

I made a script below that seems to work:

echo INPUT FILE: ${1}
gdal_translate -of SRTMHGT  $1 output.tmp 2>&1 |
while read line
        do
#       echo $line
        if [[ $line == "Warning 1: Expected output filename is"* ]]
                then
                while read -ra output
                do
                        OUTPUT=`echo ${output[6]} | cut -d "." -f 1,2`
                done <<< $line
        fi
done
echo GENERATING: $OUTPUT
mv output.tmp $OUTPUT

echo DONE WITH: $OUTPUT



>> Question 2:
>> Is my re-tiling correct and method correct to convert to SRTM 3 arc second
>> HGT files?
> Looks good

Well problem I ran into is this didn't split up the data right as it looks
like these ascii files have some overlap

bfields at Pythia:~/DEMv4/N00W090$ gdalinfo cut_n00w090.asc
Driver: AAIGrid/Arc/Info ASCII Grid
Files: cut_n00w090.asc
Size is 36023, 36023
Origin = (-90.009583333565004,30.009584035782641)
Pixel Size = (0.000833333353512,-0.000833333353512)
Corner Coordinates:
Upper Left  ( -90.0095833,  30.0095840)
Lower Left  ( -90.0095833,  -0.0095834)
Upper Right ( -59.9904159,  30.0095840)
Lower Right ( -59.9904159,  -0.0095834)
Center      ( -74.9999996,  15.0000003)
Band 1 Block=36023x1 Type=Int32, ColorInterp=Undefined
  NoData Value=-9999

This means the offset here not exactly aligned on -90, 0, but rather has an
overlap of 11 pixels on the left and 12 on the right.

Is there a way to trim this to 36001x36001 before converting it to the
1201x1201 tiles?

For example:
My understanding is the N00W90.HGT file lower left pixel is at 0, -90 lat/lon,
and will extend one pixel into N00W89.HGT.

When I run this conversion, I need an exact 1201x1201 image.  I'm also not
sure how to verify this is correct.  My concern is if I'm a pixel off that is
up to 90m, and now it would appear I'm 23 pixels off, or up to 2.07km.

Thank you,
-- 
Bryan Fields

727-409-1194 - Voice
http://bryanfields.net

From paul.malm at lfv.se  Thu Oct 24 22:46:59 2019
From: paul.malm at lfv.se (paul.malm at lfv.se)
Date: Fri, 25 Oct 2019 05:46:59 +0000
Subject: [gdal-dev] ogr2ogr for windows
In-Reply-To: <53f4861b10d342beb2d8a2061d37c524@C119S212VM042.msvyvi.vaha.local>
References: <53f4861b10d342beb2d8a2061d37c524@C119S212VM042.msvyvi.vaha.local>
Message-ID: <785199B14156764C8EB14EF96CEDC44EE50D2C@xw-exch03.lfv.se>

Hi!
It seems so easy for you guys, installing a new driver in ogr2ogr. But I haven’t found any information about how to do that in Windows.
I can see that I have the driver dll located in the gdal library….
Do I have to build the program again with Visual studio (don’t have).

Is there a reason for not having all the drivers linked in the default distribution pack?

Kind regards,
Paul

Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För Rahkonen Jukka (MML)
Skickat: den 18 oktober 2019 14:03
Till: Stephen Knox
Kopia: gdal-dev at lists.osgeo.org
Ämne: Re: [gdal-dev] ogr2ogr for windows

Thanks Stephen,

You are right, it is available in OSGeo4W and installs nicely

  ogrinfo --formats |find "GDB"
  FileGDB -vector- (rw+): ESRI FileGDB
  OpenFileGDB -vector- (rov): ESRI FileGDB

-Jukka-

Lähettäjä: Stephen Knox <stephenknox73 at gmail.com>
Lähetetty: perjantai 18. lokakuuta 2019 14.47
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>
Kopio: gdal-dev at lists.osgeo.org
Aihe: Re: [gdal-dev] ogr2ogr for windows

I think you can install the ESRI FileGDB from OSGeo4W:

http://download.osgeo.org/osgeo4w/x86/versions.html - see gdal-filegdb

On Fri, Oct 18, 2019 at 11:49 AM jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
Hi,

You may be behind a proxy server and you must use the Advanced Install
altertative which shows you a box to feed the proxy url. However, you can't
install driver https://gdal.org/drivers/vector/filegdb.html with OSGeo4W.
Perhaps it is due to license requirements because that driver requires File
GDB API SDK from ESRI
http://appsforms.esri.com/products/download/#File_Geodatabase_API_1.3.

The other driver that you wished comes with the OSGeo4W and also with the
binaries from gisinternals.com<http://gisinternals.com>

ogrinfo --formats |find "FAA"
  AeronavFAA -vector- (rov): Aeronav FAA

It may be that you need to hire somebody to make you a special Windows build
with the ESRI fgdb. I have managed to do that through this mailing list
sometimes and at reasonable price.


-Jukka Rahkonen-


paul.malm wrote
> Thanks,
> I tried that but nothing happens when I execute the installation file. I
> don’t get any connection And a empty list appears where I can add new
> URLs?
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/98f0a2d3/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 24 23:34:50 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 25 Oct 2019 06:34:50 +0000
Subject: [gdal-dev] ogr2ogr for windows
Message-ID: <140c968618d241b5a06f3fdce599893e@C119S212VM042.msvyvi.vaha.local>

Hi,

Still no luck with OSGeo4W by using the Advanced Install alternative and then selecting to install “gdal-filegdb” from the Libs category? You wrote that you can see the dll (ogr_FileGDB.dll I guess), is it in OSGeo4W64\bin\gdalplugins like I have? If you open the OSGeo4W Shell and run command

ogrinfo --formats |find "FileGDB"

what do you see? For me it shows

FileGDB -vector- (rw+): ESRI FileGDB
OpenFileGDB -vector- (rov): ESRI FileGDB

Drivers which have some non-open license are usually not included by default. In default Linux distributions it is a no-go and vendors also require users to accept their EULA. With the OSGeo4W installer you can accept the ESRI license.
If you still have some problem send me a private mail so we can find some channel to chat and try to fix your problem.

-Jukka Rahkonen-

Lähettäjä: paul.malm at lfv.se <paul.malm at lfv.se>
Lähetetty: perjantai 25. lokakuuta 2019 8.47
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi>; stephenknox73 at gmail.com
Kopio: gdal-dev at lists.osgeo.org
Aihe: SV: [gdal-dev] ogr2ogr for windows

Hi!
It seems so easy for you guys, installing a new driver in ogr2ogr. But I haven’t found any information about how to do that in Windows.
I can see that I have the driver dll located in the gdal library….
Do I have to build the program again with Visual studio (don’t have).

Is there a reason for not having all the drivers linked in the default distribution pack?

Kind regards,
Paul

Från: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] För Rahkonen Jukka (MML)
Skickat: den 18 oktober 2019 14:03
Till: Stephen Knox
Kopia: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Ämne: Re: [gdal-dev] ogr2ogr for windows

Thanks Stephen,

You are right, it is available in OSGeo4W and installs nicely

  ogrinfo --formats |find "GDB"
  FileGDB -vector- (rw+): ESRI FileGDB
  OpenFileGDB -vector- (rov): ESRI FileGDB

-Jukka-

Lähettäjä: Stephen Knox <stephenknox73 at gmail.com<mailto:stephenknox73 at gmail.com>>
Lähetetty: perjantai 18. lokakuuta 2019 14.47
Vastaanottaja: Rahkonen Jukka (MML) <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>>
Kopio: gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
Aihe: Re: [gdal-dev] ogr2ogr for windows

I think you can install the ESRI FileGDB from OSGeo4W:

http://download.osgeo.org/osgeo4w/x86/versions.html - see gdal-filegdb

On Fri, Oct 18, 2019 at 11:49 AM jratike80 <jukka.rahkonen at maanmittauslaitos.fi<mailto:jukka.rahkonen at maanmittauslaitos.fi>> wrote:
Hi,

You may be behind a proxy server and you must use the Advanced Install
altertative which shows you a box to feed the proxy url. However, you can't
install driver https://gdal.org/drivers/vector/filegdb.html with OSGeo4W.
Perhaps it is due to license requirements because that driver requires File
GDB API SDK from ESRI
http://appsforms.esri.com/products/download/#File_Geodatabase_API_1.3.

The other driver that you wished comes with the OSGeo4W and also with the
binaries from gisinternals.com<http://gisinternals.com>

ogrinfo --formats |find "FAA"
  AeronavFAA -vector- (rov): Aeronav FAA

It may be that you need to hire somebody to make you a special Windows build
with the ESRI fgdb. I have managed to do that through this mailing list
sometimes and at reasonable price.


-Jukka Rahkonen-


paul.malm wrote
> Thanks,
> I tried that but nothing happens when I execute the installation file. I
> don’t get any connection And a empty list appears where I can add new
> URLs?
> Kind regards,
> Paul





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/d7dcce33/attachment-0001.html>

From Jon.Morris at jbarisk.com  Fri Oct 25 01:19:54 2019
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Fri, 25 Oct 2019 08:19:54 +0000
Subject: [gdal-dev] FileGDB create layer error
Message-ID: <CWXP123MB22150A0A7AC810347D6AA47582650@CWXP123MB2215.GBRP123.PROD.OUTLOOK.COM>

Hi All,

I came across an intermittent system test failure and just wanted to clarify what was going on.

While trying to add a layer to a newly-created File GDB, we got the error message: Failed at creating table for \expected_dem_mods_germany (General function failure.).

Turning on GDAL debugging gave the message:

FGDB: Did not found a match in ESRI SRS DB for layer SRS. Using morphed SRS WKT.
Failure is to be expected

The XML output below included this element:

            <WKT>PROJCS["Lambert_Azimuthal_Equal_Area",GEOGCS["GCS_GRS 1980(IUGG
, 1980)",DATUM["D_unknown",SPHEROID["GRS80",6378137,298.257222101]],PRIMEM["Gree
nwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Azimuthal_Equ
al_Area"],PARAMETER["latitude_of_origin",52],PARAMETER["central_meridian",10],PA
RAMETER["false_easting",4321000],PARAMETER["false_northing",3210000],UNIT["Meter
",1]]</WKT>

So, question 1: is this failure because the SRS is not in the Esri list of expected coordinate systems? It would not surprise me, because this is a test created from bad user data, where the SRS does not match the one they usually use.

However, question 2: why does it not fail every time? The only place we have seen this error is during a conda build on our CI server, when using Python 2. When we run tests on our local machines, or use our tool on Python 3, the layer is created OK. I want to be sure that users are not going to encounter this error, and that our tool is able to handle their data.

Thanks,

Jon

Jon Morris
Software Developer

Skype<sip:jon.morris at jbarisk.com>


T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
We've moved!
Our new postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.
No changes to our telephone numbers or e-mail addresses.

Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/92d5c23f/attachment.html>

From bojan.bizjak at mastersoft.net  Fri Oct 25 01:38:12 2019
From: bojan.bizjak at mastersoft.net (Bojan Bizjak)
Date: Fri, 25 Oct 2019 10:38:12 +0200
Subject: [gdal-dev] Ogr2ogr: export attribute data (columns row data) from
	PostGis to DXF
Message-ID: <CA+PPLZGEk-bN3=kiXPgDp46yPy2wQRkXGUqVaxijvpKpz_8Qxg@mail.gmail.com>

I can export multiple layers to sigle Dxf file without no problem using
SQL.



My question is how could attributbe data be entered into these layers using
SQL.

We are thinking in this direction that BlockAttributes should be filled and
the DXF_INLINE_BLOCKS option must be set to false.

Best regards,


Bojan Bizjak

[image: cid:image001.png at 01D4DDC4.83B4CDE0]

[image: cid:image002.png at 01D4DDC4.83B4CDE0]
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/4563f38e/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 5232 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/4563f38e/attachment-0002.png>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.png
Type: image/png
Size: 12708 bytes
Desc: not available
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/4563f38e/attachment-0003.png>

From even.rouault at spatialys.com  Fri Oct 25 01:38:51 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 25 Oct 2019 10:38:51 +0200
Subject: [gdal-dev] FileGDB create layer error
In-Reply-To: <CWXP123MB22150A0A7AC810347D6AA47582650@CWXP123MB2215.GBRP123.PROD.OUTLOOK.COM>
References: <CWXP123MB22150A0A7AC810347D6AA47582650@CWXP123MB2215.GBRP123.PROD.OUTLOOK.COM>
Message-ID: <6698598.6tl6fig3f3@even-i700>

On vendredi 25 octobre 2019 08:19:54 CEST Jon Morris wrote:
> Hi All,
> 
> I came across an intermittent system test failure and just wanted to clarify
> what was going on.
> 
> While trying to add a layer to a newly-created File GDB, we got the error
> message: Failed at creating table for \expected_dem_mods_germany (General
> function failure.).
> 
> Turning on GDAL debugging gave the message:
> 
> FGDB: Did not found a match in ESRI SRS DB for layer SRS. Using morphed SRS
> WKT. Failure is to be expected
> 
> The XML output below included this element:
> 
>             <WKT>PROJCS["Lambert_Azimuthal_Equal_Area",GEOGCS["GCS_GRS
> 1980(IUGG ,
> 1980)",DATUM["D_unknown",SPHEROID["GRS80",6378137,298.257222101]],PRIMEM["G
> ree
> nwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Azimutha
> l_Equ
> al_Area"],PARAMETER["latitude_of_origin",52],PARAMETER["central_meridian",1
> 0],PA
> RAMETER["false_easting",4321000],PARAMETER["false_northing",3210000],UNIT["
> Meter ",1]]</WKT>
> 
> So, question 1: is this failure because the SRS is not in the Esri list of
> expected coordinate systems?

Yes

> 
> However, question 2: why does it not fail every time? The only place we have
> seen this error is during a conda build on our CI server, when using Python
> 2. When we run tests on our local machines, or use our tool on Python 3,
> the layer is created OK. I want to be sure that users are not going to
> encounter this error, and that our tool is able to handle their data.

Are you sure you use the same FileGDB SDK version ? Latest versions might have 
relaxed this.
On Linux, there are (were ?) also incompatibilities due to the FileGDB SDK 
embedding libxml2, which could be of a different version than the system 
libxml2 to which GDAL might also link to, causing runtime clashes.

The joys of proprietary software...

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Fri Oct 25 02:33:11 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 25 Oct 2019 11:33:11 +0200
Subject: [gdal-dev] converting AAIGrid to SRTM
In-Reply-To: <7ff085d6-16c9-c5ea-3b4e-763049b177f7@bryanfields.net>
References: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
 <1945055.do5xzePDXr@even-i700>
 <7ff085d6-16c9-c5ea-3b4e-763049b177f7@bryanfields.net>
Message-ID: <1835047.NOmV0k60p9@even-i700>

> Is there a way to trim this to 36001x36001 before converting it to the
> 1201x1201 tiles?

the -srcwin switch of gdal_translate:
https://gdal.org/programs/gdal_translate.html

like -srcwin 11 11 36001 36001

> 
> When I run this conversion, I need an exact 1201x1201 image.  I'm also not
> sure how to verify this is correct.  My concern is if I'm a pixel off that
> is up to 90m, and now it would appear I'm 23 pixels off, or up to 2.07km.

the SRTMHGT driver should emit a warning if the extent of the input dataset 
has not the expected extent.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From Bryan at bryanfields.net  Fri Oct 25 02:40:51 2019
From: Bryan at bryanfields.net (Bryan Fields)
Date: Fri, 25 Oct 2019 05:40:51 -0400
Subject: [gdal-dev] converting AAIGrid to SRTM
In-Reply-To: <1835047.NOmV0k60p9@even-i700>
References: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
 <1945055.do5xzePDXr@even-i700>
 <7ff085d6-16c9-c5ea-3b4e-763049b177f7@bryanfields.net>
 <1835047.NOmV0k60p9@even-i700>
Message-ID: <46a438f1-6d41-4b18-cffe-d7c1b0eec19e@bryanfields.net>

On 10/25/19 5:33 AM, Even Rouault wrote:
>> Is there a way to trim this to 36001x36001 before converting it to the
>> 1201x1201 tiles?
> the -srcwin switch of gdal_translate:
> https://gdal.org/programs/gdal_translate.html
> 
> like -srcwin 11 11 36001 36001

Thanks, I'll give it a try later today.

>> When I run this conversion, I need an exact 1201x1201 image.  I'm also not
>> sure how to verify this is correct.  My concern is if I'm a pixel off that
>> is up to 90m, and now it would appear I'm 23 pixels off, or up to 2.07km.
>
> the SRTMHGT driver should emit a warning if the extent of the input dataset 
> has not the expected extent.

It doesn't :)

I get everything looking like it's working, then a row of final output tiles
of 23 x 1201 SRTM files.

I'll try it later I'm coming of a maintenance window and getting ready for bed.
-- 
Bryan Fields

727-409-1194 - Voice
http://bryanfields.net

From Jon.Morris at jbarisk.com  Fri Oct 25 02:56:58 2019
From: Jon.Morris at jbarisk.com (Jon Morris)
Date: Fri, 25 Oct 2019 09:56:58 +0000
Subject: [gdal-dev] FileGDB create layer error
In-Reply-To: <6698598.6tl6fig3f3@even-i700>
References: <CWXP123MB22150A0A7AC810347D6AA47582650@CWXP123MB2215.GBRP123.PROD.OUTLOOK.COM>
 <6698598.6tl6fig3f3@even-i700>
Message-ID: <CWXP123MB2215E19ACEF31DE9E99CA34982650@CWXP123MB2215.GBRP123.PROD.OUTLOOK.COM>

>
>
>-----Original Message-----
>From: Even Rouault <even.rouault at spatialys.com>
>Sent: 25 October 2019 09:39
>To: gdal-dev at lists.osgeo.org
>Cc: Jon Morris <Jon.Morris at jbarisk.com>
>Subject: Re: [gdal-dev] FileGDB create layer error
>
>On vendredi 25 octobre 2019 08:19:54 CEST Jon Morris wrote:
>> Hi All,
>>
>> I came across an intermittent system test failure and just wanted to
>> clarify what was going on.
>>
>> While trying to add a layer to a newly-created File GDB, we got the
>> error
>> message: Failed at creating table for \expected_dem_mods_germany
>> (General function failure.).
>>
>> Turning on GDAL debugging gave the message:
>>
>> FGDB: Did not found a match in ESRI SRS DB for layer SRS. Using
>> morphed SRS WKT. Failure is to be expected
>>
>> The XML output below included this element:
>>
>>             <WKT>PROJCS["Lambert_Azimuthal_Equal_Area",GEOGCS["GCS_GRS
>> 1980(IUGG ,
>> 1980)",DATUM["D_unknown",SPHEROID["GRS80",6378137,298.257222101]],PRIM
>> EM["G
>> ree
>> nwich",0],UNIT["Degree",0.017453292519943295]],PROJECTION["Lambert_Azi
>> mutha
>> l_Equ
>> al_Area"],PARAMETER["latitude_of_origin",52],PARAMETER["central_meridi
>> an",1
>> 0],PA
>> RAMETER["false_easting",4321000],PARAMETER["false_northing",3210000],UNIT["
>> Meter ",1]]</WKT>
>>
>> So, question 1: is this failure because the SRS is not in the Esri
>> list of expected coordinate systems?
>
>Yes
>
>>
>> However, question 2: why does it not fail every time? The only place
>> we have seen this error is during a conda build on our CI server, when
>> using Python 2. When we run tests on our local machines, or use our
>> tool on Python 3, the layer is created OK. I want to be sure that
>> users are not going to encounter this error, and that our tool is able to handle their data.
>
>Are you sure you use the same FileGDB SDK version ? Latest versions might have relaxed this.

Yes, all our builds use the same GDAL build, which uses FileGDB 1.5.1. The only failure I've seen so far is on Windows, but we'll keep an eye on it, thanks!

>
>On Linux, there are (were ?) also incompatibilities due to the FileGDB SDK embedding libxml2, which could be of a different version than the system
>libxml2 to which GDAL might also link to, causing runtime clashes.
>
>The joys of proprietary software...
>
>Even
>
>--
>Spatialys - Geospatial professional services http://www.spatialys.com
>
T +44 (0) 1756 799919
www.jbarisk.com<http://www.jbarisk.com>

[Visit our website]<http://www.jbarisk.com> [http://www.jbagroup.co.uk/imgstore/JBA-Email-Sig-Icons-LINKEDIN.png] <https://www.linkedin.com/in/jon-morris-a2897b4/>  [Follow us on Twitter] <https://twitter.com/jbarisk>
We’ve moved!
Our new postal address and registered office is JBA Risk Management Limited, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire BD23 3FD.
No changes to our telephone numbers or e-mail addresses.
Find out more about us here: www.jbarisk.com<http://www.jbarisk.com/> and follow us on Twitter @JBARisk<http://twitter.com/JBARisk> and LinkedIn<https://www.linkedin.com/company/2370847?trk=tyah&trkInfo=clickedVertical%3Acompany%2CclickedEntityId%3A2370847%2Cidx%3A2-1-2%2CtarId%3A1447414259786%2Ctas%3AJBA%20RISK%20MANAGEMENT>

The JBA Group supports the JBA Trust.

All JBA Risk Management's email messages contain confidential information and are intended only for the individual(s) named. If you are not the named addressee you should not disseminate, distribute or copy this e-mail.
Please notify the sender immediately by email if you have received this email by mistake and delete this email from your system.


JBA Risk Management Limited is registered in England, company number 07732946, 1 Broughton Park, Old Lane North, Broughton, Skipton, North Yorkshire, BD23 3FD, Telephone: +441756799919



From even.rouault at spatialys.com  Fri Oct 25 02:58:46 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Fri, 25 Oct 2019 11:58:46 +0200
Subject: [gdal-dev] converting AAIGrid to SRTM
In-Reply-To: <46a438f1-6d41-4b18-cffe-d7c1b0eec19e@bryanfields.net>
References: <733e632a-6e7c-cf30-8b45-a32db9540c99@bryanfields.net>
 <1835047.NOmV0k60p9@even-i700>
 <46a438f1-6d41-4b18-cffe-d7c1b0eec19e@bryanfields.net>
Message-ID: <54216079.Fb20h2prcF@even-i700>

> It doesn't :)

That would be surprising. See below:

Non-appropriate extent/resolution

$ gdal_translate test.tif N48E002.HGT -of srtmhgt -outsize 1201 1201 -a_srs 
EPSG:4326 -a_ullr 2 49 3 48
Input file size is 20, 20
Warning 1: The corner coordinates of the source are not properly aligned on 
plain latitude/longitude boundaries.
0...10...20...30...40...50...60...70...80...90...100 - done.

vs correct one:

$ gdal_translate test.tif N48E002.HGT -of srtmhgt -outsize 1201 1201 -a_srs 
EPSG:4326 -a_ullr 1.9995833333333333 49.0004166666666666667 
3.0004166666666666667 47.999583333333334
Input file size is 20, 20
0...10...20...30...40...50...60...70...80...90...100 - done.



-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From matt.gregory at oregonstate.edu  Fri Oct 25 09:02:57 2019
From: matt.gregory at oregonstate.edu (Gregory, Matthew)
Date: Fri, 25 Oct 2019 16:02:57 +0000
Subject: [gdal-dev] Source pixels used when warping using cubic resampling
Message-ID: <7C48E40C135D314BA03D6471A6E3897801575412FE@ex5.oregonstate.edu>

Hi all,

I am warping and upsampling an image from 4km to 30m using cubic resampling.  I've been warping different sized windows from the source image like this:

# Larger window
gdalwarp
  -t_srs EPSG:5070
  -te -2303985 2406015 -2033985 2649015
  -tr 30 30
  -of GTiff
  -r cubic
  in.vrt
  out.tif

# Single line of above window
gdalwarp
  -t_srs EPSG:5070
  -te -2303985 2648985 -2033985 2649015
  -tr 30 30
  -of GTiff
  -r cubic
  in.vrt
  line.tif

Naively, my expectation was that the overlap region would have identical values, but they don't.  I assume this means that the source (4km) pixels are being subset down to a smaller window before warping in the latter case that don't necessarily include the same 16 nearest pixels as in the first case?  I had a brief look through the Warp API tutorial and it looks like it may have something to do with the GDALSuggestedWarpOutput, but I didn't dig too deeply there.  

Is there a recommended workflow if you want to warp and resample destination rasters by blocks rather than the full extent at once?

Thanks for advice,
matt

From jukka.rahkonen at maanmittauslaitos.fi  Fri Oct 25 13:52:06 2019
From: jukka.rahkonen at maanmittauslaitos.fi (Rahkonen Jukka (MML))
Date: Fri, 25 Oct 2019 20:52:06 +0000
Subject: [gdal-dev] GDAL and monster multipolygons
Message-ID: <dfb47d4a0efd4b6e86dcc306593bddc6@C119S212VM042.msvyvi.vaha.local>

Hi,

This shapefile from the Inspire dataportal https://geospatial.jrc.ec.europa.eu/geoserver/wad/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=wad%3Alpd_int2&outputFormat=SHAPE-ZIP

contains 226 (multi)polygons, one of them with 516716 ring. It seems that ogr2ogr can't explode the geometries in a reasonable time. Spatialite-gui did the job in 2 min 30 sec with

select elementarygeometries('lpd_int2','GEOMETRY','exploded','id_1','id_2');

Perhaps GDAL could be improved as well.

-Jukka Rahkonen-
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191025/b23a0123/attachment.html>

From even.rouault at spatialys.com  Sun Oct 27 14:10:58 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Sun, 27 Oct 2019 22:10:58 +0100
Subject: [gdal-dev] GDAL and monster multipolygons
In-Reply-To: <dfb47d4a0efd4b6e86dcc306593bddc6@C119S212VM042.msvyvi.vaha.local>
References: <dfb47d4a0efd4b6e86dcc306593bddc6@C119S212VM042.msvyvi.vaha.local>
Message-ID: <5579332.6Ssc8lG4lf@even-i700>

On vendredi 25 octobre 2019 20:52:06 CET Rahkonen Jukka (MML) wrote:
> Hi,
> 
> This shapefile from the Inspire dataportal
> https://geospatial.jrc.ec.europa.eu/geoserver/wad/ows?service=WFS&version=1
> .0.0&request=GetFeature&typeName=wad%3Alpd_int2&outputFormat=SHAPE-ZIP
> 
> contains 226 (multi)polygons, one of them with 516716 ring. It seems that
> ogr2ogr can't explode the geometries in a reasonable time. Spatialite-gui
> did the job in 2 min 30 sec with
> 
> select elementarygeometries('lpd_int2','GEOMETRY','exploded','id_1','id_2');
> 
> Perhaps GDAL could be improved as well.

Indeed. I've just committed an improvement. 

ogr2ogr -explodecollections out.sqlite /vsizip/lpd_int2.zip

runs now in 6 min 50s with a debug build. The resulting file contains
3 185 596 features and weighs 778 MB. 

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From maularachmat at gmail.com  Sun Oct 27 17:00:38 2019
From: maularachmat at gmail.com (rachmat maulana)
Date: Mon, 28 Oct 2019 07:00:38 +0700
Subject: [gdal-dev] add gdal package to C
Message-ID: <CABuNC5Mijpzm0oJj2CYKEGjtOrCj33k46j=EtQYj5c9pbS8ygg@mail.gmail.com>

Hello,
I read the documentation and see there are C/C++ API for gdal,
How do I add gdal package to my compiler? (when I run "#include <gdal.h>"
it gives me an error)
I usually use python, but my professor ask me to use C/C++,
I know only a little bit of C/C++, please help

Thank You
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191028/4ec18659/attachment.html>

From mateusz at loskot.net  Sun Oct 27 23:46:19 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Mon, 28 Oct 2019 07:46:19 +0100
Subject: [gdal-dev] add gdal package to C
In-Reply-To: <CABuNC5Mijpzm0oJj2CYKEGjtOrCj33k46j=EtQYj5c9pbS8ygg@mail.gmail.com>
References: <CABuNC5Mijpzm0oJj2CYKEGjtOrCj33k46j=EtQYj5c9pbS8ygg@mail.gmail.com>
Message-ID: <CABUeae_nFHTHXKabj8469EVVVsSfYrK8xv=gpLv3YVd+7s0XEQ@mail.gmail.com>

On Mon, 28 Oct 2019, 01:00 rachmat maulana, <maularachmat at gmail.com> wrote:

> Hello,
> I read the documentation and see there are C/C++ API for gdal,
> How do I add gdal package to my compiler? (when I run "#include <gdal.h>"
> it gives me an error)
>

This is generic question how to use C++ compiler toolkit.


I usually use python, but my professor ask me to use C/C++,
>

Ask your professor for help.

I know only a little bit of C/C++, please help
>

This list does not offer help about using compilers.
You will need to read documentation of your compiler.

-- 
Mateusz Loskot, mateusz at loskot.net
(Sent from mobile, may suffer from top-posting)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191028/dc50e045/attachment.html>

From ajay39in at gmail.com  Mon Oct 28 04:42:18 2019
From: ajay39in at gmail.com (Ajay Tripathi)
Date: Mon, 28 Oct 2019 17:12:18 +0530
Subject: [gdal-dev] OSError received after update
Message-ID: <CAPxBCYZyVpmv8pauG1g8BCAV4Cr8dV_HWMh4A7Jpy2v56bVR=Q@mail.gmail.com>

Hello,

I have been using gdal on alpine for geodjango and after the recent update
on 2019-10-24 11:29:50, I am seeing the following error:

"OSError: Error relocating /usr/lib/libgdal.so.20:
_ZNSt7__cxx1119basic_ostringstreamIcSt11char_traitsIcESaIcEEC1Ev: symbol
not found"

Initially, I thought that the file doesn't exist or is corrupted, but that
doesn't seem to be the case as I re-installed everything on a different
docker container.

Secondly, I thought that a dependency needs to be updated, even after
updating all the dependencies of my software, I see the same error.

Please point me on where I should investigate to fix the error?


Best,
Ajay Tripathi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191028/704cb0dc/attachment.html>

From even.rouault at spatialys.com  Mon Oct 28 05:50:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Oct 2019 13:50:28 +0100
Subject: [gdal-dev] GDAL 3.0.2 RC1 and 2.4.3 RC1 available
Message-ID: <7054641.iGKPzIlF4R@even-i700>

Hi,

1) I have prepared a GDAL/OGR 3.0.2 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2rc1.tar.xz
  http://download.osgeo.org/gdal/3.0.2/gdal-3.0.2rc1.tar.gz
  http://download.osgeo.org/gdal/3.0.2/gdal302rc1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/3.0.2/gdalautotest-3.0.2rc1.tar.gz
  http://download.osgeo.org/gdal/3.0.2/gdalautotest-3.0.2rc1.zip

GDAL-GRASS plugin (unmodified):

    http://download.osgeo.org/gdal/3.0.2/gdal-grass-3.0.2.tar.gz

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/3.0.2-News

2) I have prepared a GDAL/OGR 2.4.3 release candidate.

Peek up an archive among the following ones (by ascending size):

  http://download.osgeo.org/gdal/2.4.3/gdal-2.4.3rc1.tar.xz
  http://download.osgeo.org/gdal/2.4.3/gdal-2.4.3rc1.tar.gz
  http://download.osgeo.org/gdal/2.4.3/gdal243rc1.zip

A snapshot of the gdalautotest suite is also available :

  http://download.osgeo.org/gdal/2.4.3/gdalautotest-2.4.3rc1.tar.gz
  http://download.osgeo.org/gdal/2.4.3/gdalautotest-2.4.3rc1.zip

GDAL-GRASS plugin (unmodified):

    http://download.osgeo.org/gdal/2.4.3/gdal-grass-2.4.3.tar.gz

The NEWS file is here :

  http://trac.osgeo.org/gdal/wiki/Release/2.4.3-News

3) I'll call for a vote promoting them to final in the middle of this week if 
no serious problems are reported before.

Best regards,

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From battisti at actgate.com  Mon Oct 28 09:50:29 2019
From: battisti at actgate.com (Andrea Battisti)
Date: Mon, 28 Oct 2019 17:50:29 +0100
Subject: [gdal-dev]  cannot open PDS files anymore
Message-ID: <22d763ca-bbfc-92e0-9f89-b488838ee298@actgate.com>

Hi,

Looks like GDAL cannot open raster data in PDS format anymore.
[tested against master few minutes ago, maybe a regression?]

gdalinfo LDEM_60N_60M_FLOAT.LBL
ERROR 4: `LDEM_60N_60M_FLOAT.LBL' not recognized as a supported file format.
gdalinfo failed - unable to open 'LDEM_60N_60M_FLOAT.LBL'.


Some more info:
-) it was working on 2.2.2 on the same data.
-) maybe it is size related ?, seems to work on smaller files, for 
example LDEM_45S_400M_FLOAT.LBL works, from the same set [*]


Any idea on what can cause this?


[*] Data files can be downloaded from:
http://imbrium.mit.edu/DATA/LOLA_GDR/POLAR/FLOAT_IMG/


-- 
Andrea Battisti
Computer Science Engineer

From chris.marsh at usask.ca  Mon Oct 28 09:55:46 2019
From: chris.marsh at usask.ca (Marsh, Chris)
Date: Mon, 28 Oct 2019 16:55:46 +0000
Subject: [gdal-dev] add gdal package to C
In-Reply-To: <CABUeae_nFHTHXKabj8469EVVVsSfYrK8xv=gpLv3YVd+7s0XEQ@mail.gmail.com>
References: <CABuNC5Mijpzm0oJj2CYKEGjtOrCj33k46j=EtQYj5c9pbS8ygg@mail.gmail.com>
 <CABUeae_nFHTHXKabj8469EVVVsSfYrK8xv=gpLv3YVd+7s0XEQ@mail.gmail.com>
Message-ID: <CAFgDerHPTeLm3HQbeOWS5cfZ42YBw=V1N7n+VRa5sp-s3-BKbA@mail.gmail.com>

As Mateusz said, impossible to help without knowing your environment. I do not wish to turn this into a long email chain helping you compile against a static library as that's not what this list is for.

however, gdal is linked against link any other static library.

For example:
https://www3.ntu.edu.sg/home/ehchua/programming/cpp/gcc_make.html#zz-1.8

For how to link against a static library and set the include path. If you really end up stuck, go take a look at StackOverflow, there are others asking similar questions there. Good luck!

Cheers
Chris

On Mon, Oct 28, 2019 at 12:46 AM Mateusz Loskot <mateusz at loskot.net<mailto:mateusz at loskot.net>> wrote:
CAUTION: This email originated from outside of the University of Saskatchewan. Do not click links or open attachments unless you recognize the sender and know the content is safe. If in doubt, please forward suspicious emails to phishing at usask.ca<mailto:phishing at usask.ca>

On Mon, 28 Oct 2019, 01:00 rachmat maulana, <maularachmat at gmail.com<mailto:maularachmat at gmail.com>> wrote:
Hello,
I read the documentation and see there are C/C++ API for gdal,
How do I add gdal package to my compiler? (when I run "#include <gdal.h>" it gives me an error)

This is generic question how to use C++ compiler toolkit.


I usually use python, but my professor ask me to use C/C++,

Ask your professor for help.

I know only a little bit of C/C++, please help

This list does not offer help about using compilers.
You will need to read documentation of your compiler.

--
Mateusz Loskot, mateusz at loskot.net<mailto:mateusz at loskot.net>
(Sent from mobile, may suffer from top-posting)

_______________________________________________
gdal-dev mailing list
gdal-dev at lists.osgeo.org<mailto:gdal-dev at lists.osgeo.org>
https://lists.osgeo.org/mailman/listinfo/gdal-dev




-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191028/17741ab2/attachment-0001.html>

From even.rouault at spatialys.com  Mon Oct 28 13:59:05 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Mon, 28 Oct 2019 21:59:05 +0100
Subject: [gdal-dev] cannot open PDS files anymore
In-Reply-To: <22d763ca-bbfc-92e0-9f89-b488838ee298@actgate.com>
References: <22d763ca-bbfc-92e0-9f89-b488838ee298@actgate.com>
Message-ID: <6005248.QZHvul4ksH@even-i700>

> Any idea on what can cause this?

Fixed per
https://github.com/OSGeo/gdal/commit/0a3718f24232e863ed72cc114d3737b7af318f47
(backported to 3.0 and 2.4 as well)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From benespepa at gmail.com  Tue Oct 29 00:09:51 2019
From: benespepa at gmail.com (=?UTF-8?Q?Pepa_Bene=C5=A1?=)
Date: Tue, 29 Oct 2019 08:09:51 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead holes
In-Reply-To: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
Message-ID: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>

HI,

I recieved one shapefile. Gdal / Grass / QGIS finds two geometry errors in
it. Other GIS SW (ArcMap, MapInfo (via Universal translator or opening shp
natively)) theay can't see this geometries as errors. Instead errors they
can see regular multipolygons with holes there. Author of this shp wants to
see holes there too = in his opinion there are correct data only.

Please, write me, how to work with such geometries in gdal / grass / QGIS /
geos world to see holes too, instead errors?

In geometry_problem.zip
<https://drive.google.com/file/d/1oRJQVKYDkZji-GLmobov995m9vF00vwf> there
are:

geometry_problem.qgz .. vizualization in QGIS

original.shp .. original data prepared in ESRI
original_esri.png .. original.shp seen in ArcMap (With holes. Author of shp
wants have holes there.)

original_errors.shp .. geometry errors prepared by "QGIS Desktop 3.8.3 with
GRASS 7.6.1"
original_qgis.png .. original.shp seen in QGIS

MI/original_to_MI_by_UN.tab .. original.shp translated from shp to tab by
MapInfo - UniversalTranslator (tried defferent versions with the same
results).

Thanks
Pepa Beneš
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/01af6573/attachment.html>

From caboe at sdfe.dk  Tue Oct 29 01:19:45 2019
From: caboe at sdfe.dk (=?utf-8?B?Q2FzcGVyIELDuHJnZXNlbg==?=)
Date: Tue, 29 Oct 2019 08:19:45 +0000
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
Message-ID: <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>

Hi Pepa

I have tried loading and exporting the multipolygons as WKT using OGR/python and it looks like the holes are interpreted as polygons.

FME displays the data (correctly?) with holes and its validation engine doesn’t find any errors. BUT a year ago I sent a bug report to SAFE because FME did some automatic geometry repair when loading data => the various programs could be fixing issues automatic which means you won’t see them. Not to imply that ESRI does automatic geometry repair in the background, but which program can you definitely trust to correctly represent the contents of your data set?

I tend to trust GDAL/OGR (which means I also trust QGIS) because its open source and the developers are normally pretty good at reporting back how the software treats data.

My reply doesn’t fix your problem though, just a few thoughts from me.

Regards, Casper

From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Pepa Beneš
Sent: 29. oktober 2019 08:10
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead holes

HI,

I recieved one shapefile. Gdal / Grass / QGIS finds two geometry errors in it. Other GIS SW (ArcMap, MapInfo (via Universal translator or opening shp natively)) theay can't see this geometries as errors. Instead errors they can see regular multipolygons with holes there. Author of this shp wants to see holes there too = in his opinion there are correct data only.

Please, write me, how to work with such geometries in gdal / grass / QGIS / geos world to see holes too, instead errors?

In geometry_problem.zip<https://drive.google.com/file/d/1oRJQVKYDkZji-GLmobov995m9vF00vwf> there are:

geometry_problem.qgz .. vizualization in QGIS

original.shp .. original data prepared in ESRI
original_esri.png .. original.shp seen in ArcMap (With holes. Author of shp wants have holes there.)

original_errors.shp .. geometry errors prepared by "QGIS Desktop 3.8.3 with GRASS 7.6.1"
original_qgis.png .. original.shp seen in QGIS

MI/original_to_MI_by_UN.tab .. original.shp translated from shp to tab by MapInfo - UniversalTranslator (tried defferent versions with the same results).

Thanks
Pepa Beneš
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/3de56ade/attachment.html>

From deduikertjes at xs4all.nl  Tue Oct 29 02:18:09 2019
From: deduikertjes at xs4all.nl (Marco)
Date: Tue, 29 Oct 2019 10:18:09 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
Message-ID: <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>

Hi,

Validity checks don't check the file format. They check the validity of 
the geometries once they are read from the file into the software.

The shape file format is a partly documented format. It is very easy to 
write a shape file which is not according to the specs. To my experience 
ESRI software will do that every now and again. Very probably you have 
one of those shape files.

You might ask the person who created the files to:
- buffer the geometries with a distance of 0 and the save the resulting 
file again.
- and/or export to a different file format (eg geopackage)

Regards, MArco

On 29-10-19 09:19, Casper Børgesen wrote:
>
> Hi Pepa
>
> I have tried loading and exporting the multipolygons as WKT using 
> OGR/python and it looks like the holes are interpreted as polygons.
>
> FME displays the data (correctly?) with holes and its validation 
> engine doesn’t find any errors. BUT a year ago I sent a bug report to 
> SAFE because FME did some automatic geometry repair when loading data 
> => the various programs could be fixing issues automatic which means 
> you won’t see them. Not to imply that ESRI does automatic geometry 
> repair in the background, but which program can you definitely trust 
> to correctly represent the contents of your data set?
>
> I tend to trust GDAL/OGR (which means I also trust QGIS) because its 
> open source and the developers are normally pretty good at reporting 
> back how the software treats data.
>
> My reply doesn’t fix your problem though, just a few thoughts from me.
>
> Regards, Casper
>
> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of *Pepa 
> Beneš
> *Sent:* 29. oktober 2019 08:10
> *To:* gdal-dev at lists.osgeo.org
> *Subject:* [gdal-dev] Fwd: Gdal - multipolygon - geometry errors 
> instead holes
>
> HI,
>
> I recieved one shapefile. Gdal / Grass / QGIS finds two geometry 
> errors in it. Other GIS SW (ArcMap, MapInfo (via Universal translator 
> or opening shp natively)) theay can't see this geometries as errors. 
> Instead errors they can see regular multipolygons with holes there. 
> Author of this shp wants to see holes there too = in his opinion there 
> are correct data only.
>
> Please, write me, how to work with such geometries in gdal / grass / 
> QGIS / geos world to see holes too, instead errors?
>
> In geometry_problem.zip 
> <https://drive.google.com/file/d/1oRJQVKYDkZji-GLmobov995m9vF00vwf> 
> there are:
>
> geometry_problem.qgz .. vizualization in QGIS
>
> original.shp .. original data prepared in ESRI
> original_esri.png .. original.shp seen in ArcMap (With holes. Author 
> of shp wants have holes there.)
>
> original_errors.shp .. geometry errors prepared by "QGIS Desktop 3.8.3 
> with GRASS 7.6.1"
> original_qgis.png .. original.shp seen in QGIS
>
> MI/original_to_MI_by_UN.tab .. original.shp translated from shp to tab 
> by MapInfo - UniversalTranslator (tried defferent versions with the 
> same results).
>
> Thanks
>
> Pepa Beneš
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/14bc67a5/attachment-0001.html>

From tobias.wendorff at tu-dortmund.de  Tue Oct 29 02:37:19 2019
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Tue, 29 Oct 2019 10:37:19 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
Message-ID: <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>

No! Please NEVER buffer with 0.

There are tons of tests on the web that proof that this recommendation of 1980ies GIS experts is destroying data.

There are modern feature, like „fix geometries“ in GEOS and others (pprepair).

We really need the web to forget about this recommendation.

— 
Von einem iPhone gesendet und wird daher Fehler enthalten.

> Am 29.10.2019 um 10:18 schrieb Marco <deduikertjes at xs4all.nl>:
> 
> Hi,
> 
> Validity checks don't check the file format. They check the validity of the geometries once they are read from the file into the software.
> 
> The shape file format is a partly documented format. It is very easy to write a shape file which is not according to the specs. To my experience ESRI software will do that every now and again. Very probably you have one of those shape files.
> 
> You might ask the person who created the files to:
> - buffer the geometries with a distance of 0 and the save the resulting file again.
> - and/or export to a different file format (eg geopackage)
> 
> Regards, MArco
> 
>> On 29-10-19 09:19, Casper Børgesen wrote:
>> Hi Pepa
>>  
>> I have tried loading and exporting the multipolygons as WKT using OGR/python and it looks like the holes are interpreted as polygons.
>>  
>> FME displays the data (correctly?) with holes and its validation engine doesn’t find any errors. BUT a year ago I sent a bug report to SAFE because FME did some automatic geometry repair when loading data => the various programs could be fixing issues automatic which means you won’t see them. Not to imply that ESRI does automatic geometry repair in the background, but which program can you definitely trust to correctly represent the contents of your data set?
>>  
>> I tend to trust GDAL/OGR (which means I also trust QGIS) because its open source and the developers are normally pretty good at reporting back how the software treats data.
>>  
>> My reply doesn’t fix your problem though, just a few thoughts from me.
>>  
>> Regards, Casper
>>  
>> From: gdal-dev <gdal-dev-bounces at lists.osgeo.org> On Behalf Of Pepa Beneš
>> Sent: 29. oktober 2019 08:10
>> To: gdal-dev at lists.osgeo.org
>> Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead holes
>>  
>> HI, 
>>  
>> I recieved one shapefile. Gdal / Grass / QGIS finds two geometry errors in it. Other GIS SW (ArcMap, MapInfo (via Universal translator or opening shp natively)) theay can't see this geometries as errors. Instead errors they can see regular multipolygons with holes there. Author of this shp wants to see holes there too = in his opinion there are correct data only.   
>> 
>> Please, write me, how to work with such geometries in gdal / grass / QGIS / geos world to see holes too, instead errors?
>> 
>> In geometry_problem.zip there are:
>> 
>> geometry_problem.qgz .. vizualization in QGIS
>> 
>> original.shp .. original data prepared in ESRI
>> original_esri.png .. original.shp seen in ArcMap (With holes. Author of shp wants have holes there.)
>> 
>> original_errors.shp .. geometry errors prepared by "QGIS Desktop 3.8.3 with GRASS 7.6.1"
>> original_qgis.png .. original.shp seen in QGIS
>> 
>> MI/original_to_MI_by_UN.tab .. original.shp translated from shp to tab by MapInfo - UniversalTranslator (tried defferent versions with the same results).
>>  
>> Thanks 
>> Pepa Beneš
>> 
>> 
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
> 
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/22de7275/attachment.html>

From deduikertjes at xs4all.nl  Tue Oct 29 02:49:48 2019
From: deduikertjes at xs4all.nl (Marco)
Date: Tue, 29 Oct 2019 10:49:48 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
Message-ID: <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>

Tobias,

Buffer 0 (by the creator of the dataset) is there to prevent that VALID 
geometries being written to the shapefile in an INVALID way.

Buffer 0 on VALID geometries should IMHO never lead to data loss.

Buffer 0 on INVALID geometries IMHO can lead to good results depending 
on the nature of the invalidity. To my experience repeating points, 
wrong coordinate ordering and holes touching outer shells in one point 
are being repaired well without data loss.

Please enlighten me with a few links to the tons of tests on the web 
showing that buffer 0 is destroying data. My Google skills are not up to it.

Regards, Marco

On 29-10-19 10:37, Tobias Wendorff wrote:
> No! Please NEVER buffer with 0.
>
> There are tons of tests on the web that proof that this recommendation 
> of 1980ies GIS experts is destroying data.
>
> There are modern feature, like „fix geometries“ in GEOS and others 
> (pprepair).
>
> We really need the web to forget about this recommendation.
>
> —
> Von einem iPhone gesendet und wird daher Fehler enthalten.
>
> Am 29.10.2019 um 10:18 schrieb Marco <deduikertjes at xs4all.nl 
> <mailto:deduikertjes at xs4all.nl>>:
>
>> Hi,
>>
>> Validity checks don't check the file format. They check the validity 
>> of the geometries once they are read from the file into the software.
>>
>> The shape file format is a partly documented format. It is very easy 
>> to write a shape file which is not according to the specs. To my 
>> experience ESRI software will do that every now and again. Very 
>> probably you have one of those shape files.
>>
>> You might ask the person who created the files to:
>> - buffer the geometries with a distance of 0 and the save the 
>> resulting file again.
>> - and/or export to a different file format (eg geopackage)
>>
>> Regards, MArco
>>
>> On 29-10-19 09:19, Casper Børgesen wrote:
>>>
>>> Hi Pepa
>>>
>>> I have tried loading and exporting the multipolygons as WKT using 
>>> OGR/python and it looks like the holes are interpreted as polygons.
>>>
>>> FME displays the data (correctly?) with holes and its validation 
>>> engine doesn’t find any errors. BUT a year ago I sent a bug report 
>>> to SAFE because FME did some automatic geometry repair when loading 
>>> data => the various programs could be fixing issues automatic which 
>>> means you won’t see them. Not to imply that ESRI does automatic 
>>> geometry repair in the background, but which program can you 
>>> definitely trust to correctly represent the contents of your data set?
>>>
>>> I tend to trust GDAL/OGR (which means I also trust QGIS) because its 
>>> open source and the developers are normally pretty good at reporting 
>>> back how the software treats data.
>>>
>>> My reply doesn’t fix your problem though, just a few thoughts from me.
>>>
>>> Regards, Casper
>>>
>>> *From:*gdal-dev <gdal-dev-bounces at lists.osgeo.org> *On Behalf Of 
>>> *Pepa Beneš
>>> *Sent:* 29. oktober 2019 08:10
>>> *To:* gdal-dev at lists.osgeo.org
>>> *Subject:* [gdal-dev] Fwd: Gdal - multipolygon - geometry errors 
>>> instead holes
>>>
>>> HI,
>>>
>>> I recieved one shapefile. Gdal / Grass / QGIS finds two geometry 
>>> errors in it. Other GIS SW (ArcMap, MapInfo (via Universal 
>>> translator or opening shp natively)) theay can't see this geometries 
>>> as errors. Instead errors they can see regular multipolygons with 
>>> holes there. Author of this shp wants to see holes there too = in 
>>> his opinion there are correct data only.
>>>
>>> Please, write me, how to work with such geometries in gdal / grass / 
>>> QGIS / geos world to see holes too, instead errors?
>>>
>>> In geometry_problem.zip 
>>> <https://drive.google.com/file/d/1oRJQVKYDkZji-GLmobov995m9vF00vwf> 
>>> there are:
>>>
>>> geometry_problem.qgz .. vizualization in QGIS
>>>
>>> original.shp .. original data prepared in ESRI
>>> original_esri.png .. original.shp seen in ArcMap (With holes. Author 
>>> of shp wants have holes there.)
>>>
>>> original_errors.shp .. geometry errors prepared by "QGIS Desktop 
>>> 3.8.3 with GRASS 7.6.1"
>>> original_qgis.png .. original.shp seen in QGIS
>>>
>>> MI/original_to_MI_by_UN.tab .. original.shp translated from shp to 
>>> tab by MapInfo - UniversalTranslator (tried defferent versions with 
>>> the same results).
>>>
>>> Thanks
>>>
>>> Pepa Beneš
>>>
>>>
>>> _______________________________________________
>>> gdal-dev mailing list
>>> gdal-dev at lists.osgeo.org
>>> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>>
>> _______________________________________________
>> gdal-dev mailing list
>> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
>> https://lists.osgeo.org/mailman/listinfo/gdal-dev

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/82cf5748/attachment-0001.html>

From jukka.rahkonen at maanmittauslaitos.fi  Tue Oct 29 03:31:10 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 29 Oct 2019 03:31:10 -0700 (MST)
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
References: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
Message-ID: <1572345070086-0.post@n6.nabble.com>


Hi,

Your case is a bit hard to analyze with end users tools, probably low level
study about how the shapefile driver or GEOS works is needed.

The problematic geometry is a rather big multipolygon and it can be found
with ogrinfo 

ogrinfo -dialect sqlite -sql "select *, ST_IsValidReason(geometry) from
original where st_isvalid(geometry)=0" original.shp

The geometry is the Nested Shells case.

I opened the same shapefile with OpenJUMP and it shows that certain
multipolygon part with a hole. The QA tool, that is based on JTS does not
show topology errors. I saved the layer into a) shapefile and b) into JUMP
jml format with OpenJUMP and repeated the test with ogrinfo and
IsValidReason. The shapefile seems to contain an invalid geometry while jml
file not.

It seems that the shapefile driver has some issue with reading that
geometry. OpenJUMP considers that the geometry is OK both when reading and
writing.

I deleted manually parts from the multipolygon by utilizing the Select Parts
tool of OpenJUMP and managed to shrink the error into this shapefile
http://latuviitta.org/downloads/just_error.zip that contains only this one
geometry

MULTIPOLYGON ((( -504655.0000000044 -1116885.8500000022, -504655.0000000044
-1116887.8499999985, -504653.0000000006 -1116887.8499999985,
-504653.0000000006 -1116889.8500000024, -504651.0000000043
-1116889.8500000024, -504651.0000000043 -1116891.8499999987,
-504641.00000000035 -1116891.8499999987, -504641.00000000035
-1116893.8500000024, -504637.00000000023 -1116893.8500000024,
-504637.00000000023 -1116895.8499999987, -504635.00000000396
-1116895.8499999987, -504635.00000000396 -1116897.8500000024,
-504633.0000000002 -1116897.8500000024, -504633.0000000002
-1116899.8499999987, -504629.00000000006 -1116899.8499999987,
-504629.00000000006 -1116901.8500000027, -504625 -1116901.8500000027,
-504625 -1116903.849999999, -504623.00000000367 -1116903.849999999,
-504623.00000000367 -1116905.8500000027, -504616.99999999977
-1116905.8500000027, -504616.99999999977 -1116907.849999999,
-504615.0000000035 -1116907.849999999, -504615.0000000035
-1116909.8500000027, -504611.0000000034 -1116909.8500000027,
-504611.0000000034 -1116911.8499999992, -504609.0000000071
-1116911.8499999992, -504609.0000000071 -1116913.850000003,
-504607.0000000033 -1116913.850000003, -504607.0000000033
-1116915.8499999992, -504605.000000007 -1116915.8499999992,
-504605.000000007 -1116917.850000003, -504607.0000000033 -1116917.850000003,
-504607.0000000033 -1116925.8500000031, -504609.0000000071
-1116925.8500000031, -504609.0000000071 -1116927.8499999994,
-504613.0000000072 -1116927.8499999994, -504613.0000000072
-1116929.8500000031, -504616.99999999977 -1116929.8500000031,
-504616.99999999977 -1116931.8499999996, -504620.9999999999
-1116931.8499999996, -504620.9999999999 -1116933.8500000034, -504625
-1116933.8500000034, -504625 -1116935.8499999996, -504629.00000000006
-1116935.8499999996, -504629.00000000006 -1116937.8500000034,
-504633.0000000002 -1116937.8500000034, -504633.0000000002
-1116939.8499999996, -504637.00000000023 -1116939.8499999996,
-504637.00000000023 -1116941.8500000036, -504641.00000000035
-1116941.8500000036, -504641.00000000035 -1116943.8499999999,
-504645.0000000004 -1116943.8499999999, -504645.0000000004
-1116945.8500000036, -504649.0000000005 -1116945.8500000036,
-504649.0000000005 -1116947.8499999999, -504653.0000000006
-1116947.8499999999, -504653.0000000006 -1116949.8500000036,
-504657.0000000007 -1116949.8500000036, -504657.0000000007
-1116951.8499999999, -504661.0000000008 -1116951.8499999999,
-504661.0000000008 -1116953.8500000038, -504665.0000000009
-1116953.8500000038, -504665.0000000009 -1116955.85, -504667.00000000466
-1116955.85, -504667.00000000466 -1116953.8500000038, -504671.0000000048
-1116953.8500000038, -504671.0000000048 -1116955.85, -504675.00000000483
-1116955.85, -504675.00000000483 -1116957.8500000038, -504679.00000000495
-1116957.8500000038, -504679.00000000495 -1116959.85, -504685.00000000134
-1116959.85, -504685.00000000134 -1116951.8499999999, -504687.0000000051
-1116951.8499999999, -504687.0000000051 -1116939.8499999996,
-504689.0000000014 -1116939.8499999996, -504689.0000000014
-1116931.8499999996, -504691.0000000052 -1116931.8499999996,
-504691.0000000052 -1116923.8499999994, -504697.00000000163
-1116923.8499999994, -504697.00000000163 -1116921.8500000031,
-504695.0000000053 -1116921.8500000031, -504695.0000000053
-1116919.8499999992, -504693.0000000015 -1116919.8499999992,
-504693.0000000015 -1116913.850000003, -504691.0000000052
-1116913.850000003, -504691.0000000052 -1116911.8499999992,
-504689.0000000014 -1116911.8499999992, -504689.0000000014
-1116909.8500000027, -504687.0000000051 -1116909.8500000027,
-504687.0000000051 -1116905.8500000027, -504685.00000000134
-1116905.8500000027, -504685.00000000134 -1116903.849999999,
-504681.0000000012 -1116903.849999999, -504681.0000000012
-1116901.8500000027, -504679.00000000495 -1116901.8500000027,
-504679.00000000495 -1116899.8499999987, -504677.00000000116
-1116899.8499999987, -504677.00000000116 -1116897.8500000024,
-504675.00000000483 -1116897.8500000024, -504675.00000000483
-1116895.8499999987, -504673.00000000105 -1116895.8499999987,
-504673.00000000105 -1116893.8500000024, -504671.0000000048
-1116893.8500000024, -504671.0000000048 -1116891.8499999987,
-504667.00000000466 -1116891.8499999987, -504667.00000000466
-1116889.8500000024, -504665.0000000009 -1116889.8500000024,
-504665.0000000009 -1116887.8499999985, -504663.0000000046
-1116887.8499999985, -504663.0000000046 -1116885.8500000022,
-504655.0000000044 -1116885.8500000022 )), (( -504639.000000004
-1117208.2426935502, -504644.9999583359 -1117209.850155481,
-504645.0000000004 -1117207.8499999982, -504651.0000000043
-1117207.8499999982, -504651.0000000043 -1117203.8499999982,
-504653.0000000006 -1117203.8499999982, -504653.0000000006
-1117201.850000002, -504657.0000000007 -1117201.850000002,
-504657.0000000007 -1117203.8499999982, -504659.0000000045
-1117203.8499999982, -504659.0000000045 -1117201.850000002,
-504665.0000000009 -1117201.850000002, -504665.0000000009
-1117197.8500000017, -504663.0000000046 -1117197.8500000017,
-504663.0000000046 -1117195.849999998, -504661.0000000008
-1117195.849999998, -504661.0000000008 -1117193.8500000017,
-504659.0000000045 -1117193.8500000017, -504659.0000000045
-1117191.849999998, -504657.0000000007 -1117191.849999998,
-504657.0000000007 -1117189.8500000015, -504655.0000000044
-1117189.8500000015, -504655.0000000044 -1117185.8500000015,
-504657.0000000007 -1117185.8500000015, -504657.0000000007
-1117183.8499999978, -504655.0000000044 -1117183.8499999978,
-504655.0000000044 -1117179.8499999975, -504653.0000000006
-1117179.8499999975, -504653.0000000006 -1117181.8500000015,
-504647.0000000042 -1117181.8500000015, -504647.0000000042
-1117177.8500000013, -504645.0000000004 -1117177.8500000013,
-504645.0000000004 -1117175.8499999975, -504643.00000000413
-1117175.8499999975, -504643.00000000413 -1117177.8500000013,
-504641.00000000035 -1117177.8500000013, -504641.00000000035
-1117179.8499999975, -504637.00000000023 -1117179.8499999975,
-504637.00000000023 -1117183.8499999978, -504635.00000000396
-1117183.8499999978, -504635.00000000396 -1117187.8499999978,
-504631.00000000384 -1117187.8499999978, -504631.00000000384
-1117189.8500000015, -504633.0000000002 -1117189.8500000015,
-504633.0000000002 -1117193.8500000017, -504627.0000000038
-1117193.8500000017, -504627.0000000038 -1117199.849999998,
-504629.00000000006 -1117199.849999998, -504629.00000000006
-1117201.850000002, -504627.0000000038 -1117201.850000002,
-504627.0000000038 -1117203.8499999982, -504631.00000000384
-1117203.8499999982, -504631.00000000384 -1117205.850000002,
-504637.00000000023 -1117205.850000002, -504637.00000000023
-1117207.8499999982, -504639.000000004 -1117207.8499999982,
-504639.000000004 -1117208.2426935502 ), ( -504633.0000000002
-1117201.850000002, -504633.0000000002 -1117199.849999998,
-504635.00000000396 -1117199.849999998, -504635.00000000396
-1117201.850000002, -504633.0000000002 -1117201.850000002 )))


Let's see if the case in now simple enough so that some developer can tell
us why the just_error shapefile is reported to have nested shells.

-Jukka Rahkonen-





Pepa Beneš wrote
> HI,
> 
> I recieved one shapefile. Gdal / Grass / QGIS finds two geometry errors in
> it. Other GIS SW (ArcMap, MapInfo (via Universal translator or opening shp
> natively)) theay can't see this geometries as errors. Instead errors they
> can see regular multipolygons with holes there. Author of this shp wants
> to
> see holes there too = in his opinion there are correct data only.
> 
> Please, write me, how to work with such geometries in gdal / grass / QGIS
> /
> geos world to see holes too, instead errors?
> 
> In geometry_problem.zip
> &lt;https://drive.google.com/file/d/1oRJQVKYDkZji-GLmobov995m9vF00vwf&gt;
> there
> are:
> 
> geometry_problem.qgz .. vizualization in QGIS
> 
> original.shp .. original data prepared in ESRI
> original_esri.png .. original.shp seen in ArcMap (With holes. Author of
> shp
> wants have holes there.)
> 
> original_errors.shp .. geometry errors prepared by "QGIS Desktop 3.8.3
> with
> GRASS 7.6.1"
> original_qgis.png .. original.shp seen in QGIS
> 
> MI/original_to_MI_by_UN.tab .. original.shp translated from shp to tab by
> MapInfo - UniversalTranslator (tried defferent versions with the same
> results).
> 
> Thanks
> Pepa Beneš
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Tue Oct 29 05:32:31 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Tue, 29 Oct 2019 05:32:31 -0700 (MST)
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <1572345070086-0.post@n6.nabble.com>
References: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <1572345070086-0.post@n6.nabble.com>
Message-ID: <1572352351922-0.post@n6.nabble.com>

Interesting observation is that if I read the WKT into QGIS with the Quick
WKT plugin, then save the layer into shapefile, and finally open the
shapefile that QGIS saved back to the project, the hole has disappeared and
there is a topology error instead. It means that QGIS can create a shapefile
that it considers invalid itself.

-Jukka Rahkonen-


jratike80 wrote
> I deleted manually parts from the multipolygon by utilizing the Select
> Parts
> tool of OpenJUMP and managed to shrink the error into this shapefile
> http://latuviitta.org/downloads/just_error.zip that contains only this one
> geometry
> 
> MULTIPOLYGON ((( -504655.0000000044 -1116885.8500000022,
> -504655.0000000044
> ....





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From andrew.bell.ia at gmail.com  Tue Oct 29 05:45:58 2019
From: andrew.bell.ia at gmail.com (Andrew Bell)
Date: Tue, 29 Oct 2019 08:45:58 -0400
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <1572352351922-0.post@n6.nabble.com>
References: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <1572345070086-0.post@n6.nabble.com> <1572352351922-0.post@n6.nabble.com>
Message-ID: <CACJ51z36jMChuU00=FZ3c-DjwCZuTW7k=30QUPNjxbEHOsRENA@mail.gmail.com>

I don't know if this is relevant, but WKT doesn't support "islands" -- you
can't have positive space inside negative space in one polygon. Islands
must be represented as separate polygons within a multipolygon.

On Tue, Oct 29, 2019, 08:32 jratike80 <jukka.rahkonen at maanmittauslaitos.fi>
wrote:

> Interesting observation is that if I read the WKT into QGIS with the Quick
> WKT plugin, then save the layer into shapefile, and finally open the
> shapefile that QGIS saved back to the project, the hole has disappeared and
> there is a topology error instead. It means that QGIS can create a
> shapefile
> that it considers invalid itself.
>
> -Jukka Rahkonen-
>
>
> jratike80 wrote
> > I deleted manually parts from the multipolygon by utilizing the Select
> > Parts
> > tool of OpenJUMP and managed to shrink the error into this shapefile
> > http://latuviitta.org/downloads/just_error.zip that contains only this
> one
> > geometry
> >
> > MULTIPOLYGON ((( -504655.0000000044 -1116885.8500000022,
> > -504655.0000000044
> > ....
>
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/c890afda/attachment.html>

From Roger.Bivand at nhh.no  Tue Oct 29 07:30:41 2019
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Oct 2019 15:30:41 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
Message-ID: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>

In looking at ways to adapt R packages rgdal and sf to current GDAL and 
PROJ, I have run into a problem. Many existing vector files (I have not 
yet looked at raster) include a datum declaration, which is still present 
internally in the OGRSpatialReference object, but is dropped in the output 
of exportToProj4().

I realise that datums are not a good idea going forward, but the 
consequence is a regression from PROJ 4 and GDAL 2 where transformation 
could rely on the +datum tag being in the PROJ string. A use case with 
b_pump.* (in reprex.zip) is used in 
https://github.com/r-spatial/sf/issues/1146 and linking to discussion on 
https://github.com/r-spatial/discuss/issues/28. I have not looked at other 
drivers than ESRI Shapefile yet, I'd need to generate fresh examples that 
were definitely created on a PROJ 4 / GDAL 2 system.

The point (John Snow's Broad Street pump) used to land on Web Mercator 
close to the right place, but because the datum is dropped on export to 
PROJ, transformation is only with ballpark accuracy now. I can see that 
proj_to_proj_string() gets called, but do not see any options providing 
backward compatibility (what to do if a deprecated tag is not empty).

Using GetAttrValue("DATUM"), I can alert users who bother to see warnings 
that something has happened requiring their attention, but am I missing a 
CPL option or other remedy already in place?

Optional interpolation from GDALs gt_datum.csv or similar would perhaps 
help, inserting a +towgs84 tag, but I do not have a clear view how to make 
the migration process for users easier. In any case, they will need to 
provide an EPSG or urn or similar look-up string in the future, but this 
isn't predictably stored or retrievable.

Grateful for input,

Roger

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From even.rouault at spatialys.com  Tue Oct 29 07:59:22 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Oct 2019 15:59:22 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
Message-ID: <11086630.p102ApzHzd@even-i700>

Roger,

> In looking at ways to adapt R packages rgdal and sf to current GDAL and
> PROJ, I have run into a problem. Many existing vector files (I have not
> yet looked at raster) include a datum declaration, which is still present
> internally in the OGRSpatialReference object, but is dropped in the output
> of exportToProj4().
> [...] 
> Using GetAttrValue("DATUM"), I can alert users who bother to see warnings
> that something has happened requiring their attention, but am I missing a
> CPL option or other remedy already in place?

No, you don't miss anything. PROJ 6 makes less efforts than previous verions 
to export a +datum= string. This is more or less intended so that people move 
away from PROJ strings to represent CRS because they suffer from a number of 
limitations (its hardcoded list of datums is very limited compared to what is 
available in EPSG, axis order issues, etc.). That particular use case could 
potentially be improved as +datum=OSGB36 is known of PROJ on the import side, 
but you'd get anyway into troubles with other datums.
If you use directly the WKT representation from this .prj file with PROJ 
functions that deal with coordinate transformations (or the 
OGRSpatialReference object with GDAL functions), things should work smoothly.

> Optional interpolation from GDALs gt_datum.csv or similar would perhaps
> help, inserting a +towgs84 tag, but I do not have a clear view how to make
> the migration process for users easier.

The towgs84 concept is also a fragile and a limited one. There might be 
several potential towgs84 transformations and this assumes you transforms 
from/to WGS84. That said the method OGRSpatialReference::importFromEPSG() will 
use internally proj_crs_create_bound_crs_to_WGS84() to try finding a TOWGS84 
transform. But this will only work if there's a single candidate. In case of 
multiple candidates, it will not select an artibtrary one like previous GDAL / 
PROJ versions did.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tobias.wendorff at tu-dortmund.de  Tue Oct 29 11:35:22 2019
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Tue, 29 Oct 2019 19:35:22 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
 <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
Message-ID: <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>

Hi Marco,

Am 29.10.2019 um 10:49 schrieb Marco:
> Buffer 0 on INVALID geometries IMHO can lead to good results depending
> on the nature of the invalidity. To my experience repeating points,
> wrong coordinate ordering and holes touching outer shells in one point
> are being repaired well without data loss.

I'm sorry to say that the side effects are worse. Maybe the
implementation of QGIS is wrong, but try the example below.

> Please enlighten me with a few links to the tons of tests on the web
> showing that buffer 0 is destroying data. My Google skills are not up to it.

I've just updated the example I'm normally showing students with an
actual thematic, I'm calling in "wronxit": [1]

Try to "buffer(geom, 0)" it in QGIS...

This problem isn't constructed (well, this geojson is of course), but
I'm got lots of self-intersecting polygons from different sources all
the time. "Buffer 0" is destructive here and since many
self-intersections are damn small, most users simply don't see them.

"Fix Geometries" gives the correct result.

Best regards,
Tobias

references:
[1] https://gist.github.com/tobwen/39bc3562d1cb957cbaf4305ef53f77df

From Roger.Bivand at nhh.no  Tue Oct 29 12:32:26 2019
From: Roger.Bivand at nhh.no (Roger Bivand)
Date: Tue, 29 Oct 2019 20:32:26 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <11086630.p102ApzHzd@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
Message-ID: <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>

Even,

Thanks!

On Tue, 29 Oct 2019, Even Rouault wrote:

> Roger,
>
>> In looking at ways to adapt R packages rgdal and sf to current GDAL and 
>> PROJ, I have run into a problem. Many existing vector files (I have not 
>> yet looked at raster) include a datum declaration, which is still 
>> present internally in the OGRSpatialReference object, but is dropped in 
>> the output of exportToProj4().
>> [...]
>> Using GetAttrValue("DATUM"), I can alert users who bother to see 
>> warnings that something has happened requiring their attention, but am 
>> I missing a CPL option or other remedy already in place?
>
> No, you don't miss anything. PROJ 6 makes less efforts than previous 
> verions to export a +datum= string. This is more or less intended so 
> that people move away from PROJ strings to represent CRS because they 
> suffer from a number of limitations (its hardcoded list of datums is 
> very limited compared to what is available in EPSG, axis order issues, 
> etc.). That particular use case could potentially be improved as 
> +datum=OSGB36 is known of PROJ on the import side, but you'd get anyway 
> into troubles with other datums.

That was what I thought. Both sp (and rgdal which uses sp classes) and sf 
use proj strings to encode the CRS, but sf can alternatively use EPSG 
codes. I need to modify the sp class representation in a 
backwards-compatible way to let objects also have a CRS string such as 
"EPSG:4326", which then takes over responsibility.

But we need to provide pathways for other package developers depending 
on sp (about 500 packages) and sf (200), and packages using transformation 
(about 80), to feed through the need for end users to intervene manually. 
They'll need themselves to identify the URN or EPSG codes corresponding to 
the proj strings they are used to seeing, and add them to objects in the 
workflows. At least I have GetAttrValue("DATUM") to test whether a datum 
is being discarded.

The underlying problem is that users may face silent degradation in 
workflows as they upgrade sf and rgdal to PROJ >= 6 and GDAL >= 3 if they 
are not prompted to take remedial steps themselves. I realise that users 
have become too comfortable, but user guidance will be essential to avoid 
too much noise on SO, twitter, etc.

> If you use directly the WKT representation from this .prj file with PROJ 
> functions that deal with coordinate transformations (or the 
> OGRSpatialReference object with GDAL functions), things should work 
> smoothly.

WKT is not an option really, though users may wish to look at the WKT2 of 
an EPSG code. My attempts to feed WKT into importFromWkt() have failed so 
far, but that could be string handling (I'm treating the whole WKT block 
as a single text string).

>
>> Optional interpolation from GDALs gt_datum.csv or similar would perhaps 
>> help, inserting a +towgs84 tag, but I do not have a clear view how to 
>> make the migration process for users easier.
>
> The towgs84 concept is also a fragile and a limited one. There might be 
> several potential towgs84 transformations and this assumes you 
> transforms from/to WGS84. That said the method 
> OGRSpatialReference::importFromEPSG() will use internally 
> proj_crs_create_bound_crs_to_WGS84() to try finding a TOWGS84 transform. 
> But this will only work if there's a single candidate. In case of 
> multiple candidates, it will not select an artibtrary one like previous 
> GDAL / PROJ versions did.

I realise this too, but to permit legacy results to be replicated, it may 
be necessary to guide from +datum= to +towgs84= where +nadgrids= is not 
available. Grid handling may help, but we're likely to see trouble with 
dropped datum strings for some time (as long as R FAQ 7.31 [1]?), people 
do re-use older files.

Roger

[1]https://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-doesn_0027t-R-think-these-numbers-are-equal_003f

>
> Even
>
>

-- 
Roger Bivand
Department of Economics, Norwegian School of Economics,
Helleveien 30, N-5045 Bergen, Norway.
voice: +47 55 95 93 55; e-mail: Roger.Bivand at nhh.no
https://orcid.org/0000-0003-2392-6140
https://scholar.google.no/citations?user=AWeghB0AAAAJ&hl=en

From listerkristine at gmail.com  Tue Oct 29 13:12:38 2019
From: listerkristine at gmail.com (Kristine Lister)
Date: Tue, 29 Oct 2019 16:12:38 -0400
Subject: [gdal-dev] GDAL Import Error with Anaconda
Message-ID: <CA+zOWW0XRzBMUrT_rfYbyD7Lf4-PC9Va_pvR5oJtmvymcxV4KQ@mail.gmail.com>

Hi everyone,

I've been running into a new issue with installing GDAL in docker
containers using anaconda. I get the following error when trying to import
gdal in python:

Traceback (most recent call last):
  File "georeference_rasters2.py", line 5, in <module>
    from osgeo import gdal
  File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/site-packages/osgeo/__init__.py",
line 21, in <module>
    _gdal = swig_import_helper()
  File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/site-packages/osgeo/__init__.py",
line 17, in swig_import_helper
    _mod = imp.load_module('_gdal', fp, pathname, description)
  File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/imp.py",
line 242, in load_module
    return load_dynamic(name, filename, file)
  File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/imp.py",
line 342, in load_dynamic
    return _load(spec)ImportError: libpoppler.so.76: cannot open
shared object file: No such file or directory


I install the following packages in the docker container using conda:

RUN conda install -c conda-forge numpy pandas poppler rasterio gdal rasterstats
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/d92a2775/attachment-0001.html>

From even.rouault at spatialys.com  Tue Oct 29 13:16:28 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Oct 2019 21:16:28 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
 <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
Message-ID: <2121413.VCeqEJs6lA@even-i700>

> The underlying problem is that users may face silent degradation in
> workflows as they upgrade sf and rgdal to PROJ >= 6 and GDAL >= 3 if they
> are not prompted to take remedial steps themselves. I realise that users
> have become too comfortable, but user guidance will be essential to avoid
> too much noise on SO, twitter, etc.

I do understand your issues. If contributors are willing to spend time 
bringing back more backward compatibility into PROJ exportToProjString() (for 
the +datum part I mean. I wouldn't be enthousiastic of attempting to recover 
full backward compatibility on the +towgs84 part), we'd probably accept 
reasonable patches . I consciously did a partial implementation on that part 
of the code, so that people have an incentive to embrace other options, more 
future proof, like WKT or AUTHORITY:CODE, to encode their CRS.

> 
> > If you use directly the WKT representation from this .prj file with PROJ
> > functions that deal with coordinate transformations (or the
> > OGRSpatialReference object with GDAL functions), things should work
> > smoothly.
> 
> WKT is not an option really, though users may wish to look at the WKT2 of
> an EPSG code. My attempts to feed WKT into importFromWkt() have failed so
> far, but that could be string handling (I'm treating the whole WKT block
> as a single text string).

Using WKT should definitely be considered as an option, and investigating why 
that fails is in my opinion a more valuable time investment rather than trying 
to revive a ghost from the past. WKT is a standard, PROJ strings are not.

> I realise this too, but to permit legacy results to be replicated,

Some legacy behaviour was just plain wrong/inaccurate. Trying to replicate it 
in PROJ would be heartbreaking, an extra maintaince burden, and a confusion 
for PROJ users because depending on the path they take, they would get 
different results.

Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020

$ gdalsrsinfo EPSG:4283

PROJ.4 : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs 

OGC WKT :
GEOGCS["GDA94",
    DATUM["Geocentric_Datum_of_Australia_1994",
        SPHEROID["GRS 1980",6378137,298.257222101,
            AUTHORITY["EPSG","7019"]],
        TOWGS84[0,0,0,0,0,0,0],
        AUTHORITY["EPSG","6283"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","4283"]]

$ gdalsrsinfo EPSG:7844

PROJ.4 : +proj=longlat +ellps=GRS80 +no_defs 

OGC WKT :
GEOGCS["GDA2020",
    DATUM["Geocentric_Datum_of_Australia_2020",
        SPHEROID["GRS 1980",6378137,298.257222101,
            AUTHORITY["EPSG","7019"]],
        AUTHORITY["EPSG","1168"]],
    PRIMEM["Greenwich",0,
        AUTHORITY["EPSG","8901"]],
    UNIT["degree",0.0174532925199433,
        AUTHORITY["EPSG","9122"]],
    AUTHORITY["EPSG","7844"]]

Transforming between the above using PROJ string results in a null 
transformation:

$ echo "150 -30" | gdaltransform -s_srs EPSG:4283 -t_srs EPSG:7844 --debug on
OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
[...]
150 -30 0


Same transformation with GDAL + PROJ master:

$ echo "150 -30" | gdaltransform -s_srs EPSG:4283 -t_srs EPSG:7844 --debug on
OGRCT: proj=pipeline step proj=axisswap order=2,1 step proj=unitconvert 
xy_in=deg xy_out=rad step proj=push v_3 step proj=cart ellps=GRS80 step 
proj=helmert x=0.06155 y=-0.01087 z=-0.04019 rx=-0.0394924 ry=-0.0327221 
rz=-0.0328979 s=-0.009994 convention=coordinate_frame step inv proj=cart 
ellps=GRS80 step proj=pop v_3 step proj=unitconvert xy_in=rad xy_out=deg step 
proj=axisswap order=2,1 (GDA94 to GDA2020 (1))
[...]
150.000006074915 -29.9999871787747 0

You get a ~1.5 metre shift to the north east as expected.

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From sean at mapbox.com  Tue Oct 29 15:07:31 2019
From: sean at mapbox.com (Sean Gillies)
Date: Tue, 29 Oct 2019 16:07:31 -0600
Subject: [gdal-dev] GDAL Import Error with Anaconda
In-Reply-To: <CA+zOWW0XRzBMUrT_rfYbyD7Lf4-PC9Va_pvR5oJtmvymcxV4KQ@mail.gmail.com>
References: <CA+zOWW0XRzBMUrT_rfYbyD7Lf4-PC9Va_pvR5oJtmvymcxV4KQ@mail.gmail.com>
Message-ID: <CADPhZXw8BoX0QHvh0_x586ezn-6k==8stAKx6dRA+p5gFbWE_Q@mail.gmail.com>

Hi,

This isn't the place to ask for conda and conda-forge help. Check out
https://github.com/conda-forge/gdal-feedstock/issues/324#issuecomment-519632735
and if you don't find the solution there, see
https://conda-forge.org/docs/user/how_to_get_help.html for the right help
forum. Good luck!

On Tue, Oct 29, 2019 at 2:12 PM Kristine Lister <listerkristine at gmail.com>
wrote:

> Hi everyone,
>
> I've been running into a new issue with installing GDAL in docker
> containers using anaconda. I get the following error when trying to import
> gdal in python:
>
> Traceback (most recent call last):
>   File "georeference_rasters2.py", line 5, in <module>
>     from osgeo import gdal
>   File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/site-packages/osgeo/__init__.py", line 21, in <module>
>     _gdal = swig_import_helper()
>   File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/site-packages/osgeo/__init__.py", line 17, in swig_import_helper
>     _mod = imp.load_module('_gdal', fp, pathname, description)
>   File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/imp.py", line 242, in load_module
>     return load_dynamic(name, filename, file)
>   File "/azureml-envs/azureml_e9a775e324129d22aa5680cb26b4a846/lib/python3.6/imp.py", line 342, in load_dynamic
>     return _load(spec)ImportError: libpoppler.so.76: cannot open shared object file: No such file or directory
>
>
> I install the following packages in the docker container using conda:
>
> RUN conda install -c conda-forge numpy pandas poppler rasterio gdal rasterstats
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191029/1c21d680/attachment-0001.html>

From mdsumner at gmail.com  Tue Oct 29 15:22:11 2019
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 30 Oct 2019 09:22:11 +1100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <2121413.VCeqEJs6lA@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <11086630.p102ApzHzd@even-i700>
 <alpine.LFD.2.21.1910291956290.333@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
Message-ID: <CAAcGz9-X7ou7v02yAe5b=HLsyPzO=ixwwJ5UcCG0OSN12twRhA@mail.gmail.com>

Great discussion, thanks to both of you.  I have a question.

I wonder how we ought to specify a projection that we desire, I work in
contexts where 1.5m or even 1.5 km is not an unreasonable level of
precision, and we get a lot of value out of specifying local projections
(at ocean basin scale) in LAEA, LCC, STERE and others  (OMERC is especially
good for hermisphere-scale migrating birds, very custom and not related to
human activities) - PROJ strings are obviously an easy to specify the
family and centre point of the projection, and we have a lot of workflows
(computer and human) for this. The datum is a bit irrelevant a lot of the
time but we always include it and try to explain it to users.

Are we expected to express a full WKT or WKT2 string for this?   I know we
can write wrappers in some language, but there doesn't seem to be a culture
around crafting custom projections that I can latch onto. Usually I see
people looking for an EPSG code for their region, and as often as not they
end up using UTM because "it's a projection" and no authority has ever done
a survey in their part of the Southern Ocean and published it with EPSG.

Is something like the gdaltransform pipelining syntax the most concise we
can aim for, or do we somehow cache our own local EPSG-like codes?

Thank you.

Cheers, Mike.



On Wed, Oct 30, 2019 at 7:17 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> > The underlying problem is that users may face silent degradation in
> > workflows as they upgrade sf and rgdal to PROJ >= 6 and GDAL >= 3 if they
> > are not prompted to take remedial steps themselves. I realise that users
> > have become too comfortable, but user guidance will be essential to avoid
> > too much noise on SO, twitter, etc.
>
> I do understand your issues. If contributors are willing to spend time
> bringing back more backward compatibility into PROJ exportToProjString()
> (for
> the +datum part I mean. I wouldn't be enthousiastic of attempting to
> recover
> full backward compatibility on the +towgs84 part), we'd probably accept
> reasonable patches . I consciously did a partial implementation on that
> part
> of the code, so that people have an incentive to embrace other options,
> more
> future proof, like WKT or AUTHORITY:CODE, to encode their CRS.
>
> >
> > > If you use directly the WKT representation from this .prj file with
> PROJ
> > > functions that deal with coordinate transformations (or the
> > > OGRSpatialReference object with GDAL functions), things should work
> > > smoothly.
> >
> > WKT is not an option really, though users may wish to look at the WKT2 of
> > an EPSG code. My attempts to feed WKT into importFromWkt() have failed so
> > far, but that could be string handling (I'm treating the whole WKT block
> > as a single text string).
>
> Using WKT should definitely be considered as an option, and investigating
> why
> that fails is in my opinion a more valuable time investment rather than
> trying
> to revive a ghost from the past. WKT is a standard, PROJ strings are not.
>
> > I realise this too, but to permit legacy results to be replicated,
>
> Some legacy behaviour was just plain wrong/inaccurate. Trying to replicate
> it
> in PROJ would be heartbreaking, an extra maintaince burden, and a
> confusion
> for PROJ users because depending on the path they take, they would get
> different results.
>
> Not-so-random example with GDAL 2.4/PROJ 5 with GDA94 to GDA2020
>
> $ gdalsrsinfo EPSG:4283
>
> PROJ.4 : +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs
>
> OGC WKT :
> GEOGCS["GDA94",
>     DATUM["Geocentric_Datum_of_Australia_1994",
>         SPHEROID["GRS 1980",6378137,298.257222101,
>             AUTHORITY["EPSG","7019"]],
>         TOWGS84[0,0,0,0,0,0,0],
>         AUTHORITY["EPSG","6283"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9122"]],
>     AUTHORITY["EPSG","4283"]]
>
> $ gdalsrsinfo EPSG:7844
>
> PROJ.4 : +proj=longlat +ellps=GRS80 +no_defs
>
> OGC WKT :
> GEOGCS["GDA2020",
>     DATUM["Geocentric_Datum_of_Australia_2020",
>         SPHEROID["GRS 1980",6378137,298.257222101,
>             AUTHORITY["EPSG","7019"]],
>         AUTHORITY["EPSG","1168"]],
>     PRIMEM["Greenwich",0,
>         AUTHORITY["EPSG","8901"]],
>     UNIT["degree",0.0174532925199433,
>         AUTHORITY["EPSG","9122"]],
>     AUTHORITY["EPSG","7844"]]
>
> Transforming between the above using PROJ string results in a null
> transformation:
>
> $ echo "150 -30" | gdaltransform -s_srs EPSG:4283 -t_srs EPSG:7844 --debug
> on
> OGRCT: Source: +proj=longlat +ellps=GRS80 +no_defs
> OGRCT: Target: +proj=longlat +ellps=GRS80 +no_defs
> [...]
> 150 -30 0
>
>
> Same transformation with GDAL + PROJ master:
>
> $ echo "150 -30" | gdaltransform -s_srs EPSG:4283 -t_srs EPSG:7844 --debug
> on
> OGRCT: proj=pipeline step proj=axisswap order=2,1 step proj=unitconvert
> xy_in=deg xy_out=rad step proj=push v_3 step proj=cart ellps=GRS80 step
> proj=helmert x=0.06155 y=-0.01087 z=-0.04019 rx=-0.0394924 ry=-0.0327221
> rz=-0.0328979 s=-0.009994 convention=coordinate_frame step inv proj=cart
> ellps=GRS80 step proj=pop v_3 step proj=unitconvert xy_in=rad xy_out=deg
> step
> proj=axisswap order=2,1 (GDA94 to GDA2020 (1))
> [...]
> 150.000006074915 -29.9999871787747 0
>
> You get a ~1.5 metre shift to the north east as expected.
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/873fc264/attachment.html>

From even.rouault at spatialys.com  Tue Oct 29 15:33:42 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Tue, 29 Oct 2019 23:33:42 +0100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <CAAcGz9-X7ou7v02yAe5b=HLsyPzO=ixwwJ5UcCG0OSN12twRhA@mail.gmail.com>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAAcGz9-X7ou7v02yAe5b=HLsyPzO=ixwwJ5UcCG0OSN12twRhA@mail.gmail.com>
Message-ID: <8605951.xcSZTzH5c9@even-i700>

On mercredi 30 octobre 2019 09:22:11 CET Michael Sumner wrote:
> Great discussion, thanks to both of you.  I have a question.
> 
> I wonder how we ought to specify a projection that we desire, I work in
> contexts where 1.5m or even 1.5 km is not an unreasonable level of
> precision, and we get a lot of value out of specifying local projections
> (at ocean basin scale) in LAEA, LCC, STERE and others  (OMERC is especially
> good for hermisphere-scale migrating birds, very custom and not related to
> human activities) - PROJ strings are obviously an easy to specify the
> family and centre point of the projection, and we have a lot of workflows
> (computer and human) for this. The datum is a bit irrelevant a lot of the
> time but we always include it and try to explain it to users.
> 
> Are we expected to express a full WKT or WKT2 string for this?   I know we
> can write wrappers in some language, but there doesn't seem to be a culture
> around crafting custom projections that I can latch onto. Usually I see
> people looking for an EPSG code for their region, and as often as not they
> end up using UTM because "it's a projection" and no authority has ever done
> a survey in their part of the Southern Ocean and published it with EPSG.
> 
> Is something like the gdaltransform pipelining syntax the most concise we
> can aim for, or do we somehow cache our own local EPSG-like codes?

I'm a bit extreme when I say "don't use PROJ strings", but otherwise people 
don't get it :-) So yes if you don't care about datum transformations, don't 
use unusual axis orders, you might still use them. They won't disappear in a 
foreseable future.
The GDAL OGRSpatialReference class has a number of helper methods to help you 
build your own custom CRS, like SetLAEA(), SetLCC(), etc. and SetGeogCS()

The PROJJSON notation might also be slightly easier to work with than WKT2 (it 
is completely equivalent to it, just using a more standard encoding):
example at https://github.com/OSGeo/PROJ/pull/1547
Schema at https://proj.org/schemas/v0.1/projjson.schema.json

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From mdsumner at gmail.com  Tue Oct 29 16:22:09 2019
From: mdsumner at gmail.com (Michael Sumner)
Date: Wed, 30 Oct 2019 10:22:09 +1100
Subject: [gdal-dev] GDAL 3, PROJ 6.2 exportToProj4() drops Datum silently
In-Reply-To: <8605951.xcSZTzH5c9@even-i700>
References: <alpine.LFD.2.21.1910291504480.15781@reclus.nhh.no>
 <2121413.VCeqEJs6lA@even-i700>
 <CAAcGz9-X7ou7v02yAe5b=HLsyPzO=ixwwJ5UcCG0OSN12twRhA@mail.gmail.com>
 <8605951.xcSZTzH5c9@even-i700>
Message-ID: <CAAcGz99H3a4y4j3LCzhY1AUB=cF1GvdBXvHVbWGFbafj4bQw-w@mail.gmail.com>

> I'm a bit extreme when I say "don't use PROJ strings", but otherwise
people
> don't get it :-) So yes if you don't care about datum transformations,
don't
> use unusual axis orders, you might still use them. They won't disappear
in a
> foreseable future.
> The GDAL OGRSpatialReference class has a number of helper methods to help
you
> build your own custom CRS, like SetLAEA(), SetLCC(), etc. and SetGeogCS()

Oh excellent, that's less scary than I'd understood.

 I'll look at exposing those custom builders in R.

Cheers, Mike.


On Wed, Oct 30, 2019 at 9:33 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> On mercredi 30 octobre 2019 09:22:11 CET Michael Sumner wrote:
> > Great discussion, thanks to both of you.  I have a question.
> >
> > I wonder how we ought to specify a projection that we desire, I work in
> > contexts where 1.5m or even 1.5 km is not an unreasonable level of
> > precision, and we get a lot of value out of specifying local projections
> > (at ocean basin scale) in LAEA, LCC, STERE and others  (OMERC is
> especially
> > good for hermisphere-scale migrating birds, very custom and not related
> to
> > human activities) - PROJ strings are obviously an easy to specify the
> > family and centre point of the projection, and we have a lot of workflows
> > (computer and human) for this. The datum is a bit irrelevant a lot of the
> > time but we always include it and try to explain it to users.
> >
> > Are we expected to express a full WKT or WKT2 string for this?   I know
> we
> > can write wrappers in some language, but there doesn't seem to be a
> culture
> > around crafting custom projections that I can latch onto. Usually I see
> > people looking for an EPSG code for their region, and as often as not
> they
> > end up using UTM because "it's a projection" and no authority has ever
> done
> > a survey in their part of the Southern Ocean and published it with EPSG.
> >
> > Is something like the gdaltransform pipelining syntax the most concise we
> > can aim for, or do we somehow cache our own local EPSG-like codes?
>
> I'm a bit extreme when I say "don't use PROJ strings", but otherwise
> people
> don't get it :-) So yes if you don't care about datum transformations,
> don't
> use unusual axis orders, you might still use them. They won't disappear in
> a
> foreseable future.
> The GDAL OGRSpatialReference class has a number of helper methods to help
> you
> build your own custom CRS, like SetLAEA(), SetLCC(), etc. and SetGeogCS()
>
> The PROJJSON notation might also be slightly easier to work with than WKT2
> (it
> is completely equivalent to it, just using a more standard encoding):
> example at https://github.com/OSGeo/PROJ/pull/1547
> Schema at https://proj.org/schemas/v0.1/projjson.schema.json
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>


-- 
Michael Sumner
Software and Database Engineer
Australian Antarctic Division
Hobart, Australia
e-mail: mdsumner at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/3fe54f5c/attachment-0001.html>

From shayne.tueller at us.af.mil  Tue Oct 29 17:49:24 2019
From: shayne.tueller at us.af.mil (TUELLER, SHAYNE R CIV USAF AFMC 519 SMXS/MXDEC)
Date: Wed, 30 Oct 2019 00:49:24 +0000
Subject: [gdal-dev] GDALClose()...
Message-ID: <CY1P111MB0120BB980AAE8D3923D484F6C6600@CY1P111MB0120.NAMP111.PROD.OUTLOOK.COM>

All,

We're currently using GDAL 2.3.1 on Windows to develop a shapefile editor for our application.

We're seeing a crash in our application when we call GDALClose() on a dataset/layer that contains a large shapefile with a large number of polygons. We opened the shapefile and set the dataset by calling GDALOpenEx(...).

When we comment out the GDALClose() call, the application closes the dataset/layer without a crash.

My question is, if we ignore calling GDALClose() to close a layer/dataset, will this create a memory leak in our application?

Thanks in advance...

Shayne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/4e1ca03f/attachment.html>

From even.rouault at spatialys.com  Wed Oct 30 01:42:22 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 30 Oct 2019 09:42:22 +0100
Subject: [gdal-dev] GDALClose()...
In-Reply-To: <CY1P111MB0120BB980AAE8D3923D484F6C6600@CY1P111MB0120.NAMP111.PROD.OUTLOOK.COM>
References: <CY1P111MB0120BB980AAE8D3923D484F6C6600@CY1P111MB0120.NAMP111.PROD.OUTLOOK.COM>
Message-ID: <23482693.mmH3DYvjea@even-i700>

On mercredi 30 octobre 2019 00:49:24 CET TUELLER, SHAYNE R CIV USAF AFMC 519 
SMXS/MXDEC wrote:
> All,
> 
> We're currently using GDAL 2.3.1 on Windows to develop a shapefile editor
> for our application.
> 
> We're seeing a crash in our application when we call GDALClose() on a
> dataset/layer that contains a large shapefile with a large number of
> polygons. We opened the shapefile and set the dataset by calling
> GDALOpenEx(...).
> 
> When we comment out the GDALClose() call, the application closes the
> dataset/layer without a crash.
> 
> My question is, if we ignore calling GDALClose() to close a layer/dataset,
> will this create a memory leak in our application?

Yes, and if you did changes to the shapefile (as you mention "editor"), then 
the shapefile header will not be updated.
I'd suspect there is a misuse of the GDAL API on your side or some other 
memory corruption. Hard to tell what exactly with just what you mentionned.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From deduikertjes at xs4all.nl  Wed Oct 30 01:46:45 2019
From: deduikertjes at xs4all.nl (Marco)
Date: Wed, 30 Oct 2019 09:46:45 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
 <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
 <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>
Message-ID: <b16634ec-6915-4149-337f-2ba4a465cd8d@xs4all.nl>

Tobias,

Indeed Buffer 0 won't do any good on self intersections. Thats just not 
the way to repair them.

Hence I wrote "Buffer 0 on INVALID geometries IMHO can lead to good 
results depending on the /nature of the invalidity/. To my experience 
/repeating points,//wrong coordinate ordering and holes touching outer 
shells in one point///are being repaired well without data loss.".

Of course self intersections can be easily overlooked. For that we have 
validity checkers.

Marco


On 29-10-19 19:35, Tobias Wendorff wrote:
> Hi Marco,
>
> Am 29.10.2019 um 10:49 schrieb Marco:
>> Buffer 0 on INVALID geometries IMHO can lead to good results depending
>> on the nature of the invalidity. To my experience repeating points,
>> wrong coordinate ordering and holes touching outer shells in one point
>> are being repaired well without data loss.
> I'm sorry to say that the side effects are worse. Maybe the
> implementation of QGIS is wrong, but try the example below.
>
>> Please enlighten me with a few links to the tons of tests on the web
>> showing that buffer 0 is destroying data. My Google skills are not up to it.
> I've just updated the example I'm normally showing students with an
> actual thematic, I'm calling in "wronxit": [1]
>
> Try to "buffer(geom, 0)" it in QGIS...
>
> This problem isn't constructed (well, this geojson is of course), but
> I'm got lots of self-intersecting polygons from different sources all
> the time. "Buffer 0" is destructive here and since many
> self-intersections are damn small, most users simply don't see them.
>
> "Fix Geometries" gives the correct result.
>
> Best regards,
> Tobias
>
> references:
> [1] https://gist.github.com/tobwen/39bc3562d1cb957cbaf4305ef53f77df

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/95838a3d/attachment.html>

From jgomezdans at gmail.com  Wed Oct 30 08:52:54 2019
From: jgomezdans at gmail.com (Jose Gomez-Dans)
Date: Wed, 30 Oct 2019 15:52:54 +0000
Subject: [gdal-dev] Limit on the number of files for gdalbuildvrt
Message-ID: <CAMWde5pG3iqF1CvatG10r2afj+7SfYOgNy-xFt8_xk17dt9mqw@mail.gmail.com>

Hi,

I'm mosaicking a large number of small tiles using the GDAL python bindings
(python 3.7, gdal 3.0.1, but also tested on 2.4.2). Code is something like

```

*output_fname = "/something/or/other.vrt"*
*fnames = ["file1.tif", ..., "fileN.tif"]*




*dst_ds = gdal.BuildVRT(            output_fname,            fnames,
    options=gdal.BuildVRTOptions(separate=True),        )*
*dst_ds = None*
```

This fails with lots of errors like
ERROR 4: fileXXX.tif: No such file or directory
Warning 1: Can't open fileXXX.tif. Skipping it

The files are available on disk, and gdalinfo identifies them with no
issues.

Piping the files on a text file and using gdalbuildvrt results in the same
issue. The overall effect is that no information goes into the mosaic.

This approach works well when I tested with a handful of files (e.g. 4),
but I am now mosaicking a large number of files (>1000), and I was
wondering whether this could be an issue due to limits on opened files and
so on? This is on Linux.

The aim of this is to create a VRT mosaic that can then be converted to
GeoTIFF.

Any pointers?
many thanks
Jose
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/25187087/attachment.html>

From even.rouault at spatialys.com  Wed Oct 30 09:16:17 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 30 Oct 2019 17:16:17 +0100
Subject: [gdal-dev] Limit on the number of files for gdalbuildvrt
In-Reply-To: <CAMWde5pG3iqF1CvatG10r2afj+7SfYOgNy-xFt8_xk17dt9mqw@mail.gmail.com>
References: <CAMWde5pG3iqF1CvatG10r2afj+7SfYOgNy-xFt8_xk17dt9mqw@mail.gmail.com>
Message-ID: <1621489.h3OLbH8oeh@even-i700>

On mercredi 30 octobre 2019 15:52:54 CET Jose Gomez-Dans wrote:
> Hi,
> 
> I'm mosaicking a large number of small tiles using the GDAL python bindings
> (python 3.7, gdal 3.0.1, but also tested on 2.4.2). Code is something like
> 
> ```
> 
> *output_fname = "/something/or/other.vrt"*
> *fnames = ["file1.tif", ..., "fileN.tif"]*
> 
> 
> 
> 
> *dst_ds = gdal.BuildVRT(            output_fname,            fnames,
>     options=gdal.BuildVRTOptions(separate=True),        )*
> *dst_ds = None*
> ```
> 
> This fails with lots of errors like
> ERROR 4: fileXXX.tif: No such file or directory
> Warning 1: Can't open fileXXX.tif. Skipping it

gdalbuildvrt is normally cautious about non opening too many files at the same 
time. I can't replicate your issue with the following script

```
from osgeo import gdal
import shutil

fnames = []
for i in range(1024):
    dstname = 'testbuildvrt/byte%d.tif' % i
    shutil.copy('byte.tif', dstname)
    fnames.append(dstname)

dst_ds = gdal.BuildVRT(
            "/tmp/out.vrt",
            fnames,
            options=gdal.BuildVRTOptions(separate=True),
        )
dst_ds = None
```

> The aim of this is to create a VRT mosaic that can then be converted to
> GeoTIFF.

If you want a mosaic, you likely want separate=False.

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From patrick.mckendree.young at gmail.com  Wed Oct 30 11:05:01 2019
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Wed, 30 Oct 2019 12:05:01 -0600
Subject: [gdal-dev] Python Bindings and Closed Datasets
Message-ID: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>

Hi all,

I've been experiencing some behavior using the GDAL python bindings where I
am occasionally seeing what appears to be random blocks of the tiff being
unwritten in geotiffs I've pushed to S3.  a small block(s) in one of the
bands will be all zeros while everywhere else is good.

My setup is that I have a thread pool crunching through some gdal.Warp
calls.  The main thread is polling for completed jobs and then uploading
the file to s3.  My theory is that Python's garbage collector hasn't
destroyed the dataset I've set to None before I start uploading.  Is this
plausible?   The call to FlushCache didn't solve the problem for me and I'm
not aware of another way via the Python bindings for ensure the dataset is
closed.  I'm using Ubuntu 19.10 (comes with GDAL 2.4.2), any thoughts and
ideas to try are greatly appreciated, as one can imagine, this is hard to
reproduce.

The code looks something like this:

def warp_tile(f_in, f_out, warp_opts):
    gdal_warp_opts = gdal.WarpOptions(**warp_opts,
creationOptions=["TILED=YES", "COMPRESS=DEFLATE"])
    try:
        warp_ds = gdal.Warp(f_out, f_in, options=gdal_warp_opts)
        warp_ds.FlushCache()
    finally:
        warp_ds = None


with ThreadPoolExecutor(max_workers=max_workers) as executor:

    job_d = {}
    for job in jobs:
        job_d[executor.submit(warp_tile, job.in_f, job.out_f,
job.warp_opts)] = out_f

    for future in as_completed(job_d):
        out_f = job_d[future]
        try:
            future.result()
        except Exception as e:
            ...
        else:

boto3.resource('s3').Bucket(bucket_name).upload_file(Filename=out_f,
Key=key)

Thanks,
Patrick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/2da2ee25/attachment.html>

From even.rouault at spatialys.com  Wed Oct 30 11:32:27 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 30 Oct 2019 19:32:27 +0100
Subject: [gdal-dev] Python Bindings and Closed Datasets
In-Reply-To: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>
References: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>
Message-ID: <4778696.d7OmXju5Sq@even-i700>

On mercredi 30 octobre 2019 12:05:01 CET Patrick Young wrote:
> Hi all,
> 
> I've been experiencing some behavior using the GDAL python bindings where I
> am occasionally seeing what appears to be random blocks of the tiff being
> unwritten in geotiffs I've pushed to S3.  a small block(s) in one of the
> bands will be all zeros while everywhere else is good.
> 
> My setup is that I have a thread pool crunching through some gdal.Warp
> calls.  The main thread is polling for completed jobs and then uploading
> the file to s3.  My theory is that Python's garbage collector hasn't
> destroyed the dataset I've set to None before I start uploading.  Is this
> plausible?  

That would be surprising. As far as I know, the Python garbage collector is 
synchronous, so at the point where the last reference to an object is dropped, 
it is destroyed. Your below try / finally could be simplified as just:

gdal.Warp(f_out, f_in, options=gdal_warp_opts)

But that should behave exactly as your current code, and thus exhibit the same 
unexplained issue.
(however you might test the return of gdal.Warp() to detect errors, or enable 
gdal.UseExceptions())

However looking at your code I'm not sure if you're not warping several input 
files in the same output file. If so, the behaviour you see is expected as 
multi-threaded/multi-processing updates of a single target file are 
unspecified behaviour (but I'd expect such a scenario to always result in 
wrong results, not randomly)

Even

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Wed Oct 30 12:31:43 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Wed, 30 Oct 2019 20:31:43 +0100
Subject: [gdal-dev] Python Bindings and Closed Datasets
In-Reply-To: <4778696.d7OmXju5Sq@even-i700>
References: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>
 <4778696.d7OmXju5Sq@even-i700>
Message-ID: <2583050.INz1hFUIFx@even-i700>

I've, unsuccessfully, tried to reproduce your issue with the following script:

-----

from osgeo import gdal
import concurrent.futures

def worker(in_f, out_f):
    gdal.Unlink(out_f)
    gdal.Warp(out_f, in_f, options = '-co COMPRESS=DEFLATE -co TILED=YES -ts 2048 2048')

jobs = []

for i in range(1000):
    jobs.append( ['byte.tif', '/tmp/byte%d.tif' % i] )

with concurrent.futures.ThreadPoolExecutor(max_workers=8) as executor:
    future_map = {executor.submit(worker, in_f, out_f): out_f for in_f, out_f in jobs}
    for future in concurrent.futures.as_completed(future_map):
        out_f = future_map[future]
        try:
            future.result()
        except Exception as exc:
            print('%r generated an exception: %s' % (out_f, exc))

        print('Finished ' + out_f)
        ds = gdal.Open(out_f)
        if ds.GetRasterBand(1).Checksum() != 58226:
            print('wrong checksum for ' + out_f)

------

where the input byte.tif file is
https://github.com/OSGeo/gdal/blob/master/autotest/gcore/data/byte.tif?raw=true


-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From tobias.wendorff at tu-dortmund.de  Wed Oct 30 12:34:26 2019
From: tobias.wendorff at tu-dortmund.de (Tobias Wendorff)
Date: Wed, 30 Oct 2019 20:34:26 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
 holes
In-Reply-To: <b16634ec-6915-4149-337f-2ba4a465cd8d@xs4all.nl>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
 <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
 <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>
 <b16634ec-6915-4149-337f-2ba4a465cd8d@xs4all.nl>
Message-ID: <60136e4c-1237-ff28-7b42-971754489523@tu-dortmund.de>

Hi Marco,

Am 30.10.2019 um 09:46 schrieb Marco:
>
> Indeed Buffer 0 won't do any good on self intersections. Thats just not
> the way to repair them.

But many users act like this:

1. Get a warning about invalid geometry,
2. run Buffer 0,
3. Warning about invalid geometry is gone.

Again, this is not constructed, it's reality.

> Hence I wrote "Buffer 0 on INVALID geometries IMHO can lead to good
> results depending on the /nature of the invalidity/. To my experience
> /repeating points,//wrong coordinate ordering and holes touching outer
> shells in one point///are being repaired well without data loss.".

Of course, in this case it's correct. But a user needs to read and
understand the problem first. Most don't know what's going on at all,
run "Buffer 0 " and the problem seems to be gone.

> Of course self intersections can be easily overlooked. For that we have
> validity checkers.

No. That's what we've got "MakeValid", "Fix Geometry" etc. for. These
are the correct functions in every case, even if they're slower.

Sorry, I'm just talking from experience... might be different if users
know how to interpet the output of a validity checker. But please, never
recommend them to use Buffer 0 ... just recommend them to use the real ones.

Best regards,
Tobias

From stephenwoodbridge37 at gmail.com  Wed Oct 30 13:35:35 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Wed, 30 Oct 2019 16:35:35 -0400
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
 contours generated.
Message-ID: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>

Hi,

I want to use gdal_contour to generate shapefile contours which is 
pretty straight forward except I'm working with coastal relief data that 
has both elevation and bathymetry. I only want contours for the bathymetry.

I tried setting the -off -5 and -i -5 with the idea that this would 
start me at a depth of -5 and generate contours every -5 units deeper, 
but the generated an empty files. Seems like -i parameter can not be 
negative (should be mentioned in the docs).

This sets the depth to 400ft and generates contours every 5 ft above that:

gdal_contour -off -121.92 -i 1.524 bathy-value/crm_vol2.nc.tif 
bathy-contours/crm_vol2.nc-5.shp

How can I stop/limit the process and stop at 0 (ie: sea level)? I don't 
want land elevation contours. Like a -limit 0 argument?

If this can't be done, it would be a nice option to have so you can 
breakup contours into multiple shapefiles to avoid overflowing them

Thanks,
   -Steve

---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From nalicata at gmail.com  Wed Oct 30 13:57:59 2019
From: nalicata at gmail.com (Nick Licata)
Date: Wed, 30 Oct 2019 16:57:59 -0400
Subject: [gdal-dev] Need Help with gdal2tiles for large super overlay in
	googlemaps
Message-ID: <CAEQAsKRQTMb2rvR-f6F22zwypmyRpA0zP9LEiC-Zup8T4-de3w@mail.gmail.com>

I included as much detail as I could. I put links to all images because I
wasn't sure they would embed in the email list. Experienced programmer but
brand new to gdal.

Overview: My drone is taking multiple high resolution images that slightly
overlap each other in order to view 1 large high resolution image with
great detail after they are put together. I want to superimpose those
images in google maps as a super-overlay. It is a large area being imaged
and there can be from 800 to 1500 images. I am trying to follow these
instructions:
https://developers.google.com/kml/articles/raster#step-3:-get-information-about-the-image

I am using python3 3.6.8 and gdal 2.4.0 on ubuntu.

My plan is to execute gdal2tiles for each of these images that will compose
the 'single' large image to be super-overlayed in google maps (using
javascript).

These are the steps I took using this image downloaded locally:
https://s3.amazonaws.com/app-dev.mydroneop.com/DJI_0001.JPG

1. I run this command:
>gdalinfo DJI_0001.JPG -json
(the full output of this command is here:
https://s3.amazonaws.com/app-dev.mydroneop.com/gdalinfo-output.json)

But as I understand it the important part is this:

"cornerCoordinates":{
    "upperLeft":[
      0.0,
      0.0
    ],
    "lowerLeft":[
      0.0,
      3648.0
    ],
    "lowerRight":[
      5472.0,
      3648.0
    ],
    "upperRight":[
      5472.0,
      0.0
    ],
    "center":[
      2736.0,
      1824.0
    ]
  }

2. I then run this command and it produces this file:
https://s3.amazonaws.com/app-dev.mydroneop.com/output.vrt
> gdal_translate -of VRT -a_srs EPSG:4326 -gcp 0 0 -180 90 -gcp 5472 0 180
90 -gcp 5472 3648 180 -90 DJI_0001.JPG output.vrt

The -180 90 and 180 90 does not seem right, does not seem those should not
be variable specific to the images long/lat in some way.

3. Then I run this command:
gdalwarp -of VRT -t_srs EPSG:4326 output.vrt output2.vrt
and it produces this file:
https://s3.amazonaws.com/app-dev.mydroneop.com/output2.vrt

4. Then finally I run this command:
gdal2tiles.py -p geodetic -k output2.vrt
and it produces a folder of sub folders with images, but here is the doc
file is produces:
https://s3.amazonaws.com/app-dev.mydroneop.com/tiles/doc.kml
The other files (images and kmls) are accessible relative to that file's
location if you need to see them.

I then build a basic web page consuming googlemaps and 'import' the kml
file like this:

======START HTML=======

<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=GOOGLE_MAPS_KEY&callback=initMap"></script>

function initMap() {
  map = new google.maps.Map(document.getElementById('map'), {
    // center: new google.maps.LatLng(43.6424359, -79.37448849999998),
    zoom: 2,
    disableDefaultUI: true,
    mapTypeId: google.maps.MapTypeId.ROAD

  });

  var layers = [];
  layers [0] = new
google.maps.KmlLayer("https://s3.amazonaws.com/app-dev.mydroneop.com/tiles/doc.kml",{
    preserveViewport: false,
    map: map
  });

}

======END HTML=======

Full Source is here:
https://s3.amazonaws.com/app-dev.mydroneop.com/index.html

Here is the problem and my questions:
1. I only run this on a single image while I get it to work, but the single
image appears in the center of the world map and not in the long/lat
associated to the image file. The image also appears stretched on it's
edges. As can be seen here:
https://s3.amazonaws.com/app-dev.mydroneop.com/result-zoomed-in.png
https://s3.amazonaws.com/app-dev.mydroneop.com/result-zoomed-out.png

2. What am I doing wrong with the placement of the images not being at
correct long lat position and rather being in the center of the world map?
I assume this has something to do with the 180 90 in the gdal_translate
command but don't know where to derive those numbers from if I should be
deriving them.

3. Is it ok that I want to run gdal2tiles on each individual image that
make up this large orthomosaic image that will be super-overlayed? Or
should those images be stitched together and then gdal2tiles be run on the
single super large image (400 mb and higher).

4. Why don't the images change as I zoom in? (the purpose of the tiles I
thought) in my google maps html file?

5. In the doc.kml file, will those relative links (relative to kml file)
work when the doc.kml is used in new google.maps.KmlLayer('doc.kml')?

6. Using this command below I thought it converted x and y pixel position
in the image to real world long/lat, how do I get long/lat from the
command's output?:
> gdallocationinfo DJI_0001.JPG 10 10

Report:
  Location: (10P,10L)
  Band 1:
    Value: 45
  Band 2:
    Value: 75
  Band 3:
    Value: 13



I have searched and read many docs but can't find a sample for what I am
trying to do, just pieces here and there and I haven't been able to put a
complete process together. If there is somewhere that has a relatively
complete explanation for what I am trying to do feel free to just point me
there.

Thank you for your patience if you read through all that, I appreciate any
help that can be offered.

Nick

-- 
Nick Licata
nalicata at gmail.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/85d42f3e/attachment.html>

From csmemoe at aquaveo.com  Wed Oct 30 14:20:03 2019
From: csmemoe at aquaveo.com (Chris Smemoe)
Date: Wed, 30 Oct 2019 15:20:03 -0600
Subject: [gdal-dev] Need Help with gdal2tiles for large super overlay
	ingooglemaps
In-Reply-To: <CAEQAsKRQTMb2rvR-f6F22zwypmyRpA0zP9LEiC-Zup8T4-de3w@mail.gmail.com>
References: <CAEQAsKRQTMb2rvR-f6F22zwypmyRpA0zP9LEiC-Zup8T4-de3w@mail.gmail.com>
Message-ID: <E098408B28114DDDA9701B500E77C66B@aquaveo.local>

Nick,

 

That's lots of info and questions.  Just from a quick overview, it looks
like you need to set your ground control points to the correct lat/lon
coordinates (or whatever coordinate system you want to use) and you also
need to set your image's projection.  You can do both of these with the -gcp
and the -a_srs flags in gdal_translate.  You would need to pass the exact
longitude/latitude of known points on your image as the 3rd and 4th
arguments to the -gcp flag. The first and second arguments of the -gcp are
the column and row of the image corresponding to the lat/lon coordinate.
You could use EPSG:4326 (WGS 84) for your -a_SRS argument.  There might be
other problems once you get past this though.  You could also try posting
this to gis.stackexchange and you might get a better response.

 

Chris

 

  _____  

From: gdal-dev [mailto:gdal-dev-bounces at lists.osgeo.org] On Behalf Of Nick
Licata
Sent: Wednesday, October 30, 2019 2:58 PM
To: gdal-dev at lists.osgeo.org
Subject: [gdal-dev] Need Help with gdal2tiles for large super overlay
ingooglemaps

 

I included as much detail as I could. I put links to all images because I
wasn't sure they would embed in the email list. Experienced programmer but
brand new to gdal.

 

Overview: My drone is taking multiple high resolution images that slightly
overlap each other in order to view 1 large high resolution image with great
detail after they are put together. I want to superimpose those images in
google maps as a super-overlay. It is a large area being imaged and there
can be from 800 to 1500 images. I am trying to follow these instructions: 

https://developers.google.com/kml/articles/raster#step-3:-get-information-ab
out-the-image

 

I am using python3 3.6.8 and gdal 2.4.0 on ubuntu.

 

My plan is to execute gdal2tiles for each of these images that will compose
the 'single' large image to be super-overlayed in google maps (using
javascript).

 

These are the steps I took using this image downloaded locally:

https://s3.amazonaws.com/app-dev.mydroneop.com/DJI_0001.JPG

 

1. I run this command:

>gdalinfo DJI_0001.JPG -json 

(the full output of this command is here:
https://s3.amazonaws.com/app-dev.mydroneop.com/gdalinfo-output.json)

 

But as I understand it the important part is this:

 

"cornerCoordinates":{
    "upperLeft":[
      0.0,
      0.0
    ],
    "lowerLeft":[
      0.0,
      3648.0
    ],
    "lowerRight":[
      5472.0,
      3648.0
    ],
    "upperRight":[
      5472.0,
      0.0
    ],
    "center":[
      2736.0,
      1824.0
    ]
  }

 

2. I then run this command and it produces this file: 

https://s3.amazonaws.com/app-dev.mydroneop.com/output.vrt

> gdal_translate -of VRT -a_srs EPSG:4326 -gcp 0 0 -180 90 -gcp 5472 0 180
90 -gcp 5472 3648 180 -90 DJI_0001.JPG output.vrt

 

The -180 90 and 180 90 does not seem right, does not seem those should not
be variable specific to the images long/lat in some way.

 

3. Then I run this command:

gdalwarp -of VRT -t_srs EPSG:4326 output.vrt output2.vrt

and it produces this file:

https://s3.amazonaws.com/app-dev.mydroneop.com/output2.vrt

 

4. Then finally I run this command:

gdal2tiles.py -p geodetic -k output2.vrt

and it produces a folder of sub folders with images, but here is the doc
file is produces:

https://s3.amazonaws.com/app-dev.mydroneop.com/tiles/doc.kml

The other files (images and kmls) are accessible relative to that file's
location if you need to see them.

 

I then build a basic web page consuming googlemaps and 'import' the kml file
like this:

 

======START HTML=======

<script async defer


        src="https://maps.googleapis.com/maps/api/js?key=GOOGLE_MAPS_KEY
<https://maps.googleapis.com/maps/api/js?key=GOOGLE_MAPS_KEY&callback=initMa
p> &callback=initMap"></script>
function initMap() {


  map = new google.maps.Map(document.getElementById('map'), {


    // center: new google.maps.LatLng(43.6424359, -79.37448849999998),


    zoom: 2,


    disableDefaultUI: true,


    mapTypeId: google.maps.MapTypeId.ROAD





  });





  var layers = [];


  layers [0] = new
google.maps.KmlLayer("https://s3.amazonaws.com/app-dev.mydroneop.com/tiles/d
oc.kml",{


    preserveViewport: false,


    map: map


  });
}
======END HTML=======

Full Source is here:
https://s3.amazonaws.com/app-dev.mydroneop.com/index.html

 

Here is the problem and my questions:

1. I only run this on a single image while I get it to work, but the single
image appears in the center of the world map and not in the long/lat
associated to the image file. The image also appears stretched on it's
edges. As can be seen here: 

https://s3.amazonaws.com/app-dev.mydroneop.com/result-zoomed-in.png
https://s3.amazonaws.com/app-dev.mydroneop.com/result-zoomed-out.png

 

2. What am I doing wrong with the placement of the images not being at
correct long lat position and rather being in the center of the world map? I
assume this has something to do with the 180 90 in the gdal_translate
command but don't know where to derive those numbers from if I should be
deriving them.

 

3. Is it ok that I want to run gdal2tiles on each individual image that make
up this large orthomosaic image that will be super-overlayed? Or should
those images be stitched together and then gdal2tiles be run on the single
super large image (400 mb and higher).

 

4. Why don't the images change as I zoom in? (the purpose of the tiles I
thought) in my google maps html file?

 

5. In the doc.kml file, will those relative links (relative to kml file)
work when the doc.kml is used in new google.maps.KmlLayer('doc.kml')?

 

6. Using this command below I thought it converted x and y pixel position in
the image to real world long/lat, how do I get long/lat from the command's
output?:
> gdallocationinfo DJI_0001.JPG 10 10

Report:
  Location: (10P,10L)
  Band 1:
    Value: 45
  Band 2:
    Value: 75
  Band 3:
    Value: 13

 

 

 

I have searched and read many docs but can't find a sample for what I am
trying to do, just pieces here and there and I haven't been able to put a
complete process together. If there is somewhere that has a relatively
complete explanation for what I am trying to do feel free to just point me
there. 




Thank you for your patience if you read through all that, I appreciate any
help that can be offered.

 

Nick

 

-- 

Nick Licata
nalicata at gmail.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191030/ecc65cdd/attachment-0001.html>

From bjorn.harrtell at gmail.com  Wed Oct 30 18:17:27 2019
From: bjorn.harrtell at gmail.com (=?UTF-8?Q?Bj=C3=B6rn_Harrtell?=)
Date: Thu, 31 Oct 2019 02:17:27 +0100
Subject: [gdal-dev] Open option for vectors in the cloud
In-Reply-To: <2524372.SVzQUXFDd3@even-i700>
References: <958d77bb68094f6aa4052065e63fccb7@C119S212VM042.msvyvi.vaha.local>
 <2524372.SVzQUXFDd3@even-i700>
Message-ID: <CANhDX=bA+VMot_MZUTy7RNOfvTG=xTtMXx+WwNGQHwE=cwpybg@mail.gmail.com>

Thanks for trying out accessing FlatGeobuf via http.

For the record I've been slightly aware of this particular efficiency
problem and I aim to improve it when I can get to it, because this is a use
case I definitely want FlatGeobuf to grab the first place. :)

/Björn

Den tors 24 okt. 2019 kl 20:05 skrev Even Rouault <
even.rouault at spatialys.com>:

> On jeudi 24 octobre 2019 17:42:23 CEST Rahkonen Jukka (MML) wrote:
> > Hi,
> >
> > I was experimenting with accessing some vector files through http (same
> data
> > as FlatGeoBuffers, GeoPackage, and shapefile). The file size in each
> format
> > was about 850 MB and the amount of data was about 240000 linestrings. I
> > made ogrinfo request with spatial filter that selects one feature and
> > cheched the number of http requests and amount of requested data.
> >
> > FlatGeoBuffers
> > 19 http requests
> > 33046509 bytes read
>
> Looking at the debug log, FlatGeoBuf currently loads the whole index-of-
> features array( "Reading feature offsets index" ), which accounts for 32.7
> MB
> of the above 33 MB. This could probably be avoided by only loading the
> offsets
> of the selected features. The shapefile driver a few years ago had the
> same
> issue and this was fixed by initializing the offset array to zeroes, and
> load
> on demand the offsets when needed.
>
> > If somebody
> > really finds a use case for reading vector data from the web it seems
> > obvious that having a possibility to cache and re-use the spatial index
> > would be very beneficial. I can imagine that with shapefile it would
> mean
> > downloading the .qix file, with GeoPackage reading the contents of the
> > rtree index table, and with FlatGeoBuffers probably extracting the Static
> > packed Hilbert R-tree index.
>
> A general caching logic in /vsicurl/ would be preferable (although the
> download of the 'data' part of files might potentially evict the indexes,
> but
> having a dedicated logic in each driver to tell which files / region of
> the
> files should be cached would be a bit annoying). Basically doing a HEAD
> request on the file to get its last update date, and have a local cache of
> downloaded pieces would be a more general solution.
>
> Even
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/557a5ebf/attachment.html>

From benespepa at gmail.com  Thu Oct 31 00:22:37 2019
From: benespepa at gmail.com (=?UTF-8?Q?Pepa_Bene=C5=A1?=)
Date: Thu, 31 Oct 2019 08:22:37 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <60136e4c-1237-ff28-7b42-971754489523@tu-dortmund.de>
References: <CAGwsgV8TO5651k+SKqHXDoUrQnnzoJ7Es=y-ZFUVcg83d64x8A@mail.gmail.com>
 <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
 <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
 <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>
 <b16634ec-6915-4149-337f-2ba4a465cd8d@xs4all.nl>
 <60136e4c-1237-ff28-7b42-971754489523@tu-dortmund.de>
Message-ID: <CAGwsgV-9LjcmOmCYiG-oYGk7rjPdvw4MMhHv3OdXt27PZEcQ+g@mail.gmail.com>

Hi Tobias,
please, could You help me, with originall question? Is the geometry valid
or it isn't? If it is not, why?

How to explain it to the data author, who can only see valid geometry with
holes where he wants to see them in his ArcMap. But QGIS can see "nested
shells" there and it is consistent with output of data validation via GEOS
library functions.

Question wasn't about repairing data. I ususally use something like this
ogr2ogr -f "ESRI Shapefile" valid_original.shp original.shp -dialect sqlite
-sql "select ST_MakeValid(geometry) as geometry, * from original" --debug
on -dsco SPATIALITE=YES
for it.
But in case of this data there is invalid output here too.
Thanks
Pepa

Pepa Beneš


st 30. 10. 2019 v 20:34 odesílatel Tobias Wendorff <
tobias.wendorff at tu-dortmund.de> napsal:

> Hi Marco,
>
> Am 30.10.2019 um 09:46 schrieb Marco:
> >
> > Indeed Buffer 0 won't do any good on self intersections. Thats just not
> > the way to repair them.
>
> But many users act like this:
>
> 1. Get a warning about invalid geometry,
> 2. run Buffer 0,
> 3. Warning about invalid geometry is gone.
>
> Again, this is not constructed, it's reality.
>
> > Hence I wrote "Buffer 0 on INVALID geometries IMHO can lead to good
> > results depending on the /nature of the invalidity/. To my experience
> > /repeating points,//wrong coordinate ordering and holes touching outer
> > shells in one point///are being repaired well without data loss.".
>
> Of course, in this case it's correct. But a user needs to read and
> understand the problem first. Most don't know what's going on at all,
> run "Buffer 0 " and the problem seems to be gone.
>
> > Of course self intersections can be easily overlooked. For that we have
> > validity checkers.
>
> No. That's what we've got "MakeValid", "Fix Geometry" etc. for. These
> are the correct functions in every case, even if they're slower.
>
> Sorry, I'm just talking from experience... might be different if users
> know how to interpet the output of a validity checker. But please, never
> recommend them to use Buffer 0 ... just recommend them to use the real
> ones.
>
> Best regards,
> Tobias
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/7a271c38/attachment.html>

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 00:50:29 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 00:50:29 -0700 (MST)
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
 contours generated.
In-Reply-To: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>
References: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>
Message-ID: <1572508229577-0.post@n6.nabble.com>

Hi,

I believe I would use gdal_calc https://gdal.org/programs/gdal_calc.html and
make the terrain above the sea level flat before creating the contours. And
I would avoid shapefiles and use GeoPackage as output format. 

There is a button "Edit on GitHub" in the top-right corner on page
https://gdal.org/programs/gdal_contour.html, feel free to test it.

-Jukka Rahkonen-



Stephen Woodbridge-4 wrote
> Hi,
> 
> I want to use gdal_contour to generate shapefile contours which is 
> pretty straight forward except I'm working with coastal relief data that 
> has both elevation and bathymetry. I only want contours for the
> bathymetry.
> 
> I tried setting the -off -5 and -i -5 with the idea that this would 
> start me at a depth of -5 and generate contours every -5 units deeper, 
> but the generated an empty files. Seems like -i parameter can not be 
> negative (should be mentioned in the docs).
> 
> This sets the depth to 400ft and generates contours every 5 ft above that:
> 
> gdal_contour -off -121.92 -i 1.524 bathy-value/crm_vol2.nc.tif 
> bathy-contours/crm_vol2.nc-5.shp
> 
> How can I stop/limit the process and stop at 0 (ie: sea level)? I don't 
> want land elevation contours. Like a -limit 0 argument?
> 
> If this can't be done, it would be a nice option to have so you can 
> breakup contours into multiple shapefiles to avoid overflowing them
> 
> Thanks,
>    -Steve





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 01:14:03 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 01:14:03 -0700 (MST)
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <CAGwsgV-9LjcmOmCYiG-oYGk7rjPdvw4MMhHv3OdXt27PZEcQ+g@mail.gmail.com>
References: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <32a3f0fc43bc41908e81ff0af0c7de28@sdfe.dk>
 <c3c49b9e-cca4-850c-24a1-8e8212b21d82@xs4all.nl>
 <E42C556A-7E3B-4743-8903-C81E4F820612@tu-dortmund.de>
 <f5d62e44-ce07-f390-af14-115693bcb2e9@xs4all.nl>
 <e454edd6-2cb9-c9bf-613d-b9ba1f06cde7@tu-dortmund.de>
 <b16634ec-6915-4149-337f-2ba4a465cd8d@xs4all.nl>
 <60136e4c-1237-ff28-7b42-971754489523@tu-dortmund.de>
 <CAGwsgV-9LjcmOmCYiG-oYGk7rjPdvw4MMhHv3OdXt27PZEcQ+g@mail.gmail.com>
Message-ID: <1572509643338-0.post@n6.nabble.com>

Hi,

It seems to me that the geometry is valid but for some reason the shapefile
reader reads it wrong. It is not trivial to investigate the issue and
developers tend to be busy. Meanwhile you can ask that ArcMap user to save
data into GeoPackage so you can make a test with that.

-Jukka Rahkonen-


Pepa Beneš wrote
> Hi Tobias,
> please, could You help me, with originall question? Is the geometry valid
> or it isn't? If it is not, why?





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 01:38:38 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 01:38:38 -0700 (MST)
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
 contours generated.
In-Reply-To: <1572508229577-0.post@n6.nabble.com>
References: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>
 <1572508229577-0.post@n6.nabble.com>
Message-ID: <1572511118690-0.post@n6.nabble.com>

Second thought, perhaps I would just delete unnecessary contour lines
afterwards instead of flattening the DEM.

gdal_contour -f gpkg -a elev -off -121.92 -i 1.524
bathy-value/crm_vol2.nc.tif bathy-contours/crm_vol2.nc-5.gpkg

ogrinfo -sql "delete from crm_vol2.nc-5 where elev>0"
bathy-contours/crm_vol2.nc-5.gpkg

ogrinfo -sql "VACUUM" bathy-contours/crm_vol2.nc-5.gpkg

-Jukka-



jratike80 wrote
> Hi,
> 
> I believe I would use gdal_calc https://gdal.org/programs/gdal_calc.html
> and
> make the terrain above the sea level flat before creating the contours.
> And
> I would avoid shapefiles and use GeoPackage as output format. 
> 
> There is a button "Edit on GitHub" in the top-right corner on page
> https://gdal.org/programs/gdal_contour.html, feel free to test it.
> 
> -Jukka Rahkonen-





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From even.rouault at spatialys.com  Thu Oct 31 04:00:59 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 31 Oct 2019 12:00:59 +0100
Subject: [gdal-dev] Fwd: Gdal - multipolygon - geometry errors instead
	holes
In-Reply-To: <1572345070086-0.post@n6.nabble.com>
References: <CAGwsgV-EFoFHMDLc6cxK8T5izMT7LofNx7omYxZi3y_51J7E0g@mail.gmail.com>
 <1572345070086-0.post@n6.nabble.com>
Message-ID: <2299304.yfdQ4EPeZk@even-i700>

On mardi 29 octobre 2019 03:31:10 CET jratike80 wrote:
> Hi,
> 
> Your case is a bit hard to analyze with end users tools, probably low level
> study about how the shapefile driver or GEOS works is needed.
> 
> The problematic geometry is a rather big multipolygon and it can be found
> with ogrinfo
> 
> ogrinfo -dialect sqlite -sql "select *, ST_IsValidReason(geometry) from
> original where st_isvalid(geometry)=0" original.shp
> 
> The geometry is the Nested Shells case.
> 
> I opened the same shapefile with OpenJUMP and it shows that certain
> multipolygon part with a hole. The QA tool, that is based on JTS does not
> show topology errors. I saved the layer into a) shapefile and b) into JUMP
> jml format with OpenJUMP and repeated the test with ogrinfo and
> IsValidReason. The shapefile seems to contain an invalid geometry while jml
> file not.
> 
> It seems that the shapefile driver has some issue with reading that
> geometry. OpenJUMP considers that the geometry is OK both when reading and
> writing.
> 
> I deleted manually parts from the multipolygon by utilizing the Select Parts
> tool of OpenJUMP and managed to shrink the error into this shapefile
> http://latuviitta.org/downloads/just_error.zip that contains only this one
> geometry

Thanks for the simplified test case. That was indeed a bug in OGR multipolygon 
reconstruction from rings. Just fixed

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From even.rouault at spatialys.com  Thu Oct 31 04:08:58 2019
From: even.rouault at spatialys.com (Even Rouault)
Date: Thu, 31 Oct 2019 12:08:58 +0100
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
Message-ID: <3867881.MbL6gJQLIP@even-i700>

Hi,

A few issues [1] have been fixed since in those branches since the RCs, but 
they predated 2.4.0, so those new releases are not worse than their previous 
x.y.0, so I move to

Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final

~~~~

+1 Even


[1]
- PDS: fix opening of datasets with BSQ organization (or single band), where 
one band is larger than 2 GB (2.3 regression)
- IRIS: make identification more restrictive to avoid false-positive 
identification of raw binary formats such as ENVI (fixes #1961)
- OGRLinearRing::isPointOnRingBoundary(): fix incomplete test that could 
falsely return true if the point was aligned with a segment, but not between 
the nodes. Impact correct reconstruction of holes in shapefile driver

-- 
Spatialys - Geospatial professional services
http://www.spatialys.com

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 05:49:33 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 05:49:33 -0700 (MST)
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <3867881.MbL6gJQLIP@even-i700>
References: <3867881.MbL6gJQLIP@even-i700>
Message-ID: <1572526173735-0.post@n6.nabble.com>

+1

-Jukka Rahkonen-


Even Rouault-2 wrote
> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From sean at mapbox.com  Thu Oct 31 06:46:56 2019
From: sean at mapbox.com (Sean Gillies)
Date: Thu, 31 Oct 2019 07:46:56 -0600
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <3867881.MbL6gJQLIP@even-i700>
References: <3867881.MbL6gJQLIP@even-i700>
Message-ID: <CADPhZXySw_Y=MgY7=vrW1TWWDB0BZpjZUKda7JgUVC0+LBQSTA@mail.gmail.com>

Even, I've built 3.0.2rc1 and didn't find any new issues. +1

On Thu, Oct 31, 2019 at 5:09 AM Even Rouault <even.rouault at spatialys.com>
wrote:

> Hi,
>
> A few issues [1] have been fixed since in those branches since the RCs,
> but
> they predated 2.4.0, so those new releases are not worse than their
> previous
> x.y.0, so I move to
>
> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
>
> ~~~~
>
> +1 Even
>
>
> [1]
> - PDS: fix opening of datasets with BSQ organization (or single band),
> where
> one band is larger than 2 GB (2.3 regression)
> - IRIS: make identification more restrictive to avoid false-positive
> identification of raw binary formats such as ENVI (fixes #1961)
> - OGRLinearRing::isPointOnRingBoundary(): fix incomplete test that could
> falsely return true if the point was aligned with a segment, but not
> between
> the nodes. Impact correct reconstruction of holes in shapefile driver
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Sean Gillies
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/89e584c9/attachment.html>

From dmorissette at mapgears.com  Thu Oct 31 07:39:03 2019
From: dmorissette at mapgears.com (Daniel Morissette)
Date: Thu, 31 Oct 2019 10:39:03 -0400
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <3867881.MbL6gJQLIP@even-i700>
References: <3867881.MbL6gJQLIP@even-i700>
Message-ID: <75148d6b-9b72-1c60-20fd-bec9683e007b@mapgears.com>

+1

Daniel

On 2019-10-31 07:08, Even Rouault wrote:
> Hi,
> 
> A few issues [1] have been fixed since in those branches since the RCs, but
> they predated 2.4.0, so those new releases are not worse than their previous
> x.y.0, so I move to
> 
> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
> 
> ~~~~
> 
> +1 Even
> 
> 
> [1]
> - PDS: fix opening of datasets with BSQ organization (or single band), where
> one band is larger than 2 GB (2.3 regression)
> - IRIS: make identification more restrictive to avoid false-positive
> identification of raw binary formats such as ENVI (fixes #1961)
> - OGRLinearRing::isPointOnRingBoundary(): fix incomplete test that could
> falsely return true if the point was aligned with a segment, but not between
> the nodes. Impact correct reconstruction of holes in shapefile driver
> 


-- 
Daniel Morissette
Mapgears Inc
T: +1 418-696-5056 #201

From stephenwoodbridge37 at gmail.com  Thu Oct 31 07:59:43 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 31 Oct 2019 10:59:43 -0400
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
 contours generated.
In-Reply-To: <1572511118690-0.post@n6.nabble.com>
References: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>
 <1572508229577-0.post@n6.nabble.com> <1572511118690-0.post@n6.nabble.com>
Message-ID: <7d12a39b-6f91-630e-d337-e2d46cb10c5b@gmail.com>

Jukka,

Thanks! After trying shapefile and exceeding 2GB, I switched to postgres 
and deleted the elevation as you suggested.

I'm working with a global relief model the includes both elevation and 
bathymetry depth over the whole world at about 15 arc-sec/pixel. I 
generates a lot of contour lines between 8,000 and -10,000 meters, I was 
think it would be handy to gdal_dem had a few more options to control 
the range and direction of contour generation.

I also have played with gdal_calc to create an elevation and bathymetry 
only files.

Thanks, I think I have workarounds for the moment.

-Steve W

On 10/31/2019 4:38 AM, jratike80 wrote:
> Second thought, perhaps I would just delete unnecessary contour lines
> afterwards instead of flattening the DEM.
>
> gdal_contour -f gpkg -a elev -off -121.92 -i 1.524
> bathy-value/crm_vol2.nc.tif bathy-contours/crm_vol2.nc-5.gpkg
>
> ogrinfo -sql "delete from crm_vol2.nc-5 where elev>0"
> bathy-contours/crm_vol2.nc-5.gpkg
>
> ogrinfo -sql "VACUUM" bathy-contours/crm_vol2.nc-5.gpkg
>
> -Jukka-
>
>
>
> jratike80 wrote
>> Hi,
>>
>> I believe I would use gdal_calc https://gdal.org/programs/gdal_calc.html
>> and
>> make the terrain above the sea level flat before creating the contours.
>> And
>> I would avoid shapefiles and use GeoPackage as output format.
>>
>> There is a button "Edit on GitHub" in the top-right corner on page
>> https://gdal.org/programs/gdal_contour.html, feel free to test it.
>>
>> -Jukka Rahkonen-
>
>
>
>
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev


---
This email has been checked for viruses by Avast antivirus software.
https://www.avast.com/antivirus


From howard at hobu.co  Thu Oct 31 09:46:03 2019
From: howard at hobu.co (Howard Butler)
Date: Thu, 31 Oct 2019 11:46:03 -0500
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <75148d6b-9b72-1c60-20fd-bec9683e007b@mapgears.com>
References: <3867881.MbL6gJQLIP@even-i700>
 <75148d6b-9b72-1c60-20fd-bec9683e007b@mapgears.com>
Message-ID: <357FB146-1998-470A-86AD-FC175CEC59E2@hobu.co>

+1 

Howard

> On Oct 31, 2019, at 9:39 AM, Daniel Morissette <dmorissette at mapgears.com> wrote:
> 
> +1
> 
> Daniel
> 
> On 2019-10-31 07:08, Even Rouault wrote:
>> Hi,
>> A few issues [1] have been fixed since in those branches since the RCs, but
>> they predated 2.4.0, so those new releases are not worse than their previous
>> x.y.0, so I move to
>> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
>> ~~~~
>> +1 Even
>> [1]
>> - PDS: fix opening of datasets with BSQ organization (or single band), where
>> one band is larger than 2 GB (2.3 regression)
>> - IRIS: make identification more restrictive to avoid false-positive
>> identification of raw binary formats such as ENVI (fixes #1961)
>> - OGRLinearRing::isPointOnRingBoundary(): fix incomplete test that could
>> falsely return true if the point was aligned with a segment, but not between
>> the nodes. Impact correct reconstruction of holes in shapefile driver
> 
> 
> -- 
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org <mailto:gdal-dev at lists.osgeo.org>
> https://lists.osgeo.org/mailman/listinfo/gdal-dev <https://lists.osgeo.org/mailman/listinfo/gdal-dev>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/d0cad7ad/attachment-0001.html>

From mateusz at loskot.net  Thu Oct 31 09:55:02 2019
From: mateusz at loskot.net (Mateusz Loskot)
Date: Thu, 31 Oct 2019 17:55:02 +0100
Subject: [gdal-dev] Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
In-Reply-To: <357FB146-1998-470A-86AD-FC175CEC59E2@hobu.co>
References: <3867881.MbL6gJQLIP@even-i700>
 <75148d6b-9b72-1c60-20fd-bec9683e007b@mapgears.com>
 <357FB146-1998-470A-86AD-FC175CEC59E2@hobu.co>
Message-ID: <CABUeae9BQqG-rELDmykqcuxJt=BW0r1cFv7iuLXP2ymK7E5B9Q@mail.gmail.com>

+1

Thanks Even!

Mateusz

On Thu, 31 Oct 2019 at 17:46, Howard Butler <howard at hobu.co> wrote:
>
> +1
>
> Howard
>
> On Oct 31, 2019, at 9:39 AM, Daniel Morissette <dmorissette at mapgears.com> wrote:
>
> +1
>
> Daniel
>
> On 2019-10-31 07:08, Even Rouault wrote:
>
> Hi,
> A few issues [1] have been fixed since in those branches since the RCs, but
> they predated 2.4.0, so those new releases are not worse than their previous
> x.y.0, so I move to
> Motion: approve GDAL 2.4.3RC1 and 3.0.2RC1 as final
> ~~~~
> +1 Even
> [1]
> - PDS: fix opening of datasets with BSQ organization (or single band), where
> one band is larger than 2 GB (2.3 regression)
> - IRIS: make identification more restrictive to avoid false-positive
> identification of raw binary formats such as ENVI (fixes #1961)
> - OGRLinearRing::isPointOnRingBoundary(): fix incomplete test that could
> falsely return true if the point was aligned with a segment, but not between
> the nodes. Impact correct reconstruction of holes in shapefile driver
>
>
>
> --
> Daniel Morissette
> Mapgears Inc
> T: +1 418-696-5056 #201
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
>
>
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev



-- 
Mateusz Loskot, http://mateusz.loskot.net

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 11:11:38 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 11:11:38 -0700 (MST)
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
 contours generated.
In-Reply-To: <7d12a39b-6f91-630e-d337-e2d46cb10c5b@gmail.com>
References: <025cd6c6-6b38-4d4a-979a-7719807a48e0@gmail.com>
 <1572508229577-0.post@n6.nabble.com> <1572511118690-0.post@n6.nabble.com>
 <7d12a39b-6f91-630e-d337-e2d46cb10c5b@gmail.com>
Message-ID: <1572545498322-0.post@n6.nabble.com>

Hi,

One more suggestion, have you tried the -fl option "Name one or more “fixed
levels” to extract"? Requires  some writing but only once if you save the
list into an optfile https://gdal.org/programs/raster_common_options.html. I
haven't tried the option with hundreds of fixed levels, though.

-Jukka-


Jukka,

Thanks! After trying shapefile and exceeding 2GB, I switched to postgres 
and deleted the elevation as you suggested.

I'm working with a global relief model the includes both elevation and 
bathymetry depth over the whole world at about 15 arc-sec/pixel. I 
generates a lot of contour lines between 8,000 and -10,000 meters, I was 
think it would be handy to gdal_dem had a few more options to control 
the range and direction of contour generation.

I also have played with gdal_calc to create an elevation and bathymetry 
only files.

Thanks, I think I have workarounds for the moment.

-Steve W





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ahmettemiz88 at gmail.com  Thu Oct 31 11:34:19 2019
From: ahmettemiz88 at gmail.com (Ahmet Temiz)
Date: Thu, 31 Oct 2019 21:34:19 +0300
Subject: [gdal-dev] Confusion on intersection
Message-ID: <CAJKO1Yts0N9g=xn7mx6=7Phak=PUp7jk7y3zWvrogaVg+OH9Rw@mail.gmail.com>

Hi,
Please correct me if I am wrong.
I want to get intersected part of a line that overlays a polygon.
do I need to use firstly intersects , then intersection?
Intersection part is like:
line->intersection (polygon). // that returns linestring??? Is it correct ?

Regards


-- 
Ahmet Temiz
Jeoloji Müh.
Afet ve Acil Durum Yönetimi Başkanlığı
Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu


________________________

Ahmet Temiz
Geological Eng.
Information Systems - GIS Group
Disaster and Emergency Management
of Presidency
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/e4f40b7a/attachment.html>

From stephenwoodbridge37 at gmail.com  Thu Oct 31 12:44:17 2019
From: stephenwoodbridge37 at gmail.com (Stephen Woodbridge)
Date: Thu, 31 Oct 2019 15:44:17 -0400
Subject: [gdal-dev] Question on gdal_contour and limiting the range of
	contours generated.
In-Reply-To: <1572545498322-0.post@n6.nabble.com>
References: <1572545498322-0.post@n6.nabble.com>
Message-ID: <A9A2369C-DD47-4C89-BFE8-5BC77BBAF4CA@gmail.com>

Thanks I have not seen the raster common option file thing. I’ll look at it. 

Sent from my iPhone

> On Oct 31, 2019, at 2:11 PM, jratike80 <jukka.rahkonen at maanmittauslaitos.fi> wrote:
> 
> ﻿Hi,
> 
> One more suggestion, have you tried the -fl option "Name one or more “fixed
> levels” to extract"? Requires  some writing but only once if you save the
> list into an optfile https://gdal.org/programs/raster_common_options.html. I
> haven't tried the option with hundreds of fixed levels, though.
> 
> -Jukka-
> 
> 
> Jukka,
> 
> Thanks! After trying shapefile and exceeding 2GB, I switched to postgres 
> and deleted the elevation as you suggested.
> 
> I'm working with a global relief model the includes both elevation and 
> bathymetry depth over the whole world at about 15 arc-sec/pixel. I 
> generates a lot of contour lines between 8,000 and -10,000 meters, I was 
> think it would be handy to gdal_dem had a few more options to control 
> the range and direction of contour generation.
> 
> I also have played with gdal_calc to create an elevation and bathymetry 
> only files.
> 
> Thanks, I think I have workarounds for the moment.
> 
> -Steve W
> 
> 
> 
> 
> 
> --
> Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev

From jukka.rahkonen at maanmittauslaitos.fi  Thu Oct 31 13:01:33 2019
From: jukka.rahkonen at maanmittauslaitos.fi (jratike80)
Date: Thu, 31 Oct 2019 13:01:33 -0700 (MST)
Subject: [gdal-dev] Confusion on intersection
In-Reply-To: <CAJKO1Yts0N9g=xn7mx6=7Phak=PUp7jk7y3zWvrogaVg+OH9Rw@mail.gmail.com>
References: <CAJKO1Yts0N9g=xn7mx6=7Phak=PUp7jk7y3zWvrogaVg+OH9Rw@mail.gmail.com>
Message-ID: <1572552093597-0.post@n6.nabble.com>

Hi,

This question does not have much to do with just GDAL but it would have been
a perfect one to be asked from https://gis.stackexchange.com.

Intersects is a function that tells if two geometries intersect and answer
is true or false. Intersection computes the intersection of the two
geometries. 

You can compute intersection without knowing if geometries intersect or not.
If they don't the result is NULL. That may be a problem if your client
program don't know what to do with NULL geometries so one way to avoid them
is to make a preliminary check with Intersects. It may also be faster to get
"false" from Intersects than "null" from Intersection.

You can try yourself with spatialite-gui or with some PostGIS SQL client
with these queries:

select ST_AsText(
ST_Intersection(
ST_GeomFromText('LINESTRING ( 20 50, 100 50 )'),
ST_GeomFromText('POLYGON (( 60 40, 60 60, 80 60, 80 40, 60 40 ))')));
LINESTRING(60 50, 80 50)

select ST_AsText(
ST_Intersection(
ST_GeomFromText('LINESTRING ( 20 80, 100 80 )'),
ST_GeomFromText('POLYGON (( 60 40, 60 60, 80 60, 80 40, 60 40 ))')));
NULL

-Jukka Rahkonen-




orkun wrote
> Hi,
> Please correct me if I am wrong.
> I want to get intersected part of a line that overlays a polygon.
> do I need to use firstly intersects , then intersection?
> Intersection part is like:
> line->intersection (polygon). // that returns linestring??? Is it correct
> ?
> 
> Regards
> 
> 
> -- 
> Ahmet Temiz
> Jeoloji Müh.
> Afet ve Acil Durum Yönetimi Başkanlığı
> Bilgi İşlem  Dairesi Başkanlığı-CBS Grubu
> 
> 
> ________________________
> 
> Ahmet Temiz
> Geological Eng.
> Information Systems - GIS Group
> Disaster and Emergency Management
> of Presidency
> 
> _______________________________________________
> gdal-dev mailing list

> gdal-dev at .osgeo

> https://lists.osgeo.org/mailman/listinfo/gdal-dev





--
Sent from: http://osgeo-org.1560.x6.nabble.com/GDAL-Dev-f3742093.html

From ivan.lucena at outlook.com  Thu Oct 31 14:06:37 2019
From: ivan.lucena at outlook.com (Ivan Lucena)
Date: Thu, 31 Oct 2019 21:06:37 +0000
Subject: [gdal-dev] NetCDF and ESA Probav issue with corner coordimates
Message-ID: <BN6PR22MB0948AE43DD3E4FF4271040B8F2630@BN6PR22MB0948.namprd22.prod.outlook.com>


Hi Folks,

I Downloaded NetCDF files from http://land.copernicus.eu/global/products/ndvi and I am having problems with the GeoTransform that the driver is getting.

The image extents, as you can see in following gdalinfo report, goes beyond the -180 and +180 longitude degrees (half resolution, half pixel) but that's OK according to page 27 in the PDF documentation: PROBAV-Products_User_Manual_v1.3.pdf<https://earth.esa.int/documents/700255/1929094/PROBAV-Products_User_Manual_v1.3.pdf/fd5e30f4-5305-4d41-86aa-fab7b9568251>

But if I open that image on QGIS and overlay a vector (GADM from gadm.org) or any other global layer it is clear that -180x80 should be in the upper left corner of the image, not In the center. There is a half pixel missing on the left and bottom of the image. This in in Fiji:

[cid:fe6be096-c2db-42a9-a1c0-15358ccf71bb]

The gdalinfo report shows that the crs:GeoTransform is -180.0000000000 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905 but it seems like the driver decided to take that to as center of the pixel based. Looking at the NetCDF source I can see that there this possibility exists.

Of course, I am not waiting for a solution. I just used gdal_translate "- a_ullr" and fix that into the target format. It takes centuries to converted that image to geotiff. But I am concerned that others might get in trouble because of that.

I tried to contact the data provider but did not received an answer yet.

Does anybody has experience with that dataset and/or NetCDF that can help figure out what is going on. It is a bug in the driver or an issue with the data.

Thanks,

-
Ivan

Here is the gdalinfo report:

Don't worry about the warnings in regards to the pixel values. It is fine.

$ gdalinfo netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc --debug on
GDAL_netCDF: driver detected file type=5, libnetcdf detected type=3​
Warning 1: NetCDF driver detected file type=5, but libnetcdf detected type=3​
GDAL_netCDF: setting file type to 3, was 5​
GDAL_netCDF: dim_count = 2​
GDAL_netCDF: var_count = 4​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
GDAL_netCDF:​
=====​
SetProjectionFromVar( 3)​
GDAL_netCDF: got grid_mapping crs​
GDAL_netCDF: bIsGdalFile=1 bIsGdalCfFile=0 bBottomUp=0​
GDAL_netCDF: got spheroid from CF: (6378137.000000 , 298.257224)​
GDAL_netCDF: set bBottomUp = 0 from Y axis​
GDAL_netCDF: setting WKT from CF​
GDAL_netCDF: SetProjection, WKT = GEOGCS["unknown",DATUM["unknown",SPHEROID["Spheroid",6378137,298.257223563]],PRIMEM["Greenwich",0],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9122"]]]​
GDAL_netCDF: xdim: 120960 nSpacingBegin: 3 nSpacingMiddle: 3 nSpacingLast: 3​
GDAL_netCDF: ydim: 47040 nSpacingBegin: -3 nSpacingMiddle: -3 nSpacingLast: -3​
GDAL_netCDF: setting WKT from GDAL​
GDAL_netCDF: SetProjection, WKT = GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]​
GDAL_netCDF: SetGeoTransform(-180.001488,0.002976,0.000000,80.001488,0.000000,-0.002976)​
GDAL_netCDF: bGotGeogCS=1 bGotCfSRS=1 bGotCfGT=1 bGotGdalSRS=1 bGotGdalGT=0​
Warning 1: Unsupported netCDF datatype (7), treat as Float32.​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
GDAL_netCDF: netcdf type=5 gdal type=6 signedByte=1​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute _FillValue​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute missing_value​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute flag_values​
GDAL_netCDF: NCDFGetAttr unsupported type 7 for attribute valid_range​
GDAL_netCDF: got add_offset=-0.07999999821186066, status=0​
GDAL_netCDF: got scale_factor=0.004000000189989805, status=0​
GDAL: GDALOpen(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc, this=00000219E2D291F0) succeeds as netCDF.​
Driver: netCDF/Network Common Data Format​
GDAL: GDALDefaultOverviews::OverviewScan()​
Files: none associated​
Size is 120960, 47040​
Coordinate System is:​
GEOGCS["WGS 84",​
    DATUM["WGS_1984",​
        SPHEROID["WGS 84",6378137,298.257223563,​
            AUTHORITY["EPSG","7030"]],​
        TOWGS84[0,0,0,0,0,0,0],​
        AUTHORITY["EPSG","6326"]],​
    PRIMEM["Greenwich",0,​
        AUTHORITY["EPSG","8901"]],​
    UNIT["degree",0.0174532925199433,​
        AUTHORITY["EPSG","9108"]],​
    AUTHORITY["EPSG","4326"]]​
Origin = (-180.001488095238102,80.001488095238088)​
Pixel Size = (0.002976190476204,-0.002976190476190)​
Metadata:​
  crs#GeoTransform=-180.0000000000 0.0029761905 0.0 80.0000000000 0.0 -0.0029761905​
  crs#grid_mapping_name=latitude_longitude​
  crs#inverse_flattening=298.257223563​
  crs#longitude_of_prime_meridian=0​
  crs#long_name=coordinate reference system​
  crs#semi_major_axis=6378137​
  crs#spatial_ref=GEOGCS["WGS 84",DATUM["WGS_1984",SPHEROID["WGS 84",6378137,298.257223563,AUTHORITY["EPSG","7030"]],TOWGS84[0,0,0,0,0,0,0],AUTHORITY["EPSG","6326"]],PRIMEM["Greenwich",0,AUTHORITY["EPSG","8901"]],UNIT["degree",0.0174532925199433,AUTHORITY["EPSG","9108"]],AUTHORITY["EPSG","4326"]]​
  crs#_CoordinateAxisTypes=GeoX GeoY​
  crs#_CoordinateTransformType=Projection​
  lat#axis=Y​
  lat#DIMENSION_LABELS=lat​
  lat#long_name=latitude​
  lat#standard_name=latitude​
  lat#units=degrees_north​
  lat#_CoordinateAxisType=Lat​
  lon#axis=X​
  lon#DIMENSION_LABELS=lon​
  lon#long_name=longitude​
  lon#standard_name=longitude​
  lon#units=degrees_east​
  lon#_CoordinateAxisType=Lon​
  NC_GLOBAL#archive_facility=VITO​
  NC_GLOBAL#Conventions=CF-1.6​
  NC_GLOBAL#copyright=Copernicus Service information 2019​
  NC_GLOBAL#history=Processing line NDVI: 2019-10-22​
  NC_GLOBAL#identifier=urn:cgls:global:ndvi300_v1_333m:NDVI300_201910110000_GLOBE_PROBAV_V1.0.1​
  NC_GLOBAL#institution=VITO NV​
  NC_GLOBAL#long_name=Normalized Difference Vegetation Index​
  NC_GLOBAL#orbit_type=LEO​
  NC_GLOBAL#parent_identifier=urn:cgls:global:ndvi300_v1_333m​
  NC_GLOBAL#platform=Proba-V​
  NC_GLOBAL#processing_level=L3​
  NC_GLOBAL#processing_mode=Near Real Time​
  NC_GLOBAL#product_version=V1.0.1​
  NC_GLOBAL#references=http://land.copernicus.eu/global/products/ndvi​
  NC_GLOBAL#sensor=VEGETATION​
  NC_GLOBAL#source=Derived from EO satellite imagery​
  NC_GLOBAL#time_coverage_end=2019-10-20T23:59:59Z​
  NC_GLOBAL#time_coverage_start=2019-10-11T00:00:00Z​
  NC_GLOBAL#title=10-daily Normalized Difference Vegetation Index 333M: GLOBE 2019-10-11T00:00:00Z​
  NDVI#add_offset=-0.079999998​
  NDVI#flag_meanings=Missing cloud snow sea background​
  NDVI#flag_values={}​
  NDVI#grid_mapping=crs​
  NDVI#long_name=Normalized Difference Vegetation Index 333M​
  NDVI#missing_value=​
  NDVI#scale_factor=0.0040000002​
  NDVI#standard_name=normalized_difference_vegetation_index​
  NDVI#units=​
  NDVI#valid_range={}​
  NDVI#_FillValue=​
OGRCT: PROJ >= 4.8.0 features enabled​
OGRCT: Using locale-safe proj version​
OGRCT: Source: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
OGRCT: Target: +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs​
Corner Coordinates:​
Upper Left  (-180.0014881,  80.0014881) (180d 0' 5.36"W, 80d 0' 5.36"N)​
Lower Left  (-180.0014881, -59.9985119) (180d 0' 5.36"W, 59d59'54.64"S)​
Upper Right ( 179.9985119,  80.0014881) (179d59'54.64"E, 80d 0' 5.36"N)​
Lower Right ( 179.9985119, -59.9985119) (179d59'54.64"E, 59d59'54.64"S)​
Center      (  -0.0014881,  10.0014881) (  0d 0' 5.36"W, 10d 0' 5.36"N)​
Band 1 Block=120960x1 Type=Float32, ColorInterp=Undefined​
  NoData Value=0​
  Offset: -0.0799999982118607,   Scale:0.00400000018998981​
  Metadata:​
    add_offset=-0.079999998​
    flag_meanings=Missing cloud snow sea background​
    flag_values={}​
    grid_mapping=crs​
    long_name=Normalized Difference Vegetation Index 333M​
    missing_value=​
    NETCDF_VARNAME=NDVI​
    scale_factor=0.0040000002​
    standard_name=normalized_difference_vegetation_index​
    units=​
    valid_range={}​
    _FillValue=​
GDAL: GDALClose(netcdf:c_gls_NDVI300_201910110000_GLOBE_PROBAV_V1.0.1.nc, this=00000219E2D291F0)​


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/1f561c0b/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image.png
Type: image/png
Size: 10134 bytes
Desc: image.png
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/1f561c0b/attachment-0001.png>

From davidc.photo at outlook.com  Thu Oct 31 18:01:03 2019
From: davidc.photo at outlook.com (David Cakalic)
Date: Fri, 1 Nov 2019 01:01:03 +0000
Subject: [gdal-dev] gdalsrsinfo Incorrect or Inconsistent results reporting
	EPSG codes
In-Reply-To: <DM6PR18MB335592089C9EF816BAF56B4883620@DM6PR18MB3355.namprd18.prod.outlook.com>
References: <DM6PR18MB335592089C9EF816BAF56B4883620@DM6PR18MB3355.namprd18.prod.outlook.com>
Message-ID: <DM6PR18MB33557E92CFF7B4D41056107383620@DM6PR18MB3355.namprd18.prod.outlook.com>


Hi,

I've been having a problem using gdal to simply read/report EPSG headers on rasters.  I am trying to use it to verify header projection information is correct.
First, I am using Windows 10.
Rasters are Imagine .IMG format.
Command being used is   gdalsrsinfo -e {filename}

I've tried gdal from various sources/vintages... the problem is I can only get it to report the proper (expected) EPSG on 2 of 6 computers... even if I take special care to follow same steps each time.  I am also using the SAME EXACT image file each time.

The projection is NAD83(2011) / UTM zone 14N.
So I expect to see EPSG:6343

I'm often getting EPSG:26914
This is NAD83 / UTM zone 14N   (NOT 2011)

Or I get EPSG:  -1

The gdal install that works as expected on 2 of 6 computers is the version that installs on Windows along with  OSgeo4w.  (GDAL 2.4.1 as reported by "gdalsrsinfo --version" command)

It only works if I run the gdalsrsinfo command from the C:\OSgeo4w\bin folder.... If I run from anywhere else I get the other results mentioned.
Also, I've installed the same OSgeo4w on all 6 machines... and it only works on two.

Other GDAL binaries for Windows I got from the gisinternals website... I've tried multiple versions (2.4.1, 2.4.2, 3.0....) and I'm running through the command shell provided with that distribution....  All getting different results (sometimes -1   sometimes  26914)   but I simply can't find any consistency of WHY it is working sometimes and not others.

One concern I have is that perhaps since GDAL is packaged with SO MANY programs (ESRI, Qgis, Global Mapper, etc.) that perhaps the command is calling incorrect libraries?

Please... if anyone has ideas on WHY this is happening, or how to force the command to run from a a CLEAN environment only using the libraries I desire, I welcome input.
Sincerely,
David C.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/4d05890d/attachment.html>

From patrick.mckendree.young at gmail.com  Thu Oct 31 22:27:20 2019
From: patrick.mckendree.young at gmail.com (Patrick Young)
Date: Thu, 31 Oct 2019 23:27:20 -0600
Subject: [gdal-dev] Python Bindings and Closed Datasets
In-Reply-To: <2583050.INz1hFUIFx@even-i700>
References: <CADXYQQ7fmP8H67eK7FG+z6GTWfUqpX003Ux6s_KGa+PnTsKCqg@mail.gmail.com>
 <4778696.d7OmXju5Sq@even-i700> <2583050.INz1hFUIFx@even-i700>
Message-ID: <CADXYQQ5Ezi2-dm4ZeqPT7tB9eg4JQ1wRCPoY0OWO8nzLAbmZpw@mail.gmail.com>

After some more investigation, I've managed to put together the script
below that manifests the issue on my machine (8 core, Ubuntu 19.04, GDAL
2.4.0, Python 3.7).  Where I first observed this was in using 8 band WV2
imagery, so that's what the complicated input image is modeled after.
Here's an example output:

/tmp/output-15.tif generated an unexpected checksum (5888, 11776, 50432,
23552, 62208, 35328, 55347, 28467)
/tmp/output-26.tif generated an unexpected checksum (55040, 44544, 50432,
23552, 62208, 35328, 55347, 28467)
/tmp/output-32.tif generated an unexpected checksum (55040, 11776, 50432,
23552, 62208, 35328, 55347, 28467)
/tmp/output-56.tif generated an unexpected checksum (38656, 44544, 34048,
23552, 13056, 2560, 55347, 28467)
/tmp/output-59.tif generated an unexpected checksum (55040, 44544, 50432,
23552, 62208, 35328, 55347, 28467)
generated 5 checksums during concurrent warping of same tile


The number different checksums you get back varies from run to run.  Rather
than calling gdal.Warp, I tried shelling out directly to the gdalwarp
executable with the same arguments and didn't see the issue, so that is
interesting.  Also, a threadpool of size 1 seems to not have the same
issue.  I'll keep poking at it and see if i can distill it down to
something more precise, but here's the script I've got at the moment:

import os
from concurrent.futures import ThreadPoolExecutor, as_completed

from osgeo import gdal, osr

def warp_tile(f_in, f_out, warp_opts):
    gdal_warp_opts = gdal.WarpOptions(**warp_opts,
creationOptions=["TILED=YES", "COMPRESS=DEFLATE"])
    warp_ds = gdal.Warp(f_out, f_in, options=gdal_warp_opts)

def create_input(f_in):
    dvr = gdal.GetDriverByName('GTiff')
    ds = dvr.Create(f_in, 8456, 7558, 8, gdal.GDT_UInt16)

    ds.SetGeoTransform( (533949.5611715792, 2.12, 0.0, 4183240.981122436,
0.0, -2.12) )

    srs = osr.SpatialReference()
    srs.SetUTM(10, 1)
    srs.SetWellKnownGeogCS('WGS84')
    ds.SetProjection(srs.ExportToWkt())

    for b in range(8):
        ds.GetRasterBand(b+1).Fill(b+1)

if __name__ == "__main__":
    gdal.UseExceptions()

    f_in = '/tmp/input.tif'
    create_input(f_in)

    warp_opts = {'outputBounds': (539750.0, 4179750.0, 550250.0,
4190250.0), 'width': 5376, 'height': 5376, 'dstSRS': 'EPSG:32610',
'resampleAlg': 'bilinear'}
    with ThreadPoolExecutor(max_workers=8) as executor:
        job_d = {}
        for i in range(100):
            f_out = f'/tmp/output-{i}.tif'
            job_d[executor.submit(warp_tile, f_in, f_out, warp_opts)] =
f_out

        check_sums = set()
        for future in as_completed(job_d):
            f_out = job_d[future]
            try:
                future.result()
            except Exception as e:
                print(f'failure warping {f_out}, {e}')
            else:
                ds = gdal.Open(f_out)
                cs = tuple(ds.GetRasterBand(b+1).Checksum() for b in
range(ds.RasterCount))
                if cs != (38656, 11776, 50432, 23552, 62208, 35328, 55347,
28467):
                    print(f'{f_out} generated an unexpected checksum {cs}')
                ds = None
                check_sums.add(cs)
            finally:
                os.remove(f_out)
        os.remove(f_in)
        print(f'generated {len(check_sums)} checksums during concurrent
warping of same tile')

On Wed, Oct 30, 2019 at 1:32 PM Even Rouault <even.rouault at spatialys.com>
wrote:

> I've, unsuccessfully, tried to reproduce your issue with the following
> script:
>
> -----
>
> from osgeo import gdal
> import concurrent.futures
>
> def worker(in_f, out_f):
>     gdal.Unlink(out_f)
>     gdal.Warp(out_f, in_f, options = '-co COMPRESS=DEFLATE -co TILED=YES
> -ts 2048 2048')
>
> jobs = []
>
> for i in range(1000):
>     jobs.append( ['byte.tif', '/tmp/byte%d.tif' % i] )
>
> with concurrent.futures.ThreadPoolExecutor(max_workers=8) as executor:
>     future_map = {executor.submit(worker, in_f, out_f): out_f for in_f,
> out_f in jobs}
>     for future in concurrent.futures.as_completed(future_map):
>         out_f = future_map[future]
>         try:
>             future.result()
>         except Exception as exc:
>             print('%r generated an exception: %s' % (out_f, exc))
>
>         print('Finished ' + out_f)
>         ds = gdal.Open(out_f)
>         if ds.GetRasterBand(1).Checksum() != 58226:
>             print('wrong checksum for ' + out_f)
>
> ------
>
> where the input byte.tif file is
>
> https://github.com/OSGeo/gdal/blob/master/autotest/gcore/data/byte.tif?raw=true
>
>
> --
> Spatialys - Geospatial professional services
> http://www.spatialys.com
> _______________________________________________
> gdal-dev mailing list
> gdal-dev at lists.osgeo.org
> https://lists.osgeo.org/mailman/listinfo/gdal-dev
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191031/1e8cba67/attachment.html>

From divxtamana at gmail.com  Thu Oct 31 23:09:57 2019
From: divxtamana at gmail.com (Dshah)
Date: Fri, 1 Nov 2019 08:09:57 +0200
Subject: [gdal-dev] flipped
Message-ID: <CAOOxsY7_gkBB_HXX6n5iGEX8EuPCh8BOnmFQvUO4txB1Q8H5zA@mail.gmail.com>

Greetings,

When I GDALOpen a .tif image and write a new one, the new image is flipped
upside down? could someone please help?

    const char *pszFilename = "im.tif";
    poDataset = (GDALDataset *)GDALOpen(pszFilename, GA_ReadOnly);
Best Regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.osgeo.org/pipermail/gdal-dev/attachments/20191101/027de738/attachment-0001.html>

